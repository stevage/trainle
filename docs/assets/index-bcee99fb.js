(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();function hC(e,t){const n=Object.create(null),r=e.split(",");for(let i=0;i<r.length;i++)n[r[i]]=!0;return t?i=>!!n[i.toLowerCase()]:i=>!!n[i]}const no={},Nm=[],cc=()=>{},t8=()=>!1,n8=/^on[^a-z]/,aw=e=>n8.test(e),fC=e=>e.startsWith("onUpdate:"),Go=Object.assign,dC=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},r8=Object.prototype.hasOwnProperty,ai=(e,t)=>r8.call(e,t),Zn=Array.isArray,Fm=e=>sw(e)==="[object Map]",xR=e=>sw(e)==="[object Set]",ur=e=>typeof e=="function",Bo=e=>typeof e=="string",pC=e=>typeof e=="symbol",Ji=e=>e!==null&&typeof e=="object",bR=e=>Ji(e)&&ur(e.then)&&ur(e.catch),wR=Object.prototype.toString,sw=e=>wR.call(e),i8=e=>sw(e).slice(8,-1),ER=e=>sw(e)==="[object Object]",gC=e=>Bo(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,ab=hC(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),lw=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},o8=/-(\w)/g,gu=lw(e=>e.replace(o8,(t,n)=>n?n.toUpperCase():"")),a8=/\B([A-Z])/g,ag=lw(e=>e.replace(a8,"-$1").toLowerCase()),rf=lw(e=>e.charAt(0).toUpperCase()+e.slice(1)),ZS=lw(e=>e?`on${rf(e)}`:""),J_=(e,t)=>!Object.is(e,t),sb=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},bb=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},UT=e=>{const t=parseFloat(e);return isNaN(t)?e:t},s8=e=>{const t=Bo(e)?Number(e):NaN;return isNaN(t)?e:t};let yL;const VT=()=>yL||(yL=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function mC(e){if(Zn(e)){const t={};for(let n=0;n<e.length;n++){const r=e[n],i=Bo(r)?h8(r):mC(r);if(i)for(const a in i)t[a]=i[a]}return t}else{if(Bo(e))return e;if(Ji(e))return e}}const l8=/;(?![^(]*\))/g,u8=/:([^]+)/,c8=/\/\*[^]*?\*\//g;function h8(e){const t={};return e.replace(c8,"").split(l8).forEach(n=>{if(n){const r=n.split(u8);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function uw(e){let t="";if(Bo(e))t=e;else if(Zn(e))for(let n=0;n<e.length;n++){const r=uw(e[n]);r&&(t+=r+" ")}else if(Ji(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const f8="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",d8=hC(f8);function SR(e){return!!e||e===""}const Mh=e=>Bo(e)?e:e==null?"":Zn(e)||Ji(e)&&(e.toString===wR||!ur(e.toString))?JSON.stringify(e,TR,2):String(e),TR=(e,t)=>t&&t.__v_isRef?TR(e,t.value):Fm(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[r,i])=>(n[`${r} =>`]=i,n),{})}:xR(t)?{[`Set(${t.size})`]:[...t.values()]}:Ji(t)&&!Zn(t)&&!ER(t)?String(t):t;let bl;class IR{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=bl,!t&&bl&&(this.index=(bl.scopes||(bl.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const n=bl;try{return bl=this,t()}finally{bl=n}}}on(){bl=this}off(){bl=this.parent}stop(t){if(this._active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this._active=!1}}}function yC(e){return new IR(e)}function p8(e,t=bl){t&&t.active&&t.effects.push(e)}function g8(){return bl}function il(e){bl&&bl.cleanups.push(e)}const vC=e=>{const t=new Set(e);return t.w=0,t.n=0,t},CR=e=>(e.w&rd)>0,PR=e=>(e.n&rd)>0,m8=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=rd},y8=e=>{const{deps:t}=e;if(t.length){let n=0;for(let r=0;r<t.length;r++){const i=t[r];CR(i)&&!PR(i)?i.delete(e):t[n++]=i,i.w&=~rd,i.n&=~rd}t.length=n}},wb=new WeakMap;let R_=0,rd=1;const GT=30;let ac;const Ap=Symbol(""),$T=Symbol("");class _C{constructor(t,n=null,r){this.fn=t,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,p8(this,r)}run(){if(!this.active)return this.fn();let t=ac,n=Qf;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=ac,ac=this,Qf=!0,rd=1<<++R_,R_<=GT?m8(this):vL(this),this.fn()}finally{R_<=GT&&y8(this),rd=1<<--R_,ac=this.parent,Qf=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){ac===this?this.deferStop=!0:this.active&&(vL(this),this.onStop&&this.onStop(),this.active=!1)}}function vL(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let Qf=!0;const AR=[];function Ey(){AR.push(Qf),Qf=!1}function Sy(){const e=AR.pop();Qf=e===void 0?!0:e}function ol(e,t,n){if(Qf&&ac){let r=wb.get(e);r||wb.set(e,r=new Map);let i=r.get(n);i||r.set(n,i=vC()),MR(i)}}function MR(e,t){let n=!1;R_<=GT?PR(e)||(e.n|=rd,n=!CR(e)):n=!e.has(ac),n&&(e.add(ac),ac.deps.push(e))}function Gh(e,t,n,r,i,a){const l=wb.get(e);if(!l)return;let o=[];if(t==="clear")o=[...l.values()];else if(n==="length"&&Zn(e)){const f=Number(r);l.forEach((p,y)=>{(y==="length"||y>=f)&&o.push(p)})}else switch(n!==void 0&&o.push(l.get(n)),t){case"add":Zn(e)?gC(n)&&o.push(l.get("length")):(o.push(l.get(Ap)),Fm(e)&&o.push(l.get($T)));break;case"delete":Zn(e)||(o.push(l.get(Ap)),Fm(e)&&o.push(l.get($T)));break;case"set":Fm(e)&&o.push(l.get(Ap));break}if(o.length===1)o[0]&&jT(o[0]);else{const f=[];for(const p of o)p&&f.push(...p);jT(vC(f))}}function jT(e,t){const n=Zn(e)?e:[...e];for(const r of n)r.computed&&_L(r);for(const r of n)r.computed||_L(r)}function _L(e,t){(e!==ac||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}function v8(e,t){var n;return(n=wb.get(e))==null?void 0:n.get(t)}const _8=hC("__proto__,__v_isRef,__isVue"),LR=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(pC)),x8=xC(),b8=xC(!1,!0),w8=xC(!0),xL=E8();function E8(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...n){const r=cr(this);for(let a=0,l=this.length;a<l;a++)ol(r,"get",a+"");const i=r[t](...n);return i===-1||i===!1?r[t](...n.map(cr)):i}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...n){Ey();const r=cr(this)[t].apply(this,n);return Sy(),r}}),e}function S8(e){const t=cr(this);return ol(t,"has",e),t.hasOwnProperty(e)}function xC(e=!1,t=!1){return function(r,i,a){if(i==="__v_isReactive")return!e;if(i==="__v_isReadonly")return e;if(i==="__v_isShallow")return t;if(i==="__v_raw"&&a===(e?t?U8:NR:t?kR:RR).get(r))return r;const l=Zn(r);if(!e){if(l&&ai(xL,i))return Reflect.get(xL,i,a);if(i==="hasOwnProperty")return S8}const o=Reflect.get(r,i,a);return(pC(i)?LR.has(i):_8(i))||(e||ol(r,"get",i),t)?o:Oo(o)?l&&gC(i)?o:o.value:Ji(o)?e?z0(o):Qs(o):o}}const T8=OR(),I8=OR(!0);function OR(e=!1){return function(n,r,i,a){let l=n[r];if(qm(l)&&Oo(l)&&!Oo(i))return!1;if(!e&&(!Eb(i)&&!qm(i)&&(l=cr(l),i=cr(i)),!Zn(n)&&Oo(l)&&!Oo(i)))return l.value=i,!0;const o=Zn(n)&&gC(r)?Number(r)<n.length:ai(n,r),f=Reflect.set(n,r,i,a);return n===cr(a)&&(o?J_(i,l)&&Gh(n,"set",r,i):Gh(n,"add",r,i)),f}}function C8(e,t){const n=ai(e,t);e[t];const r=Reflect.deleteProperty(e,t);return r&&n&&Gh(e,"delete",t,void 0),r}function P8(e,t){const n=Reflect.has(e,t);return(!pC(t)||!LR.has(t))&&ol(e,"has",t),n}function A8(e){return ol(e,"iterate",Zn(e)?"length":Ap),Reflect.ownKeys(e)}const DR={get:x8,set:T8,deleteProperty:C8,has:P8,ownKeys:A8},M8={get:w8,set(e,t){return!0},deleteProperty(e,t){return!0}},L8=Go({},DR,{get:b8,set:I8}),bC=e=>e,cw=e=>Reflect.getPrototypeOf(e);function kx(e,t,n=!1,r=!1){e=e.__v_raw;const i=cr(e),a=cr(t);n||(t!==a&&ol(i,"get",t),ol(i,"get",a));const{has:l}=cw(i),o=r?bC:n?SC:Q_;if(l.call(i,t))return o(e.get(t));if(l.call(i,a))return o(e.get(a));e!==i&&e.get(t)}function Nx(e,t=!1){const n=this.__v_raw,r=cr(n),i=cr(e);return t||(e!==i&&ol(r,"has",e),ol(r,"has",i)),e===i?n.has(e):n.has(e)||n.has(i)}function Fx(e,t=!1){return e=e.__v_raw,!t&&ol(cr(e),"iterate",Ap),Reflect.get(e,"size",e)}function bL(e){e=cr(e);const t=cr(this);return cw(t).has.call(t,e)||(t.add(e),Gh(t,"add",e,e)),this}function wL(e,t){t=cr(t);const n=cr(this),{has:r,get:i}=cw(n);let a=r.call(n,e);a||(e=cr(e),a=r.call(n,e));const l=i.call(n,e);return n.set(e,t),a?J_(t,l)&&Gh(n,"set",e,t):Gh(n,"add",e,t),this}function EL(e){const t=cr(this),{has:n,get:r}=cw(t);let i=n.call(t,e);i||(e=cr(e),i=n.call(t,e)),r&&r.call(t,e);const a=t.delete(e);return i&&Gh(t,"delete",e,void 0),a}function SL(){const e=cr(this),t=e.size!==0,n=e.clear();return t&&Gh(e,"clear",void 0,void 0),n}function Bx(e,t){return function(r,i){const a=this,l=a.__v_raw,o=cr(l),f=t?bC:e?SC:Q_;return!e&&ol(o,"iterate",Ap),l.forEach((p,y)=>r.call(i,f(p),f(y),a))}}function zx(e,t,n){return function(...r){const i=this.__v_raw,a=cr(i),l=Fm(a),o=e==="entries"||e===Symbol.iterator&&l,f=e==="keys"&&l,p=i[e](...r),y=n?bC:t?SC:Q_;return!t&&ol(a,"iterate",f?$T:Ap),{next(){const{value:x,done:w}=p.next();return w?{value:x,done:w}:{value:o?[y(x[0]),y(x[1])]:y(x),done:w}},[Symbol.iterator](){return this}}}}function $f(e){return function(...t){return e==="delete"?!1:this}}function O8(){const e={get(a){return kx(this,a)},get size(){return Fx(this)},has:Nx,add:bL,set:wL,delete:EL,clear:SL,forEach:Bx(!1,!1)},t={get(a){return kx(this,a,!1,!0)},get size(){return Fx(this)},has:Nx,add:bL,set:wL,delete:EL,clear:SL,forEach:Bx(!1,!0)},n={get(a){return kx(this,a,!0)},get size(){return Fx(this,!0)},has(a){return Nx.call(this,a,!0)},add:$f("add"),set:$f("set"),delete:$f("delete"),clear:$f("clear"),forEach:Bx(!0,!1)},r={get(a){return kx(this,a,!0,!0)},get size(){return Fx(this,!0)},has(a){return Nx.call(this,a,!0)},add:$f("add"),set:$f("set"),delete:$f("delete"),clear:$f("clear"),forEach:Bx(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(a=>{e[a]=zx(a,!1,!1),n[a]=zx(a,!0,!1),t[a]=zx(a,!1,!0),r[a]=zx(a,!0,!0)}),[e,n,t,r]}const[D8,R8,k8,N8]=O8();function wC(e,t){const n=t?e?N8:k8:e?R8:D8;return(r,i,a)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?r:Reflect.get(ai(n,i)&&i in r?n:r,i,a)}const F8={get:wC(!1,!1)},B8={get:wC(!1,!0)},z8={get:wC(!0,!1)},RR=new WeakMap,kR=new WeakMap,NR=new WeakMap,U8=new WeakMap;function V8(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function G8(e){return e.__v_skip||!Object.isExtensible(e)?0:V8(i8(e))}function Qs(e){return qm(e)?e:EC(e,!1,DR,F8,RR)}function $8(e){return EC(e,!1,L8,B8,kR)}function z0(e){return EC(e,!0,M8,z8,NR)}function EC(e,t,n,r,i){if(!Ji(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=i.get(e);if(a)return a;const l=G8(e);if(l===0)return e;const o=new Proxy(e,l===2?r:n);return i.set(e,o),o}function Bm(e){return qm(e)?Bm(e.__v_raw):!!(e&&e.__v_isReactive)}function qm(e){return!!(e&&e.__v_isReadonly)}function Eb(e){return!!(e&&e.__v_isShallow)}function FR(e){return Bm(e)||qm(e)}function cr(e){const t=e&&e.__v_raw;return t?cr(t):e}function BR(e){return bb(e,"__v_skip",!0),e}const Q_=e=>Ji(e)?Qs(e):e,SC=e=>Ji(e)?z0(e):e;function zR(e){Qf&&ac&&(e=cr(e),MR(e.dep||(e.dep=vC())))}function UR(e,t){e=cr(e);const n=e.dep;n&&jT(n)}function Oo(e){return!!(e&&e.__v_isRef===!0)}function Xt(e){return VR(e,!1)}function on(e){return VR(e,!0)}function VR(e,t){return Oo(e)?e:new j8(e,t)}class j8{constructor(t,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?t:cr(t),this._value=n?t:Q_(t)}get value(){return zR(this),this._value}set value(t){const n=this.__v_isShallow||Eb(t)||qm(t);t=n?t:cr(t),J_(t,this._rawValue)&&(this._rawValue=t,this._value=n?t:Q_(t),UR(this))}}function Sl(e){return Oo(e)?e.value:e}const q8={get:(e,t,n)=>Sl(Reflect.get(e,t,n)),set:(e,t,n,r)=>{const i=e[t];return Oo(i)&&!Oo(n)?(i.value=n,!0):Reflect.set(e,t,n,r)}};function GR(e){return Bm(e)?e:new Proxy(e,q8)}function TC(e){const t=Zn(e)?new Array(e.length):{};for(const n in e)t[n]=$R(e,n);return t}class Z8{constructor(t,n,r){this._object=t,this._key=n,this._defaultValue=r,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return v8(cr(this._object),this._key)}}class X8{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function kt(e,t,n){return Oo(e)?e:ur(e)?new X8(e):Ji(e)&&arguments.length>1?$R(e,t,n):Xt(e)}function $R(e,t,n){const r=e[t];return Oo(r)?r:new Z8(e,t,n)}class W8{constructor(t,n,r,i){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new _C(t,()=>{this._dirty||(this._dirty=!0,UR(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=r}get value(){const t=cr(this);return zR(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function H8(e,t,n=!1){let r,i;const a=ur(e);return a?(r=e,i=cc):(r=e.get,i=e.set),new W8(r,i,a||!i,n)}function ed(e,t,n,r){let i;try{i=r?e(...r):e()}catch(a){hw(a,t,n)}return i}function hu(e,t,n,r){if(ur(e)){const a=ed(e,t,n,r);return a&&bR(a)&&a.catch(l=>{hw(l,t,n)}),a}const i=[];for(let a=0;a<e.length;a++)i.push(hu(e[a],t,n,r));return i}function hw(e,t,n,r=!0){const i=t?t.vnode:null;if(t){let a=t.parent;const l=t.proxy,o=n;for(;a;){const p=a.ec;if(p){for(let y=0;y<p.length;y++)if(p[y](e,l,o)===!1)return}a=a.parent}const f=t.appContext.config.errorHandler;if(f){ed(f,null,10,[e,l,o]);return}}Y8(e,n,i,r)}function Y8(e,t,n,r=!0){console.error(e)}let e0=!1,qT=!1;const ds=[];let Xc=0;const zm=[];let Dh=null,_p=0;const jR=Promise.resolve();let IC=null;function qi(e){const t=IC||jR;return e?t.then(this?e.bind(this):e):t}function K8(e){let t=Xc+1,n=ds.length;for(;t<n;){const r=t+n>>>1;t0(ds[r])<e?t=r+1:n=r}return t}function CC(e){(!ds.length||!ds.includes(e,e0&&e.allowRecurse?Xc+1:Xc))&&(e.id==null?ds.push(e):ds.splice(K8(e.id),0,e),qR())}function qR(){!e0&&!qT&&(qT=!0,IC=jR.then(XR))}function J8(e){const t=ds.indexOf(e);t>Xc&&ds.splice(t,1)}function Q8(e){Zn(e)?zm.push(...e):(!Dh||!Dh.includes(e,e.allowRecurse?_p+1:_p))&&zm.push(e),qR()}function TL(e,t=e0?Xc+1:0){for(;t<ds.length;t++){const n=ds[t];n&&n.pre&&(ds.splice(t,1),t--,n())}}function ZR(e){if(zm.length){const t=[...new Set(zm)];if(zm.length=0,Dh){Dh.push(...t);return}for(Dh=t,Dh.sort((n,r)=>t0(n)-t0(r)),_p=0;_p<Dh.length;_p++)Dh[_p]();Dh=null,_p=0}}const t0=e=>e.id==null?1/0:e.id,e9=(e,t)=>{const n=t0(e)-t0(t);if(n===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function XR(e){qT=!1,e0=!0,ds.sort(e9);const t=cc;try{for(Xc=0;Xc<ds.length;Xc++){const n=ds[Xc];n&&n.active!==!1&&ed(n,null,14)}}finally{Xc=0,ds.length=0,ZR(),e0=!1,IC=null,(ds.length||zm.length)&&XR()}}function t9(e,t,...n){if(e.isUnmounted)return;const r=e.vnode.props||no;let i=n;const a=t.startsWith("update:"),l=a&&t.slice(7);if(l&&l in r){const y=`${l==="modelValue"?"model":l}Modifiers`,{number:x,trim:w}=r[y]||no;w&&(i=n.map(S=>Bo(S)?S.trim():S)),x&&(i=n.map(UT))}let o,f=r[o=ZS(t)]||r[o=ZS(gu(t))];!f&&a&&(f=r[o=ZS(ag(t))]),f&&hu(f,e,6,i);const p=r[o+"Once"];if(p){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,hu(p,e,6,i)}}function WR(e,t,n=!1){const r=t.emitsCache,i=r.get(e);if(i!==void 0)return i;const a=e.emits;let l={},o=!1;if(!ur(e)){const f=p=>{const y=WR(p,t,!0);y&&(o=!0,Go(l,y))};!n&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}return!a&&!o?(Ji(e)&&r.set(e,null),null):(Zn(a)?a.forEach(f=>l[f]=null):Go(l,a),Ji(e)&&r.set(e,l),l)}function fw(e,t){return!e||!aw(t)?!1:(t=t.slice(2).replace(/Once$/,""),ai(e,t[0].toLowerCase()+t.slice(1))||ai(e,ag(t))||ai(e,t))}let Tl=null,HR=null;function Sb(e){const t=Tl;return Tl=e,HR=e&&e.type.__scopeId||null,t}function Vo(e,t=Tl,n){if(!t||e._n)return e;const r=(...i)=>{r._d&&zL(-1);const a=Sb(t);let l;try{l=e(...i)}finally{Sb(a),r._d&&zL(1)}return l};return r._n=!0,r._c=!0,r._d=!0,r}function XS(e){const{type:t,vnode:n,proxy:r,withProxy:i,props:a,propsOptions:[l],slots:o,attrs:f,emit:p,render:y,renderCache:x,data:w,setupState:S,ctx:L,inheritAttrs:D}=e;let B,z;const M=Sb(e);try{if(n.shapeFlag&4){const V=i||r;B=Zc(y.call(V,V,x,a,S,w,L)),z=f}else{const V=t;B=Zc(V.length>1?V(a,{attrs:f,slots:o,emit:p}):V(a,null)),z=t.props?f:n9(f)}}catch(V){X_.length=0,hw(V,e,1),B=H(hc)}let k=B;if(z&&D!==!1){const V=Object.keys(z),{shapeFlag:q}=k;V.length&&q&7&&(l&&V.some(fC)&&(z=r9(z,l)),k=$h(k,z))}return n.dirs&&(k=$h(k),k.dirs=k.dirs?k.dirs.concat(n.dirs):n.dirs),n.transition&&(k.transition=n.transition),B=k,Sb(M),B}const n9=e=>{let t;for(const n in e)(n==="class"||n==="style"||aw(n))&&((t||(t={}))[n]=e[n]);return t},r9=(e,t)=>{const n={};for(const r in e)(!fC(r)||!(r.slice(9)in t))&&(n[r]=e[r]);return n};function i9(e,t,n){const{props:r,children:i,component:a}=e,{props:l,children:o,patchFlag:f}=t,p=a.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&f>=0){if(f&1024)return!0;if(f&16)return r?IL(r,l,p):!!l;if(f&8){const y=t.dynamicProps;for(let x=0;x<y.length;x++){const w=y[x];if(l[w]!==r[w]&&!fw(p,w))return!0}}}else return(i||o)&&(!o||!o.$stable)?!0:r===l?!1:r?l?IL(r,l,p):!0:!!l;return!1}function IL(e,t,n){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let i=0;i<r.length;i++){const a=r[i];if(t[a]!==e[a]&&!fw(n,a))return!0}return!1}function o9({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}const a9=e=>e.__isSuspense;function s9(e,t){t&&t.pendingBranch?Zn(e)?t.effects.push(...e):t.effects.push(e):Q8(e)}function Nl(e,t){return PC(e,null,t)}const Ux={};function cn(e,t,n){return PC(e,t,n)}function PC(e,t,{immediate:n,deep:r,flush:i,onTrack:a,onTrigger:l}=no){var o;const f=g8()===((o=Ra)==null?void 0:o.scope)?Ra:null;let p,y=!1,x=!1;if(Oo(e)?(p=()=>e.value,y=Eb(e)):Bm(e)?(p=()=>e,r=!0):Zn(e)?(x=!0,y=e.some(V=>Bm(V)||Eb(V)),p=()=>e.map(V=>{if(Oo(V))return V.value;if(Bm(V))return Sp(V);if(ur(V))return ed(V,f,2)})):ur(e)?t?p=()=>ed(e,f,2):p=()=>{if(!(f&&f.isUnmounted))return w&&w(),hu(e,f,3,[S])}:p=cc,t&&r){const V=p;p=()=>Sp(V())}let w,S=V=>{w=M.onStop=()=>{ed(V,f,4)}},L;if(o0)if(S=cc,t?n&&hu(t,f,3,[p(),x?[]:void 0,S]):p(),i==="sync"){const V=J9();L=V.__watcherHandles||(V.__watcherHandles=[])}else return cc;let D=x?new Array(e.length).fill(Ux):Ux;const B=()=>{if(M.active)if(t){const V=M.run();(r||y||(x?V.some((q,Y)=>J_(q,D[Y])):J_(V,D)))&&(w&&w(),hu(t,f,3,[V,D===Ux?void 0:x&&D[0]===Ux?[]:D,S]),D=V)}else M.run()};B.allowRecurse=!!t;let z;i==="sync"?z=B:i==="post"?z=()=>Js(B,f&&f.suspense):(B.pre=!0,f&&(B.id=f.uid),z=()=>CC(B));const M=new _C(p,z);t?n?B():D=M.run():i==="post"?Js(M.run.bind(M),f&&f.suspense):M.run();const k=()=>{M.stop(),f&&f.scope&&dC(f.scope.effects,M)};return L&&L.push(k),k}function l9(e,t,n){const r=this.proxy,i=Bo(e)?e.includes(".")?YR(r,e):()=>r[e]:e.bind(r,r);let a;ur(t)?a=t:(a=t.handler,n=t);const l=Ra;Zm(this);const o=PC(i,a.bind(r),n);return l?Zm(l):Mp(),o}function YR(e,t){const n=t.split(".");return()=>{let r=e;for(let i=0;i<n.length&&r;i++)r=r[n[i]];return r}}function Sp(e,t){if(!Ji(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Oo(e))Sp(e.value,t);else if(Zn(e))for(let n=0;n<e.length;n++)Sp(e[n],t);else if(xR(e)||Fm(e))e.forEach(n=>{Sp(n,t)});else if(ER(e))for(const n in e)Sp(e[n],t);return e}function go(e,t){const n=Tl;if(n===null)return e;const r=yw(n)||n.proxy,i=e.dirs||(e.dirs=[]);for(let a=0;a<t.length;a++){let[l,o,f,p=no]=t[a];l&&(ur(l)&&(l={mounted:l,updated:l}),l.deep&&Sp(o),i.push({dir:l,instance:r,value:o,oldValue:void 0,arg:f,modifiers:p}))}return e}function dp(e,t,n,r){const i=e.dirs,a=t&&t.dirs;for(let l=0;l<i.length;l++){const o=i[l];a&&(o.oldValue=a[l].value);let f=o.dir[r];f&&(Ey(),hu(f,n,8,[e.el,o,e,t]),Sy())}}function KR(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return bs(()=>{e.isMounted=!0}),Us(()=>{e.isUnmounting=!0}),e}const Ql=[Function,Array],JR={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ql,onEnter:Ql,onAfterEnter:Ql,onEnterCancelled:Ql,onBeforeLeave:Ql,onLeave:Ql,onAfterLeave:Ql,onLeaveCancelled:Ql,onBeforeAppear:Ql,onAppear:Ql,onAfterAppear:Ql,onAppearCancelled:Ql},u9={name:"BaseTransition",props:JR,setup(e,{slots:t}){const n=NC(),r=KR();let i;return()=>{const a=t.default&&AC(t.default(),!0);if(!a||!a.length)return;let l=a[0];if(a.length>1){for(const D of a)if(D.type!==hc){l=D;break}}const o=cr(e),{mode:f}=o;if(r.isLeaving)return WS(l);const p=CL(l);if(!p)return WS(l);const y=n0(p,o,r,n);r0(p,y);const x=n.subTree,w=x&&CL(x);let S=!1;const{getTransitionKey:L}=p.type;if(L){const D=L();i===void 0?i=D:D!==i&&(i=D,S=!0)}if(w&&w.type!==hc&&(!xp(p,w)||S)){const D=n0(w,o,r,n);if(r0(w,D),f==="out-in")return r.isLeaving=!0,D.afterLeave=()=>{r.isLeaving=!1,n.update.active!==!1&&n.update()},WS(l);f==="in-out"&&p.type!==hc&&(D.delayLeave=(B,z,M)=>{const k=QR(r,w);k[String(w.key)]=w,B._leaveCb=()=>{z(),B._leaveCb=void 0,delete y.delayedLeave},y.delayedLeave=M})}return l}}},c9=u9;function QR(e,t){const{leavingVNodes:n}=e;let r=n.get(t.type);return r||(r=Object.create(null),n.set(t.type,r)),r}function n0(e,t,n,r){const{appear:i,mode:a,persisted:l=!1,onBeforeEnter:o,onEnter:f,onAfterEnter:p,onEnterCancelled:y,onBeforeLeave:x,onLeave:w,onAfterLeave:S,onLeaveCancelled:L,onBeforeAppear:D,onAppear:B,onAfterAppear:z,onAppearCancelled:M}=t,k=String(e.key),V=QR(n,e),q=(X,U)=>{X&&hu(X,r,9,U)},Y=(X,U)=>{const le=U[1];q(X,U),Zn(X)?X.every(ue=>ue.length<=1)&&le():X.length<=1&&le()},K={mode:a,persisted:l,beforeEnter(X){let U=o;if(!n.isMounted)if(i)U=D||o;else return;X._leaveCb&&X._leaveCb(!0);const le=V[k];le&&xp(e,le)&&le.el._leaveCb&&le.el._leaveCb(),q(U,[X])},enter(X){let U=f,le=p,ue=y;if(!n.isMounted)if(i)U=B||f,le=z||p,ue=M||y;else return;let ae=!1;const ve=X._enterCb=Ee=>{ae||(ae=!0,Ee?q(ue,[X]):q(le,[X]),K.delayedLeave&&K.delayedLeave(),X._enterCb=void 0)};U?Y(U,[X,ve]):ve()},leave(X,U){const le=String(e.key);if(X._enterCb&&X._enterCb(!0),n.isUnmounting)return U();q(x,[X]);let ue=!1;const ae=X._leaveCb=ve=>{ue||(ue=!0,U(),ve?q(L,[X]):q(S,[X]),X._leaveCb=void 0,V[le]===e&&delete V[le])};V[le]=e,w?Y(w,[X,ae]):ae()},clone(X){return n0(X,t,n,r)}};return K}function WS(e){if(dw(e))return e=$h(e),e.children=null,e}function CL(e){return dw(e)?e.children?e.children[0]:void 0:e}function r0(e,t){e.shapeFlag&6&&e.component?r0(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function AC(e,t=!1,n){let r=[],i=0;for(let a=0;a<e.length;a++){let l=e[a];const o=n==null?l.key:String(n)+String(l.key!=null?l.key:a);l.type===Dn?(l.patchFlag&128&&i++,r=r.concat(AC(l.children,t,o))):(t||l.type!==hc)&&r.push(o!=null?$h(l,{key:o}):l)}if(i>1)for(let a=0;a<r.length;a++)r[a].patchFlag=-2;return r}function h9(e,t){return ur(e)?(()=>Go({name:e.name},t,{setup:e}))():e}const lb=e=>!!e.type.__asyncLoader,dw=e=>e.type.__isKeepAlive;function ek(e,t){nk(e,"a",t)}function tk(e,t){nk(e,"da",t)}function nk(e,t,n=Ra){const r=e.__wdc||(e.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return e()});if(pw(t,r,n),n){let i=n.parent;for(;i&&i.parent;)dw(i.parent.vnode)&&f9(r,t,n,i),i=i.parent}}function f9(e,t,n,r){const i=pw(t,e,r,!0);ok(()=>{dC(r[t],i)},n)}function pw(e,t,n=Ra,r=!1){if(n){const i=n[e]||(n[e]=[]),a=t.__weh||(t.__weh=(...l)=>{if(n.isUnmounted)return;Ey(),Zm(n);const o=hu(t,n,e,l);return Mp(),Sy(),o});return r?i.unshift(a):i.push(a),a}}const of=e=>(t,n=Ra)=>(!o0||e==="sp")&&pw(e,(...r)=>t(...r),n),gw=of("bm"),bs=of("m"),rk=of("bu"),ik=of("u"),Us=of("bum"),ok=of("um"),d9=of("sp"),p9=of("rtg"),g9=of("rtc");function m9(e,t=Ra){pw("ec",e,t)}const MC="components",y9="directives";function eu(e,t){return LC(MC,e,!0,t)||e}const ak=Symbol.for("v-ndc");function v9(e){return Bo(e)?LC(MC,e,!1)||e:e||ak}function Fl(e){return LC(y9,e)}function LC(e,t,n=!0,r=!1){const i=Tl||Ra;if(i){const a=i.type;if(e===MC){const o=H9(a,!1);if(o&&(o===t||o===gu(t)||o===rf(gu(t))))return a}const l=PL(i[e]||a[e],t)||PL(i.appContext[e],t);return!l&&r?a:l}}function PL(e,t){return e&&(e[t]||e[gu(t)]||e[rf(gu(t))])}function AL(e,t,n,r){let i;const a=n&&n[r];if(Zn(e)||Bo(e)){i=new Array(e.length);for(let l=0,o=e.length;l<o;l++)i[l]=t(e[l],l,void 0,a&&a[l])}else if(typeof e=="number"){i=new Array(e);for(let l=0;l<e;l++)i[l]=t(l+1,l,void 0,a&&a[l])}else if(Ji(e))if(e[Symbol.iterator])i=Array.from(e,(l,o)=>t(l,o,void 0,a&&a[o]));else{const l=Object.keys(e);i=new Array(l.length);for(let o=0,f=l.length;o<f;o++){const p=l[o];i[o]=t(e[p],p,o,a&&a[o])}}else i=[];return n&&(n[r]=i),i}const ZT=e=>e?yk(e)?yw(e)||e.proxy:ZT(e.parent):null,q_=Go(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>ZT(e.parent),$root:e=>ZT(e.root),$emit:e=>e.emit,$options:e=>OC(e),$forceUpdate:e=>e.f||(e.f=()=>CC(e.update)),$nextTick:e=>e.n||(e.n=qi.bind(e.proxy)),$watch:e=>l9.bind(e)}),HS=(e,t)=>e!==no&&!e.__isScriptSetup&&ai(e,t),_9={get({_:e},t){const{ctx:n,setupState:r,data:i,props:a,accessCache:l,type:o,appContext:f}=e;let p;if(t[0]!=="$"){const S=l[t];if(S!==void 0)switch(S){case 1:return r[t];case 2:return i[t];case 4:return n[t];case 3:return a[t]}else{if(HS(r,t))return l[t]=1,r[t];if(i!==no&&ai(i,t))return l[t]=2,i[t];if((p=e.propsOptions[0])&&ai(p,t))return l[t]=3,a[t];if(n!==no&&ai(n,t))return l[t]=4,n[t];XT&&(l[t]=0)}}const y=q_[t];let x,w;if(y)return t==="$attrs"&&ol(e,"get",t),y(e);if((x=o.__cssModules)&&(x=x[t]))return x;if(n!==no&&ai(n,t))return l[t]=4,n[t];if(w=f.config.globalProperties,ai(w,t))return w[t]},set({_:e},t,n){const{data:r,setupState:i,ctx:a}=e;return HS(i,t)?(i[t]=n,!0):r!==no&&ai(r,t)?(r[t]=n,!0):ai(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:r,appContext:i,propsOptions:a}},l){let o;return!!n[l]||e!==no&&ai(e,l)||HS(t,l)||(o=a[0])&&ai(o,l)||ai(r,l)||ai(q_,l)||ai(i.config.globalProperties,l)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:ai(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function ML(e){return Zn(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let XT=!0;function x9(e){const t=OC(e),n=e.proxy,r=e.ctx;XT=!1,t.beforeCreate&&LL(t.beforeCreate,e,"bc");const{data:i,computed:a,methods:l,watch:o,provide:f,inject:p,created:y,beforeMount:x,mounted:w,beforeUpdate:S,updated:L,activated:D,deactivated:B,beforeDestroy:z,beforeUnmount:M,destroyed:k,unmounted:V,render:q,renderTracked:Y,renderTriggered:K,errorCaptured:X,serverPrefetch:U,expose:le,inheritAttrs:ue,components:ae,directives:ve,filters:Ee}=t;if(p&&b9(p,r,null),l)for(const Ve in l){const Pe=l[Ve];ur(Pe)&&(r[Ve]=Pe.bind(n))}if(i){const Ve=i.call(n,n);Ji(Ve)&&(e.data=Qs(Ve))}if(XT=!0,a)for(const Ve in a){const Pe=a[Ve],Ke=ur(Pe)?Pe.bind(n,n):ur(Pe.get)?Pe.get.bind(n,n):cc,Be=!ur(Pe)&&ur(Pe.set)?Pe.set.bind(n):cc,Ue=fe({get:Ke,set:Be});Object.defineProperty(r,Ve,{enumerable:!0,configurable:!0,get:()=>Ue.value,set:lt=>Ue.value=lt})}if(o)for(const Ve in o)sk(o[Ve],r,n,Ve);if(f){const Ve=ur(f)?f.call(n):f;Reflect.ownKeys(Ve).forEach(Pe=>{da(Pe,Ve[Pe])})}y&&LL(y,e,"c");function Oe(Ve,Pe){Zn(Pe)?Pe.forEach(Ke=>Ve(Ke.bind(n))):Pe&&Ve(Pe.bind(n))}if(Oe(gw,x),Oe(bs,w),Oe(rk,S),Oe(ik,L),Oe(ek,D),Oe(tk,B),Oe(m9,X),Oe(g9,Y),Oe(p9,K),Oe(Us,M),Oe(ok,V),Oe(d9,U),Zn(le))if(le.length){const Ve=e.exposed||(e.exposed={});le.forEach(Pe=>{Object.defineProperty(Ve,Pe,{get:()=>n[Pe],set:Ke=>n[Pe]=Ke})})}else e.exposed||(e.exposed={});q&&e.render===cc&&(e.render=q),ue!=null&&(e.inheritAttrs=ue),ae&&(e.components=ae),ve&&(e.directives=ve)}function b9(e,t,n=cc){Zn(e)&&(e=WT(e));for(const r in e){const i=e[r];let a;Ji(i)?"default"in i?a=Pi(i.from||r,i.default,!0):a=Pi(i.from||r):a=Pi(i),Oo(a)?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>a.value,set:l=>a.value=l}):t[r]=a}}function LL(e,t,n){hu(Zn(e)?e.map(r=>r.bind(t.proxy)):e.bind(t.proxy),t,n)}function sk(e,t,n,r){const i=r.includes(".")?YR(n,r):()=>n[r];if(Bo(e)){const a=t[e];ur(a)&&cn(i,a)}else if(ur(e))cn(i,e.bind(n));else if(Ji(e))if(Zn(e))e.forEach(a=>sk(a,t,n,r));else{const a=ur(e.handler)?e.handler.bind(n):t[e.handler];ur(a)&&cn(i,a,e)}}function OC(e){const t=e.type,{mixins:n,extends:r}=t,{mixins:i,optionsCache:a,config:{optionMergeStrategies:l}}=e.appContext,o=a.get(t);let f;return o?f=o:!i.length&&!n&&!r?f=t:(f={},i.length&&i.forEach(p=>Tb(f,p,l,!0)),Tb(f,t,l)),Ji(t)&&a.set(t,f),f}function Tb(e,t,n,r=!1){const{mixins:i,extends:a}=t;a&&Tb(e,a,n,!0),i&&i.forEach(l=>Tb(e,l,n,!0));for(const l in t)if(!(r&&l==="expose")){const o=w9[l]||n&&n[l];e[l]=o?o(e[l],t[l]):t[l]}return e}const w9={data:OL,props:DL,emits:DL,methods:k_,computed:k_,beforeCreate:As,created:As,beforeMount:As,mounted:As,beforeUpdate:As,updated:As,beforeDestroy:As,beforeUnmount:As,destroyed:As,unmounted:As,activated:As,deactivated:As,errorCaptured:As,serverPrefetch:As,components:k_,directives:k_,watch:S9,provide:OL,inject:E9};function OL(e,t){return t?e?function(){return Go(ur(e)?e.call(this,this):e,ur(t)?t.call(this,this):t)}:t:e}function E9(e,t){return k_(WT(e),WT(t))}function WT(e){if(Zn(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function As(e,t){return e?[...new Set([].concat(e,t))]:t}function k_(e,t){return e?Go(Object.create(null),e,t):t}function DL(e,t){return e?Zn(e)&&Zn(t)?[...new Set([...e,...t])]:Go(Object.create(null),ML(e),ML(t??{})):t}function S9(e,t){if(!e)return t;if(!t)return e;const n=Go(Object.create(null),e);for(const r in t)n[r]=As(e[r],t[r]);return n}function lk(){return{app:null,config:{isNativeTag:t8,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let T9=0;function I9(e,t){return function(r,i=null){ur(r)||(r=Go({},r)),i!=null&&!Ji(i)&&(i=null);const a=lk(),l=new Set;let o=!1;const f=a.app={_uid:T9++,_component:r,_props:i,_container:null,_context:a,_instance:null,version:Q9,get config(){return a.config},set config(p){},use(p,...y){return l.has(p)||(p&&ur(p.install)?(l.add(p),p.install(f,...y)):ur(p)&&(l.add(p),p(f,...y))),f},mixin(p){return a.mixins.includes(p)||a.mixins.push(p),f},component(p,y){return y?(a.components[p]=y,f):a.components[p]},directive(p,y){return y?(a.directives[p]=y,f):a.directives[p]},mount(p,y,x){if(!o){const w=H(r,i);return w.appContext=a,y&&t?t(w,p):e(w,p,x),o=!0,f._container=p,p.__vue_app__=f,yw(w.component)||w.component.proxy}},unmount(){o&&(e(null,f._container),delete f._container.__vue_app__)},provide(p,y){return a.provides[p]=y,f},runWithContext(p){Ib=f;try{return p()}finally{Ib=null}}};return f}}let Ib=null;function da(e,t){if(Ra){let n=Ra.provides;const r=Ra.parent&&Ra.parent.provides;r===n&&(n=Ra.provides=Object.create(r)),n[e]=t}}function Pi(e,t,n=!1){const r=Ra||Tl;if(r||Ib){const i=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:Ib._context.provides;if(i&&e in i)return i[e];if(arguments.length>1)return n&&ur(t)?t.call(r&&r.proxy):t}}function C9(e,t,n,r=!1){const i={},a={};bb(a,mw,1),e.propsDefaults=Object.create(null),uk(e,t,i,a);for(const l in e.propsOptions[0])l in i||(i[l]=void 0);n?e.props=r?i:$8(i):e.type.props?e.props=i:e.props=a,e.attrs=a}function P9(e,t,n,r){const{props:i,attrs:a,vnode:{patchFlag:l}}=e,o=cr(i),[f]=e.propsOptions;let p=!1;if((r||l>0)&&!(l&16)){if(l&8){const y=e.vnode.dynamicProps;for(let x=0;x<y.length;x++){let w=y[x];if(fw(e.emitsOptions,w))continue;const S=t[w];if(f)if(ai(a,w))S!==a[w]&&(a[w]=S,p=!0);else{const L=gu(w);i[L]=HT(f,o,L,S,e,!1)}else S!==a[w]&&(a[w]=S,p=!0)}}}else{uk(e,t,i,a)&&(p=!0);let y;for(const x in o)(!t||!ai(t,x)&&((y=ag(x))===x||!ai(t,y)))&&(f?n&&(n[x]!==void 0||n[y]!==void 0)&&(i[x]=HT(f,o,x,void 0,e,!0)):delete i[x]);if(a!==o)for(const x in a)(!t||!ai(t,x))&&(delete a[x],p=!0)}p&&Gh(e,"set","$attrs")}function uk(e,t,n,r){const[i,a]=e.propsOptions;let l=!1,o;if(t)for(let f in t){if(ab(f))continue;const p=t[f];let y;i&&ai(i,y=gu(f))?!a||!a.includes(y)?n[y]=p:(o||(o={}))[y]=p:fw(e.emitsOptions,f)||(!(f in r)||p!==r[f])&&(r[f]=p,l=!0)}if(a){const f=cr(n),p=o||no;for(let y=0;y<a.length;y++){const x=a[y];n[x]=HT(i,f,x,p[x],e,!ai(p,x))}}return l}function HT(e,t,n,r,i,a){const l=e[n];if(l!=null){const o=ai(l,"default");if(o&&r===void 0){const f=l.default;if(l.type!==Function&&!l.skipFactory&&ur(f)){const{propsDefaults:p}=i;n in p?r=p[n]:(Zm(i),r=p[n]=f.call(null,t),Mp())}else r=f}l[0]&&(a&&!o?r=!1:l[1]&&(r===""||r===ag(n))&&(r=!0))}return r}function ck(e,t,n=!1){const r=t.propsCache,i=r.get(e);if(i)return i;const a=e.props,l={},o=[];let f=!1;if(!ur(e)){const y=x=>{f=!0;const[w,S]=ck(x,t,!0);Go(l,w),S&&o.push(...S)};!n&&t.mixins.length&&t.mixins.forEach(y),e.extends&&y(e.extends),e.mixins&&e.mixins.forEach(y)}if(!a&&!f)return Ji(e)&&r.set(e,Nm),Nm;if(Zn(a))for(let y=0;y<a.length;y++){const x=gu(a[y]);RL(x)&&(l[x]=no)}else if(a)for(const y in a){const x=gu(y);if(RL(x)){const w=a[y],S=l[x]=Zn(w)||ur(w)?{type:w}:Go({},w);if(S){const L=FL(Boolean,S.type),D=FL(String,S.type);S[0]=L>-1,S[1]=D<0||L<D,(L>-1||ai(S,"default"))&&o.push(x)}}}const p=[l,o];return Ji(e)&&r.set(e,p),p}function RL(e){return e[0]!=="$"}function kL(e){const t=e&&e.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:e===null?"null":""}function NL(e,t){return kL(e)===kL(t)}function FL(e,t){return Zn(t)?t.findIndex(n=>NL(n,e)):ur(t)&&NL(t,e)?0:-1}const hk=e=>e[0]==="_"||e==="$stable",DC=e=>Zn(e)?e.map(Zc):[Zc(e)],A9=(e,t,n)=>{if(t._n)return t;const r=Vo((...i)=>DC(t(...i)),n);return r._c=!1,r},fk=(e,t,n)=>{const r=e._ctx;for(const i in e){if(hk(i))continue;const a=e[i];if(ur(a))t[i]=A9(i,a,r);else if(a!=null){const l=DC(a);t[i]=()=>l}}},dk=(e,t)=>{const n=DC(t);e.slots.default=()=>n},M9=(e,t)=>{if(e.vnode.shapeFlag&32){const n=t._;n?(e.slots=cr(t),bb(t,"_",n)):fk(t,e.slots={})}else e.slots={},t&&dk(e,t);bb(e.slots,mw,1)},L9=(e,t,n)=>{const{vnode:r,slots:i}=e;let a=!0,l=no;if(r.shapeFlag&32){const o=t._;o?n&&o===1?a=!1:(Go(i,t),!n&&o===1&&delete i._):(a=!t.$stable,fk(t,i)),l=t}else t&&(dk(e,t),l={default:1});if(a)for(const o in i)!hk(o)&&!(o in l)&&delete i[o]};function YT(e,t,n,r,i=!1){if(Zn(e)){e.forEach((w,S)=>YT(w,t&&(Zn(t)?t[S]:t),n,r,i));return}if(lb(r)&&!i)return;const a=r.shapeFlag&4?yw(r.component)||r.component.proxy:r.el,l=i?null:a,{i:o,r:f}=e,p=t&&t.r,y=o.refs===no?o.refs={}:o.refs,x=o.setupState;if(p!=null&&p!==f&&(Bo(p)?(y[p]=null,ai(x,p)&&(x[p]=null)):Oo(p)&&(p.value=null)),ur(f))ed(f,o,12,[l,y]);else{const w=Bo(f),S=Oo(f);if(w||S){const L=()=>{if(e.f){const D=w?ai(x,f)?x[f]:y[f]:f.value;i?Zn(D)&&dC(D,a):Zn(D)?D.includes(a)||D.push(a):w?(y[f]=[a],ai(x,f)&&(x[f]=y[f])):(f.value=[a],e.k&&(y[e.k]=f.value))}else w?(y[f]=l,ai(x,f)&&(x[f]=l)):S&&(f.value=l,e.k&&(y[e.k]=l))};l?(L.id=-1,Js(L,n)):L()}}}const Js=s9;function O9(e){return D9(e)}function D9(e,t){const n=VT();n.__VUE__=!0;const{insert:r,remove:i,patchProp:a,createElement:l,createText:o,createComment:f,setText:p,setElementText:y,parentNode:x,nextSibling:w,setScopeId:S=cc,insertStaticContent:L}=e,D=(we,Ce,je,nt=null,st=null,vt=null,Dt=!1,Ct=null,Gt=!!Ce.dynamicChildren)=>{if(we===Ce)return;we&&!xp(we,Ce)&&(nt=Kt(we),lt(we,st,vt,!0),we=null),Ce.patchFlag===-2&&(Gt=!1,Ce.dynamicChildren=null);const{type:Tt,ref:fn,shapeFlag:un}=Ce;switch(Tt){case U0:B(we,Ce,je,nt);break;case hc:z(we,Ce,je,nt);break;case YS:we==null&&M(Ce,je,nt,Dt);break;case Dn:ae(we,Ce,je,nt,st,vt,Dt,Ct,Gt);break;default:un&1?q(we,Ce,je,nt,st,vt,Dt,Ct,Gt):un&6?ve(we,Ce,je,nt,st,vt,Dt,Ct,Gt):(un&64||un&128)&&Tt.process(we,Ce,je,nt,st,vt,Dt,Ct,Gt,dt)}fn!=null&&st&&YT(fn,we&&we.ref,vt,Ce||we,!Ce)},B=(we,Ce,je,nt)=>{if(we==null)r(Ce.el=o(Ce.children),je,nt);else{const st=Ce.el=we.el;Ce.children!==we.children&&p(st,Ce.children)}},z=(we,Ce,je,nt)=>{we==null?r(Ce.el=f(Ce.children||""),je,nt):Ce.el=we.el},M=(we,Ce,je,nt)=>{[we.el,we.anchor]=L(we.children,Ce,je,nt,we.el,we.anchor)},k=({el:we,anchor:Ce},je,nt)=>{let st;for(;we&&we!==Ce;)st=w(we),r(we,je,nt),we=st;r(Ce,je,nt)},V=({el:we,anchor:Ce})=>{let je;for(;we&&we!==Ce;)je=w(we),i(we),we=je;i(Ce)},q=(we,Ce,je,nt,st,vt,Dt,Ct,Gt)=>{Dt=Dt||Ce.type==="svg",we==null?Y(Ce,je,nt,st,vt,Dt,Ct,Gt):U(we,Ce,st,vt,Dt,Ct,Gt)},Y=(we,Ce,je,nt,st,vt,Dt,Ct)=>{let Gt,Tt;const{type:fn,props:un,shapeFlag:xn,transition:Mn,dirs:Wn}=we;if(Gt=we.el=l(we.type,vt,un&&un.is,un),xn&8?y(Gt,we.children):xn&16&&X(we.children,Gt,null,nt,st,vt&&fn!=="foreignObject",Dt,Ct),Wn&&dp(we,null,nt,"created"),K(Gt,we,we.scopeId,Dt,nt),un){for(const gr in un)gr!=="value"&&!ab(gr)&&a(Gt,gr,null,un[gr],vt,we.children,nt,st,Je);"value"in un&&a(Gt,"value",null,un.value),(Tt=un.onVnodeBeforeMount)&&zc(Tt,nt,we)}Wn&&dp(we,null,nt,"beforeMount");const hr=(!st||st&&!st.pendingBranch)&&Mn&&!Mn.persisted;hr&&Mn.beforeEnter(Gt),r(Gt,Ce,je),((Tt=un&&un.onVnodeMounted)||hr||Wn)&&Js(()=>{Tt&&zc(Tt,nt,we),hr&&Mn.enter(Gt),Wn&&dp(we,null,nt,"mounted")},st)},K=(we,Ce,je,nt,st)=>{if(je&&S(we,je),nt)for(let vt=0;vt<nt.length;vt++)S(we,nt[vt]);if(st){let vt=st.subTree;if(Ce===vt){const Dt=st.vnode;K(we,Dt,Dt.scopeId,Dt.slotScopeIds,st.parent)}}},X=(we,Ce,je,nt,st,vt,Dt,Ct,Gt=0)=>{for(let Tt=Gt;Tt<we.length;Tt++){const fn=we[Tt]=Ct?Hf(we[Tt]):Zc(we[Tt]);D(null,fn,Ce,je,nt,st,vt,Dt,Ct)}},U=(we,Ce,je,nt,st,vt,Dt)=>{const Ct=Ce.el=we.el;let{patchFlag:Gt,dynamicChildren:Tt,dirs:fn}=Ce;Gt|=we.patchFlag&16;const un=we.props||no,xn=Ce.props||no;let Mn;je&&pp(je,!1),(Mn=xn.onVnodeBeforeUpdate)&&zc(Mn,je,Ce,we),fn&&dp(Ce,we,je,"beforeUpdate"),je&&pp(je,!0);const Wn=st&&Ce.type!=="foreignObject";if(Tt?le(we.dynamicChildren,Tt,Ct,je,nt,Wn,vt):Dt||Pe(we,Ce,Ct,null,je,nt,Wn,vt,!1),Gt>0){if(Gt&16)ue(Ct,Ce,un,xn,je,nt,st);else if(Gt&2&&un.class!==xn.class&&a(Ct,"class",null,xn.class,st),Gt&4&&a(Ct,"style",un.style,xn.style,st),Gt&8){const hr=Ce.dynamicProps;for(let gr=0;gr<hr.length;gr++){const ki=hr[gr],Uo=un[ki],Ss=xn[ki];(Ss!==Uo||ki==="value")&&a(Ct,ki,Uo,Ss,st,we.children,je,nt,Je)}}Gt&1&&we.children!==Ce.children&&y(Ct,Ce.children)}else!Dt&&Tt==null&&ue(Ct,Ce,un,xn,je,nt,st);((Mn=xn.onVnodeUpdated)||fn)&&Js(()=>{Mn&&zc(Mn,je,Ce,we),fn&&dp(Ce,we,je,"updated")},nt)},le=(we,Ce,je,nt,st,vt,Dt)=>{for(let Ct=0;Ct<Ce.length;Ct++){const Gt=we[Ct],Tt=Ce[Ct],fn=Gt.el&&(Gt.type===Dn||!xp(Gt,Tt)||Gt.shapeFlag&70)?x(Gt.el):je;D(Gt,Tt,fn,null,nt,st,vt,Dt,!0)}},ue=(we,Ce,je,nt,st,vt,Dt)=>{if(je!==nt){if(je!==no)for(const Ct in je)!ab(Ct)&&!(Ct in nt)&&a(we,Ct,je[Ct],null,Dt,Ce.children,st,vt,Je);for(const Ct in nt){if(ab(Ct))continue;const Gt=nt[Ct],Tt=je[Ct];Gt!==Tt&&Ct!=="value"&&a(we,Ct,Tt,Gt,Dt,Ce.children,st,vt,Je)}"value"in nt&&a(we,"value",je.value,nt.value)}},ae=(we,Ce,je,nt,st,vt,Dt,Ct,Gt)=>{const Tt=Ce.el=we?we.el:o(""),fn=Ce.anchor=we?we.anchor:o("");let{patchFlag:un,dynamicChildren:xn,slotScopeIds:Mn}=Ce;Mn&&(Ct=Ct?Ct.concat(Mn):Mn),we==null?(r(Tt,je,nt),r(fn,je,nt),X(Ce.children,je,fn,st,vt,Dt,Ct,Gt)):un>0&&un&64&&xn&&we.dynamicChildren?(le(we.dynamicChildren,xn,je,st,vt,Dt,Ct),(Ce.key!=null||st&&Ce===st.subTree)&&RC(we,Ce,!0)):Pe(we,Ce,je,fn,st,vt,Dt,Ct,Gt)},ve=(we,Ce,je,nt,st,vt,Dt,Ct,Gt)=>{Ce.slotScopeIds=Ct,we==null?Ce.shapeFlag&512?st.ctx.activate(Ce,je,nt,Dt,Gt):Ee(Ce,je,nt,st,vt,Dt,Gt):He(we,Ce,Gt)},Ee=(we,Ce,je,nt,st,vt,Dt)=>{const Ct=we.component=j9(we,nt,st);if(dw(we)&&(Ct.ctx.renderer=dt),q9(Ct),Ct.asyncDep){if(st&&st.registerDep(Ct,Oe),!we.el){const Gt=Ct.subTree=H(hc);z(null,Gt,Ce,je)}return}Oe(Ct,we,Ce,je,st,vt,Dt)},He=(we,Ce,je)=>{const nt=Ce.component=we.component;if(i9(we,Ce,je))if(nt.asyncDep&&!nt.asyncResolved){Ve(nt,Ce,je);return}else nt.next=Ce,J8(nt.update),nt.update();else Ce.el=we.el,nt.vnode=Ce},Oe=(we,Ce,je,nt,st,vt,Dt)=>{const Ct=()=>{if(we.isMounted){let{next:fn,bu:un,u:xn,parent:Mn,vnode:Wn}=we,hr=fn,gr;pp(we,!1),fn?(fn.el=Wn.el,Ve(we,fn,Dt)):fn=Wn,un&&sb(un),(gr=fn.props&&fn.props.onVnodeBeforeUpdate)&&zc(gr,Mn,fn,Wn),pp(we,!0);const ki=XS(we),Uo=we.subTree;we.subTree=ki,D(Uo,ki,x(Uo.el),Kt(Uo),we,st,vt),fn.el=ki.el,hr===null&&o9(we,ki.el),xn&&Js(xn,st),(gr=fn.props&&fn.props.onVnodeUpdated)&&Js(()=>zc(gr,Mn,fn,Wn),st)}else{let fn;const{el:un,props:xn}=Ce,{bm:Mn,m:Wn,parent:hr}=we,gr=lb(Ce);if(pp(we,!1),Mn&&sb(Mn),!gr&&(fn=xn&&xn.onVnodeBeforeMount)&&zc(fn,hr,Ce),pp(we,!0),un&&Ut){const ki=()=>{we.subTree=XS(we),Ut(un,we.subTree,we,st,null)};gr?Ce.type.__asyncLoader().then(()=>!we.isUnmounted&&ki()):ki()}else{const ki=we.subTree=XS(we);D(null,ki,je,nt,we,st,vt),Ce.el=ki.el}if(Wn&&Js(Wn,st),!gr&&(fn=xn&&xn.onVnodeMounted)){const ki=Ce;Js(()=>zc(fn,hr,ki),st)}(Ce.shapeFlag&256||hr&&lb(hr.vnode)&&hr.vnode.shapeFlag&256)&&we.a&&Js(we.a,st),we.isMounted=!0,Ce=je=nt=null}},Gt=we.effect=new _C(Ct,()=>CC(Tt),we.scope),Tt=we.update=()=>Gt.run();Tt.id=we.uid,pp(we,!0),Tt()},Ve=(we,Ce,je)=>{Ce.component=we;const nt=we.vnode.props;we.vnode=Ce,we.next=null,P9(we,Ce.props,nt,je),L9(we,Ce.children,je),Ey(),TL(),Sy()},Pe=(we,Ce,je,nt,st,vt,Dt,Ct,Gt=!1)=>{const Tt=we&&we.children,fn=we?we.shapeFlag:0,un=Ce.children,{patchFlag:xn,shapeFlag:Mn}=Ce;if(xn>0){if(xn&128){Be(Tt,un,je,nt,st,vt,Dt,Ct,Gt);return}else if(xn&256){Ke(Tt,un,je,nt,st,vt,Dt,Ct,Gt);return}}Mn&8?(fn&16&&Je(Tt,st,vt),un!==Tt&&y(je,un)):fn&16?Mn&16?Be(Tt,un,je,nt,st,vt,Dt,Ct,Gt):Je(Tt,st,vt,!0):(fn&8&&y(je,""),Mn&16&&X(un,je,nt,st,vt,Dt,Ct,Gt))},Ke=(we,Ce,je,nt,st,vt,Dt,Ct,Gt)=>{we=we||Nm,Ce=Ce||Nm;const Tt=we.length,fn=Ce.length,un=Math.min(Tt,fn);let xn;for(xn=0;xn<un;xn++){const Mn=Ce[xn]=Gt?Hf(Ce[xn]):Zc(Ce[xn]);D(we[xn],Mn,je,null,st,vt,Dt,Ct,Gt)}Tt>fn?Je(we,st,vt,!0,!1,un):X(Ce,je,nt,st,vt,Dt,Ct,Gt,un)},Be=(we,Ce,je,nt,st,vt,Dt,Ct,Gt)=>{let Tt=0;const fn=Ce.length;let un=we.length-1,xn=fn-1;for(;Tt<=un&&Tt<=xn;){const Mn=we[Tt],Wn=Ce[Tt]=Gt?Hf(Ce[Tt]):Zc(Ce[Tt]);if(xp(Mn,Wn))D(Mn,Wn,je,null,st,vt,Dt,Ct,Gt);else break;Tt++}for(;Tt<=un&&Tt<=xn;){const Mn=we[un],Wn=Ce[xn]=Gt?Hf(Ce[xn]):Zc(Ce[xn]);if(xp(Mn,Wn))D(Mn,Wn,je,null,st,vt,Dt,Ct,Gt);else break;un--,xn--}if(Tt>un){if(Tt<=xn){const Mn=xn+1,Wn=Mn<fn?Ce[Mn].el:nt;for(;Tt<=xn;)D(null,Ce[Tt]=Gt?Hf(Ce[Tt]):Zc(Ce[Tt]),je,Wn,st,vt,Dt,Ct,Gt),Tt++}}else if(Tt>xn)for(;Tt<=un;)lt(we[Tt],st,vt,!0),Tt++;else{const Mn=Tt,Wn=Tt,hr=new Map;for(Tt=Wn;Tt<=xn;Tt++){const vo=Ce[Tt]=Gt?Hf(Ce[Tt]):Zc(Ce[Tt]);vo.key!=null&&hr.set(vo.key,Tt)}let gr,ki=0;const Uo=xn-Wn+1;let Ss=!1,Cc=0;const Ts=new Array(Uo);for(Tt=0;Tt<Uo;Tt++)Ts[Tt]=0;for(Tt=Mn;Tt<=un;Tt++){const vo=we[Tt];if(ki>=Uo){lt(vo,st,vt,!0);continue}let Wo;if(vo.key!=null)Wo=hr.get(vo.key);else for(gr=Wn;gr<=xn;gr++)if(Ts[gr-Wn]===0&&xp(vo,Ce[gr])){Wo=gr;break}Wo===void 0?lt(vo,st,vt,!0):(Ts[Wo-Wn]=Tt+1,Wo>=Cc?Cc=Wo:Ss=!0,D(vo,Ce[Wo],je,null,st,vt,Dt,Ct,Gt),ki++)}const pl=Ss?R9(Ts):Nm;for(gr=pl.length-1,Tt=Uo-1;Tt>=0;Tt--){const vo=Wn+Tt,Wo=Ce[vo],Fu=vo+1<fn?Ce[vo+1].el:nt;Ts[Tt]===0?D(null,Wo,je,Fu,st,vt,Dt,Ct,Gt):Ss&&(gr<0||Tt!==pl[gr]?Ue(Wo,je,Fu,2):gr--)}}},Ue=(we,Ce,je,nt,st=null)=>{const{el:vt,type:Dt,transition:Ct,children:Gt,shapeFlag:Tt}=we;if(Tt&6){Ue(we.component.subTree,Ce,je,nt);return}if(Tt&128){we.suspense.move(Ce,je,nt);return}if(Tt&64){Dt.move(we,Ce,je,dt);return}if(Dt===Dn){r(vt,Ce,je);for(let un=0;un<Gt.length;un++)Ue(Gt[un],Ce,je,nt);r(we.anchor,Ce,je);return}if(Dt===YS){k(we,Ce,je);return}if(nt!==2&&Tt&1&&Ct)if(nt===0)Ct.beforeEnter(vt),r(vt,Ce,je),Js(()=>Ct.enter(vt),st);else{const{leave:un,delayLeave:xn,afterLeave:Mn}=Ct,Wn=()=>r(vt,Ce,je),hr=()=>{un(vt,()=>{Wn(),Mn&&Mn()})};xn?xn(vt,Wn,hr):hr()}else r(vt,Ce,je)},lt=(we,Ce,je,nt=!1,st=!1)=>{const{type:vt,props:Dt,ref:Ct,children:Gt,dynamicChildren:Tt,shapeFlag:fn,patchFlag:un,dirs:xn}=we;if(Ct!=null&&YT(Ct,null,je,we,!0),fn&256){Ce.ctx.deactivate(we);return}const Mn=fn&1&&xn,Wn=!lb(we);let hr;if(Wn&&(hr=Dt&&Dt.onVnodeBeforeUnmount)&&zc(hr,Ce,we),fn&6)Wt(we.component,je,nt);else{if(fn&128){we.suspense.unmount(je,nt);return}Mn&&dp(we,null,Ce,"beforeUnmount"),fn&64?we.type.remove(we,Ce,je,st,dt,nt):Tt&&(vt!==Dn||un>0&&un&64)?Je(Tt,Ce,je,!1,!0):(vt===Dn&&un&384||!st&&fn&16)&&Je(Gt,Ce,je),nt&&xt(we)}(Wn&&(hr=Dt&&Dt.onVnodeUnmounted)||Mn)&&Js(()=>{hr&&zc(hr,Ce,we),Mn&&dp(we,null,Ce,"unmounted")},je)},xt=we=>{const{type:Ce,el:je,anchor:nt,transition:st}=we;if(Ce===Dn){Nt(je,nt);return}if(Ce===YS){V(we);return}const vt=()=>{i(je),st&&!st.persisted&&st.afterLeave&&st.afterLeave()};if(we.shapeFlag&1&&st&&!st.persisted){const{leave:Dt,delayLeave:Ct}=st,Gt=()=>Dt(je,vt);Ct?Ct(we.el,vt,Gt):Gt()}else vt()},Nt=(we,Ce)=>{let je;for(;we!==Ce;)je=w(we),i(we),we=je;i(Ce)},Wt=(we,Ce,je)=>{const{bum:nt,scope:st,update:vt,subTree:Dt,um:Ct}=we;nt&&sb(nt),st.stop(),vt&&(vt.active=!1,lt(Dt,we,Ce,je)),Ct&&Js(Ct,Ce),Js(()=>{we.isUnmounted=!0},Ce),Ce&&Ce.pendingBranch&&!Ce.isUnmounted&&we.asyncDep&&!we.asyncResolved&&we.suspenseId===Ce.pendingId&&(Ce.deps--,Ce.deps===0&&Ce.resolve())},Je=(we,Ce,je,nt=!1,st=!1,vt=0)=>{for(let Dt=vt;Dt<we.length;Dt++)lt(we[Dt],Ce,je,nt,st)},Kt=we=>we.shapeFlag&6?Kt(we.component.subTree):we.shapeFlag&128?we.suspense.next():w(we.anchor||we.el),Vt=(we,Ce,je)=>{we==null?Ce._vnode&&lt(Ce._vnode,null,null,!0):D(Ce._vnode||null,we,Ce,null,null,null,je),TL(),ZR(),Ce._vnode=we},dt={p:D,um:lt,m:Ue,r:xt,mt:Ee,mc:X,pc:Pe,pbc:le,n:Kt,o:e};let Jt,Ut;return t&&([Jt,Ut]=t(dt)),{render:Vt,hydrate:Jt,createApp:I9(Vt,Jt)}}function pp({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function RC(e,t,n=!1){const r=e.children,i=t.children;if(Zn(r)&&Zn(i))for(let a=0;a<r.length;a++){const l=r[a];let o=i[a];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[a]=Hf(i[a]),o.el=l.el),n||RC(l,o)),o.type===U0&&(o.el=l.el)}}function R9(e){const t=e.slice(),n=[0];let r,i,a,l,o;const f=e.length;for(r=0;r<f;r++){const p=e[r];if(p!==0){if(i=n[n.length-1],e[i]<p){t[r]=i,n.push(r);continue}for(a=0,l=n.length-1;a<l;)o=a+l>>1,e[n[o]]<p?a=o+1:l=o;p<e[n[a]]&&(a>0&&(t[r]=n[a-1]),n[a]=r)}}for(a=n.length,l=n[a-1];a-- >0;)n[a]=l,l=t[l];return n}const k9=e=>e.__isTeleport,Z_=e=>e&&(e.disabled||e.disabled===""),BL=e=>typeof SVGElement<"u"&&e instanceof SVGElement,KT=(e,t)=>{const n=e&&e.to;return Bo(n)?t?t(n):null:n},N9={__isTeleport:!0,process(e,t,n,r,i,a,l,o,f,p){const{mc:y,pc:x,pbc:w,o:{insert:S,querySelector:L,createText:D,createComment:B}}=p,z=Z_(t.props);let{shapeFlag:M,children:k,dynamicChildren:V}=t;if(e==null){const q=t.el=D(""),Y=t.anchor=D("");S(q,n,r),S(Y,n,r);const K=t.target=KT(t.props,L),X=t.targetAnchor=D("");K&&(S(X,K),l=l||BL(K));const U=(le,ue)=>{M&16&&y(k,le,ue,i,a,l,o,f)};z?U(n,Y):K&&U(K,X)}else{t.el=e.el;const q=t.anchor=e.anchor,Y=t.target=e.target,K=t.targetAnchor=e.targetAnchor,X=Z_(e.props),U=X?n:Y,le=X?q:K;if(l=l||BL(Y),V?(w(e.dynamicChildren,V,U,i,a,l,o),RC(e,t,!0)):f||x(e,t,U,le,i,a,l,o,!1),z)X||Vx(t,n,q,p,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const ue=t.target=KT(t.props,L);ue&&Vx(t,ue,null,p,0)}else X&&Vx(t,Y,K,p,1)}pk(t)},remove(e,t,n,r,{um:i,o:{remove:a}},l){const{shapeFlag:o,children:f,anchor:p,targetAnchor:y,target:x,props:w}=e;if(x&&a(y),(l||!Z_(w))&&(a(p),o&16))for(let S=0;S<f.length;S++){const L=f[S];i(L,t,n,!0,!!L.dynamicChildren)}},move:Vx,hydrate:F9};function Vx(e,t,n,{o:{insert:r},m:i},a=2){a===0&&r(e.targetAnchor,t,n);const{el:l,anchor:o,shapeFlag:f,children:p,props:y}=e,x=a===2;if(x&&r(l,t,n),(!x||Z_(y))&&f&16)for(let w=0;w<p.length;w++)i(p[w],t,n,2);x&&r(o,t,n)}function F9(e,t,n,r,i,a,{o:{nextSibling:l,parentNode:o,querySelector:f}},p){const y=t.target=KT(t.props,f);if(y){const x=y._lpa||y.firstChild;if(t.shapeFlag&16)if(Z_(t.props))t.anchor=p(l(e),t,o(e),n,r,i,a),t.targetAnchor=x;else{t.anchor=l(e);let w=x;for(;w;)if(w=l(w),w&&w.nodeType===8&&w.data==="teleport anchor"){t.targetAnchor=w,y._lpa=t.targetAnchor&&l(t.targetAnchor);break}p(x,t,y,n,r,i,a)}pk(t)}return t.anchor&&l(t.anchor)}const B9=N9;function pk(e){const t=e.ctx;if(t&&t.ut){let n=e.children[0].el;for(;n!==e.targetAnchor;)n.nodeType===1&&n.setAttribute("data-v-owner",t.uid),n=n.nextSibling;t.ut()}}const Dn=Symbol.for("v-fgt"),U0=Symbol.for("v-txt"),hc=Symbol.for("v-cmt"),YS=Symbol.for("v-stc"),X_=[];let sc=null;function ta(e=!1){X_.push(sc=e?null:[])}function z9(){X_.pop(),sc=X_[X_.length-1]||null}let i0=1;function zL(e){i0+=e}function gk(e){return e.dynamicChildren=i0>0?sc||Nm:null,z9(),i0>0&&sc&&sc.push(e),e}function nu(e,t,n,r,i,a){return gk(ho(e,t,n,r,i,a,!0))}function Xf(e,t,n,r,i){return gk(H(e,t,n,r,i,!0))}function JT(e){return e?e.__v_isVNode===!0:!1}function xp(e,t){return e.type===t.type&&e.key===t.key}const mw="__vInternal",mk=({key:e})=>e??null,ub=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?Bo(e)||Oo(e)||ur(e)?{i:Tl,r:e,k:t,f:!!n}:e:null);function ho(e,t=null,n=null,r=0,i=null,a=e===Dn?0:1,l=!1,o=!1){const f={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&mk(t),ref:t&&ub(t),scopeId:HR,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Tl};return o?(kC(f,n),a&128&&e.normalize(f)):n&&(f.shapeFlag|=Bo(n)?8:16),i0>0&&!l&&sc&&(f.patchFlag>0||a&6)&&f.patchFlag!==32&&sc.push(f),f}const H=U9;function U9(e,t=null,n=null,r=0,i=null,a=!1){if((!e||e===ak)&&(e=hc),JT(e)){const o=$h(e,t,!0);return n&&kC(o,n),i0>0&&!a&&sc&&(o.shapeFlag&6?sc[sc.indexOf(e)]=o:sc.push(o)),o.patchFlag|=-2,o}if(Y9(e)&&(e=e.__vccOpts),t){t=V9(t);let{class:o,style:f}=t;o&&!Bo(o)&&(t.class=uw(o)),Ji(f)&&(FR(f)&&!Zn(f)&&(f=Go({},f)),t.style=mC(f))}const l=Bo(e)?1:a9(e)?128:k9(e)?64:Ji(e)?4:ur(e)?2:0;return ho(e,t,n,r,i,l,a,!0)}function V9(e){return e?FR(e)||mw in e?Go({},e):e:null}function $h(e,t,n=!1){const{props:r,ref:i,patchFlag:a,children:l}=e,o=t?tn(r||{},t):r;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:o,key:o&&mk(o),ref:t&&t.ref?n&&i?Zn(i)?i.concat(ub(t)):[i,ub(t)]:ub(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:l,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Dn?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&$h(e.ssContent),ssFallback:e.ssFallback&&$h(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function au(e=" ",t=0){return H(U0,null,e,t)}function Lh(e="",t=!1){return t?(ta(),Xf(hc,null,e)):H(hc,null,e)}function Zc(e){return e==null||typeof e=="boolean"?H(hc):Zn(e)?H(Dn,null,e.slice()):typeof e=="object"?Hf(e):H(U0,null,String(e))}function Hf(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:$h(e)}function kC(e,t){let n=0;const{shapeFlag:r}=e;if(t==null)t=null;else if(Zn(t))n=16;else if(typeof t=="object")if(r&65){const i=t.default;i&&(i._c&&(i._d=!1),kC(e,i()),i._c&&(i._d=!0));return}else{n=32;const i=t._;!i&&!(mw in t)?t._ctx=Tl:i===3&&Tl&&(Tl.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ur(t)?(t={default:t,_ctx:Tl},n=32):(t=String(t),r&64?(n=16,t=[au(t)]):n=8);e.children=t,e.shapeFlag|=n}function tn(...e){const t={};for(let n=0;n<e.length;n++){const r=e[n];for(const i in r)if(i==="class")t.class!==r.class&&(t.class=uw([t.class,r.class]));else if(i==="style")t.style=mC([t.style,r.style]);else if(aw(i)){const a=t[i],l=r[i];l&&a!==l&&!(Zn(a)&&a.includes(l))&&(t[i]=a?[].concat(a,l):l)}else i!==""&&(t[i]=r[i])}return t}function zc(e,t,n,r=null){hu(e,t,7,[n,r])}const G9=lk();let $9=0;function j9(e,t,n){const r=e.type,i=(t?t.appContext:e.appContext)||G9,a={uid:$9++,vnode:e,type:r,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new IR(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ck(r,i),emitsOptions:WR(r,i),emit:null,emitted:null,propsDefaults:no,inheritAttrs:r.inheritAttrs,ctx:no,data:no,props:no,attrs:no,slots:no,refs:no,setupState:no,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=t9.bind(null,a),e.ce&&e.ce(a),a}let Ra=null;const NC=()=>Ra||Tl;let FC,mm,UL="__VUE_INSTANCE_SETTERS__";(mm=VT()[UL])||(mm=VT()[UL]=[]),mm.push(e=>Ra=e),FC=e=>{mm.length>1?mm.forEach(t=>t(e)):mm[0](e)};const Zm=e=>{FC(e),e.scope.on()},Mp=()=>{Ra&&Ra.scope.off(),FC(null)};function yk(e){return e.vnode.shapeFlag&4}let o0=!1;function q9(e,t=!1){o0=t;const{props:n,children:r}=e.vnode,i=yk(e);C9(e,n,i,t),M9(e,r);const a=i?Z9(e,t):void 0;return o0=!1,a}function Z9(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=BR(new Proxy(e.ctx,_9));const{setup:r}=n;if(r){const i=e.setupContext=r.length>1?W9(e):null;Zm(e),Ey();const a=ed(r,e,0,[e.props,i]);if(Sy(),Mp(),bR(a)){if(a.then(Mp,Mp),t)return a.then(l=>{VL(e,l,t)}).catch(l=>{hw(l,e,0)});e.asyncDep=a}else VL(e,a,t)}else vk(e,t)}function VL(e,t,n){ur(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ji(t)&&(e.setupState=GR(t)),vk(e,n)}let GL;function vk(e,t,n){const r=e.type;if(!e.render){if(!t&&GL&&!r.render){const i=r.template||OC(e).template;if(i){const{isCustomElement:a,compilerOptions:l}=e.appContext.config,{delimiters:o,compilerOptions:f}=r,p=Go(Go({isCustomElement:a,delimiters:o},l),f);r.render=GL(i,p)}}e.render=r.render||cc}Zm(e),Ey(),x9(e),Sy(),Mp()}function X9(e){return e.attrsProxy||(e.attrsProxy=new Proxy(e.attrs,{get(t,n){return ol(e,"get","$attrs"),t[n]}}))}function W9(e){const t=n=>{e.exposed=n||{}};return{get attrs(){return X9(e)},slots:e.slots,emit:e.emit,expose:t}}function yw(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(GR(BR(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in q_)return q_[n](e)},has(t,n){return n in t||n in q_}}))}function H9(e,t=!0){return ur(e)?e.displayName||e.name:e.name||t&&e.__name}function Y9(e){return ur(e)&&"__vccOpts"in e}const fe=(e,t)=>H8(e,t,o0);function vd(e,t,n){const r=arguments.length;return r===2?Ji(t)&&!Zn(t)?JT(t)?H(e,null,[t]):H(e,t):H(e,null,t):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&JT(n)&&(n=[n]),H(e,t,n))}const K9=Symbol.for("v-scx"),J9=()=>Pi(K9),Q9="3.3.4",eV="http://www.w3.org/2000/svg",bp=typeof document<"u"?document:null,$L=bp&&bp.createElement("template"),tV={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{const i=t?bp.createElementNS(eV,e):bp.createElement(e,n?{is:n}:void 0);return e==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:e=>bp.createTextNode(e),createComment:e=>bp.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>bp.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,r,i,a){const l=n?n.previousSibling:t.lastChild;if(i&&(i===a||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),n),!(i===a||!(i=i.nextSibling)););else{$L.innerHTML=r?`<svg>${e}</svg>`:e;const o=$L.content;if(r){const f=o.firstChild;for(;f.firstChild;)o.appendChild(f.firstChild);o.removeChild(f)}t.insertBefore(o,n)}return[l?l.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};function nV(e,t,n){const r=e._vtc;r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}function rV(e,t,n){const r=e.style,i=Bo(n);if(n&&!i){if(t&&!Bo(t))for(const a in t)n[a]==null&&QT(r,a,"");for(const a in n)QT(r,a,n[a])}else{const a=r.display;i?t!==n&&(r.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(r.display=a)}}const jL=/\s*!important$/;function QT(e,t,n){if(Zn(n))n.forEach(r=>QT(e,t,r));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const r=iV(e,t);jL.test(n)?e.setProperty(ag(r),n.replace(jL,""),"important"):e[r]=n}}const qL=["Webkit","Moz","ms"],KS={};function iV(e,t){const n=KS[t];if(n)return n;let r=gu(t);if(r!=="filter"&&r in e)return KS[t]=r;r=rf(r);for(let i=0;i<qL.length;i++){const a=qL[i]+r;if(a in e)return KS[t]=a}return t}const ZL="http://www.w3.org/1999/xlink";function oV(e,t,n,r,i){if(r&&t.startsWith("xlink:"))n==null?e.removeAttributeNS(ZL,t.slice(6,t.length)):e.setAttributeNS(ZL,t,n);else{const a=d8(t);n==null||a&&!SR(n)?e.removeAttribute(t):e.setAttribute(t,a?"":n)}}function aV(e,t,n,r,i,a,l){if(t==="innerHTML"||t==="textContent"){r&&l(r,i,a),e[t]=n??"";return}const o=e.tagName;if(t==="value"&&o!=="PROGRESS"&&!o.includes("-")){e._value=n;const p=o==="OPTION"?e.getAttribute("value"):e.value,y=n??"";p!==y&&(e.value=y),n==null&&e.removeAttribute(t);return}let f=!1;if(n===""||n==null){const p=typeof e[t];p==="boolean"?n=SR(n):n==null&&p==="string"?(n="",f=!0):p==="number"&&(n=0,f=!0)}try{e[t]=n}catch{}f&&e.removeAttribute(t)}function Im(e,t,n,r){e.addEventListener(t,n,r)}function sV(e,t,n,r){e.removeEventListener(t,n,r)}function lV(e,t,n,r,i=null){const a=e._vei||(e._vei={}),l=a[t];if(r&&l)l.value=r;else{const[o,f]=uV(t);if(r){const p=a[t]=fV(r,i);Im(e,o,p,f)}else l&&(sV(e,o,l,f),a[t]=void 0)}}const XL=/(?:Once|Passive|Capture)$/;function uV(e){let t;if(XL.test(e)){t={};let r;for(;r=e.match(XL);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):ag(e.slice(2)),t]}let JS=0;const cV=Promise.resolve(),hV=()=>JS||(cV.then(()=>JS=0),JS=Date.now());function fV(e,t){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;hu(dV(r,n.value),t,5,[r])};return n.value=e,n.attached=hV(),n}function dV(e,t){if(Zn(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(r=>i=>!i._stopped&&r&&r(i))}else return t}const WL=/^on[a-z]/,pV=(e,t,n,r,i=!1,a,l,o,f)=>{t==="class"?nV(e,r,i):t==="style"?rV(e,n,r):aw(t)?fC(t)||lV(e,t,n,r,l):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):gV(e,t,r,i))?aV(e,t,r,a,l,o,f):(t==="true-value"?e._trueValue=r:t==="false-value"&&(e._falseValue=r),oV(e,t,r,i))};function gV(e,t,n,r){return r?!!(t==="innerHTML"||t==="textContent"||t in e&&WL.test(t)&&ur(n)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||WL.test(t)&&Bo(n)?!1:t in e}const jf="transition",w_="animation",Qc=(e,{slots:t})=>vd(c9,xk(e),t);Qc.displayName="Transition";const _k={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},mV=Qc.props=Go({},JR,_k),gp=(e,t=[])=>{Zn(e)?e.forEach(n=>n(...t)):e&&e(...t)},HL=e=>e?Zn(e)?e.some(t=>t.length>1):e.length>1:!1;function xk(e){const t={};for(const ae in e)ae in _k||(t[ae]=e[ae]);if(e.css===!1)return t;const{name:n="v",type:r,duration:i,enterFromClass:a=`${n}-enter-from`,enterActiveClass:l=`${n}-enter-active`,enterToClass:o=`${n}-enter-to`,appearFromClass:f=a,appearActiveClass:p=l,appearToClass:y=o,leaveFromClass:x=`${n}-leave-from`,leaveActiveClass:w=`${n}-leave-active`,leaveToClass:S=`${n}-leave-to`}=e,L=yV(i),D=L&&L[0],B=L&&L[1],{onBeforeEnter:z,onEnter:M,onEnterCancelled:k,onLeave:V,onLeaveCancelled:q,onBeforeAppear:Y=z,onAppear:K=M,onAppearCancelled:X=k}=t,U=(ae,ve,Ee)=>{Wf(ae,ve?y:o),Wf(ae,ve?p:l),Ee&&Ee()},le=(ae,ve)=>{ae._isLeaving=!1,Wf(ae,x),Wf(ae,S),Wf(ae,w),ve&&ve()},ue=ae=>(ve,Ee)=>{const He=ae?K:M,Oe=()=>U(ve,ae,Ee);gp(He,[ve,Oe]),YL(()=>{Wf(ve,ae?f:a),Oh(ve,ae?y:o),HL(He)||KL(ve,r,D,Oe)})};return Go(t,{onBeforeEnter(ae){gp(z,[ae]),Oh(ae,a),Oh(ae,l)},onBeforeAppear(ae){gp(Y,[ae]),Oh(ae,f),Oh(ae,p)},onEnter:ue(!1),onAppear:ue(!0),onLeave(ae,ve){ae._isLeaving=!0;const Ee=()=>le(ae,ve);Oh(ae,x),wk(),Oh(ae,w),YL(()=>{ae._isLeaving&&(Wf(ae,x),Oh(ae,S),HL(V)||KL(ae,r,B,Ee))}),gp(V,[ae,Ee])},onEnterCancelled(ae){U(ae,!1),gp(k,[ae])},onAppearCancelled(ae){U(ae,!0),gp(X,[ae])},onLeaveCancelled(ae){le(ae),gp(q,[ae])}})}function yV(e){if(e==null)return null;if(Ji(e))return[QS(e.enter),QS(e.leave)];{const t=QS(e);return[t,t]}}function QS(e){return s8(e)}function Oh(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e._vtc||(e._vtc=new Set)).add(t)}function Wf(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.remove(r));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function YL(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let vV=0;function KL(e,t,n,r){const i=e._endId=++vV,a=()=>{i===e._endId&&r()};if(n)return setTimeout(a,n);const{type:l,timeout:o,propCount:f}=bk(e,t);if(!l)return r();const p=l+"end";let y=0;const x=()=>{e.removeEventListener(p,w),a()},w=S=>{S.target===e&&++y>=f&&x()};setTimeout(()=>{y<f&&x()},o+1),e.addEventListener(p,w)}function bk(e,t){const n=window.getComputedStyle(e),r=L=>(n[L]||"").split(", "),i=r(`${jf}Delay`),a=r(`${jf}Duration`),l=JL(i,a),o=r(`${w_}Delay`),f=r(`${w_}Duration`),p=JL(o,f);let y=null,x=0,w=0;t===jf?l>0&&(y=jf,x=l,w=a.length):t===w_?p>0&&(y=w_,x=p,w=f.length):(x=Math.max(l,p),y=x>0?l>p?jf:w_:null,w=y?y===jf?a.length:f.length:0);const S=y===jf&&/\b(transform|all)(,|$)/.test(r(`${jf}Property`).toString());return{type:y,timeout:x,propCount:w,hasTransform:S}}function JL(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,r)=>QL(n)+QL(e[r])))}function QL(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function wk(){return document.body.offsetHeight}const Ek=new WeakMap,Sk=new WeakMap,Tk={name:"TransitionGroup",props:Go({},mV,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=NC(),r=KR();let i,a;return ik(()=>{if(!i.length)return;const l=e.moveClass||`${e.name||"v"}-move`;if(!SV(i[0].el,n.vnode.el,l))return;i.forEach(bV),i.forEach(wV);const o=i.filter(EV);wk(),o.forEach(f=>{const p=f.el,y=p.style;Oh(p,l),y.transform=y.webkitTransform=y.transitionDuration="";const x=p._moveCb=w=>{w&&w.target!==p||(!w||/transform$/.test(w.propertyName))&&(p.removeEventListener("transitionend",x),p._moveCb=null,Wf(p,l))};p.addEventListener("transitionend",x)})}),()=>{const l=cr(e),o=xk(l);let f=l.tag||Dn;i=a,a=t.default?AC(t.default()):[];for(let p=0;p<a.length;p++){const y=a[p];y.key!=null&&r0(y,n0(y,o,r,n))}if(i)for(let p=0;p<i.length;p++){const y=i[p];r0(y,n0(y,o,r,n)),Ek.set(y,y.el.getBoundingClientRect())}return H(f,null,a)}}},_V=e=>delete e.mode;Tk.props;const xV=Tk;function bV(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function wV(e){Sk.set(e,e.el.getBoundingClientRect())}function EV(e){const t=Ek.get(e),n=Sk.get(e),r=t.left-n.left,i=t.top-n.top;if(r||i){const a=e.el.style;return a.transform=a.webkitTransform=`translate(${r}px,${i}px)`,a.transitionDuration="0s",e}}function SV(e,t,n){const r=e.cloneNode();e._vtc&&e._vtc.forEach(l=>{l.split(/\s+/).forEach(o=>o&&r.classList.remove(o))}),n.split(/\s+/).forEach(l=>l&&r.classList.add(l)),r.style.display="none";const i=t.nodeType===1?t:t.parentNode;i.appendChild(r);const{hasTransform:a}=bk(r);return i.removeChild(r),a}const eO=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Zn(t)?n=>sb(t,n):t};function TV(e){e.target.composing=!0}function tO(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const IV={created(e,{modifiers:{lazy:t,trim:n,number:r}},i){e._assign=eO(i);const a=r||i.props&&i.props.type==="number";Im(e,t?"change":"input",l=>{if(l.target.composing)return;let o=e.value;n&&(o=o.trim()),a&&(o=UT(o)),e._assign(o)}),n&&Im(e,"change",()=>{e.value=e.value.trim()}),t||(Im(e,"compositionstart",TV),Im(e,"compositionend",tO),Im(e,"change",tO))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,modifiers:{lazy:n,trim:r,number:i}},a){if(e._assign=eO(a),e.composing||document.activeElement===e&&e.type!=="range"&&(n||r&&e.value.trim()===t||(i||e.type==="number")&&UT(e.value)===t))return;const l=t??"";e.value!==l&&(e.value=l)}},CV=["ctrl","shift","alt","meta"],PV={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>CV.some(n=>e[`${n}Key`]&&!t.includes(n))},AV=(e,t)=>(n,...r)=>{for(let i=0;i<t.length;i++){const a=PV[t[i]];if(a&&a(n,t))return}return e(n,...r)},MV={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},LV=(e,t)=>n=>{if(!("key"in n))return;const r=ag(n.key);if(t.some(i=>i===r||MV[i]===r))return e(n)},Ec={beforeMount(e,{value:t},{transition:n}){e._vod=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):E_(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:r}){!t!=!n&&(r?t?(r.beforeEnter(e),E_(e,!0),r.enter(e)):r.leave(e,()=>{E_(e,!1)}):E_(e,t))},beforeUnmount(e,{value:t}){E_(e,t)}};function E_(e,t){e.style.display=t?e._vod:"none"}const OV=Go({patchProp:pV},tV);let nO;function DV(){return nO||(nO=O9(OV))}const RV=(...e)=>{const t=DV().createApp(...e),{mount:n}=t;return t.mount=r=>{const i=kV(r);if(!i)return;const a=t._component;!ur(a)&&!a.render&&!a.template&&(a.template=i.innerHTML),i.innerHTML="";const l=n(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),l},t};function kV(e){return Bo(e)?document.querySelector(e):e}var V0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function vw(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var Ik={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(V0,function(){var n,r,i;function a(o,f){if(!n)n=f;else if(!r)r=f;else{var p="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk); self.onerror = null;",y={};n(y),i=f(y),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(i.workerUrl=window.URL.createObjectURL(new Blob([p],{type:"text/javascript"})))}}a(["exports"],function(o){var f=typeof self<"u"?self:{},p="2.15.0";let y;const x={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(y==null){const u=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{y={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):u}catch{y=u}}return y},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!x.API_URL)return null;try{const u=new URL(x.API_URL);return u.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":u.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},w={supported:!1,testSupport:function(u){!D&&L&&(B?z(u):S=u)}};let S,L,D=!1,B=!1;function z(u){const s=u.createTexture();u.bindTexture(u.TEXTURE_2D,s);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,L),u.isContextLost())return;w.supported=!0}catch{}u.deleteTexture(s),D=!0}f.document&&(L=f.document.createElement("img"),L.onload=function(){S&&z(S),S=null,B=!0},L.onerror=function(){D=!0,S=null},L.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const M="01";function k(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var V=q;function q(u,s,c,d){this.cx=3*u,this.bx=3*(c-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(d-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=s,this.p2x=c,this.p2y=d}q.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,s){if(s===void 0&&(s=1e-6),u<0)return 0;if(u>1)return 1;for(var c=u,d=0;d<8;d++){var m=this.sampleCurveX(c)-u;if(Math.abs(m)<s)return c;var _=this.sampleCurveDerivativeX(c);if(Math.abs(_)<1e-6)break;c-=m/_}var E=0,I=1;for(c=u,d=0;d<20&&(m=this.sampleCurveX(c),!(Math.abs(m-u)<s));d++)u>m?E=c:I=c,c=.5*(I-E)+E;return c},solve:function(u,s){return this.sampleCurveY(this.solveCurveX(u,s))}};var Y=k(V),K=X;function X(u,s){this.x=u,this.y=s}X.prototype={clone:function(){return new X(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,s){return this.clone()._rotateAround(u,s)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var s=u.x-this.x,c=u.y-this.y;return s*s+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,s){return Math.atan2(this.x*s-this.y*u,this.x*u+this.y*s)},_matMult:function(u){var s=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=s,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var s=Math.cos(u),c=Math.sin(u),d=c*this.x+s*this.y;return this.x=s*this.x-c*this.y,this.y=d,this},_rotateAround:function(u,s){var c=Math.cos(u),d=Math.sin(u),m=s.y+d*(this.x-s.x)+c*(this.y-s.y);return this.x=s.x+c*(this.x-s.x)-d*(this.y-s.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},X.convert=function(u){return u instanceof X?u:Array.isArray(u)?new X(u[0],u[1]):u};var U=k(K);const le=Math.PI/180,ue=180/Math.PI;function ae(u){return u*le}function ve(u){return u*ue}const Ee=[[0,0],[1,0],[1,1],[0,1]];function He(u){if(u<=0)return 0;if(u>=1)return 1;const s=u*u,c=s*u;return 4*(u<.5?c:3*(u-s)+c-.75)}function Oe(u,s,c,d){const m=new Y(u,s,c,d);return function(_){return m.solve(_)}}const Ve=Oe(.25,.1,.25,1);function Pe(u,s,c){return Math.min(c,Math.max(s,u))}function Ke(u,s,c){return(c=Pe((c-u)/(s-u),0,1))*c*(3-2*c)}function Be(u,s,c){const d=c-s,m=((u-s)%d+d)%d+s;return m===s?c:m}function Ue(u,s,c){if(!u.length)return c(null,[]);let d=u.length;const m=new Array(u.length);let _=null;u.forEach((E,I)=>{s(E,(P,A)=>{P&&(_=P),m[I]=A,--d==0&&c(_,m)})})}function lt(u){const s=[];for(const c in u)s.push(u[c]);return s}function xt(u,...s){for(const c of s)for(const d in c)u[d]=c[d];return u}let Nt=1;function Wt(){return Nt++}function Je(){return function u(s){return s?(s^Math.random()*(16>>s/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,u)}()}function Kt(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))}function Vt(u){return!!u&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(u)}function dt(u,s){u.forEach(c=>{s[c]&&(s[c]=s[c].bind(s))})}function Jt(u,s){return u.indexOf(s,u.length-s.length)!==-1}function Ut(u,s,c){const d={};for(const m in u)d[m]=s.call(c||this,u[m],m,u);return d}function we(u,s,c){const d={};for(const m in u)s.call(c||this,u[m],m,u)&&(d[m]=u[m]);return d}function Ce(u){return Array.isArray(u)?u.map(Ce):typeof u=="object"&&u?Ut(u,Ce):u}const je={};function nt(u){je[u]||(typeof console<"u"&&console.warn(u),je[u]=!0)}function st(u,s,c){return(c.y-u.y)*(s.x-u.x)>(s.y-u.y)*(c.x-u.x)}function vt(u){let s=0;for(let c,d,m=0,_=u.length,E=_-1;m<_;E=m++)c=u[m],d=u[E],s+=(d.x-c.x)*(c.y+d.y);return s}function Dt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ct(u){const s={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,d,m,_)=>{const E=m||_;return s[d]=!E||E.toLowerCase(),""}),s["max-age"]){const c=parseInt(s["max-age"],10);isNaN(c)?delete s["max-age"]:s["max-age"]=c}return s}let Gt=null;function Tt(u){if(Gt==null){const s=u.navigator?u.navigator.userAgent:null;Gt=!!u.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return Gt}function fn(u){try{const s=f[u];return s.setItem("_mapbox_test_",1),s.removeItem("_mapbox_test_"),!0}catch{return!1}}function un(u,s){return[u[4*s],u[4*s+1],u[4*s+2],u[4*s+3]]}const xn="mapbox-tiles";let Mn=500,Wn=50,hr,gr;function ki(){try{return f.caches}catch{}}function Uo(){ki()&&!hr&&(hr=f.caches.open(xn))}function Ss(u){const s=u.indexOf("?");if(s<0)return u;const c=function(m){const _=m.indexOf("?");return _>0?m.slice(_+1).split("&"):[]}(u),d=c.filter(m=>{const _=m.split("=");return _[0]==="language"||_[0]==="worldview"});return d.length?`${u.slice(0,s)}?${d.join("&")}`:u.slice(0,s)}let Cc=1/0;const Ts={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Ts);class pl extends Error{constructor(s,c,d){c===401&&Ze(d)&&(s+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(s),this.status=c,this.url=d}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const vo=Dt()?()=>self.worker&&self.worker.referrer:()=>(f.location.protocol==="blob:"?f.parent:f).location.href,Wo=function(u,s){if(!(/^file:/.test(c=u.url)||/^file:/.test(vo())&&!/^\w+:/.test(c))){if(f.fetch&&f.Request&&f.AbortController&&f.Request.prototype.hasOwnProperty("signal"))return function(d,m){const _=new f.AbortController,E=new f.Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,referrer:vo(),referrerPolicy:d.referrerPolicy,signal:_.signal});let I=!1,P=!1;const A=(N=E.url).indexOf("sku=")>0&&Ze(N);var N;d.type==="json"&&E.headers.set("Accept","application/json");const G=(W,J,te)=>{if(P)return;if(W&&W.message!=="SecurityError"&&nt(W.toString()),J&&te)return $(J);const se=Date.now();f.fetch(E).then(me=>{if(me.ok){const Ie=A?me.clone():null;return $(me,Ie,se)}return m(new pl(me.statusText,me.status,d.url))}).catch(me=>{me.name!=="AbortError"&&m(new Error(`${me.message} ${d.url}`))})},$=(W,J,te)=>{(d.type==="arrayBuffer"?W.arrayBuffer():d.type==="json"?W.json():W.text()).then(se=>{P||(J&&te&&function(me,Ie,ye){if(Uo(),!hr)return;const Se={status:Ie.status,statusText:Ie.statusText,headers:new f.Headers};Ie.headers.forEach((et,We)=>Se.headers.set(We,et));const Me=Ct(Ie.headers.get("Cache-Control")||"");if(Me["no-store"])return;Me["max-age"]&&Se.headers.set("Expires",new Date(ye+1e3*Me["max-age"]).toUTCString());const Ae=Se.headers.get("Expires");Ae&&(new Date(Ae).getTime()-ye<42e4||function(et,We){if(gr===void 0)try{new Response(new ReadableStream),gr=!0}catch{gr=!1}gr?We(et.body):et.blob().then(We)}(Ie,et=>{const We=new f.Response(et,Se);Uo(),hr&&hr.then(ft=>ft.put(Ss(me.url),We)).catch(ft=>nt(ft.message))}))}(E,J,te),I=!0,m(null,se,W.headers.get("Cache-Control"),W.headers.get("Expires")))}).catch(se=>{P||m(new Error(se.message))})};return A?function(W,J){if(Uo(),!hr)return J(null);const te=Ss(W.url);hr.then(se=>{se.match(te).then(me=>{const Ie=function(ye){if(!ye)return!1;const Se=new Date(ye.headers.get("Expires")||0),Me=Ct(ye.headers.get("Cache-Control")||"");return Se>Date.now()&&!Me["no-cache"]}(me);se.delete(te),Ie&&se.put(te,me.clone()),J(null,me,Ie)}).catch(J)}).catch(J)}(E,G):G(null,null),{cancel:()=>{P=!0,I||_.abort()}}}(u,s);if(Dt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,s,void 0,!0)}var c;return function(d,m){const _=new f.XMLHttpRequest;_.open(d.method||"GET",d.url,!0),d.type==="arrayBuffer"&&(_.responseType="arraybuffer");for(const E in d.headers)_.setRequestHeader(E,d.headers[E]);return d.type==="json"&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials=d.credentials==="include",_.onerror=()=>{m(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||_.status===0)&&_.response!==null){let E=_.response;if(d.type==="json")try{E=JSON.parse(_.response)}catch(I){return m(I)}m(null,E,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else m(new pl(_.statusText,_.status,d.url))},_.send(d.body),{cancel:()=>_.abort()}}(u,s)},Fu=function(u,s){return Wo(xt(u,{type:"arrayBuffer"}),s)};function vg(u){const s=f.document.createElement("a");return s.href=u,s.protocol===f.document.location.protocol&&s.host===f.document.location.host}const Te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ne,re;ne=[],re=0;const be=function(u,s){if(w.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),re>=x.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:u,callback:s,cancelled:!1,cancel(){this.cancelled=!0}};return ne.push(_),_}re++;let c=!1;const d=()=>{if(!c)for(c=!0,re--;ne.length&&re<x.MAX_PARALLEL_IMAGE_REQUESTS;){const _=ne.shift(),{requestParameters:E,callback:I,cancelled:P}=_;P||(_.cancel=be(E,I).cancel)}},m=Fu(u,(_,E,I,P)=>{d(),_?s(_):E&&(f.createImageBitmap?function(A,N){const G=new f.Blob([new Uint8Array(A)],{type:"image/png"});f.createImageBitmap(G).then($=>{N(null,$)}).catch($=>{N(new Error(`Could not load image because of ${$.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(E,(A,N)=>s(A,N,I,P)):function(A,N){const G=new f.Image,$=f.URL;G.onload=()=>{N(null,G),$.revokeObjectURL(G.src),G.onload=null,f.requestAnimationFrame(()=>{G.src=Te})},G.onerror=()=>N(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const W=new f.Blob([new Uint8Array(A)],{type:"image/png"});G.src=A.byteLength?$.createObjectURL(W):Te}(E,(A,N)=>s(A,N,I,P)))});return{cancel:()=>{m.cancel(),d()}}},Le="NO_ACCESS_TOKEN";function Fe(u){return u.indexOf("mapbox:")===0}function Ze(u){return x.API_URL_REGEX.test(u)}function qe(u){return x.API_CDN_URL_REGEX.test(u)}function Ne(u){return x.API_STYLE_REGEX.test(u)&&!ot(u)}function ot(u){return x.API_SPRITE_REGEX.test(u)}const Rt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function zt(u){const s=u.match(Rt);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function At(u){const s=u.params.length?`?${u.params.join("&")}`:"";return`${u.protocol}://${u.authority}${u.path}${s}`}const Vn="mapbox.eventData";function Hn(u){if(!u)return null;const s=u.split(".");if(!s||s.length!==3)return null;try{return JSON.parse(decodeURIComponent(f.atob(s[1]).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Gn{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const c=Hn(x.ACCESS_TOKEN);let d="";return d=c&&c.u?f.btoa(encodeURIComponent(c.u).replace(/%([0-9A-F]{2})/g,(m,_)=>String.fromCharCode(+("0x"+_)))):x.ACCESS_TOKEN||"",s?`${Vn}.${s}:${d}`:`${Vn}:${d}`}fetchEventData(){const s=fn("localStorage"),c=this.getStorageKey(),d=this.getStorageKey("uuid");if(s)try{const m=f.localStorage.getItem(c);m&&(this.eventData=JSON.parse(m));const _=f.localStorage.getItem(d);_&&(this.anonId=_)}catch{nt("Unable to read from LocalStorage")}}saveEventData(){const s=fn("localStorage"),c=this.getStorageKey(),d=this.getStorageKey("uuid");if(s)try{f.localStorage.setItem(d,this.anonId),Object.keys(this.eventData).length>=1&&f.localStorage.setItem(c,JSON.stringify(this.eventData))}catch{nt("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,c,d,m){if(!x.EVENTS_URL)return;const _=zt(x.EVENTS_URL);_.params.push(`access_token=${m||x.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(s).toISOString()},I=c?xt(E,c):E,P={url:At(_),headers:{"Content-Type":"text/plain"},body:JSON.stringify([I])};this.pendingRequest=function(A,N){return Wo(xt(A,{method:"POST"}),N)}(P,A=>{this.pendingRequest=null,d(A),this.saveEventData(),this.processRequests(m)})}queueRequest(s,c){this.queue.push(s),this.processRequests(c)}}const Yn=new class extends Gn{constructor(u){super("appUserTurnstile"),this._customAccessToken=u}postTurnstileEvent(u,s){x.EVENTS_URL&&x.ACCESS_TOKEN&&Array.isArray(u)&&u.some(c=>Fe(c)||Ze(c))&&this.queueRequest(Date.now(),s)}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=Hn(x.ACCESS_TOKEN),c=s?s.u:x.ACCESS_TOKEN;let d=c!==this.eventData.tokenU;Vt(this.anonId)||(this.anonId=Je(),d=!0);const m=this.queue.shift();if(this.eventData.lastSuccess){const _=new Date(this.eventData.lastSuccess),E=new Date(m),I=(m-this.eventData.lastSuccess)/864e5;d=d||I>=1||I<-1||_.getDate()!==E.getDate()}else d=!0;d?this.postEvent(m,{sdkIdentifier:"mapbox-gl-js",sdkVersion:p,skuId:M,"enabled.telemetry":!1,userId:this.anonId},_=>{_||(this.eventData.lastSuccess=m,this.eventData.tokenU=c)},u):this.processRequests()}},lr=Yn.postTurnstileEvent.bind(Yn),$i=new class extends Gn{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(u,s,c,d){this.skuToken=s,this.errorCb=d,x.EVENTS_URL&&(c||x.ACCESS_TOKEN?this.queueRequest({id:u,timestamp:Date.now()},c):this.errorCb(new Error(Le)))}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:c}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),Vt(this.anonId)||(this.anonId=Je()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:p,skuId:M,skuToken:this.skuToken,userId:this.anonId},d=>{d?this.errorCb(d):s&&(this.success[s]=!0)},u))}},_o=$i.postMapLoadEvent.bind($i),Ia=new class extends Gn{constructor(){super("gljs.performance")}postPerformanceEvent(u,s){x.EVENTS_URL&&(u||x.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},u)}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,performanceData:c}=this.queue.shift(),d=function(m){const _=f.performance.getEntriesByType("resource"),E=f.performance.getEntriesByType("mark"),I=function($){const W={};if($){for(const J in $)if(J!=="other")for(const te of $[J]){const se=`${J}ResolveRangeMin`,me=`${J}ResolveRangeMax`,Ie=`${J}RequestCount`,ye=`${J}RequestCachedCount`;W[se]=Math.min(W[se]||1/0,te.startTime),W[me]=Math.max(W[me]||-1/0,te.responseEnd);const Se=Me=>{W[Me]===void 0&&(W[Me]=0),++W[Me]};te.transferSize!==void 0&&te.transferSize===0&&Se(ye),Se(Ie)}}return W}(function($,W){const J={};if($)for(const te of $){const se=W(te);J[se]===void 0&&(J[se]=[]),J[se].push(te)}return J}(_,c1)),P=f.devicePixelRatio,A=f.navigator.connection||f.navigator.mozConnection||f.navigator.webkitConnection,N={counters:[],metadata:[],attributes:[]},G=($,W,J)=>{J!=null&&$.push({name:W,value:J.toString()})};for(const $ in I)G(N.counters,$,I[$]);if(m.interactionRange[0]!==1/0&&m.interactionRange[1]!==-1/0&&(G(N.counters,"interactionRangeMin",m.interactionRange[0]),G(N.counters,"interactionRangeMax",m.interactionRange[1])),E)for(const $ of Object.keys(df)){const W=df[$],J=E.find(te=>te.name===W);J&&G(N.counters,W,J.startTime)}return G(N.counters,"visibilityHidden",m.visibilityHidden),G(N.attributes,"style",function($){if($)for(const W of $){const J=W.name.split("?")[0];if(Ne(J)){const te=J.split("/").slice(-2);if(te.length===2)return`mapbox://styles/${te[0]}/${te[1]}`}}}(_)),G(N.attributes,"terrainEnabled",m.terrainEnabled?"true":"false"),G(N.attributes,"fogEnabled",m.fogEnabled?"true":"false"),G(N.attributes,"projection",m.projection),G(N.attributes,"zoom",m.zoom),G(N.metadata,"devicePixelRatio",P),G(N.metadata,"connectionEffectiveType",A?A.effectiveType:void 0),G(N.metadata,"navigatorUserAgent",f.navigator.userAgent),G(N.metadata,"screenWidth",f.screen.width),G(N.metadata,"screenHeight",f.screen.height),G(N.metadata,"windowWidth",f.innerWidth),G(N.metadata,"windowHeight",f.innerHeight),G(N.metadata,"mapWidth",m.width/P),G(N.metadata,"mapHeight",m.height/P),G(N.metadata,"webglRenderer",m.renderer),G(N.metadata,"webglVendor",m.vendor),G(N.metadata,"sdkVersion",p),G(N.metadata,"sdkIdentifier","mapbox-gl-js"),N}(c);for(const m of d.metadata);for(const m of d.counters);for(const m of d.attributes);this.postEvent(s,d,()=>{},u)}},No=Ia.postPerformanceEvent.bind(Ia),Gl=new class extends Gn{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(u,s,c,d){if(!x.API_URL||!x.SESSION_PATH)return;const m=zt(x.API_URL+x.SESSION_PATH);m.params.push(`sku=${s||""}`),m.params.push(`access_token=${d||x.ACCESS_TOKEN||""}`);const _={url:At(m),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(E,I){return Wo(xt(E,{method:"GET"}),I)}(_,E=>{this.pendingRequest=null,c(E),this.saveEventData(),this.processRequests(d)})}getSessionAPI(u,s,c,d){this.skuToken=s,this.errorCb=d,x.SESSION_PATH&&x.API_URL&&(c||x.ACCESS_TOKEN?this.queueRequest({id:u,timestamp:Date.now()},c):this.errorCb(new Error(Le)))}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:c}=this.queue.shift();s&&this.success[s]||this.getSession(c,this.skuToken,d=>{d?this.errorCb(d):s&&(this.success[s]=!0)},u)}},Ho=Gl.getSessionAPI.bind(Gl),Xa=new Set,df={create:"create",load:"load",fullLoad:"fullLoad"},dE={mark(u){f.performance.mark(u)},measure(u,s,c){f.performance.measure(u,s,c)}};function c1(u){const s=u.name.split("?")[0];return qe(s)&&s.includes("mapbox-gl.js")?"javascript":qe(s)&&s.includes("mapbox-gl.css")?"css":function(c){return x.API_FONTS_REGEX.test(c)}(s)?"fontRange":ot(s)?"sprite":Ne(s)?"style":function(c){return x.API_TILEJSON_REGEX.test(c)}(s)?"tilejson":"other"}const Kr=f.performance;function qy(u){const s=u?u.url.toString():void 0;return Kr.getEntriesByName(s)}let Id,Zy,_g,$l;const Bu={now:()=>_g!==void 0?_g:f.performance.now(),setNow(u){_g=u},restoreNow(){_g=void 0},frame(u){const s=f.requestAnimationFrame(u);return{cancel:()=>f.cancelAnimationFrame(s)}},getImageData(u,s=0){const{width:c,height:d}=u;$l||($l=f.document.createElement("canvas"));const m=$l.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(c>$l.width||d>$l.height)&&($l.width=c,$l.height=d),m.clearRect(-s,-s,c+2*s,d+2*s),m.drawImage(u,0,0,c,d),m.getImageData(-s,-s,c+2*s,d+2*s)},resolveURL:u=>(Id||(Id=f.document.createElement("a")),Id.href=u,Id.href),get devicePixelRatio(){return f.devicePixelRatio},get prefersReducedMotion(){return!!f.matchMedia&&(Zy==null&&(Zy=f.matchMedia("(prefers-reduced-motion: reduce)")),Zy.matches)}};function Xy(u,s,c){c[u]&&c[u].indexOf(s)!==-1||(c[u]=c[u]||[],c[u].push(s))}function Wy(u,s,c){if(c&&c[u]){const d=c[u].indexOf(s);d!==-1&&c[u].splice(d,1)}}class fh{constructor(s,c={}){xt(this,c),this.type=s}}class zu extends fh{constructor(s,c={}){super("error",xt({error:s},c))}}class Cd{on(s,c){return this._listeners=this._listeners||{},Xy(s,c,this._listeners),this}off(s,c){return Wy(s,c,this._listeners),Wy(s,c,this._oneTimeListeners),this}once(s,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},Xy(s,c,this._oneTimeListeners),this):new Promise(d=>this.once(s,d))}fire(s,c){typeof s=="string"&&(s=new fh(s,c||{}));const d=s.type;if(this.listens(d)){s.target=this;const m=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const I of m)I.call(this,s);const _=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const I of _)Wy(d,I,this._oneTimeListeners),I.call(this,s);const E=this._eventedParent;E&&(xt(s,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(s))}else s instanceof zu&&console.error(s.error);return this}listens(s){return!!(this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s))}setEventedParent(s,c){return this._eventedParent=s,this._eventedParentData=c,this}}var ct=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Uu(u,...s){for(const c of s)for(const d in c)u[d]=c[d];return u}function xo(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function Yo(u){if(Array.isArray(u))return u.map(Yo);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const s={};for(const c in u)s[c]=Yo(u[c]);return s}return xo(u)}class h1 extends Error{constructor(s,c){super(c),this.message=c,this.key=s}}var jl=h1;class Hy{constructor(s,c=[]){this.parent=s,this.bindings={};for(const[d,m]of c)this.bindings[d]=m}concat(s){return new Hy(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}var f1=Hy;const pf={kind:"null"},Ht={kind:"number"},ar={kind:"string"},Qn={kind:"boolean"},Is={kind:"color"},gl={kind:"object"},er={kind:"value"},Cs={kind:"collator"},Pd={kind:"formatted"},dh={kind:"resolvedImage"};function Gs(u,s){return{kind:"array",itemType:u,N:s}}function Ni(u){if(u.kind==="array"){const s=Ni(u.itemType);return typeof u.N=="number"?`array<${s}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${s}>`}return u.kind}const d1=[pf,Ht,ar,Qn,Is,Pd,gl,Gs(er),dh];function Vu(u,s){if(s.kind==="error")return null;if(u.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!Vu(u.itemType,s.itemType))&&(typeof u.N!="number"||u.N===s.N))return null}else{if(u.kind===s.kind)return null;if(u.kind==="value"){for(const c of d1)if(!Vu(c,s))return null}}return`Expected ${Ni(u)} but found ${Ni(s)} instead.`}function Ad(u,s){return s.some(c=>c.kind===u.kind)}function Md(u,s){return s.some(c=>c==="null"?u===null:c==="array"?Array.isArray(u):c==="object"?u&&!Array.isArray(u)&&typeof u=="object":c===typeof u)}var Yy,p1={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ld(u){return(u=Math.round(u))<0?0:u>255?255:u}function Od(u){return Ld(u[u.length-1]==="%"?parseFloat(u)/100*255:parseInt(u))}function xg(u){return(s=u[u.length-1]==="%"?parseFloat(u)/100:parseFloat(u))<0?0:s>1?1:s;var s}function gf(u,s,c){return c<0?c+=1:c>1&&(c-=1),6*c<1?u+(s-u)*c*6:2*c<1?s:3*c<2?u+(s-u)*(2/3-c)*6:u}try{Yy={}.parseCSSColor=function(u){var s,c=u.replace(/ /g,"").toLowerCase();if(c in p1)return p1[c].slice();if(c[0]==="#")return c.length===4?(s=parseInt(c.substr(1),16))>=0&&s<=4095?[(3840&s)>>4|(3840&s)>>8,240&s|(240&s)>>4,15&s|(15&s)<<4,1]:null:c.length===7&&(s=parseInt(c.substr(1),16))>=0&&s<=16777215?[(16711680&s)>>16,(65280&s)>>8,255&s,1]:null;var d=c.indexOf("("),m=c.indexOf(")");if(d!==-1&&m+1===c.length){var _=c.substr(0,d),E=c.substr(d+1,m-(d+1)).split(","),I=1;switch(_){case"rgba":if(E.length!==4)return null;I=xg(E.pop());case"rgb":return E.length!==3?null:[Od(E[0]),Od(E[1]),Od(E[2]),I];case"hsla":if(E.length!==4)return null;I=xg(E.pop());case"hsl":if(E.length!==3)return null;var P=(parseFloat(E[0])%360+360)%360/360,A=xg(E[1]),N=xg(E[2]),G=N<=.5?N*(A+1):N+A-N*A,$=2*N-G;return[Ld(255*gf($,G,P+1/3)),Ld(255*gf($,G,P)),Ld(255*gf($,G,P-1/3)),I];default:return null}}return null}}catch{}class is{constructor(s,c,d,m=1){this.r=s,this.g=c,this.b=d,this.a=m}static parse(s){if(!s)return;if(s instanceof is)return s;if(typeof s!="string")return;const c=Yy(s);return c?new is(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3]):void 0}toString(){const[s,c,d,m]=this.toArray();return`rgba(${Math.round(s)},${Math.round(c)},${Math.round(d)},${m})`}toArray(){const{r:s,g:c,b:d,a:m}=this;return m===0?[0,0,0,0]:[255*s/m,255*c/m,255*d/m,m]}toArray01(){const{r:s,g:c,b:d,a:m}=this;return m===0?[0,0,0,0]:[s/m,c/m,d/m,m]}toArray01PremultipliedAlpha(){const{r:s,g:c,b:d,a:m}=this;return[s,c,d,m]}}is.black=new is(0,0,0,1),is.white=new is(1,1,1,1),is.transparent=new is(0,0,0,0),is.red=new is(1,0,0,1),is.blue=new is(0,0,1,1);var uo=is;class Ky{constructor(s,c,d){this.sensitivity=s?c?"variant":"case":c?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,c){return this.collator.compare(s,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Jy{constructor(s,c,d,m,_){this.text=s.normalize?s.normalize():s,this.image=c,this.scale=d,this.fontStack=m,this.textColor=_}}class os{constructor(s){this.sections=s}static fromString(s){return new os([new Jy(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.name.length!==0)}static factory(s){return s instanceof os?s:os.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}serialize(){const s=["format"];for(const c of this.sections){if(c.image){s.push(["image",c.image.name]);continue}s.push(c.text);const d={};c.fontStack&&(d["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(d["font-scale"]=c.scale),c.textColor&&(d["text-color"]=["rgba"].concat(c.textColor.toArray())),s.push(d)}return s}}class $s{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new $s({name:s,available:!1}):null}serialize(){return["image",this.name]}}function g1(u,s,c,d){return typeof u=="number"&&u>=0&&u<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof c=="number"&&c>=0&&c<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[u,s,c,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[u,s,c,d]:[u,s,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Dd(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof uo||u instanceof Ky||u instanceof os||u instanceof $s)return!0;if(Array.isArray(u)){for(const s of u)if(!Dd(s))return!1;return!0}if(typeof u=="object"){for(const s in u)if(!Dd(u[s]))return!1;return!0}return!1}function eo(u){if(u===null)return pf;if(typeof u=="string")return ar;if(typeof u=="boolean")return Qn;if(typeof u=="number")return Ht;if(u instanceof uo)return Is;if(u instanceof Ky)return Cs;if(u instanceof os)return Pd;if(u instanceof $s)return dh;if(Array.isArray(u)){const s=u.length;let c;for(const d of u){const m=eo(d);if(c){if(c===m)continue;c=er;break}c=m}return Gs(c||er,s)}return gl}function Rd(u){const s=typeof u;return u===null?"":s==="string"||s==="number"||s==="boolean"?String(u):u instanceof uo||u instanceof os||u instanceof $s?u.toString():JSON.stringify(u)}class Qy{constructor(s,c){this.type=s,this.value=c}static parse(s,c){if(s.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!Dd(s[1]))return c.error("invalid value");const d=s[1];let m=eo(d);const _=c.expectedType;return m.kind!=="array"||m.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(m=_),new Qy(m,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof uo?["rgba"].concat(this.value.toArray()):this.value instanceof os?this.value.serialize():this.value}}var ph=Qy,pa=class{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}};const ev={string:ar,number:Ht,boolean:Qn,object:gl};class tv{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");let d,m=1;const _=s[0];if(_==="array"){let I,P;if(s.length>2){const A=s[1];if(typeof A!="string"||!(A in ev)||A==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);I=ev[A],m++}else I=er;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return c.error('The length argument to "array" must be a positive integer literal',2);P=s[2],m++}d=Gs(I,P)}else d=ev[_];const E=[];for(;m<s.length;m++){const I=c.parse(s[m],m,er);if(!I)return null;E.push(I)}return new tv(d,E)}evaluate(s){for(let c=0;c<this.args.length;c++){const d=this.args[c].evaluate(s);if(!Vu(this.type,eo(d)))return d;if(c===this.args.length-1)throw new pa(`Expected value to be of type ${Ni(this.type)}, but found ${Ni(eo(d))} instead.`)}return null}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=this.type,c=[s.kind];if(s.kind==="array"){const d=s.itemType;if(d.kind==="string"||d.kind==="number"||d.kind==="boolean"){c.push(d.kind);const m=s.N;(typeof m=="number"||this.args.length>1)&&c.push(m)}}return c.concat(this.args.map(d=>d.serialize()))}}var Gu=tv;class Pc{constructor(s){this.type=Pd,this.sections=s}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const d=s[1];if(!Array.isArray(d)&&typeof d=="object")return c.error("First argument must be an image or text section.");const m=[];let _=!1;for(let E=1;E<=s.length-1;++E){const I=s[E];if(_&&typeof I=="object"&&!Array.isArray(I)){_=!1;let P=null;if(I["font-scale"]&&(P=c.parse(I["font-scale"],1,Ht),!P))return null;let A=null;if(I["text-font"]&&(A=c.parse(I["text-font"],1,Gs(ar)),!A))return null;let N=null;if(I["text-color"]&&(N=c.parse(I["text-color"],1,Is),!N))return null;const G=m[m.length-1];G.scale=P,G.font=A,G.textColor=N}else{const P=c.parse(s[E],1,er);if(!P)return null;const A=P.type.kind;if(A!=="string"&&A!=="value"&&A!=="null"&&A!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,m.push({content:P,scale:null,font:null,textColor:null})}}return new Pc(m)}evaluate(s){return new os(this.sections.map(c=>{const d=c.content.evaluate(s);return eo(d)===dh?new Jy("",d,null,null,null):new Jy(Rd(d),null,c.scale?c.scale.evaluate(s):null,c.font?c.font.evaluate(s).join(","):null,c.textColor?c.textColor.evaluate(s):null)}))}eachChild(s){for(const c of this.sections)s(c.content),c.scale&&s(c.scale),c.font&&s(c.font),c.textColor&&s(c.textColor)}outputDefined(){return!1}serialize(){const s=["format"];for(const c of this.sections){s.push(c.content.serialize());const d={};c.scale&&(d["font-scale"]=c.scale.serialize()),c.font&&(d["text-font"]=c.font.serialize()),c.textColor&&(d["text-color"]=c.textColor.serialize()),s.push(d)}return s}}class bg{constructor(s){this.type=dh,this.input=s}static parse(s,c){if(s.length!==2)return c.error("Expected two arguments.");const d=c.parse(s[1],1,ar);return d?new bg(d):c.error("No image name provided.")}evaluate(s){const c=this.input.evaluate(s),d=$s.fromString(c);return d&&s.availableImages&&(d.available=s.availableImages.indexOf(c)>-1),d}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const pE={"to-boolean":Qn,"to-color":Is,"to-number":Ht,"to-string":ar};class nv{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const d=s[0];if((d==="to-boolean"||d==="to-string")&&s.length!==2)return c.error("Expected one argument.");const m=pE[d],_=[];for(let E=1;E<s.length;E++){const I=c.parse(s[E],E,er);if(!I)return null;_.push(I)}return new nv(m,_)}evaluate(s){if(this.type.kind==="boolean")return!!this.args[0].evaluate(s);if(this.type.kind==="color"){let c,d;for(const m of this.args){if(c=m.evaluate(s),d=null,c instanceof uo)return c;if(typeof c=="string"){const _=s.parseColor(c);if(_)return _}else if(Array.isArray(c)&&(d=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:g1(c[0],c[1],c[2],c[3]),!d))return new uo(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new pa(d||`Could not parse color from value '${typeof c=="string"?c:String(JSON.stringify(c))}'`)}if(this.type.kind==="number"){let c=null;for(const d of this.args){if(c=d.evaluate(s),c===null)return 0;const m=Number(c);if(!isNaN(m))return m}throw new pa(`Could not convert ${JSON.stringify(c)} to number.`)}return this.type.kind==="formatted"?os.fromString(Rd(this.args[0].evaluate(s))):this.type.kind==="resolvedImage"?$s.fromString(Rd(this.args[0].evaluate(s))):Rd(this.args[0].evaluate(s))}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Pc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new bg(this.args[0]).serialize();const s=[`to-${this.type.kind}`];return this.eachChild(c=>{s.push(c.serialize())}),s}}var mf=nv;const ql=["Unknown","Point","LineString","Polygon"];var rv=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ql[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const u=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:c,y:d}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*s-u[0])+this.featureDistanceData.bearing[1]*(d*s-u[1])}return 0}parseColor(u){let s=this._parseColorCache[u];return s||(s=this._parseColorCache[u]=uo.parse(u)),s}};class gh{constructor(s,c,d,m){this.name=s,this.type=c,this._evaluate=d,this.args=m}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(s=>s.serialize()))}static parse(s,c){const d=s[0],m=gh.definitions[d];if(!m)return c.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(m)?m[0]:m.type,E=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,I=E.filter(([A])=>!Array.isArray(A)||A.length===s.length-1);let P=null;for(const[A,N]of I){P=new uv(c.registry,c.path,null,c.scope);const G=[];let $=!1;for(let W=1;W<s.length;W++){const J=s[W],te=Array.isArray(A)?A[W-1]:A.type,se=P.parse(J,1+G.length,te);if(!se){$=!0;break}G.push(se)}if(!$)if(Array.isArray(A)&&A.length!==G.length)P.error(`Expected ${A.length} arguments, but found ${G.length} instead.`);else{for(let W=0;W<G.length;W++){const J=Array.isArray(A)?A[W]:A.type,te=G[W];P.concat(W+1).checkSubtype(J,te.type)}if(P.errors.length===0)return new gh(d,_,N,G)}}if(I.length===1)c.errors.push(...P.errors);else{const A=(I.length?I:E).map(([G])=>{return $=G,Array.isArray($)?`(${$.map(Ni).join(", ")})`:`(${Ni($.type)}...)`;var $}).join(" | "),N=[];for(let G=1;G<s.length;G++){const $=c.parse(s[G],1+N.length);if(!$)return null;N.push(Ni($.type))}c.error(`Expected arguments of type ${A}, but found (${N.join(", ")}) instead.`)}return null}static register(s,c){gh.definitions=c;for(const d in c)s[d]=gh}}var $u=gh;class kd{constructor(s,c,d){this.type=Cs,this.locale=d,this.caseSensitive=s,this.diacriticSensitive=c}static parse(s,c){if(s.length!==2)return c.error("Expected one argument.");const d=s[1];if(typeof d!="object"||Array.isArray(d))return c.error("Collator options argument must be an object.");const m=c.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,Qn);if(!m)return null;const _=c.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,Qn);if(!_)return null;let E=null;return d.locale&&(E=c.parse(d.locale,1,ar),!E)?null:new kd(m,_,E)}evaluate(s){return new Ky(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}serialize(){const s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]}}const ju=8192;function wg(u,s){u[0]=Math.min(u[0],s[0]),u[1]=Math.min(u[1],s[1]),u[2]=Math.max(u[2],s[0]),u[3]=Math.max(u[3],s[1])}function yf(u,s){return!(u[0]<=s[0]||u[2]>=s[2]||u[1]<=s[1]||u[3]>=s[3])}function Nd(u,s){const c=(180+u[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,m=Math.pow(2,s.z);return[Math.round(c*m*ju),Math.round(d*m*ju)]}function m1(u,s,c){const d=u[0]-s[0],m=u[1]-s[1],_=u[0]-c[0],E=u[1]-c[1];return d*E-_*m==0&&d*_<=0&&m*E<=0}function Eg(u,s){let c=!1;for(let E=0,I=s.length;E<I;E++){const P=s[E];for(let A=0,N=P.length;A<N-1;A++){if(m1(u,P[A],P[A+1]))return!1;(m=P[A])[1]>(d=u)[1]!=(_=P[A+1])[1]>d[1]&&d[0]<(_[0]-m[0])*(d[1]-m[1])/(_[1]-m[1])+m[0]&&(c=!c)}}var d,m,_;return c}function iv(u,s){for(let c=0;c<s.length;c++)if(Eg(u,s[c]))return!0;return!1}function ov(u,s,c,d){const m=d[0]-c[0],_=d[1]-c[1],E=(u[0]-c[0])*_-m*(u[1]-c[1]),I=(s[0]-c[0])*_-m*(s[1]-c[1]);return E>0&&I<0||E<0&&I>0}function vf(u,s,c){for(const A of c)for(let N=0;N<A.length-1;++N)if((I=[(E=A[N+1])[0]-(_=A[N])[0],E[1]-_[1]])[0]*(P=[(m=s)[0]-(d=u)[0],m[1]-d[1]])[1]-I[1]*P[0]!=0&&ov(d,m,_,E)&&ov(_,E,d,m))return!0;var d,m,_,E,I,P;return!1}function Jr(u,s){for(let c=0;c<u.length;++c)if(!Eg(u[c],s))return!1;for(let c=0;c<u.length-1;++c)if(vf(u[c],u[c+1],s))return!1;return!0}function gE(u,s){for(let c=0;c<s.length;c++)if(Jr(u,s[c]))return!0;return!1}function av(u,s,c){const d=[];for(let m=0;m<u.length;m++){const _=[];for(let E=0;E<u[m].length;E++){const I=Nd(u[m][E],c);wg(s,I),_.push(I)}d.push(_)}return d}function y1(u,s,c){const d=[];for(let m=0;m<u.length;m++){const _=av(u[m],s,c);d.push(_)}return d}function sv(u,s,c,d){if(u[0]<c[0]||u[0]>c[2]){const m=.5*d;let _=u[0]-c[0]>m?-d:c[0]-u[0]>m?d:0;_===0&&(_=u[0]-c[2]>m?-d:c[2]-u[0]>m?d:0),u[0]+=_}wg(s,u)}function v1(u,s,c,d){const m=Math.pow(2,d.z)*ju,_=[d.x*ju,d.y*ju],E=[];if(!u)return E;for(const I of u)for(const P of I){const A=[P.x+_[0],P.y+_[1]];sv(A,s,c,m),E.push(A)}return E}function lv(u,s,c,d){const m=Math.pow(2,d.z)*ju,_=[d.x*ju,d.y*ju],E=[];if(!u)return E;for(const P of u){const A=[];for(const N of P){const G=[N.x+_[0],N.y+_[1]];wg(s,G),A.push(G)}E.push(A)}if(s[2]-s[0]<=m/2){(I=s)[0]=I[1]=1/0,I[2]=I[3]=-1/0;for(const P of E)for(const A of P)sv(A,s,c,m)}var I;return E}class _f{constructor(s,c){this.type=Qn,this.geojson=s,this.geometries=c}static parse(s,c){if(s.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(Dd(s[1])){const d=s[1];if(d.type==="FeatureCollection")for(let m=0;m<d.features.length;++m){const _=d.features[m].geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new _f(d,d.features[m].geometry)}else if(d.type==="Feature"){const m=d.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new _f(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new _f(d,d)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(c,d){const m=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],E=c.canonicalID();if(!E)return!1;if(d.type==="Polygon"){const I=av(d.coordinates,_,E),P=v1(c.geometry(),m,_,E);if(!yf(m,_))return!1;for(const A of P)if(!Eg(A,I))return!1}if(d.type==="MultiPolygon"){const I=y1(d.coordinates,_,E),P=v1(c.geometry(),m,_,E);if(!yf(m,_))return!1;for(const A of P)if(!iv(A,I))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(c,d){const m=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],E=c.canonicalID();if(!E)return!1;if(d.type==="Polygon"){const I=av(d.coordinates,_,E),P=lv(c.geometry(),m,_,E);if(!yf(m,_))return!1;for(const A of P)if(!Jr(A,I))return!1}if(d.type==="MultiPolygon"){const I=y1(d.coordinates,_,E),P=lv(c.geometry(),m,_,E);if(!yf(m,_))return!1;for(const A of P)if(!gE(A,I))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Sg=_f;function xf(u){if(u instanceof $u&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof Sg)return!1;let s=!0;return u.eachChild(c=>{s&&!xf(c)&&(s=!1)}),s}function qu(u){if(u instanceof $u&&u.name==="feature-state")return!1;let s=!0;return u.eachChild(c=>{s&&!qu(c)&&(s=!1)}),s}function mh(u,s){if(u instanceof $u&&s.indexOf(u.name)>=0)return!1;let c=!0;return u.eachChild(d=>{c&&!mh(d,s)&&(c=!1)}),c}class Tg{constructor(s,c){this.type=c.type,this.name=s,this.boundExpression=c}static parse(s,c){if(s.length!==2||typeof s[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const d=s[1];return c.scope.has(d)?new Tg(d,c.scope.get(d)):c.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var _1=Tg;class Fd{constructor(s,c=[],d,m=new f1,_=[]){this.registry=s,this.path=c,this.key=c.map(E=>`[${E}]`).join(""),this.scope=m,this.errors=_,this.expectedType=d}parse(s,c,d,m,_={}){return c?this.concat(c,d,m)._parse(s,_):this._parse(s,_)}_parse(s,c){function d(m,_,E){return E==="assert"?new Gu(_,[m]):E==="coerce"?new mf(_,[m]):m}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=s[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[m];if(_){let E=_.parse(s,this);if(!E)return null;if(this.expectedType){const I=this.expectedType,P=E.type;if(I.kind!=="string"&&I.kind!=="number"&&I.kind!=="boolean"&&I.kind!=="object"&&I.kind!=="array"||P.kind!=="value")if(I.kind!=="color"&&I.kind!=="formatted"&&I.kind!=="resolvedImage"||P.kind!=="value"&&P.kind!=="string"){if(this.checkSubtype(I,P))return null}else E=d(E,I,c.typeAnnotation||"coerce");else E=d(E,I,c.typeAnnotation||"assert")}if(!(E instanceof ph)&&E.type.kind!=="resolvedImage"&&cv(E)){const I=new rv;try{E=new ph(E.type,E.evaluate(I))}catch(P){return this.error(P.message),null}}return E}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,c,d){const m=typeof s=="number"?this.path.concat(s):this.path,_=d?this.scope.concat(d):this.scope;return new Fd(this.registry,m,c||null,_,this.errors)}error(s,...c){const d=`${this.key}${c.map(m=>`[${m}]`).join("")}`;this.errors.push(new jl(d,s))}checkSubtype(s,c){const d=Vu(s,c);return d&&this.error(d),d}}var uv=Fd;function cv(u){if(u instanceof _1)return cv(u.boundExpression);if(u instanceof $u&&u.name==="error"||u instanceof kd||u instanceof Sg)return!1;const s=u instanceof mf||u instanceof Gu;let c=!0;return u.eachChild(d=>{c=s?c&&cv(d):c&&d instanceof ph}),!!c&&xf(u)&&mh(u,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Ig(u,s){const c=u.length-1;let d,m,_=0,E=c,I=0;for(;_<=E;)if(I=Math.floor((_+E)/2),d=u[I],m=u[I+1],d<=s){if(I===c||s<m)return I;_=I+1}else{if(!(d>s))throw new pa("Input is not a number.");E=I-1}return 0}class Cg{constructor(s,c,d){this.type=s,this.input=c,this.labels=[],this.outputs=[];for(const[m,_]of d)this.labels.push(m),this.outputs.push(_)}static parse(s,c){if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");const d=c.parse(s[1],1,Ht);if(!d)return null;const m=[];let _=null;c.expectedType&&c.expectedType.kind!=="value"&&(_=c.expectedType);for(let E=1;E<s.length;E+=2){const I=E===1?-1/0:s[E],P=s[E+1],A=E,N=E+1;if(typeof I!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(m.length&&m[m.length-1][0]>=I)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const G=c.parse(P,N,_);if(!G)return null;_=_||G.type,m.push([I,G])}return new Cg(_,d,m)}evaluate(s){const c=this.labels,d=this.outputs;if(c.length===1)return d[0].evaluate(s);const m=this.input.evaluate(s);if(m<=c[0])return d[0].evaluate(s);const _=c.length;return m>=c[_-1]?d[_-1].evaluate(s):d[Ig(c,m)].evaluate(s)}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){const s=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&s.push(this.labels[c]),s.push(this.outputs[c].serialize());return s}}var hv=Cg;function mr(u,s,c){return u*(1-c)+s*c}var Bd=Object.freeze({__proto__:null,array:function(u,s,c){return u.map((d,m)=>mr(d,s[m],c))},color:function(u,s,c){return new uo(mr(u.r,s.r,c),mr(u.g,s.g,c),mr(u.b,s.b,c),mr(u.a,s.a,c))},number:mr});const x1=.95047,fv=1.08883,b1=4/29,yh=6/29,dv=3*yh*yh,mE=yh*yh*yh,yE=Math.PI/180,vE=180/Math.PI;function pv(u){return u>mE?Math.pow(u,1/3):u/dv+b1}function gv(u){return u>yh?u*u*u:dv*(u-b1)}function mv(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function Pg(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function w1(u){const s=Pg(u.r),c=Pg(u.g),d=Pg(u.b),m=pv((.4124564*s+.3575761*c+.1804375*d)/x1),_=pv((.2126729*s+.7151522*c+.072175*d)/1);return{l:116*_-16,a:500*(m-_),b:200*(_-pv((.0193339*s+.119192*c+.9503041*d)/fv)),alpha:u.a}}function E1(u){let s=(u.l+16)/116,c=isNaN(u.a)?s:s+u.a/500,d=isNaN(u.b)?s:s-u.b/200;return s=1*gv(s),c=x1*gv(c),d=fv*gv(d),new uo(mv(3.2404542*c-1.5371385*s-.4985314*d),mv(-.969266*c+1.8760108*s+.041556*d),mv(.0556434*c-.2040259*s+1.0572252*d),u.alpha)}function _E(u,s,c){const d=s-u;return u+c*(d>180||d<-180?d-360*Math.round(d/360):d)}const zd={forward:w1,reverse:E1,interpolate:function(u,s,c){return{l:mr(u.l,s.l,c),a:mr(u.a,s.a,c),b:mr(u.b,s.b,c),alpha:mr(u.alpha,s.alpha,c)}}},bf={forward:function(u){const{l:s,a:c,b:d}=w1(u),m=Math.atan2(d,c)*vE;return{h:m<0?m+360:m,c:Math.sqrt(c*c+d*d),l:s,alpha:u.a}},reverse:function(u){const s=u.h*yE,c=u.c;return E1({l:u.l,a:Math.cos(s)*c,b:Math.sin(s)*c,alpha:u.alpha})},interpolate:function(u,s,c){return{h:_E(u.h,s.h,c),c:mr(u.c,s.c,c),l:mr(u.l,s.l,c),alpha:mr(u.alpha,s.alpha,c)}}};var yv=Object.freeze({__proto__:null,hcl:bf,lab:zd});class Ud{constructor(s,c,d,m,_){this.type=s,this.operator=c,this.interpolation=d,this.input=m,this.labels=[],this.outputs=[];for(const[E,I]of _)this.labels.push(E),this.outputs.push(I)}static interpolationFactor(s,c,d,m){let _=0;if(s.name==="exponential")_=vv(c,s.base,d,m);else if(s.name==="linear")_=vv(c,1,d,m);else if(s.name==="cubic-bezier"){const E=s.controlPoints;_=new Y(E[0],E[1],E[2],E[3]).solve(vv(c,1,d,m))}return _}static parse(s,c){let[d,m,_,...E]=s;if(!Array.isArray(m)||m.length===0)return c.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const A=m[1];if(typeof A!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:A}}else{if(m[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const A=m.slice(1);if(A.length!==4||A.some(N=>typeof N!="number"||N<0||N>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:A}}}if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(_=c.parse(_,2,Ht),!_)return null;const I=[];let P=null;d==="interpolate-hcl"||d==="interpolate-lab"?P=Is:c.expectedType&&c.expectedType.kind!=="value"&&(P=c.expectedType);for(let A=0;A<E.length;A+=2){const N=E[A],G=E[A+1],$=A+3,W=A+4;if(typeof N!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(I.length&&I[I.length-1][0]>=N)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const J=c.parse(G,W,P);if(!J)return null;P=P||J.type,I.push([N,J])}return P.kind==="number"||P.kind==="color"||P.kind==="array"&&P.itemType.kind==="number"&&typeof P.N=="number"?new Ud(P,d,m,_,I):c.error(`Type ${Ni(P)} is not interpolatable.`)}evaluate(s){const c=this.labels,d=this.outputs;if(c.length===1)return d[0].evaluate(s);const m=this.input.evaluate(s);if(m<=c[0])return d[0].evaluate(s);const _=c.length;if(m>=c[_-1])return d[_-1].evaluate(s);const E=Ig(c,m),I=Ud.interpolationFactor(this.interpolation,m,c[E],c[E+1]),P=d[E].evaluate(s),A=d[E+1].evaluate(s);return this.operator==="interpolate"?Bd[this.type.kind.toLowerCase()](P,A,I):this.operator==="interpolate-hcl"?bf.reverse(bf.interpolate(bf.forward(P),bf.forward(A),I)):zd.reverse(zd.interpolate(zd.forward(P),zd.forward(A),I))}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){let s;s=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const c=[this.operator,s,this.input.serialize()];for(let d=0;d<this.labels.length;d++)c.push(this.labels[d],this.outputs[d].serialize());return c}}function vv(u,s,c,d){const m=d-c,_=u-c;return m===0?0:s===1?_/m:(Math.pow(s,_)-1)/(Math.pow(s,m)-1)}var Zl=Ud;class Ag{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expectected at least one argument.");let d=null;const m=c.expectedType;m&&m.kind!=="value"&&(d=m);const _=[];for(const I of s.slice(1)){const P=c.parse(I,1+_.length,d,void 0,{typeAnnotation:"omit"});if(!P)return null;d=d||P.type,_.push(P)}const E=m&&_.some(I=>Vu(m,I.type));return new Ag(E?er:d,_)}evaluate(s){let c,d=null,m=0;for(const _ of this.args){if(m++,d=_.evaluate(s),d&&d instanceof $s&&!d.available&&(c||(c=d),d=null,m===this.args.length))return c;if(d!==null)break}return d}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=["coalesce"];return this.eachChild(c=>{s.push(c.serialize())}),s}}var _v=Ag;class Mg{constructor(s,c){this.type=c.type,this.bindings=[].concat(s),this.result=c}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const c of this.bindings)s(c[1]);s(this.result)}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const d=[];for(let _=1;_<s.length-1;_+=2){const E=s[_];if(typeof E!="string")return c.error(`Expected string, but found ${typeof E} instead.`,_);if(/[^a-zA-Z0-9_]/.test(E))return c.error("Variable names must contain only alphanumeric characters or '_'.",_);const I=c.parse(s[_+1],_+1);if(!I)return null;d.push([E,I])}const m=c.parse(s[s.length-1],s.length-1,c.expectedType,d);return m?new Mg(d,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const s=["let"];for(const[c,d]of this.bindings)s.push(c,d.serialize());return s.push(this.result.serialize()),s}}var S1=Mg;class xv{constructor(s,c,d){this.type=s,this.index=c,this.input=d}static parse(s,c){if(s.length!==3)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,Ht),m=c.parse(s[2],2,Gs(c.expectedType||er));return d&&m?new xv(m.type.itemType,d,m):null}evaluate(s){const c=this.index.evaluate(s),d=this.input.evaluate(s);if(c<0)throw new pa(`Array index out of bounds: ${c} < 0.`);if(c>=d.length)throw new pa(`Array index out of bounds: ${c} > ${d.length-1}.`);if(c!==Math.floor(c))throw new pa(`Array index must be an integer, but found ${c} instead.`);return d[c]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var xE=xv;class bv{constructor(s,c){this.type=Qn,this.needle=s,this.haystack=c}static parse(s,c){if(s.length!==3)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,er),m=c.parse(s[2],2,er);return d&&m?Ad(d.type,[Qn,ar,Ht,pf,er])?new bv(d,m):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ni(d.type)} instead`):null}evaluate(s){const c=this.needle.evaluate(s),d=this.haystack.evaluate(s);if(d==null)return!1;if(!Md(c,["boolean","string","number","null"]))throw new pa(`Expected first argument to be of type boolean, string, number or null, but found ${Ni(eo(c))} instead.`);if(!Md(d,["string","array"]))throw new pa(`Expected second argument to be of type array or string, but found ${Ni(eo(d))} instead.`);return d.indexOf(c)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Lg=bv;class Vd{constructor(s,c,d){this.type=Ht,this.needle=s,this.haystack=c,this.fromIndex=d}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,er),m=c.parse(s[2],2,er);if(!d||!m)return null;if(!Ad(d.type,[Qn,ar,Ht,pf,er]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ni(d.type)} instead`);if(s.length===4){const _=c.parse(s[3],3,Ht);return _?new Vd(d,m,_):null}return new Vd(d,m)}evaluate(s){const c=this.needle.evaluate(s),d=this.haystack.evaluate(s);if(!Md(c,["boolean","string","number","null"]))throw new pa(`Expected first argument to be of type boolean, string, number or null, but found ${Ni(eo(c))} instead.`);if(!Md(d,["string","array"]))throw new pa(`Expected second argument to be of type array or string, but found ${Ni(eo(d))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(s);return d.indexOf(c,m)}return d.indexOf(c)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var T1=Vd;class wv{constructor(s,c,d,m,_,E){this.inputType=s,this.type=c,this.input=d,this.cases=m,this.outputs=_,this.otherwise=E}static parse(s,c){if(s.length<5)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return c.error("Expected an even number of arguments.");let d,m;c.expectedType&&c.expectedType.kind!=="value"&&(m=c.expectedType);const _={},E=[];for(let A=2;A<s.length-1;A+=2){let N=s[A];const G=s[A+1];Array.isArray(N)||(N=[N]);const $=c.concat(A);if(N.length===0)return $.error("Expected at least one branch label.");for(const J of N){if(typeof J!="number"&&typeof J!="string")return $.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return $.error("Numeric branch labels must be integer values.");if(d){if($.checkSubtype(d,eo(J)))return null}else d=eo(J);if(_[String(J)]!==void 0)return $.error("Branch labels must be unique.");_[String(J)]=E.length}const W=c.parse(G,A,m);if(!W)return null;m=m||W.type,E.push(W)}const I=c.parse(s[1],1,er);if(!I)return null;const P=c.parse(s[s.length-1],s.length-1,m);return P?I.type.kind!=="value"&&c.concat(1).checkSubtype(d,I.type)?null:new wv(d,m,I,_,E,P):null}evaluate(s){const c=this.input.evaluate(s);return(eo(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),d=[],m={};for(const E of c){const I=m[this.cases[E]];I===void 0?(m[this.cases[E]]=d.length,d.push([this.cases[E],[E]])):d[I][1].push(E)}const _=E=>this.inputType.kind==="number"?Number(E):E;for(const[E,I]of d)s.push(I.length===1?_(I[0]):I.map(_)),s.push(this.outputs[E].serialize());return s.push(this.otherwise.serialize()),s}}var bE=wv;class Ev{constructor(s,c,d){this.type=s,this.branches=c,this.otherwise=d}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return c.error("Expected an odd number of arguments.");let d;c.expectedType&&c.expectedType.kind!=="value"&&(d=c.expectedType);const m=[];for(let E=1;E<s.length-1;E+=2){const I=c.parse(s[E],E,Qn);if(!I)return null;const P=c.parse(s[E+1],E+1,d);if(!P)return null;m.push([I,P]),d=d||P.type}const _=c.parse(s[s.length-1],s.length-1,d);return _?new Ev(d,m,_):null}evaluate(s){for(const[c,d]of this.branches)if(c.evaluate(s))return d.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[c,d]of this.branches)s(c),s(d);s(this.otherwise)}outputDefined(){return this.branches.every(([s,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["case"];return this.eachChild(c=>{s.push(c.serialize())}),s}}var I1=Ev;class Gd{constructor(s,c,d,m){this.type=s,this.input=c,this.beginIndex=d,this.endIndex=m}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,er),m=c.parse(s[2],2,Ht);if(!d||!m)return null;if(!Ad(d.type,[Gs(er),ar,er]))return c.error(`Expected first argument to be of type array or string, but found ${Ni(d.type)} instead`);if(s.length===4){const _=c.parse(s[3],3,Ht);return _?new Gd(d.type,d,m,_):null}return new Gd(d.type,d,m)}evaluate(s){const c=this.input.evaluate(s),d=this.beginIndex.evaluate(s);if(!Md(c,["string","array"]))throw new pa(`Expected first argument to be of type array or string, but found ${Ni(eo(c))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(s);return c.slice(d,m)}return c.slice(d)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var C1=Gd;function Og(u,s){return u==="=="||u==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function P1(u,s,c,d){return d.compare(s,c)===0}function wf(u,s,c){const d=u!=="=="&&u!=="!=";return class Ck{constructor(_,E,I){this.type=Qn,this.lhs=_,this.rhs=E,this.collator=I,this.hasUntypedArgument=_.type.kind==="value"||E.type.kind==="value"}static parse(_,E){if(_.length!==3&&_.length!==4)return E.error("Expected two or three arguments.");const I=_[0];let P=E.parse(_[1],1,er);if(!P)return null;if(!Og(I,P.type))return E.concat(1).error(`"${I}" comparisons are not supported for type '${Ni(P.type)}'.`);let A=E.parse(_[2],2,er);if(!A)return null;if(!Og(I,A.type))return E.concat(2).error(`"${I}" comparisons are not supported for type '${Ni(A.type)}'.`);if(P.type.kind!==A.type.kind&&P.type.kind!=="value"&&A.type.kind!=="value")return E.error(`Cannot compare types '${Ni(P.type)}' and '${Ni(A.type)}'.`);d&&(P.type.kind==="value"&&A.type.kind!=="value"?P=new Gu(A.type,[P]):P.type.kind!=="value"&&A.type.kind==="value"&&(A=new Gu(P.type,[A])));let N=null;if(_.length===4){if(P.type.kind!=="string"&&A.type.kind!=="string"&&P.type.kind!=="value"&&A.type.kind!=="value")return E.error("Cannot use collator to compare non-string types.");if(N=E.parse(_[3],3,Cs),!N)return null}return new Ck(P,A,N)}evaluate(_){const E=this.lhs.evaluate(_),I=this.rhs.evaluate(_);if(d&&this.hasUntypedArgument){const P=eo(E),A=eo(I);if(P.kind!==A.kind||P.kind!=="string"&&P.kind!=="number")throw new pa(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${P.kind}, ${A.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const P=eo(E),A=eo(I);if(P.kind!=="string"||A.kind!=="string")return s(_,E,I)}return this.collator?c(_,E,I,this.collator.evaluate(_)):s(_,E,I)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[u];return this.eachChild(E=>{_.push(E.serialize())}),_}}}const wE=wf("==",function(u,s,c){return s===c},P1),EE=wf("!=",function(u,s,c){return s!==c},function(u,s,c,d){return!P1(0,s,c,d)}),SE=wf("<",function(u,s,c){return s<c},function(u,s,c,d){return d.compare(s,c)<0}),TE=wf(">",function(u,s,c){return s>c},function(u,s,c,d){return d.compare(s,c)>0}),IE=wf("<=",function(u,s,c){return s<=c},function(u,s,c,d){return d.compare(s,c)<=0}),A1=wf(">=",function(u,s,c){return s>=c},function(u,s,c,d){return d.compare(s,c)>=0});class Dg{constructor(s,c,d,m,_,E){this.type=ar,this.number=s,this.locale=c,this.currency=d,this.unit=m,this.minFractionDigits=_,this.maxFractionDigits=E}static parse(s,c){if(s.length!==3)return c.error("Expected two arguments.");const d=c.parse(s[1],1,Ht);if(!d)return null;const m=s[2];if(typeof m!="object"||Array.isArray(m))return c.error("NumberFormat options argument must be an object.");let _=null;if(m.locale&&(_=c.parse(m.locale,1,ar),!_))return null;let E=null;if(m.currency&&(E=c.parse(m.currency,1,ar),!E))return null;let I=null;if(m.unit&&(I=c.parse(m.unit,1,ar),!I))return null;let P=null;if(m["min-fraction-digits"]&&(P=c.parse(m["min-fraction-digits"],1,Ht),!P))return null;let A=null;return m["max-fraction-digits"]&&(A=c.parse(m["max-fraction-digits"],1,Ht),!A)?null:new Dg(d,_,E,I,P,A)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(s):void 0,unit:this.unit?this.unit.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.unit&&s(this.unit),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.unit&&(s.unit=this.unit.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]}}class Ef{constructor(s){this.type=Ht,this.input=s}static parse(s,c){if(s.length!==2)return c.error(`Expected 1 argument, but found ${s.length-1} instead.`);const d=c.parse(s[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${Ni(d.type)} instead.`):new Ef(d):null}evaluate(s){const c=this.input.evaluate(s);if(typeof c=="string"||Array.isArray(c))return c.length;throw new pa(`Expected value to be of type string or array, but found ${Ni(eo(c))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){const s=["length"];return this.eachChild(c=>{s.push(c.serialize())}),s}}const M1={"==":wE,"!=":EE,">":TE,"<":SE,">=":A1,"<=":IE,array:Gu,at:xE,boolean:Gu,case:I1,coalesce:_v,collator:kd,format:Pc,image:bg,in:Lg,"index-of":T1,interpolate:Zl,"interpolate-hcl":Zl,"interpolate-lab":Zl,length:Ef,let:S1,literal:ph,match:bE,number:Gu,"number-format":Dg,object:Gu,slice:C1,step:hv,string:Gu,"to-boolean":mf,"to-color":mf,"to-number":mf,"to-string":mf,var:_1,within:Sg};function L1(u,[s,c,d,m]){s=s.evaluate(u),c=c.evaluate(u),d=d.evaluate(u);const _=m?m.evaluate(u):1,E=g1(s,c,d,_);if(E)throw new pa(E);return new uo(s/255*_,c/255*_,d/255*_,_)}function Zu(u,s){return u in s}function Rg(u,s){const c=s[u];return c===void 0?null:c}function js(u){return{type:u}}$u.register(M1,{error:[{kind:"error"},[ar],(u,[s])=>{throw new pa(s.evaluate(u))}],typeof:[ar,[er],(u,[s])=>Ni(eo(s.evaluate(u)))],"to-rgba":[Gs(Ht,4),[Is],(u,[s])=>s.evaluate(u).toArray()],rgb:[Is,[Ht,Ht,Ht],L1],rgba:[Is,[Ht,Ht,Ht,Ht],L1],has:{type:Qn,overloads:[[[ar],(u,[s])=>Zu(s.evaluate(u),u.properties())],[[ar,gl],(u,[s,c])=>Zu(s.evaluate(u),c.evaluate(u))]]},get:{type:er,overloads:[[[ar],(u,[s])=>Rg(s.evaluate(u),u.properties())],[[ar,gl],(u,[s,c])=>Rg(s.evaluate(u),c.evaluate(u))]]},"feature-state":[er,[ar],(u,[s])=>Rg(s.evaluate(u),u.featureState||{})],properties:[gl,[],u=>u.properties()],"geometry-type":[ar,[],u=>u.geometryType()],id:[er,[],u=>u.id()],zoom:[Ht,[],u=>u.globals.zoom],pitch:[Ht,[],u=>u.globals.pitch||0],"distance-from-center":[Ht,[],u=>u.distanceFromCenter()],"heatmap-density":[Ht,[],u=>u.globals.heatmapDensity||0],"line-progress":[Ht,[],u=>u.globals.lineProgress||0],"sky-radial-progress":[Ht,[],u=>u.globals.skyRadialProgress||0],accumulated:[er,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Ht,js(Ht),(u,s)=>{let c=0;for(const d of s)c+=d.evaluate(u);return c}],"*":[Ht,js(Ht),(u,s)=>{let c=1;for(const d of s)c*=d.evaluate(u);return c}],"-":{type:Ht,overloads:[[[Ht,Ht],(u,[s,c])=>s.evaluate(u)-c.evaluate(u)],[[Ht],(u,[s])=>-s.evaluate(u)]]},"/":[Ht,[Ht,Ht],(u,[s,c])=>s.evaluate(u)/c.evaluate(u)],"%":[Ht,[Ht,Ht],(u,[s,c])=>s.evaluate(u)%c.evaluate(u)],ln2:[Ht,[],()=>Math.LN2],pi:[Ht,[],()=>Math.PI],e:[Ht,[],()=>Math.E],"^":[Ht,[Ht,Ht],(u,[s,c])=>Math.pow(s.evaluate(u),c.evaluate(u))],sqrt:[Ht,[Ht],(u,[s])=>Math.sqrt(s.evaluate(u))],log10:[Ht,[Ht],(u,[s])=>Math.log(s.evaluate(u))/Math.LN10],ln:[Ht,[Ht],(u,[s])=>Math.log(s.evaluate(u))],log2:[Ht,[Ht],(u,[s])=>Math.log(s.evaluate(u))/Math.LN2],sin:[Ht,[Ht],(u,[s])=>Math.sin(s.evaluate(u))],cos:[Ht,[Ht],(u,[s])=>Math.cos(s.evaluate(u))],tan:[Ht,[Ht],(u,[s])=>Math.tan(s.evaluate(u))],asin:[Ht,[Ht],(u,[s])=>Math.asin(s.evaluate(u))],acos:[Ht,[Ht],(u,[s])=>Math.acos(s.evaluate(u))],atan:[Ht,[Ht],(u,[s])=>Math.atan(s.evaluate(u))],min:[Ht,js(Ht),(u,s)=>Math.min(...s.map(c=>c.evaluate(u)))],max:[Ht,js(Ht),(u,s)=>Math.max(...s.map(c=>c.evaluate(u)))],abs:[Ht,[Ht],(u,[s])=>Math.abs(s.evaluate(u))],round:[Ht,[Ht],(u,[s])=>{const c=s.evaluate(u);return c<0?-Math.round(-c):Math.round(c)}],floor:[Ht,[Ht],(u,[s])=>Math.floor(s.evaluate(u))],ceil:[Ht,[Ht],(u,[s])=>Math.ceil(s.evaluate(u))],"filter-==":[Qn,[ar,er],(u,[s,c])=>u.properties()[s.value]===c.value],"filter-id-==":[Qn,[er],(u,[s])=>u.id()===s.value],"filter-type-==":[Qn,[ar],(u,[s])=>u.geometryType()===s.value],"filter-<":[Qn,[ar,er],(u,[s,c])=>{const d=u.properties()[s.value],m=c.value;return typeof d==typeof m&&d<m}],"filter-id-<":[Qn,[er],(u,[s])=>{const c=u.id(),d=s.value;return typeof c==typeof d&&c<d}],"filter->":[Qn,[ar,er],(u,[s,c])=>{const d=u.properties()[s.value],m=c.value;return typeof d==typeof m&&d>m}],"filter-id->":[Qn,[er],(u,[s])=>{const c=u.id(),d=s.value;return typeof c==typeof d&&c>d}],"filter-<=":[Qn,[ar,er],(u,[s,c])=>{const d=u.properties()[s.value],m=c.value;return typeof d==typeof m&&d<=m}],"filter-id-<=":[Qn,[er],(u,[s])=>{const c=u.id(),d=s.value;return typeof c==typeof d&&c<=d}],"filter->=":[Qn,[ar,er],(u,[s,c])=>{const d=u.properties()[s.value],m=c.value;return typeof d==typeof m&&d>=m}],"filter-id->=":[Qn,[er],(u,[s])=>{const c=u.id(),d=s.value;return typeof c==typeof d&&c>=d}],"filter-has":[Qn,[er],(u,[s])=>s.value in u.properties()],"filter-has-id":[Qn,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Qn,[Gs(ar)],(u,[s])=>s.value.indexOf(u.geometryType())>=0],"filter-id-in":[Qn,[Gs(er)],(u,[s])=>s.value.indexOf(u.id())>=0],"filter-in-small":[Qn,[ar,Gs(er)],(u,[s,c])=>c.value.indexOf(u.properties()[s.value])>=0],"filter-in-large":[Qn,[ar,Gs(er)],(u,[s,c])=>function(d,m,_,E){for(;_<=E;){const I=_+E>>1;if(m[I]===d)return!0;m[I]>d?E=I-1:_=I+1}return!1}(u.properties()[s.value],c.value,0,c.value.length-1)],all:{type:Qn,overloads:[[[Qn,Qn],(u,[s,c])=>s.evaluate(u)&&c.evaluate(u)],[js(Qn),(u,s)=>{for(const c of s)if(!c.evaluate(u))return!1;return!0}]]},any:{type:Qn,overloads:[[[Qn,Qn],(u,[s,c])=>s.evaluate(u)||c.evaluate(u)],[js(Qn),(u,s)=>{for(const c of s)if(c.evaluate(u))return!0;return!1}]]},"!":[Qn,[Qn],(u,[s])=>!s.evaluate(u)],"is-supported-script":[Qn,[ar],(u,[s])=>{const c=u.globals&&u.globals.isSupportedScript;return!c||c(s.evaluate(u))}],upcase:[ar,[ar],(u,[s])=>s.evaluate(u).toUpperCase()],downcase:[ar,[ar],(u,[s])=>s.evaluate(u).toLowerCase()],concat:[ar,js(er),(u,s)=>s.map(c=>Rd(c.evaluate(u))).join("")],"resolved-locale":[ar,[Cs],(u,[s])=>s.evaluate(u).resolvedLocale()]});var $d=M1;function O1(u){return{result:"success",value:u}}function vh(u){return{result:"error",value:u}}function Sf(u){return u["property-type"]==="data-driven"}function kg(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function Ng(u){return!!u.expression&&u.expression.interpolated}function Gr(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function jd(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function D1(u){return u}function Fg(u,s){const c=s.type==="color",d=u.stops&&typeof u.stops[0][0]=="object",m=d||!(d||u.property!==void 0),_=u.type||(Ng(s)?"exponential":"interval");if(c&&((u=Uu({},u)).stops&&(u.stops=u.stops.map(A=>[A[0],uo.parse(A[1])])),u.default=uo.parse(u.default?u.default:s.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!yv[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let E,I,P;if(_==="exponential")E=Xu;else if(_==="interval")E=Bg;else if(_==="categorical"){E=R1,I=Object.create(null);for(const A of u.stops)I[A[0]]=A[1];P=typeof u.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);E=k1}if(d){const A={},N=[];for(let W=0;W<u.stops.length;W++){const J=u.stops[W],te=J[0].zoom;A[te]===void 0&&(A[te]={zoom:te,type:u.type,property:u.property,default:u.default,stops:[]},N.push(te)),A[te].stops.push([J[0].value,J[1]])}const G=[];for(const W of N)G.push([A[W].zoom,Fg(A[W],s)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:Zl.interpolationFactor.bind(void 0,$),zoomStops:G.map(W=>W[0]),evaluate:({zoom:W},J)=>Xu({stops:G,base:u.base},s,W).evaluate(W,J)}}if(m){const A=_==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:Zl.interpolationFactor.bind(void 0,A),zoomStops:u.stops.map(N=>N[0]),evaluate:({zoom:N})=>E(u,s,N,I,P)}}return{kind:"source",evaluate(A,N){const G=N&&N.properties?N.properties[u.property]:void 0;return G===void 0?Tf(u.default,s.default):E(u,s,G,I,P)}}}function Tf(u,s,c){return u!==void 0?u:s!==void 0?s:c!==void 0?c:void 0}function R1(u,s,c,d,m){return Tf(typeof c===m?d[c]:void 0,u.default,s.default)}function Bg(u,s,c){if(Gr(c)!=="number")return Tf(u.default,s.default);const d=u.stops.length;if(d===1||c<=u.stops[0][0])return u.stops[0][1];if(c>=u.stops[d-1][0])return u.stops[d-1][1];const m=Ig(u.stops.map(_=>_[0]),c);return u.stops[m][1]}function Xu(u,s,c){const d=u.base!==void 0?u.base:1;if(Gr(c)!=="number")return Tf(u.default,s.default);const m=u.stops.length;if(m===1||c<=u.stops[0][0])return u.stops[0][1];if(c>=u.stops[m-1][0])return u.stops[m-1][1];const _=Ig(u.stops.map(N=>N[0]),c),E=function(N,G,$,W){const J=W-$,te=N-$;return J===0?0:G===1?te/J:(Math.pow(G,te)-1)/(Math.pow(G,J)-1)}(c,d,u.stops[_][0],u.stops[_+1][0]),I=u.stops[_][1],P=u.stops[_+1][1];let A=Bd[s.type]||D1;if(u.colorSpace&&u.colorSpace!=="rgb"){const N=yv[u.colorSpace];A=(G,$)=>N.reverse(N.interpolate(N.forward(G),N.forward($),E))}return typeof I.evaluate=="function"?{evaluate(...N){const G=I.evaluate.apply(void 0,N),$=P.evaluate.apply(void 0,N);if(G!==void 0&&$!==void 0)return A(G,$,E)}}:A(I,P,E)}function k1(u,s,c){return s.type==="color"?c=uo.parse(c):s.type==="formatted"?c=os.fromString(c.toString()):s.type==="resolvedImage"?c=$s.fromString(c.toString()):Gr(c)===s.type||s.type==="enum"&&s.values[c]||(c=void 0),Tf(c,u.default,s.default)}class zg{constructor(s,c){this.expression=s,this._warningHistory={},this._evaluator=new rv,this._defaultValue=c?function(d){return d.type==="color"&&(jd(d.default)||Array.isArray(d.default))?new uo(0,0,0,0):d.type==="color"?uo.parse(d.default)||null:d.default===void 0?null:d.default}(c):null,this._enumValues=c&&c.type==="enum"?c.values:null}evaluateWithoutErrorHandling(s,c,d,m,_,E,I,P){return this._evaluator.globals=s,this._evaluator.feature=c,this._evaluator.featureState=d,this._evaluator.canonical=m||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=E,this._evaluator.featureTileCoord=I||null,this._evaluator.featureDistanceData=P||null,this.expression.evaluate(this._evaluator)}evaluate(s,c,d,m,_,E,I,P){this._evaluator.globals=s,this._evaluator.feature=c||null,this._evaluator.featureState=d||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=E||null,this._evaluator.featureTileCoord=I||null,this._evaluator.featureDistanceData=P||null;try{const A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new pa(`Expected value to be one of ${Object.keys(this._enumValues).map(N=>JSON.stringify(N)).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(A.message)),this._defaultValue}}}function If(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in $d}function Cf(u,s){const c=new uv($d,[],s?function(m){const _={color:Is,string:ar,number:Ht,enum:ar,boolean:Qn,formatted:Pd,resolvedImage:dh};return m.type==="array"?Gs(_[m.value]||er,m.length):_[m.type]}(s):void 0),d=c.parse(u,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?O1(new zg(d,s)):vh(c.errors)}class Sv{constructor(s,c){this.kind=s,this._styleExpression=c,this.isStateDependent=s!=="constant"&&!qu(c.expression)}evaluateWithoutErrorHandling(s,c,d,m,_,E){return this._styleExpression.evaluateWithoutErrorHandling(s,c,d,m,_,E)}evaluate(s,c,d,m,_,E){return this._styleExpression.evaluate(s,c,d,m,_,E)}}class qd{constructor(s,c,d,m){this.kind=s,this.zoomStops=d,this._styleExpression=c,this.isStateDependent=s!=="camera"&&!qu(c.expression),this.interpolationType=m}evaluateWithoutErrorHandling(s,c,d,m,_,E){return this._styleExpression.evaluateWithoutErrorHandling(s,c,d,m,_,E)}evaluate(s,c,d,m,_,E){return this._styleExpression.evaluate(s,c,d,m,_,E)}interpolationFactor(s,c,d){return this.interpolationType?Zl.interpolationFactor(this.interpolationType,s,c,d):0}}function Zd(u,s){if((u=Cf(u,s)).result==="error")return u;const c=u.value.expression,d=xf(c);if(!d&&!Sf(s))return vh([new jl("","data expressions not supported")]);const m=mh(c,["zoom","pitch","distance-from-center"]);if(!m&&!kg(s))return vh([new jl("","zoom expressions not supported")]);const _=Vg(c);return _||m?_ instanceof jl?vh([_]):_ instanceof Zl&&!Ng(s)?vh([new jl("",'"interpolate" expressions cannot be used with this property')]):O1(_?new qd(d?"camera":"composite",u.value,_.labels,_ instanceof Zl?_.interpolation:void 0):new Sv(d?"constant":"source",u.value)):vh([new jl("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ug{constructor(s,c){this._parameters=s,this._specification=c,Uu(this,Fg(this._parameters,this._specification))}static deserialize(s){return new Ug(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Vg(u){let s=null;if(u instanceof S1)s=Vg(u.result);else if(u instanceof _v){for(const c of u.args)if(s=Vg(c),s)break}else(u instanceof hv||u instanceof Zl)&&u.input instanceof $u&&u.input.name==="zoom"&&(s=u);return s instanceof jl||u.eachChild(c=>{const d=Vg(c);d instanceof jl?s=d:!s&&d?s=new jl("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&d&&s!==d&&(s=new jl("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}class Yt{constructor(s,c,d,m){this.message=(s?`${s}: `:"")+d,m&&(this.identifier=m),c!=null&&c.__line__&&(this.line=c.__line__)}}function ml(u){const s=u.key,c=u.value,d=u.valueSpec||{},m=u.objectElementValidators||{},_=u.style,E=u.styleSpec;let I=[];const P=Gr(c);if(P!=="object")return[new Yt(s,c,`object expected, ${P} found`)];for(const A in c){const N=A.split(".")[0];let G;m[N]?G=m[N]:d[N]?G=Ca:m["*"]?G=m["*"]:d["*"]&&(G=Ca),G?I=I.concat(G({key:(s&&`${s}.`)+A,value:c[A],valueSpec:d[N]||d["*"],style:_,styleSpec:E,object:c,objectKey:A},c)):I.push(new Yt(s,c[A],`unknown property "${A}"`))}for(const A in d)m[A]||d[A].required&&d[A].default===void 0&&c[A]===void 0&&I.push(new Yt(s,c,`missing required property "${A}"`));return I}function N1(u){const s=u.value,c=u.valueSpec,d=u.style,m=u.styleSpec,_=u.key,E=u.arrayElementValidator||Ca;if(Gr(s)!=="array")return[new Yt(_,s,`array expected, ${Gr(s)} found`)];if(c.length&&s.length!==c.length)return[new Yt(_,s,`array length ${c.length} expected, length ${s.length} found`)];if(c["min-length"]&&s.length<c["min-length"])return[new Yt(_,s,`array length at least ${c["min-length"]} expected, length ${s.length} found`)];let I={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};m.$version<7&&(I.function=c.function),Gr(c.value)==="object"&&(I=c.value);let P=[];for(let A=0;A<s.length;A++)P=P.concat(E({array:s,arrayIndex:A,value:s[A],valueSpec:I,style:d,styleSpec:m,key:`${_}[${A}]`}));return P}function Xd(u){const s=u.key,c=u.value,d=u.valueSpec;let m=Gr(c);if(m==="number"&&c!=c&&(m="NaN"),m!=="number")return[new Yt(s,c,`number expected, ${m} found`)];if("minimum"in d){let _=d.minimum;if(Gr(d.minimum)==="array"&&(_=d.minimum[u.arrayIndex]),c<_)return[new Yt(s,c,`${c} is less than the minimum value ${_}`)]}if("maximum"in d){let _=d.maximum;if(Gr(d.maximum)==="array"&&(_=d.maximum[u.arrayIndex]),c>_)return[new Yt(s,c,`${c} is greater than the maximum value ${_}`)]}return[]}function Wd(u){const s=u.valueSpec,c=xo(u.value.type);let d,m,_,E={};const I=c!=="categorical"&&u.value.property===void 0,P=!I,A=Gr(u.value.stops)==="array"&&Gr(u.value.stops[0])==="array"&&Gr(u.value.stops[0][0])==="object",N=ml({key:u.key,value:u.value,valueSpec:u.styleSpec.function,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(W){if(c==="identity")return[new Yt(W.key,W.value,'identity function may not have a "stops" property')];let J=[];const te=W.value;return J=J.concat(N1({key:W.key,value:te,valueSpec:W.valueSpec,style:W.style,styleSpec:W.styleSpec,arrayElementValidator:G})),Gr(te)==="array"&&te.length===0&&J.push(new Yt(W.key,te,"array must have at least one stop")),J},default:function(W){return Ca({key:W.key,value:W.value,valueSpec:s,style:W.style,styleSpec:W.styleSpec})}}});return c==="identity"&&I&&N.push(new Yt(u.key,u.value,'missing required property "property"')),c==="identity"||u.value.stops||N.push(new Yt(u.key,u.value,'missing required property "stops"')),c==="exponential"&&u.valueSpec.expression&&!Ng(u.valueSpec)&&N.push(new Yt(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(P&&!Sf(u.valueSpec)?N.push(new Yt(u.key,u.value,"property functions not supported")):I&&!kg(u.valueSpec)&&N.push(new Yt(u.key,u.value,"zoom functions not supported"))),c!=="categorical"&&!A||u.value.property!==void 0||N.push(new Yt(u.key,u.value,'"property" property is required')),N;function G(W){let J=[];const te=W.value,se=W.key;if(Gr(te)!=="array")return[new Yt(se,te,`array expected, ${Gr(te)} found`)];if(te.length!==2)return[new Yt(se,te,`array length 2 expected, length ${te.length} found`)];if(A){if(Gr(te[0])!=="object")return[new Yt(se,te,`object expected, ${Gr(te[0])} found`)];if(te[0].zoom===void 0)return[new Yt(se,te,"object stop key must have zoom")];if(te[0].value===void 0)return[new Yt(se,te,"object stop key must have value")];const me=xo(te[0].zoom);if(typeof me!="number")return[new Yt(se,te[0].zoom,"stop zoom values must be numbers")];if(_&&_>me)return[new Yt(se,te[0].zoom,"stop zoom values must appear in ascending order")];me!==_&&(_=me,m=void 0,E={}),J=J.concat(ml({key:`${se}[0]`,value:te[0],valueSpec:{zoom:{}},style:W.style,styleSpec:W.styleSpec,objectElementValidators:{zoom:Xd,value:$}}))}else J=J.concat($({key:`${se}[0]`,value:te[0],valueSpec:{},style:W.style,styleSpec:W.styleSpec},te));return If(Yo(te[1]))?J.concat([new Yt(`${se}[1]`,te[1],"expressions are not allowed in function stops.")]):J.concat(Ca({key:`${se}[1]`,value:te[1],valueSpec:s,style:W.style,styleSpec:W.styleSpec}))}function $(W,J){const te=Gr(W.value),se=xo(W.value),me=W.value!==null?W.value:J;if(d){if(te!==d)return[new Yt(W.key,me,`${te} stop domain type must match previous stop domain type ${d}`)]}else d=te;if(te!=="number"&&te!=="string"&&te!=="boolean"&&typeof se!="number"&&typeof se!="string"&&typeof se!="boolean")return[new Yt(W.key,me,"stop domain value must be a number, string, or boolean")];if(te!=="number"&&c!=="categorical"){let Ie=`number expected, ${te} found`;return Sf(s)&&c===void 0&&(Ie+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Yt(W.key,me,Ie)]}return c!=="categorical"||te!=="number"||typeof se=="number"&&isFinite(se)&&Math.floor(se)===se?c!=="categorical"&&te==="number"&&typeof se=="number"&&typeof m=="number"&&m!==void 0&&se<m?[new Yt(W.key,me,"stop domain values must appear in ascending order")]:(m=se,c==="categorical"&&se in E?[new Yt(W.key,me,"stop domain values must be unique")]:(E[se]=!0,[])):[new Yt(W.key,me,`integer expected, found ${String(se)}`)]}}function Ko(u){const s=(u.expressionContext==="property"?Zd:Cf)(Yo(u.value),u.valueSpec);if(s.result==="error")return s.value.map(d=>new Yt(`${u.key}${d.key}`,u.value,d.message));const c=s.value.expression||s.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!c.outputDefined())return[new Yt(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!qu(c))return[new Yt(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter")return Hd(c,u);if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!mh(c,["zoom","feature-state"]))return[new Yt(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!xf(c))return[new Yt(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Hd(u,s){const c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const m of s.valueSpec.expression.parameters)c.delete(m);if(c.size===0)return[];const d=[];return u instanceof $u&&c.has(u.name)?[new Yt(s.key,s.value,`["${u.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(u.eachChild(m=>{d.push(...Hd(m,s))}),d)}function Gg(u){const s=u.key,c=u.value,d=u.valueSpec,m=[];return Array.isArray(d.values)?d.values.indexOf(xo(c))===-1&&m.push(new Yt(s,c,`expected one of [${d.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(d.values).indexOf(xo(c))===-1&&m.push(new Yt(s,c,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(c)} found`)),m}function Tv(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const s of u.slice(1))if(!Tv(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}function $g(u,s="fill"){if(u==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Tv(u)||(u=Af(u));const c=u;let d=!0;try{d=function(A){if(!Pf(A))return A;let N=Yo(A);return jg(N),N=F1(N),N}(c)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(c,null,2)}
        `)}const m=ct[`filter_${s}`],_=Cf(d,m);let E=null;if(_.result==="error")throw new Error(_.value.map(A=>`${A.key}: ${A.message}`).join(", "));E=(A,N,G)=>_.value.evaluate(A,N,{},G);let I=null,P=null;if(d!==c){const A=Cf(c,m);if(A.result==="error")throw new Error(A.value.map(N=>`${N.key}: ${N.message}`).join(", "));I=(N,G,$,W,J)=>A.value.evaluate(N,G,{},$,void 0,void 0,W,J),P=!xf(A.value.expression)}return{filter:E,dynamicFilter:I||void 0,needGeometry:B1(d),needFeature:!!P}}function F1(u){if(!Array.isArray(u))return u;const s=function(c){if(Iv.has(c[0])){for(let d=1;d<c.length;d++)if(Pf(c[d]))return!0}return c}(u);return s===!0?s:s.map(c=>F1(c))}function jg(u){let s=!1;const c=[];if(u[0]==="case"){for(let d=1;d<u.length-1;d+=2)s=s||Pf(u[d]),c.push(u[d+1]);c.push(u[u.length-1])}else if(u[0]==="match"){s=s||Pf(u[1]);for(let d=2;d<u.length-1;d+=2)c.push(u[d+1]);c.push(u[u.length-1])}else if(u[0]==="step"){s=s||Pf(u[1]);for(let d=1;d<u.length-1;d+=2)c.push(u[d+1])}s&&(u.length=0,u.push("any",...c));for(let d=1;d<u.length;d++)jg(u[d])}function Pf(u){if(!Array.isArray(u))return!1;if((s=u[0])==="pitch"||s==="distance-from-center")return!0;var s;for(let c=1;c<u.length;c++)if(Pf(u[c]))return!0;return!1}const Iv=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function CE(u,s){return u<s?-1:u>s?1:0}function B1(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(let s=1;s<u.length;s++)if(B1(u[s]))return!0;return!1}function Af(u){if(!u)return!0;const s=u[0];return u.length<=1?s!=="any":s==="=="?Cv(u[1],u[2],"=="):s==="!="?qg(Cv(u[1],u[2],"==")):s==="<"||s===">"||s==="<="||s===">="?Cv(u[1],u[2],s):s==="any"?(c=u.slice(1),["any"].concat(c.map(Af))):s==="all"?["all"].concat(u.slice(1).map(Af)):s==="none"?["all"].concat(u.slice(1).map(Af).map(qg)):s==="in"?Pv(u[1],u.slice(2)):s==="!in"?qg(Pv(u[1],u.slice(2))):s==="has"?Av(u[1]):s==="!has"?qg(Av(u[1])):s!=="within"||u;var c}function Cv(u,s,c){switch(u){case"$type":return[`filter-type-${c}`,s];case"$id":return[`filter-id-${c}`,s];default:return[`filter-${c}`,u,s]}}function Pv(u,s){if(s.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(c=>typeof c!=typeof s[0])?["filter-in-large",u,["literal",s.sort(CE)]]:["filter-in-small",u,["literal",s]]}}function Av(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function qg(u){return["!",u]}function Yd(u){return Tv(Yo(u.value))?Ko(Uu({},u,{expressionContext:"filter",valueSpec:u.styleSpec[`filter_${u.layerType||"fill"}`]})):Kd(u)}function Kd(u){const s=u.value,c=u.key;if(Gr(s)!=="array")return[new Yt(c,s,`array expected, ${Gr(s)} found`)];const d=u.styleSpec;let m,_=[];if(s.length<1)return[new Yt(c,s,"filter array must have at least 1 element")];switch(_=_.concat(Gg({key:`${c}[0]`,value:s[0],valueSpec:d.filter_operator,style:u.style,styleSpec:u.styleSpec})),xo(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&xo(s[1])==="$type"&&_.push(new Yt(c,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&_.push(new Yt(c,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(m=Gr(s[1]),m!=="string"&&_.push(new Yt(`${c}[1]`,s[1],`string expected, ${m} found`)));for(let E=2;E<s.length;E++)m=Gr(s[E]),xo(s[1])==="$type"?_=_.concat(Gg({key:`${c}[${E}]`,value:s[E],valueSpec:d.geometry_type,style:u.style,styleSpec:u.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&_.push(new Yt(`${c}[${E}]`,s[E],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let E=1;E<s.length;E++)_=_.concat(Kd({key:`${c}[${E}]`,value:s[E],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":m=Gr(s[1]),s.length!==2?_.push(new Yt(c,s,`filter array for "${s[0]}" operator must have 2 elements`)):m!=="string"&&_.push(new Yt(`${c}[1]`,s[1],`string expected, ${m} found`));break;case"within":m=Gr(s[1]),s.length!==2?_.push(new Yt(c,s,`filter array for "${s[0]}" operator must have 2 elements`)):m!=="object"&&_.push(new Yt(`${c}[1]`,s[1],`object expected, ${m} found`))}return _}function Mv(u,s){const c=u.key,d=u.style,m=u.styleSpec,_=u.value,E=u.objectKey,I=m[`${s}_${u.layerType}`];if(!I)return[];const P=E.match(/^(.*)-transition$/);if(s==="paint"&&P&&I[P[1]]&&I[P[1]].transition)return Ca({key:c,value:_,valueSpec:m.transition,style:d,styleSpec:m});const A=u.valueSpec||I[E];if(!A)return[new Yt(c,_,`unknown property "${E}"`)];let N;if(Gr(_)==="string"&&Sf(A)&&!A.tokens&&(N=/^{([^}]+)}$/.exec(_))){const $=`\`{ "type": "identity", "property": ${N?JSON.stringify(N[1]):'"_"'} }\``;return[new Yt(c,_,`"${E}" does not support interpolation syntax
Use an identity property function instead: ${$}.`)]}const G=[];return u.layerType==="symbol"&&(E==="text-field"&&d&&!d.glyphs&&G.push(new Yt(c,_,'use of "text-field" requires a style "glyphs" property')),E==="text-font"&&jd(Yo(_))&&xo(_.type)==="identity"&&G.push(new Yt(c,_,'"text-font" does not support identity functions'))),G.concat(Ca({key:u.key,value:_,valueSpec:A,style:d,styleSpec:m,expressionContext:"property",propertyType:s,propertyKey:E}))}function z1(u){return Mv(u,"paint")}function Lv(u){return Mv(u,"layout")}function U1(u){let s=[];const c=u.value,d=u.key,m=u.style,_=u.styleSpec;c.type||c.ref||s.push(new Yt(d,c,'either "type" or "ref" is required'));let E=xo(c.type);const I=xo(c.ref);if(c.id){const P=xo(c.id);for(let A=0;A<u.arrayIndex;A++){const N=m.layers[A];xo(N.id)===P&&s.push(new Yt(d,c.id,`duplicate layer id "${c.id}", previously used at line ${N.id.__line__}`))}}if("ref"in c){let P;["type","source","source-layer","filter","layout"].forEach(A=>{A in c&&s.push(new Yt(d,c[A],`"${A}" is prohibited for ref layers`))}),m.layers.forEach(A=>{xo(A.id)===I&&(P=A)}),P?P.ref?s.push(new Yt(d,c.ref,"ref cannot reference another ref layer")):E=xo(P.type):typeof I=="string"&&s.push(new Yt(d,c.ref,`ref layer "${I}" not found`))}else if(E!=="background"&&E!=="sky")if(c.source){const P=m.sources&&m.sources[c.source],A=P&&xo(P.type);P?A==="vector"&&E==="raster"?s.push(new Yt(d,c.source,`layer "${c.id}" requires a raster source`)):A==="raster"&&E!=="raster"?s.push(new Yt(d,c.source,`layer "${c.id}" requires a vector source`)):A!=="vector"||c["source-layer"]?A==="raster-dem"&&E!=="hillshade"?s.push(new Yt(d,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):E!=="line"||!c.paint||!c.paint["line-gradient"]&&!c.paint["line-trim-offset"]||A==="geojson"&&P.lineMetrics||s.push(new Yt(d,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new Yt(d,c,`layer "${c.id}" must specify a "source-layer"`)):s.push(new Yt(d,c.source,`source "${c.source}" not found`))}else s.push(new Yt(d,c,'missing required property "source"'));return s=s.concat(ml({key:d,value:c,valueSpec:_.layer,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ca({key:`${d}.type`,value:c.type,valueSpec:_.layer.type,style:u.style,styleSpec:u.styleSpec,object:c,objectKey:"type"}),filter:P=>Yd(Uu({layerType:E},P)),layout:P=>ml({layer:c,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":A=>Lv(Uu({layerType:E},A))}}),paint:P=>ml({layer:c,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":A=>z1(Uu({layerType:E},A))}})}})),s}function Ac(u){const s=u.value,c=u.key,d=Gr(s);return d!=="string"?[new Yt(c,s,`string expected, ${d} found`)]:[]}const V1={promoteId:function({key:u,value:s}){if(Gr(s)==="string")return Ac({key:u,value:s});{const c=[];for(const d in s)c.push(...Ac({key:`${u}.${d}`,value:s[d]}));return c}}};function G1(u){const s=u.value,c=u.key,d=u.styleSpec,m=u.style;if(!s.type)return[new Yt(c,s,'"type" is required')];const _=xo(s.type);let E;switch(_){case"vector":case"raster":case"raster-dem":return E=ml({key:c,value:s,valueSpec:d[`source_${_.replace("-","_")}`],style:u.style,styleSpec:d,objectElementValidators:V1}),E;case"geojson":if(E=ml({key:c,value:s,valueSpec:d.source_geojson,style:m,styleSpec:d,objectElementValidators:V1}),s.cluster)for(const I in s.clusterProperties){const[P,A]=s.clusterProperties[I],N=typeof P=="string"?[P,["accumulated"],["get",I]]:P;E.push(...Ko({key:`${c}.${I}.map`,value:A,expressionContext:"cluster-map"})),E.push(...Ko({key:`${c}.${I}.reduce`,value:N,expressionContext:"cluster-reduce"}))}return E;case"video":return ml({key:c,value:s,valueSpec:d.source_video,style:m,styleSpec:d});case"image":return ml({key:c,value:s,valueSpec:d.source_image,style:m,styleSpec:d});case"canvas":return[new Yt(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Gg({key:`${c}.type`,value:s.type,valueSpec:{values:PE(d)},style:m,styleSpec:d})}}function PE(u){return u.source.reduce((s,c)=>{const d=u[c];return d.type.type==="enum"&&(s=s.concat(Object.keys(d.type.values))),s},[])}function $1(u){const s=u.value,c=u.styleSpec,d=c.light,m=u.style;let _=[];const E=Gr(s);if(s===void 0)return _;if(E!=="object")return _=_.concat([new Yt("light",s,`object expected, ${E} found`)]),_;for(const I in s){const P=I.match(/^(.*)-transition$/);_=_.concat(P&&d[P[1]]&&d[P[1]].transition?Ca({key:I,value:s[I],valueSpec:c.transition,style:m,styleSpec:c}):d[I]?Ca({key:I,value:s[I],valueSpec:d[I],style:m,styleSpec:c}):[new Yt(I,s[I],`unknown property "${I}"`)])}return _}function Ov(u){const s=u.value,c=u.key,d=u.style,m=u.styleSpec,_=m.terrain;let E=[];const I=Gr(s);if(s===void 0)return E;if(I!=="object")return E=E.concat([new Yt("terrain",s,`object expected, ${I} found`)]),E;for(const P in s){const A=P.match(/^(.*)-transition$/);E=E.concat(A&&_[A[1]]&&_[A[1]].transition?Ca({key:P,value:s[P],valueSpec:m.transition,style:d,styleSpec:m}):_[P]?Ca({key:P,value:s[P],valueSpec:_[P],style:d,styleSpec:m}):[new Yt(P,s[P],`unknown property "${P}"`)])}if(s.source){const P=d.sources&&d.sources[s.source],A=P&&xo(P.type);P?A!=="raster-dem"&&E.push(new Yt(c,s.source,`terrain cannot be used with a source of type ${String(A)}, it only be used with a "raster-dem" source type`)):E.push(new Yt(c,s.source,`source "${s.source}" not found`))}else E.push(new Yt(c,s,'terrain is missing required property "source"'));return E}function j1(u){const s=u.value,c=u.style,d=u.styleSpec,m=d.fog;let _=[];const E=Gr(s);if(s===void 0)return _;if(E!=="object")return _=_.concat([new Yt("fog",s,`object expected, ${E} found`)]),_;for(const I in s){const P=I.match(/^(.*)-transition$/);_=_.concat(P&&m[P[1]]&&m[P[1]].transition?Ca({key:I,value:s[I],valueSpec:d.transition,style:c,styleSpec:d}):m[I]?Ca({key:I,value:s[I],valueSpec:m[I],style:c,styleSpec:d}):[new Yt(I,s[I],`unknown property "${I}"`)])}return _}const q1={"*":()=>[],array:N1,boolean:function(u){const s=u.value,c=u.key,d=Gr(s);return d!=="boolean"?[new Yt(c,s,`boolean expected, ${d} found`)]:[]},number:Xd,color:function(u){const s=u.key,c=u.value,d=Gr(c);return d!=="string"?[new Yt(s,c,`color expected, ${d} found`)]:Yy(c)===null?[new Yt(s,c,`color expected, "${c}" found`)]:[]},enum:Gg,filter:Yd,function:Wd,layer:U1,object:ml,source:G1,light:$1,terrain:Ov,fog:j1,string:Ac,formatted:function(u){return Ac(u).length===0?[]:Ko(u)},resolvedImage:function(u){return Ac(u).length===0?[]:Ko(u)},projection:function(u){const s=u.value,c=u.styleSpec,d=c.projection,m=u.style;let _=[];const E=Gr(s);if(E==="object")for(const I in s)_=_.concat(Ca({key:I,value:s[I],valueSpec:d[I],style:m,styleSpec:c}));else E!=="string"&&(_=_.concat([new Yt("projection",s,`object or string expected, ${E} found`)]));return _}};function Ca(u){const s=u.value,c=u.valueSpec,d=u.styleSpec;return c.expression&&jd(xo(s))?Wd(u):c.expression&&If(Yo(s))?Ko(u):c.type&&q1[c.type]?q1[c.type](u):ml(Uu({},u,{valueSpec:c.type?d[c.type]:c}))}function AE(u){const s=u.value,c=u.key,d=Ac(u);return d.length||(s.indexOf("{fontstack}")===-1&&d.push(new Yt(c,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&d.push(new Yt(c,s,'"glyphs" url must include a "{range}" token'))),d}function Z1(u,s=ct){return qs(Ca({key:"",value:u,valueSpec:s.$root,styleSpec:s,style:u,objectElementValidators:{glyphs:AE,"*":()=>[]}}))}const ME=u=>qs(z1(u)),LE=u=>qs(Lv(u));function qs(u){return u.slice().sort((s,c)=>s.line&&c.line?s.line-c.line:0)}function X1(u,s){let c=!1;if(s&&s.length)for(const d of s)u.fire(new zu(new Error(d.message))),c=!0;return c}var OE=Xl,yl=3;function Xl(u,s,c){var d=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;var m=new Int32Array(this.arrayBuffer);u=m[0],this.d=(s=m[1])+2*(c=m[2]);for(var _=0;_<this.d*this.d;_++){var E=m[yl+_],I=m[yl+_+1];d.push(E===I?null:m.subarray(E,I))}var P=m[yl+d.length+1];this.keys=m.subarray(m[yl+d.length],P),this.bboxes=m.subarray(P),this.insert=this._insertReadonly}else{this.d=s+2*c;for(var A=0;A<this.d*this.d;A++)d.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=u,this.padding=c,this.scale=s/u,this.uid=0;var N=c/s*u;this.min=-N,this.max=u+N}Xl.prototype.insert=function(u,s,c,d,m){this._forEachCell(s,c,d,m,this._insertCell,this.uid++),this.keys.push(u),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(m)},Xl.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Xl.prototype._insertCell=function(u,s,c,d,m,_){this.cells[m].push(_)},Xl.prototype.query=function(u,s,c,d,m){var _=this.min,E=this.max;if(u<=_&&s<=_&&E<=c&&E<=d&&!m)return Array.prototype.slice.call(this.keys);var I=[];return this._forEachCell(u,s,c,d,this._queryCell,I,{},m),I},Xl.prototype._queryCell=function(u,s,c,d,m,_,E,I){var P=this.cells[m];if(P!==null)for(var A=this.keys,N=this.bboxes,G=0;G<P.length;G++){var $=P[G];if(E[$]===void 0){var W=4*$;(I?I(N[W+0],N[W+1],N[W+2],N[W+3]):u<=N[W+2]&&s<=N[W+3]&&c>=N[W+0]&&d>=N[W+1])?(E[$]=!0,_.push(A[$])):E[$]=!1}}},Xl.prototype._forEachCell=function(u,s,c,d,m,_,E,I){for(var P=this._convertToCellCoord(u),A=this._convertToCellCoord(s),N=this._convertToCellCoord(c),G=this._convertToCellCoord(d),$=P;$<=N;$++)for(var W=A;W<=G;W++){var J=this.d*W+$;if((!I||I(this._convertFromCellCoord($),this._convertFromCellCoord(W),this._convertFromCellCoord($+1),this._convertFromCellCoord(W+1)))&&m.call(this,u,s,c,d,J,_,E,I))return}},Xl.prototype._convertFromCellCoord=function(u){return(u-this.padding)/this.scale},Xl.prototype._convertToCellCoord=function(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))},Xl.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var u=this.cells,s=yl+this.cells.length+1+1,c=0,d=0;d<this.cells.length;d++)c+=this.cells[d].length;var m=new Int32Array(s+c+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;for(var _=s,E=0;E<u.length;E++){var I=u[E];m[yl+E]=_,m.set(I,_),_+=I.length}return m[yl+u.length]=_,m.set(this.keys,_),m[yl+u.length+1]=_+=this.keys.length,m.set(this.bboxes,_),_+=this.bboxes.length,m.buffer};var _h=k(OE);const Zg={};function nn(u,s,c={}){Object.defineProperty(u,"_classRegistryKey",{value:s,writeable:!1}),Zg[s]={klass:u,omit:c.omit||[]}}nn(Object,"Object"),_h.serialize=function(u,s){const c=u.toArrayBuffer();return s&&s.push(c),{buffer:c}},_h.deserialize=function(u){return new _h(u.buffer)},Object.defineProperty(_h,"name",{value:"Grid"}),nn(_h,"Grid"),nn(uo,"Color"),nn(Error,"Error"),nn(pl,"AJAXError"),nn($s,"ResolvedImage"),nn(Ug,"StylePropertyFunction"),nn(zg,"StyleExpression",{omit:["_evaluator"]}),nn(qd,"ZoomDependentExpression"),nn(Sv,"ZoomConstantExpression"),nn($u,"CompoundExpression",{omit:["_evaluate"]});for(const u in $d)Zg[$d[u]._classRegistryKey]||nn($d[u],`Expression${u}`);function Dv(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function Rv(u){return f.ImageBitmap&&u instanceof f.ImageBitmap}function Mf(u,s){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp)return u;if(Dv(u)||Rv(u))return s&&s.push(u),u;if(ArrayBuffer.isView(u)){const c=u;return s&&s.push(c.buffer),c}if(u instanceof f.ImageData)return s&&s.push(u.data.buffer),u;if(Array.isArray(u)){const c=[];for(const d of u)c.push(Mf(d,s));return c}if(typeof u=="object"){const c=u.constructor,d=c._classRegistryKey;if(!d)throw new Error(`can't serialize object of unregistered class ${d}`);const m=c.serialize?c.serialize(u,s):{};if(!c.serialize){for(const _ in u)u.hasOwnProperty(_)&&(Zg[d].omit.indexOf(_)>=0||(m[_]=Mf(u[_],s)));u instanceof Error&&(m.message=u.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(m.$name=d),m}throw new Error("can't serialize object of type "+typeof u)}function xh(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||Dv(u)||Rv(u)||ArrayBuffer.isView(u)||u instanceof f.ImageData)return u;if(Array.isArray(u))return u.map(xh);if(typeof u=="object"){const s=u.$name||"Object",{klass:c}=Zg[s];if(!c)throw new Error(`can't deserialize unregistered class ${s}`);if(c.deserialize)return c.deserialize(u);const d=Object.create(c.prototype);for(const m of Object.keys(u))m!=="$name"&&(d[m]=xh(u[m]));return d}throw new Error("can't deserialize object of type "+typeof u)}const Zt={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519};function kv(u){for(const s of u)if(Nv(s.charCodeAt(0)))return!0;return!1}function DE(u){for(const s of u)if(!W1(s.charCodeAt(0)))return!1;return!0}function W1(u){return!(Zt.Arabic(u)||Zt["Arabic Supplement"](u)||Zt["Arabic Extended-A"](u)||Zt["Arabic Presentation Forms-A"](u)||Zt["Arabic Presentation Forms-B"](u))}function Nv(u){return!(u!==746&&u!==747&&(u<4352||!(Zt["Bopomofo Extended"](u)||Zt.Bopomofo(u)||Zt["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||Zt["CJK Compatibility Ideographs"](u)||Zt["CJK Compatibility"](u)||Zt["CJK Radicals Supplement"](u)||Zt["CJK Strokes"](u)||!(!Zt["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||Zt["CJK Unified Ideographs Extension A"](u)||Zt["CJK Unified Ideographs"](u)||Zt["Enclosed CJK Letters and Months"](u)||Zt["Hangul Compatibility Jamo"](u)||Zt["Hangul Jamo Extended-A"](u)||Zt["Hangul Jamo Extended-B"](u)||Zt["Hangul Jamo"](u)||Zt["Hangul Syllables"](u)||Zt.Hiragana(u)||Zt["Ideographic Description Characters"](u)||Zt.Kanbun(u)||Zt["Kangxi Radicals"](u)||Zt["Katakana Phonetic Extensions"](u)||Zt.Katakana(u)&&u!==12540||!(!Zt["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!Zt["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||Zt["Unified Canadian Aboriginal Syllabics"](u)||Zt["Unified Canadian Aboriginal Syllabics Extended"](u)||Zt["Vertical Forms"](u)||Zt["Yijing Hexagram Symbols"](u)||Zt["Yi Syllables"](u)||Zt["Yi Radicals"](u))))}function H1(u){return!(Nv(u)||function(s){return!!(Zt["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||Zt["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||Zt["Letterlike Symbols"](s)||Zt["Number Forms"](s)||Zt["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||Zt["Control Pictures"](s)&&s!==9251||Zt["Optical Character Recognition"](s)||Zt["Enclosed Alphanumerics"](s)||Zt["Geometric Shapes"](s)||Zt["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||Zt["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Zt["CJK Symbols and Punctuation"](s)||Zt.Katakana(s)||Zt["Private Use Area"](s)||Zt["CJK Compatibility Forms"](s)||Zt["Small Form Variants"](s)||Zt["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(u))}function Y1(u){return u>=1424&&u<=2303||Zt["Arabic Presentation Forms-A"](u)||Zt["Arabic Presentation Forms-B"](u)}function RE(u,s){return!(!s&&Y1(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||Zt.Khmer(u))}function kE(u){for(const s of u)if(Y1(s.charCodeAt(0)))return!0;return!1}const Fv="deferred",Bv="loading",zv="loaded";let Lf=null,v="unavailable",h=null;const g=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(v="error"),Lf&&Lf(u)};function b(){T.fire(new fh("pluginStateChange",{pluginStatus:v,pluginURL:h}))}const T=new Cd,C=function(){return v},O=function(){if(v!==Fv||!h)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");v=Bv,b(),h&&Fu({url:h},u=>{u?g(u):(v=zv,b())})},R={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>v===zv||R.applyArabicShaping!=null,isLoading:()=>v===Bv,setState(u){v=u.pluginStatus,h=u.pluginURL},isParsed:()=>R.applyArabicShaping!=null&&R.processBidirectionalText!=null&&R.processStyledBidirectionalText!=null,getPluginURL:()=>h};class F{constructor(s,c){this.zoom=s,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.transition=c.transition,this.pitch=c.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(s){return function(c,d){for(const m of c)if(!RE(m.charCodeAt(0),d))return!1;return!0}(s,R.isLoaded())}}class Z{constructor(s,c){this.property=s,this.value=c,this.expression=function(d,m){if(jd(d))return new Ug(d,m);if(If(d)){const _=Zd(d,m);if(_.result==="error")throw new Error(_.value.map(E=>`${E.key}: ${E.message}`).join(", "));return _.value}{let _=d;return typeof d=="string"&&m.type==="color"&&(_=uo.parse(d)),{kind:"constant",evaluate:()=>_}}}(c===void 0?s.specification.default:c,s.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,c,d){return this.property.possiblyEvaluate(this,s,c,d)}}class j{constructor(s){this.property=s,this.value=new Z(s,void 0)}transitioned(s,c){return new oe(this.property,this.value,c,xt({},s.transition,this.transition),s.now)}untransitioned(){return new oe(this.property,this.value,null,{},0)}}class Q{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return Ce(this._values[s].value.value)}setValue(s,c){this._values.hasOwnProperty(s)||(this._values[s]=new j(this._values[s].property)),this._values[s].value=new Z(this._values[s].property,c===null?void 0:Ce(c))}getTransition(s){return Ce(this._values[s].transition)}setTransition(s,c){this._values.hasOwnProperty(s)||(this._values[s]=new j(this._values[s].property)),this._values[s].transition=Ce(c)||void 0}serialize(){const s={};for(const c of Object.keys(this._values)){const d=this.getValue(c);d!==void 0&&(s[c]=d);const m=this.getTransition(c);m!==void 0&&(s[`${c}-transition`]=m)}return s}transitioned(s,c){const d=new he(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].transitioned(s,c._values[m]);return d}untransitioned(){const s=new he(this._properties);for(const c of Object.keys(this._values))s._values[c]=this._values[c].untransitioned();return s}}class oe{constructor(s,c,d,m,_){const E=m.delay||0,I=m.duration||0;_=_||0,this.property=s,this.value=c,this.begin=_+E,this.end=this.begin+I,s.specification.transition&&(m.delay||m.duration)&&(this.prior=d)}possiblyEvaluate(s,c,d){const m=s.now||0,_=this.value.possiblyEvaluate(s,c,d),E=this.prior;if(E){if(m>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(m<this.begin)return E.possiblyEvaluate(s,c,d);{const I=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(s,c,d),_,He(I))}}return _}}class he{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,c,d){const m=new ge(this._properties);for(const _ of Object.keys(this._values))m._values[_]=this._values[_].possiblyEvaluate(s,c,d);return m}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class pe{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}getValue(s){return Ce(this._values[s].value)}setValue(s,c){this._values[s]=new Z(this._values[s].property,c===null?void 0:Ce(c))}serialize(){const s={};for(const c of Object.keys(this._values)){const d=this.getValue(c);d!==void 0&&(s[c]=d)}return s}possiblyEvaluate(s,c,d){const m=new ge(this._properties);for(const _ of Object.keys(this._values))m._values[_]=this._values[_].possiblyEvaluate(s,c,d);return m}}class de{constructor(s,c,d){this.property=s,this.value=c,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,c,d,m){return this.property.evaluate(this.value,this.parameters,s,c,d,m)}}class ge{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class ee{constructor(s){this.specification=s}possiblyEvaluate(s,c){return s.expression.evaluate(c)}interpolate(s,c,d){const m=Bd[this.specification.type];return m?m(s,c,d):s}}class ce{constructor(s,c){this.specification=s,this.overrides=c}possiblyEvaluate(s,c,d,m){return new de(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(c,null,{},d,m)}:s.expression,c)}interpolate(s,c,d){if(s.value.kind!=="constant"||c.value.kind!=="constant")return s;if(s.value.value===void 0||c.value.value===void 0)return new de(this,{kind:"constant",value:void 0},s.parameters);const m=Bd[this.specification.type];return m?new de(this,{kind:"constant",value:m(s.value.value,c.value.value,d)},s.parameters):s}evaluate(s,c,d,m,_,E){return s.kind==="constant"?s.value:s.evaluate(c,d,m,_,E)}}class _e{constructor(s){this.specification=s}possiblyEvaluate(s,c,d,m){return!!s.expression.evaluate(c,null,{},d,m)}interpolate(){return!1}}class xe{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new F(0,{});for(const d in s){const m=s[d];m.specification.overridable&&this.overridableProperties.push(d);const _=this.defaultPropertyValues[d]=new Z(m,void 0),E=this.defaultTransitionablePropertyValues[d]=new j(m);this.defaultTransitioningPropertyValues[d]=E.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=_.possiblyEvaluate(c)}}}function De(u,s){return 256*(u=Pe(Math.floor(u),0,255))+Pe(Math.floor(s),0,255)}nn(ce,"DataDrivenProperty"),nn(ee,"DataConstantProperty"),nn(_e,"ColorRampProperty");const ke={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Re{constructor(s,c){this._structArray=s,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ge{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,c){return s._trim(),c&&(s.isTransferred=!0,c.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const c=Object.create(this.prototype);return c.arrayBuffer=s.arrayBuffer,c.length=s.length,c.capacity=s.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ze(u,s=1){let c=0,d=0;return{members:u.map(m=>{const _=ke[m.type].BYTES_PER_ELEMENT,E=c=Qe(c,Math.max(s,_)),I=m.components||1;return d=Math.max(d,_),c+=_*I,{name:m.name,type:m.type,components:I,offset:E}}),size:Qe(c,Math.max(d,s)),alignment:s}}function Qe(u,s){return Math.ceil(u/s)*s}class Et extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c){const d=this.length;return this.resize(d+1),this.emplace(d,s,c)}emplace(s,c,d){const m=2*s;return this.int16[m+0]=c,this.int16[m+1]=d,s}}Et.prototype.bytesPerElement=4,nn(Et,"StructArrayLayout2i4");class Xe extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const _=3*s;return this.int16[_+0]=c,this.int16[_+1]=d,this.int16[_+2]=m,s}}Xe.prototype.bytesPerElement=6,nn(Xe,"StructArrayLayout3i6");class gt extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m){const _=this.length;return this.resize(_+1),this.emplace(_,s,c,d,m)}emplace(s,c,d,m,_){const E=4*s;return this.int16[E+0]=c,this.int16[E+1]=d,this.int16[E+2]=m,this.int16[E+3]=_,s}}gt.prototype.bytesPerElement=8,nn(gt,"StructArrayLayout4i8");class rt extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,_,E,I){const P=this.length;return this.resize(P+1),this.emplace(P,s,c,d,m,_,E,I)}emplace(s,c,d,m,_,E,I,P){const A=6*s,N=12*s,G=3*s;return this.int16[A+0]=c,this.int16[A+1]=d,this.uint8[N+4]=m,this.uint8[N+5]=_,this.uint8[N+6]=E,this.uint8[N+7]=I,this.float32[G+2]=P,s}}rt.prototype.bytesPerElement=12,nn(rt,"StructArrayLayout2i4ub1f12");class wt extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m){const _=this.length;return this.resize(_+1),this.emplace(_,s,c,d,m)}emplace(s,c,d,m,_){const E=4*s;return this.float32[E+0]=c,this.float32[E+1]=d,this.float32[E+2]=m,this.float32[E+3]=_,s}}wt.prototype.bytesPerElement=16,nn(wt,"StructArrayLayout4f16");class Ye extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,_){const E=this.length;return this.resize(E+1),this.emplace(E,s,c,d,m,_)}emplace(s,c,d,m,_,E){const I=6*s,P=3*s;return this.uint16[I+0]=c,this.uint16[I+1]=d,this.uint16[I+2]=m,this.uint16[I+3]=_,this.float32[P+2]=E,s}}Ye.prototype.bytesPerElement=12,nn(Ye,"StructArrayLayout4ui1f12");class pt extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d,m){const _=this.length;return this.resize(_+1),this.emplace(_,s,c,d,m)}emplace(s,c,d,m,_){const E=4*s;return this.uint16[E+0]=c,this.uint16[E+1]=d,this.uint16[E+2]=m,this.uint16[E+3]=_,s}}pt.prototype.bytesPerElement=8,nn(pt,"StructArrayLayout4ui8");class It extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,_,E){const I=this.length;return this.resize(I+1),this.emplace(I,s,c,d,m,_,E)}emplace(s,c,d,m,_,E,I){const P=6*s;return this.int16[P+0]=c,this.int16[P+1]=d,this.int16[P+2]=m,this.int16[P+3]=_,this.int16[P+4]=E,this.int16[P+5]=I,s}}It.prototype.bytesPerElement=12,nn(It,"StructArrayLayout6i12");class _t extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,_,E,I,P,A,N,G,$){const W=this.length;return this.resize(W+1),this.emplace(W,s,c,d,m,_,E,I,P,A,N,G,$)}emplace(s,c,d,m,_,E,I,P,A,N,G,$,W){const J=12*s;return this.int16[J+0]=c,this.int16[J+1]=d,this.int16[J+2]=m,this.int16[J+3]=_,this.uint16[J+4]=E,this.uint16[J+5]=I,this.uint16[J+6]=P,this.uint16[J+7]=A,this.int16[J+8]=N,this.int16[J+9]=G,this.int16[J+10]=$,this.int16[J+11]=W,s}}_t.prototype.bytesPerElement=24,nn(_t,"StructArrayLayout4i4ui4i24");class Pt extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,_,E){const I=this.length;return this.resize(I+1),this.emplace(I,s,c,d,m,_,E)}emplace(s,c,d,m,_,E,I){const P=10*s,A=5*s;return this.int16[P+0]=c,this.int16[P+1]=d,this.int16[P+2]=m,this.float32[A+2]=_,this.float32[A+3]=E,this.float32[A+4]=I,s}}Pt.prototype.bytesPerElement=20,nn(Pt,"StructArrayLayout3i3f20");class yn extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint32[1*s+0]=c,s}}yn.prototype.bytesPerElement=4,nn(yn,"StructArrayLayout1ul4");class Ln extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,_,E,I,P,A,N,G,$,W){const J=this.length;return this.resize(J+1),this.emplace(J,s,c,d,m,_,E,I,P,A,N,G,$,W)}emplace(s,c,d,m,_,E,I,P,A,N,G,$,W,J){const te=20*s,se=10*s;return this.int16[te+0]=c,this.int16[te+1]=d,this.int16[te+2]=m,this.int16[te+3]=_,this.int16[te+4]=E,this.float32[se+3]=I,this.float32[se+4]=P,this.float32[se+5]=A,this.float32[se+6]=N,this.int16[te+14]=G,this.uint32[se+8]=$,this.uint16[te+18]=W,this.uint16[te+19]=J,s}}Ln.prototype.bytesPerElement=40,nn(Ln,"StructArrayLayout5i4f1i1ul2ui40");class an extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,_,E,I){const P=this.length;return this.resize(P+1),this.emplace(P,s,c,d,m,_,E,I)}emplace(s,c,d,m,_,E,I,P){const A=8*s;return this.int16[A+0]=c,this.int16[A+1]=d,this.int16[A+2]=m,this.int16[A+4]=_,this.int16[A+5]=E,this.int16[A+6]=I,this.int16[A+7]=P,s}}an.prototype.bytesPerElement=16,nn(an,"StructArrayLayout3i2i2i16");class En extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,_){const E=this.length;return this.resize(E+1),this.emplace(E,s,c,d,m,_)}emplace(s,c,d,m,_,E){const I=4*s,P=8*s;return this.float32[I+0]=c,this.float32[I+1]=d,this.float32[I+2]=m,this.int16[P+6]=_,this.int16[P+7]=E,s}}En.prototype.bytesPerElement=16,nn(En,"StructArrayLayout2f1f2i16");class tr extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m){const _=this.length;return this.resize(_+1),this.emplace(_,s,c,d,m)}emplace(s,c,d,m,_){const E=12*s,I=3*s;return this.uint8[E+0]=c,this.uint8[E+1]=d,this.float32[I+1]=m,this.float32[I+2]=_,s}}tr.prototype.bytesPerElement=12,nn(tr,"StructArrayLayout2ub2f12");class Kn extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const _=3*s;return this.float32[_+0]=c,this.float32[_+1]=d,this.float32[_+2]=m,s}}Kn.prototype.bytesPerElement=12,nn(Kn,"StructArrayLayout3f12");class gn extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const _=3*s;return this.uint16[_+0]=c,this.uint16[_+1]=d,this.uint16[_+2]=m,s}}gn.prototype.bytesPerElement=6,nn(gn,"StructArrayLayout3ui6");class ni extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,_,E,I,P,A,N,G,$,W,J,te,se,me,Ie,ye,Se,Me){const Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,s,c,d,m,_,E,I,P,A,N,G,$,W,J,te,se,me,Ie,ye,Se,Me)}emplace(s,c,d,m,_,E,I,P,A,N,G,$,W,J,te,se,me,Ie,ye,Se,Me,Ae){const et=30*s,We=15*s,ft=60*s;return this.int16[et+0]=c,this.int16[et+1]=d,this.int16[et+2]=m,this.float32[We+2]=_,this.float32[We+3]=E,this.uint16[et+8]=I,this.uint16[et+9]=P,this.uint32[We+5]=A,this.uint32[We+6]=N,this.uint32[We+7]=G,this.uint16[et+16]=$,this.uint16[et+17]=W,this.uint16[et+18]=J,this.float32[We+10]=te,this.float32[We+11]=se,this.uint8[ft+48]=me,this.uint8[ft+49]=Ie,this.uint8[ft+50]=ye,this.uint32[We+13]=Se,this.int16[et+28]=Me,this.uint8[ft+58]=Ae,s}}ni.prototype.bytesPerElement=60,nn(ni,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class ui extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,_,E,I,P,A,N,G,$,W,J,te,se,me,Ie,ye,Se,Me,Ae,et,We,ft,St,it,mt,yt,bt){const Lt=this.length;return this.resize(Lt+1),this.emplace(Lt,s,c,d,m,_,E,I,P,A,N,G,$,W,J,te,se,me,Ie,ye,Se,Me,Ae,et,We,ft,St,it,mt,yt,bt)}emplace(s,c,d,m,_,E,I,P,A,N,G,$,W,J,te,se,me,Ie,ye,Se,Me,Ae,et,We,ft,St,it,mt,yt,bt,Lt){const ut=38*s,$t=19*s;return this.int16[ut+0]=c,this.int16[ut+1]=d,this.int16[ut+2]=m,this.float32[$t+2]=_,this.float32[$t+3]=E,this.int16[ut+8]=I,this.int16[ut+9]=P,this.int16[ut+10]=A,this.int16[ut+11]=N,this.int16[ut+12]=G,this.int16[ut+13]=$,this.uint16[ut+14]=W,this.uint16[ut+15]=J,this.uint16[ut+16]=te,this.uint16[ut+17]=se,this.uint16[ut+18]=me,this.uint16[ut+19]=Ie,this.uint16[ut+20]=ye,this.uint16[ut+21]=Se,this.uint16[ut+22]=Me,this.uint16[ut+23]=Ae,this.uint16[ut+24]=et,this.uint16[ut+25]=We,this.uint16[ut+26]=ft,this.uint16[ut+27]=St,this.uint16[ut+28]=it,this.uint32[$t+15]=mt,this.float32[$t+16]=yt,this.float32[$t+17]=bt,this.float32[$t+18]=Lt,s}}ui.prototype.bytesPerElement=76,nn(ui,"StructArrayLayout3i2f6i15ui1ul3f76");class ci extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.float32[1*s+0]=c,s}}ci.prototype.bytesPerElement=4,nn(ci,"StructArrayLayout1f4");class hi extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,_){const E=this.length;return this.resize(E+1),this.emplace(E,s,c,d,m,_)}emplace(s,c,d,m,_,E){const I=5*s;return this.float32[I+0]=c,this.float32[I+1]=d,this.float32[I+2]=m,this.float32[I+3]=_,this.float32[I+4]=E,s}}hi.prototype.bytesPerElement=20,nn(hi,"StructArrayLayout5f20");class Pa extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d,m){const _=this.length;return this.resize(_+1),this.emplace(_,s,c,d,m)}emplace(s,c,d,m,_){const E=6*s;return this.uint32[3*s+0]=c,this.uint16[E+2]=d,this.uint16[E+3]=m,this.uint16[E+4]=_,s}}Pa.prototype.bytesPerElement=12,nn(Pa,"StructArrayLayout1ul3ui12");class Jo extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c){const d=this.length;return this.resize(d+1),this.emplace(d,s,c)}emplace(s,c,d){const m=2*s;return this.uint16[m+0]=c,this.uint16[m+1]=d,s}}Jo.prototype.bytesPerElement=4,nn(Jo,"StructArrayLayout2ui4");class Zs extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint16[1*s+0]=c,s}}Zs.prototype.bytesPerElement=2,nn(Zs,"StructArrayLayout1ui2");class Wl extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c){const d=this.length;return this.resize(d+1),this.emplace(d,s,c)}emplace(s,c,d){const m=2*s;return this.float32[m+0]=c,this.float32[m+1]=d,s}}Wl.prototype.bytesPerElement=8,nn(Wl,"StructArrayLayout2f8");class Fi extends Re{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Fi.prototype.size=40;class fi extends Ln{get(s){return new Fi(this,s)}}nn(fi,"CollisionBoxArray");class qr extends Re{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(s){this._structArray.uint8[this._pos1+49]=s}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(s){this._structArray.uint8[this._pos1+50]=s}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(s){this._structArray.uint32[this._pos4+13]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(s){this._structArray.uint8[this._pos1+58]=s}}qr.prototype.size=60;class bo extends ni{get(s){return new qr(this,s)}}nn(bo,"PlacedSymbolArray");class Wa extends Re{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(s){this._structArray.uint32[this._pos4+15]=s}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Wa.prototype.size=76;class Ai extends ui{get(s){return new Wa(this,s)}}nn(Ai,"SymbolInstanceArray");class as extends ci{getoffsetX(s){return this.float32[1*s+0]}}nn(as,"GlyphOffsetArray");class Xg extends Et{getx(s){return this.int16[2*s+0]}gety(s){return this.int16[2*s+1]}}nn(Xg,"SymbolLineVertexArray");class bh extends Re{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}bh.prototype.size=12;class Jd extends Pa{get(s){return new bh(this,s)}}nn(Jd,"FeatureIndexArray");class Wu extends Jo{geta_centroid_pos0(s){return this.uint16[2*s+0]}geta_centroid_pos1(s){return this.uint16[2*s+1]}}nn(Wu,"FillExtrusionCentroidArray");const Mc=ze([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),wh=ze([{name:"a_dash",components:4,type:"Uint16"}]);var Wg={exports:{}},Qd={exports:{}};Qd.exports=function(u,s){var c,d,m,_,E,I,P,A;for(d=u.length-(c=3&u.length),m=s,E=3432918353,I=461845907,A=0;A<d;)P=255&u.charCodeAt(A)|(255&u.charCodeAt(++A))<<8|(255&u.charCodeAt(++A))<<16|(255&u.charCodeAt(++A))<<24,++A,m=27492+(65535&(_=5*(65535&(m=(m^=P=(65535&(P=(P=(65535&P)*E+(((P>>>16)*E&65535)<<16)&4294967295)<<15|P>>>17))*I+(((P>>>16)*I&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(P=0,c){case 3:P^=(255&u.charCodeAt(A+2))<<16;case 2:P^=(255&u.charCodeAt(A+1))<<8;case 1:m^=P=(65535&(P=(P=(65535&(P^=255&u.charCodeAt(A)))*E+(((P>>>16)*E&65535)<<16)&4294967295)<<15|P>>>17))*I+(((P>>>16)*I&65535)<<16)&4294967295}return m^=u.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0};var Uv=Qd.exports,VP={exports:{}};VP.exports=function(u,s){for(var c,d=u.length,m=s^d,_=0;d>=4;)c=1540483477*(65535&(c=255&u.charCodeAt(_)|(255&u.charCodeAt(++_))<<8|(255&u.charCodeAt(++_))<<16|(255&u.charCodeAt(++_))<<24))+((1540483477*(c>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),d-=4,++_;switch(d){case 3:m^=(255&u.charCodeAt(_+2))<<16;case 2:m^=(255&u.charCodeAt(_+1))<<8;case 1:m=1540483477*(65535&(m^=255&u.charCodeAt(_)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};var GP=Uv,Cz=VP.exports;Wg.exports=GP,Wg.exports.murmur3=GP,Wg.exports.murmur2=Cz;var NE=k(Wg.exports);class K1{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,c,d,m){this.ids.push($P(s)),this.positions.push(c,d,m)}getPositions(s){const c=$P(s);let d=0,m=this.ids.length-1;for(;d<m;){const E=d+m>>1;this.ids[E]>=c?m=E:d=E+1}const _=[];for(;this.ids[d]===c;)_.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return _}static serialize(s,c){const d=new Float64Array(s.ids),m=new Uint32Array(s.positions);return FE(d,m,0,d.length-1),c&&c.push(d.buffer,m.buffer),{ids:d,positions:m}}static deserialize(s){const c=new K1;return c.ids=s.ids,c.positions=s.positions,c.indexed=!0,c}}function $P(u){const s=+u;return!isNaN(s)&&Number.MIN_SAFE_INTEGER<=s&&s<=Number.MAX_SAFE_INTEGER?s:NE(String(u))}function FE(u,s,c,d){for(;c<d;){const m=u[c+d>>1];let _=c-1,E=d+1;for(;;){do _++;while(u[_]<m);do E--;while(u[E]>m);if(_>=E)break;J1(u,_,E),J1(s,3*_,3*E),J1(s,3*_+1,3*E+1),J1(s,3*_+2,3*E+2)}E-c<d-E?(FE(u,s,c,E),c=E+1):(FE(u,s,E+1,d),d=E)}}function J1(u,s,c){const d=u[s];u[s]=u[c],u[c]=d}nn(K1,"FeaturePositionMap");class Eh{constructor(s){this.gl=s.gl,this.initialized=!1}fetchUniformLocation(s,c){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(s,c),this.initialized=!0),!!this.location}}class Q1 extends Eh{constructor(s){super(s),this.current=0}set(s,c,d){this.fetchUniformLocation(s,c)&&this.current!==d&&(this.current=d,this.gl.uniform1f(this.location,d))}}class jP extends Eh{constructor(s){super(s),this.current=[0,0,0,0]}set(s,c,d){this.fetchUniformLocation(s,c)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]&&d[3]===this.current[3]||(this.current=d,this.gl.uniform4f(this.location,d[0],d[1],d[2],d[3])))}}class qP extends Eh{constructor(s){super(s),this.current=uo.transparent}set(s,c,d){this.fetchUniformLocation(s,c)&&(d.r===this.current.r&&d.g===this.current.g&&d.b===this.current.b&&d.a===this.current.a||(this.current=d,this.gl.uniform4f(this.location,d.r,d.g,d.b,d.a)))}}const Pz=new Float32Array(16),Az=new Float32Array(9),Mz=new Float32Array(4);function BE(u){return[De(255*u.r,255*u.g),De(255*u.b,255*u.a)]}class Vv{constructor(s,c,d){this.value=s,this.uniformNames=c.map(m=>`u_${m}`),this.type=d}setUniform(s,c,d,m,_){c.set(s,_,m.constantOr(this.value))}getBinding(s,c){return this.type==="color"?new qP(s):new Q1(s)}}class Hg{constructor(s,c){this.uniformNames=c.map(d=>`u_${d}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(s){this.pixelRatio=s.pixelRatio||1,this.pattern=s.tl.concat(s.br)}setUniform(s,c,d,m,_){const E=_==="u_pattern"||_==="u_dash"?this.pattern:_==="u_pixel_ratio"?this.pixelRatio:null;E&&c.set(s,_,E)}getBinding(s,c){return c==="u_pattern"||c==="u_dash"?new jP(s):new Q1(s)}}class Sh{constructor(s,c,d,m){this.expression=s,this.type=d,this.maxValue=0,this.paintVertexAttributes=c.map(_=>({name:`a_${_}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(s,c,d,m,_,E){const I=this.paintVertexArray.length,P=this.expression.evaluate(new F(0),c,{},_,m,E);this.paintVertexArray.resize(s),this._setPaintValue(I,s,P)}updatePaintArray(s,c,d,m,_){const E=this.expression.evaluate({zoom:0},d,m,void 0,_);this._setPaintValue(s,c,E)}_setPaintValue(s,c,d){if(this.type==="color"){const m=BE(d);for(let _=s;_<c;_++)this.paintVertexArray.emplace(_,m[0],m[1])}else{for(let m=s;m<c;m++)this.paintVertexArray.emplace(m,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Hu{constructor(s,c,d,m,_,E){this.expression=s,this.uniformNames=c.map(I=>`u_${I}_t`),this.type=d,this.useIntegerZoom=m,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=c.map(I=>({name:`a_${I}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new E}populatePaintArray(s,c,d,m,_,E){const I=this.expression.evaluate(new F(this.zoom),c,{},_,m,E),P=this.expression.evaluate(new F(this.zoom+1),c,{},_,m,E),A=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(A,s,I,P)}updatePaintArray(s,c,d,m,_){const E=this.expression.evaluate({zoom:this.zoom},d,m,void 0,_),I=this.expression.evaluate({zoom:this.zoom+1},d,m,void 0,_);this._setPaintValue(s,c,E,I)}_setPaintValue(s,c,d,m){if(this.type==="color"){const _=BE(d),E=BE(m);for(let I=s;I<c;I++)this.paintVertexArray.emplace(I,_[0],_[1],E[0],E[1])}else{for(let _=s;_<c;_++)this.paintVertexArray.emplace(_,d,m);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(m))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,c,d,m,_){const E=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,I=Pe(this.expression.interpolationFactor(E,this.zoom,this.zoom+1),0,1);c.set(s,_,I)}getBinding(s,c){return new Q1(s)}}class Of{constructor(s,c,d,m,_){this.expression=s,this.layerId=_,this.paintVertexAttributes=(d==="array"?wh:Mc).members;for(let E=0;E<c.length;++E);this.paintVertexArray=new m}populatePaintArray(s,c,d){const m=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValues(m,s,c.patterns&&c.patterns[this.layerId],d)}updatePaintArray(s,c,d,m,_,E){this._setPaintValues(s,c,d.patterns&&d.patterns[this.layerId],E)}_setPaintValues(s,c,d,m){if(!m||!d)return;const _=m[d];if(!_)return;const{tl:E,br:I,pixelRatio:P}=_;for(let A=s;A<c;A++)this.paintVertexArray.emplace(A,E[0],E[1],I[0],I[1],P)}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Df{constructor(s,c,d=()=>!0){this.binders={},this._buffers=[];const m=[];for(const _ in s.paint._values){if(!d(_))continue;const E=s.paint.get(_);if(!(E instanceof de&&Sf(E.property.specification)))continue;const I=Oz(_,s.type),P=E.value,A=E.property.specification.type,N=!!E.property.useIntegerZoom,G=_==="line-dasharray"||_.endsWith("pattern"),$=_==="line-dasharray"&&s.layout.get("line-cap").value.kind!=="constant";if(P.kind!=="constant"||$)if(P.kind==="source"||$||G){const W=ZP(_,A,"source");this.binders[_]=G?new Of(P,I,A,W,s.id):new Sh(P,I,A,W),m.push(`/a_${_}`)}else{const W=ZP(_,A,"composite");this.binders[_]=new Hu(P,I,A,N,c,W),m.push(`/z_${_}`)}else this.binders[_]=G?new Hg(P.value,I):new Vv(P.value,I,A),m.push(`/u_${_}`)}this.cacheKey=m.sort().join("")}getMaxValue(s){const c=this.binders[s];return c instanceof Sh||c instanceof Hu?c.maxValue:0}populatePaintArrays(s,c,d,m,_,E){for(const I in this.binders){const P=this.binders[I];(P instanceof Sh||P instanceof Hu||P instanceof Of)&&P.populatePaintArray(s,c,d,m,_,E)}}setConstantPatternPositions(s){for(const c in this.binders){const d=this.binders[c];d instanceof Hg&&d.setConstantPatternPositions(s)}}updatePaintArrays(s,c,d,m,_,E){let I=!1;for(const P in s){const A=c.getPositions(P);for(const N of A){const G=d.feature(N.index);for(const $ in this.binders){const W=this.binders[$];if((W instanceof Sh||W instanceof Hu||W instanceof Of)&&W.expression.isStateDependent===!0){const J=m.paint.get($);W.expression=J.value,W.updatePaintArray(N.start,N.end,G,s[P],_,E),I=!0}}}}return I}defines(){const s=[];for(const c in this.binders){const d=this.binders[c];(d instanceof Vv||d instanceof Hg)&&s.push(...d.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return s}getBinderAttributes(){const s=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof Sh||d instanceof Hu||d instanceof Of)for(let m=0;m<d.paintVertexAttributes.length;m++)s.push(d.paintVertexAttributes[m].name)}return s}getBinderUniforms(){const s=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof Vv||d instanceof Hg||d instanceof Hu)for(const m of d.uniformNames)s.push(m)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s){const c=[];for(const d in this.binders){const m=this.binders[d];if(m instanceof Vv||m instanceof Hg||m instanceof Hu)for(const _ of m.uniformNames)c.push({name:_,property:d,binding:m.getBinding(s,_)})}return c}setUniforms(s,c,d,m,_){for(const{name:E,property:I,binding:P}of d)this.binders[I].setUniform(s,P,_,m.get(I),E)}updatePaintBuffers(){this._buffers=[];for(const s in this.binders){const c=this.binders[s];(c instanceof Sh||c instanceof Hu||c instanceof Of)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(s){for(const c in this.binders){const d=this.binders[c];(d instanceof Sh||d instanceof Hu||d instanceof Of)&&d.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const c=this.binders[s];(c instanceof Sh||c instanceof Hu||c instanceof Of)&&c.destroy()}}}class ep{constructor(s,c,d=()=>!0){this.programConfigurations={};for(const m of s)this.programConfigurations[m.id]=new Df(m,c,d);this.needsUpload=!1,this._featureMap=new K1,this._bufferOffset=0}populatePaintArrays(s,c,d,m,_,E,I){for(const P in this.programConfigurations)this.programConfigurations[P].populatePaintArrays(s,c,m,_,E,I);c.id!==void 0&&this._featureMap.add(c.id,d,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,c,d,m,_){for(const E of d)this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(s,this._featureMap,c,E,m,_)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}const Lz={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Oz(u,s){return Lz[u]||[u.replace(`${s}-`,"").replace(/-/g,"_")]}const Dz={"line-pattern":{source:Ye,composite:Ye},"fill-pattern":{source:Ye,composite:Ye},"fill-extrusion-pattern":{source:Ye,composite:Ye},"line-dasharray":{source:pt,composite:pt}},Rz={color:{source:Wl,composite:wt},number:{source:ci,composite:Wl}};function ZP(u,s,c){const d=Dz[u];return d&&d[c]||Rz[s][c]}nn(Vv,"ConstantBinder"),nn(Hg,"PatternConstantBinder"),nn(Sh,"SourceExpressionBinder"),nn(Of,"PatternCompositeBinder"),nn(Hu,"CompositeExpressionBinder"),nn(Df,"ProgramConfiguration",{omit:["_buffers"]}),nn(ep,"ProgramConfigurationSet");const XP="-transition";class Yu extends Cd{constructor(s,c){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,s.type!=="custom"&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type!=="background"&&s.type!=="sky"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),c.layout&&(this._unevaluatedLayout=new pe(c.layout)),c.paint)){this._transitionablePaint=new Q(c.paint);for(const d in s.paint)this.setPaintProperty(d,s.paint[d],{validate:!1});for(const d in s.layout)this.setLayoutProperty(d,s.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ge(c.paint)}}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,c,d={}){c!=null&&this._validate(LE,`layers.${this.id}.layout.${s}`,s,c,d)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,c):this.visibility=c)}getPaintProperty(s){return Jt(s,XP)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,c,d={}){if(c!=null&&this._validate(ME,`layers.${this.id}.paint.${s}`,s,c,d))return!1;if(Jt(s,XP))return this._transitionablePaint.setTransition(s.slice(0,-11),c||void 0),!1;{const m=this._transitionablePaint._values[s],_=m.value.isDataDriven(),E=m.value;this._transitionablePaint.setValue(s,c),this._handleSpecialPaintPropertyUpdate(s);const I=this._transitionablePaint._values[s].value,P=I.isDataDriven(),A=Jt(s,"pattern")||s==="line-dasharray";return P||_||A||this._handleOverridablePaintPropertyUpdate(s,E,I)}}_handleSpecialPaintPropertyUpdate(s){}getProgramIds(){return null}getProgramConfiguration(s){return null}_handleOverridablePaintPropertyUpdate(s,c,d){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,c){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,c)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),we(s,(c,d)=>!(c===void 0||d==="layout"&&!Object.keys(c).length||d==="paint"&&!Object.keys(c).length))}_validate(s,c,d,m,_={}){return(!_||_.validate!==!1)&&X1(this,s.call(Z1,{key:c,layerType:this.type,objectKey:d,value:m,styleSpec:ct,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const c=this.paint.get(s);if(c instanceof de&&Sf(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=$g(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const kz=ze([{name:"a_pos",components:2,type:"Int16"}],4),Nz=ze([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class wo{constructor(s=[]){this.segments=s}prepareSegment(s,c,d,m){let _=this.segments[this.segments.length-1];return s>wo.MAX_VERTEX_ARRAY_LENGTH&&nt(`Max vertices per segment is ${wo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!_||_.vertexLength+s>wo.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==m)&&(_={vertexOffset:c.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0},m!==void 0&&(_.sortKey=m),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const s of this.segments)for(const c in s.vaos)s.vaos[c].destroy()}static simpleSegment(s,c,d,m){return new wo([{vertexOffset:s,primitiveOffset:c,vertexLength:d,primitiveLength:m,vaos:{},sortKey:0}])}}wo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,nn(wo,"SegmentVector");var bn=8192;class Rf{constructor(s,c){s&&(c?this.setSouthWest(s).setNorthEast(c):s.length===4?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1]))}setNorthEast(s){return this._ne=s instanceof di?new di(s.lng,s.lat):di.convert(s),this}setSouthWest(s){return this._sw=s instanceof di?new di(s.lng,s.lat):di.convert(s),this}extend(s){const c=this._sw,d=this._ne;let m,_;if(s instanceof di)m=s,_=s;else{if(!(s instanceof Rf))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(Rf.convert(s)):this.extend(di.convert(s)):typeof s=="object"&&s!==null&&s.hasOwnProperty("lat")&&(s.hasOwnProperty("lon")||s.hasOwnProperty("lng"))?this.extend(di.convert(s)):this;if(m=s._sw,_=s._ne,!m||!_)return this}return c||d?(c.lng=Math.min(m.lng,c.lng),c.lat=Math.min(m.lat,c.lat),d.lng=Math.max(_.lng,d.lng),d.lat=Math.max(_.lat,d.lat)):(this._sw=new di(m.lng,m.lat),this._ne=new di(_.lng,_.lat)),this}getCenter(){return new di((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new di(this.getWest(),this.getNorth())}getSouthEast(){return new di(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:c,lat:d}=di.convert(s);let m=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&m}static convert(s){return!s||s instanceof Rf?s:new Rf(s)}}var ex=1e-6,Xs=typeof Float32Array<"u"?Float32Array:Array;function WP(){var u=new Xs(9);return Xs!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[5]=0,u[6]=0,u[7]=0),u[0]=1,u[4]=1,u[8]=1,u}function HP(u,s,c){var d=s[0],m=s[1],_=s[2],E=s[3],I=s[4],P=s[5],A=s[6],N=s[7],G=s[8],$=c[0],W=c[1],J=c[2],te=c[3],se=c[4],me=c[5],Ie=c[6],ye=c[7],Se=c[8];return u[0]=$*d+W*E+J*A,u[1]=$*m+W*I+J*N,u[2]=$*_+W*P+J*G,u[3]=te*d+se*E+me*A,u[4]=te*m+se*I+me*N,u[5]=te*_+se*P+me*G,u[6]=Ie*d+ye*E+Se*A,u[7]=Ie*m+ye*I+Se*N,u[8]=Ie*_+ye*P+Se*G,u}function Ku(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function zE(u,s){var c=s[0],d=s[1],m=s[2],_=s[3],E=s[4],I=s[5],P=s[6],A=s[7],N=s[8],G=s[9],$=s[10],W=s[11],J=s[12],te=s[13],se=s[14],me=s[15],Ie=c*I-d*E,ye=c*P-m*E,Se=c*A-_*E,Me=d*P-m*I,Ae=d*A-_*I,et=m*A-_*P,We=N*te-G*J,ft=N*se-$*J,St=N*me-W*J,it=G*se-$*te,mt=G*me-W*te,yt=$*me-W*se,bt=Ie*yt-ye*mt+Se*it+Me*St-Ae*ft+et*We;return bt?(u[0]=(I*yt-P*mt+A*it)*(bt=1/bt),u[1]=(m*mt-d*yt-_*it)*bt,u[2]=(te*et-se*Ae+me*Me)*bt,u[3]=($*Ae-G*et-W*Me)*bt,u[4]=(P*St-E*yt-A*ft)*bt,u[5]=(c*yt-m*St+_*ft)*bt,u[6]=(se*Se-J*et-me*ye)*bt,u[7]=(N*et-$*Se+W*ye)*bt,u[8]=(E*mt-I*St+A*We)*bt,u[9]=(d*St-c*mt-_*We)*bt,u[10]=(J*Ae-te*Se+me*Ie)*bt,u[11]=(G*Se-N*Ae-W*Ie)*bt,u[12]=(I*ft-E*it-P*We)*bt,u[13]=(c*it-d*ft+m*We)*bt,u[14]=(te*ye-J*Me-se*Ie)*bt,u[15]=(N*Me-G*ye+$*Ie)*bt,u):null}function tp(u,s,c){var d=s[0],m=s[1],_=s[2],E=s[3],I=s[4],P=s[5],A=s[6],N=s[7],G=s[8],$=s[9],W=s[10],J=s[11],te=s[12],se=s[13],me=s[14],Ie=s[15],ye=c[0],Se=c[1],Me=c[2],Ae=c[3];return u[0]=ye*d+Se*I+Me*G+Ae*te,u[1]=ye*m+Se*P+Me*$+Ae*se,u[2]=ye*_+Se*A+Me*W+Ae*me,u[3]=ye*E+Se*N+Me*J+Ae*Ie,u[4]=(ye=c[4])*d+(Se=c[5])*I+(Me=c[6])*G+(Ae=c[7])*te,u[5]=ye*m+Se*P+Me*$+Ae*se,u[6]=ye*_+Se*A+Me*W+Ae*me,u[7]=ye*E+Se*N+Me*J+Ae*Ie,u[8]=(ye=c[8])*d+(Se=c[9])*I+(Me=c[10])*G+(Ae=c[11])*te,u[9]=ye*m+Se*P+Me*$+Ae*se,u[10]=ye*_+Se*A+Me*W+Ae*me,u[11]=ye*E+Se*N+Me*J+Ae*Ie,u[12]=(ye=c[12])*d+(Se=c[13])*I+(Me=c[14])*G+(Ae=c[15])*te,u[13]=ye*m+Se*P+Me*$+Ae*se,u[14]=ye*_+Se*A+Me*W+Ae*me,u[15]=ye*E+Se*N+Me*J+Ae*Ie,u}function Gv(u,s,c){var d,m,_,E,I,P,A,N,G,$,W,J,te=c[0],se=c[1],me=c[2];return s===u?(u[12]=s[0]*te+s[4]*se+s[8]*me+s[12],u[13]=s[1]*te+s[5]*se+s[9]*me+s[13],u[14]=s[2]*te+s[6]*se+s[10]*me+s[14],u[15]=s[3]*te+s[7]*se+s[11]*me+s[15]):(m=s[1],_=s[2],E=s[3],I=s[4],P=s[5],A=s[6],N=s[7],G=s[8],$=s[9],W=s[10],J=s[11],u[0]=d=s[0],u[1]=m,u[2]=_,u[3]=E,u[4]=I,u[5]=P,u[6]=A,u[7]=N,u[8]=G,u[9]=$,u[10]=W,u[11]=J,u[12]=d*te+I*se+G*me+s[12],u[13]=m*te+P*se+$*me+s[13],u[14]=_*te+A*se+W*me+s[14],u[15]=E*te+N*se+J*me+s[15]),u}function np(u,s,c){var d=c[0],m=c[1],_=c[2];return u[0]=s[0]*d,u[1]=s[1]*d,u[2]=s[2]*d,u[3]=s[3]*d,u[4]=s[4]*m,u[5]=s[5]*m,u[6]=s[6]*m,u[7]=s[7]*m,u[8]=s[8]*_,u[9]=s[9]*_,u[10]=s[10]*_,u[11]=s[11]*_,u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15],u}function UE(u,s,c){var d=Math.sin(c),m=Math.cos(c),_=s[4],E=s[5],I=s[6],P=s[7],A=s[8],N=s[9],G=s[10],$=s[11];return s!==u&&(u[0]=s[0],u[1]=s[1],u[2]=s[2],u[3]=s[3],u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15]),u[4]=_*m+A*d,u[5]=E*m+N*d,u[6]=I*m+G*d,u[7]=P*m+$*d,u[8]=A*m-_*d,u[9]=N*m-E*d,u[10]=G*m-I*d,u[11]=$*m-P*d,u}function tx(u,s,c){var d=Math.sin(c),m=Math.cos(c),_=s[0],E=s[1],I=s[2],P=s[3],A=s[8],N=s[9],G=s[10],$=s[11];return s!==u&&(u[4]=s[4],u[5]=s[5],u[6]=s[6],u[7]=s[7],u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15]),u[0]=_*m-A*d,u[1]=E*m-N*d,u[2]=I*m-G*d,u[3]=P*m-$*d,u[8]=_*d+A*m,u[9]=E*d+N*m,u[10]=I*d+G*m,u[11]=P*d+$*m,u}function YP(u,s){return u[0]=s[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=s[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=s[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function KP(u,s,c){var d,m,_,E=c[0],I=c[1],P=c[2],A=Math.hypot(E,I,P);return A<ex?null:(E*=A=1/A,I*=A,P*=A,d=Math.sin(s),m=Math.cos(s),u[0]=E*E*(_=1-m)+m,u[1]=I*E*_+P*d,u[2]=P*E*_-I*d,u[3]=0,u[4]=E*I*_-P*d,u[5]=I*I*_+m,u[6]=P*I*_+E*d,u[7]=0,u[8]=E*P*_+I*d,u[9]=I*P*_-E*d,u[10]=P*P*_+m,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u)}Math.hypot||(Math.hypot=function(){for(var u=0,s=arguments.length;s--;)u+=arguments[s]*arguments[s];return Math.sqrt(u)});var Fz=tp;function VE(){var u=new Xs(3);return Xs!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u}function JP(u){var s=new Xs(3);return s[0]=u[0],s[1]=u[1],s[2]=u[2],s}function $v(u){return Math.hypot(u[0],u[1],u[2])}function Yg(u,s,c){var d=new Xs(3);return d[0]=u,d[1]=s,d[2]=c,d}function Th(u,s,c){return u[0]=s[0]+c[0],u[1]=s[1]+c[1],u[2]=s[2]+c[2],u}function GE(u,s,c){return u[0]=s[0]-c[0],u[1]=s[1]-c[1],u[2]=s[2]-c[2],u}function QP(u,s,c){return u[0]=s[0]*c[0],u[1]=s[1]*c[1],u[2]=s[2]*c[2],u}function jv(u,s,c){return u[0]=Math.min(s[0],c[0]),u[1]=Math.min(s[1],c[1]),u[2]=Math.min(s[2],c[2]),u}function qv(u,s,c){return u[0]=Math.max(s[0],c[0]),u[1]=Math.max(s[1],c[1]),u[2]=Math.max(s[2],c[2]),u}function vl(u,s,c){return u[0]=s[0]*c,u[1]=s[1]*c,u[2]=s[2]*c,u}function Zv(u,s,c,d){return u[0]=s[0]+c[0]*d,u[1]=s[1]+c[1]*d,u[2]=s[2]+c[2]*d,u}function ss(u,s){var c=s[0],d=s[1],m=s[2],_=c*c+d*d+m*m;return _>0&&(_=1/Math.sqrt(_)),u[0]=s[0]*_,u[1]=s[1]*_,u[2]=s[2]*_,u}function Hl(u,s){return u[0]*s[0]+u[1]*s[1]+u[2]*s[2]}function $E(u,s,c){var d=s[0],m=s[1],_=s[2],E=c[0],I=c[1],P=c[2];return u[0]=m*P-_*I,u[1]=_*E-d*P,u[2]=d*I-m*E,u}function co(u,s,c){var d=s[0],m=s[1],_=s[2],E=c[3]*d+c[7]*m+c[11]*_+c[15];return u[0]=(c[0]*d+c[4]*m+c[8]*_+c[12])/(E=E||1),u[1]=(c[1]*d+c[5]*m+c[9]*_+c[13])/E,u[2]=(c[2]*d+c[6]*m+c[10]*_+c[14])/E,u}function eA(u,s,c){var d=c[0],m=c[1],_=c[2],E=s[0],I=s[1],P=s[2],A=m*P-_*I,N=_*E-d*P,G=d*I-m*E,$=m*G-_*N,W=_*A-d*G,J=d*N-m*A,te=2*c[3];return N*=te,G*=te,W*=2,J*=2,u[0]=E+(A*=te)+($*=2),u[1]=I+N+W,u[2]=P+G+J,u}var Xv,Ju=GE,Bz=QP,zz=$v;function tA(u,s,c){return u[0]=s[0]*c,u[1]=s[1]*c,u[2]=s[2]*c,u[3]=s[3]*c,u}function nA(u,s){var c=s[0],d=s[1],m=s[2],_=s[3],E=c*c+d*d+m*m+_*_;return E>0&&(E=1/Math.sqrt(E)),u[0]=c*E,u[1]=d*E,u[2]=m*E,u[3]=_*E,u}function rp(u,s,c){var d=s[0],m=s[1],_=s[2],E=s[3];return u[0]=c[0]*d+c[4]*m+c[8]*_+c[12]*E,u[1]=c[1]*d+c[5]*m+c[9]*_+c[13]*E,u[2]=c[2]*d+c[6]*m+c[10]*_+c[14]*E,u[3]=c[3]*d+c[7]*m+c[11]*_+c[15]*E,u}function rA(){var u=new Xs(4);return Xs!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u[3]=1,u}function iA(u){return u[0]=0,u[1]=0,u[2]=0,u[3]=1,u}function oA(u,s,c){c*=.5;var d=s[0],m=s[1],_=s[2],E=s[3],I=Math.sin(c),P=Math.cos(c);return u[0]=d*P+E*I,u[1]=m*P+_*I,u[2]=_*P-m*I,u[3]=E*P-d*I,u}function aA(u,s,c){c*=.5;var d=s[0],m=s[1],_=s[2],E=s[3],I=Math.sin(c),P=Math.cos(c);return u[0]=d*P-_*I,u[1]=m*P+E*I,u[2]=_*P+d*I,u[3]=E*P-m*I,u}VE(),Xv=new Xs(4),Xs!=Float32Array&&(Xv[0]=0,Xv[1]=0,Xv[2]=0,Xv[3]=0);var Uz=nA;VE(),Yg(1,0,0),Yg(0,1,0),rA(),rA(),WP();const Vz=ze([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:sA}=Vz,lA=ze([{name:"a_pos_3",components:3,type:"Int16"}]);var Wv=ze([{name:"a_pos",type:"Int16",components:2}]);class jE{constructor(s,c){this.pos=s,this.dir=c}intersectsPlane(s,c,d){const m=Hl(c,this.dir);if(Math.abs(m)<1e-6)return!1;const _=((s[0]-this.pos[0])*c[0]+(s[1]-this.pos[1])*c[1]+(s[2]-this.pos[2])*c[2])/m;return d[0]=this.pos[0]+this.dir[0]*_,d[1]=this.pos[1]+this.dir[1]*_,d[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(s,c,d){if(function(W,J){var te=W[0],se=W[1],me=W[2],Ie=J[0],ye=J[1],Se=J[2];return Math.abs(te-Ie)<=ex*Math.max(1,Math.abs(te),Math.abs(Ie))&&Math.abs(se-ye)<=ex*Math.max(1,Math.abs(se),Math.abs(ye))&&Math.abs(me-Se)<=ex*Math.max(1,Math.abs(me),Math.abs(Se))}(this.pos,s)||c===0)return d[0]=d[1]=d[2]=0,!1;const[m,_,E]=this.dir,I=this.pos[0]-s[0],P=this.pos[1]-s[1],A=this.pos[2]-s[2],N=m*m+_*_+E*E,G=2*(I*m+P*_+A*E),$=G*G-4*N*(I*I+P*P+A*A-c*c);if($<0){const W=Math.max(-G/2,0),J=I+m*W,te=P+_*W,se=A+E*W,me=Math.hypot(J,te,se);return d[0]=J*c/me,d[1]=te*c/me,d[2]=se*c/me,!1}{const W=(-G-Math.sqrt($))/(2*N);if(W<0){const J=Math.hypot(I,P,A);return d[0]=I*c/J,d[1]=P*c/J,d[2]=A*c/J,!1}return d[0]=I+m*W,d[1]=P+_*W,d[2]=A+E*W,!0}}}class qE{constructor(s,c,d,m,_){this.TL=s,this.TR=c,this.BR=d,this.BL=m,this.horizon=_}static fromInvProjectionMatrix(s,c,d){const m=[-1,1,1],_=[1,1,1],E=[1,-1,1],I=[-1,-1,1],P=co(m,m,s),A=co(_,_,s),N=co(E,E,s),G=co(I,I,s);return new qE(P,A,N,G,c/d)}}class ZE{constructor(s,c){this.points=s,this.planes=c}static fromInvProjectionMatrix(s,c,d,m){const _=Math.pow(2,d),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(P=>{const A=rp([],P,s),N=1/A[3]/c*_;return function(G,$,W){return G[0]=$[0]*W[0],G[1]=$[1]*W[1],G[2]=$[2]*W[2],G[3]=$[3]*W[3],G}(A,A,[N,N,m?1/A[3]:N,N])}),I=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(P=>{const A=ss([],$E([],Ju([],E[P[0]],E[P[1]]),Ju([],E[P[2]],E[P[1]]))),N=-Hl(A,E[P[1]]);return A.concat(N)});return new ZE(E,I)}}class ls{static fromPoints(s){const c=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];for(const m of s)jv(c,c,m),qv(d,d,m);return new ls(c,d)}static applyTransform(s,c){const d=s.getCorners();for(let m=0;m<d.length;++m)co(d[m],d[m],c);return ls.fromPoints(d)}constructor(s,c){this.min=s,this.max=c,this.center=vl([],Th([],this.min,this.max),.5)}quadrant(s){const c=[s%2==0,s<2],d=JP(this.min),m=JP(this.max);for(let _=0;_<c.length;_++)d[_]=c[_]?this.min[_]:this.center[_],m[_]=c[_]?this.center[_]:this.max[_];return m[2]=this.max[2],new ls(d,m)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}distanceZ(s){return Math.max(Math.min(this.max[2],s[2]),this.min[2])-s[2]}getCorners(){const s=this.min,c=this.max;return[[s[0],s[1],s[2]],[c[0],s[1],s[2]],[c[0],c[1],s[2]],[s[0],c[1],s[2]],[s[0],s[1],c[2]],[c[0],s[1],c[2]],[c[0],c[1],c[2]],[s[0],c[1],c[2]]]}intersects(s){const c=this.getCorners();let d=!0;for(let m=0;m<s.planes.length;m++){const _=s.planes[m];let E=0;for(let I=0;I<c.length;I++)E+=Hl(_,c[I])+_[3]>=0;if(E===0)return 0;E!==c.length&&(d=!1)}if(d)return 2;for(let m=0;m<3;m++){let _=Number.MAX_VALUE,E=-Number.MAX_VALUE;for(let I=0;I<s.points.length;I++){const P=s.points[I][m]-this.min[m];_=Math.min(_,P),E=Math.max(E,P)}if(E<0||_>this.max[m]-this.min[m])return 0}return 1}}const XE=5,uA=6,Lc=bn/Math.PI/2,Gz=16383,ip=64,Hv=[ip,32,16],Yl=-Lc,Kl=Lc,$z=[new ls([Yl,Yl,Yl],[Kl,Kl,Kl]),new ls([Yl,Yl,Yl],[0,0,Kl]),new ls([0,Yl,Yl],[Kl,0,Kl]),new ls([Yl,0,Yl],[0,Kl,Kl]),new ls([0,0,Yl],[Kl,Kl,Kl])];function nx(u){return u*Lc/Jv}function cA(u,s,c,d=!0){const m=vl([],u._camera.position,u.worldSize),_=[s,c,1,1];rp(_,_,u.pixelMatrixInverse),tA(_,_,1/_[3]);const E=ss([],Ju([],_,m)),I=u.globeMatrix,P=[I[12],I[13],I[14]],A=Ju([],P,m),N=$v(A),G=ss([],A),$=u.worldSize/(2*Math.PI),W=Hl(G,E),J=Math.asin($/N);if(J<Math.acos(W)){if(!d)return null;const St=[],it=[];vl(St,E,N/W),ss(it,Ju(it,St,A)),ss(E,Th(E,A,vl(E,it,Math.tan(J)*N)))}const te=[];new jE(m,E).closestPointOnSphere(P,$,te);const se=ss([],un(I,0)),me=ss([],un(I,1)),Ie=ss([],un(I,2)),ye=Hl(se,te),Se=Hl(me,te),Me=Hl(Ie,te),Ae=ve(Math.asin(-Se/$));let et=ve(Math.atan2(ye,Me));et=u.center.lng+function(St,it){const mt=(it-St+180)%360-180;return mt<-180?mt+360:mt}(u.center.lng,et);const We=Dc(et),ft=Pe(Rc(Ae),0,1);return new em(We,ft)}class jz{constructor(s,c,d){this.a=Ju([],s,d),this.b=Ju([],c,d),this.center=d;const m=ss([],this.a),_=ss([],this.b);this.angle=Math.acos(Hl(m,_))}}function WE(u,s){if(u.angle===0)return null;let c;return c=u.a[s]===0?1/u.angle*.5*Math.PI:1/u.angle*Math.atan(u.b[s]/u.a[s]/Math.sin(u.angle)-1/Math.tan(u.angle)),c<0||c>1?null:function(d,m,_,E){const I=Math.sin(_);return d*(Math.sin((1-E)*_)/I)+m*(Math.sin(E*_)/I)}(u.a[s],u.b[s],u.angle,Pe(c,0,1))+u.center[s]}function Oc(u){if(u.z<=1)return $z[u.z+2*u.y+u.x];const s=HE(rx(u));return ls.fromPoints(s)}function op(u,s,c){return vl(u,u,1-c),Zv(u,u,s,c)}function hA(u,s){const c=Qg(s.zoom);if(c===0)return Oc(u);const d=rx(u),m=HE(d),_=Dc(d.getWest())*s.worldSize,E=Dc(d.getEast())*s.worldSize,I=Rc(d.getNorth())*s.worldSize,P=Rc(d.getSouth())*s.worldSize,A=[_,I,0],N=[E,I,0],G=[_,P,0],$=[E,P,0],W=zE([],s.globeMatrix);return co(A,A,W),co(N,N,W),co(G,G,W),co($,$,W),m[0]=op(m[0],G,c),m[1]=op(m[1],$,c),m[2]=op(m[2],N,c),m[3]=op(m[3],A,c),ls.fromPoints(m)}function fA(u,s,c){for(const d of u)co(d,d,s),vl(d,d,c)}function qz(u,s,c){const d=s/u.worldSize,m=u.globeMatrix;if(c.z<=1){const We=Oc(c).getCorners();return fA(We,m,d),ls.fromPoints(We)}const _=rx(c),E=HE(_);fA(E,m,d);const I=Number.MAX_VALUE,P=[-I,-I,-I],A=[I,I,I];if(_.contains(u.center)){for(const St of E)jv(A,A,St),qv(P,P,St);P[2]=0;const We=u.point,ft=[We.x*d,We.y*d,0];return jv(A,A,ft),qv(P,P,ft),new ls(A,P)}const N=[m[12]*d,m[13]*d,m[14]*d],G=_.getCenter(),$=Pe(u.center.lat,-Ma,Ma),W=Pe(G.lat,-Ma,Ma),J=Dc(u.center.lng),te=Rc($);let se=J-Dc(G.lng);const me=te-Rc(W);se>.5?se-=1:se<-.5&&(se+=1);let Ie=0;Math.abs(se)>Math.abs(me)?Ie=se>=0?1:3:(Ie=me>=0?0:2,Zv(N,N,[m[4]*d,m[5]*d,m[6]*d],-Math.sin(ae(me>=0?_.getSouth():_.getNorth()))*Lc));const ye=E[Ie],Se=E[(Ie+1)%4],Me=new jz(ye,Se,N),Ae=[WE(Me,0)||ye[0],WE(Me,1)||ye[1],WE(Me,2)||ye[2]],et=Qg(u.zoom);if(et>0){const We=function({x:St,y:it,z:mt},yt,bt,Lt,ut){const $t=1/(1<<mt);let sn=St*$t,qt=sn+$t,Fn=it*$t,Ot=Fn+$t,vn=0;const Bn=(sn+qt)/2-Lt;return Bn>.5?vn=-1:Bn<-.5&&(vn=1),sn=((sn+vn)*yt-(Lt*=yt))*bt+Lt,qt=((qt+vn)*yt-Lt)*bt+Lt,Fn=(Fn*yt-(ut*=yt))*bt+ut,Ot=(Ot*yt-ut)*bt+ut,[[sn,Ot,0],[qt,Ot,0],[qt,Fn,0],[sn,Fn,0]]}(c,s,u._pixelsPerMercatorPixel,J,te);for(let St=0;St<E.length;St++)op(E[St],We[St],et);const ft=Th([],We[Ie],We[(Ie+1)%4]);vl(ft,ft,.5),op(Ae,ft,et)}for(const We of E)jv(A,A,We),qv(P,P,We);return A[2]=Math.min(ye[2],Se[2]),jv(A,A,Ae),qv(P,P,Ae),new ls(A,P)}function rx({x:u,y:s,z:c}){const d=1/(1<<c),m=new di(_l(u*d),Aa((s+1)*d)),_=new di(_l((u+1)*d),Aa(s*d));return new Rf(m,_)}function HE(u){const s=ae(u.getNorth()),c=ae(u.getSouth()),d=Math.cos(s),m=Math.cos(c),_=Math.sin(s),E=Math.sin(c),I=u.getWest(),P=u.getEast();return[Kg(m,E,I),Kg(m,E,P),Kg(d,_,P),Kg(d,_,I)]}function Kg(u,s,c,d=Lc){return c=ae(c),[u*Math.sin(c)*d,-s*d,u*Math.cos(c)*d]}function Jg(u,s,c){return Kg(Math.cos(ae(u)),Math.sin(ae(u)),s,c)}function Yv(u,s,c,d){const m=1<<c.z,_=(u/bn+c.x)/m;return Jg(Aa((s/bn+c.y)/m),_l(_),d)}function ix({min:u,max:s}){return Gz/Math.max(s[0]-u[0],s[1]-u[1],s[2]-u[2])}const dA=new Float64Array(16);function Kv(u){const s=ix(u),c=YP(dA,[s,s,s]);return Gv(c,c,((d=[])[0]=-(m=u.min)[0],d[1]=-m[1],d[2]=-m[2],d));var d,m}function YE(u){const s=(d=u.min,(c=dA)[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=d[0],c[13]=d[1],c[14]=d[2],c[15]=1,c);var c,d;const m=1/ix(u);return np(s,s,[m,m,m])}function pA(u,s,c,d,m){const _=function(P){const A=bn/(2*Math.PI);return P/(2*Math.PI)/A}(c),E=[u,s,-c/(2*Math.PI)],I=Ku(new Float64Array(16));return Gv(I,I,E),np(I,I,[_,_,_]),UE(I,I,ae(-m)),tx(I,I,ae(-d)),I}function Qg(u){return Ke(XE,uA,u)}function gA(u,s){const c=Jg(s.lat,s.lng),d=function(J){const te=Jg(J._center.lat,J._center.lng);let se=$E([],Yg(0,1,0),te);const me=KP([],-J.angle,te);se=co(se,se,me),KP(me,-J._pitch,se);const Ie=ss([],te);return vl(Ie,Ie,nx(J.cameraToCenterDistance/J.pixelsPerMeter)),co(Ie,Ie,me),Th([],te,Ie)}(u);return E=(m=GE([],d,c))[0],I=m[1],P=m[2],A=(_=c)[0],N=_[1],G=_[2],W=($=Math.sqrt(E*E+I*I+P*P)*Math.sqrt(A*A+N*N+G*G))&&Hl(m,_)/$,Math.acos(Math.min(Math.max(W,-1),1));var m,_,E,I,P,A,N,G,$,W}function KE(u,s){return gA(u,s)>Math.PI/2*1.01}const mA=ae(85),Zz=Math.cos(mA),Xz=Math.sin(mA),Jv=63710088e-1,yA=2*Math.PI*Jv;class kf{constructor(s,c){if(isNaN(s)||isNaN(c))throw new Error(`Invalid LngLat object: (${s}, ${c})`);if(this.lng=+s,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new kf(Be(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const c=Math.PI/180,d=this.lat*c,m=s.lat*c,_=Math.sin(d)*Math.sin(m)+Math.cos(d)*Math.cos(m)*Math.cos((s.lng-this.lng)*c);return Jv*Math.acos(Math.min(_,1))}toBounds(s=0){const c=360*s/40075017,d=c/Math.cos(Math.PI/180*this.lat);return new Rf(new kf(this.lng-d,this.lat-c),new kf(this.lng+d,this.lat+c))}toEcef(s){const c=nx(s);return Jg(this.lat,this.lng,Lc+c)}static convert(s){if(s instanceof kf)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new kf(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new kf(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var di=kf;function JE(u){return yA*Math.cos(u*Math.PI/180)}function Dc(u){return(180+u)/360}function Rc(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function Qu(u,s){return u/JE(s)}function _l(u){return 360*u-180}function Aa(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function vA(u,s){return u*JE(Aa(s))}const Ma=85.051129;function _A(u){return 1/Math.cos(u*Math.PI/180)}class em{constructor(s,c,d=0){this.x=+s,this.y=+c,this.z=+d}static fromLngLat(s,c=0){const d=di.convert(s);return new em(Dc(d.lng),Rc(d.lat),Qu(c,d.lat))}toLngLat(){return new di(_l(this.x),Aa(this.y))}toAltitude(){return vA(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/yA*_A(Aa(this.y))}}function QE(u,s,c,d,m,_,E,I,P){const A=(s+d)/2,N=(c+m)/2,G=new U(A,N);I(G),function($,W,J,te,se,me){const Ie=J-se,ye=te-me;return Math.abs((te-W)*Ie-(J-$)*ye)/Math.hypot(Ie,ye)}(G.x,G.y,_.x,_.y,E.x,E.y)>=P?(QE(u,s,c,A,N,_,G,I,P),QE(u,A,N,d,m,G,E,I,P)):u.push(E)}function xA(u,s,c){let d=u[0],m=d.x,_=d.y;s(d);const E=[d];for(let I=1;I<u.length;I++){const P=u[I],{x:A,y:N}=P;s(P),QE(E,m,_,A,N,d,P,s,c),m=A,_=N,d=P}return E}function eS(u,s,c,d){if(d(s,c)){const m=s.add(c)._mult(.5);eS(u,s,m,d),eS(u,m,c,d)}else u.push(c)}function Wz(u,s){let c=u[0];const d=[c];for(let m=1;m<u.length;m++){const _=u[m];eS(d,c,_,s),c=_}return d}const tS=Math.pow(2,14)-1,bA=-tS-1;function Hz(u,s){const c=Math.round(u.x*s),d=Math.round(u.y*s);return u.x=Pe(c,bA,tS),u.y=Pe(d,bA,tS),(c<u.x||c>u.x+1||d<u.y||d>u.y+1)&&nt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),u}function Ih(u,s,c){const d=u.loadGeometry(),m=u.extent,_=bn/m;if(s&&c&&c.projection.isReprojectedInTileSpace){const E=1<<s.z,{scale:I,x:P,y:A,projection:N}=c,G=$=>{const W=_l((s.x+$.x/m)/E),J=Aa((s.y+$.y/m)/E),te=N.project(W,J);$.x=(te.x*I-P)*m,$.y=(te.y*I-A)*m};for(let $=0;$<d.length;$++)if(u.type!==1)d[$]=xA(d[$],G,1);else{const W=[];for(const J of d[$])J.x<0||J.x>=m||J.y<0||J.y>=m||(G(J),W.push(J));d[$]=W}}for(const E of d)for(const I of E)Hz(I,_);return d}function ap(u,s){return{type:u.type,id:u.id,properties:u.properties,geometry:s?Ih(u):[]}}function ox(u,s,c,d,m){u.emplaceBack(2*s+(d+1)/2,2*c+(m+1)/2)}function ax(u,s,c){u.emplaceBack(s.x,s.y,s.z,c[0]*16384,c[1]*16384,c[2]*16384)}class nS{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.projection=s.projection,this.layoutVertexArray=new Et,this.indexArray=new gn,this.segments=new wo,this.programConfigurations=new ep(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,d,m){const _=this.layers[0],E=[];let I=null;_.type==="circle"&&(I=_.layout.get("circle-sort-key"));for(const{feature:A,id:N,index:G,sourceLayerIndex:$}of s){const W=this.layers[0]._featureFilter.needGeometry,J=ap(A,W);if(!this.layers[0]._featureFilter.filter(new F(this.zoom),J,d))continue;const te=I?I.evaluate(J,{},d):void 0,se={id:N,properties:A.properties,type:A.type,sourceLayerIndex:$,index:G,geometry:W?J.geometry:Ih(A,d,m),patterns:{},sortKey:te};E.push(se)}I&&E.sort((A,N)=>A.sortKey-N.sortKey);let P=null;m.projection.name==="globe"&&(this.globeExtVertexArray=new It,P=m.projection);for(const A of E){const{geometry:N,index:G,sourceLayerIndex:$}=A,W=s[G].feature;this.addFeature(A,N,G,c.availableImages,d,P),c.featureIndex.insert(W,N,G,$,this.index)}}update(s,c,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,kz.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,Nz.members))),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(s,c,d,m,_,E){for(const I of c)for(const P of I){const A=P.x,N=P.y;if(A<0||A>=bn||N<0||N>=bn)continue;if(E){const W=E.projectTilePoint(A,N,_),J=E.upVector(_,A,N),te=this.globeExtVertexArray;ax(te,W,J),ax(te,W,J),ax(te,W,J),ax(te,W,J)}const G=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),$=G.vertexLength;ox(this.layoutVertexArray,A,N,-1,-1),ox(this.layoutVertexArray,A,N,1,-1),ox(this.layoutVertexArray,A,N,1,1),ox(this.layoutVertexArray,A,N,-1,1),this.indexArray.emplaceBack($,$+1,$+2),this.indexArray.emplaceBack($,$+2,$+3),G.vertexLength+=4,G.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,{},m,_)}}function wA(u,s){for(let c=0;c<u.length;c++)if(sp(s,u[c]))return!0;for(let c=0;c<s.length;c++)if(sp(u,s[c]))return!0;return!!rS(u,s)}function Yz(u,s,c){return!!sp(u,s)||!!iS(s,u,c)}function EA(u,s){if(u.length===1)return TA(s,u[0]);for(let c=0;c<s.length;c++){const d=s[c];for(let m=0;m<d.length;m++)if(sp(u,d[m]))return!0}for(let c=0;c<u.length;c++)if(TA(s,u[c]))return!0;for(let c=0;c<s.length;c++)if(rS(u,s[c]))return!0;return!1}function Kz(u,s,c){if(u.length>1){if(rS(u,s))return!0;for(let d=0;d<s.length;d++)if(iS(s[d],u,c))return!0}for(let d=0;d<u.length;d++)if(iS(u[d],s,c))return!0;return!1}function rS(u,s){if(u.length===0||s.length===0)return!1;for(let c=0;c<u.length-1;c++){const d=u[c],m=u[c+1];for(let _=0;_<s.length-1;_++)if(Jz(d,m,s[_],s[_+1]))return!0}return!1}function Jz(u,s,c,d){return st(u,c,d)!==st(s,c,d)&&st(u,s,c)!==st(u,s,d)}function iS(u,s,c){const d=c*c;if(s.length===1)return u.distSqr(s[0])<d;for(let m=1;m<s.length;m++)if(SA(u,s[m-1],s[m])<d)return!0;return!1}function SA(u,s,c){const d=s.distSqr(c);if(d===0)return u.distSqr(s);const m=((u.x-s.x)*(c.x-s.x)+(u.y-s.y)*(c.y-s.y))/d;return u.distSqr(m<0?s:m>1?c:c.sub(s)._mult(m)._add(s))}function TA(u,s){let c,d,m,_=!1;for(let E=0;E<u.length;E++){c=u[E];for(let I=0,P=c.length-1;I<c.length;P=I++)d=c[I],m=c[P],d.y>s.y!=m.y>s.y&&s.x<(m.x-d.x)*(s.y-d.y)/(m.y-d.y)+d.x&&(_=!_)}return _}function sp(u,s){let c=!1;for(let d=0,m=u.length-1;d<u.length;m=d++){const _=u[d],E=u[m];_.y>s.y!=E.y>s.y&&s.x<(E.x-_.x)*(s.y-_.y)/(E.y-_.y)+_.x&&(c=!c)}return c}function IA(u,s,c,d,m){for(const E of u)if(s<=E.x&&c<=E.y&&d>=E.x&&m>=E.y)return!0;const _=[new U(s,c),new U(s,m),new U(d,m),new U(d,c)];if(u.length>2){for(const E of _)if(sp(u,E))return!0}for(let E=0;E<u.length-1;E++)if(Qz(u[E],u[E+1],_))return!0;return!1}function Qz(u,s,c){const d=c[0],m=c[2];if(u.x<d.x&&s.x<d.x||u.x>m.x&&s.x>m.x||u.y<d.y&&s.y<d.y||u.y>m.y&&s.y>m.y)return!1;const _=st(u,s,c[0]);return _!==st(u,s,c[1])||_!==st(u,s,c[2])||_!==st(u,s,c[3])}function tm(u,s,c){const d=s.paint.get(u).value;return d.kind==="constant"?d.value:c.programConfigurations.get(s.id).getMaxValue(u)}function sx(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function CA(u,s,c,d,m){if(!s[0]&&!s[1])return u;const _=U.convert(s)._mult(m);c==="viewport"&&_._rotate(-d);const E=[];for(let I=0;I<u.length;I++)E.push(u[I].sub(_));return E}function PA(u,s,c,d){const m=U.convert(u)._mult(d);return s==="viewport"&&m._rotate(-c),m}nn(nS,"CircleBucket",{omit:["layers"]});const e6=new xe({"circle-sort-key":new ce(ct.layout_circle["circle-sort-key"])});var t6={paint:new xe({"circle-radius":new ce(ct.paint_circle["circle-radius"]),"circle-color":new ce(ct.paint_circle["circle-color"]),"circle-blur":new ce(ct.paint_circle["circle-blur"]),"circle-opacity":new ce(ct.paint_circle["circle-opacity"]),"circle-translate":new ee(ct.paint_circle["circle-translate"]),"circle-translate-anchor":new ee(ct.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ee(ct.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ee(ct.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ce(ct.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ce(ct.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ce(ct.paint_circle["circle-stroke-opacity"])}),layout:e6};function AA(u,s,c,d,m,_,E,I,P){if(_&&u.queryGeometry.isAboveHorizon)return!1;_&&(P*=u.pixelToTileUnitsFactor);const A=u.tileID.canonical,N=c.projection.upVectorScale(A,c.center.lat,c.worldSize).metersToTile;for(const G of s)for(const $ of G){const W=$.add(I),J=m&&c.elevation?c.elevation.exaggeration()*m.getElevationAt(W.x,W.y,!0):0,te=c.projection.projectTilePoint(W.x,W.y,A);if(J>0){const ye=c.projection.upVector(A,W.x,W.y);te.x+=ye[0]*N*J,te.y+=ye[1]*N*J,te.z+=ye[2]*N*J}const se=_?W:n6(te.x,te.y,te.z,d),me=_?u.tilespaceRays.map(ye=>i6(ye,J)):u.queryGeometry.screenGeometry,Ie=rp([],[te.x,te.y,te.z,1],d);if(!E&&_?P*=Ie[3]/c.cameraToCenterDistance:E&&!_&&(P*=c.cameraToCenterDistance/Ie[3]),_){const ye=Aa(($.y/bn+A.y)/(1<<A.z));P/=c.projection.pixelsPerMeter(ye,1)/Qu(1,ye)}if(Yz(me,se,P))return!0}return!1}function n6(u,s,c,d){const m=rp([],[u,s,c,1],d);return new U(m[0]/m[3],m[1]/m[3])}const MA=Yg(0,0,0),r6=Yg(0,0,1);function i6(u,s){const c=VE();return MA[2]=s,u.intersectsPlane(MA,r6,c),new U(c[0],c[1])}class LA extends nS{}function OA(u,{width:s,height:c},d,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==s*c*d)throw new RangeError("mismatched image size")}else m=new Uint8Array(s*c*d);return u.width=s,u.height=c,u.data=m,u}function DA(u,s,c){const{width:d,height:m}=s;d===u.width&&m===u.height||(oS(u,s,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,d),height:Math.min(u.height,m)},c),u.width=d,u.height=m,u.data=s.data)}function oS(u,s,c,d,m,_){if(m.width===0||m.height===0)return s;if(m.width>u.width||m.height>u.height||c.x>u.width-m.width||c.y>u.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>s.width||m.height>s.height||d.x>s.width-m.width||d.y>s.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const E=u.data,I=s.data;for(let P=0;P<m.height;P++){const A=((c.y+P)*u.width+c.x)*_,N=((d.y+P)*s.width+d.x)*_;for(let G=0;G<m.width*_;G++)I[N+G]=E[A+G]}return s}nn(LA,"HeatmapBucket",{omit:["layers"]});class Ch{constructor(s,c){OA(this,s,1,c)}resize(s){DA(this,new Ch(s),1)}clone(){return new Ch({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,d,m,_){oS(s,c,d,m,_,1)}}class Ws{constructor(s,c){OA(this,s,4,c)}resize(s){DA(this,new Ws(s),4)}replace(s,c){c?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new Ws({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,d,m,_){oS(s,c,d,m,_,4)}}nn(Ch,"AlphaImage"),nn(Ws,"RGBAImage");var o6={paint:new xe({"heatmap-radius":new ce(ct.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ce(ct.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ee(ct.paint_heatmap["heatmap-intensity"]),"heatmap-color":new _e(ct.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ee(ct.paint_heatmap["heatmap-opacity"])})};function aS(u){const s={},c=u.resolution||256,d=u.clips?u.clips.length:1,m=u.image||new Ws({width:c,height:d}),_=(E,I,P)=>{s[u.evaluationKey]=P;const A=u.expression.evaluate(s);m.data[E+I+0]=Math.floor(255*A.r/A.a),m.data[E+I+1]=Math.floor(255*A.g/A.a),m.data[E+I+2]=Math.floor(255*A.b/A.a),m.data[E+I+3]=Math.floor(255*A.a)};if(u.clips)for(let E=0,I=0;E<d;++E,I+=4*c)for(let P=0,A=0;P<c;P++,A+=4){const N=P/(c-1),{start:G,end:$}=u.clips[E];_(I,A,G*(1-N)+$*N)}else for(let E=0,I=0;E<c;E++,I+=4)_(0,I,E/(c-1));return m}var a6={paint:new xe({"hillshade-illumination-direction":new ee(ct.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ee(ct.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ee(ct.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ee(ct.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ee(ct.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ee(ct.paint_hillshade["hillshade-accent-color"])})};const s6=ze([{name:"a_pos",components:2,type:"Int16"}],4),{members:l6}=s6;var sS={exports:{}};function lx(u,s,c){c=c||2;var d,m,_,E,I,P,A,N=s&&s.length,G=N?s[0]*c:u.length,$=RA(u,0,G,c,!0),W=[];if(!$||$.next===$.prev)return W;if(N&&($=function(te,se,me,Ie){var ye,Se,Me,Ae=[];for(ye=0,Se=se.length;ye<Se;ye++)(Me=RA(te,se[ye]*Ie,ye<Se-1?se[ye+1]*Ie:te.length,Ie,!1))===Me.next&&(Me.steiner=!0),Ae.push(m6(Me));for(Ae.sort(d6),ye=0;ye<Ae.length;ye++)me=p6(Ae[ye],me);return me}(u,s,$,c)),u.length>80*c){d=_=u[0],m=E=u[1];for(var J=c;J<G;J+=c)(I=u[J])<d&&(d=I),(P=u[J+1])<m&&(m=P),I>_&&(_=I),P>E&&(E=P);A=(A=Math.max(_-d,E-m))!==0?32767/A:0}return Qv($,W,c,d,m,A,0),W}function RA(u,s,c,d,m){var _,E;if(m===cS(u,s,c,d)>0)for(_=s;_<c;_+=d)E=FA(_,u[_],u[_+1],E);else for(_=c-d;_>=s;_-=d)E=FA(_,u[_],u[_+1],E);return E&&ux(E,E.next)&&(t_(E),E=E.next),E}function lp(u,s){if(!u)return u;s||(s=u);var c,d=u;do if(c=!1,d.steiner||!ux(d,d.next)&&Eo(d.prev,d,d.next)!==0)d=d.next;else{if(t_(d),(d=s=d.prev)===d.next)break;c=!0}while(c||d!==s);return s}function Qv(u,s,c,d,m,_,E){if(u){!E&&_&&function(N,G,$,W){var J=N;do J.z===0&&(J.z=lS(J.x,J.y,G,$,W)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==N);J.prevZ.nextZ=null,J.prevZ=null,function(te){var se,me,Ie,ye,Se,Me,Ae,et,We=1;do{for(me=te,te=null,Se=null,Me=0;me;){for(Me++,Ie=me,Ae=0,se=0;se<We&&(Ae++,Ie=Ie.nextZ);se++);for(et=We;Ae>0||et>0&&Ie;)Ae!==0&&(et===0||!Ie||me.z<=Ie.z)?(ye=me,me=me.nextZ,Ae--):(ye=Ie,Ie=Ie.nextZ,et--),Se?Se.nextZ=ye:te=ye,ye.prevZ=Se,Se=ye;me=Ie}Se.nextZ=null,We*=2}while(Me>1)}(J)}(u,d,m,_);for(var I,P,A=u;u.prev!==u.next;)if(I=u.prev,P=u.next,_?c6(u,d,m,_):u6(u))s.push(I.i/c|0),s.push(u.i/c|0),s.push(P.i/c|0),t_(u),u=P.next,A=P.next;else if((u=P)===A){E?E===1?Qv(u=h6(lp(u),s,c),s,c,d,m,_,2):E===2&&f6(u,s,c,d,m,_):Qv(lp(u),s,c,d,m,_,1);break}}}function u6(u){var s=u.prev,c=u,d=u.next;if(Eo(s,c,d)>=0)return!1;for(var m=s.x,_=c.x,E=d.x,I=s.y,P=c.y,A=d.y,N=m<_?m<E?m:E:_<E?_:E,G=I<P?I<A?I:A:P<A?P:A,$=m>_?m>E?m:E:_>E?_:E,W=I>P?I>A?I:A:P>A?P:A,J=d.next;J!==s;){if(J.x>=N&&J.x<=$&&J.y>=G&&J.y<=W&&nm(m,I,_,P,E,A,J.x,J.y)&&Eo(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function c6(u,s,c,d){var m=u.prev,_=u,E=u.next;if(Eo(m,_,E)>=0)return!1;for(var I=m.x,P=_.x,A=E.x,N=m.y,G=_.y,$=E.y,W=I<P?I<A?I:A:P<A?P:A,J=N<G?N<$?N:$:G<$?G:$,te=I>P?I>A?I:A:P>A?P:A,se=N>G?N>$?N:$:G>$?G:$,me=lS(W,J,s,c,d),Ie=lS(te,se,s,c,d),ye=u.prevZ,Se=u.nextZ;ye&&ye.z>=me&&Se&&Se.z<=Ie;){if(ye.x>=W&&ye.x<=te&&ye.y>=J&&ye.y<=se&&ye!==m&&ye!==E&&nm(I,N,P,G,A,$,ye.x,ye.y)&&Eo(ye.prev,ye,ye.next)>=0||(ye=ye.prevZ,Se.x>=W&&Se.x<=te&&Se.y>=J&&Se.y<=se&&Se!==m&&Se!==E&&nm(I,N,P,G,A,$,Se.x,Se.y)&&Eo(Se.prev,Se,Se.next)>=0))return!1;Se=Se.nextZ}for(;ye&&ye.z>=me;){if(ye.x>=W&&ye.x<=te&&ye.y>=J&&ye.y<=se&&ye!==m&&ye!==E&&nm(I,N,P,G,A,$,ye.x,ye.y)&&Eo(ye.prev,ye,ye.next)>=0)return!1;ye=ye.prevZ}for(;Se&&Se.z<=Ie;){if(Se.x>=W&&Se.x<=te&&Se.y>=J&&Se.y<=se&&Se!==m&&Se!==E&&nm(I,N,P,G,A,$,Se.x,Se.y)&&Eo(Se.prev,Se,Se.next)>=0)return!1;Se=Se.nextZ}return!0}function h6(u,s,c){var d=u;do{var m=d.prev,_=d.next.next;!ux(m,_)&&kA(m,d,d.next,_)&&e_(m,_)&&e_(_,m)&&(s.push(m.i/c|0),s.push(d.i/c|0),s.push(_.i/c|0),t_(d),t_(d.next),d=u=_),d=d.next}while(d!==u);return lp(d)}function f6(u,s,c,d,m,_){var E=u;do{for(var I=E.next.next;I!==E.prev;){if(E.i!==I.i&&y6(E,I)){var P=NA(E,I);return E=lp(E,E.next),P=lp(P,P.next),Qv(E,s,c,d,m,_,0),void Qv(P,s,c,d,m,_,0)}I=I.next}E=E.next}while(E!==u)}function d6(u,s){return u.x-s.x}function p6(u,s){var c=function(m,_){var E,I=_,P=m.x,A=m.y,N=-1/0;do{if(A<=I.y&&A>=I.next.y&&I.next.y!==I.y){var G=I.x+(A-I.y)*(I.next.x-I.x)/(I.next.y-I.y);if(G<=P&&G>N&&(N=G,E=I.x<I.next.x?I:I.next,G===P))return E}I=I.next}while(I!==_);if(!E)return null;var $,W=E,J=E.x,te=E.y,se=1/0;I=E;do P>=I.x&&I.x>=J&&P!==I.x&&nm(A<te?P:N,A,J,te,A<te?N:P,A,I.x,I.y)&&($=Math.abs(A-I.y)/(P-I.x),e_(I,m)&&($<se||$===se&&(I.x>E.x||I.x===E.x&&g6(E,I)))&&(E=I,se=$)),I=I.next;while(I!==W);return E}(u,s);if(!c)return s;var d=NA(c,u);return lp(d,d.next),lp(c,c.next)}function g6(u,s){return Eo(u.prev,u,s.prev)<0&&Eo(s.next,u,u.next)<0}function lS(u,s,c,d,m){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-c)*m|0)|u<<8))|u<<4))|u<<2))|u<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-d)*m|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function m6(u){var s=u,c=u;do(s.x<c.x||s.x===c.x&&s.y<c.y)&&(c=s),s=s.next;while(s!==u);return c}function nm(u,s,c,d,m,_,E,I){return(m-E)*(s-I)>=(u-E)*(_-I)&&(u-E)*(d-I)>=(c-E)*(s-I)&&(c-E)*(_-I)>=(m-E)*(d-I)}function y6(u,s){return u.next.i!==s.i&&u.prev.i!==s.i&&!function(c,d){var m=c;do{if(m.i!==c.i&&m.next.i!==c.i&&m.i!==d.i&&m.next.i!==d.i&&kA(m,m.next,c,d))return!0;m=m.next}while(m!==c);return!1}(u,s)&&(e_(u,s)&&e_(s,u)&&function(c,d){var m=c,_=!1,E=(c.x+d.x)/2,I=(c.y+d.y)/2;do m.y>I!=m.next.y>I&&m.next.y!==m.y&&E<(m.next.x-m.x)*(I-m.y)/(m.next.y-m.y)+m.x&&(_=!_),m=m.next;while(m!==c);return _}(u,s)&&(Eo(u.prev,u,s.prev)||Eo(u,s.prev,s))||ux(u,s)&&Eo(u.prev,u,u.next)>0&&Eo(s.prev,s,s.next)>0)}function Eo(u,s,c){return(s.y-u.y)*(c.x-s.x)-(s.x-u.x)*(c.y-s.y)}function ux(u,s){return u.x===s.x&&u.y===s.y}function kA(u,s,c,d){var m=hx(Eo(u,s,c)),_=hx(Eo(u,s,d)),E=hx(Eo(c,d,u)),I=hx(Eo(c,d,s));return m!==_&&E!==I||!(m!==0||!cx(u,c,s))||!(_!==0||!cx(u,d,s))||!(E!==0||!cx(c,u,d))||!(I!==0||!cx(c,s,d))}function cx(u,s,c){return s.x<=Math.max(u.x,c.x)&&s.x>=Math.min(u.x,c.x)&&s.y<=Math.max(u.y,c.y)&&s.y>=Math.min(u.y,c.y)}function hx(u){return u>0?1:u<0?-1:0}function e_(u,s){return Eo(u.prev,u,u.next)<0?Eo(u,s,u.next)>=0&&Eo(u,u.prev,s)>=0:Eo(u,s,u.prev)<0||Eo(u,u.next,s)<0}function NA(u,s){var c=new uS(u.i,u.x,u.y),d=new uS(s.i,s.x,s.y),m=u.next,_=s.prev;return u.next=s,s.prev=u,c.next=m,m.prev=c,d.next=c,c.prev=d,_.next=d,d.prev=_,d}function FA(u,s,c,d){var m=new uS(u,s,c);return d?(m.next=d.next,m.prev=d,d.next.prev=m,d.next=m):(m.prev=m,m.next=m),m}function t_(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function uS(u,s,c){this.i=u,this.x=s,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function cS(u,s,c,d){for(var m=0,_=s,E=c-d;_<c;_+=d)m+=(u[E]-u[_])*(u[_+1]+u[E+1]),E=_;return m}sS.exports=lx,sS.exports.default=lx,lx.deviation=function(u,s,c,d){var m=s&&s.length,_=Math.abs(cS(u,0,m?s[0]*c:u.length,c));if(m)for(var E=0,I=s.length;E<I;E++)_-=Math.abs(cS(u,s[E]*c,E<I-1?s[E+1]*c:u.length,c));var P=0;for(E=0;E<d.length;E+=3){var A=d[E]*c,N=d[E+1]*c,G=d[E+2]*c;P+=Math.abs((u[A]-u[G])*(u[N+1]-u[A+1])-(u[A]-u[N])*(u[G+1]-u[A+1]))}return _===0&&P===0?0:Math.abs((P-_)/_)},lx.flatten=function(u){for(var s=u[0][0].length,c={vertices:[],holes:[],dimensions:s},d=0,m=0;m<u.length;m++){for(var _=0;_<u[m].length;_++)for(var E=0;E<s;E++)c.vertices.push(u[m][_][E]);m>0&&c.holes.push(d+=u[m-1].length)}return c};var hS=k(sS.exports);function v6(u,s,c,d,m){BA(u,s,c||0,d||u.length-1,m||_6)}function BA(u,s,c,d,m){for(;d>c;){if(d-c>600){var _=d-c+1,E=s-c+1,I=Math.log(_),P=.5*Math.exp(2*I/3),A=.5*Math.sqrt(I*P*(_-P)/_)*(E-_/2<0?-1:1);BA(u,s,Math.max(c,Math.floor(s-E*P/_+A)),Math.min(d,Math.floor(s+(_-E)*P/_+A)),m)}var N=u[s],G=c,$=d;for(n_(u,c,s),m(u[d],N)>0&&n_(u,c,d);G<$;){for(n_(u,G,$),G++,$--;m(u[G],N)<0;)G++;for(;m(u[$],N)>0;)$--}m(u[c],N)===0?n_(u,c,$):n_(u,++$,d),$<=s&&(c=$+1),s<=$&&(d=$-1)}}function n_(u,s,c){var d=u[s];u[s]=u[c],u[c]=d}function _6(u,s){return u<s?-1:u>s?1:0}function fS(u,s){const c=u.length;if(c<=1)return[u];const d=[];let m,_;for(let E=0;E<c;E++){const I=vt(u[E]);I!==0&&(u[E].area=Math.abs(I),_===void 0&&(_=I<0),_===I<0?(m&&d.push(m),m=[u[E]]):m.push(u[E]))}if(m&&d.push(m),s>1)for(let E=0;E<d.length;E++)d[E].length<=s||(v6(d[E],s,1,d[E].length-1,x6),d[E]=d[E].slice(0,s));return d}function x6(u,s){return s.area-u.area}function dS(u,s,c){const d=c.patternDependencies;let m=!1;for(const _ of s){const E=_.paint.get(`${u}-pattern`);E.isConstant()||(m=!0);const I=E.constantOr(null);I&&(m=!0,d[I]=!0)}return m}function pS(u,s,c,d,m){const _=m.patternDependencies;for(const E of s){const I=E.paint.get(`${u}-pattern`).value;if(I.kind!=="constant"){let P=I.evaluate({zoom:d},c,{},m.availableImages);P=P&&P.name?P.name:P,_[P]=!0,c.patterns[E.id]=P}}return c}class fx{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Et,this.indexArray=new gn,this.indexArray2=new Jo,this.programConfigurations=new ep(s.layers,s.zoom),this.segments=new wo,this.segments2=new wo,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=s.projection}populate(s,c,d,m){this.hasPattern=dS("fill",this.layers,c);const _=this.layers[0].layout.get("fill-sort-key"),E=[];for(const{feature:I,id:P,index:A,sourceLayerIndex:N}of s){const G=this.layers[0]._featureFilter.needGeometry,$=ap(I,G);if(!this.layers[0]._featureFilter.filter(new F(this.zoom),$,d))continue;const W=_?_.evaluate($,{},d,c.availableImages):void 0,J={id:P,properties:I.properties,type:I.type,sourceLayerIndex:N,index:A,geometry:G?$.geometry:Ih(I,d,m),patterns:{},sortKey:W};E.push(J)}_&&E.sort((I,P)=>I.sortKey-P.sortKey);for(const I of E){const{geometry:P,index:A,sourceLayerIndex:N}=I;if(this.hasPattern){const G=pS("fill",this.layers,I,this.zoom,c);this.patternFeatures.push(G)}else this.addFeature(I,P,A,d,{},c.availableImages);c.featureIndex.insert(s[A].feature,P,A,N,this.index)}}update(s,c,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d,m)}addFeatures(s,c,d,m,_){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,c,d,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,l6),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,c,d,m,_,E=[]){for(const I of fS(c,500)){let P=0;for(const J of I)P+=J.length;const A=this.segments.prepareSegment(P,this.layoutVertexArray,this.indexArray),N=A.vertexLength,G=[],$=[];for(const J of I){if(J.length===0)continue;J!==I[0]&&$.push(G.length/2);const te=this.segments2.prepareSegment(J.length,this.layoutVertexArray,this.indexArray2),se=te.vertexLength;this.layoutVertexArray.emplaceBack(J[0].x,J[0].y),this.indexArray2.emplaceBack(se+J.length-1,se),G.push(J[0].x),G.push(J[0].y);for(let me=1;me<J.length;me++)this.layoutVertexArray.emplaceBack(J[me].x,J[me].y),this.indexArray2.emplaceBack(se+me-1,se+me),G.push(J[me].x),G.push(J[me].y);te.vertexLength+=J.length,te.primitiveLength+=J.length}const W=hS(G,$);for(let J=0;J<W.length;J+=3)this.indexArray.emplaceBack(N+W[J],N+W[J+1],N+W[J+2]);A.vertexLength+=P,A.primitiveLength+=W.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,_,E,m)}}nn(fx,"FillBucket",{omit:["layers","patternFeatures"]});const b6=new xe({"fill-sort-key":new ce(ct.layout_fill["fill-sort-key"])});var w6={paint:new xe({"fill-antialias":new ee(ct.paint_fill["fill-antialias"]),"fill-opacity":new ce(ct.paint_fill["fill-opacity"]),"fill-color":new ce(ct.paint_fill["fill-color"]),"fill-outline-color":new ce(ct.paint_fill["fill-outline-color"]),"fill-translate":new ee(ct.paint_fill["fill-translate"]),"fill-translate-anchor":new ee(ct.paint_fill["fill-translate-anchor"]),"fill-pattern":new ce(ct.paint_fill["fill-pattern"])}),layout:b6};const E6=ze([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),S6=ze([{name:"a_centroid_pos",components:2,type:"Uint16"}]),T6=ze([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:I6}=E6;var dx={},C6=K,zA=rm;function rm(u,s,c,d,m){this.properties={},this.extent=c,this.type=0,this._pbf=u,this._geometry=-1,this._keys=d,this._values=m,u.readFields(P6,this,s)}function P6(u,s,c){u==1?s.id=c.readVarint():u==2?function(d,m){for(var _=d.readVarint()+d.pos;d.pos<_;){var E=m._keys[d.readVarint()],I=m._values[d.readVarint()];m.properties[E]=I}}(c,s):u==3?s.type=c.readVarint():u==4&&(s._geometry=c.pos)}function A6(u){for(var s,c,d=0,m=0,_=u.length,E=_-1;m<_;E=m++)d+=((c=u[E]).x-(s=u[m]).x)*(s.y+c.y);return d}rm.types=["Unknown","Point","LineString","Polygon"],rm.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var s,c=u.readVarint()+u.pos,d=1,m=0,_=0,E=0,I=[];u.pos<c;){if(m<=0){var P=u.readVarint();d=7&P,m=P>>3}if(m--,d===1||d===2)_+=u.readSVarint(),E+=u.readSVarint(),d===1&&(s&&I.push(s),s=[]),s.push(new C6(_,E));else{if(d!==7)throw new Error("unknown command "+d);s&&s.push(s[0].clone())}}return s&&I.push(s),I},rm.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var s=u.readVarint()+u.pos,c=1,d=0,m=0,_=0,E=1/0,I=-1/0,P=1/0,A=-1/0;u.pos<s;){if(d<=0){var N=u.readVarint();c=7&N,d=N>>3}if(d--,c===1||c===2)(m+=u.readSVarint())<E&&(E=m),m>I&&(I=m),(_+=u.readSVarint())<P&&(P=_),_>A&&(A=_);else if(c!==7)throw new Error("unknown command "+c)}return[E,P,I,A]},rm.prototype.toGeoJSON=function(u,s,c){var d,m,_=this.extent*Math.pow(2,c),E=this.extent*u,I=this.extent*s,P=this.loadGeometry(),A=rm.types[this.type];function N(W){for(var J=0;J<W.length;J++){var te=W[J];W[J]=[360*(te.x+E)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(te.y+I)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var G=[];for(d=0;d<P.length;d++)G[d]=P[d][0];N(P=G);break;case 2:for(d=0;d<P.length;d++)N(P[d]);break;case 3:for(P=function(W){var J=W.length;if(J<=1)return[W];for(var te,se,me=[],Ie=0;Ie<J;Ie++){var ye=A6(W[Ie]);ye!==0&&(se===void 0&&(se=ye<0),se===ye<0?(te&&me.push(te),te=[W[Ie]]):te.push(W[Ie]))}return te&&me.push(te),me}(P),d=0;d<P.length;d++)for(m=0;m<P[d].length;m++)N(P[d][m])}P.length===1?P=P[0]:A="Multi"+A;var $={type:"Feature",geometry:{type:A,coordinates:P},properties:this.properties};return"id"in this&&($.id=this.id),$};var M6=zA,UA=VA;function VA(u,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(L6,this,s),this.length=this._features.length}function L6(u,s,c){u===15?s.version=c.readVarint():u===1?s.name=c.readString():u===5?s.extent=c.readVarint():u===2?s._features.push(c.pos):u===3?s._keys.push(c.readString()):u===4&&s._values.push(function(d){for(var m=null,_=d.readVarint()+d.pos;d.pos<_;){var E=d.readVarint()>>3;m=E===1?d.readString():E===2?d.readFloat():E===3?d.readDouble():E===4?d.readVarint64():E===5?d.readVarint():E===6?d.readSVarint():E===7?d.readBoolean():null}return m}(c))}VA.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var s=this._pbf.readVarint()+this._pbf.pos;return new M6(this._pbf,s,this.extent,this._keys,this._values)};var O6=UA;function D6(u,s,c){if(u===3){var d=new O6(c,c.readVarint()+c.pos);d.length&&(s[d.name]=d)}}var gS=dx.VectorTile=function(u,s){this.layers=u.readFields(D6,{},s)},px=dx.VectorTileFeature=zA;function gx(u,s,c,d){const m=[],_=d===0?(E,I,P,A,N,G)=>{E.push(new U(G,P+(G-I)/(A-I)*(N-P)))}:(E,I,P,A,N,G)=>{E.push(new U(I+(G-P)/(N-P)*(A-I),G))};for(const E of u){const I=[];for(const P of E){if(P.length<=2)continue;const A=[];for(let $=0;$<P.length-1;$++){const W=P[$].x,J=P[$].y,te=P[$+1].x,se=P[$+1].y,me=d===0?W:J,Ie=d===0?te:se;me<s?Ie>s&&_(A,W,J,te,se,s):me>c?Ie<c&&_(A,W,J,te,se,c):A.push(P[$]),Ie<s&&me>=s&&_(A,W,J,te,se,s),Ie>c&&me<=c&&_(A,W,J,te,se,c)}let N=P[P.length-1];const G=d===0?N.x:N.y;G>=s&&G<=c&&A.push(N),A.length&&(N=A[A.length-1],A[0].x===N.x&&A[0].y===N.y||A.push(A[0]),I.push(A))}I.length&&m.push(I)}return m}dx.VectorTileLayer=UA;const R6=px.types,k6=Math.pow(2,13);function r_(u,s,c,d,m,_,E,I){u.emplaceBack((s<<1)+E,(c<<1)+_,(Math.floor(d*k6)<<1)+m,Math.round(I))}function i_(u,s,c){u.emplaceBack(s.x,s.y,s.z,c[0]*16384,c[1]*16384,c[2]*16384)}class GA{constructor(){this.acc=new U(0,0),this.polyCount=[]}startRing(s){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new U(s.x,s.y),this.max=new U(s.x,s.y))}append(s,c){this.currentPolyCount.edges++,this.acc._add(s);const d=this.min,m=this.max;s.x<d.x?d.x=s.x:s.x>m.x&&(m.x=s.x),s.y<d.y?d.y=s.y:s.y>m.y&&(m.y=s.y),((s.x===0||s.x===bn)&&s.x===c.x)!=((s.y===0||s.y===bn)&&s.y===c.y)&&this.processBorderOverlap(s,c),c.x<0!=s.x<0&&this.addBorderIntersection(0,mr(c.y,s.y,(0-c.x)/(s.x-c.x))),c.x>bn!=s.x>bn&&this.addBorderIntersection(1,mr(c.y,s.y,(bn-c.x)/(s.x-c.x))),c.y<0!=s.y<0&&this.addBorderIntersection(2,mr(c.x,s.x,(0-c.y)/(s.y-c.y))),c.y>bn!=s.y>bn&&this.addBorderIntersection(3,mr(c.x,s.x,(bn-c.y)/(s.y-c.y)))}addBorderIntersection(s,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const d=this.borders[s];c<d[0]&&(d[0]=c),c>d[1]&&(d[1]=c)}processBorderOverlap(s,c){if(s.x===c.x){if(s.y===c.y)return;const d=s.x===0?0:1;this.addBorderIntersection(d,c.y),this.addBorderIntersection(d,s.y)}else{const d=s.y===0?2:3;this.addBorderIntersection(d,c.x),this.addBorderIntersection(d,s.x)}}centroid(){const s=this.polyCount.reduce((c,d)=>c+d.edges,0);return s!==0?this.acc.div(s)._round():new U(0,0)}span(){return new U(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((s,c)=>s+ +(c[0]!==Number.MAX_VALUE),0)}}class o_{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=s.projection,this.layoutVertexArray=new gt,this.centroidVertexArray=new Wu,this.indexArray=new gn,this.programConfigurations=new ep(s.layers,s.zoom),this.segments=new wo,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.enableTerrain=s.enableTerrain}populate(s,c,d,m){this.features=[],this.hasPattern=dS("fill-extrusion",this.layers,c),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(_){const E=Math.exp(Math.PI*(1-_.y/(1<<_.z)*2));return 80150034*E/(E*E+1)/bn/(1<<_.z)}(d),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:_,id:E,index:I,sourceLayerIndex:P}of s){const A=this.layers[0]._featureFilter.needGeometry,N=ap(_,A);if(!this.layers[0]._featureFilter.filter(new F(this.zoom),N,d))continue;const G={id:E,sourceLayerIndex:P,index:I,geometry:A?N.geometry:Ih(_,d,m),properties:_.properties,type:_.type,patterns:{}},$=this.layoutVertexArray.length;this.hasPattern?this.features.push(pS("fill-extrusion",this.layers,G,this.zoom,c)):this.addFeature(G,G.geometry,I,d,{},c.availableImages,m),c.featureIndex.insert(_,G.geometry,I,P,this.index,$)}this.sortBorders()}addFeatures(s,c,d,m,_){for(const E of this.features){const{geometry:I}=E;this.addFeature(E,I,E.index,c,d,m,_)}this.sortBorders()}update(s,c,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,I6),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=s.createVertexBuffer(this.layoutVertexExtArray,T6.members,!0))),this.programConfigurations.upload(s),this.uploaded=!0}uploadCentroid(s){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,S6.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,c,d,m,_,E,I){const P=[new U(0,0),new U(bn,bn)],A=I.projection,N=A.name==="globe",G=this.enableTerrain&&!N?new GA:null,$=R6[s.type]==="Polygon";N&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new It);const W=fS(c,500);for(let me=W.length-1;me>=0;me--){const Ie=W[me];(Ie.length===0||(J=Ie[0]).every(ye=>ye.x<=0)||J.every(ye=>ye.x>=bn)||J.every(ye=>ye.y<=0)||J.every(ye=>ye.y>=bn))&&W.splice(me,1)}var J;let te;if(N)te=HA(W,P,m);else{te=[];for(const me of W)te.push({polygon:me,bounds:P})}const se=$?this.edgeRadius:0;for(const{polygon:me,bounds:Ie}of te){let ye=0,Se=0;for(const Ae of me)$&&!Ae[0].equals(Ae[Ae.length-1])&&Ae.push(Ae[0]),Se+=$?Ae.length-1:Ae.length;const Me=this.segments.prepareSegment(($?5:4)*Se,this.layoutVertexArray,this.indexArray);if($){const Ae=[],et=[];ye=Me.vertexLength;for(const ft of me){let St,it;ft.length&&ft!==me[0]&&et.push(Ae.length/2),St=ft[1].sub(ft[0])._perp()._unit();for(let mt=1;mt<ft.length;mt++){const yt=ft[mt],bt=ft[mt===ft.length-1?1:mt+1];let{x:Lt,y:ut}=yt;if(se){it=bt.sub(yt)._perp()._unit();const $t=St.add(it)._unit(),sn=se*Math.min(4,1/(St.x*$t.x+St.y*$t.y));Lt+=sn*$t.x,ut+=sn*$t.y,St=it}r_(this.layoutVertexArray,Lt,ut,0,0,1,1,0),Me.vertexLength++,Ae.push(yt.x,yt.y),N&&i_(this.layoutVertexExtArray,A.projectTilePoint(Lt,ut,m),A.upVector(m,Lt,ut))}}const We=hS(Ae,et);for(let ft=0;ft<We.length;ft+=3)this.indexArray.emplaceBack(ye+We[ft],ye+We[ft+2],ye+We[ft+1]),Me.primitiveLength++}for(const Ae of me){G&&Ae.length&&G.startRing(Ae[0]);let et,We,ft,St=Ae.length>4&&ZA(Ae[Ae.length-2],Ae[0],Ae[1]),it=se?N6(Ae[Ae.length-2],Ae[0],Ae[1],se):0;We=Ae[1].sub(Ae[0])._perp()._unit();let mt=!0;for(let yt=1,bt=0;yt<Ae.length;yt++){let Lt=Ae[yt-1],ut=Ae[yt];const $t=Ae[yt===Ae.length-1?1:yt+1];if(G&&$&&G.currentPolyCount.top++,qA(ut,Lt,Ie)){se&&(We=$t.sub(ut)._perp()._unit(),mt=!mt);continue}G&&G.append(ut,Lt);const sn=ut.sub(Lt)._perp(),qt=sn.x/(Math.abs(sn.x)+Math.abs(sn.y)),Fn=sn.y>0?1:0,Ot=Lt.dist(ut);if(bt+Ot>32768&&(bt=0),se){ft=$t.sub(ut)._perp()._unit();let zn=jA(Lt,ut,$t,$A(We,ft),se);isNaN(zn)&&(zn=0);const Tn=ut.sub(Lt)._unit();Lt=Lt.add(Tn.mult(it))._round(),ut=ut.add(Tn.mult(-zn))._round(),it=zn,We=ft}const vn=Me.vertexLength,Bn=Ae.length>4&&ZA(Lt,ut,$t);let $r=XA(bt,St,mt);if(r_(this.layoutVertexArray,Lt.x,Lt.y,qt,Fn,0,0,$r),r_(this.layoutVertexArray,Lt.x,Lt.y,qt,Fn,0,1,$r),bt+=Ot,$r=XA(bt,Bn,!mt),St=Bn,r_(this.layoutVertexArray,ut.x,ut.y,qt,Fn,0,0,$r),r_(this.layoutVertexArray,ut.x,ut.y,qt,Fn,0,1,$r),Me.vertexLength+=4,this.indexArray.emplaceBack(vn+0,vn+1,vn+2),this.indexArray.emplaceBack(vn+1,vn+3,vn+2),Me.primitiveLength+=2,se){const zn=ye+(yt===1?Ae.length-2:yt-2),Tn=yt===1?ye:zn+1;if(this.indexArray.emplaceBack(vn+1,zn,vn+3),this.indexArray.emplaceBack(zn,Tn,vn+3),Me.primitiveLength+=2,et===void 0&&(et=vn),!qA($t,Ae[yt],Ie)){const Ci=yt===Ae.length-1?et:Me.vertexLength;this.indexArray.emplaceBack(vn+2,vn+3,Ci),this.indexArray.emplaceBack(vn+3,Ci+1,Ci),this.indexArray.emplaceBack(vn+3,Tn,Ci+1),Me.primitiveLength+=3}mt=!mt}if(N){const zn=this.layoutVertexExtArray,Tn=A.projectTilePoint(Lt.x,Lt.y,m),Ci=A.projectTilePoint(ut.x,ut.y,m),$n=A.upVector(m,Lt.x,Lt.y),jn=A.upVector(m,ut.x,ut.y);i_(zn,Tn,$n),i_(zn,Tn,$n),i_(zn,Ci,jn),i_(zn,Ci,jn)}}$&&(ye+=Ae.length-1)}}if(G&&G.polyCount.length>0){if(G.borders){G.vertexArrayOffset=this.centroidVertexArray.length;const me=G.borders,Ie=this.featuresOnBorder.push(G)-1;for(let ye=0;ye<4;ye++)me[ye][0]!==Number.MAX_VALUE&&this.borders[ye].push(Ie)}this.encodeCentroid(G.borders?void 0:G.centroid(),G)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,_,E,m)}sortBorders(){for(let s=0;s<4;s++)this.borders[s].sort((c,d)=>this.featuresOnBorder[c].borders[s][0]-this.featuresOnBorder[d].borders[s][0])}encodeCentroid(s,c,d=!0){let m,_;if(s)if(s.y!==0){const I=c.span()._mult(this.tileToMeter);m=(Math.max(s.x,1)<<3)+Math.min(7,Math.round(I.x/10)),_=(Math.max(s.y,1)<<3)+Math.min(7,Math.round(I.y/10))}else m=Math.ceil(7*(s.x+450)),_=0;else m=0,_=+d;let E=d?this.centroidVertexArray.length:c.vertexArrayOffset;for(const I of c.polyCount){d&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*I.edges+I.top);for(let P=0;P<I.top;P++)this.centroidVertexArray.emplace(E++,m,_);for(let P=0;P<2*I.edges;P++)this.centroidVertexArray.emplace(E++,0,_),this.centroidVertexArray.emplace(E++,m,_)}}}function $A(u,s){const c=u.add(s)._unit();return u.x*c.x+u.y*c.y}function N6(u,s,c,d){const m=s.sub(u)._perp()._unit(),_=c.sub(s)._perp()._unit();return jA(u,s,c,$A(m,_),d)}function jA(u,s,c,d,m){const _=Math.sqrt(1-d*d);return Math.min(u.dist(s)/3,s.dist(c)/3,m*_/d)}function qA(u,s,c){return u.x<c[0].x&&s.x<c[0].x||u.x>c[1].x&&s.x>c[1].x||u.y<c[0].y&&s.y<c[0].y||u.y>c[1].y&&s.y>c[1].y}function ZA(u,s,c){if(u.x<0||u.x>=bn||s.x<0||s.x>=bn||c.x<0||c.x>=bn)return!1;const d=c.sub(s),m=d.perp(),_=u.sub(s);return(d.x*_.x+d.y*_.y)/Math.sqrt((d.x*d.x+d.y*d.y)*(_.x*_.x+_.y*_.y))>-.866&&m.x*_.x+m.y*_.y<0}function XA(u,s,c){const d=s?2|u:-3&u;return c?1|d:-2&d}function WA(){const u=Math.PI/32,s=Math.tan(u),c=Jv;return c*Math.sqrt(1+2*s*s)-c}function HA(u,s,c){const d=1<<c.z,m=_l(c.x/d),_=_l((c.x+1)/d),E=Aa(c.y/d),I=Aa((c.y+1)/d);return function(P,A,N,G,$=0,W){const J=[];if(!P.length||!N||!G)return J;const te=(Ae,et)=>{for(const We of Ae)J.push({polygon:We,bounds:et})},se=Math.ceil(Math.log2(N)),me=Math.ceil(Math.log2(G)),Ie=se-me,ye=[];for(let Ae=0;Ae<Math.abs(Ie);Ae++)ye.push(Ie>0?0:1);for(let Ae=0;Ae<Math.min(se,me);Ae++)ye.push(0),ye.push(1);let Se=P;if(Se=gx(Se,A[0].y-$,A[1].y+$,1),Se=gx(Se,A[0].x-$,A[1].x+$,0),!Se.length)return J;const Me=[];for(ye.length?Me.push({polygons:Se,bounds:A,depth:0}):te(Se,A);Me.length;){const Ae=Me.pop(),et=Ae.depth,We=ye[et],ft=Ae.bounds[0],St=Ae.bounds[1],it=We===0?ft.x:ft.y,mt=We===0?St.x:St.y,yt=W?W(We,it,mt):.5*(it+mt),bt=gx(Ae.polygons,it-$,yt+$,We),Lt=gx(Ae.polygons,yt-$,mt+$,We);if(bt.length){const ut=[ft,new U(We===0?yt:St.x,We===1?yt:St.y)];ye.length>et+1?Me.push({polygons:bt,bounds:ut,depth:et+1}):te(bt,ut)}if(Lt.length){const ut=[new U(We===0?yt:ft.x,We===1?yt:ft.y),St];ye.length>et+1?Me.push({polygons:Lt,bounds:ut,depth:et+1}):te(Lt,ut)}}return J}(u,s,Math.ceil((_-m)/11.25),Math.ceil((E-I)/11.25),1,(P,A,N)=>{if(P===0)return .5*(A+N);{const G=Aa((c.y+A/bn)/d);return(Rc(.5*(Aa((c.y+N/bn)/d)+G))*d-c.y)*bn}})}nn(o_,"FillExtrusionBucket",{omit:["layers","features"]}),nn(GA,"PartMetadata");const F6=new xe({"fill-extrusion-edge-radius":new ee(ct["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var B6={paint:new xe({"fill-extrusion-opacity":new ee(ct["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ce(ct["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ee(ct["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ee(ct["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ce(ct["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ce(ct["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ce(ct["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ee(ct["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ee(ct["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ee(ct["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new ee(ct["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:F6};function YA(u,s,c){var d=2*Math.PI*6378137/256/Math.pow(2,c);return[u*d-2*Math.PI*6378137/2,s*d-2*Math.PI*6378137/2]}class mx{constructor(s,c,d){this.z=s,this.x=c,this.y=d,this.key=a_(0,s,s,c,d)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,c){const d=function(_,E,I){var P=YA(256*_,256*(E=Math.pow(2,I)-E-1),I),A=YA(256*(_+1),256*(E+1),I);return P[0]+","+P[1]+","+A[0]+","+A[1]}(this.x,this.y,this.z),m=function(_,E,I){let P,A="";for(let N=_;N>0;N--)P=1<<N-1,A+=(E&P?1:0)+(I&P?2:0);return A}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",d)}toString(){return`${this.z}/${this.x}/${this.y}`}}class KA{constructor(s,c){this.wrap=s,this.canonical=c,this.key=a_(s,c.z,c.z,c.x,c.y)}}class us{constructor(s,c,d,m,_){this.overscaledZ=s,this.wrap=c,this.canonical=new mx(d,+m,+_),this.key=c===0&&s===d?this.canonical.key:a_(c,s,d,m,_)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){const c=this.canonical.z-s;return s>this.canonical.z?new us(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new us(s,this.wrap,s,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(s,c=!0){if(this.overscaledZ===s&&c)return this.key;if(s>this.canonical.z)return a_(this.wrap*+c,s,this.canonical.z,this.canonical.x,this.canonical.y);{const d=this.canonical.z-s;return a_(this.wrap*+c,s,s,this.canonical.x>>d,this.canonical.y>>d)}}isChildOf(s){if(s.wrap!==this.wrap)return!1;const c=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>c&&s.canonical.y===this.canonical.y>>c}children(s){if(this.overscaledZ>=s)return[new us(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,d=2*this.canonical.x,m=2*this.canonical.y;return[new us(c,this.wrap,c,d,m),new us(c,this.wrap,c,d+1,m),new us(c,this.wrap,c,d,m+1),new us(c,this.wrap,c,d+1,m+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new us(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new us(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new KA(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function a_(u,s,c,d,m){const _=1<<Math.min(c,22);let E=_*(m%_)+d%_;return u&&c<22&&(E+=_*_*((u<0?-2*u-1:2*u)%(1<<2*(22-c)))),16*(32*E+c)+(s-c)}nn(mx,"CanonicalTileID"),nn(us,"OverscaledTileID",{omit:["projMatrix"]});class im extends U{constructor(s,c,d){super(s,c),this.z=d}}function s_(u,s){return u.x*s.x+u.y*s.y}function JA(u,s){if(u.length===1){let c=0;const d=s[c++];let m;for(;!m||d.equals(m);)if(m=s[c++],!m)return 1/0;for(;c<s.length;c++){const _=s[c],E=u[0],I=m.sub(d),P=_.sub(d),A=E.sub(d),N=s_(I,I),G=s_(I,P),$=s_(P,P),W=s_(A,I),J=s_(A,P),te=N*$-G*G,se=($*W-G*J)/te,me=(N*J-G*W)/te,Ie=d.z*(1-se-me)+m.z*se+_.z*me;if(isFinite(Ie))return Ie}return 1/0}{let c=1/0;for(const d of s)c=Math.min(c,d.z);return c}}function QA(u,s,c,d,m,_,E,I){const P=E*m.getElevationAt(u,s,!0,!0),A=_[0]!==0,N=A?_[1]===0?E*(_[0]/7-450):E*function(G,$,W){const J=Math.floor($[0]/8),te=Math.floor($[1]/8),se=10*($[0]-8*J),me=10*($[1]-8*te),Ie=G.getElevationAt(J,te,!0,!0),ye=G.getMeterToDEM(W),Se=Math.floor(.5*(se*ye-1)),Me=Math.floor(.5*(me*ye-1)),Ae=G.tileCoordToPixel(J,te),et=2*Se+1,We=2*Me+1,ft=function(Lt,ut,$t,sn,qt){return[Lt.getElevationAtPixel(ut,$t,!0),Lt.getElevationAtPixel(ut+qt,$t,!0),Lt.getElevationAtPixel(ut,$t+qt,!0),Lt.getElevationAtPixel(ut+sn,$t+qt,!0)]}(G,Ae.x-Se,Ae.y-Me,et,We),St=Math.abs(ft[0]-ft[1]),it=Math.abs(ft[2]-ft[3]),mt=Math.abs(ft[0]-ft[2])+Math.abs(ft[1]-ft[3]),yt=Math.min(.25,.5*ye*(St+it)/et),bt=Math.min(.25,.5*ye*mt/We);return Ie+Math.max(yt*se,bt*me)}(m,_,I):P;return{base:P+(c===0)?-1:c,top:A?Math.max(N+d,P+c+2):P+d}}const z6=ze([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:U6}=z6,V6=ze([{name:"a_packed",components:4,type:"Float32"}]),{members:G6}=V6,$6=px.types,j6=Math.cos(Math.PI/180*37.5);class yx{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.projection=s.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new rt,this.layoutVertexArray2=new wt,this.indexArray=new gn,this.programConfigurations=new ep(s.layers,s.zoom),this.segments=new wo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,d,m){this.hasPattern=dS("line",this.layers,c);const _=this.layers[0].layout.get("line-sort-key"),E=[];for(const{feature:N,id:G,index:$,sourceLayerIndex:W}of s){const J=this.layers[0]._featureFilter.needGeometry,te=ap(N,J);if(!this.layers[0]._featureFilter.filter(new F(this.zoom),te,d))continue;const se=_?_.evaluate(te,{},d):void 0,me={id:G,properties:N.properties,type:N.type,sourceLayerIndex:W,index:$,geometry:J?te.geometry:Ih(N,d,m),patterns:{},sortKey:se};E.push(me)}_&&E.sort((N,G)=>N.sortKey-G.sortKey);const{lineAtlas:I,featureIndex:P}=c,A=this.addConstantDashes(I);for(const N of E){const{geometry:G,index:$,sourceLayerIndex:W}=N;if(A&&this.addFeatureDashes(N,I),this.hasPattern){const J=pS("line",this.layers,N,this.zoom,c);this.patternFeatures.push(J)}else this.addFeature(N,G,$,d,I.positions,c.availableImages);P.insert(s[$].feature,G,$,W,this.index)}}addConstantDashes(s){let c=!1;for(const d of this.layers){const m=d.paint.get("line-dasharray").value,_=d.layout.get("line-cap").value;if(m.kind!=="constant"||_.kind!=="constant")c=!0;else{const E=_.value,I=m.value;if(!I)continue;s.addDash(I,E)}}return c}addFeatureDashes(s,c){const d=this.zoom;for(const m of this.layers){const _=m.paint.get("line-dasharray").value,E=m.layout.get("line-cap").value;if(_.kind==="constant"&&E.kind==="constant")continue;let I,P;if(_.kind==="constant"){if(I=_.value,!I)continue}else I=_.evaluate({zoom:d},s);P=E.kind==="constant"?E.value:E.evaluate({zoom:d},s),c.addDash(I,P),s.patterns[m.id]=c.getKey(I,P)}}update(s,c,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d,m)}addFeatures(s,c,d,m,_){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,c,d,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,G6)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,U6),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,c,d,m,_,E){const I=this.layers[0].layout,P=I.get("line-join").evaluate(s,{}),A=I.get("line-cap").evaluate(s,{}),N=I.get("line-miter-limit"),G=I.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const $ of c)this.addLine($,s,P,A,N,G);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,_,E,m)}addLine(s,c,d,m,_,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let me=0;me<s.length-1;me++)this.totalDistance+=s[me].dist(s[me+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const I=$6[c.type]==="Polygon";let P=s.length;for(;P>=2&&s[P-1].equals(s[P-2]);)P--;let A=0;for(;A<P-1&&s[A].equals(s[A+1]);)A++;if(P<(I?3:2))return;d==="bevel"&&(_=1.05);const N=this.overscaling<=16?15*bn/(512*this.overscaling):0,G=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray);let $,W,J,te,se;this.e1=this.e2=-1,I&&($=s[P-2],se=s[A].sub($)._unit()._perp());for(let me=A;me<P;me++){if(J=me===P-1?I?s[A+1]:void 0:s[me+1],J&&s[me].equals(J))continue;se&&(te=se),$&&(W=$),$=s[me],se=J?J.sub($)._unit()._perp():te,te=te||se;let Ie=te.add(se);Ie.x===0&&Ie.y===0||Ie._unit();const ye=te.x*se.x+te.y*se.y,Se=Ie.x*se.x+Ie.y*se.y,Me=Se!==0?1/Se:1/0,Ae=2*Math.sqrt(2-2*Se),et=Se<j6&&W&&J,We=te.x*se.y-te.y*se.x>0;if(et&&me>A){const it=$.dist(W);if(it>2*N){const mt=$.sub($.sub(W)._mult(N/it)._round());this.updateDistance(W,mt),this.addCurrentVertex(mt,te,0,0,G),W=mt}}const ft=W&&J;let St=ft?d:I?"butt":m;if(ft&&St==="round"&&(Me<E?St="miter":Me<=2&&(St="fakeround")),St==="miter"&&Me>_&&(St="bevel"),St==="bevel"&&(Me>2&&(St="flipbevel"),Me<_&&(St="miter")),W&&this.updateDistance(W,$),St==="miter")Ie._mult(Me),this.addCurrentVertex($,Ie,0,0,G);else if(St==="flipbevel"){if(Me>100)Ie=se.mult(-1);else{const it=Me*te.add(se).mag()/te.sub(se).mag();Ie._perp()._mult(it*(We?-1:1))}this.addCurrentVertex($,Ie,0,0,G),this.addCurrentVertex($,Ie.mult(-1),0,0,G)}else if(St==="bevel"||St==="fakeround"){const it=-Math.sqrt(Me*Me-1),mt=We?it:0,yt=We?0:it;if(W&&this.addCurrentVertex($,te,mt,yt,G),St==="fakeround"){const bt=Math.round(180*Ae/Math.PI/20);for(let Lt=1;Lt<bt;Lt++){let ut=Lt/bt;if(ut!==.5){const sn=ut-.5;ut+=ut*sn*(ut-1)*((1.0904+ye*(ye*(3.55645-1.43519*ye)-3.2452))*sn*sn+(.848013+ye*(.215638*ye-1.06021)))}const $t=se.sub(te)._mult(ut)._add(te)._unit()._mult(We?-1:1);this.addHalfVertex($,$t.x,$t.y,!1,We,0,G)}}J&&this.addCurrentVertex($,se,-mt,-yt,G)}else if(St==="butt")this.addCurrentVertex($,Ie,0,0,G);else if(St==="square"){const it=W?1:-1;W||this.addCurrentVertex($,Ie,it,it,G),this.addCurrentVertex($,Ie,0,0,G),W&&this.addCurrentVertex($,Ie,it,it,G)}else St==="round"&&(W&&(this.addCurrentVertex($,te,0,0,G),this.addCurrentVertex($,te,1,1,G,!0)),J&&(this.addCurrentVertex($,se,-1,-1,G,!0),this.addCurrentVertex($,se,0,0,G)));if(et&&me<P-1){const it=$.dist(J);if(it>2*N){const mt=$.add(J.sub($)._mult(N/it)._round());this.updateDistance($,mt),this.addCurrentVertex(mt,se,0,0,G),$=mt}}}}addCurrentVertex(s,c,d,m,_,E=!1){const I=c.y*m-c.x,P=-c.y-c.x*m;this.addHalfVertex(s,c.x+c.y*d,c.y-c.x*d,E,!1,d,_),this.addHalfVertex(s,I,P,E,!0,-m,_)}addHalfVertex({x:s,y:c},d,m,_,E,I,P){this.layoutVertexArray.emplaceBack((s<<1)+(_?1:0),(c<<1)+(E?1:0),Math.round(63*d)+128,Math.round(63*m)+128,1+(I===0?0:I<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const A=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,A),P.primitiveLength++),E?this.e2=A:this.e1=A}updateScaledDistance(){if(this.lineClips){const s=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=s*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(s,c){this.distance+=s.dist(c),this.updateScaledDistance()}}nn(yx,"LineBucket",{omit:["layers","patternFeatures"]});const q6=new xe({"line-cap":new ce(ct.layout_line["line-cap"]),"line-join":new ce(ct.layout_line["line-join"]),"line-miter-limit":new ee(ct.layout_line["line-miter-limit"]),"line-round-limit":new ee(ct.layout_line["line-round-limit"]),"line-sort-key":new ce(ct.layout_line["line-sort-key"])});var eM={paint:new xe({"line-opacity":new ce(ct.paint_line["line-opacity"]),"line-color":new ce(ct.paint_line["line-color"]),"line-translate":new ee(ct.paint_line["line-translate"]),"line-translate-anchor":new ee(ct.paint_line["line-translate-anchor"]),"line-width":new ce(ct.paint_line["line-width"]),"line-gap-width":new ce(ct.paint_line["line-gap-width"]),"line-offset":new ce(ct.paint_line["line-offset"]),"line-blur":new ce(ct.paint_line["line-blur"]),"line-dasharray":new ce(ct.paint_line["line-dasharray"]),"line-pattern":new ce(ct.paint_line["line-pattern"]),"line-gradient":new _e(ct.paint_line["line-gradient"]),"line-trim-offset":new ee(ct.paint_line["line-trim-offset"])}),layout:q6};const tM=new class extends ce{possiblyEvaluate(u,s){return s=new F(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(u,s)}evaluate(u,s,c,d){return s=xt({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(u,s,c,d)}}(eM.paint.properties["line-width"].specification);function nM(u,s){return s>0?s+2*u:u}tM.useIntegerZoom=!0;const Z6=ze([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),X6=ze([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),W6=ze([{name:"a_projected_pos",components:4,type:"Float32"}],4);ze([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const H6=ze([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Y6=ze([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);ze([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const rM=ze([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),K6=ze([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ze([{name:"triangle",components:3,type:"Uint16"}]),ze([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ze([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ze([{type:"Float32",name:"offsetX"}]),ze([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ga=24;const ec=128;function mS(u,s){const{expression:c}=s;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new F(u+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:m}=c;let _=0;for(;_<d.length&&d[_]<=u;)_++;_=Math.max(0,_-1);let E=_;for(;E<d.length&&d[E]<u+1;)E++;E=Math.min(d.length-1,E);const I=d[_],P=d[E];return c.kind==="composite"?{kind:"composite",minZoom:I,maxZoom:P,interpolationType:m}:{kind:"camera",minZoom:I,maxZoom:P,minSize:c.evaluate(new F(I)),maxSize:c.evaluate(new F(P)),interpolationType:m}}}function vx(u,{uSize:s,uSizeT:c},{lowerSize:d,upperSize:m}){return u.kind==="source"?d/ec:u.kind==="composite"?mr(d/ec,m/ec,c):s}function om(u,s){let c=0,d=0;if(u.kind==="constant")d=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:m,minZoom:_,maxZoom:E}=u,I=m?Pe(Zl.interpolationFactor(m,s,_,E),0,1):0;u.kind==="camera"?d=mr(u.minSize,u.maxSize,I):c=I}return{uSizeT:c,uSize:d}}var J6=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:ec,evaluateSizeForFeature:vx,evaluateSizeForZoom:om,getSizeData:mS});function Q6(u,s,c){return u.sections.forEach(d=>{d.text=function(m,_,E){const I=_.layout.get("text-transform").evaluate(E,{});return I==="uppercase"?m=m.toLocaleUpperCase():I==="lowercase"&&(m=m.toLocaleLowerCase()),R.applyArabicShaping&&(m=R.applyArabicShaping(m)),m}(d.text,s,c)}),u}const l_={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function eU(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}function tU(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}var iM=_i,oM=function(u,s,c,d,m){var _,E,I=8*m-d-1,P=(1<<I)-1,A=P>>1,N=-7,G=c?m-1:0,$=c?-1:1,W=u[s+G];for(G+=$,_=W&(1<<-N)-1,W>>=-N,N+=I;N>0;_=256*_+u[s+G],G+=$,N-=8);for(E=_&(1<<-N)-1,_>>=-N,N+=d;N>0;E=256*E+u[s+G],G+=$,N-=8);if(_===0)_=1-A;else{if(_===P)return E?NaN:1/0*(W?-1:1);E+=Math.pow(2,d),_-=A}return(W?-1:1)*E*Math.pow(2,_-d)},aM=function(u,s,c,d,m,_){var E,I,P,A=8*_-m-1,N=(1<<A)-1,G=N>>1,$=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,W=d?0:_-1,J=d?1:-1,te=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(I=isNaN(s)?1:0,E=N):(E=Math.floor(Math.log(s)/Math.LN2),s*(P=Math.pow(2,-E))<1&&(E--,P*=2),(s+=E+G>=1?$/P:$*Math.pow(2,1-G))*P>=2&&(E++,P/=2),E+G>=N?(I=0,E=N):E+G>=1?(I=(s*P-1)*Math.pow(2,m),E+=G):(I=s*Math.pow(2,G-1)*Math.pow(2,m),E=0));m>=8;u[c+W]=255&I,W+=J,I/=256,m-=8);for(E=E<<m|I,A+=m;A>0;u[c+W]=255&E,W+=J,E/=256,A-=8);u[c+W-J]|=128*te};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function _i(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}_i.Varint=0,_i.Fixed64=1,_i.Bytes=2,_i.Fixed32=5;var yS=4294967296,sM=1/yS,lM=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ph(u){return u.type===_i.Bytes?u.readVarint()+u.pos:u.pos+1}function am(u,s,c){return c?4294967296*s+(u>>>0):4294967296*(s>>>0)+(u>>>0)}function uM(u,s,c){var d=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));c.realloc(d);for(var m=c.pos-1;m>=u;m--)c.buf[m+d]=c.buf[m]}function nU(u,s){for(var c=0;c<u.length;c++)s.writeVarint(u[c])}function rU(u,s){for(var c=0;c<u.length;c++)s.writeSVarint(u[c])}function iU(u,s){for(var c=0;c<u.length;c++)s.writeFloat(u[c])}function oU(u,s){for(var c=0;c<u.length;c++)s.writeDouble(u[c])}function aU(u,s){for(var c=0;c<u.length;c++)s.writeBoolean(u[c])}function sU(u,s){for(var c=0;c<u.length;c++)s.writeFixed32(u[c])}function lU(u,s){for(var c=0;c<u.length;c++)s.writeSFixed32(u[c])}function uU(u,s){for(var c=0;c<u.length;c++)s.writeFixed64(u[c])}function cU(u,s){for(var c=0;c<u.length;c++)s.writeSFixed64(u[c])}function _x(u,s){return(u[s]|u[s+1]<<8|u[s+2]<<16)+16777216*u[s+3]}function sm(u,s,c){u[c]=s,u[c+1]=s>>>8,u[c+2]=s>>>16,u[c+3]=s>>>24}function cM(u,s){return(u[s]|u[s+1]<<8|u[s+2]<<16)+(u[s+3]<<24)}_i.prototype={destroy:function(){this.buf=null},readFields:function(u,s,c){for(c=c||this.length;this.pos<c;){var d=this.readVarint(),m=d>>3,_=this.pos;this.type=7&d,u(m,s,this),this.pos===_&&this.skip(d)}return s},readMessage:function(u,s){return this.readFields(u,s,this.readVarint()+this.pos)},readFixed32:function(){var u=_x(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=cM(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=_x(this.buf,this.pos)+_x(this.buf,this.pos+4)*yS;return this.pos+=8,u},readSFixed64:function(){var u=_x(this.buf,this.pos)+cM(this.buf,this.pos+4)*yS;return this.pos+=8,u},readFloat:function(){var u=oM(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=oM(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var s,c,d=this.buf;return s=127&(c=d[this.pos++]),c<128?s:(s|=(127&(c=d[this.pos++]))<<7,c<128?s:(s|=(127&(c=d[this.pos++]))<<14,c<128?s:(s|=(127&(c=d[this.pos++]))<<21,c<128?s:function(m,_,E){var I,P,A=E.buf;if(I=(112&(P=A[E.pos++]))>>4,P<128||(I|=(127&(P=A[E.pos++]))<<3,P<128)||(I|=(127&(P=A[E.pos++]))<<10,P<128)||(I|=(127&(P=A[E.pos++]))<<17,P<128)||(I|=(127&(P=A[E.pos++]))<<24,P<128)||(I|=(1&(P=A[E.pos++]))<<31,P<128))return am(m,I,_);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(c=d[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,s=this.pos;return this.pos=u,u-s>=12&&lM?function(c,d,m){return lM.decode(c.subarray(d,m))}(this.buf,s,u):function(c,d,m){for(var _="",E=d;E<m;){var I,P,A,N=c[E],G=null,$=N>239?4:N>223?3:N>191?2:1;if(E+$>m)break;$===1?N<128&&(G=N):$===2?(192&(I=c[E+1]))==128&&(G=(31&N)<<6|63&I)<=127&&(G=null):$===3?(P=c[E+2],(192&(I=c[E+1]))==128&&(192&P)==128&&((G=(15&N)<<12|(63&I)<<6|63&P)<=2047||G>=55296&&G<=57343)&&(G=null)):$===4&&(P=c[E+2],A=c[E+3],(192&(I=c[E+1]))==128&&(192&P)==128&&(192&A)==128&&((G=(15&N)<<18|(63&I)<<12|(63&P)<<6|63&A)<=65535||G>=1114112)&&(G=null)),G===null?(G=65533,$=1):G>65535&&(G-=65536,_+=String.fromCharCode(G>>>10&1023|55296),G=56320|1023&G),_+=String.fromCharCode(G),E+=$}return _}(this.buf,s,u)},readBytes:function(){var u=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,u);return this.pos=u,s},readPackedVarint:function(u,s){if(this.type!==_i.Bytes)return u.push(this.readVarint(s));var c=Ph(this);for(u=u||[];this.pos<c;)u.push(this.readVarint(s));return u},readPackedSVarint:function(u){if(this.type!==_i.Bytes)return u.push(this.readSVarint());var s=Ph(this);for(u=u||[];this.pos<s;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==_i.Bytes)return u.push(this.readBoolean());var s=Ph(this);for(u=u||[];this.pos<s;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==_i.Bytes)return u.push(this.readFloat());var s=Ph(this);for(u=u||[];this.pos<s;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==_i.Bytes)return u.push(this.readDouble());var s=Ph(this);for(u=u||[];this.pos<s;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==_i.Bytes)return u.push(this.readFixed32());var s=Ph(this);for(u=u||[];this.pos<s;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==_i.Bytes)return u.push(this.readSFixed32());var s=Ph(this);for(u=u||[];this.pos<s;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==_i.Bytes)return u.push(this.readFixed64());var s=Ph(this);for(u=u||[];this.pos<s;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==_i.Bytes)return u.push(this.readSFixed64());var s=Ph(this);for(u=u||[];this.pos<s;)u.push(this.readSFixed64());return u},skip:function(u){var s=7&u;if(s===_i.Varint)for(;this.buf[this.pos++]>127;);else if(s===_i.Bytes)this.pos=this.readVarint()+this.pos;else if(s===_i.Fixed32)this.pos+=4;else{if(s!==_i.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(u,s){this.writeVarint(u<<3|s)},realloc:function(u){for(var s=this.length||16;s<this.pos+u;)s*=2;if(s!==this.length){var c=new Uint8Array(s);c.set(this.buf),this.buf=c,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),sm(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),sm(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),sm(this.buf,-1&u,this.pos),sm(this.buf,Math.floor(u*sM),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),sm(this.buf,-1&u,this.pos),sm(this.buf,Math.floor(u*sM),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(s,c){var d,m;if(s>=0?(d=s%4294967296|0,m=s/4294967296|0):(m=~(-s/4294967296),4294967295^(d=~(-s%4294967296))?d=d+1|0:(d=0,m=m+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),function(_,E,I){I.buf[I.pos++]=127&_|128,_>>>=7,I.buf[I.pos++]=127&_|128,_>>>=7,I.buf[I.pos++]=127&_|128,_>>>=7,I.buf[I.pos++]=127&_|128,I.buf[I.pos]=127&(_>>>=7)}(d,0,c),function(_,E){var I=(7&_)<<4;E.buf[E.pos++]|=I|((_>>>=3)?128:0),_&&(E.buf[E.pos++]=127&_|((_>>>=7)?128:0),_&&(E.buf[E.pos++]=127&_|((_>>>=7)?128:0),_&&(E.buf[E.pos++]=127&_|((_>>>=7)?128:0),_&&(E.buf[E.pos++]=127&_|((_>>>=7)?128:0),_&&(E.buf[E.pos++]=127&_)))))}(m,c)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var s=this.pos;this.pos=function(d,m,_){for(var E,I,P=0;P<m.length;P++){if((E=m.charCodeAt(P))>55295&&E<57344){if(!I){E>56319||P+1===m.length?(d[_++]=239,d[_++]=191,d[_++]=189):I=E;continue}if(E<56320){d[_++]=239,d[_++]=191,d[_++]=189,I=E;continue}E=I-55296<<10|E-56320|65536,I=null}else I&&(d[_++]=239,d[_++]=191,d[_++]=189,I=null);E<128?d[_++]=E:(E<2048?d[_++]=E>>6|192:(E<65536?d[_++]=E>>12|224:(d[_++]=E>>18|240,d[_++]=E>>12&63|128),d[_++]=E>>6&63|128),d[_++]=63&E|128)}return _}(this.buf,u,this.pos);var c=this.pos-s;c>=128&&uM(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeFloat:function(u){this.realloc(4),aM(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),aM(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var s=u.length;this.writeVarint(s),this.realloc(s);for(var c=0;c<s;c++)this.buf[this.pos++]=u[c]},writeRawMessage:function(u,s){this.pos++;var c=this.pos;u(s,this);var d=this.pos-c;d>=128&&uM(c,d,this),this.pos=c-1,this.writeVarint(d),this.pos+=d},writeMessage:function(u,s,c){this.writeTag(u,_i.Bytes),this.writeRawMessage(s,c)},writePackedVarint:function(u,s){s.length&&this.writeMessage(u,nU,s)},writePackedSVarint:function(u,s){s.length&&this.writeMessage(u,rU,s)},writePackedBoolean:function(u,s){s.length&&this.writeMessage(u,aU,s)},writePackedFloat:function(u,s){s.length&&this.writeMessage(u,iU,s)},writePackedDouble:function(u,s){s.length&&this.writeMessage(u,oU,s)},writePackedFixed32:function(u,s){s.length&&this.writeMessage(u,sU,s)},writePackedSFixed32:function(u,s){s.length&&this.writeMessage(u,lU,s)},writePackedFixed64:function(u,s){s.length&&this.writeMessage(u,uU,s)},writePackedSFixed64:function(u,s){s.length&&this.writeMessage(u,cU,s)},writeBytesField:function(u,s){this.writeTag(u,_i.Bytes),this.writeBytes(s)},writeFixed32Field:function(u,s){this.writeTag(u,_i.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(u,s){this.writeTag(u,_i.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(u,s){this.writeTag(u,_i.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(u,s){this.writeTag(u,_i.Fixed64),this.writeSFixed64(s)},writeVarintField:function(u,s){this.writeTag(u,_i.Varint),this.writeVarint(s)},writeSVarintField:function(u,s){this.writeTag(u,_i.Varint),this.writeSVarint(s)},writeStringField:function(u,s){this.writeTag(u,_i.Bytes),this.writeString(s)},writeFloatField:function(u,s){this.writeTag(u,_i.Fixed32),this.writeFloat(s)},writeDoubleField:function(u,s){this.writeTag(u,_i.Fixed64),this.writeDouble(s)},writeBooleanField:function(u,s){this.writeVarintField(u,!!s)}};var xx=k(iM);const vS=3;function hU(u,s,c){s.glyphs=[],u===1&&c.readMessage(fU,s)}function fU(u,s,c){if(u===3){const{id:d,bitmap:m,width:_,height:E,left:I,top:P,advance:A}=c.readMessage(dU,{});s.glyphs.push({id:d,bitmap:new Ch({width:_+2*vS,height:E+2*vS},m),metrics:{width:_,height:E,left:I,top:P,advance:A}})}else u===4?s.ascender=c.readSVarint():u===5&&(s.descender=c.readSVarint())}function dU(u,s,c){u===1?s.id=c.readVarint():u===2?s.bitmap=c.readBytes():u===3?s.width=c.readVarint():u===4?s.height=c.readVarint():u===5?s.left=c.readSVarint():u===6?s.top=c.readSVarint():u===7&&(s.advance=c.readVarint())}const hM=vS;function _S(u){let s=0,c=0;for(const E of u)s+=E.w*E.h,c=Math.max(c,E.w);u.sort((E,I)=>I.h-E.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),c),h:1/0}];let m=0,_=0;for(const E of u)for(let I=d.length-1;I>=0;I--){const P=d[I];if(!(E.w>P.w||E.h>P.h)){if(E.x=P.x,E.y=P.y,_=Math.max(_,E.y+E.h),m=Math.max(m,E.x+E.w),E.w===P.w&&E.h===P.h){const A=d.pop();I<d.length&&(d[I]=A)}else E.h===P.h?(P.x+=E.w,P.w-=E.w):E.w===P.w?(P.y+=E.h,P.h-=E.h):(d.push({x:P.x+E.w,y:P.y,w:P.w-E.w,h:E.h}),P.y+=E.h,P.h-=E.h);break}}return{w:m,h:_,fill:s/(m*_)||0}}const Ps=1;class xS{constructor(s,{pixelRatio:c,version:d,stretchX:m,stretchY:_,content:E}){this.paddedRect=s,this.pixelRatio=c,this.stretchX=m,this.stretchY=_,this.content=E,this.version=d}get tl(){return[this.paddedRect.x+Ps,this.paddedRect.y+Ps]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ps,this.paddedRect.y+this.paddedRect.h-Ps]}get displaySize(){return[(this.paddedRect.w-2*Ps)/this.pixelRatio,(this.paddedRect.h-2*Ps)/this.pixelRatio]}}class fM{constructor(s,c){const d={},m={};this.haveRenderCallbacks=[];const _=[];this.addImages(s,d,_),this.addImages(c,m,_);const{w:E,h:I}=_S(_),P=new Ws({width:E||1,height:I||1});for(const A in s){const N=s[A],G=d[A].paddedRect;Ws.copy(N.data,P,{x:0,y:0},{x:G.x+Ps,y:G.y+Ps},N.data)}for(const A in c){const N=c[A],G=m[A].paddedRect,$=G.x+Ps,W=G.y+Ps,J=N.data.width,te=N.data.height;Ws.copy(N.data,P,{x:0,y:0},{x:$,y:W},N.data),Ws.copy(N.data,P,{x:0,y:te-1},{x:$,y:W-1},{width:J,height:1}),Ws.copy(N.data,P,{x:0,y:0},{x:$,y:W+te},{width:J,height:1}),Ws.copy(N.data,P,{x:J-1,y:0},{x:$-1,y:W},{width:1,height:te}),Ws.copy(N.data,P,{x:0,y:0},{x:$+J,y:W},{width:1,height:te})}this.image=P,this.iconPositions=d,this.patternPositions=m}addImages(s,c,d){for(const m in s){const _=s[m],E={x:0,y:0,w:_.data.width+2*Ps,h:_.data.height+2*Ps};d.push(E),c[m]=new xS(E,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(s,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(d=>s.hasImage(d)),s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in s.updatedImages)this.patchUpdatedImage(this.iconPositions[d],s.getImage(d),c),this.patchUpdatedImage(this.patternPositions[d],s.getImage(d),c)}patchUpdatedImage(s,c,d){if(!s||!c||s.version===c.version)return;s.version=c.version;const[m,_]=s.tl;d.update(c.data,void 0,{x:m,y:_})}}nn(xS,"ImagePosition"),nn(fM,"ImageAtlas");const xl={horizontal:1,vertical:2,horizontalOnly:3},dM=-17;class u_{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,c){const d=new u_;return d.scale=s||1,d.fontStack=c,d}static forImage(s){const c=new u_;return c.imageName=s,c}}class lm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,c){const d=new lm;for(let m=0;m<s.sections.length;m++){const _=s.sections[m];_.image?d.addImageSection(_):d.addTextSection(_,c)}return d}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSections(){return this.sections}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(s){this.text=function(c,d){let m="";for(let _=0;_<c.length;_++){const E=c.charCodeAt(_+1)||null,I=c.charCodeAt(_-1)||null;m+=!d&&(E&&H1(E)&&!l_[c[_+1]]||I&&H1(I)&&!l_[c[_-1]])||!l_[c[_]]?c[_]:l_[c[_]]}return m}(this.text,s)}trim(){let s=0;for(let d=0;d<this.text.length&&bx[this.text.charCodeAt(d)];d++)s++;let c=this.text.length;for(let d=this.text.length-1;d>=0&&d>=s&&bx[this.text.charCodeAt(d)];d--)c--;this.text=this.text.substring(s,c),this.sectionIndex=this.sectionIndex.slice(s,c)}substring(s,c){const d=new lm;return d.text=this.text.substring(s,c),d.sectionIndex=this.sectionIndex.slice(s,c),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,c)=>Math.max(s,this.sections[c].scale),0)}addTextSection(s,c){this.text+=s.text,this.sections.push(u_.forText(s.scale,s.fontStack||c));const d=this.sections.length-1;for(let m=0;m<s.text.length;++m)this.sectionIndex.push(d)}addImageSection(s){const c=s.image?s.image.name:"";if(c.length===0)return void nt("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(u_.forImage(c)),this.sectionIndex.push(this.sections.length-1)):nt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function bS(u,s,c,d,m,_,E,I,P,A,N,G,$,W,J){const te=lm.fromFeature(u,m);G===xl.vertical&&te.verticalizePunctuation($);let se=[];const me=function(Ae,et,We,ft,St,it){if(!Ae)return[];const mt=[],yt=function($t,sn,qt,Fn,Ot,vn){let Bn=0;for(let $r=0;$r<$t.length();$r++){const zn=$t.getSection($r);Bn+=pM($t.getCharCode($r),zn,Fn,Ot,sn,vn)}return Bn/Math.max(1,Math.ceil(Bn/qt))}(Ae,et,We,ft,St,it),bt=Ae.text.indexOf("")>=0;let Lt=0;for(let $t=0;$t<Ae.length();$t++){const sn=Ae.getSection($t),qt=Ae.getCharCode($t);if(bx[qt]||(Lt+=pM(qt,sn,ft,St,et,it)),$t<Ae.length()-1){const Fn=!((ut=qt)<11904||!(Zt["Bopomofo Extended"](ut)||Zt.Bopomofo(ut)||Zt["CJK Compatibility Forms"](ut)||Zt["CJK Compatibility Ideographs"](ut)||Zt["CJK Compatibility"](ut)||Zt["CJK Radicals Supplement"](ut)||Zt["CJK Strokes"](ut)||Zt["CJK Symbols and Punctuation"](ut)||Zt["CJK Unified Ideographs Extension A"](ut)||Zt["CJK Unified Ideographs"](ut)||Zt["Enclosed CJK Letters and Months"](ut)||Zt["Halfwidth and Fullwidth Forms"](ut)||Zt.Hiragana(ut)||Zt["Ideographic Description Characters"](ut)||Zt["Kangxi Radicals"](ut)||Zt["Katakana Phonetic Extensions"](ut)||Zt.Katakana(ut)||Zt["Vertical Forms"](ut)||Zt["Yi Radicals"](ut)||Zt["Yi Syllables"](ut)));(pU[qt]||Fn||sn.imageName)&&mt.push(mM($t+1,Lt,yt,mt,gU(qt,Ae.getCharCode($t+1),Fn&&bt),!1))}}var ut;return yM(mM(Ae.length(),Lt,yt,mt,0,!0))}(te,A,_,s,d,W),{processBidirectionalText:Ie,processStyledBidirectionalText:ye}=R;if(Ie&&te.sections.length===1){const Ae=Ie(te.toString(),me);for(const et of Ae){const We=new lm;We.text=et,We.sections=te.sections;for(let ft=0;ft<et.length;ft++)We.sectionIndex.push(0);se.push(We)}}else if(ye){const Ae=ye(te.text,te.sectionIndex,me);for(const et of Ae){const We=new lm;We.text=et[0],We.sectionIndex=et[1],We.sections=te.sections,se.push(We)}}else se=function(Ae,et){const We=[],ft=Ae.text;let St=0;for(const it of et)We.push(Ae.substring(St,it)),St=it;return St<ft.length&&We.push(Ae.substring(St,ft.length)),We}(te,me);const Se=[],Me={positionedLines:Se,text:te.toString(),top:N[1],bottom:N[1],left:N[0],right:N[0],writingMode:G,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Ae,et,We,ft,St,it,mt,yt,bt,Lt,ut,$t){let sn=0,qt=0,Fn=0;const Ot=yt==="right"?1:yt==="left"?0:.5;let vn=!1;for(const $n of St){const jn=$n.getSections();for(const pi of jn){if(pi.imageName)continue;const xi=et[pi.fontStack];if(xi&&(vn=xi.ascender!==void 0&&xi.descender!==void 0,!vn))break}if(!vn)break}let Bn=0;for(const $n of St){$n.trim();const jn=$n.getMaxScale(),pi=(jn-1)*ga,xi={positionedGlyphs:[],lineOffset:0};Ae.positionedLines[Bn]=xi;const bi=xi.positionedGlyphs;let gi=0;if(!$n.length()){qt+=it,++Bn;continue}let ji=0,to=0;for(let mi=0;mi<$n.length();mi++){const Fo=$n.getSection(mi),To=$n.getSectionIndex(mi),Wi=$n.getCharCode(mi);let Zr=Fo.scale,Io=null,wi=null,cs=null,Co=ga,ma=0;const Qo=!(bt===xl.horizontal||!ut&&!Nv(Wi)||ut&&(bx[Wi]||($r=Wi,Zt.Arabic($r)||Zt["Arabic Supplement"]($r)||Zt["Arabic Extended-A"]($r)||Zt["Arabic Presentation Forms-A"]($r)||Zt["Arabic Presentation Forms-B"]($r))));if(Fo.imageName){const hs=ft[Fo.imageName];if(!hs)continue;cs=Fo.imageName,Ae.iconsInText=Ae.iconsInText||!0,wi=hs.paddedRect;const ea=hs.displaySize;Zr=Zr*ga/$t,Io={width:ea[0],height:ea[1],left:Ps,top:-hM,advance:Qo?ea[1]:ea[0],localGlyph:!1},ma=vn?-Io.height*Zr:dM+jn*ga-ea[1]*Zr,Co=Io.advance;const rc=(Qo?ea[0]:ea[1])*Zr-ga*jn;rc>0&&rc>gi&&(gi=rc)}else{const hs=We[Fo.fontStack];if(!hs)continue;hs[Wi]&&(wi=hs[Wi]);const ea=et[Fo.fontStack];if(!ea)continue;const rc=ea.glyphs[Wi];if(!rc)continue;if(Io=rc.metrics,Co=Wi!==8203?ga:0,vn){const gm=ea.ascender!==void 0?Math.abs(ea.ascender):0,__=ea.descender!==void 0?Math.abs(ea.descender):0,x_=(gm+__)*Zr;ji<x_&&(ji=x_,to=(gm-__)/2*Zr),ma=-gm*Zr}else ma=dM+(jn-Zr)*ga}Qo?(Ae.verticalizable=!0,bi.push({glyph:Wi,imageName:cs,x:sn,y:qt+ma,vertical:Qo,scale:Zr,localGlyph:Io.localGlyph,fontStack:Fo.fontStack,sectionIndex:To,metrics:Io,rect:wi}),sn+=Co*Zr+Lt):(bi.push({glyph:Wi,imageName:cs,x:sn,y:qt+ma,vertical:Qo,scale:Zr,localGlyph:Io.localGlyph,fontStack:Fo.fontStack,sectionIndex:To,metrics:Io,rect:wi}),sn+=Io.advance*Zr+Lt)}bi.length!==0&&(Fn=Math.max(sn-Lt,Fn),vn?vM(bi,Ot,gi,to,it*jn/2):vM(bi,Ot,gi,0,it/2)),sn=0;const So=it*jn+gi;xi.lineOffset=Math.max(gi,pi),qt+=So,++Bn}var $r;const zn=qt,{horizontalAlign:Tn,verticalAlign:Ci}=wS(mt);(function($n,jn,pi,xi,bi,gi){const ji=(jn-pi)*bi,to=-gi*xi;for(const So of $n)for(const mi of So.positionedGlyphs)mi.x+=ji,mi.y+=to})(Ae.positionedLines,Ot,Tn,Ci,Fn,zn),Ae.top+=-Ci*zn,Ae.bottom=Ae.top+zn,Ae.left+=-Tn*Fn,Ae.right=Ae.left+Fn,Ae.hasBaseline=vn}(Me,s,c,d,se,E,I,P,G,A,$,J),!function(Ae){for(const et of Ae)if(et.positionedGlyphs.length!==0)return!1;return!0}(Se)&&Me}const bx={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},pU={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function pM(u,s,c,d,m,_){if(s.imageName){const E=d[s.imageName];return E?E.displaySize[0]*s.scale*ga/_+m:0}{const E=c[s.fontStack],I=E&&E.glyphs[u];return I?I.metrics.advance*s.scale+m:0}}function gM(u,s,c,d){const m=Math.pow(u-s,2);return d?u<s?m/2:2*m:m+Math.abs(c)*c}function gU(u,s,c){let d=0;return u===10&&(d-=1e4),c&&(d+=150),u!==40&&u!==65288||(d+=50),s!==41&&s!==65289||(d+=50),d}function mM(u,s,c,d,m,_){let E=null,I=gM(s,c,m,_);for(const P of d){const A=gM(s-P.x,c,m,_)+P.badness;A<=I&&(E=P,I=A)}return{index:u,x:s,priorBreak:E,badness:I}}function yM(u){return u?yM(u.priorBreak).concat(u.index):[]}function wS(u){let s=.5,c=.5;switch(u){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:s,verticalAlign:c}}function vM(u,s,c,d,m){if(!(s||c||d||m))return;const _=u.length-1,E=u[_],I=(E.x+E.metrics.advance*E.scale)*s;for(let P=0;P<=_;P++)u[P].x-=I,u[P].y+=c+d+m}function mU(u,s,c){const{horizontalAlign:d,verticalAlign:m}=wS(c),_=s[0]-u.displaySize[0]*d,E=s[1]-u.displaySize[1]*m;return{image:u,top:E,bottom:E+u.displaySize[1],left:_,right:_+u.displaySize[0]}}function _M(u,s,c,d,m,_){const E=u.image;let I;if(E.content){const se=E.content,me=E.pixelRatio||1;I=[se[0]/me,se[1]/me,E.displaySize[0]-se[2]/me,E.displaySize[1]-se[3]/me]}const P=s.left*_,A=s.right*_;let N,G,$,W;c==="width"||c==="both"?(W=m[0]+P-d[3],G=m[0]+A+d[1]):(W=m[0]+(P+A-E.displaySize[0])/2,G=W+E.displaySize[0]);const J=s.top*_,te=s.bottom*_;return c==="height"||c==="both"?(N=m[1]+J-d[0],$=m[1]+te+d[2]):(N=m[1]+(J+te-E.displaySize[1])/2,$=N+E.displaySize[1]),{image:E,top:N,right:G,bottom:$,left:W,collisionPadding:I}}class Ah extends U{constructor(s,c,d,m,_){super(s,c),this.angle=m,this.z=d,_!==void 0&&(this.segment=_)}clone(){return new Ah(this.x,this.y,this.z,this.angle,this.segment)}}function xM(u,s,c,d,m){if(s.segment===void 0)return!0;let _=s,E=s.segment+1,I=0;for(;I>-c/2;){if(E--,E<0)return!1;I-=u[E].dist(_),_=u[E]}I+=u[E].dist(u[E+1]),E++;const P=[];let A=0;for(;I<c/2;){const N=u[E],G=u[E+1];if(!G)return!1;let $=u[E-1].angleTo(N)-N.angleTo(G);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:I,angleDelta:$}),A+=$;I-P[0].distance>d;)A-=P.shift().angleDelta;if(A>m)return!1;E++,I+=N.dist(G)}return!0}function bM(u){let s=0;for(let c=0;c<u.length-1;c++)s+=u[c].dist(u[c+1]);return s}function wM(u,s,c){return u?.6*s*c:0}function EM(u,s){return Math.max(u?u.right-u.left:0,s?s.right-s.left:0)}function yU(u,s,c,d,m,_){const E=wM(c,m,_),I=EM(c,d)*_;let P=0;const A=bM(u)/2;for(let N=0;N<u.length-1;N++){const G=u[N],$=u[N+1],W=G.dist($);if(P+W>A){const J=(A-P)/W,te=mr(G.x,$.x,J),se=mr(G.y,$.y,J),me=new Ah(te,se,0,$.angleTo(G),N);return!E||xM(u,me,I,E,s)?me:void 0}P+=W}}function vU(u,s,c,d,m,_,E,I,P){const A=wM(d,_,E),N=EM(d,m),G=N*E,$=u[0].x===0||u[0].x===P||u[0].y===0||u[0].y===P;return s-G<s/4&&(s=G+s/4),SM(u,$?s/2*I%s:(N/2+2*_)*E*I%s,s,A,c,G,$,!1,P)}function SM(u,s,c,d,m,_,E,I,P){const A=_/2,N=bM(u);let G=0,$=s-c,W=[];for(let J=0;J<u.length-1;J++){const te=u[J],se=u[J+1],me=te.dist(se),Ie=se.angleTo(te);for(;$+c<G+me;){$+=c;const ye=($-G)/me,Se=mr(te.x,se.x,ye),Me=mr(te.y,se.y,ye);if(Se>=0&&Se<P&&Me>=0&&Me<P&&$-A>=0&&$+A<=N){const Ae=new Ah(Se,Me,0,Ie,J);Ae._round(),d&&!xM(u,Ae,_,d,m)||W.push(Ae)}}G+=me}return I||W.length||E||(W=SM(u,G/2,c,d,m,_,E,!0,P)),W}function TM(u,s,c,d,m){const _=[];for(let E=0;E<u.length;E++){const I=u[E];let P;for(let A=0;A<I.length-1;A++){let N=I[A],G=I[A+1];N.x<s&&G.x<s||(N.x<s?N=new U(s,N.y+(s-N.x)/(G.x-N.x)*(G.y-N.y))._round():G.x<s&&(G=new U(s,N.y+(s-N.x)/(G.x-N.x)*(G.y-N.y))._round()),N.y<c&&G.y<c||(N.y<c?N=new U(N.x+(c-N.y)/(G.y-N.y)*(G.x-N.x),c)._round():G.y<c&&(G=new U(N.x+(c-N.y)/(G.y-N.y)*(G.x-N.x),c)._round()),N.x>=d&&G.x>=d||(N.x>=d?N=new U(d,N.y+(d-N.x)/(G.x-N.x)*(G.y-N.y))._round():G.x>=d&&(G=new U(d,N.y+(d-N.x)/(G.x-N.x)*(G.y-N.y))._round()),N.y>=m&&G.y>=m||(N.y>=m?N=new U(N.x+(m-N.y)/(G.y-N.y)*(G.x-N.x),m)._round():G.y>=m&&(G=new U(N.x+(m-N.y)/(G.y-N.y)*(G.x-N.x),m)._round()),P&&N.equals(P[P.length-1])||(P=[N],_.push(P)),P.push(G)))))}}return _}nn(Ah,"Anchor");const c_=1e20;function IM(u,s,c,d,m,_,E,I,P){for(let A=s;A<s+d;A++)CM(u,c*_+A,_,m,E,I,P);for(let A=c;A<c+m;A++)CM(u,A*_+s,1,d,E,I,P)}function CM(u,s,c,d,m,_,E){_[0]=0,E[0]=-c_,E[1]=c_,m[0]=u[s];for(let I=1,P=0,A=0;I<d;I++){m[I]=u[s+I*c];const N=I*I;do{const G=_[P];A=(m[I]-m[G]+N-G*G)/(I-G)/2}while(A<=E[P]&&--P>-1);P++,_[P]=I,E[P]=A,E[P+1]=c_}for(let I=0,P=0;I<d;I++){for(;E[P+1]<I;)P++;const A=_[P],N=I-A;u[s+I*c]=m[A]+N*N}}const tc=2,ES={none:0,ideographs:1,all:2};class um{constructor(s,c,d){this.requestManager=s,this.localGlyphMode=c,this.localFontFamily=d,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(s){this.url=s}getGlyphs(s,c){const d=[];for(const m in s)for(const _ of s[m])d.push({stack:m,id:_});Ue(d,({stack:m,id:_},E)=>{let I=this.entries[m];I||(I=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let P=I.glyphs[_];if(P!==void 0)return void E(null,{stack:m,id:_,glyph:P});if(P=this._tinySDF(I,m,_),P)return I.glyphs[_]=P,void E(null,{stack:m,id:_,glyph:P});const A=Math.floor(_/256);if(256*A>65535)return void E(new Error("glyphs > 65535 not supported"));if(I.ranges[A])return void E(null,{stack:m,id:_,glyph:P});let N=I.requests[A];N||(N=I.requests[A]=[],um.loadGlyphRange(m,A,this.url,this.requestManager,(G,$)=>{if($){I.ascender=$.ascender,I.descender=$.descender;for(const W in $.glyphs)this._doesCharSupportLocalGlyph(+W)||(I.glyphs[+W]=$.glyphs[+W]);I.ranges[A]=!0}for(const W of N)W(G,$);delete I.requests[A]})),N.push((G,$)=>{G?E(G):$&&E(null,{stack:m,id:_,glyph:$.glyphs[_]||null})})},(m,_)=>{if(m)c(m);else if(_){const E={};for(const{stack:I,id:P,glyph:A}of _)E[I]===void 0&&(E[I]={}),E[I].glyphs===void 0&&(E[I].glyphs={}),E[I].glyphs[P]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics},E[I].ascender=this.entries[I].ascender,E[I].descender=this.entries[I].descender;c(null,E)}})}_doesCharSupportLocalGlyph(s){return this.localGlyphMode!==ES.none&&(this.localGlyphMode===ES.all?!!this.localFontFamily:!!this.localFontFamily&&(Zt["CJK Unified Ideographs"](s)||Zt["Hangul Syllables"](s)||Zt.Hiragana(s)||Zt.Katakana(s)||Zt["CJK Symbols and Punctuation"](s)))}_tinySDF(s,c,d){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(d))return;let _=s.tinySDF;if(!_){let te="400";/bold/i.test(c)?te="900":/medium/i.test(c)?te="500":/light/i.test(c)&&(te="200"),_=s.tinySDF=new um.TinySDF({fontFamily:m,fontWeight:te,fontSize:24*tc,buffer:3*tc,radius:8*tc}),_.fontWeight=te}if(this.localGlyphs[_.fontWeight][d])return this.localGlyphs[_.fontWeight][d];const E=String.fromCharCode(d),{data:I,width:P,height:A,glyphWidth:N,glyphHeight:G,glyphLeft:$,glyphTop:W,glyphAdvance:J}=_.draw(E);return this.localGlyphs[_.fontWeight][d]={id:d,bitmap:new Ch({width:P,height:A},I),metrics:{width:N/tc,height:G/tc,left:$/tc,top:W/tc-27,advance:J/tc,localGlyph:!0}}}}um.loadGlyphRange=function(u,s,c,d,m){const _=256*s,E=_+255,I=d.transformRequest(d.normalizeGlyphsURL(c).replace("{fontstack}",u).replace("{range}",`${_}-${E}`),Ts.Glyphs);Fu(I,(P,A)=>{if(P)m(P);else if(A){const N={},G=function($){return new xx($).readFields(hU,{})}(A);for(const $ of G.glyphs)N[$.id]=$;m(null,{glyphs:N,ascender:G.ascender,descender:G.descender})}})},um.TinySDF=class{constructor({fontSize:u=24,buffer:s=3,radius:c=8,cutoff:d=.25,fontFamily:m="sans-serif",fontWeight:_="normal",fontStyle:E="normal"}={}){this.buffer=s,this.cutoff=d,this.radius=c;const I=this.size=u+4*s,P=this._createCanvas(I),A=this.ctx=P.getContext("2d",{willReadFrequently:!0});A.font=`${E} ${_} ${u}px ${m}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Uint16Array(I)}_createCanvas(u){const s=document.createElement("canvas");return s.width=s.height=u,s}draw(u){const{width:s,actualBoundingBoxAscent:c,actualBoundingBoxDescent:d,actualBoundingBoxLeft:m,actualBoundingBoxRight:_}=this.ctx.measureText(u),E=Math.ceil(c),I=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-m))),P=Math.min(this.size-this.buffer,E+Math.ceil(d)),A=I+2*this.buffer,N=P+2*this.buffer,G=Math.max(A*N,0),$=new Uint8ClampedArray(G),W={data:$,width:A,height:N,glyphWidth:I,glyphHeight:P,glyphTop:E,glyphLeft:0,glyphAdvance:s};if(I===0||P===0)return W;const{ctx:J,buffer:te,gridInner:se,gridOuter:me}=this;J.clearRect(te,te,I,P),J.fillText(u,te,te+E);const Ie=J.getImageData(te,te,I,P);me.fill(c_,0,G),se.fill(0,0,G);for(let ye=0;ye<P;ye++)for(let Se=0;Se<I;Se++){const Me=Ie.data[4*(ye*I+Se)+3]/255;if(Me===0)continue;const Ae=(ye+te)*A+Se+te;if(Me===1)me[Ae]=0,se[Ae]=c_;else{const et=.5-Me;me[Ae]=et>0?et*et:0,se[Ae]=et<0?et*et:0}}IM(me,0,0,A,N,A,this.f,this.v,this.z),IM(se,te,te,I,P,A,this.f,this.v,this.z);for(let ye=0;ye<G;ye++){const Se=Math.sqrt(me[ye])-Math.sqrt(se[ye]);$[ye]=Math.round(255-255*(Se/this.radius+this.cutoff))}return W}};const cm=Ps;function PM(u,s,c,d){const m=[],_=u.image,E=_.pixelRatio,I=_.paddedRect.w-2*cm,P=_.paddedRect.h-2*cm,A=u.right-u.left,N=u.bottom-u.top,G=_.stretchX||[[0,I]],$=_.stretchY||[[0,P]],W=(it,mt)=>it+mt[1]-mt[0],J=G.reduce(W,0),te=$.reduce(W,0),se=I-J,me=P-te;let Ie=0,ye=J,Se=0,Me=te,Ae=0,et=se,We=0,ft=me;if(_.content&&d){const it=_.content;Ie=wx(G,0,it[0]),Se=wx($,0,it[1]),ye=wx(G,it[0],it[2]),Me=wx($,it[1],it[3]),Ae=it[0]-Ie,We=it[1]-Se,et=it[2]-it[0]-ye,ft=it[3]-it[1]-Me}const St=(it,mt,yt,bt)=>{const Lt=Ex(it.stretch-Ie,ye,A,u.left),ut=Sx(it.fixed-Ae,et,it.stretch,J),$t=Ex(mt.stretch-Se,Me,N,u.top),sn=Sx(mt.fixed-We,ft,mt.stretch,te),qt=Ex(yt.stretch-Ie,ye,A,u.left),Fn=Sx(yt.fixed-Ae,et,yt.stretch,J),Ot=Ex(bt.stretch-Se,Me,N,u.top),vn=Sx(bt.fixed-We,ft,bt.stretch,te),Bn=new U(Lt,$t),$r=new U(qt,$t),zn=new U(qt,Ot),Tn=new U(Lt,Ot),Ci=new U(ut/E,sn/E),$n=new U(Fn/E,vn/E),jn=s*Math.PI/180;if(jn){const bi=Math.sin(jn),gi=Math.cos(jn),ji=[gi,-bi,bi,gi];Bn._matMult(ji),$r._matMult(ji),Tn._matMult(ji),zn._matMult(ji)}const pi=it.stretch+it.fixed,xi=mt.stretch+mt.fixed;return{tl:Bn,tr:$r,bl:Tn,br:zn,tex:{x:_.paddedRect.x+cm+pi,y:_.paddedRect.y+cm+xi,w:yt.stretch+yt.fixed-pi,h:bt.stretch+bt.fixed-xi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ci,pixelOffsetBR:$n,minFontScaleX:et/E/A,minFontScaleY:ft/E/N,isSDF:c}};if(d&&(_.stretchX||_.stretchY)){const it=AM(G,se,J),mt=AM($,me,te);for(let yt=0;yt<it.length-1;yt++){const bt=it[yt],Lt=it[yt+1];for(let ut=0;ut<mt.length-1;ut++)m.push(St(bt,mt[ut],Lt,mt[ut+1]))}}else m.push(St({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:I+1},{fixed:0,stretch:P+1}));return m}function wx(u,s,c){let d=0;for(const m of u)d+=Math.max(s,Math.min(c,m[1]))-Math.max(s,Math.min(c,m[0]));return d}function AM(u,s,c){const d=[{fixed:-cm,stretch:0}];for(const[m,_]of u){const E=d[d.length-1];d.push({fixed:m-E.stretch,stretch:E.stretch}),d.push({fixed:m-E.stretch,stretch:E.stretch+(_-m)})}return d.push({fixed:s+cm,stretch:c}),d}function Ex(u,s,c,d){return u/s*c+d}function Sx(u,s,c,d){return u-s*c/d}function _U(u,s,c,d){const m=s+u.positionedLines[d].lineOffset;return d===0?c+m/2:c+(m+(s+u.positionedLines[d-1].lineOffset))/2}class xU{constructor(s=[],c=bU){if(this.data=s,this.length=this.data.length,this.compare=c,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const s=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:c,compare:d}=this,m=c[s];for(;s>0;){const _=s-1>>1,E=c[_];if(d(m,E)>=0)break;c[s]=E,s=_}c[s]=m}_down(s){const{data:c,compare:d}=this,m=this.length>>1,_=c[s];for(;s<m;){let E=1+(s<<1),I=c[E];const P=E+1;if(P<this.length&&d(c[P],I)<0&&(E=P,I=c[P]),d(I,_)>=0)break;c[s]=I,s=E}c[s]=_}}function bU(u,s){return u<s?-1:u>s?1:0}function wU(u,s=1,c=!1){let d=1/0,m=1/0,_=-1/0,E=-1/0;const I=u[0];for(let W=0;W<I.length;W++){const J=I[W];(!W||J.x<d)&&(d=J.x),(!W||J.y<m)&&(m=J.y),(!W||J.x>_)&&(_=J.x),(!W||J.y>E)&&(E=J.y)}const P=Math.min(_-d,E-m);let A=P/2;const N=new xU([],EU);if(P===0)return new U(d,m);for(let W=d;W<_;W+=P)for(let J=m;J<E;J+=P)N.push(new hm(W+A,J+A,A,u));let G=function(W){let J=0,te=0,se=0;const me=W[0];for(let Ie=0,ye=me.length,Se=ye-1;Ie<ye;Se=Ie++){const Me=me[Ie],Ae=me[Se],et=Me.x*Ae.y-Ae.x*Me.y;te+=(Me.x+Ae.x)*et,se+=(Me.y+Ae.y)*et,J+=3*et}return new hm(te/J,se/J,0,W)}(u),$=N.length;for(;N.length;){const W=N.pop();(W.d>G.d||!G.d)&&(G=W,c&&console.log("found best %d after %d probes",Math.round(1e4*W.d)/1e4,$)),W.max-G.d<=s||(A=W.h/2,N.push(new hm(W.p.x-A,W.p.y-A,A,u)),N.push(new hm(W.p.x+A,W.p.y-A,A,u)),N.push(new hm(W.p.x-A,W.p.y+A,A,u)),N.push(new hm(W.p.x+A,W.p.y+A,A,u)),$+=4)}return c&&(console.log(`num probes: ${$}`),console.log(`best distance: ${G.d}`)),G.p}function EU(u,s){return s.max-u.max}class hm{constructor(s,c,d,m){this.p=new U(s,c),this.h=d,this.d=function(_,E){let I=!1,P=1/0;for(let A=0;A<E.length;A++){const N=E[A];for(let G=0,$=N.length,W=$-1;G<$;W=G++){const J=N[G],te=N[W];J.y>_.y!=te.y>_.y&&_.x<(te.x-J.x)*(_.y-J.y)/(te.y-J.y)+J.x&&(I=!I),P=Math.min(P,SA(_,J,te))}}return(I?1:-1)*Math.sqrt(P)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}}const fm=7,SS=Number.POSITIVE_INFINITY,SU=Math.sqrt(2);function MM(u,[s,c]){let d=0,m=0;if(c===SS){s<0&&(s=0);const _=s/SU;switch(u){case"top-right":case"top-left":m=_-fm;break;case"bottom-right":case"bottom-left":m=-_+fm;break;case"bottom":m=-s+fm;break;case"top":m=s-fm}switch(u){case"top-right":case"bottom-right":d=-_;break;case"top-left":case"bottom-left":d=_;break;case"left":d=s;break;case"right":d=-s}}else{switch(s=Math.abs(s),c=Math.abs(c),u){case"top-right":case"top-left":case"top":m=c-fm;break;case"bottom-right":case"bottom-left":case"bottom":m=-c+fm}switch(u){case"top-right":case"bottom-right":case"right":d=-s;break;case"top-left":case"bottom-left":case"left":d=s}}return[d,m]}function TU(u,s,c,d,m,_,E,I,P,A){u.createArrays(),u.tilePixelRatio=bn/(512*u.overscaling),u.compareText={},u.iconsNeedLinear=!1;const N=u.layers[0].layout,G=u.layers[0]._unevaluatedLayout._values,$={};if(u.textSizeData.kind==="composite"){const{minZoom:te,maxZoom:se}=u.textSizeData;$.compositeTextSizes=[G["text-size"].possiblyEvaluate(new F(te),I),G["text-size"].possiblyEvaluate(new F(se),I)]}if(u.iconSizeData.kind==="composite"){const{minZoom:te,maxZoom:se}=u.iconSizeData;$.compositeIconSizes=[G["icon-size"].possiblyEvaluate(new F(te),I),G["icon-size"].possiblyEvaluate(new F(se),I)]}$.layoutTextSize=G["text-size"].possiblyEvaluate(new F(P+1),I),$.layoutIconSize=G["icon-size"].possiblyEvaluate(new F(P+1),I),$.textMaxSize=G["text-size"].possiblyEvaluate(new F(18),I);const W=N.get("text-rotation-alignment")==="map"&&N.get("symbol-placement")!=="point",J=N.get("text-size");for(const te of u.features){const se=N.get("text-font").evaluate(te,{},I).join(","),me=J.evaluate(te,{},I),Ie=$.layoutTextSize.evaluate(te,{},I),ye=($.layoutIconSize.evaluate(te,{},I),{horizontal:{},vertical:void 0}),Se=te.text;let Me,Ae=[0,0];if(Se){const ft=Se.toString(),St=N.get("text-letter-spacing").evaluate(te,{},I)*ga,it=N.get("text-line-height").evaluate(te,{},I)*ga,mt=DE(ft)?St:0,yt=N.get("text-anchor").evaluate(te,{},I),bt=N.get("text-variable-anchor");if(!bt){const qt=N.get("text-radial-offset").evaluate(te,{},I);Ae=qt?MM(yt,[qt*ga,SS]):N.get("text-offset").evaluate(te,{},I).map(Fn=>Fn*ga)}let Lt=W?"center":N.get("text-justify").evaluate(te,{},I);const ut=N.get("symbol-placement")==="point",$t=ut?N.get("text-max-width").evaluate(te,{},I)*ga:1/0,sn=qt=>{u.allowVerticalPlacement&&kv(ft)&&(ye.vertical=bS(Se,s,c,m,se,$t,it,yt,qt,mt,Ae,xl.vertical,!0,Ie,me))};if(!W&&bt){const qt=Lt==="auto"?bt.map(Ot=>TS(Ot)):[Lt];let Fn=!1;for(let Ot=0;Ot<qt.length;Ot++){const vn=qt[Ot];if(!ye.horizontal[vn])if(Fn)ye.horizontal[vn]=ye.horizontal[0];else{const Bn=bS(Se,s,c,m,se,$t,it,"center",vn,mt,Ae,xl.horizontal,!1,Ie,me);Bn&&(ye.horizontal[vn]=Bn,Fn=Bn.positionedLines.length===1)}}sn("left")}else{if(Lt==="auto"&&(Lt=TS(yt)),ut||N.get("text-writing-mode").indexOf("horizontal")>=0||!kv(ft)){const qt=bS(Se,s,c,m,se,$t,it,yt,Lt,mt,Ae,xl.horizontal,!1,Ie,me);qt&&(ye.horizontal[Lt]=qt)}sn(ut?"left":Lt)}}let et=!1;if(te.icon&&te.icon.name){const ft=d[te.icon.name];ft&&(Me=mU(m[te.icon.name],N.get("icon-offset").evaluate(te,{},I),N.get("icon-anchor").evaluate(te,{},I)),et=ft.sdf,u.sdfIcons===void 0?u.sdfIcons=ft.sdf:u.sdfIcons!==ft.sdf&&nt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ft.pixelRatio!==u.pixelRatio||N.get("icon-rotate").constantOr(1)!==0)&&(u.iconsNeedLinear=!0))}const We=OM(ye.horizontal)||ye.vertical;u.iconsInText||(u.iconsInText=!!We&&We.iconsInText),(We||Me)&&IU(u,te,ye,Me,d,$,Ie,0,Ae,et,E,I,A)}_&&u.generateCollisionDebugBuffers(P,u.collisionBoxArray)}function TS(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function IU(u,s,c,d,m,_,E,I,P,A,N,G,$){let W=_.textMaxSize.evaluate(s,{},G);W===void 0&&(W=E);const J=u.layers[0].layout,te=J.get("icon-offset").evaluate(s,{},G),se=OM(c.horizontal)||c.vertical,me=$.name==="globe",Ie=ga,ye=E/Ie,Se=u.tilePixelRatio*W/Ie,Me=(yt=u.overscaling,u.zoom>18&&yt>2&&(yt>>=1),Math.max(bn/(512*yt),1)*J.get("symbol-spacing")),Ae=J.get("text-padding")*u.tilePixelRatio,et=J.get("icon-padding")*u.tilePixelRatio,We=ae(J.get("text-max-angle")),ft=J.get("text-rotation-alignment")==="map"&&J.get("symbol-placement")!=="point",St=J.get("icon-rotation-alignment")==="map"&&J.get("symbol-placement")!=="point",it=J.get("symbol-placement"),mt=Me/2;var yt;const bt=J.get("icon-text-fit");let Lt;d&&bt!=="none"&&(u.allowVerticalPlacement&&c.vertical&&(Lt=_M(d,c.vertical,bt,J.get("icon-text-fit-padding"),te,ye)),se&&(d=_M(d,se,bt,J.get("icon-text-fit-padding"),te,ye)));const ut=($t,sn,qt)=>{if(sn.x<0||sn.x>=bn||sn.y<0||sn.y>=bn)return;let Fn=null;if(me){const{x:Ot,y:vn,z:Bn}=$.projectTilePoint(sn.x,sn.y,qt);Fn={anchor:new Ah(Ot,vn,Bn,0,void 0),up:$.upVector(qt,sn.x,sn.y)}}(function(Ot,vn,Bn,$r,zn,Tn,Ci,$n,jn,pi,xi,bi,gi,ji,to,So,mi,Fo,To,Wi,Zr,Io,wi,cs,Co){const ma=Ot.addToLineVertexArray(vn,$r);let Qo,hs,ea,rc,gm,__,x_,hL=0,fL=0,dL=0,pL=0,US=-1,VS=-1;const Bc={};let gL=NE("");const hp=Bn?Bn.anchor:vn;let GS=0,$S=0;if(jn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[GS,$S]=jn.layout.get("text-offset").evaluate(Zr,{},Co).map(Hs=>Hs*ga):(GS=jn.layout.get("text-radial-offset").evaluate(Zr,{},Co)*ga,$S=SS),Ot.allowVerticalPlacement&&zn.vertical){const Hs=zn.vertical;if(to)__=IS(Hs),$n&&(x_=IS($n));else{const Ys=jn.layout.get("text-rotate").evaluate(Zr,{},Co)+90;ea=Tx(pi,hp,vn,xi,bi,gi,Hs,ji,Ys,So),$n&&(rc=Tx(pi,hp,vn,xi,bi,gi,$n,Fo,Ys))}}if(Tn){const Hs=jn.layout.get("icon-rotate").evaluate(Zr,{},Co),Ys=jn.layout.get("icon-text-fit")!=="none",b_=PM(Tn,Hs,wi,Ys),qS=$n?PM($n,Hs,wi,Ys):void 0;hs=Tx(pi,hp,vn,xi,bi,gi,Tn,Fo,Hs),hL=4*b_.length;const mL=Ot.iconSizeData;let fp=null;mL.kind==="source"?(fp=[ec*jn.layout.get("icon-size").evaluate(Zr,{},Co)],fp[0]>Nf&&nt(`${Ot.layerIds[0]}: Value for "icon-size" is >= ${h_}. Reduce your "icon-size".`)):mL.kind==="composite"&&(fp=[ec*Io.compositeIconSizes[0].evaluate(Zr,{},Co),ec*Io.compositeIconSizes[1].evaluate(Zr,{},Co)],(fp[0]>Nf||fp[1]>Nf)&&nt(`${Ot.layerIds[0]}: Value for "icon-size" is >= ${h_}. Reduce your "icon-size".`)),Ot.addSymbols(Ot.icon,b_,fp,Wi,To,Zr,!1,Bn,vn,ma.lineStartIndex,ma.lineLength,-1,cs,Co),US=Ot.icon.placedSymbolArray.length-1,qS&&(fL=4*qS.length,Ot.addSymbols(Ot.icon,qS,fp,Wi,To,Zr,xl.vertical,Bn,vn,ma.lineStartIndex,ma.lineLength,-1,cs,Co),VS=Ot.icon.placedSymbolArray.length-1)}for(const Hs in zn.horizontal){const Ys=zn.horizontal[Hs];Qo||(gL=NE(Ys.text),to?gm=IS(Ys):Qo=Tx(pi,hp,vn,xi,bi,gi,Ys,ji,jn.layout.get("text-rotate").evaluate(Zr,{},Co),So));const b_=Ys.positionedLines.length===1;if(dL+=LM(Ot,Bn,vn,Ys,Ci,jn,to,Zr,So,ma,zn.vertical?xl.horizontal:xl.horizontalOnly,b_?Object.keys(zn.horizontal):[Hs],Bc,US,Io,cs,Co),b_)break}zn.vertical&&(pL+=LM(Ot,Bn,vn,zn.vertical,Ci,jn,to,Zr,So,ma,xl.vertical,["vertical"],Bc,VS,Io,cs,Co));let Gf=-1;const jS=(Hs,Ys)=>Hs?Math.max(Hs,Ys):Ys;Gf=jS(gm,Gf),Gf=jS(__,Gf),Gf=jS(x_,Gf);const e8=Gf>-1?1:0;Ot.glyphOffsetArray.length>=Bf.MAX_GLYPHS&&nt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Zr.sortKey!==void 0&&Ot.addToSortKeyRanges(Ot.symbolInstances.length,Zr.sortKey),Ot.symbolInstances.emplaceBack(hp.x,hp.y,hp.z,vn.x,vn.y,Bc.right>=0?Bc.right:-1,Bc.center>=0?Bc.center:-1,Bc.left>=0?Bc.left:-1,Bc.vertical>=0?Bc.vertical:-1,US,VS,gL,Qo!==void 0?Qo:Ot.collisionBoxArray.length,Qo!==void 0?Qo+1:Ot.collisionBoxArray.length,ea!==void 0?ea:Ot.collisionBoxArray.length,ea!==void 0?ea+1:Ot.collisionBoxArray.length,hs!==void 0?hs:Ot.collisionBoxArray.length,hs!==void 0?hs+1:Ot.collisionBoxArray.length,rc||Ot.collisionBoxArray.length,rc?rc+1:Ot.collisionBoxArray.length,xi,dL,pL,hL,fL,e8,0,GS,$S,Gf)})(u,sn,Fn,$t,c,d,m,Lt,u.layers[0],u.collisionBoxArray,s.index,s.sourceLayerIndex,u.index,Ae,ft,P,0,et,St,te,s,_,A,N,G)};if(it==="line")for(const $t of TM(s.geometry,0,0,bn,bn)){const sn=vU($t,Me,We,c.vertical||se,d,Ie,Se,u.overscaling,bn);for(const qt of sn)se&&CU(u,se.text,mt,qt)||ut($t,qt,G)}else if(it==="line-center"){for(const $t of s.geometry)if($t.length>1){const sn=yU($t,We,c.vertical||se,d,Ie,Se);sn&&ut($t,sn,G)}}else if(s.type==="Polygon")for(const $t of fS(s.geometry,0)){const sn=wU($t,16);ut($t[0],new Ah(sn.x,sn.y,0,0,void 0),G)}else if(s.type==="LineString")for(const $t of s.geometry)ut($t,new Ah($t[0].x,$t[0].y,0,0,void 0),G);else if(s.type==="Point")for(const $t of s.geometry)for(const sn of $t)ut([sn],new Ah(sn.x,sn.y,0,0,void 0),G)}const h_=255,Nf=h_*ec;function LM(u,s,c,d,m,_,E,I,P,A,N,G,$,W,J,te,se){const me=function(Se,Me,Ae,et,We,ft,St,it){const mt=[];if(Me.positionedLines.length===0)return mt;const yt=et.layout.get("text-rotate").evaluate(ft,{})*Math.PI/180,bt=function(qt){const Fn=qt[0],Ot=qt[1],vn=Fn*Ot;return vn>0?[Fn,-Ot]:vn<0?[-Fn,Ot]:Fn===0?[Ot,Fn]:[Ot,-Fn]}(Ae);let Lt=Math.abs(Me.top-Me.bottom);for(const qt of Me.positionedLines)Lt-=qt.lineOffset;const ut=Me.positionedLines.length,$t=Lt/ut;let sn=Me.top-Ae[1];for(let qt=0;qt<ut;++qt){const Fn=Me.positionedLines[qt];sn=_U(Me,$t,sn,qt);for(const Ot of Fn.positionedGlyphs){if(!Ot.rect)continue;const vn=Ot.rect||{};let Bn=hM+1,$r=!0,zn=1,Tn=0;if(Ot.imageName){const wi=St[Ot.imageName];if(!wi)continue;if(wi.sdf){nt("SDF images are not supported in formatted text and will be ignored.");continue}$r=!1,zn=wi.pixelRatio,Bn=Ps/zn}const Ci=(We||it)&&Ot.vertical,$n=Ot.metrics.advance*Ot.scale/2,jn=Ot.metrics,pi=Ot.rect;if(pi===null)continue;it&&Me.verticalizable&&(Tn=Ot.imageName?$n-Ot.metrics.width*Ot.scale/2:0);const xi=We?[Ot.x+$n,Ot.y]:[0,0];let bi=[0,0],gi=[0,0],ji=!1;We||(Ci?(gi=[Ot.x+$n+bt[0],Ot.y+bt[1]-Tn],ji=!0):bi=[Ot.x+$n+Ae[0],Ot.y+Ae[1]-Tn]);const to=pi.w*Ot.scale/(zn*(Ot.localGlyph?tc:1)),So=pi.h*Ot.scale/(zn*(Ot.localGlyph?tc:1));let mi,Fo,To,Wi;if(Ci){const wi=Ot.y-sn,cs=new U(-$n,$n-wi),Co=-Math.PI/2,ma=new U(...gi);mi=new U(-$n+bi[0],bi[1]),mi._rotateAround(Co,cs)._add(ma),mi.x+=-wi+$n,mi.y-=(jn.left-Bn)*Ot.scale;const Qo=Ot.imageName?jn.advance*Ot.scale:ga*Ot.scale,hs=String.fromCharCode(Ot.glyph);eU(hs)?mi.x+=(1-Bn)*Ot.scale:tU(hs)?mi.x+=Qo-jn.height*Ot.scale+(-Bn-1)*Ot.scale:mi.x+=Ot.imageName||jn.width+2*Bn===pi.w&&jn.height+2*Bn===pi.h?(Qo-So)/2:(Qo-(jn.height+2*Bn)*Ot.scale)/2,Fo=new U(mi.x,mi.y-to),To=new U(mi.x+So,mi.y),Wi=new U(mi.x+So,mi.y-to)}else{const wi=(jn.left-Bn)*Ot.scale-$n+bi[0],cs=(-jn.top-Bn)*Ot.scale+bi[1],Co=wi+to,ma=cs+So;mi=new U(wi,cs),Fo=new U(Co,cs),To=new U(wi,ma),Wi=new U(Co,ma)}if(yt){let wi;wi=We?new U(0,0):ji?new U(bt[0],bt[1]):new U(Ae[0],Ae[1]),mi._rotateAround(yt,wi),Fo._rotateAround(yt,wi),To._rotateAround(yt,wi),Wi._rotateAround(yt,wi)}const Zr=new U(0,0),Io=new U(0,0);mt.push({tl:mi,tr:Fo,bl:To,br:Wi,tex:vn,writingMode:Me.writingMode,glyphOffset:xi,sectionIndex:Ot.sectionIndex,isSDF:$r,pixelOffsetTL:Zr,pixelOffsetBR:Io,minFontScaleX:0,minFontScaleY:0})}}return mt}(0,d,P,_,E,I,m,u.allowVerticalPlacement),Ie=u.textSizeData;let ye=null;Ie.kind==="source"?(ye=[ec*_.layout.get("text-size").evaluate(I,{},se)],ye[0]>Nf&&nt(`${u.layerIds[0]}: Value for "text-size" is >= ${h_}. Reduce your "text-size".`)):Ie.kind==="composite"&&(ye=[ec*J.compositeTextSizes[0].evaluate(I,{},se),ec*J.compositeTextSizes[1].evaluate(I,{},se)],(ye[0]>Nf||ye[1]>Nf)&&nt(`${u.layerIds[0]}: Value for "text-size" is >= ${h_}. Reduce your "text-size".`)),u.addSymbols(u.text,me,ye,P,E,I,N,s,c,A.lineStartIndex,A.lineLength,W,te,se);for(const Se of G)$[Se]=u.text.placedSymbolArray.length-1;return 4*me.length}function OM(u){for(const s in u)return u[s];return null}function Tx(u,s,c,d,m,_,E,I,P,A){let N=E.top,G=E.bottom,$=E.left,W=E.right;const J=E.collisionPadding;if(J&&($-=J[0],N-=J[1],W+=J[2],G+=J[3]),P){const te=new U($,N),se=new U(W,N),me=new U($,G),Ie=new U(W,G),ye=ae(P);let Se=new U(0,0);A&&(Se=new U(A[0],A[1])),te._rotateAround(ye,Se),se._rotateAround(ye,Se),me._rotateAround(ye,Se),Ie._rotateAround(ye,Se),$=Math.min(te.x,se.x,me.x,Ie.x),W=Math.max(te.x,se.x,me.x,Ie.x),N=Math.min(te.y,se.y,me.y,Ie.y),G=Math.max(te.y,se.y,me.y,Ie.y)}return u.emplaceBack(s.x,s.y,s.z,c.x,c.y,$,N,W,G,I,d,m,_),u.length-1}function IS(u){u.collisionPadding&&(u.top-=u.collisionPadding[1],u.bottom+=u.collisionPadding[3]);const s=u.bottom-u.top;return s>0?Math.max(10,s):null}function CU(u,s,c,d){const m=u.compareText;if(s in m){const _=m[s];for(let E=_.length-1;E>=0;E--)if(d.dist(_[E])<c)return!0}else m[s]=[];return m[s].push(d),!1}function DM(u,s){const c=u.fovAboveCenter,d=u.elevation?u.elevation.getMinElevationBelowMSL()*s:0,m=(u._camera.position[2]*u.worldSize-d)/Math.cos(u._pitch),_=Math.sin(c)*m/Math.sin(Math.max(Math.PI/2-u._pitch-c,.01)),E=Math.sin(u._pitch)*_+m;return Math.min(1.01*E,m*(1/u._horizonShift))}function up(u,s){if(!s.isReprojectedInTileSpace)return{scale:1<<u.z,x:u.x,y:u.y,x2:u.x+1,y2:u.y+1,projection:s};const c=Math.pow(2,-u.z),d=u.x*c,m=(u.x+1)*c,_=u.y*c,E=(u.y+1)*c,I=_l(d),P=_l(m),A=Aa(_),N=Aa(E),G=s.project(I,A),$=s.project(P,A),W=s.project(P,N),J=s.project(I,N);let te=Math.min(G.x,$.x,W.x,J.x),se=Math.min(G.y,$.y,W.y,J.y),me=Math.max(G.x,$.x,W.x,J.x),Ie=Math.max(G.y,$.y,W.y,J.y);const ye=c/16;function Se(Ae,et,We,ft,St,it){const mt=(We+St)/2,yt=(ft+it)/2,bt=s.project(_l(mt),Aa(yt)),Lt=Math.max(0,te-bt.x,se-bt.y,bt.x-me,bt.y-Ie);te=Math.min(te,bt.x),me=Math.max(me,bt.x),se=Math.min(se,bt.y),Ie=Math.max(Ie,bt.y),Lt>ye&&(Se(Ae,bt,We,ft,mt,yt),Se(bt,et,mt,yt,St,it))}Se(G,$,d,_,m,_),Se($,W,m,_,m,E),Se(W,J,m,E,d,E),Se(J,G,d,E,d,_),te-=ye,se-=ye,me+=ye,Ie+=ye;const Me=1/Math.max(me-te,Ie-se);return{scale:Me,x:te*Me,y:se*Me,x2:me*Me,y2:Ie*Me,projection:s}}const PU=Ku(new Float32Array(16));class Ff{constructor(s){this.spec=s,this.name=s.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(s,c){return{x:0,y:0,z:0}}unproject(s,c){return new di(0,0)}projectTilePoint(s,c,d){return{x:s,y:c,z:0}}locationPoint(s,c,d=!0){return s._coordinatePoint(s.locationCoordinate(c),d)}pixelsPerMeter(s,c){return Qu(1,s)*c}pixelSpaceConversion(s,c,d){return 1}farthestPixelDistance(s){return DM(s,s.pixelsPerMeter)}pointCoordinate(s,c,d,m){const _=s.horizonLineFromTop(!1),E=new U(c,Math.max(_,d));return s.rayIntersectionCoordinate(s.pointRayIntersection(E,m))}pointCoordinate3D(s,c,d){const m=new U(c,d);if(s.elevation)return s.elevation.pointCoordinate(m);{const _=this.pointCoordinate(s,m.x,m.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(s,c){if(s.elevation)return!this.pointCoordinate3D(s,c.x,c.y);const d=s.horizonLineFromTop();return c.y<d}createInversionMatrix(s,c){return PU}createTileMatrix(s,c,d){let m,_,E;const I=d.canonical,P=Ku(new Float64Array(16));if(this.isReprojectedInTileSpace){const A=up(I,this);m=1,_=A.x+d.wrap*A.scale,E=A.y,np(P,P,[m/A.scale,m/A.scale,s.pixelsPerMeter/c])}else m=c/s.zoomScale(I.z),_=(I.x+Math.pow(2,I.z)*d.wrap)*m,E=I.y*m;return Gv(P,P,[_,E,0]),np(P,P,[m/bn,m/bn,1]),P}upVector(s,c,d){return[0,0,1]}upVectorScale(s,c,d){return{metersToTile:1}}}class AU extends Ff{constructor(s){super(s),this.range=[4,7],this.center=s.center||[-96,37.5];const[c,d]=this.parallels=s.parallels||[29.5,45.5],m=Math.sin(ae(c));this.n=(m+Math.sin(ae(d)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(s,c){const{n:d,c:m,r0:_}=this,E=ae(s-this.center[0]),I=ae(c),P=Math.sqrt(m-2*d*Math.sin(I))/d;return{x:P*Math.sin(E*d),y:P*Math.cos(E*d)-_,z:0}}unproject(s,c){const{n:d,c:m,r0:_}=this,E=_+c;let I=Math.atan2(s,Math.abs(E))*Math.sign(E);E*d<0&&(I-=Math.PI*Math.sign(s)*Math.sign(E));const P=ae(this.center[0])*d;I=Be(I,-Math.PI-P,Math.PI-P);const A=Pe(ve(I/d)+this.center[0],-180,180),N=Math.asin(Pe((m-(s*s+E*E)*d*d)/(2*d),-1,1)),G=Pe(ve(N),-Ma,Ma);return new di(A,G)}}const f_=1.340264,d_=-.081106,p_=893e-6,g_=.003796,Ix=Math.sqrt(3)/2;class MU extends Ff{project(s,c){c=c/180*Math.PI,s=s/180*Math.PI;const d=Math.asin(Ix*Math.sin(c)),m=d*d,_=m*m*m;return{x:.5*(s*Math.cos(d)/(Ix*(f_+3*d_*m+_*(7*p_+9*g_*m)))/Math.PI+.5),y:1-.5*(d*(f_+d_*m+_*(p_+g_*m))/Math.PI+1),z:0}}unproject(s,c){s=(2*s-.5)*Math.PI;let d=c=(2*(1-c)-1)*Math.PI,m=d*d,_=m*m*m;for(let N,G,$,W=0;W<12&&(G=d*(f_+d_*m+_*(p_+g_*m))-c,$=f_+3*d_*m+_*(7*p_+9*g_*m),N=G/$,d=Pe(d-N,-Math.PI/3,Math.PI/3),m=d*d,_=m*m*m,!(Math.abs(N)<1e-12));++W);const E=Ix*s*(f_+3*d_*m+_*(7*p_+9*g_*m))/Math.cos(d),I=Math.asin(Math.sin(d)/Ix),P=Pe(180*E/Math.PI,-180,180),A=Pe(180*I/Math.PI,-Ma,Ma);return new di(P,A)}}class LU extends Ff{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0}project(s,c){return{x:.5+s/360,y:.5-c/360,z:0}}unproject(s,c){const d=360*(s-.5),m=Pe(360*(.5-c),-Ma,Ma);return new di(d,m)}}const dm=Math.PI/2;function Cx(u){return Math.tan((dm+u)/2)}class OU extends Ff{constructor(s){super(s),this.center=s.center||[0,30];const[c,d]=this.parallels=s.parallels||[30,30];let m=ae(c),_=ae(d);this.southernCenter=m+_<0,this.southernCenter&&(m=-m,_=-_);const E=Math.cos(m),I=Cx(m);this.n=m===_?Math.sin(m):Math.log(E/Math.cos(_))/Math.log(Cx(_)/I),this.f=E*Math.pow(Cx(m),this.n)/this.n}project(s,c){c=ae(c),this.southernCenter&&(c=-c),s=ae(s-this.center[0]);const d=1e-6,{n:m,f:_}=this;_>0?c<-dm+d&&(c=-dm+d):c>dm-d&&(c=dm-d);const E=_/Math.pow(Cx(c),m);let I=E*Math.sin(m*s),P=_-E*Math.cos(m*s);return I=.5*(I/Math.PI+.5),P=.5*(P/Math.PI+.5),{x:I,y:this.southernCenter?P:1-P,z:0}}unproject(s,c){s=(2*s-.5)*Math.PI,this.southernCenter&&(c=1-c),c=(2*(1-c)-.5)*Math.PI;const{n:d,f:m}=this,_=m-c,E=Math.sign(_),I=Math.sign(d)*Math.sqrt(s*s+_*_);let P=Math.atan2(s,Math.abs(_))*E;_*d<0&&(P-=Math.PI*Math.sign(s)*E);const A=Pe(ve(P/d)+this.center[0],-180,180),N=Pe(ve(2*Math.atan(Math.pow(m/I,1/d))-dm),-Ma,Ma);return new di(A,this.southernCenter?-N:N)}}class RM extends Ff{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(s,c){return{x:Dc(s),y:Rc(c),z:0}}unproject(s,c){const d=_l(s),m=Aa(c);return new di(d,m)}}const kM=ae(Ma);class DU extends Ff{project(s,c){const d=(c=ae(c))*c,m=d*d;return{x:.5*((s=ae(s))*(.8707-.131979*d+m*(m*(.003971*d-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+d*(.015085+m*(.028874*d-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(s,c){s=(2*s-.5)*Math.PI;let d=c=(2*(1-c)-1)*Math.PI,m=25,_=0,E=d*d;do{E=d*d;const A=E*E;_=(d*(1.007226+E*(.015085+A*(.028874*E-.044475-.005916*A)))-c)/(1.007226+E*(.045255+A*(.259866*E-.311325-.005916*11*A))),d=Pe(d-_,-kM,kM)}while(Math.abs(_)>1e-6&&--m>0);E=d*d;const I=Pe(ve(s/(.8707+E*(E*(E*E*E*(.003971-.001529*E)-.013791)-.131979))),-180,180),P=ve(d);return new di(I,P)}}const NM=ae(Ma);class RU extends Ff{project(s,c){c=ae(c),s=ae(s);const d=Math.cos(c),m=2/Math.PI,_=Math.acos(d*Math.cos(s/2)),E=Math.sin(_)/_,I=.5*(s*m+2*d*Math.sin(s/2)/E)||0,P=.5*(c+Math.sin(c)/E)||0;return{x:.5*(I/Math.PI+.5),y:1-.5*(P/Math.PI+1),z:0}}unproject(s,c){let d=s=(2*s-.5)*Math.PI,m=c=(2*(1-c)-1)*Math.PI,_=25;const E=1e-6;let I=0,P=0;do{const A=Math.cos(m),N=Math.sin(m),G=2*N*A,$=N*N,W=A*A,J=Math.cos(d/2),te=Math.sin(d/2),se=2*J*te,me=te*te,Ie=1-W*J*J,ye=Ie?1/Ie:0,Se=Ie?Math.acos(A*J)*Math.sqrt(1/Ie):0,Me=.5*(2*Se*A*te+2*d/Math.PI)-s,Ae=.5*(Se*N+m)-c,et=.5*ye*(W*me+Se*A*J*$)+1/Math.PI,We=ye*(se*G/4-Se*N*te),ft=.125*ye*(G*te-Se*N*W*se),St=.5*ye*($*J+Se*me*A)+.5,it=We*ft-St*et;I=(Ae*We-Me*St)/it,P=(Me*ft-Ae*et)/it,d=Pe(d-I,-Math.PI,Math.PI),m=Pe(m-P,-NM,NM)}while((Math.abs(I)>E||Math.abs(P)>E)&&--_>0);return new di(ve(d),ve(m))}}class FM extends Ff{constructor(s){super(s),this.center=s.center||[0,0],this.parallels=s.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ae(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(s,c){const{scale:d,cosPhi:m}=this;return{x:ae(s)*m*d+.5,y:-Math.sin(ae(c))/m*d+.5,z:0}}unproject(s,c){const{scale:d,cosPhi:m}=this,_=-(c-.5)/d,E=Pe(ve((s-.5)/d)/m,-180,180),I=Math.asin(Pe(_*m,-1,1)),P=Pe(ve(I),-Ma,Ma);return new di(E,P)}}class kU extends RM{constructor(s){super(s),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(s,c,d){const m=Yv(s,c,d);return co(m,m,Kv(Oc(d))),{x:m[0],y:m[1],z:m[2]}}locationPoint(s,c){const d=Jg(c.lat,c.lng),m=ss([],d),_=s.elevation?s.elevation.getAtPointOrZero(s.locationCoordinate(c),s._centerAltitude):s._centerAltitude;Zv(d,d,m,Qu(1,0)*bn*_);const E=Ku(new Float64Array(16));return tp(E,s.pixelMatrix,s.globeMatrix),co(d,d,E),new U(d[0],d[1])}pixelsPerMeter(s,c){return Qu(1,0)*c}pixelSpaceConversion(s,c,d){const m=Qu(1,s)*c,_=mr(Qu(1,45)*c,m,d);return this.pixelsPerMeter(s,c)/_}createTileMatrix(s,c,d){const m=YE(Oc(d.canonical));return tp(new Float64Array(16),s.globeMatrix,m)}createInversionMatrix(s,c){const{center:d}=s,m=Kv(Oc(c));return tx(m,m,ae(d.lng)),UE(m,m,ae(d.lat)),np(m,m,[s._pixelsPerMercatorPixel,s._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(s,c,d,m){return cA(s,c,d,!0)||new em(0,0)}pointCoordinate3D(s,c,d){const m=this.pointCoordinate(s,c,d,0);return[m.x,m.y,m.z]}isPointAboveHorizon(s,c){return!cA(s,c.x,c.y,!1)}farthestPixelDistance(s){const c=function(m,_){const E=m.cameraToCenterDistance,I=m._centerAltitude*_,P=m._camera,A=m._camera.forward(),N=Th([],vl([],A,-E),[0,0,I]),G=m.worldSize/(2*Math.PI),$=[0,0,-G],W=m.width/m.height,J=Math.tan(m.fovAboveCenter),te=vl([],P.up(),J),se=vl([],P.right(),J*W),me=ss([],Th([],Th([],A,te),se)),Ie=[];let ye;if(new jE(N,me).closestPointOnSphere($,G,Ie)){const Se=Th([],Ie,$),Me=Ju([],Se,N);ye=Math.cos(m.fovAboveCenter)*$v(Me)}else{const Se=Ju([],N,$),Me=Ju([],$,N);ss(Me,Me);const Ae=$v(Se)-G;ye=Math.sqrt(Ae*(Ae+2*G));const et=Math.acos(ye/(G+Ae))-Math.acos(Hl(A,Me));ye*=Math.cos(et)}return 1.01*ye}(s,this.pixelsPerMeter(s.center.lat,s.worldSize)),d=Qg(s.zoom);if(d>0){const m=DM(s,Qu(1,s.center.lat)*s.worldSize),_=s.worldSize/(2*Math.PI),E=Math.max(s.width,s.height)/s.worldSize*Math.PI;return mr(c,m+_*(1-Math.cos(E)),Math.pow(d,10))}return c}upVector(s,c,d){return Yv(c,d,s,1)}upVectorScale(s){return{metersToTile:nx(ix(Oc(s)))}}}function BM(u){const s=u.parallels,c=!!s&&Math.abs(s[0]+s[1])<.01;switch(u.name){case"mercator":return new RM(u);case"equirectangular":return new LU(u);case"naturalEarth":return new DU(u);case"equalEarth":return new MU(u);case"winkelTripel":return new RU(u);case"albers":return c?new FM(u):new AU(u);case"lambertConformalConic":return c?new FM(u):new OU(u);case"globe":return new kU(u)}throw new Error(`Invalid projection name: ${u.name}`)}const NU=px.types,FU=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Px(u,s,c,d,m,_,E,I,P,A,N,G,$){const W=I?Math.min(Nf,Math.round(I[0])):0,J=I?Math.min(Nf,Math.round(I[1])):0;u.emplaceBack(s,c,Math.round(32*d),Math.round(32*m),_,E,(W<<1)+(P?1:0),J,16*A,16*N,256*G,256*$)}function Ax(u,s,c,d,m,_,E){u.emplaceBack(s,c,d,m,_,E)}function Mx(u,s,c,d,m){u.emplaceBack(s,c,d,m),u.emplaceBack(s,c,d,m),u.emplaceBack(s,c,d,m),u.emplaceBack(s,c,d,m)}function BU(u){for(const s of u.sections)if(kE(s.text))return!0;return!1}class CS{constructor(s){this.layoutVertexArray=new _t,this.indexArray=new gn,this.programConfigurations=s,this.segments=new wo,this.dynamicLayoutVertexArray=new wt,this.opacityVertexArray=new yn,this.placedSymbolArray=new bo,this.globeExtVertexArray=new Pt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(s,c,d,m){this.isEmpty()||(d&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Z6.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,W6.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,FU,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,X6.members,!0)),this.opacityVertexBuffer.itemSize=1),(d||m)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}nn(CS,"SymbolBuffers");class PS{constructor(s,c,d){this.layoutVertexArray=new s,this.layoutAttributes=c,this.indexArray=new d,this.segments=new wo,this.collisionVertexArray=new tr,this.collisionVertexArrayExt=new Kn}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,H6.members,!0),this.collisionVertexBufferExt=s.createVertexBuffer(this.collisionVertexArrayExt,Y6.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}nn(PS,"CollisionBuffers");class Bf{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(E=>E.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ku([]),this.placementViewportMatrix=Ku([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=mS(this.zoom,c["text-size"]),this.iconSizeData=mS(this.zoom,c["icon-size"]);const d=this.layers[0].layout,m=d.get("symbol-sort-key"),_=d.get("symbol-z-order");this.canOverlap=d.get("text-allow-overlap")||d.get("icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&m.constantOr(1)!==void 0,this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=d.get("text-writing-mode").map(E=>xl[E]),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.sourceID=s.sourceID,this.projection=s.projection}createArrays(){this.text=new CS(new ep(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new CS(new ep(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new as,this.lineVertexArray=new Xg,this.symbolInstances=new Ai}calculateGlyphDependencies(s,c,d,m,_){for(let E=0;E<s.length;E++)if(c[s.charCodeAt(E)]=!0,m&&_){const I=l_[s.charAt(E)];I&&(c[I.charCodeAt(0)]=!0)}}populate(s,c,d,m){const _=this.layers[0],E=_.layout,I=this.projection.name==="globe",P=E.get("text-font"),A=E.get("text-field"),N=E.get("icon-image"),G=(A.value.kind!=="constant"||A.value.value instanceof os&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(P.value.kind!=="constant"||P.value.value.length>0),$=N.value.kind!=="constant"||!!N.value.value||Object.keys(N.parameters).length>0,W=E.get("symbol-sort-key");if(this.features=[],!G&&!$)return;const J=c.iconDependencies,te=c.glyphDependencies,se=c.availableImages,me=new F(this.zoom);for(const{feature:Ie,id:ye,index:Se,sourceLayerIndex:Me}of s){const Ae=_._featureFilter.needGeometry,et=ap(Ie,Ae);if(!_._featureFilter.filter(me,et,d))continue;if(Ae||(et.geometry=Ih(Ie,d,m)),I&&Ie.type!==1&&d.z<=5){const it=et.geometry,mt=.98078528056,yt=(bt,Lt)=>Hl(Yv(bt.x,bt.y,d,1),Yv(Lt.x,Lt.y,d,1))<mt;for(let bt=0;bt<it.length;bt++)it[bt]=Wz(it[bt],yt)}let We,ft;if(G){const it=_.getValueAndResolveTokens("text-field",et,d,se),mt=os.factory(it);BU(mt)&&(this.hasRTLText=!0),(!this.hasRTLText||C()==="unavailable"||this.hasRTLText&&R.isParsed())&&(We=Q6(mt,_,et))}if($){const it=_.getValueAndResolveTokens("icon-image",et,d,se);ft=it instanceof $s?it:$s.fromString(it)}if(!We&&!ft)continue;const St=this.sortFeaturesByKey?W.evaluate(et,{},d):void 0;if(this.features.push({id:ye,text:We,icon:ft,index:Se,sourceLayerIndex:Me,geometry:et.geometry,properties:Ie.properties,type:NU[Ie.type],sortKey:St}),ft&&(J[ft.name]=!0),We){const it=P.evaluate(et,{},d).join(","),mt=E.get("text-rotation-alignment")==="map"&&E.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(xl.vertical)>=0;for(const yt of We.sections)if(yt.image)J[yt.image.name]=!0;else{const bt=kv(We.toString()),Lt=yt.fontStack||it,ut=te[Lt]=te[Lt]||{};this.calculateGlyphDependencies(yt.text,ut,mt,this.allowVerticalPlacement,bt)}}}E.get("symbol-placement")==="line"&&(this.features=function(Ie){const ye={},Se={},Me=[];let Ae=0;function et(it){Me.push(Ie[it]),Ae++}function We(it,mt,yt){const bt=Se[it];return delete Se[it],Se[mt]=bt,Me[bt].geometry[0].pop(),Me[bt].geometry[0]=Me[bt].geometry[0].concat(yt[0]),bt}function ft(it,mt,yt){const bt=ye[mt];return delete ye[mt],ye[it]=bt,Me[bt].geometry[0].shift(),Me[bt].geometry[0]=yt[0].concat(Me[bt].geometry[0]),bt}function St(it,mt,yt){const bt=yt?mt[0][mt[0].length-1]:mt[0][0];return`${it}:${bt.x}:${bt.y}`}for(let it=0;it<Ie.length;it++){const mt=Ie[it],yt=mt.geometry,bt=mt.text?mt.text.toString():null;if(!bt){et(it);continue}const Lt=St(bt,yt),ut=St(bt,yt,!0);if(Lt in Se&&ut in ye&&Se[Lt]!==ye[ut]){const $t=ft(Lt,ut,yt),sn=We(Lt,ut,Me[$t].geometry);delete ye[Lt],delete Se[ut],Se[St(bt,Me[sn].geometry,!0)]=sn,Me[$t].geometry=null}else Lt in Se?We(Lt,ut,yt):ut in ye?ft(Lt,ut,yt):(et(it),ye[Lt]=Ae-1,Se[ut]=Ae-1)}return Me.filter(it=>it.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ie,ye)=>Ie.sortKey-ye.sortKey)}update(s,c,d,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,c,this.layers,d,m),this.icon.programConfigurations.updatePaintArrays(s,c,this.layers,d,m))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=BM(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,c){const d=this.lineVertexArray.length;if(s.segment!==void 0)for(const{x:m,y:_}of c)this.lineVertexArray.emplaceBack(m,_);return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(s,c,d,m,_,E,I,P,A,N,G,$,W,J){const te=s.indexArray,se=s.layoutVertexArray,me=s.globeExtVertexArray,Ie=s.segments.prepareSegment(4*c.length,se,te,this.canOverlap?E.sortKey:void 0),ye=this.glyphOffsetArray.length,Se=Ie.vertexLength,Me=this.allowVerticalPlacement&&I===xl.vertical?Math.PI/2:0,Ae=E.text&&E.text.sections;for(let We=0;We<c.length;We++){const{tl:ft,tr:St,bl:it,br:mt,tex:yt,pixelOffsetTL:bt,pixelOffsetBR:Lt,minFontScaleX:ut,minFontScaleY:$t,glyphOffset:sn,isSDF:qt,sectionIndex:Fn}=c[We],Ot=Ie.vertexLength,vn=sn[1];if(Px(se,A.x,A.y,ft.x,vn+ft.y,yt.x,yt.y,d,qt,bt.x,bt.y,ut,$t),Px(se,A.x,A.y,St.x,vn+St.y,yt.x+yt.w,yt.y,d,qt,Lt.x,bt.y,ut,$t),Px(se,A.x,A.y,it.x,vn+it.y,yt.x,yt.y+yt.h,d,qt,bt.x,Lt.y,ut,$t),Px(se,A.x,A.y,mt.x,vn+mt.y,yt.x+yt.w,yt.y+yt.h,d,qt,Lt.x,Lt.y,ut,$t),P){const{x:Bn,y:$r,z:zn}=P.anchor,[Tn,Ci,$n]=P.up;Ax(me,Bn,$r,zn,Tn,Ci,$n),Ax(me,Bn,$r,zn,Tn,Ci,$n),Ax(me,Bn,$r,zn,Tn,Ci,$n),Ax(me,Bn,$r,zn,Tn,Ci,$n),Mx(s.dynamicLayoutVertexArray,Bn,$r,zn,Me)}else Mx(s.dynamicLayoutVertexArray,A.x,A.y,A.z,Me);te.emplaceBack(Ot,Ot+1,Ot+2),te.emplaceBack(Ot+1,Ot+2,Ot+3),Ie.vertexLength+=4,Ie.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(sn[0]),We!==c.length-1&&Fn===c[We+1].sectionIndex||s.programConfigurations.populatePaintArrays(se.length,E,E.index,{},W,J,Ae&&Ae[Fn])}const et=P?P.anchor:A;s.placedSymbolArray.emplaceBack(et.x,et.y,et.z,A.x,A.y,ye,this.glyphOffsetArray.length-ye,Se,N,G,A.segment,d?d[0]:0,d?d[1]:0,m[0],m[1],I,0,!1,0,$,0)}_commitLayoutVertex(s,c,d,m,_,E,I){s.emplaceBack(c,d,m,_,E,Math.round(I.x),Math.round(I.y))}_addCollisionDebugVertices(s,c,d,m,_,E,I){const P=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),A=P.vertexLength,N=I.tileAnchorX,G=I.tileAnchorY;for(let W=0;W<4;W++)d.collisionVertexArray.emplaceBack(0,0,0,0);d.collisionVertexArrayExt.emplaceBack(c,-s.padding,-s.padding),d.collisionVertexArrayExt.emplaceBack(c,s.padding,-s.padding),d.collisionVertexArrayExt.emplaceBack(c,s.padding,s.padding),d.collisionVertexArrayExt.emplaceBack(c,-s.padding,s.padding),this._commitLayoutVertex(d.layoutVertexArray,m,_,E,N,G,new U(s.x1,s.y1)),this._commitLayoutVertex(d.layoutVertexArray,m,_,E,N,G,new U(s.x2,s.y1)),this._commitLayoutVertex(d.layoutVertexArray,m,_,E,N,G,new U(s.x2,s.y2)),this._commitLayoutVertex(d.layoutVertexArray,m,_,E,N,G,new U(s.x1,s.y2)),P.vertexLength+=4;const $=d.indexArray;$.emplaceBack(A,A+1),$.emplaceBack(A+1,A+2),$.emplaceBack(A+2,A+3),$.emplaceBack(A+3,A),P.primitiveLength+=4}_addTextDebugCollisionBoxes(s,c,d,m,_,E){for(let I=m;I<_;I++){const P=d.get(I),A=this.getSymbolInstanceTextSize(s,E,c,I);this._addCollisionDebugVertices(P,A,this.textCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,E)}}_addIconDebugCollisionBoxes(s,c,d,m,_,E){for(let I=m;I<_;I++){const P=d.get(I),A=this.getSymbolInstanceIconSize(s,c,E.placedIconSymbolIndex);this._addCollisionDebugVertices(P,A,this.iconCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,E)}}generateCollisionDebugBuffers(s,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new PS(an,rM.members,Jo),this.iconCollisionBox=new PS(an,rM.members,Jo);const d=om(this.iconSizeData,s),m=om(this.textSizeData,s);for(let _=0;_<this.symbolInstances.length;_++){const E=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(m,s,c,E.textBoxStartIndex,E.textBoxEndIndex,E),this._addTextDebugCollisionBoxes(m,s,c,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._addIconDebugCollisionBoxes(d,s,c,E.iconBoxStartIndex,E.iconBoxEndIndex,E),this._addIconDebugCollisionBoxes(d,s,c,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E)}}getSymbolInstanceTextSize(s,c,d,m){const _=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:m),E=vx(this.textSizeData,s,_)/ga;return this.tilePixelRatio*E}getSymbolInstanceIconSize(s,c,d){const m=this.icon.placedSymbolArray.get(d),_=vx(this.iconSizeData,s,m);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(s,c,d){s.emplaceBack(c,-d,-d),s.emplaceBack(c,d,-d),s.emplaceBack(c,d,d),s.emplaceBack(c,-d,d)}_updateTextDebugCollisionBoxes(s,c,d,m,_,E){for(let I=m;I<_;I++){const P=d.get(I),A=this.getSymbolInstanceTextSize(s,E,c,I);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,A,P.padding)}}_updateIconDebugCollisionBoxes(s,c,d,m,_,E){for(let I=m;I<_;I++){const P=d.get(I),A=this.getSymbolInstanceIconSize(s,c,E);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,A,P.padding)}}updateCollisionDebugBuffers(s,c){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const d=om(this.iconSizeData,s),m=om(this.textSizeData,s);for(let _=0;_<this.symbolInstances.length;_++){const E=this.symbolInstances.get(_);this._updateTextDebugCollisionBoxes(m,s,c,E.textBoxStartIndex,E.textBoxEndIndex,E),this._updateTextDebugCollisionBoxes(m,s,c,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._updateIconDebugCollisionBoxes(d,s,c,E.iconBoxStartIndex,E.iconBoxEndIndex,E.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(d,s,c,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(s,c,d,m,_,E,I,P,A){const N={};if(c<d){const{x1:G,y1:$,x2:W,y2:J,padding:te,projectedAnchorX:se,projectedAnchorY:me,projectedAnchorZ:Ie,tileAnchorX:ye,tileAnchorY:Se,featureIndex:Me}=s.get(c);N.textBox={x1:G,y1:$,x2:W,y2:J,padding:te,projectedAnchorX:se,projectedAnchorY:me,projectedAnchorZ:Ie,tileAnchorX:ye,tileAnchorY:Se},N.textFeatureIndex=Me}if(m<_){const{x1:G,y1:$,x2:W,y2:J,padding:te,projectedAnchorX:se,projectedAnchorY:me,projectedAnchorZ:Ie,tileAnchorX:ye,tileAnchorY:Se,featureIndex:Me}=s.get(m);N.verticalTextBox={x1:G,y1:$,x2:W,y2:J,padding:te,projectedAnchorX:se,projectedAnchorY:me,projectedAnchorZ:Ie,tileAnchorX:ye,tileAnchorY:Se},N.verticalTextFeatureIndex=Me}if(E<I){const{x1:G,y1:$,x2:W,y2:J,padding:te,projectedAnchorX:se,projectedAnchorY:me,projectedAnchorZ:Ie,tileAnchorX:ye,tileAnchorY:Se,featureIndex:Me}=s.get(E);N.iconBox={x1:G,y1:$,x2:W,y2:J,padding:te,projectedAnchorX:se,projectedAnchorY:me,projectedAnchorZ:Ie,tileAnchorX:ye,tileAnchorY:Se},N.iconFeatureIndex=Me}if(P<A){const{x1:G,y1:$,x2:W,y2:J,padding:te,projectedAnchorX:se,projectedAnchorY:me,projectedAnchorZ:Ie,tileAnchorX:ye,tileAnchorY:Se,featureIndex:Me}=s.get(P);N.verticalIconBox={x1:G,y1:$,x2:W,y2:J,padding:te,projectedAnchorX:se,projectedAnchorY:me,projectedAnchorZ:Ie,tileAnchorX:ye,tileAnchorY:Se},N.verticalIconFeatureIndex=Me}return N}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const d=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,c){const d=s.placedSymbolArray.get(c),m=d.vertexStartIndex+4*d.numGlyphs;for(let _=d.vertexStartIndex;_<m;_+=4)s.indexArray.emplaceBack(_,_+1,_+2),s.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(s),d=Math.cos(s),m=[],_=[],E=[];for(let I=0;I<this.symbolInstances.length;++I){E.push(I);const P=this.symbolInstances.get(I);m.push(0|Math.round(c*P.tileAnchorX+d*P.tileAnchorY)),_.push(P.featureIndex)}return E.sort((I,P)=>m[I]-m[P]||_[P]-_[I]),E}addToSortKeyRanges(s,c){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===c?d.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const d=this.symbolInstances.get(c);this.featureSortOrder.push(d.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:_,leftJustifiedTextSymbolIndex:E,verticalPlacedTextSymbolIndex:I,placedIconSymbolIndex:P,verticalPlacedIconSymbolIndex:A}=d;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),_>=0&&_!==m&&this.addIndicesForPlacedSymbol(this.text,_),E>=0&&E!==_&&E!==m&&this.addIndicesForPlacedSymbol(this.text,E),I>=0&&this.addIndicesForPlacedSymbol(this.text,I),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P),A>=0&&this.addIndicesForPlacedSymbol(this.icon,A)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}nn(Bf,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Bf.MAX_GLYPHS=65535,Bf.addDynamicAttributes=Mx;const zU=new xe({"symbol-placement":new ee(ct.layout_symbol["symbol-placement"]),"symbol-spacing":new ee(ct.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ee(ct.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ce(ct.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ee(ct.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ee(ct.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ee(ct.layout_symbol["icon-ignore-placement"]),"icon-optional":new ee(ct.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ee(ct.layout_symbol["icon-rotation-alignment"]),"icon-size":new ce(ct.layout_symbol["icon-size"]),"icon-text-fit":new ee(ct.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ee(ct.layout_symbol["icon-text-fit-padding"]),"icon-image":new ce(ct.layout_symbol["icon-image"]),"icon-rotate":new ce(ct.layout_symbol["icon-rotate"]),"icon-padding":new ee(ct.layout_symbol["icon-padding"]),"icon-keep-upright":new ee(ct.layout_symbol["icon-keep-upright"]),"icon-offset":new ce(ct.layout_symbol["icon-offset"]),"icon-anchor":new ce(ct.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ee(ct.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ee(ct.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ee(ct.layout_symbol["text-rotation-alignment"]),"text-field":new ce(ct.layout_symbol["text-field"]),"text-font":new ce(ct.layout_symbol["text-font"]),"text-size":new ce(ct.layout_symbol["text-size"]),"text-max-width":new ce(ct.layout_symbol["text-max-width"]),"text-line-height":new ce(ct.layout_symbol["text-line-height"]),"text-letter-spacing":new ce(ct.layout_symbol["text-letter-spacing"]),"text-justify":new ce(ct.layout_symbol["text-justify"]),"text-radial-offset":new ce(ct.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ee(ct.layout_symbol["text-variable-anchor"]),"text-anchor":new ce(ct.layout_symbol["text-anchor"]),"text-max-angle":new ee(ct.layout_symbol["text-max-angle"]),"text-writing-mode":new ee(ct.layout_symbol["text-writing-mode"]),"text-rotate":new ce(ct.layout_symbol["text-rotate"]),"text-padding":new ee(ct.layout_symbol["text-padding"]),"text-keep-upright":new ee(ct.layout_symbol["text-keep-upright"]),"text-transform":new ce(ct.layout_symbol["text-transform"]),"text-offset":new ce(ct.layout_symbol["text-offset"]),"text-allow-overlap":new ee(ct.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ee(ct.layout_symbol["text-ignore-placement"]),"text-optional":new ee(ct.layout_symbol["text-optional"])});var AS={paint:new xe({"icon-opacity":new ce(ct.paint_symbol["icon-opacity"]),"icon-color":new ce(ct.paint_symbol["icon-color"]),"icon-halo-color":new ce(ct.paint_symbol["icon-halo-color"]),"icon-halo-width":new ce(ct.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ce(ct.paint_symbol["icon-halo-blur"]),"icon-translate":new ee(ct.paint_symbol["icon-translate"]),"icon-translate-anchor":new ee(ct.paint_symbol["icon-translate-anchor"]),"text-opacity":new ce(ct.paint_symbol["text-opacity"]),"text-color":new ce(ct.paint_symbol["text-color"],{runtimeType:Is,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new ce(ct.paint_symbol["text-halo-color"]),"text-halo-width":new ce(ct.paint_symbol["text-halo-width"]),"text-halo-blur":new ce(ct.paint_symbol["text-halo-blur"]),"text-translate":new ee(ct.paint_symbol["text-translate"]),"text-translate-anchor":new ee(ct.paint_symbol["text-translate-anchor"])}),layout:zU};class zM{constructor(s){this.type=s.property.overrides?s.property.overrides.runtimeType:pf,this.defaultValue=s}evaluate(s){if(s.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(s.formattedSection))return c.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}nn(zM,"FormatSectionOverride",{omit:["defaultValue"]});class Lx extends Yu{constructor(s){super(s,AS)}recalculate(s,c){super.recalculate(s,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const d=this.layout.get("text-writing-mode");if(d){const m=[];for(const _ of d)m.indexOf(_)<0&&m.push(_);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(s,c,d,m){const _=this.layout.get(s).evaluate(c,{},d,m),E=this._unevaluatedLayout._values[s];return E.isDataDriven()||If(E.value)||!_?_:function(I,P){return P.replace(/{([^{}]+)}/g,(A,N)=>N in I?String(I[N]):"")}(c.properties,_)}createBucket(s){return new Bf(s)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const s of AS.paint.overridableProperties){if(!Lx.hasPaintOverride(this.layout,s))continue;const c=this.paint.get(s),d=new zM(c),m=new zg(d,c.property.specification);let _=null;_=c.value.kind==="constant"||c.value.kind==="source"?new Sv("source",m):new qd("composite",m,c.value.zoomStops,c.value._interpolationType),this.paint._values[s]=new de(c.property,_,c.parameters)}}_handleOverridablePaintPropertyUpdate(s,c,d){return!(!this.layout||c.isDataDriven()||d.isDataDriven())&&Lx.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,c){const d=s.get("text-field"),m=AS.paint.properties[c];let _=!1;const E=I=>{for(const P of I)if(m.overrides&&m.overrides.hasOverride(P))return void(_=!0)};if(d.value.kind==="constant"&&d.value.value instanceof os)E(d.value.value.sections);else if(d.value.kind==="source"){const I=A=>{_||(A instanceof ph&&eo(A.value)===Pd?E(A.value.sections):A instanceof Pc?E(A.sections):A.eachChild(I))},P=d.value;P._styleExpression&&I(P._styleExpression.expression)}return _}getProgramConfiguration(s){return new Df(this,s)}}var UU={paint:new xe({"background-color":new ee(ct.paint_background["background-color"]),"background-pattern":new ee(ct.paint_background["background-pattern"]),"background-opacity":new ee(ct.paint_background["background-opacity"])})},VU={paint:new xe({"raster-opacity":new ee(ct.paint_raster["raster-opacity"]),"raster-hue-rotate":new ee(ct.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ee(ct.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ee(ct.paint_raster["raster-brightness-max"]),"raster-saturation":new ee(ct.paint_raster["raster-saturation"]),"raster-contrast":new ee(ct.paint_raster["raster-contrast"]),"raster-resampling":new ee(ct.paint_raster["raster-resampling"]),"raster-fade-duration":new ee(ct.paint_raster["raster-fade-duration"])})};class GU extends Yu{constructor(s){super(s,{}),this.implementation=s}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)}onRemove(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)}}var $U={paint:new xe({"sky-type":new ee(ct.paint_sky["sky-type"]),"sky-atmosphere-sun":new ee(ct.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ee(ct.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ee(ct.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ee(ct.paint_sky["sky-gradient-radius"]),"sky-gradient":new _e(ct.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ee(ct.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ee(ct.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ee(ct.paint_sky["sky-opacity"])})};function MS(u,s,c){const d=[0,0,1],m=iA([]);return aA(m,m,c?-ae(u)+Math.PI:ae(u)),oA(m,m,-ae(s)),eA(d,d,m),ss(d,d)}const jU={circle:class extends Yu{constructor(u){super(u,t6)}createBucket(u){return new nS(u)}queryRadius(u){const s=u;return tm("circle-radius",this,s)+tm("circle-stroke-width",this,s)+sx(this.paint.get("circle-translate"))}queryIntersectsFeature(u,s,c,d,m,_,E,I){const P=PA(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),A=this.paint.get("circle-radius").evaluate(s,c)+this.paint.get("circle-stroke-width").evaluate(s,c);return AA(u,d,_,E,I,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",P,A)}getProgramIds(){return["circle"]}getProgramConfiguration(u){return new Df(this,u)}},heatmap:class extends Yu{createBucket(u){return new LA(u)}constructor(u){super(u,o6),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=aS({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(u){return tm("heatmap-radius",this,u)}queryIntersectsFeature(u,s,c,d,m,_,E,I){const P=this.paint.get("heatmap-radius").evaluate(s,c);return AA(u,d,_,E,I,!0,!0,new U(0,0),P)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(u){return new Df(this,u)}},hillshade:class extends Yu{constructor(u){super(u,a6)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Yu{constructor(u){super(u,w6)}getProgramIds(){const u=this.paint.get("fill-pattern"),s=u&&u.constantOr(1),c=[s?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(s&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getProgramConfiguration(u){return new Df(this,u)}recalculate(u,s){super.recalculate(u,s);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new fx(u)}queryRadius(){return sx(this.paint.get("fill-translate"))}queryIntersectsFeature(u,s,c,d,m,_){return!u.queryGeometry.isAboveHorizon&&EA(CA(u.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),d)}isTileClipped(){return!0}},"fill-extrusion":class extends Yu{constructor(u){super(u,B6)}createBucket(u){return new o_(u)}queryRadius(){return sx(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(u){return new Df(this,u)}queryIntersectsFeature(u,s,c,d,m,_,E,I,P){const A=PA(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),N=this.paint.get("fill-extrusion-height").evaluate(s,c),G=this.paint.get("fill-extrusion-base").evaluate(s,c),$=[0,0],W=I&&_.elevation,J=_.elevation?_.elevation.exaggeration():1,te=u.tile.getBucket(this);if(W&&te instanceof o_){const Se=te.centroidVertexArray,Me=P+1;Me<Se.length&&($[0]=Se.geta_centroid_pos0(Me),$[1]=Se.geta_centroid_pos1(Me))}if($[0]===0&&$[1]===1)return!1;_.projection.name==="globe"&&(d=HA([d],[new U(0,0),new U(bn,bn)],u.tileID.canonical).map(Se=>Se.polygon).flat());const se=W?I:null,[me,Ie]=function(Se,Me,Ae,et,We,ft,St,it,mt,yt,bt){return Se.projection.name==="globe"?function(Lt,ut,$t,sn,qt,Fn,Ot,vn,Bn,$r,zn){const Tn=[],Ci=[],$n=Lt.projection.upVectorScale(zn,Lt.center.lat,Lt.worldSize).metersToTile,jn=[0,0,0,1],pi=[0,0,0,1],xi=(gi,ji,to,So)=>{gi[0]=ji,gi[1]=to,gi[2]=So,gi[3]=1},bi=WA();$t>0&&($t+=bi),sn+=bi;for(const gi of ut){const ji=[],to=[];for(const So of gi){const mi=So.x+qt.x,Fo=So.y+qt.y,To=Lt.projection.projectTilePoint(mi,Fo,zn),Wi=Lt.projection.upVector(zn,So.x,So.y);let Zr=$t,Io=sn;if(Ot){const wi=QA(mi,Fo,$t,sn,Ot,vn,Bn,$r);Zr+=wi.base,Io+=wi.top}$t!==0?xi(jn,To.x+Wi[0]*$n*Zr,To.y+Wi[1]*$n*Zr,To.z+Wi[2]*$n*Zr):xi(jn,To.x,To.y,To.z),xi(pi,To.x+Wi[0]*$n*Io,To.y+Wi[1]*$n*Io,To.z+Wi[2]*$n*Io),co(jn,jn,Fn),co(pi,pi,Fn),ji.push(new im(jn[0],jn[1],jn[2])),to.push(new im(pi[0],pi[1],pi[2]))}Tn.push(ji),Ci.push(to)}return[Tn,Ci]}(Se,Me,Ae,et,We,ft,St,it,mt,yt,bt):St?function(Lt,ut,$t,sn,qt,Fn,Ot,vn,Bn){const $r=[],zn=[],Tn=[0,0,0,1];for(const Ci of Lt){const $n=[],jn=[];for(const pi of Ci){const xi=pi.x+sn.x,bi=pi.y+sn.y,gi=QA(xi,bi,ut,$t,Fn,Ot,vn,Bn);Tn[0]=xi,Tn[1]=bi,Tn[2]=gi.base,Tn[3]=1,rp(Tn,Tn,qt),Tn[3]=Math.max(Tn[3],1e-5);const ji=new im(Tn[0]/Tn[3],Tn[1]/Tn[3],Tn[2]/Tn[3]);Tn[0]=xi,Tn[1]=bi,Tn[2]=gi.top,Tn[3]=1,rp(Tn,Tn,qt),Tn[3]=Math.max(Tn[3],1e-5);const to=new im(Tn[0]/Tn[3],Tn[1]/Tn[3],Tn[2]/Tn[3]);$n.push(ji),jn.push(to)}$r.push($n),zn.push(jn)}return[$r,zn]}(Me,Ae,et,We,ft,St,it,mt,yt):function(Lt,ut,$t,sn,qt){const Fn=[],Ot=[],vn=qt[8]*ut,Bn=qt[9]*ut,$r=qt[10]*ut,zn=qt[11]*ut,Tn=qt[8]*$t,Ci=qt[9]*$t,$n=qt[10]*$t,jn=qt[11]*$t;for(const pi of Lt){const xi=[],bi=[];for(const gi of pi){const ji=gi.x+sn.x,to=gi.y+sn.y,So=qt[0]*ji+qt[4]*to+qt[12],mi=qt[1]*ji+qt[5]*to+qt[13],Fo=qt[2]*ji+qt[6]*to+qt[14],To=qt[3]*ji+qt[7]*to+qt[15],Wi=So+vn,Zr=mi+Bn,Io=Fo+$r,wi=Math.max(To+zn,1e-5),cs=So+Tn,Co=mi+Ci,ma=Fo+$n,Qo=Math.max(To+jn,1e-5);xi.push(new im(Wi/wi,Zr/wi,Io/wi)),bi.push(new im(cs/Qo,Co/Qo,ma/Qo))}Fn.push(xi),Ot.push(bi)}return[Fn,Ot]}(Me,Ae,et,We,ft)}(_,d,G,N,A,E,se,$,J,_.center.lat,u.tileID.canonical),ye=u.queryGeometry;return function(Se,Me,Ae){let et=1/0;EA(Ae,Me)&&(et=JA(Ae,Me[0]));for(let We=0;We<Me.length;We++){const ft=Me[We],St=Se[We];for(let it=0;it<ft.length-1;it++){const mt=ft[it],yt=[mt,ft[it+1],St[it+1],St[it],mt];wA(Ae,yt)&&(et=Math.min(et,JA(Ae,yt)))}}return et!==1/0&&et}(me,Ie,ye.isPointQuery()?ye.screenBounds:ye.screenGeometry)}},line:class extends Yu{constructor(u){super(u,eM),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const s=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=s._styleExpression&&s._styleExpression.expression instanceof hv,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(u,s){super.recalculate(u,s),this.paint._values["line-floorwidth"]=tM.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new yx(u)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(u){return new Df(this,u)}queryRadius(u){const s=u,c=nM(tm("line-width",this,s),tm("line-gap-width",this,s)),d=tm("line-offset",this,s);return c/2+Math.abs(d)+sx(this.paint.get("line-translate"))}queryIntersectsFeature(u,s,c,d,m,_){if(u.queryGeometry.isAboveHorizon)return!1;const E=CA(u.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),I=u.pixelToTileUnitsFactor/2*nM(this.paint.get("line-width").evaluate(s,c),this.paint.get("line-gap-width").evaluate(s,c)),P=this.paint.get("line-offset").evaluate(s,c);return P&&(d=function(A,N){const G=[],$=new U(0,0);for(let W=0;W<A.length;W++){const J=A[W],te=[];for(let se=0;se<J.length;se++){const me=J[se],Ie=J[se+1],ye=se===0?$:me.sub(J[se-1])._unit()._perp(),Se=se===J.length-1?$:Ie.sub(me)._unit()._perp(),Me=ye._add(Se)._unit();Me._mult(1/(Me.x*Se.x+Me.y*Se.y)),te.push(Me._mult(N)._add(me))}G.push(te)}return G}(d,P*u.pixelToTileUnitsFactor)),function(A,N,G){for(let $=0;$<N.length;$++){const W=N[$];if(A.length>=3){for(let J=0;J<W.length;J++)if(sp(A,W[J]))return!0}if(Kz(A,W,G))return!0}return!1}(E,d,I)}isTileClipped(){return!0}},symbol:Lx,background:class extends Yu{constructor(u){super(u,UU)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Yu{constructor(u){super(u,VU)}getProgramIds(){return["raster"]}},sky:class extends Yu{constructor(u){super(u,$U),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="sky-gradient"?this._updateColorRamp():u!=="sky-atmosphere-sun"&&u!=="sky-atmosphere-halo-color"&&u!=="sky-atmosphere-color"&&u!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=aS({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(u){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const s=u.style.light.properties.get("position");return this._lightPosition.azimuthal!==s.azimuthal||this._lightPosition.polar!==s.polar}return!1}getCenter(u,s){if(this.paint.get("sky-type")==="atmosphere"){const d=this.paint.get("sky-atmosphere-sun"),m=!d,_=u.style.light,E=_.properties.get("position");return m&&_.properties.get("anchor")==="viewport"&&nt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?MS(E.azimuthal,90-E.polar,s):MS(d[0],90-d[1],s)}const c=this.paint.get("sky-gradient-center");return MS(c[0],90-c[1],s)}is3D(){return!1}isSky(){return!0}markSkyboxValid(u){this._skyboxInvalidated=!1,this._lightPosition=u.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const u=this.paint.get("sky-type");return u==="atmosphere"?["skyboxCapture","skybox"]:u==="gradient"?["skyboxGradient"]:null}}};class m_{constructor(s,c,d,m){this.context=s,this.format=d,this.texture=s.gl.createTexture(),this.update(c,m)}update(s,c,d){const{width:m,height:_}=s,{context:E}=this,{gl:I}=E,{HTMLImageElement:P,HTMLCanvasElement:A,HTMLVideoElement:N,ImageData:G,ImageBitmap:$}=f;if(I.bindTexture(I.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!c||c.premultiply!==!1)),d||this.size&&this.size[0]===m&&this.size[1]===_){const{x:W,y:J}=d||{x:0,y:0};s instanceof P||s instanceof A||s instanceof N||s instanceof G||$&&s instanceof $?I.texSubImage2D(I.TEXTURE_2D,0,W,J,I.RGBA,I.UNSIGNED_BYTE,s):I.texSubImage2D(I.TEXTURE_2D,0,W,J,m,_,I.RGBA,I.UNSIGNED_BYTE,s.data)}else this.size=[m,_],s instanceof P||s instanceof A||s instanceof N||s instanceof G||$&&s instanceof $?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,s):I.texImage2D(I.TEXTURE_2D,0,this.format,m,_,0,this.format,I.UNSIGNED_BYTE,s.data);this.useMipmap=!!(c&&c.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&I.generateMipmap(I.TEXTURE_2D)}bind(s,c){const{context:d}=this,{gl:m}=d;m.bindTexture(m.TEXTURE_2D,this.texture),s!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap?s===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_NEAREST:s),this.filter=s),c!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,c),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class qU{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class ZU{constructor(){this.tasks={},this.taskQueue=[],dt(["process"],this),this.invoker=new qU(this.process),this.nextId=0}add(s,c){const d=this.nextId++,m=function({type:_,isSymbolTile:E,zoom:I}){return I=I||0,_==="message"?0:_!=="maybePrepare"||E?_!=="parseTile"||E?_==="parseTile"&&E?300-I:_==="maybePrepare"&&E?400-I:500:200-I:100-I}(c);if(m===0){Dt();try{s()}finally{}return{cancel:()=>{}}}return this.tasks[d]={fn:s,metadata:c,priority:m,id:d},this.taskQueue.push(d),this.invoker.trigger(),{cancel:()=>{delete this.tasks[d]}}}process(){Dt();try{if(this.taskQueue=this.taskQueue.filter(d=>!!this.tasks[d]),!this.taskQueue.length)return;const s=this.pick();if(s===null)return;const c=this.tasks[s];if(delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let s=null,c=1/0;for(let m=0;m<this.taskQueue.length;m++){const _=this.tasks[this.taskQueue[m]];_.priority<c&&(c=_.priority,s=m)}if(s===null)return null;const d=this.taskQueue[s];return this.taskQueue.splice(s,1),d}remove(){this.invoker.remove()}}class UM{constructor(s){this._stringToNumber={},this._numberToString=[];for(let c=0;c<s.length;c++){const d=s[c];this._stringToNumber[d]=c,this._numberToString[c]=d}}encode(s){return this._stringToNumber[s]}decode(s){return this._numberToString[s]}}const XU=["tile","layer","source","sourceLayer","state"];class VM{constructor(s,c,d,m,_){this.type="Feature",this._vectorTileFeature=s,this._z=c,this._x=d,this._y=m,this.properties=s.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(s.id=this.id);for(const c of XU)this[c]!==void 0&&(s[c]=this[c]);return s}}const Jl=32,kc=33,zf=new Uint16Array(8184);for(let u=0;u<2046;u++){let s=u+2,c=0,d=0,m=0,_=0,E=0,I=0;for(1&s?m=_=E=Jl:c=d=I=Jl;(s>>=1)>1;){const A=c+m>>1,N=d+_>>1;1&s?(m=c,_=d,c=E,d=I):(c=m,d=_,m=E,_=I),E=A,I=N}const P=4*u;zf[P+0]=c,zf[P+1]=d,zf[P+2]=m,zf[P+3]=_}const Nc=new Uint16Array(2178),Uf=new Uint8Array(1089),Ox=new Uint16Array(1089);function GM(u){return u===0?-.03125:u===32?.03125:0}var $M=ze([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const jM={type:2,extent:bn,loadGeometry:()=>[[new U(0,0),new U(bn+1,0),new U(bn+1,bn+1),new U(0,bn+1),new U(0,0)]]};class LS{constructor(s,c,d,m,_){this.tileID=s,this.uid=Wt(),this.uses=0,this.tileSize=c,this.tileZoom=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=_,this.expiredRequestCount=0,this.state="loading",m&&m.transform&&(this.projection=m.transform.projection)}registerFadeDuration(s){const c=s+this.timeAdded;c<Bu.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=up(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,c,d){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(m,_){const E={};if(!_)return E;for(const I of m){const P=I.layerIds.map(A=>_.getLayer(A)).filter(Boolean);if(P.length!==0){I.layers=P,I.stateDependentLayerIds&&(I.stateDependentLayers=I.stateDependentLayerIds.map(A=>P.filter(N=>N.id===A)[0]));for(const A of P)E[A.id]=I}}return E}(s.buckets,c.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const _=this.buckets[m];if(_ instanceof Bf){if(this.hasSymbolBuckets=!0,!d)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const _=this.buckets[m];if(_ instanceof Bf&&_.hasRTLText){this.hasRTLText=!0,R.isLoading()||R.isLoaded()||C()!=="deferred"||O();break}}this.queryPadding=0;for(const m in this.buckets){const _=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(m).queryRadius(_))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas)}else this.collisionBoxArray=new fi}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(s){return this.buckets[s.id]}upload(s){for(const d in this.buckets){const m=this.buckets[d];m.uploadPending()&&m.upload(s)}const c=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new m_(s,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new m_(s,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new m_(s,this.lineAtlas.image,c.ALPHA),this.lineAtlas.uploaded=!0)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,c,d,m,_,E,I,P){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:m,pixelPosMatrix:I,transform:E,params:_,tileTransform:this.tileTransform},s,c,d):{}}querySourceFeatures(s,c){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const m=d.loadVTLayers(),_=c?c.sourceLayer:"",E=m._geojsonTileLayer||m[_];if(!E)return;const I=$g(c&&c.filter),{z:P,x:A,y:N}=this.tileID.canonical,G={z:P,x:A,y:N};for(let $=0;$<E.length;$++){const W=E.feature($);if(I.needGeometry){const se=ap(W,!0);if(!I.filter(new F(this.tileID.overscaledZ),se,this.tileID.canonical))continue}else if(!I.filter(new F(this.tileID.overscaledZ),W))continue;const J=d.getId(W,_),te=new VM(W,P,A,N,J);te.tile=G,s.push(te)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const c=this.expirationTime;if(s.cacheControl){const d=Ct(s.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const d=Date.now();let m=!1;if(this.expirationTime>d)m=!1;else if(c)if(this.expirationTime<c)m=!0;else{const _=this.expirationTime-c;_?this.expirationTime=d+Math.max(_,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(s,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(s).length===0||!c)return;const d=this.latestFeatureIndex.loadVTLayers(),m=c.style.listImages();for(const _ in this.buckets){if(!c.style.hasLayer(_))continue;const E=this.buckets[_],I=E.layers[0].sourceLayer||"_geojsonTileLayer",P=d[I],A=s[I];if(!P||!A||Object.keys(A).length===0)continue;if(E.update(A,P,m,this.imageAtlas&&this.imageAtlas.patternPositions||{}),E instanceof yx||E instanceof fx){const G=c.style._getSourceCache(E.layers[0].source);c._terrain&&c._terrain.enabled&&G&&E.programConfigurations.needsUpload&&c._terrain._clearRenderCacheForTile(G.id,this.tileID)}const N=c&&c.style&&c.style.getLayer(_);N&&(this.queryPadding=Math.max(this.queryPadding,N.queryRadius(E)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Bu.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=Bu.now()+s}setTexture(s,c){const d=c.context,m=d.gl;this.texture=this.texture||c.getTileTexture(s.width),this.texture?this.texture.update(s,{useMipmap:!0}):(this.texture=new m_(d,s,m.RGBA,{useMipmap:!0}),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE))}setDependencies(s,c){const d={};for(const m of c)d[m]=!0;this.dependencies[s]=d}hasDependency(s,c){for(const d of s){const m=this.dependencies[d];if(m){for(const _ of c)if(m[_])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,c){if(!c||c.name==="mercator"||this._tileDebugBuffer)return;const d=Ih(jM,this.tileID.canonical,this.tileTransform)[0],m=new Et,_=new Zs;for(let E=0;E<d.length;E++){const{x:I,y:P}=d[E];m.emplaceBack(I,P),_.emplaceBack(E)}_.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(_),this._tileDebugBuffer=s.createVertexBuffer(m,Wv.members),this._tileDebugSegments=wo.simpleSegment(0,0,m.length,_.length)}_makeTileBoundsBuffers(s,c){if(this._tileBoundsBuffer||!c||c.name==="mercator")return;const d=Ih(jM,this.tileID.canonical,this.tileTransform)[0];let m,_;if(this.isRaster){const E=function(I,P){const A=up(I,P),N=Math.pow(2,I.z);for(let se=0;se<kc;se++)for(let me=0;me<kc;me++){const Ie=_l((I.x+(me+GM(me))/Jl)/N),ye=Aa((I.y+(se+GM(se))/Jl)/N),Se=P.project(Ie,ye),Me=se*kc+me;Nc[2*Me+0]=Math.round((Se.x*A.scale-A.x)*bn),Nc[2*Me+1]=Math.round((Se.y*A.scale-A.y)*bn)}Uf.fill(0),Ox.fill(0);for(let se=2045;se>=0;se--){const me=4*se,Ie=zf[me+0],ye=zf[me+1],Se=zf[me+2],Me=zf[me+3],Ae=Ie+Se>>1,et=ye+Me>>1,We=Ae+et-ye,ft=et+Ie-Ae,St=ye*kc+Ie,it=Me*kc+Se,mt=et*kc+Ae,yt=Math.hypot((Nc[2*St+0]+Nc[2*it+0])/2-Nc[2*mt+0],(Nc[2*St+1]+Nc[2*it+1])/2-Nc[2*mt+1])>=16;Uf[mt]=Uf[mt]||(yt?1:0),se<1022&&(Uf[mt]=Uf[mt]||Uf[(ye+ft>>1)*kc+(Ie+We>>1)]||Uf[(Me+ft>>1)*kc+(Se+We>>1)])}const G=new gt,$=new gn;let W=0;function J(se,me){const Ie=me*kc+se;return Ox[Ie]===0&&(G.emplaceBack(Nc[2*Ie+0],Nc[2*Ie+1],se*bn/Jl,me*bn/Jl),Ox[Ie]=++W),Ox[Ie]-1}function te(se,me,Ie,ye,Se,Me){const Ae=se+Ie>>1,et=me+ye>>1;if(Math.abs(se-Se)+Math.abs(me-Me)>1&&Uf[et*kc+Ae])te(Se,Me,se,me,Ae,et),te(Ie,ye,Se,Me,Ae,et);else{const We=J(se,me),ft=J(Ie,ye),St=J(Se,Me);$.emplaceBack(We,ft,St)}}return te(0,0,Jl,Jl,Jl,0),te(Jl,Jl,0,0,0,Jl),{vertices:G,indices:$}}(this.tileID.canonical,c);m=E.vertices,_=E.indices}else{m=new gt,_=new gn;for(const{x:I,y:P}of d)m.emplaceBack(I,P,0,0);const E=hS(m.int16,void 0,4);for(let I=0;I<E.length;I+=3)_.emplaceBack(E[I],E[I+1],E[I+2])}this._tileBoundsBuffer=s.createVertexBuffer(m,$M.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(_),this._tileBoundsSegments=wo.simpleSegment(0,0,m.length,_.length)}_makeGlobeTileDebugBuffers(s,c){const d=c.projection;if(!d||d.name!=="globe"||c.freezeTileCoverage)return;const m=this.tileID.canonical,_=Kv(hA(m,c)),E=Qg(c.zoom);let I;E>0&&(I=zE(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,m,c,_,I,E),this._makeGlobeTileDebugTextBuffer(s,m,c,_,I,E)}_globePoint(s,c,d,m,_,E,I){let P=Yv(s,c,d);if(E){const A=1<<d.z,N=Dc(m.center.lng),G=Rc(m.center.lat),$=(d.x+.5)/A-N;let W=0;$>.5?W=-1:$<-.5&&(W=1);let J=(s/bn+d.x)/A+W,te=(c/bn+d.y)/A;J=(J-N)*m._pixelsPerMercatorPixel+N,te=(te-G)*m._pixelsPerMercatorPixel+G;const se=[J*m.worldSize,te*m.worldSize,0];co(se,se,E),P=op(P,se,I)}return co(P,P,_)}_makeGlobeTileDebugBorderBuffer(s,c,d,m,_,E){const I=new Et,P=new Zs,A=new Xe,N=($,W,J,te,se)=>{const me=(J-$)/(se-1),Ie=(te-W)/(se-1),ye=I.length;for(let Se=0;Se<se;Se++){const Me=$+Se*me,Ae=W+Se*Ie;I.emplaceBack(Me,Ae);const et=this._globePoint(Me,Ae,c,d,m,_,E);A.emplaceBack(et[0],et[1],et[2]),P.emplaceBack(ye+Se)}},G=bn;N(0,0,G,0,16),N(G,0,G,G,16),N(G,G,0,G,16),N(0,G,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(P),this._tileDebugBuffer=s.createVertexBuffer(I,Wv.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(A,lA.members),this._tileDebugSegments=wo.simpleSegment(0,0,I.length,P.length)}_makeGlobeTileDebugTextBuffer(s,c,d,m,_,E){const I=bn/4,P=new Et,A=new gn,N=new Xe,G=25;A.reserve(32),P.reserve(G),N.reserve(G);const $=(W,J)=>G*W+J;for(let W=0;W<G;W++){const J=W*I;for(let te=0;te<G;te++){const se=te*I;P.emplaceBack(se,J);const me=this._globePoint(se,J,c,d,m,_,E);N.emplaceBack(me[0],me[1],me[2])}}for(let W=0;W<4;W++)for(let J=0;J<4;J++){const te=$(W,J),se=$(W,J+1),me=$(W+1,J),Ie=$(W+1,J+1);A.emplaceBack(te,se,me),A.emplaceBack(me,se,Ie)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(A),this._tileDebugTextBuffer=s.createVertexBuffer(P,Wv.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(N,lA.members),this._tileDebugTextSegments=wo.simpleSegment(0,0,G,32)}}class WU{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,c,d){const m=String(c);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][m]=this.stateChanges[s][m]||{},xt(this.stateChanges[s][m],d),this.deletedStates[s]===null){this.deletedStates[s]={};for(const _ in this.state[s])_!==m&&(this.deletedStates[s][_]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][m]===null){this.deletedStates[s][m]={};for(const _ in this.state[s][m])d[_]||(this.deletedStates[s][m][_]=null)}else for(const _ in d)this.deletedStates[s]&&this.deletedStates[s][m]&&this.deletedStates[s][m][_]===null&&delete this.deletedStates[s][m][_]}removeFeatureState(s,c,d){if(this.deletedStates[s]===null)return;const m=String(c);if(this.deletedStates[s]=this.deletedStates[s]||{},d&&c!==void 0)this.deletedStates[s][m]!==null&&(this.deletedStates[s][m]=this.deletedStates[s][m]||{},this.deletedStates[s][m][d]=null);else if(c!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][m])for(d in this.deletedStates[s][m]={},this.stateChanges[s][m])this.deletedStates[s][m][d]=null;else this.deletedStates[s][m]=null;else this.deletedStates[s]=null}getState(s,c){const d=String(c),m=xt({},(this.state[s]||{})[d],(this.stateChanges[s]||{})[d]);if(this.deletedStates[s]===null)return{};if(this.deletedStates[s]){const _=this.deletedStates[s][c];if(_===null)return{};for(const E in _)delete m[E]}return m}initializeTileState(s,c){s.setFeatureState(this.state,c)}coalesceChanges(s,c){const d={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const _={};for(const E in this.stateChanges[m])this.state[m][E]||(this.state[m][E]={}),xt(this.state[m][E],this.stateChanges[m][E]),_[E]=this.state[m][E];d[m]=_}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const _={};if(this.deletedStates[m]===null)for(const E in this.state[m])_[E]={},this.state[m][E]={};else for(const E in this.deletedStates[m]){if(this.deletedStates[m][E]===null)this.state[m][E]={};else if(this.state[m][E])for(const I of Object.keys(this.deletedStates[m][E]))delete this.state[m][E][I];_[E]=this.state[m][E]}d[m]=d[m]||{},xt(d[m],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const m in s)s[m].setFeatureState(d,c)}}class qM{constructor(s){this.size=s,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(s,c){const d=this.toIdx(s,c);return{min:this.minimums[d],max:this.maximums[d]}}isLeaf(s,c){return this.leaves[this.toIdx(s,c)]}toIdx(s,c){return c*this.size+s}}function ZM(u,s,c,d){let m=0,_=Number.MAX_VALUE;for(let E=0;E<3;E++)if(Math.abs(d[E])<1e-15){if(c[E]<u[E]||c[E]>s[E])return null}else{const I=1/d[E];let P=(u[E]-c[E])*I,A=(s[E]-c[E])*I;if(P>A){const N=P;P=A,A=N}if(P>m&&(m=P),A<_&&(_=A),m>_)return null}return m}function XM(u,s,c,d,m,_,E,I,P,A,N){const G=d-u,$=m-s,W=_-c,J=E-u,te=I-s,se=P-c,me=N[1]*se-N[2]*te,Ie=N[2]*J-N[0]*se,ye=N[0]*te-N[1]*J,Se=G*me+$*Ie+W*ye;if(Math.abs(Se)<1e-15)return null;const Me=1/Se,Ae=A[0]-u,et=A[1]-s,We=A[2]-c,ft=(Ae*me+et*Ie+We*ye)*Me;if(ft<0||ft>1)return null;const St=et*W-We*$,it=We*G-Ae*W,mt=Ae*$-et*G,yt=(N[0]*St+N[1]*it+N[2]*mt)*Me;return yt<0||ft+yt>1?null:(J*St+te*it+se*mt)*Me}function WM(u,s,c){return(u-s)/(c-s)}function HM(u,s,c,d,m,_,E,I,P){const A=1<<c,N=_-d,G=E-m,$=(u+1)/A*N+d,W=(s+0)/A*G+m,J=(s+1)/A*G+m;I[0]=(u+0)/A*N+d,I[1]=W,P[0]=$,P[1]=J}class YM{constructor(s){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=s,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(_){const E=Math.ceil(Math.log2(_.dim/8)),I=[];let P=Math.ceil(Math.pow(2,E));const A=1/P,N=(W,J,te,se,me)=>{const Ie=se?1:0,ye=(W+1)*te-Ie,Se=J*te,Me=(J+1)*te-Ie;me[0]=W*te,me[1]=Se,me[2]=ye,me[3]=Me};let G=new qM(P);const $=[];for(let W=0;W<P*P;W++){N(W%P,Math.floor(W/P),A,!1,$);const J=Vf($[0],$[1],_),te=Vf($[2],$[1],_),se=Vf($[2],$[3],_),me=Vf($[0],$[3],_);G.minimums.push(Math.min(J,te,se,me)),G.maximums.push(Math.max(J,te,se,me)),G.leaves.push(1)}for(I.push(G),P/=2;P>=1;P/=2){const W=I[I.length-1];G=new qM(P);for(let J=0;J<P*P;J++){N(J%P,Math.floor(J/P),2,!0,$);const te=W.getElevation($[0],$[1]),se=W.getElevation($[2],$[1]),me=W.getElevation($[2],$[3]),Ie=W.getElevation($[0],$[3]),ye=W.isLeaf($[0],$[1]),Se=W.isLeaf($[2],$[1]),Me=W.isLeaf($[2],$[3]),Ae=W.isLeaf($[0],$[3]),et=Math.min(te.min,se.min,me.min,Ie.min),We=Math.max(te.max,se.max,me.max,Ie.max),ft=ye&&Se&&Me&&Ae;G.maximums.push(We),G.minimums.push(et),G.leaves.push(We-et<=5&&ft?1:0)}I.push(G)}return I}(this.dem),d=c.length-1,m=c[d];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(c,0,0,d,0)}raycastRoot(s,c,d,m,_,E,I=1){return ZM([s,c,-100],[d,m,this.maximums[0]*I],_,E)}raycast(s,c,d,m,_,E,I=1){if(!this.nodeCount)return null;const P=this.raycastRoot(s,c,d,m,_,E,I);if(P==null)return null;const A=[],N=[],G=[],$=[],W=[{idx:0,t:P,nodex:0,nodey:0,depth:0}];for(;W.length>0;){const{idx:J,t:te,nodex:se,nodey:me,depth:Ie}=W.pop();if(this.leaves[J]){HM(se,me,Ie,s,c,d,m,G,$);const Se=1<<Ie,Me=(se+0)/Se,Ae=(se+1)/Se,et=(me+0)/Se,We=(me+1)/Se,ft=Vf(Me,et,this.dem)*I,St=Vf(Ae,et,this.dem)*I,it=Vf(Ae,We,this.dem)*I,mt=Vf(Me,We,this.dem)*I,yt=XM(G[0],G[1],ft,$[0],G[1],St,$[0],$[1],it,_,E),bt=XM($[0],$[1],it,G[0],$[1],mt,G[0],G[1],ft,_,E),Lt=Math.min(yt!==null?yt:Number.MAX_VALUE,bt!==null?bt:Number.MAX_VALUE);if(Lt!==Number.MAX_VALUE)return Lt;{const ut=Zv([],_,E,te);if(KM(ft,St,mt,it,WM(ut[0],G[0],$[0]),WM(ut[1],G[1],$[1]))>=ut[2])return te}continue}let ye=0;for(let Se=0;Se<this._siblingOffset.length;Se++){HM((se<<1)+this._siblingOffset[Se][0],(me<<1)+this._siblingOffset[Se][1],Ie+1,s,c,d,m,G,$),G[2]=-100,$[2]=this.maximums[this.childOffsets[J]+Se]*I;const Me=ZM(G,$,_,E);if(Me!=null){const Ae=Me;A[Se]=Ae;let et=!1;for(let We=0;We<ye&&!et;We++)Ae>=A[N[We]]&&(N.splice(We,0,Se),et=!0);et||(N[ye]=Se),ye++}}for(let Se=0;Se<ye;Se++){const Me=N[Se];W.push({idx:this.childOffsets[J]+Me,t:A[Me],nodex:(se<<1)+this._siblingOffset[Me][0],nodey:(me<<1)+this._siblingOffset[Me][1],depth:Ie+1})}}return null}_addNode(s,c,d){return this.minimums.push(s),this.maximums.push(c),this.leaves.push(d),this.childOffsets.push(0),this.nodeCount++}_construct(s,c,d,m,_){if(s[m].isLeaf(c,d)===1)return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const E=m-1,I=s[E];let P=0,A=0;for(let N=0;N<this._siblingOffset.length;N++){const G=2*c+this._siblingOffset[N][0],$=2*d+this._siblingOffset[N][1],W=I.getElevation(G,$),J=I.isLeaf(G,$),te=this._addNode(W.min,W.max,J);J&&(P|=1<<N),A||(A=te)}for(let N=0;N<this._siblingOffset.length;N++)P&1<<N||this._construct(s,2*c+this._siblingOffset[N][0],2*d+this._siblingOffset[N][1],E,A+N)}}function KM(u,s,c,d,m,_){return mr(mr(u,c,_),mr(s,d,_),m)}function Vf(u,s,c){const d=c.dim,m=Pe(u*d-.5,0,d-1),_=Pe(s*d-.5,0,d-1),E=Math.floor(m),I=Math.floor(_),P=Math.min(E+1,d-1),A=Math.min(I+1,d-1);return KM(c.get(E,I),c.get(P,I),c.get(E,A),c.get(P,A),m-E,_-I)}const JM={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function HU(u,s,c){return(256*u*256+256*s+c)/10-1e4}function YU(u,s,c){return 256*u+s+c/256-32768}class Dx{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(s,c,d,m=!1,_=!1){if(this.uid=s,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(d&&d!=="mapbox"&&d!=="terrarium")return nt(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const E=this.dim=c.height-2,I=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.encoding=d||"mapbox",this.borderReady=m,!m){for(let P=0;P<E;P++)I[this._idx(-1,P)]=I[this._idx(0,P)],I[this._idx(E,P)]=I[this._idx(E-1,P)],I[this._idx(P,-1)]=I[this._idx(P,0)],I[this._idx(P,E)]=I[this._idx(P,E-1)];I[this._idx(-1,-1)]=I[this._idx(0,0)],I[this._idx(E,-1)]=I[this._idx(E-1,0)],I[this._idx(-1,E)]=I[this._idx(0,E-1)],I[this._idx(E,E)]=I[this._idx(E-1,E-1)],_&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new YM(this)}get(s,c,d=!1){d&&(s=Pe(s,-1,this.dim),c=Pe(c,-1,this.dim));const m=4*this._idx(s,c);return(this.encoding==="terrarium"?YU:HU)(this.pixels[m],this.pixels[m+1],this.pixels[m+2])}static getUnpackVector(s){return JM[s]}get unpackVector(){return JM[this.encoding]}_idx(s,c){if(s<-1||s>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(s+1)}static pack(s,c){const d=[0,0,0,0],m=Dx.getUnpackVector(c);let _=Math.floor((s+m[3])/m[2]);return d[2]=_%256,_=Math.floor(_/256),d[1]=_%256,_=Math.floor(_/256),d[0]=_,d}getPixels(){return new Ws({width:this.stride,height:this.stride},this.pixels)}backfillBorder(s,c,d){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let m=c*this.dim,_=c*this.dim+this.dim,E=d*this.dim,I=d*this.dim+this.dim;switch(c){case-1:m=_-1;break;case 1:_=m+1}switch(d){case-1:E=I-1;break;case 1:I=E+1}const P=-c*this.dim,A=-d*this.dim;for(let N=E;N<I;N++)for(let G=m;G<_;G++){const $=4*this._idx(G,N),W=4*this._idx(G+P,N+A);this.pixels[$+0]=s.pixels[W+0],this.pixels[$+1]=s.pixels[W+1],this.pixels[$+2]=s.pixels[W+2],this.pixels[$+3]=s.pixels[W+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}nn(Dx,"DEMData"),nn(YM,"DemMinMaxQuadTree",{omit:["dem"]});class KU{constructor(s,c){this.max=s,this.onRemove=c,this.reset()}reset(){for(const s in this.data)for(const c of this.data[s])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(s,c,d){const m=s.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);const _={value:c,timeout:void 0};if(d!==void 0&&(_.timeout=setTimeout(()=>{this.remove(s,_)},d)),this.data[m].push(_),this.order.push(m),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const c=this.data[s].shift();return c.timeout&&clearTimeout(c.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),c.value}getByKey(s){const c=this.data[s];return c?c[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,c){if(!this.has(s))return this;const d=s.wrapped().key,m=c===void 0?0:this.data[d].indexOf(c),_=this.data[d][m];return this.data[d].splice(m,1),_.timeout&&clearTimeout(_.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(_.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(s){const c=[];for(const d in this.data)for(const m of this.data[d])s(m.value)||c.push(m);for(const d of c)this.remove(d.value.tileID,d)}}class pm{constructor(s,c,d){this.func=s,this.mask=c,this.range=d}}pm.ReadOnly=!1,pm.ReadWrite=!0,pm.disabled=new pm(519,pm.ReadOnly,[0,1]);const OS=7680;class DS{constructor(s,c,d,m,_,E){this.test=s,this.ref=c,this.mask=d,this.fail=m,this.depthFail=_,this.pass=E}}DS.disabled=new DS({func:519,mask:0},0,0,OS,OS,OS);class Fc{constructor(s,c,d){this.blendFunction=s,this.blendColor=c,this.mask=d}}Fc.Replace=[1,0],Fc.disabled=new Fc(Fc.Replace,uo.transparent,[!1,!1,!1,!1]),Fc.unblended=new Fc(Fc.Replace,uo.transparent,[!0,!0,!0,!0]),Fc.alphaBlended=new Fc([1,771],uo.transparent,[!0,!0,!0,!0]);const RS=1029,kS=2305;class nc{constructor(s,c,d){this.enable=s,this.mode=c,this.frontFace=d}}nc.disabled=new nc(!1,RS,kS),nc.backCCW=new nc(!0,RS,kS),nc.backCW=new nc(!0,RS,2304),nc.frontCW=new nc(!0,1028,2304),nc.frontCCW=new nc(!0,1028,kS);class cp extends Cd{constructor(s,c,d){super(),this.id=s,this._onlySymbols=d,c.on("data",m=>{m.dataType==="source"&&m.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&m.dataType==="source"&&m.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),c.on("error",()=>{this._sourceErrored=!0}),this._source=c,this._tiles={},this._cache=new KU(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new WU,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(s){this.map=s,this._minTileCacheSize=this._minTileCacheSize===void 0&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles){const c=this._tiles[s];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,c){return s.isSymbolTile=this._onlySymbols,this._source.loadTile(s,c)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s,()=>{})}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s,()=>{})}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const d=this._tiles[c];d.upload(s),d.prepare(this.map.style.imageManager)}}getIds(){return lt(this._tiles).map(s=>s.tileID).sort(QM).map(s=>s.key)}getRenderableIds(s){const c=[];for(const d in this._tiles)this._isIdRenderable(+d,s)&&c.push(this._tiles[d]);return s?c.sort((d,m)=>{const _=d.tileID,E=m.tileID,I=new U(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),P=new U(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-E.overscaledZ||P.y-I.y||P.x-I.x}).map(d=>d.tileID.key):c.map(d=>d.tileID).sort(QM).map(d=>d.key)}hasRenderableParent(s){const c=this.findLoadedParent(s,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(s,c){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(c||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(+s,"reloading")}}_reloadTile(s,c){const d=this._tiles[s];d&&(d.state!=="loading"&&(d.state=c),this._loadTile(d,this._tileLoaded.bind(this,d,s,c)))}_tileLoaded(s,c,d,m){if(m)if(s.state="errored",m.status!==404)this._source.fire(new zu(m,{tile:s}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const _=this.map.painter.terrain;this.update(this.transform,_.getScaledDemTileSize(),!0),_.resetTileLookupCache(this.id)}else this.update(this.transform);else s.timeAdded=Bu.now(),d==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(c,s),this._source.type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new fh("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const c=this.getRenderableIds();for(let m=0;m<c.length;m++){const _=c[m];if(s.neighboringTiles&&s.neighboringTiles[_]){const E=this.getTileByID(_);d(s,E),d(E,s)}}function d(m,_){if(!m.dem||m.dem.borderReady)return;m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0;let E=_.tileID.canonical.x-m.tileID.canonical.x;const I=_.tileID.canonical.y-m.tileID.canonical.y,P=Math.pow(2,m.tileID.canonical.z),A=_.tileID.key;E===0&&I===0||Math.abs(I)>1||(Math.abs(E)>1&&(Math.abs(E+P)===1?E+=P:Math.abs(E-P)===1&&(E-=P)),_.dem&&m.dem&&(m.dem.backfillBorder(_.dem,E,I),m.neighboringTiles&&m.neighboringTiles[A]&&(m.neighboringTiles[A].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,c,d,m){for(const _ in this._tiles){let E=this._tiles[_];if(m[_]||!E.hasData()||E.tileID.overscaledZ<=c||E.tileID.overscaledZ>d)continue;let I=E.tileID;for(;E&&E.tileID.overscaledZ>c+1;){const A=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[A.key],E&&E.hasData()&&(I=A)}let P=I;for(;P.overscaledZ>c;)if(P=P.scaledTo(P.overscaledZ-1),s[P.key]){m[I.key]=I;break}}}findLoadedParent(s,c){if(s.key in this._loadedParentTiles){const d=this._loadedParentTiles[s.key];return d&&d.tileID.overscaledZ>=c?d:null}for(let d=s.overscaledZ-1;d>=c;d--){const m=s.scaledTo(d),_=this._getLoadedTile(m);if(_)return _}}_getLoadedTile(s){const c=this._tiles[s.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,c){c=c||this._source.tileSize;const d=Math.ceil(s.width/c)+1,m=Math.ceil(s.height/c)+1,_=Math.floor(d*m*5),E=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,_):_,I=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(I)}handleWrapJump(s){const c=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,c){const d={};for(const m in this._tiles){const _=this._tiles[m];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+c),d[_.tileID.key]=_}this._tiles=d;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(+m,this._tiles[m])}}update(s,c,d){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!d)return;let m;this.updateCacheSize(s,c),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?m=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(I=>new us(I.canonical.z,I.wrap,I.canonical.z,I.canonical.x,I.canonical.y)):(m=s.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!d,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(m=m.filter(I=>this._source.hasTile(I)))):m=[];const _=this._updateRetainedTiles(m);if(eL(this._source.type)&&m.length!==0){const I={},P={},A=Object.keys(_);for(const G of A){const $=_[G],W=this._tiles[G];if(!W||W.fadeEndTime&&W.fadeEndTime<=Bu.now())continue;const J=this.findLoadedParent($,Math.max($.overscaledZ-cp.maxOverzooming,this._source.minzoom));J&&(this._addTile(J.tileID),I[J.tileID.key]=J.tileID),P[G]=$}const N=m[m.length-1].overscaledZ;for(const G in this._tiles){const $=this._tiles[G];if(_[G]||!$.hasData())continue;let W=$.tileID;for(;W.overscaledZ>N;){W=W.scaledTo(W.overscaledZ-1);const J=this._tiles[W.key];if(J&&J.hasData()&&P[W.key]){_[G]=$.tileID;break}}}for(const G in I)_[G]||(this._coveredTiles[G]=!0,_[G]=I[G])}for(const I in _)this._tiles[I].clearFadeHold();const E=function(I,P){const A=[];for(const N in I)N in P||A.push(N);return A}(this._tiles,_);for(const I of E){const P=this._tiles[I];P.hasSymbolBuckets&&!P.holdingForFade()?P.setHoldDuration(this.map._fadeDuration):P.hasSymbolBuckets&&!P.symbolFadeFinished()||this._removeTile(+I)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const c={};if(s.length===0)return c;const d={},m=s.reduce((A,N)=>Math.min(A,N.overscaledZ),1/0),_=s[0].overscaledZ,E=Math.max(_-cp.maxOverzooming,this._source.minzoom),I=Math.max(_+cp.maxUnderzooming,this._source.minzoom),P={};for(const A of s){const N=this._addTile(A);c[A.key]=A,N.hasData()||m<this._source.maxzoom&&(P[A.key]=A)}this._retainLoadedChildren(P,m,I,c);for(const A of s){let N=this._tiles[A.key];if(N.hasData())continue;if(A.canonical.z>=this._source.maxzoom){const $=A.children(this._source.maxzoom)[0],W=this.getTile($);if(W&&W.hasData()){c[$.key]=$;continue}}else{const $=A.children(this._source.maxzoom);if(c[$[0].key]&&c[$[1].key]&&c[$[2].key]&&c[$[3].key])continue}let G=N.wasRequested();for(let $=A.overscaledZ-1;$>=E;--$){const W=A.scaledTo($);if(d[W.key]||(d[W.key]=!0,N=this.getTile(W),!N&&G&&(N=this._addTile(W)),N&&(c[W.key]=W,G=N.wasRequested(),N.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const c=[];let d,m=this._tiles[s].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){d=this._loadedParentTiles[m.key];break}c.push(m.key);const _=m.scaledTo(m.overscaledZ-1);if(d=this._getLoadedTile(_),d)break;m=_}for(const _ of c)this._loadedParentTiles[_]=d}}_addTile(s){let c=this._tiles[s.key];if(c)return c;c=this._cache.getAndRemove(s),c&&(this._setTileReloadTimer(s.key,c),c.tileID=s,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,c)));const d=!!c;if(!d){const m=this.map?this.map.painter:null;c=new LS(s,this._source.tileSize*s.overscaleFactor(),this.transform.tileZoom,m,this._isRaster),this._loadTile(c,this._tileLoaded.bind(this,c,s.key,c.state))}return c?(c.uses++,this._tiles[s.key]=c,d||this._source.fire(new fh("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null}_setTileReloadTimer(s,c){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const d=c.getExpiryTimeout();d&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},d))}_removeTile(s){const c=this._tiles[s];c&&(c.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,c,d){const m=[],_=this.transform;if(!_)return m;const E=_.projection.name==="globe",I=Dc(_.center.lng);for(const P in this._tiles){const A=this._tiles[P];if(d&&A.clearQueryDebugViz(),A.holdingForFade())continue;let N;if(E){const G=A.tileID.canonical;if(G.z===0){const $=[Math.abs(Pe(I,...y_(G,-1))-I),Math.abs(Pe(I,...y_(G,1))-I)];N=[0,2*$.indexOf(Math.min(...$))-1]}else{const $=[Math.abs(Pe(I,...y_(G,-1))-I),Math.abs(Pe(I,...y_(G,0))-I),Math.abs(Pe(I,...y_(G,1))-I)];N=[$.indexOf(Math.min(...$))-1]}}else N=[0];for(const G of N){const $=s.containsTile(A,_,c,G);$&&m.push($)}}return m}getVisibleCoordinates(s){const c=this.getRenderableIds(s).map(d=>this._tiles[d].tileID);for(const d of c)d.projMatrix=this.transform.calculateProjMatrix(d.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(eL(this._source.type))for(const s in this._tiles){const c=this._tiles[s];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=Bu.now())return!0}return!1}setFeatureState(s,c,d){this._state.updateState(s=s||"_geojsonTileLayer",c,d)}removeFeatureState(s,c,d){this._state.removeFeatureState(s=s||"_geojsonTileLayer",c,d)}getFeatureState(s,c){return this._state.getState(s=s||"_geojsonTileLayer",c)}setDependencies(s,c,d){const m=this._tiles[s];m&&m.setDependencies(c,d)}reloadTilesForDependencies(s,c){for(const d in this._tiles)this._tiles[d].hasDependency(s,c)&&this._reloadTile(+d,"reloading");this._cache.filter(d=>!d.hasDependency(s,c))}_preloadTiles(s,c){if(!this._sourceLoaded){const I=()=>{this._sourceLoaded&&(this._source.off("data",I),this._preloadTiles(s,c))};return void this._source.on("data",I)}const d=new Map,m=Array.isArray(s)?s:[s],_=this.map.painter.terrain,E=this.usedForTerrain&&_?_.getScaledDemTileSize():this._source.tileSize;for(const I of m){const P=I.coveringTiles({tileSize:E,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const A of P)d.set(A.key,A);this.usedForTerrain&&I.updateElevation(!1)}Ue(Array.from(d.values()),(I,P)=>{const A=new LS(I,this._source.tileSize*I.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(A,N=>{this._source.type==="raster-dem"&&A.dem&&this._backfillDEM(A),P(N,A)})},c)}}function QM(u,s){const c=Math.abs(2*u.wrap)-+(u.wrap<0),d=Math.abs(2*s.wrap)-+(s.wrap<0);return u.overscaledZ-s.overscaledZ||d-c||s.canonical.y-u.canonical.y||s.canonical.x-u.canonical.x}function eL(u){return u==="raster"||u==="image"||u==="video"||u==="custom"}function y_(u,s){const c=1<<u.z;return[u.x/c+s,(u.x+1)/c+s]}cp.maxOverzooming=10,cp.maxUnderzooming=3;class Rx{constructor(s,c,d){this._demTile=s,this._dem=this._demTile.dem,this._scale=c,this._offset=d}static create(s,c,d){const m=d||s.findDEMTileFor(c);if(!m||!m.dem)return;const _=m.dem,E=m.tileID,I=1<<c.canonical.z-E.canonical.z;return new Rx(m,m.tileSize/bn/I,[(c.canonical.x/I-E.canonical.x)*_.dim,(c.canonical.y/I-E.canonical.y)*_.dim])}tileCoordToPixel(s,c){const d=c*this._scale+this._offset[1],m=Math.floor(s*this._scale+this._offset[0]),_=Math.floor(d);return new U(m,_)}getElevationAt(s,c,d,m){const _=s*this._scale+this._offset[0],E=c*this._scale+this._offset[1],I=Math.floor(_),P=Math.floor(E),A=this._dem;return m=!!m,d?mr(mr(A.get(I,P,m),A.get(I,P+1,m),E-P),mr(A.get(I+1,P,m),A.get(I+1,P+1,m),E-P),_-I):A.get(I,P,m)}getElevationAtPixel(s,c,d){return this._dem.get(s,c,!!d)}getMeterToDEM(s){return(1<<this._demTile.tileID.canonical.z)*Qu(1,s)*this._dem.stride}}class tL{constructor(s,c){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new _h(bn,16,0),this.featureIndexArray=new Jd,this.promoteId=c}insert(s,c,d,m,_,E=0){const I=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,m,_,E);const P=this.grid;for(let A=0;A<c.length;A++){const N=c[A],G=[1/0,1/0,-1/0,-1/0];for(let $=0;$<N.length;$++){const W=N[$];G[0]=Math.min(G[0],W.x),G[1]=Math.min(G[1],W.y),G[2]=Math.max(G[2],W.x),G[3]=Math.max(G[3],W.y)}G[0]<bn&&G[1]<bn&&G[2]>=0&&G[3]>=0&&P.insert(I,G[0],G[1],G[2],G[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new gS(new xx(this.rawTileData)).layers,this.sourceLayerCoder=new UM(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const s in this.vtLayers)this.vtFeatures[s]=[]}return this.vtLayers}query(s,c,d,m){this.loadVTLayers();const _=s.params||{},E=$g(_.filter),I=s.tileResult,P=s.transform,A=I.bufferedTilespaceBounds,N=this.grid.query(A.min.x,A.min.y,A.max.x,A.max.y,(J,te,se,me)=>IA(I.bufferedTilespaceGeometry,J,te,se,me));N.sort(JU);let G=null;P.elevation&&N.length>0&&(G=Rx.create(P.elevation,this.tileID));const $={};let W;for(let J=0;J<N.length;J++){const te=N[J];if(te===W)continue;W=te;const se=this.featureIndexArray.get(te);let me=null;this.loadMatchingFeature($,se,E,_.layers,_.availableImages,c,d,m,(Ie,ye,Se,Me=0)=>(me||(me=Ih(Ie,this.tileID.canonical,s.tileTransform)),ye.queryIntersectsFeature(I,Ie,Se,me,this.z,s.transform,s.pixelPosMatrix,G,Me)))}return $}loadMatchingFeature(s,c,d,m,_,E,I,P,A){const{featureIndex:N,bucketIndex:G,sourceLayerIndex:$,layoutVertexArrayOffset:W}=c,J=this.bucketLayerIDs[G];if(m&&!function(Ie,ye){for(let Se=0;Se<Ie.length;Se++)if(ye.indexOf(Ie[Se])>=0)return!0;return!1}(m,J))return;const te=this.sourceLayerCoder.decode($),se=this.vtLayers[te].feature(N);if(d.needGeometry){const Ie=ap(se,!0);if(!d.filter(new F(this.tileID.overscaledZ),Ie,this.tileID.canonical))return}else if(!d.filter(new F(this.tileID.overscaledZ),se))return;const me=this.getId(se,te);for(let Ie=0;Ie<J.length;Ie++){const ye=J[Ie];if(m&&m.indexOf(ye)<0)continue;const Se=E[ye];if(!Se)continue;let Me={};me!==void 0&&P&&(Me=P.getState(Se.sourceLayer||"_geojsonTileLayer",me));const Ae=xt({},I[ye]);Ae.paint=nL(Ae.paint,Se.paint,se,Me,_),Ae.layout=nL(Ae.layout,Se.layout,se,Me,_);const et=!A||A(se,Se,Me,W);if(!et)continue;const We=new VM(se,this.z,this.x,this.y,me);We.layer=Ae;let ft=s[ye];ft===void 0&&(ft=s[ye]=[]),ft.push({featureIndex:N,feature:We,intersectionZ:et})}}lookupSymbolFeatures(s,c,d,m,_,E,I,P){const A={};this.loadVTLayers();const N=$g(_);for(const G of s)this.loadMatchingFeature(A,{bucketIndex:d,sourceLayerIndex:m,featureIndex:G,layoutVertexArrayOffset:0},N,E,I,P,c);return A}loadFeature(s){const{featureIndex:c,sourceLayerIndex:d}=s;this.loadVTLayers();const m=this.sourceLayerCoder.decode(d),_=this.vtFeatures[m];if(_[c])return _[c];const E=this.vtLayers[m].feature(c);return _[c]=E,E}hasLayer(s){for(const c of this.bucketLayerIDs)for(const d of c)if(s===d)return!0;return!1}getId(s,c){let d=s.id;if(this.promoteId){const m=typeof this.promoteId=="string"?this.promoteId:this.promoteId[c];m!=null&&(d=s.properties[m]),typeof d=="boolean"&&(d=Number(d))}return d}}function nL(u,s,c,d,m){return Ut(u,(_,E)=>{const I=s instanceof ge?s.get(E):null;return I&&I.evaluate?I.evaluate(c,d,m):I})}function JU(u,s){return s-u}nn(tL,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class rL{constructor(s,c){this.width=s,this.height=c,this.nextRow=0,this.image=new Ch({width:s,height:c}),this.positions={},this.uploaded=!1}getDash(s,c){const d=this.getKey(s,c);return this.positions[d]}trim(){const s=this.width,c=this.height=Kt(this.nextRow);this.image.resize({width:s,height:c})}getKey(s,c){return s.join(",")+c}getDashRanges(s,c,d){const m=[];let _=s.length%2==1?-s[s.length-1]*d:0,E=s[0]*d,I=!0;m.push({left:_,right:E,isDash:I,zeroLength:s[0]===0});let P=s[0];for(let A=1;A<s.length;A++){I=!I;const N=s[A];_=P*d,P+=N,E=P*d,m.push({left:_,right:E,isDash:I,zeroLength:N===0})}return m}addRoundDash(s,c,d){const m=c/2;for(let _=-d;_<=d;_++){const E=this.width*(this.nextRow+d+_);let I=0,P=s[I];for(let A=0;A<this.width;A++){A/P.right>1&&(P=s[++I]);const N=Math.abs(A-P.left),G=Math.abs(A-P.right),$=Math.min(N,G);let W;const J=_/d*(m+1);if(P.isDash){const te=m-Math.abs(J);W=Math.sqrt($*$+te*te)}else W=m-Math.sqrt($*$+J*J);this.image.data[E+A]=Math.max(0,Math.min(255,W+128))}}}addRegularDash(s,c){for(let P=s.length-1;P>=0;--P){const A=s[P],N=s[P+1];A.zeroLength?s.splice(P,1):N&&N.isDash===A.isDash&&(N.left=A.left,s.splice(P,1))}const d=s[0],m=s[s.length-1];d.isDash===m.isDash&&(d.left=m.left-this.width,m.right=d.right+this.width);const _=this.width*this.nextRow;let E=0,I=s[E];for(let P=0;P<this.width;P++){P/I.right>1&&(I=s[++E]);const A=Math.abs(P-I.left),N=Math.abs(P-I.right),G=Math.min(A,N);this.image.data[_+P]=Math.max(0,Math.min(255,(I.isDash?G:-G)+c+128))}}addDash(s,c){const d=this.getKey(s,c);if(this.positions[d])return this.positions[d];const m=c==="round",_=m?7:0,E=2*_+1;if(this.nextRow+E>this.height)return nt("LineAtlas out of space"),null;s.length===0&&s.push(1);let I=0;for(let N=0;N<s.length;N++)s[N]<0&&(nt("Negative value is found in line dasharray, replacing values with 0"),s[N]=0),I+=s[N];if(I!==0){const N=this.width/I,G=this.getDashRanges(s,this.width,N);m?this.addRoundDash(G,N,_):this.addRegularDash(G,c==="square"?.5*N:0)}const P=this.nextRow+_;this.nextRow+=E;const A={tl:[P,_],br:[I,0]};return this.positions[d]=A,A}}nn(rL,"LineAtlas");const iL=1*tc;class oL{constructor(s){const c={},d=[];for(const I in s){const P=s[I],A=c[I]={};for(const N in P.glyphs){const G=P.glyphs[+N];if(!G||G.bitmap.width===0||G.bitmap.height===0)continue;const $=G.metrics.localGlyph?iL:1,W={x:0,y:0,w:G.bitmap.width+2*$,h:G.bitmap.height+2*$};d.push(W),A[N]=W}}const{w:m,h:_}=_S(d),E=new Ch({width:m||1,height:_||1});for(const I in s){const P=s[I];for(const A in P.glyphs){const N=P.glyphs[+A];if(!N||N.bitmap.width===0||N.bitmap.height===0)continue;const G=c[I][A],$=N.metrics.localGlyph?iL:1;Ch.copy(N.bitmap,E,{x:0,y:0},{x:G.x+$,y:G.y+$},N.bitmap)}}this.image=E,this.positions=c}}nn(oL,"GlyphAtlas");class QU{constructor(s){this.tileID=new us(s.tileID.overscaledZ,s.tileID.wrap,s.tileID.canonical.z,s.tileID.canonical.x,s.tileID.canonical.y),this.tileZoom=s.tileZoom,this.uid=s.uid,this.zoom=s.zoom,this.canonical=s.tileID.canonical,this.pixelRatio=s.pixelRatio,this.tileSize=s.tileSize,this.source=s.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=s.showCollisionBoxes,this.collectResourceTiming=!!s.collectResourceTiming,this.returnDependencies=!!s.returnDependencies,this.promoteId=s.promoteId,this.enableTerrain=!!s.enableTerrain,this.isSymbolTile=s.isSymbolTile,this.tileTransform=up(s.tileID.canonical,s.projection),this.projection=s.projection}parse(s,c,d,m,_){this.status="parsing",this.data=s,this.collisionBoxArray=new fi;const E=new UM(Object.keys(s.layers).sort()),I=new tL(this.tileID,this.promoteId);I.bucketLayerIDs=[];const P={},A=new rL(256,256),N={featureIndex:I,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:A,availableImages:d},G=c.familiesBySource[this.source];for(const Me in G){const Ae=s.layers[Me];if(!Ae)continue;let et=!1,We=!1;for(const it of G[Me])it[0].type==="symbol"?et=!0:We=!0;if(this.isSymbolTile===!0&&!et||this.isSymbolTile===!1&&!We)continue;Ae.version===1&&nt(`Vector tile source "${this.source}" layer "${Me}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ft=E.encode(Me),St=[];for(let it=0;it<Ae.length;it++){const mt=Ae.feature(it),yt=I.getId(mt,Me);St.push({feature:mt,id:yt,index:it,sourceLayerIndex:ft})}for(const it of G[Me]){const mt=it[0];this.isSymbolTile!==void 0&&mt.type==="symbol"!==this.isSymbolTile||mt.minzoom&&this.zoom<Math.floor(mt.minzoom)||mt.maxzoom&&this.zoom>=mt.maxzoom||mt.visibility!=="none"&&(NS(it,this.zoom,d),(P[mt.id]=mt.createBucket({index:I.bucketLayerIDs.length,layers:it,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ft,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:d})).populate(St,N,this.tileID.canonical,this.tileTransform),I.bucketLayerIDs.push(it.map(yt=>yt.id)))}}let $,W,J,te;A.trim();const se={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},me=()=>{if($)return _($);if(W&&J&&te){const Me=new oL(W),Ae=new fM(J,te);for(const et in P){const We=P[et];We instanceof Bf?(NS(We.layers,this.zoom,d),TU(We,W,Me.positions,J,Ae.iconPositions,this.showCollisionBoxes,d,this.tileID.canonical,this.tileZoom,this.projection)):We.hasPattern&&(We instanceof yx||We instanceof fx||We instanceof o_)&&(NS(We.layers,this.zoom,d),We.addFeatures(N,this.tileID.canonical,Ae.patternPositions,d,this.tileTransform))}this.status="done",_(null,{buckets:lt(P).filter(et=>!et.isEmpty()),featureIndex:I,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Me.image,lineAtlas:A,imageAtlas:Ae,glyphMap:this.returnDependencies?W:null,iconMap:this.returnDependencies?J:null,glyphPositions:this.returnDependencies?Me.positions:null})}},Ie=Ut(N.glyphDependencies,Me=>Object.keys(Me).map(Number));Object.keys(Ie).length?m.send("getGlyphs",{uid:this.uid,stacks:Ie},(Me,Ae)=>{$||($=Me,W=Ae,me())},void 0,!1,se):W={};const ye=Object.keys(N.iconDependencies);ye.length?m.send("getImages",{icons:ye,source:this.source,tileID:this.tileID,type:"icons"},(Me,Ae)=>{$||($=Me,J=Ae,me())},void 0,!1,se):J={};const Se=Object.keys(N.patternDependencies);Se.length?m.send("getImages",{icons:Se,source:this.source,tileID:this.tileID,type:"patterns"},(Me,Ae)=>{$||($=Me,te=Ae,me())},void 0,!1,se):te={},me()}}function NS(u,s,c){const d=new F(s);for(const m of u)m.recalculate(d,c)}class aL{constructor(s){this.entries={},this.scheduler=s}request(s,c,d,m){const _=this.entries[s]=this.entries[s]||{callbacks:[]};if(_.result){const[E,I]=_.result;return this.scheduler?this.scheduler.add(()=>{m(E,I)},c):m(E,I),()=>{}}return _.callbacks.push(m),_.cancel||(_.cancel=d((E,I)=>{_.result=[E,I];for(const P of _.callbacks)this.scheduler?this.scheduler.add(()=>{P(E,I)},c):P(E,I);setTimeout(()=>delete this.entries[s],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(E=>E!==m),_.callbacks.length||(_.cancel(),delete this.entries[s]))}}}function sL(u,s,c){const d=JSON.stringify(u.request);return u.data&&(this.deduped.entries[d]={result:[null,u.data]}),this.deduped.request(d,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom},m=>{const _=Fu(u.request,(E,I,P,A)=>{E?m(E):I&&m(null,{vectorTile:c?void 0:new gS(new xx(I)),rawData:I,cacheControl:P,expires:A})});return()=>{_.cancel(),m()}},s)}const lL=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class FS{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,d]=new Uint8Array(s,0,2);if(c!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=d>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const _=lL[15&d];if(!_)throw new Error("Unrecognized array type.");const[E]=new Uint16Array(s,2,1),[I]=new Uint32Array(s,4,1);return new FS(I,E,_,s)}constructor(s,c=64,d=Float64Array,m){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=d,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const _=lL.indexOf(this.ArrayType),E=2*s*this.ArrayType.BYTES_PER_ELEMENT,I=s*this.IndexArrayType.BYTES_PER_ELEMENT,P=(8-I%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${d}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+I+P,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+E+I+P),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+I+P,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=s)}add(s,c){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=s,this.coords[this._pos++]=c,d}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return BS(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,c,d,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:E,nodeSize:I}=this,P=[0,_.length-1,0],A=[];for(;P.length;){const N=P.pop()||0,G=P.pop()||0,$=P.pop()||0;if(G-$<=I){for(let se=$;se<=G;se++){const me=E[2*se],Ie=E[2*se+1];me>=s&&me<=d&&Ie>=c&&Ie<=m&&A.push(_[se])}continue}const W=$+G>>1,J=E[2*W],te=E[2*W+1];J>=s&&J<=d&&te>=c&&te<=m&&A.push(_[W]),(N===0?s<=J:c<=te)&&(P.push($),P.push(W-1),P.push(1-N)),(N===0?d>=J:m>=te)&&(P.push(W+1),P.push(G),P.push(1-N))}return A}within(s,c,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:_,nodeSize:E}=this,I=[0,m.length-1,0],P=[],A=d*d;for(;I.length;){const N=I.pop()||0,G=I.pop()||0,$=I.pop()||0;if(G-$<=E){for(let se=$;se<=G;se++)cL(_[2*se],_[2*se+1],s,c)<=A&&P.push(m[se]);continue}const W=$+G>>1,J=_[2*W],te=_[2*W+1];cL(J,te,s,c)<=A&&P.push(m[W]),(N===0?s-d<=J:c-d<=te)&&(I.push($),I.push(W-1),I.push(1-N)),(N===0?s+d>=J:c+d>=te)&&(I.push(W+1),I.push(G),I.push(1-N))}return P}}function BS(u,s,c,d,m,_){if(m-d<=c)return;const E=d+m>>1;uL(u,s,E,d,m,_),BS(u,s,c,d,E-1,1-_),BS(u,s,c,E+1,m,1-_)}function uL(u,s,c,d,m,_){for(;m>d;){if(m-d>600){const A=m-d+1,N=c-d+1,G=Math.log(A),$=.5*Math.exp(2*G/3),W=.5*Math.sqrt(G*$*(A-$)/A)*(N-A/2<0?-1:1);uL(u,s,c,Math.max(d,Math.floor(c-N*$/A+W)),Math.min(m,Math.floor(c+(A-N)*$/A+W)),_)}const E=s[2*c+_];let I=d,P=m;for(v_(u,s,d,c),s[2*m+_]>E&&v_(u,s,d,m);I<P;){for(v_(u,s,I,P),I++,P--;s[2*I+_]<E;)I++;for(;s[2*P+_]>E;)P--}s[2*d+_]===E?v_(u,s,d,P):(P++,v_(u,s,P,m)),P<=c&&(d=P+1),c<=P&&(m=P-1)}}function v_(u,s,c,d){zS(u,c,d),zS(s,2*c,2*d),zS(s,2*c+1,2*d+1)}function zS(u,s,c){const d=u[s];u[s]=u[c],u[c]=d}function cL(u,s,c,d){const m=u-c,_=s-d;return m*m+_*_}o.ARRAY_TYPE=Xs,o.AUTH_ERR_MSG=Le,o.Aabb=ls,o.Actor=class{constructor(u,s,c){this.target=u,this.parent=s,this.mapId=c,this.callbacks={},this.cancelCallbacks={},dt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Dt()?u:f,this.scheduler=new ZU}send(u,s,c,d,m=!1,_){const E=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=_,this.callbacks[E]=c);const I=Tt(this.globalScope)?void 0:[];return this.target.postMessage({id:E,type:u,hasCallback:!!c,targetMapId:d,mustQueue:m,sourceMapId:this.mapId,data:Mf(s,I)},I),{cancel:()=>{c&&delete this.callbacks[E],this.target.postMessage({id:E,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}receive(u){const s=u.data,c=s.id;if(c&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const d=this.cancelCallbacks[c];delete this.cancelCallbacks[c],d&&d.cancel()}else if(s.mustQueue||Dt()){const d=this.callbacks[c];this.cancelCallbacks[c]=this.scheduler.add(()=>this.processTask(c,s),d&&d.metadata||{type:"message"})}else this.processTask(c,s)}processTask(u,s){if(s.type==="<response>"){const c=this.callbacks[u];delete this.callbacks[u],c&&(s.error?c(xh(s.error)):c(null,xh(s.data)))}else{const c=Tt(this.globalScope)?void 0:[],d=s.hasCallback?(_,E)=>{delete this.cancelCallbacks[u],this.target.postMessage({id:u,type:"<response>",sourceMapId:this.mapId,error:_?Mf(_):null,data:Mf(E,c)},c)}:_=>{},m=xh(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,m,d);else if(this.parent.getWorkerSource){const _=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,_[0],m.source)[_[1]](m,d)}else d(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.CanonicalTileID=mx,o.Color=uo,o.ColorMode=Fc,o.CullFaceMode=nc,o.DEMData=Dx,o.DataConstantProperty=ee,o.DedupedRequest=aL,o.DepthMode=pm,o.EXTENT=bn,o.Elevation=class{isDataAvailableAtPoint(u){const s=this._source();if(this.isUsingMockSource()||!s||u.y<0||u.y>1)return!1;const c=s.getSource().maxzoom,d=1<<c,m=Math.floor(u.x),_=Math.floor((u.x-m)*d),E=Math.floor(u.y*d),I=this.findDEMTileFor(new us(c,m,c,_,E));return!(!I||!I.dem)}getAtPointOrZero(u,s=0){return this.getAtPoint(u,s)||0}getAtPoint(u,s,c=!0){if(this.isUsingMockSource())return null;s==null&&(s=null);const d=this._source();if(!d||u.y<0||u.y>1)return s;const m=d.getSource().maxzoom,_=1<<m,E=Math.floor(u.x),I=u.x-E,P=new us(m,E,m,Math.floor(I*_),Math.floor(u.y*_)),A=this.findDEMTileFor(P);if(!A||!A.dem)return s;const N=A.dem,G=1<<A.tileID.canonical.z,$=(I*G-A.tileID.canonical.x)*N.dim,W=(u.y*G-A.tileID.canonical.y)*N.dim,J=Math.floor($),te=Math.floor(W);return(c?this.exaggeration():1)*mr(mr(N.get(J,te),N.get(J,te+1),W-te),mr(N.get(J+1,te),N.get(J+1,te+1),W-te),$-J)}getAtTileOffset(u,s,c){const d=1<<u.canonical.z;return this.getAtPointOrZero(new em(u.wrap+(u.canonical.x+s/bn)/d,(u.canonical.y+c/bn)/d))}getAtTileOffsetFunc(u,s,c,d){return m=>{const _=this.getAtTileOffset(u,m.x,m.y),E=d.upVector(u.canonical,m.x,m.y);return vl(E,E,_*d.upVectorScale(u.canonical,s,c).metersToTile),E}}getForTilePoints(u,s,c,d){if(this.isUsingMockSource())return!1;const m=Rx.create(this,u,d);return!!m&&(s.forEach(_=>{_[2]=this.exaggeration()*m.getElevationAt(_[0],_[1],c)}),!0)}getMinMaxForTile(u){if(this.isUsingMockSource())return null;const s=this.findDEMTileFor(u);if(!s||!s.dem)return null;const c=s.dem.tree,d=s.tileID,m=1<<u.canonical.z-d.canonical.z;let _=u.canonical.x/m-d.canonical.x,E=u.canonical.y/m-d.canonical.y,I=0;for(let P=0;P<u.canonical.z-d.canonical.z&&!c.leaves[I];P++){_*=2,E*=2;const A=2*Math.floor(E)+Math.floor(_);I=c.childOffsets[I]+A,_%=1,E%=1}return{min:this.exaggeration()*c.minimums[I],max:this.exaggeration()*c.maximums[I]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(u,s,c){throw new Error("Pure virtual method called.")}pointCoordinate(u){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(u){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},o.ErrorEvent=zu,o.EvaluationParameters=F,o.Event=fh,o.Evented=Cd,o.FillExtrusionBucket=o_,o.Frustum=ZE,o.FrustumCorners=qE,o.GLOBE_RADIUS=Lc,o.GLOBE_SCALE_MATCH_LATITUDE=45,o.GLOBE_ZOOM_THRESHOLD_MAX=uA,o.GLOBE_ZOOM_THRESHOLD_MIN=XE,o.GlobeSharedBuffers=class{constructor(u){this._createGrid(u),this._createPoles(u)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const u of this._poleSegments)u.destroy();for(const u of this._gridSegments)u.withSkirts.destroy(),u.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const u of this._wireframeSegments)u.destroy()}}_fillGridMeshWithLods(u,s){const c=new Et,d=new gn,m=[],_=u+1+2,E=s[0]+1,I=s[0]+1+(1+s.length),P=(A,N,G)=>{let $=A===_-1?A-2:A===0?A:A-1;return $+=G?24575:0,[$,N]};for(let A=0;A<_;++A)c.emplaceBack(...P(A,0,!0));for(let A=0;A<E;++A)for(let N=0;N<_;++N)c.emplaceBack(...P(N,A,(N===0||N===_-1)&&!0));for(let A=0;A<s.length;++A){const N=s[A];for(let G=0;G<_;++G)c.emplaceBack(...P(G,N,!0))}for(let A=0;A<s.length;++A){const N=d.length,G=s[A]+1+2,$=new gn;for(let te=0;te<G-1;te++){const se=te===G-2,me=se?_*(I-s.length+A-te):_;for(let Ie=0;Ie<_-1;Ie++){const ye=te*_+Ie;te===0||se||Ie===0||Ie===_-2?($.emplaceBack(ye+1,ye,ye+me),$.emplaceBack(ye+me,ye+me+1,ye+1)):(d.emplaceBack(ye+1,ye,ye+me),d.emplaceBack(ye+me,ye+me+1,ye+1))}}const W=wo.simpleSegment(0,N,c.length,d.length-N);for(let te=0;te<$.uint16.length;te+=3)d.emplaceBack($.uint16[te],$.uint16[te+1],$.uint16[te+2]);const J=wo.simpleSegment(0,N,c.length,d.length-N);m.push({withoutSkirts:W,withSkirts:J})}return{vertices:c,indices:d,segments:m}}_createGrid(u){const s=this._fillGridMeshWithLods(ip,Hv);this._gridSegments=s.segments,this._gridBuffer=u.createVertexBuffer(s.vertices,Wv.members),this._gridIndexBuffer=u.createIndexBuffer(s.indices,!0)}_createPoles(u){const s=new gn;for(let m=0;m<=ip;m++)s.emplaceBack(0,m+1,m+2);this._poleIndexBuffer=u.createIndexBuffer(s,!0);const c=new hi,d=new hi;this._poleSegments=[];for(let m=0,_=0;m<XE;m++){const E=360/(1<<m);c.emplaceBack(0,-Lc,0,.5,0),d.emplaceBack(0,-Lc,0,.5,1);for(let I=0;I<=ip;I++){const P=I/ip,A=mr(0,E,P),[N,G,$]=Kg(Zz,Xz,A,Lc);c.emplaceBack(N,G,$,P,0),d.emplaceBack(N,G,$,P,1)}this._poleSegments.push(wo.simpleSegment(_,0,66,64)),_+=66}this._poleNorthVertexBuffer=u.createVertexBuffer(c,sA,!1),this._poleSouthVertexBuffer=u.createVertexBuffer(d,sA,!1)}getGridBuffers(u,s){return[this._gridBuffer,this._gridIndexBuffer,s?this._gridSegments[u].withSkirts:this._gridSegments[u].withoutSkirts]}getPoleBuffers(u){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[u]]}getWirefameBuffers(u,s){if(!this._wireframeSegments){const c=new Jo,d=ip,m=d+1+2,_=1;this._wireframeSegments=[];for(let E=0,I=0;E<Hv.length;E++){const P=Hv[E];for(let N=_;N<P+_;N++)for(let G=_;G<d+_;G++){const $=N*m+G;c.emplaceBack($,$+1),c.emplaceBack($,$+m),c.emplaceBack($,$+m+1)}const A=P*d*3;this._wireframeSegments.push(wo.simpleSegment(0,I,(P+1)*m,A)),I+=A}this._wireframeIndexBuffer=u.createIndexBuffer(c)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[s]]}},o.GlyphManager=um,o.ImagePosition=xS,o.KDBush=FS,o.LivePerformanceUtils=dE,o.LngLat=di,o.LngLatBounds=Rf,o.LocalGlyphMode=ES,o.MAX_MERCATOR_LATITUDE=Ma,o.MercatorCoordinate=em,o.ONE_EM=ga,o.OverscaledTileID=us,o.PerformanceMarkers=df,o.Point=U,o.Properties=xe,o.RGBAImage=Ws,o.Ray=jE,o.RequestManager=class{constructor(u,s,c){this._transformRequestFn=u,this._customAccessToken=s,this._silenceAuthErrors=!!c,this._createSkuToken()}_createSkuToken(){const u=function(){let s="";for(let c=0;c<10;c++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",M,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=u.token,this._skuTokenExpiresAt=u.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(u,s){return this._transformRequestFn&&this._transformRequestFn(u,s)||{url:u}}normalizeStyleURL(u,s){if(!Fe(u))return u;const c=zt(u);return c.path=`/styles/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||s)}normalizeGlyphsURL(u,s){if(!Fe(u))return u;const c=zt(u);return c.path=`/fonts/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||s)}normalizeSourceURL(u,s,c,d){if(!Fe(u))return u;const m=zt(u);return m.path=`/v4/${m.authority}.json`,m.params.push("secure"),c&&m.params.push(`language=${c}`),d&&m.params.push(`worldview=${d}`),this._makeAPIURL(m,this._customAccessToken||s)}normalizeSpriteURL(u,s,c,d){const m=zt(u);return Fe(u)?(m.path=`/styles/v1${m.path}/sprite${s}${c}`,this._makeAPIURL(m,this._customAccessToken||d)):(m.path+=`${s}${c}`,At(m))}normalizeTileURL(u,s,c){if(this._isSkuTokenExpired()&&this._createSkuToken(),u&&!Fe(u))return u;const d=zt(u);d.path=d.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${s||c&&d.authority!=="raster"&&c===512?"@2x":""}${w.supported?".webp":"$1"}`),d.authority==="raster"?d.path=`/${x.RASTER_URL_PREFIX}${d.path}`:(d.path=d.path.replace(/^.+\/v4\//,"/"),d.path=`/${x.TILE_URL_VERSION}${d.path}`);const m=this._customAccessToken||function(_){for(const E of _){const I=E.match(/^access_token=(.*)$/);if(I)return I[1]}return null}(d.params)||x.ACCESS_TOKEN;return x.REQUIRE_ACCESS_TOKEN&&m&&this._skuToken&&d.params.push(`sku=${this._skuToken}`),this._makeAPIURL(d,m)}canonicalizeTileURL(u,s){const c=zt(u);if(!c.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!c.path.match(/\.[\w]+$/))return u;let d="mapbox://";c.path.match(/^\/raster\/v1\//)?d+=`raster/${c.path.replace(`/${x.RASTER_URL_PREFIX}/`,"")}`:d+=`tiles/${c.path.replace(`/${x.TILE_URL_VERSION}/`,"")}`;let m=c.params;return s&&(m=m.filter(_=>!_.match(/^access_token=/))),m.length&&(d+=`?${m.join("&")}`),d}canonicalizeTileset(u,s){const c=!!s&&Fe(s),d=[];for(const m of u.tiles||[])Ze(m)?d.push(this.canonicalizeTileURL(m,c)):d.push(m);return d}_makeAPIURL(u,s){const c="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",d=zt(x.API_URL);if(u.protocol=d.protocol,u.authority=d.authority,u.protocol==="http"){const m=u.params.indexOf("secure");m>=0&&u.params.splice(m,1)}if(d.path!=="/"&&(u.path=`${d.path}${u.path}`),!x.REQUIRE_ACCESS_TOKEN)return At(u);if(s=s||x.ACCESS_TOKEN,!this._silenceAuthErrors){if(!s)throw new Error(`An API access token is required to use Mapbox GL. ${c}`);if(s[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${c}`)}return u.params=u.params.filter(m=>m.indexOf("access_token")===-1),u.params.push(`access_token=${s||""}`),At(u)}},o.ResourceType=Ts,o.SegmentVector=wo,o.SourceCache=cp,o.StencilMode=DS,o.StructArrayLayout1ui2=Zs,o.StructArrayLayout2f1f2i16=En,o.StructArrayLayout2i4=Et,o.StructArrayLayout2ui4=Jo,o.StructArrayLayout3f12=Kn,o.StructArrayLayout3ui6=gn,o.StructArrayLayout4i8=gt,o.StructArrayLayout5f20=hi,o.Texture=m_,o.Tile=LS,o.Transitionable=Q,o.Uniform1f=Q1,o.Uniform1i=class extends Eh{constructor(u){super(u),this.current=0}set(u,s,c){this.fetchUniformLocation(u,s)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},o.Uniform2f=class extends Eh{constructor(u){super(u),this.current=[0,0]}set(u,s,c){this.fetchUniformLocation(u,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}},o.Uniform3f=class extends Eh{constructor(u){super(u),this.current=[0,0,0]}set(u,s,c){this.fetchUniformLocation(u,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}},o.Uniform4f=jP,o.UniformColor=qP,o.UniformMatrix2f=class extends Eh{constructor(u){super(u),this.current=Mz}set(u,s,c){if(this.fetchUniformLocation(u,s)){for(let d=0;d<4;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}},o.UniformMatrix3f=class extends Eh{constructor(u){super(u),this.current=Az}set(u,s,c){if(this.fetchUniformLocation(u,s)){for(let d=0;d<9;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}}},o.UniformMatrix4f=class extends Eh{constructor(u){super(u),this.current=Pz}set(u,s,c){if(this.fetchUniformLocation(u,s)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let d=1;d<16;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}},o.UnwrappedTileID=KA,o.ValidationError=Yt,o.VectorTileFeature=px,o.VectorTileWorkerSource=class extends Cd{constructor(u,s,c,d,m){super(),this.actor=u,this.layerIndex=s,this.availableImages=c,this.loadVectorData=m||sL,this.loading={},this.loaded={},this.deduped=new aL(u.scheduler),this.isSpriteLoaded=d,this.scheduler=u.scheduler}loadTile(u,s){const c=u.uid,d=u&&u.request,m=d&&d.collectResourceTiming,_=this.loading[c]=new QU(u);_.abort=this.loadVectorData(u,(E,I)=>{const P=!this.loading[c];if(delete this.loading[c],P||E||!I)return _.status="done",P||(this.loaded[c]=_),s(E);const A=I.rawData,N={};I.expires&&(N.expires=I.expires),I.cacheControl&&(N.cacheControl=I.cacheControl),_.vectorTile=I.vectorTile||new gS(new xx(A));const G=()=>{_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,($,W)=>{if($||!W)return s($);const J={};if(m){const te=qy(d);te.length>0&&(J.resourceTiming=JSON.parse(JSON.stringify(te)))}s(null,xt({rawTileData:A.slice(0)},W,N,J))})};this.isSpriteLoaded?G():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(G,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom}):G()}),this.loaded=this.loaded||{},this.loaded[c]=_})}reloadTile(u,s){const c=this.loaded,d=u.uid,m=this;if(c&&c[d]){const _=c[d];_.showCollisionBoxes=u.showCollisionBoxes,_.enableTerrain=!!u.enableTerrain,_.projection=u.projection,_.tileTransform=up(u.tileID.canonical,u.projection);const E=(I,P)=>{const A=_.reloadCallback;A&&(delete _.reloadCallback,_.parse(_.vectorTile,m.layerIndex,this.availableImages,m.actor,A)),s(I,P)};_.status==="parsing"?_.reloadCallback=E:_.status==="done"&&(_.vectorTile?_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,E):E())}}abortTile(u,s){const c=u.uid,d=this.loading[c];d&&(d.abort&&d.abort(),delete this.loading[c]),s()}removeTile(u,s){const c=this.loaded,d=u.uid;c&&c[d]&&delete c[d],s()}},o.WritingMode=xl,o.ZoomDependentExpression=qd,o.add=Th,o.addDynamicAttributes=Mx,o.adjoint=function(u,s){var c=s[0],d=s[1],m=s[2],_=s[3],E=s[4],I=s[5],P=s[6],A=s[7],N=s[8];return u[0]=E*N-I*A,u[1]=m*A-d*N,u[2]=d*I-m*E,u[3]=I*P-_*N,u[4]=c*N-m*P,u[5]=m*_-c*I,u[6]=_*A-E*P,u[7]=d*P-c*A,u[8]=c*E-d*_,u},o.asyncAll=Ue,o.bezier=Oe,o.bindAll=dt,o.boundsAttributes=$M,o.bufferConvexPolygon=function(u,s){const c=[];for(let d=0;d<u.length;d++){const m=Be(d-1,-1,u.length-1),_=Be(d+1,-1,u.length-1),E=u[d],I=u[_],P=u[m].sub(E).unit(),A=I.sub(E).unit(),N=A.angleWithSep(P.x,P.y),G=P.add(A).unit().mult(-1*s/Math.sin(N/2));c.push(E.add(G))}return c},o.cacheEntryPossiblyAdded=function(u){Cc++,Cc>Wn&&(u.getActor().send("enforceCacheSizeLimit",Mn),Cc=0)},o.calculateGlobeLabelMatrix=function(u,s){const{x:c,y:d}=u.point,m=pA(c,d,u.worldSize/u._pixelsPerMercatorPixel,0,0);return tp(m,m,YE(Oc(s)))},o.calculateGlobeMatrix=function(u){const{x:s,y:c}=u.point,{lng:d,lat:m}=u._center;return pA(s,c,u.worldSize,d,m)},o.calculateGlobeMercatorMatrix=function(u){const s=u.pixelsPerMeter,c=s/Qu(1,u.center.lat),d=Ku(new Float64Array(16));return Gv(d,d,[u.point.x,u.point.y,0]),np(d,d,[c,c,s]),Float32Array.from(d)},o.circumferenceAtLatitude=JE,o.clamp=Pe,o.clearTileCache=function(u){if(!ki())return;const s=f.caches.delete(xn);u&&s.catch(u).then(()=>u())},o.clipLine=TM,o.clone=function(u){var s=new Xs(16);return s[0]=u[0],s[1]=u[1],s[2]=u[2],s[3]=u[3],s[4]=u[4],s[5]=u[5],s[6]=u[6],s[7]=u[7],s[8]=u[8],s[9]=u[9],s[10]=u[10],s[11]=u[11],s[12]=u[12],s[13]=u[13],s[14]=u[14],s[15]=u[15],s},o.clone$1=Ce,o.collisionCircleLayout=K6,o.config=x,o.conjugate=function(u,s){return u[0]=-s[0],u[1]=-s[1],u[2]=-s[2],u[3]=s[3],u},o.create=function(){var u=new Xs(16);return Xs!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},o.create$1=WP,o.createExpression=Cf,o.createLayout=ze,o.createStyleLayer=function(u){return u.type==="custom"?new GU(u):new jU[u.type](u)},o.cross=$E,o.degToRad=ae,o.distance=function(u,s){return Math.hypot(s[0]-u[0],s[1]-u[1],s[2]-u[2])},o.div=function(u,s,c){return u[0]=s[0]/c[0],u[1]=s[1]/c[1],u[2]=s[2]/c[2],u},o.dot=Hl,o.earthRadius=Jv,o.ease=Ve,o.easeCubicInOut=He,o.ecefToLatLng=function([u,s,c]){const d=Math.hypot(u,s,c),m=Math.atan2(u,c),_=.5*Math.PI-Math.acos(-s/d);return new di(ve(m),ve(_))},o.emitValidationErrors=X1,o.endsWith=Jt,o.enforceCacheSizeLimit=function(u){Uo(),hr&&hr.then(s=>{s.keys().then(c=>{for(let d=0;d<c.length-u;d++)s.delete(c[d])})})},o.evaluateSizeForFeature=vx,o.evaluateSizeForZoom=om,o.evaluateVariableOffset=MM,o.evented=T,o.exactEquals=function(u,s){return u[0]===s[0]&&u[1]===s[1]&&u[2]===s[2]&&u[3]===s[3]},o.exactEquals$1=function(u,s){return u[0]===s[0]&&u[1]===s[1]&&u[2]===s[2]},o.exported=Bu,o.exported$1=w,o.extend=xt,o.extend$1=Uu,o.fillExtrusionHeightLift=WA,o.filterObject=we,o.fromMat4=function(u,s){return u[0]=s[0],u[1]=s[1],u[2]=s[2],u[3]=s[4],u[4]=s[5],u[5]=s[6],u[6]=s[8],u[7]=s[9],u[8]=s[10],u},o.fromQuat=function(u,s){var c=s[0],d=s[1],m=s[2],_=s[3],E=c+c,I=d+d,P=m+m,A=c*E,N=d*E,G=d*I,$=m*E,W=m*I,J=m*P,te=_*E,se=_*I,me=_*P;return u[0]=1-G-J,u[1]=N+me,u[2]=$-se,u[3]=0,u[4]=N-me,u[5]=1-A-J,u[6]=W+te,u[7]=0,u[8]=$+se,u[9]=W-te,u[10]=1-A-G,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},o.fromRotation=function(u,s){var c=Math.sin(s),d=Math.cos(s);return u[0]=d,u[1]=c,u[2]=0,u[3]=-c,u[4]=d,u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},o.fromScaling=YP,o.furthestTileCorner=function(u){const s=Math.round((u+45+360)%360/90)%4;return Ee[s]},o.getAABBPointSquareDist=function(u,s,c){let d=0;for(let m=0;m<2;++m){const _=c?c[m]:0;u[m]>_&&(d+=(u[m]-_)*(u[m]-_)),s[m]<_&&(d+=(_-s[m])*(_-s[m]))}return d},o.getAnchorAlignment=wS,o.getAnchorJustification=TS,o.getBounds=function(u){let s=1/0,c=1/0,d=-1/0,m=-1/0;for(const _ of u)s=Math.min(s,_.x),c=Math.min(c,_.y),d=Math.max(d,_.x),m=Math.max(m,_.y);return{min:new U(s,c),max:new U(d,m)}},o.getColumn=un,o.getDefaultExportFromCjs=k,o.getGridMatrix=function(u,s,c,d){const m=s.getNorth(),_=s.getSouth(),E=s.getWest(),I=s.getEast(),P=1<<u.z,A=I-E,N=m-_,G=A/ip,$=-N/Hv[c],W=[0,G,0,$,0,0,m,E,0];if(u.z>0){const J=180/d;HP(W,W,[J/A+1,0,0,0,J/N+1,0,-.5*J/G,.5*J/$,1])}return W[2]=P,W[5]=u.x,W[8]=u.y,W},o.getImage=be,o.getJSON=function(u,s){return Wo(xt(u,{type:"json"}),s)},o.getLatitudinalLod=function(u){const s=Ma-5;u=Pe(u,-s,s)/s*90;const c=Math.pow(Math.abs(Math.sin(ae(u))),3);return Math.round(c*(Hv.length-1))},o.getMapSessionAPI=Ho,o.getPerformanceMeasurement=qy,o.getProjection=BM,o.getRTLTextPluginStatus=C,o.getReferrer=vo,o.getTilePoint=function(u,{x:s,y:c},d=0){return new U(((s-d)*u.scale-u.x)*bn,(c*u.scale-u.y)*bn)},o.getTileVec3=function(u,s,c=0){return Yg(((s.x-c)*u.scale-u.x)*bn,(s.y*u.scale-u.y)*bn,vA(s.z,s.y))},o.getVideo=function(u,s){const c=f.document.createElement("video");c.muted=!0,c.onloadstart=function(){s(null,c)};for(let d=0;d<u.length;d++){const m=f.document.createElement("source");vg(u[d])||(c.crossOrigin="Anonymous"),m.src=u[d],c.appendChild(m)}return{cancel:()=>{}}},o.globeCenterToScreenPoint=function(u){const s=[0,0,0],c=Ku(new Float64Array(16));return tp(c,u.pixelMatrix,u.globeMatrix),co(s,s,c),new U(s[0],s[1])},o.globeDenormalizeECEF=YE,o.globeECEFOrigin=function(u,s){const c=[0,0,0];return co(c,c,Kv(Oc(s.canonical))),co(c,c,u),c},o.globeMetersToEcef=nx,o.globeNormalizeECEF=Kv,o.globePixelsToTileUnits=function(u,s){return bn/(512*Math.pow(2,u))*ix(Oc(s))},o.globePoleMatrixForTile=function(u,s,c){const d=Ku(new Float64Array(16)),m=(s/(1<<u)-.5)*Math.PI*2;return tx(d,c.globeMatrix,m),Float32Array.from(d)},o.globeTileBounds=Oc,o.globeTiltAtLngLat=gA,o.globeToMercatorTransition=Qg,o.globeUseCustomAntiAliasing=function(u,s,c){const d=Qg(c.zoom),m=u.style.map._antialias,_=!!s.extStandardDerivatives,E=s.extStandardDerivativesForceOff||u.terrain&&u.terrain.exaggeration()>0;return d===0&&!m&&!E&&_},o.identity=Ku,o.identity$1=iA,o.invert=zE,o.isFullscreen=function(){return!!f.document.fullscreenElement||!!f.document.webkitFullscreenElement},o.isLngLatBehindGlobe=KE,o.isMapAuthenticated=function(u){return Xa.has(u)},o.isMapboxURL=Fe,o.isSafariWithAntialiasingBug=function(u){const s=u.navigator?u.navigator.userAgent:null;return!!Tt(u)&&s&&(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.latFromMercatorY=Aa,o.latLngToECEF=Jg,o.len=zz,o.length=$v,o.length$1=function(u){return Math.hypot(u[0],u[1],u[2],u[3])},o.lngFromMercatorX=_l,o.loadVectorTile=sL,o.makeRequest=Wo,o.mapValue=function(u,s,c,d,m){return Pe((u-s)/(c-s)*(m-d)+d,d,m)},o.mercatorScale=_A,o.mercatorXfromLng=Dc,o.mercatorYfromLat=Rc,o.mercatorZfromAltitude=Qu,o.mul=Fz,o.mul$1=Bz,o.multiply=tp,o.multiply$1=HP,o.multiply$2=QP,o.nextPowerOfTwo=Kt,o.normalize=ss,o.normalize$1=Uz,o.normalize$2=nA,o.number=mr,o.ortho=function(u,s,c,d,m,_,E){var I=1/(s-c),P=1/(d-m),A=1/(_-E);return u[0]=-2*I,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*P,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*A,u[11]=0,u[12]=(s+c)*I,u[13]=(m+d)*P,u[14]=(E+_)*A,u[15]=1,u},o.pbf=iM,o.perspective=function(u,s,c,d,m){var _,E=1/Math.tan(s/2);return u[0]=E/c,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=E,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,m!=null&&m!==1/0?(u[10]=(m+d)*(_=1/(d-m)),u[14]=2*m*d*_):(u[10]=-1,u[14]=-2*d),u},o.pick=function(u,s){const c={};for(let d=0;d<s.length;d++){const m=s[d];m in u&&(c[m]=u[m])}return c},o.plugin=R,o.pointGeometry=K,o.polesInViewport=function(u){const s=Ku(new Float64Array(16));tp(s,u.pixelMatrix,u.globeMatrix);const c=[0,Yl,0],d=[0,Kl,0];return co(c,c,s),co(d,d,s),[c[0]>0&&c[0]<=u.width&&c[1]>0&&c[1]<=u.height&&!KE(u,new di(u.center.lat,90)),d[0]>0&&d[0]<=u.width&&d[1]>0&&d[1]<=u.height&&!KE(u,new di(u.center.lat,-90))]},o.polygonContainsPoint=sp,o.polygonIntersectsBox=IA,o.polygonIntersectsPolygon=wA,o.polygonizeBounds=function(u,s,c=0,d=!0){const m=new U(c,c),_=u.sub(m),E=s.add(m),I=[_,new U(E.x,_.y),E,new U(_.x,E.y)];return d&&I.push(_.clone()),I},o.posAttributes=Wv,o.postMapLoadEvent=_o,o.postPerformanceEvent=No,o.postTurnstileEvent=lr,o.potpack=_S,o.prevPowerOfTwo=function(u){return u<=1?1:Math.pow(2,Math.floor(Math.log(u)/Math.LN2))},o.radToDeg=ve,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.registerForPluginStateChange=function(u){return u({pluginStatus:v,pluginURL:h}),T.on("pluginStateChange",u),u},o.removeAuthState=function(u){Xa.delete(u)},o.renderColorRamp=aS,o.resample=xA,o.rotateX=UE,o.rotateX$1=oA,o.rotateY=tx,o.rotateY$1=aA,o.rotateZ=function(u,s,c){var d=Math.sin(c),m=Math.cos(c),_=s[0],E=s[1],I=s[2],P=s[3],A=s[4],N=s[5],G=s[6],$=s[7];return s!==u&&(u[8]=s[8],u[9]=s[9],u[10]=s[10],u[11]=s[11],u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15]),u[0]=_*m+A*d,u[1]=E*m+N*d,u[2]=I*m+G*d,u[3]=P*m+$*d,u[4]=A*m-_*d,u[5]=N*m-E*d,u[6]=G*m-I*d,u[7]=$*m-P*d,u},o.rotateZ$1=function(u,s,c){c*=.5;var d=s[0],m=s[1],_=s[2],E=s[3],I=Math.sin(c),P=Math.cos(c);return u[0]=d*P+m*I,u[1]=m*P-d*I,u[2]=_*P+E*I,u[3]=E*P-_*I,u},o.scale=np,o.scale$1=tA,o.scale$2=vl,o.scaleAndAdd=Zv,o.set=function(u,s,c,d){return u[0]=s,u[1]=c,u[2]=d,u},o.setCacheLimits=function(u,s){Mn=u,Wn=s},o.setColumn=function(u,s,c){u[4*s+0]=c[0],u[4*s+1]=c[1],u[4*s+2]=c[2],u[4*s+3]=c[3]},o.setRTLTextPlugin=function(u,s,c=!1){if(v===Fv||v===Bv||v===zv)throw new Error("setRTLTextPlugin cannot be called multiple times.");h=Bu.resolveURL(u),v=Fv,Lf=s,b(),c||O()},o.smoothstep=Ke,o.spec=ct,o.squaredLength=function(u){var s=u[0],c=u[1],d=u[2];return s*s+c*c+d*d},o.storeAuthState=function(u,s){s?Xa.add(u):Xa.delete(u)},o.sub=Ju,o.subtract=GE,o.symbolSize=J6,o.tileAABB=function(u,s,c,d,m,_,E,I,P){if(P.name==="globe")return qz(u,s,new mx(c,d,m));const A=up({z:c,x:d,y:m},P);return new ls([(_+A.x/A.scale)*s,s*(A.y/A.scale),E],[(_+A.x2/A.scale)*s,s*(A.y2/A.scale),I])},o.tileCornersToBounds=rx,o.tileTransform=up,o.transformMat3=function(u,s,c){var d=s[0],m=s[1],_=s[2];return u[0]=d*c[0]+m*c[3]+_*c[6],u[1]=d*c[1]+m*c[4]+_*c[7],u[2]=d*c[2]+m*c[5]+_*c[8],u},o.transformMat4=co,o.transformMat4$1=rp,o.transformQuat=eA,o.transitionTileAABBinECEF=hA,o.translate=Gv,o.transpose=function(u,s){if(u===s){var c=s[1],d=s[2],m=s[5];u[1]=s[3],u[2]=s[6],u[3]=c,u[5]=s[7],u[6]=d,u[7]=m}else u[0]=s[0],u[1]=s[3],u[2]=s[6],u[3]=s[1],u[4]=s[4],u[5]=s[7],u[6]=s[2],u[7]=s[5],u[8]=s[8];return u},o.triggerPluginCompletionEvent=g,o.uniqueId=Wt,o.updateGlobeVertexNormal=function(u,s,c,d,m){const _=5*s+2;u.float32[_+0]=c,u.float32[_+1]=d,u.float32[_+2]=m},o.validateCustomStyleLayer=function(u){const s=[],c=u.id;return c===void 0&&s.push({message:`layers.${c}: missing required property "id"`}),u.render===void 0&&s.push({message:`layers.${c}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&s.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),s},o.validateFilter=u=>qs(Yd(u)),o.validateFog=u=>qs(j1(u)),o.validateLayer=u=>qs(U1(u)),o.validateLight=u=>qs($1(u)),o.validateSource=u=>qs(G1(u)),o.validateStyle=Z1,o.validateTerrain=u=>qs(Ov(u)),o.values=lt,o.vectorTile=dx,o.version=p,o.warnOnce=nt,o.window=f,o.wrap=Be}),a(["./shared"],function(o){function f(Te){if(typeof Te=="number"||typeof Te=="boolean"||typeof Te=="string"||Te==null)return JSON.stringify(Te);if(Array.isArray(Te)){let re="[";for(const be of Te)re+=`${f(be)},`;return`${re}]`}let ne="{";for(const re of Object.keys(Te).sort())ne+=`${re}:${f(Te[re])},`;return`${ne}}`}function p(Te){let ne="";for(const re of o.refProperties)ne+=`/${f(Te[re])}`;return ne}class y{constructor(ne){this.keyCache={},ne&&this.replace(ne)}replace(ne){this._layerConfigs={},this._layers={},this.update(ne,[])}update(ne,re){for(const Le of ne)this._layerConfigs[Le.id]=Le,(this._layers[Le.id]=o.createStyleLayer(Le)).compileFilter(),this.keyCache[Le.id]&&delete this.keyCache[Le.id];for(const Le of re)delete this.keyCache[Le],delete this._layerConfigs[Le],delete this._layers[Le];this.familiesBySource={};const be=function(Le,Fe){const Ze={};for(let Ne=0;Ne<Le.length;Ne++){const ot=Fe&&Fe[Le[Ne].id]||p(Le[Ne]);Fe&&(Fe[Le[Ne].id]=ot);let Rt=Ze[ot];Rt||(Rt=Ze[ot]=[]),Rt.push(Le[Ne])}const qe=[];for(const Ne in Ze)qe.push(Ze[Ne]);return qe}(o.values(this._layerConfigs),this.keyCache);for(const Le of be){const Fe=Le.map(zt=>this._layers[zt.id]),Ze=Fe[0];if(Ze.visibility==="none")continue;const qe=Ze.source||"";let Ne=this.familiesBySource[qe];Ne||(Ne=this.familiesBySource[qe]={});const ot=Ze.sourceLayer||"_geojsonTileLayer";let Rt=Ne[ot];Rt||(Rt=Ne[ot]=[]),Rt.push(Fe)}}}class x{loadTile(ne,re){const{uid:be,encoding:Le,rawImageData:Fe,padding:Ze,buildQuadTree:qe}=ne,Ne=o.window.ImageBitmap&&Fe instanceof o.window.ImageBitmap?this.getImageData(Fe,Ze):Fe;re(null,new o.DEMData(be,Ne,Le,Ze<1,qe))}getImageData(ne,re){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ne.width,ne.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ne.width,this.offscreenCanvas.height=ne.height,this.offscreenCanvasContext.drawImage(ne,0,0,ne.width,ne.height);const be=this.offscreenCanvasContext.getImageData(-re,-re,ne.width+2*re,ne.height+2*re);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),be}}function w(Te,ne){if(Te.length!==0){S(Te[0],ne);for(var re=1;re<Te.length;re++)S(Te[re],!ne)}}function S(Te,ne){for(var re=0,be=0,Le=0,Fe=Te.length,Ze=Fe-1;Le<Fe;Ze=Le++){var qe=(Te[Le][0]-Te[Ze][0])*(Te[Ze][1]+Te[Le][1]),Ne=re+qe;be+=Math.abs(re)>=Math.abs(qe)?re-Ne+qe:qe-Ne+re,re=Ne}re+be>=0!=!!ne&&Te.reverse()}var L=o.getDefaultExportFromCjs(function Te(ne,re){var be,Le=ne&&ne.type;if(Le==="FeatureCollection")for(be=0;be<ne.features.length;be++)Te(ne.features[be],re);else if(Le==="GeometryCollection")for(be=0;be<ne.geometries.length;be++)Te(ne.geometries[be],re);else if(Le==="Feature")Te(ne.geometry,re);else if(Le==="Polygon")w(ne.coordinates,re);else if(Le==="MultiPolygon")for(be=0;be<ne.coordinates.length;be++)w(ne.coordinates[be],re);return ne});const D=o.VectorTileFeature.prototype.toGeoJSON;var B={exports:{}},z=o.pointGeometry,M=o.vectorTile.VectorTileFeature,k=V;function V(Te,ne){this.options=ne||{},this.features=Te,this.length=Te.length}function q(Te,ne){this.id=typeof Te.id=="number"?Te.id:void 0,this.type=Te.type,this.rawGeometry=Te.type===1?[Te.geometry]:Te.geometry,this.properties=Te.tags,this.extent=ne||4096}V.prototype.feature=function(Te){return new q(this.features[Te],this.options.extent)},q.prototype.loadGeometry=function(){var Te=this.rawGeometry;this.geometry=[];for(var ne=0;ne<Te.length;ne++){for(var re=Te[ne],be=[],Le=0;Le<re.length;Le++)be.push(new z(re[Le][0],re[Le][1]));this.geometry.push(be)}return this.geometry},q.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Te=this.geometry,ne=1/0,re=-1/0,be=1/0,Le=-1/0,Fe=0;Fe<Te.length;Fe++)for(var Ze=Te[Fe],qe=0;qe<Ze.length;qe++){var Ne=Ze[qe];ne=Math.min(ne,Ne.x),re=Math.max(re,Ne.x),be=Math.min(be,Ne.y),Le=Math.max(Le,Ne.y)}return[ne,be,re,Le]},q.prototype.toGeoJSON=M.prototype.toGeoJSON;var Y=o.pbf,K=k;function X(Te){var ne=new Y;return function(re,be){for(var Le in re.layers)be.writeMessage(3,U,re.layers[Le])}(Te,ne),ne.finish()}function U(Te,ne){var re;ne.writeVarintField(15,Te.version||1),ne.writeStringField(1,Te.name||""),ne.writeVarintField(5,Te.extent||4096);var be={keys:[],values:[],keycache:{},valuecache:{}};for(re=0;re<Te.length;re++)be.feature=Te.feature(re),ne.writeMessage(2,le,be);var Le=be.keys;for(re=0;re<Le.length;re++)ne.writeStringField(3,Le[re]);var Fe=be.values;for(re=0;re<Fe.length;re++)ne.writeMessage(4,He,Fe[re])}function le(Te,ne){var re=Te.feature;re.id!==void 0&&ne.writeVarintField(1,re.id),ne.writeMessage(2,ue,Te),ne.writeVarintField(3,re.type),ne.writeMessage(4,Ee,re)}function ue(Te,ne){var re=Te.feature,be=Te.keys,Le=Te.values,Fe=Te.keycache,Ze=Te.valuecache;for(var qe in re.properties){var Ne=re.properties[qe],ot=Fe[qe];if(Ne!==null){ot===void 0&&(be.push(qe),Fe[qe]=ot=be.length-1),ne.writeVarint(ot);var Rt=typeof Ne;Rt!=="string"&&Rt!=="boolean"&&Rt!=="number"&&(Ne=JSON.stringify(Ne));var zt=Rt+":"+Ne,At=Ze[zt];At===void 0&&(Le.push(Ne),Ze[zt]=At=Le.length-1),ne.writeVarint(At)}}}function ae(Te,ne){return(ne<<3)+(7&Te)}function ve(Te){return Te<<1^Te>>31}function Ee(Te,ne){for(var re=Te.loadGeometry(),be=Te.type,Le=0,Fe=0,Ze=re.length,qe=0;qe<Ze;qe++){var Ne=re[qe],ot=1;be===1&&(ot=Ne.length),ne.writeVarint(ae(1,ot));for(var Rt=be===3?Ne.length-1:Ne.length,zt=0;zt<Rt;zt++){zt===1&&be!==1&&ne.writeVarint(ae(2,Rt-1));var At=Ne[zt].x-Le,Vn=Ne[zt].y-Fe;ne.writeVarint(ve(At)),ne.writeVarint(ve(Vn)),Le+=At,Fe+=Vn}be===3&&ne.writeVarint(ae(7,1))}}function He(Te,ne){var re=typeof Te;re==="string"?ne.writeStringField(1,Te):re==="boolean"?ne.writeBooleanField(7,Te):re==="number"&&(Te%1!=0?ne.writeDoubleField(3,Te):Te<0?ne.writeSVarintField(6,Te):ne.writeVarintField(5,Te))}B.exports=X,B.exports.fromVectorTileJs=X,B.exports.fromGeojsonVt=function(Te,ne){ne=ne||{};var re={};for(var be in Te)re[be]=new K(Te[be].features,ne),re[be].name=be,re[be].version=ne.version,re[be].extent=ne.extent;return X({layers:re})},B.exports.GeoJSONWrapper=K;var Oe=o.getDefaultExportFromCjs(B.exports);const Ve={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Te=>Te},Pe=Math.fround||(Ke=new Float32Array(1),Te=>(Ke[0]=+Te,Ke[0]));var Ke;const Be=3,Ue=5,lt=6;class xt{constructor(ne){this.options=Object.assign(Object.create(Ve),ne),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ne){const{log:re,minZoom:be,maxZoom:Le}=this.options;re&&console.time("total time");const Fe=`prepare ${ne.length} points`;re&&console.time(Fe),this.points=ne;const Ze=[];for(let Ne=0;Ne<ne.length;Ne++){const ot=ne[Ne];if(!ot.geometry)continue;const[Rt,zt]=ot.geometry.coordinates,At=Pe(Je(Rt)),Vn=Pe(Kt(zt));Ze.push(At,Vn,1/0,Ne,-1,1),this.options.reduce&&Ze.push(0)}let qe=this.trees[Le+1]=this._createTree(Ze);re&&console.timeEnd(Fe);for(let Ne=Le;Ne>=be;Ne--){const ot=+Date.now();qe=this.trees[Ne]=this._createTree(this._cluster(qe,Ne)),re&&console.log("z%d: %d clusters in %dms",Ne,qe.numItems,+Date.now()-ot)}return re&&console.timeEnd("total time"),this}getClusters(ne,re){let be=((ne[0]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,ne[1]));let Fe=ne[2]===180?180:((ne[2]+180)%360+360)%360-180;const Ze=Math.max(-90,Math.min(90,ne[3]));if(ne[2]-ne[0]>=360)be=-180,Fe=180;else if(be>Fe){const zt=this.getClusters([be,Le,180,Ze],re),At=this.getClusters([-180,Le,Fe,Ze],re);return zt.concat(At)}const qe=this.trees[this._limitZoom(re)],Ne=qe.range(Je(be),Kt(Ze),Je(Fe),Kt(Le)),ot=qe.data,Rt=[];for(const zt of Ne){const At=this.stride*zt;Rt.push(ot[At+Ue]>1?Nt(ot,At,this.clusterProps):this.points[ot[At+Be]])}return Rt}getChildren(ne){const re=this._getOriginId(ne),be=this._getOriginZoom(ne),Le="No cluster with the specified id.",Fe=this.trees[be];if(!Fe)throw new Error(Le);const Ze=Fe.data;if(re*this.stride>=Ze.length)throw new Error(Le);const qe=this.options.radius/(this.options.extent*Math.pow(2,be-1)),Ne=Fe.within(Ze[re*this.stride],Ze[re*this.stride+1],qe),ot=[];for(const Rt of Ne){const zt=Rt*this.stride;Ze[zt+4]===ne&&ot.push(Ze[zt+Ue]>1?Nt(Ze,zt,this.clusterProps):this.points[Ze[zt+Be]])}if(ot.length===0)throw new Error(Le);return ot}getLeaves(ne,re,be){const Le=[];return this._appendLeaves(Le,ne,re=re||10,be=be||0,0),Le}getTile(ne,re,be){const Le=this.trees[this._limitZoom(ne)],Fe=Math.pow(2,ne),{extent:Ze,radius:qe}=this.options,Ne=qe/Ze,ot=(be-Ne)/Fe,Rt=(be+1+Ne)/Fe,zt={features:[]};return this._addTileFeatures(Le.range((re-Ne)/Fe,ot,(re+1+Ne)/Fe,Rt),Le.data,re,be,Fe,zt),re===0&&this._addTileFeatures(Le.range(1-Ne/Fe,ot,1,Rt),Le.data,Fe,be,Fe,zt),re===Fe-1&&this._addTileFeatures(Le.range(0,ot,Ne/Fe,Rt),Le.data,-1,be,Fe,zt),zt.features.length?zt:null}getClusterExpansionZoom(ne){let re=this._getOriginZoom(ne)-1;for(;re<=this.options.maxZoom;){const be=this.getChildren(ne);if(re++,be.length!==1)break;ne=be[0].properties.cluster_id}return re}_appendLeaves(ne,re,be,Le,Fe){const Ze=this.getChildren(re);for(const qe of Ze){const Ne=qe.properties;if(Ne&&Ne.cluster?Fe+Ne.point_count<=Le?Fe+=Ne.point_count:Fe=this._appendLeaves(ne,Ne.cluster_id,be,Le,Fe):Fe<Le?Fe++:ne.push(qe),ne.length===be)break}return Fe}_createTree(ne){const re=new o.KDBush(ne.length/this.stride|0,this.options.nodeSize,Float32Array);for(let be=0;be<ne.length;be+=this.stride)re.add(ne[be],ne[be+1]);return re.finish(),re.data=ne,re}_addTileFeatures(ne,re,be,Le,Fe,Ze){for(const qe of ne){const Ne=qe*this.stride,ot=re[Ne+Ue]>1;let Rt,zt,At;if(ot)Rt=Wt(re,Ne,this.clusterProps),zt=re[Ne],At=re[Ne+1];else{const Gn=this.points[re[Ne+Be]];Rt=Gn.properties;const[Yn,lr]=Gn.geometry.coordinates;zt=Je(Yn),At=Kt(lr)}const Vn={type:1,geometry:[[Math.round(this.options.extent*(zt*Fe-be)),Math.round(this.options.extent*(At*Fe-Le))]],tags:Rt};let Hn;Hn=ot||this.options.generateId?re[Ne+Be]:this.points[re[Ne+Be]].id,Hn!==void 0&&(Vn.id=Hn),Ze.features.push(Vn)}}_limitZoom(ne){return Math.max(this.options.minZoom,Math.min(Math.floor(+ne),this.options.maxZoom+1))}_cluster(ne,re){const{radius:be,extent:Le,reduce:Fe,minPoints:Ze}=this.options,qe=be/(Le*Math.pow(2,re)),Ne=ne.data,ot=[],Rt=this.stride;for(let zt=0;zt<Ne.length;zt+=Rt){if(Ne[zt+2]<=re)continue;Ne[zt+2]=re;const At=Ne[zt],Vn=Ne[zt+1],Hn=ne.within(Ne[zt],Ne[zt+1],qe),Gn=Ne[zt+Ue];let Yn=Gn;for(const lr of Hn){const $i=lr*Rt;Ne[$i+2]>re&&(Yn+=Ne[$i+Ue])}if(Yn>Gn&&Yn>=Ze){let lr,$i=At*Gn,_o=Vn*Gn,Ia=-1;const No=((zt/Rt|0)<<5)+(re+1)+this.points.length;for(const Gl of Hn){const Ho=Gl*Rt;if(Ne[Ho+2]<=re)continue;Ne[Ho+2]=re;const Xa=Ne[Ho+Ue];$i+=Ne[Ho]*Xa,_o+=Ne[Ho+1]*Xa,Ne[Ho+4]=No,Fe&&(lr||(lr=this._map(Ne,zt,!0),Ia=this.clusterProps.length,this.clusterProps.push(lr)),Fe(lr,this._map(Ne,Ho)))}Ne[zt+4]=No,ot.push($i/Yn,_o/Yn,1/0,No,-1,Yn),Fe&&ot.push(Ia)}else{for(let lr=0;lr<Rt;lr++)ot.push(Ne[zt+lr]);if(Yn>1)for(const lr of Hn){const $i=lr*Rt;if(!(Ne[$i+2]<=re)){Ne[$i+2]=re;for(let _o=0;_o<Rt;_o++)ot.push(Ne[$i+_o])}}}}return ot}_getOriginId(ne){return ne-this.points.length>>5}_getOriginZoom(ne){return(ne-this.points.length)%32}_map(ne,re,be){if(ne[re+Ue]>1){const Ze=this.clusterProps[ne[re+lt]];return be?Object.assign({},Ze):Ze}const Le=this.points[ne[re+Be]].properties,Fe=this.options.map(Le);return be&&Fe===Le?Object.assign({},Fe):Fe}}function Nt(Te,ne,re){return{type:"Feature",id:Te[ne+Be],properties:Wt(Te,ne,re),geometry:{type:"Point",coordinates:[(be=Te[ne],360*(be-.5)),Vt(Te[ne+1])]}};var be}function Wt(Te,ne,re){const be=Te[ne+Ue],Le=be>=1e4?`${Math.round(be/1e3)}k`:be>=1e3?Math.round(be/100)/10+"k":be,Fe=Te[ne+lt],Ze=Fe===-1?{}:Object.assign({},re[Fe]);return Object.assign(Ze,{cluster:!0,cluster_id:Te[ne+Be],point_count:be,point_count_abbreviated:Le})}function Je(Te){return Te/360+.5}function Kt(Te){const ne=Math.sin(Te*Math.PI/180),re=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return re<0?0:re>1?1:re}function Vt(Te){const ne=(180-360*Te)*Math.PI/180;return 360*Math.atan(Math.exp(ne))/Math.PI-90}function dt(Te,ne,re,be){for(var Le,Fe=be,Ze=re-ne>>1,qe=re-ne,Ne=Te[ne],ot=Te[ne+1],Rt=Te[re],zt=Te[re+1],At=ne+3;At<re;At+=3){var Vn=Jt(Te[At],Te[At+1],Ne,ot,Rt,zt);if(Vn>Fe)Le=At,Fe=Vn;else if(Vn===Fe){var Hn=Math.abs(At-Ze);Hn<qe&&(Le=At,qe=Hn)}}Fe>be&&(Le-ne>3&&dt(Te,ne,Le,be),Te[Le+2]=Fe,re-Le>3&&dt(Te,Le,re,be))}function Jt(Te,ne,re,be,Le,Fe){var Ze=Le-re,qe=Fe-be;if(Ze!==0||qe!==0){var Ne=((Te-re)*Ze+(ne-be)*qe)/(Ze*Ze+qe*qe);Ne>1?(re=Le,be=Fe):Ne>0&&(re+=Ze*Ne,be+=qe*Ne)}return(Ze=Te-re)*Ze+(qe=ne-be)*qe}function Ut(Te,ne,re,be){var Le={id:Te===void 0?null:Te,type:ne,geometry:re,tags:be,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Fe){var Ze=Fe.geometry,qe=Fe.type;if(qe==="Point"||qe==="MultiPoint"||qe==="LineString")we(Fe,Ze);else if(qe==="Polygon"||qe==="MultiLineString")for(var Ne=0;Ne<Ze.length;Ne++)we(Fe,Ze[Ne]);else if(qe==="MultiPolygon")for(Ne=0;Ne<Ze.length;Ne++)for(var ot=0;ot<Ze[Ne].length;ot++)we(Fe,Ze[Ne][ot])}(Le),Le}function we(Te,ne){for(var re=0;re<ne.length;re+=3)Te.minX=Math.min(Te.minX,ne[re]),Te.minY=Math.min(Te.minY,ne[re+1]),Te.maxX=Math.max(Te.maxX,ne[re]),Te.maxY=Math.max(Te.maxY,ne[re+1])}function Ce(Te,ne,re,be){if(ne.geometry){var Le=ne.geometry.coordinates,Fe=ne.geometry.type,Ze=Math.pow(re.tolerance/((1<<re.maxZoom)*re.extent),2),qe=[],Ne=ne.id;if(re.promoteId?Ne=ne.properties[re.promoteId]:re.generateId&&(Ne=be||0),Fe==="Point")je(Le,qe);else if(Fe==="MultiPoint")for(var ot=0;ot<Le.length;ot++)je(Le[ot],qe);else if(Fe==="LineString")nt(Le,qe,Ze,!1);else if(Fe==="MultiLineString"){if(re.lineMetrics){for(ot=0;ot<Le.length;ot++)nt(Le[ot],qe=[],Ze,!1),Te.push(Ut(Ne,"LineString",qe,ne.properties));return}st(Le,qe,Ze,!1)}else if(Fe==="Polygon")st(Le,qe,Ze,!0);else{if(Fe!=="MultiPolygon"){if(Fe==="GeometryCollection"){for(ot=0;ot<ne.geometry.geometries.length;ot++)Ce(Te,{id:Ne,geometry:ne.geometry.geometries[ot],properties:ne.properties},re,be);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ot=0;ot<Le.length;ot++){var Rt=[];st(Le[ot],Rt,Ze,!0),qe.push(Rt)}}Te.push(Ut(Ne,Fe,qe,ne.properties))}}function je(Te,ne){ne.push(vt(Te[0])),ne.push(Dt(Te[1])),ne.push(0)}function nt(Te,ne,re,be){for(var Le,Fe,Ze=0,qe=0;qe<Te.length;qe++){var Ne=vt(Te[qe][0]),ot=Dt(Te[qe][1]);ne.push(Ne),ne.push(ot),ne.push(0),qe>0&&(Ze+=be?(Le*ot-Ne*Fe)/2:Math.sqrt(Math.pow(Ne-Le,2)+Math.pow(ot-Fe,2))),Le=Ne,Fe=ot}var Rt=ne.length-3;ne[2]=1,dt(ne,0,Rt,re),ne[Rt+2]=1,ne.size=Math.abs(Ze),ne.start=0,ne.end=ne.size}function st(Te,ne,re,be){for(var Le=0;Le<Te.length;Le++){var Fe=[];nt(Te[Le],Fe,re,be),ne.push(Fe)}}function vt(Te){return Te/360+.5}function Dt(Te){var ne=Math.sin(Te*Math.PI/180),re=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return re<0?0:re>1?1:re}function Ct(Te,ne,re,be,Le,Fe,Ze,qe){if(be/=ne,Fe>=(re/=ne)&&Ze<be)return Te;if(Ze<re||Fe>=be)return null;for(var Ne=[],ot=0;ot<Te.length;ot++){var Rt=Te[ot],zt=Rt.geometry,At=Rt.type,Vn=Le===0?Rt.minX:Rt.minY,Hn=Le===0?Rt.maxX:Rt.maxY;if(Vn>=re&&Hn<be)Ne.push(Rt);else if(!(Hn<re||Vn>=be)){var Gn=[];if(At==="Point"||At==="MultiPoint")Gt(zt,Gn,re,be,Le);else if(At==="LineString")Tt(zt,Gn,re,be,Le,!1,qe.lineMetrics);else if(At==="MultiLineString")un(zt,Gn,re,be,Le,!1);else if(At==="Polygon")un(zt,Gn,re,be,Le,!0);else if(At==="MultiPolygon")for(var Yn=0;Yn<zt.length;Yn++){var lr=[];un(zt[Yn],lr,re,be,Le,!0),lr.length&&Gn.push(lr)}if(Gn.length){if(qe.lineMetrics&&At==="LineString"){for(Yn=0;Yn<Gn.length;Yn++)Ne.push(Ut(Rt.id,At,Gn[Yn],Rt.tags));continue}At!=="LineString"&&At!=="MultiLineString"||(Gn.length===1?(At="LineString",Gn=Gn[0]):At="MultiLineString"),At!=="Point"&&At!=="MultiPoint"||(At=Gn.length===3?"Point":"MultiPoint"),Ne.push(Ut(Rt.id,At,Gn,Rt.tags))}}}return Ne.length?Ne:null}function Gt(Te,ne,re,be,Le){for(var Fe=0;Fe<Te.length;Fe+=3){var Ze=Te[Fe+Le];Ze>=re&&Ze<=be&&(ne.push(Te[Fe]),ne.push(Te[Fe+1]),ne.push(Te[Fe+2]))}}function Tt(Te,ne,re,be,Le,Fe,Ze){for(var qe,Ne,ot=fn(Te),Rt=Le===0?Mn:Wn,zt=Te.start,At=0;At<Te.length-3;At+=3){var Vn=Te[At],Hn=Te[At+1],Gn=Te[At+2],Yn=Te[At+3],lr=Te[At+4],$i=Le===0?Vn:Hn,_o=Le===0?Yn:lr,Ia=!1;Ze&&(qe=Math.sqrt(Math.pow(Vn-Yn,2)+Math.pow(Hn-lr,2))),$i<re?_o>re&&(Ne=Rt(ot,Vn,Hn,Yn,lr,re),Ze&&(ot.start=zt+qe*Ne)):$i>be?_o<be&&(Ne=Rt(ot,Vn,Hn,Yn,lr,be),Ze&&(ot.start=zt+qe*Ne)):xn(ot,Vn,Hn,Gn),_o<re&&$i>=re&&(Ne=Rt(ot,Vn,Hn,Yn,lr,re),Ia=!0),_o>be&&$i<=be&&(Ne=Rt(ot,Vn,Hn,Yn,lr,be),Ia=!0),!Fe&&Ia&&(Ze&&(ot.end=zt+qe*Ne),ne.push(ot),ot=fn(Te)),Ze&&(zt+=qe)}var No=Te.length-3;Vn=Te[No],Hn=Te[No+1],Gn=Te[No+2],($i=Le===0?Vn:Hn)>=re&&$i<=be&&xn(ot,Vn,Hn,Gn),No=ot.length-3,Fe&&No>=3&&(ot[No]!==ot[0]||ot[No+1]!==ot[1])&&xn(ot,ot[0],ot[1],ot[2]),ot.length&&ne.push(ot)}function fn(Te){var ne=[];return ne.size=Te.size,ne.start=Te.start,ne.end=Te.end,ne}function un(Te,ne,re,be,Le,Fe){for(var Ze=0;Ze<Te.length;Ze++)Tt(Te[Ze],ne,re,be,Le,Fe,!1)}function xn(Te,ne,re,be){Te.push(ne),Te.push(re),Te.push(be)}function Mn(Te,ne,re,be,Le,Fe){var Ze=(Fe-ne)/(be-ne);return Te.push(Fe),Te.push(re+(Le-re)*Ze),Te.push(1),Ze}function Wn(Te,ne,re,be,Le,Fe){var Ze=(Fe-re)/(Le-re);return Te.push(ne+(be-ne)*Ze),Te.push(Fe),Te.push(1),Ze}function hr(Te,ne){for(var re=[],be=0;be<Te.length;be++){var Le,Fe=Te[be],Ze=Fe.type;if(Ze==="Point"||Ze==="MultiPoint"||Ze==="LineString")Le=gr(Fe.geometry,ne);else if(Ze==="MultiLineString"||Ze==="Polygon"){Le=[];for(var qe=0;qe<Fe.geometry.length;qe++)Le.push(gr(Fe.geometry[qe],ne))}else if(Ze==="MultiPolygon")for(Le=[],qe=0;qe<Fe.geometry.length;qe++){for(var Ne=[],ot=0;ot<Fe.geometry[qe].length;ot++)Ne.push(gr(Fe.geometry[qe][ot],ne));Le.push(Ne)}re.push(Ut(Fe.id,Ze,Le,Fe.tags))}return re}function gr(Te,ne){var re=[];re.size=Te.size,Te.start!==void 0&&(re.start=Te.start,re.end=Te.end);for(var be=0;be<Te.length;be+=3)re.push(Te[be]+ne,Te[be+1],Te[be+2]);return re}function ki(Te,ne){if(Te.transformed)return Te;var re,be,Le,Fe=1<<Te.z,Ze=Te.x,qe=Te.y;for(re=0;re<Te.features.length;re++){var Ne=Te.features[re],ot=Ne.geometry,Rt=Ne.type;if(Ne.geometry=[],Rt===1)for(be=0;be<ot.length;be+=2)Ne.geometry.push(Uo(ot[be],ot[be+1],ne,Fe,Ze,qe));else for(be=0;be<ot.length;be++){var zt=[];for(Le=0;Le<ot[be].length;Le+=2)zt.push(Uo(ot[be][Le],ot[be][Le+1],ne,Fe,Ze,qe));Ne.geometry.push(zt)}}return Te.transformed=!0,Te}function Uo(Te,ne,re,be,Le,Fe){return[Math.round(re*(Te*be-Le)),Math.round(re*(ne*be-Fe))]}function Ss(Te,ne,re,be,Le){for(var Fe=ne===Le.maxZoom?0:Le.tolerance/((1<<ne)*Le.extent),Ze={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:re,y:be,z:ne,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},qe=0;qe<Te.length;qe++){Ze.numFeatures++,Cc(Ze,Te[qe],Fe,Le);var Ne=Te[qe].minX,ot=Te[qe].minY,Rt=Te[qe].maxX,zt=Te[qe].maxY;Ne<Ze.minX&&(Ze.minX=Ne),ot<Ze.minY&&(Ze.minY=ot),Rt>Ze.maxX&&(Ze.maxX=Rt),zt>Ze.maxY&&(Ze.maxY=zt)}return Ze}function Cc(Te,ne,re,be){var Le=ne.geometry,Fe=ne.type,Ze=[];if(Fe==="Point"||Fe==="MultiPoint")for(var qe=0;qe<Le.length;qe+=3)Ze.push(Le[qe]),Ze.push(Le[qe+1]),Te.numPoints++,Te.numSimplified++;else if(Fe==="LineString")Ts(Ze,Le,Te,re,!1,!1);else if(Fe==="MultiLineString"||Fe==="Polygon")for(qe=0;qe<Le.length;qe++)Ts(Ze,Le[qe],Te,re,Fe==="Polygon",qe===0);else if(Fe==="MultiPolygon")for(var Ne=0;Ne<Le.length;Ne++){var ot=Le[Ne];for(qe=0;qe<ot.length;qe++)Ts(Ze,ot[qe],Te,re,!0,qe===0)}if(Ze.length){var Rt=ne.tags||null;if(Fe==="LineString"&&be.lineMetrics){for(var zt in Rt={},ne.tags)Rt[zt]=ne.tags[zt];Rt.mapbox_clip_start=Le.start/Le.size,Rt.mapbox_clip_end=Le.end/Le.size}var At={geometry:Ze,type:Fe==="Polygon"||Fe==="MultiPolygon"?3:Fe==="LineString"||Fe==="MultiLineString"?2:1,tags:Rt};ne.id!==null&&(At.id=ne.id),Te.features.push(At)}}function Ts(Te,ne,re,be,Le,Fe){var Ze=be*be;if(be>0&&ne.size<(Le?Ze:be))re.numPoints+=ne.length/3;else{for(var qe=[],Ne=0;Ne<ne.length;Ne+=3)(be===0||ne[Ne+2]>Ze)&&(re.numSimplified++,qe.push(ne[Ne]),qe.push(ne[Ne+1])),re.numPoints++;Le&&function(ot,Rt){for(var zt=0,At=0,Vn=ot.length,Hn=Vn-2;At<Vn;Hn=At,At+=2)zt+=(ot[At]-ot[Hn])*(ot[At+1]+ot[Hn+1]);if(zt>0===Rt)for(At=0,Vn=ot.length;At<Vn/2;At+=2){var Gn=ot[At],Yn=ot[At+1];ot[At]=ot[Vn-2-At],ot[At+1]=ot[Vn-1-At],ot[Vn-2-At]=Gn,ot[Vn-1-At]=Yn}}(qe,Fe),Te.push(qe)}}function pl(Te,ne){var re=(ne=this.options=function(Le,Fe){for(var Ze in Fe)Le[Ze]=Fe[Ze];return Le}(Object.create(this.options),ne)).debug;if(re&&console.time("preprocess data"),ne.maxZoom<0||ne.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ne.promoteId&&ne.generateId)throw new Error("promoteId and generateId cannot be used together.");var be=function(Le,Fe){var Ze=[];if(Le.type==="FeatureCollection")for(var qe=0;qe<Le.features.length;qe++)Ce(Ze,Le.features[qe],Fe,qe);else Ce(Ze,Le.type==="Feature"?Le:{geometry:Le},Fe);return Ze}(Te,ne);this.tiles={},this.tileCoords=[],re&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ne.indexMaxZoom,ne.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),be=function(Le,Fe){var Ze=Fe.buffer/Fe.extent,qe=Le,Ne=Ct(Le,1,-1-Ze,Ze,0,-1,2,Fe),ot=Ct(Le,1,1-Ze,2+Ze,0,-1,2,Fe);return(Ne||ot)&&(qe=Ct(Le,1,-Ze,1+Ze,0,-1,2,Fe)||[],Ne&&(qe=hr(Ne,1).concat(qe)),ot&&(qe=qe.concat(hr(ot,-1)))),qe}(be,ne),be.length&&this.splitTile(be,0,0,0),re&&(be.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function vo(Te,ne,re){return 32*((1<<Te)*re+ne)+Te}function Wo(Te,ne){const re=Te.tileID.canonical;if(!this._geoJSONIndex)return ne(null,null);const be=this._geoJSONIndex.getTile(re.z,re.x,re.y);if(!be)return ne(null,null);const Le=new class{constructor(Ze){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=Ze.length,this._features=Ze}feature(Ze){return new class{constructor(qe){this._feature=qe,this.extent=o.EXTENT,this.type=qe.type,this.properties=qe.tags,"id"in qe&&!isNaN(qe.id)&&(this.id=parseInt(qe.id,10))}loadGeometry(){if(this._feature.type===1){const qe=[];for(const Ne of this._feature.geometry)qe.push([new o.Point(Ne[0],Ne[1])]);return qe}{const qe=[];for(const Ne of this._feature.geometry){const ot=[];for(const Rt of Ne)ot.push(new o.Point(Rt[0],Rt[1]));qe.push(ot)}return qe}}toGeoJSON(qe,Ne,ot){return D.call(this,qe,Ne,ot)}}(this._features[Ze])}}(be.features);let Fe=Oe(Le);Fe.byteOffset===0&&Fe.byteLength===Fe.buffer.byteLength||(Fe=new Uint8Array(Fe)),ne(null,{vectorTile:Le,rawData:Fe.buffer})}pl.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},pl.prototype.splitTile=function(Te,ne,re,be,Le,Fe,Ze){for(var qe=[Te,ne,re,be],Ne=this.options,ot=Ne.debug;qe.length;){be=qe.pop(),re=qe.pop(),ne=qe.pop(),Te=qe.pop();var Rt=1<<ne,zt=vo(ne,re,be),At=this.tiles[zt];if(!At&&(ot>1&&console.time("creation"),At=this.tiles[zt]=Ss(Te,ne,re,be,Ne),this.tileCoords.push({z:ne,x:re,y:be}),ot)){ot>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ne,re,be,At.numFeatures,At.numPoints,At.numSimplified),console.timeEnd("creation"));var Vn="z"+ne;this.stats[Vn]=(this.stats[Vn]||0)+1,this.total++}if(At.source=Te,Le){if(ne===Ne.maxZoom||ne===Le)continue;var Hn=1<<Le-ne;if(re!==Math.floor(Fe/Hn)||be!==Math.floor(Ze/Hn))continue}else if(ne===Ne.indexMaxZoom||At.numPoints<=Ne.indexMaxPoints)continue;if(At.source=null,Te.length!==0){ot>1&&console.time("clipping");var Gn,Yn,lr,$i,_o,Ia,No=.5*Ne.buffer/Ne.extent,Gl=.5-No,Ho=.5+No,Xa=1+No;Gn=Yn=lr=$i=null,_o=Ct(Te,Rt,re-No,re+Ho,0,At.minX,At.maxX,Ne),Ia=Ct(Te,Rt,re+Gl,re+Xa,0,At.minX,At.maxX,Ne),Te=null,_o&&(Gn=Ct(_o,Rt,be-No,be+Ho,1,At.minY,At.maxY,Ne),Yn=Ct(_o,Rt,be+Gl,be+Xa,1,At.minY,At.maxY,Ne),_o=null),Ia&&(lr=Ct(Ia,Rt,be-No,be+Ho,1,At.minY,At.maxY,Ne),$i=Ct(Ia,Rt,be+Gl,be+Xa,1,At.minY,At.maxY,Ne),Ia=null),ot>1&&console.timeEnd("clipping"),qe.push(Gn||[],ne+1,2*re,2*be),qe.push(Yn||[],ne+1,2*re,2*be+1),qe.push(lr||[],ne+1,2*re+1,2*be),qe.push($i||[],ne+1,2*re+1,2*be+1)}}},pl.prototype.getTile=function(Te,ne,re){var be=this.options,Le=be.extent,Fe=be.debug;if(Te<0||Te>24)return null;var Ze=1<<Te,qe=vo(Te,ne=(ne%Ze+Ze)%Ze,re);if(this.tiles[qe])return ki(this.tiles[qe],Le);Fe>1&&console.log("drilling down to z%d-%d-%d",Te,ne,re);for(var Ne,ot=Te,Rt=ne,zt=re;!Ne&&ot>0;)ot--,Rt=Math.floor(Rt/2),zt=Math.floor(zt/2),Ne=this.tiles[vo(ot,Rt,zt)];return Ne&&Ne.source?(Fe>1&&console.log("found parent tile z%d-%d-%d",ot,Rt,zt),Fe>1&&console.time("drilling down"),this.splitTile(Ne.source,ot,Rt,zt,Te,ne,re),Fe>1&&console.timeEnd("drilling down"),this.tiles[qe]?ki(this.tiles[qe],Le):null):null};class Fu extends o.VectorTileWorkerSource{constructor(ne,re,be,Le,Fe){super(ne,re,be,Le,Wo),Fe&&(this.loadGeoJSON=Fe)}loadData(ne,re){const be=ne&&ne.request,Le=be&&be.collectResourceTiming;this.loadGeoJSON(ne,(Fe,Ze)=>{if(Fe||!Ze)return re(Fe);if(typeof Ze!="object")return re(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));{L(Ze,!0);try{if(ne.filter){const Ne=o.createExpression(ne.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ne.result==="error")throw new Error(Ne.value.map(Rt=>`${Rt.key}: ${Rt.message}`).join(", "));Ze={type:"FeatureCollection",features:Ze.features.filter(Rt=>Ne.value.evaluate({zoom:0},Rt))}}this._geoJSONIndex=ne.cluster?new xt(function({superclusterOptions:Ne,clusterProperties:ot}){if(!ot||!Ne)return Ne;const Rt={},zt={},At={accumulated:null,zoom:0},Vn={properties:null},Hn=Object.keys(ot);for(const Gn of Hn){const[Yn,lr]=ot[Gn],$i=o.createExpression(lr),_o=o.createExpression(typeof Yn=="string"?[Yn,["accumulated"],["get",Gn]]:Yn);Rt[Gn]=$i.value,zt[Gn]=_o.value}return Ne.map=Gn=>{Vn.properties=Gn;const Yn={};for(const lr of Hn)Yn[lr]=Rt[lr].evaluate(At,Vn);return Yn},Ne.reduce=(Gn,Yn)=>{Vn.properties=Yn;for(const lr of Hn)At.accumulated=Gn[lr],Gn[lr]=zt[lr].evaluate(At,Vn)},Ne}(ne)).load(Ze.features):function(Ne,ot){return new pl(Ne,ot)}(Ze,ne.geojsonVtOptions)}catch(Ne){return re(Ne)}this.loaded={};const qe={};if(Le){const Ne=o.getPerformanceMeasurement(be);Ne&&(qe.resourceTiming={},qe.resourceTiming[ne.source]=JSON.parse(JSON.stringify(Ne)))}re(null,qe)}})}reloadTile(ne,re){const be=this.loaded;return be&&be[ne.uid]?super.reloadTile(ne,re):this.loadTile(ne,re)}loadGeoJSON(ne,re){if(ne.request)o.getJSON(ne.request,re);else{if(typeof ne.data!="string")return re(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));try{return re(null,JSON.parse(ne.data))}catch{return re(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ne,re){try{re(null,this._geoJSONIndex.getClusterExpansionZoom(ne.clusterId))}catch(be){re(be)}}getClusterChildren(ne,re){try{re(null,this._geoJSONIndex.getChildren(ne.clusterId))}catch(be){re(be)}}getClusterLeaves(ne,re){try{re(null,this._geoJSONIndex.getLeaves(ne.clusterId,ne.limit,ne.offset))}catch(be){re(be)}}}class vg{constructor(ne){this.self=ne,this.actor=new o.Actor(ne,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.getProjection({name:"mercator"}),this.workerSourceTypes={vector:o.VectorTileWorkerSource,geojson:Fu},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(re,be)=>{if(this.workerSourceTypes[re])throw new Error(`Worker source with name "${re}" already registered.`);this.workerSourceTypes[re]=be},this.self.registerRTLTextPlugin=re=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=re.applyArabicShaping,o.plugin.processBidirectionalText=re.processBidirectionalText,o.plugin.processStyledBidirectionalText=re.processStyledBidirectionalText}}clearCaches(ne,re,be){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne],be()}checkIfReady(ne,re,be){be()}setReferrer(ne,re){this.referrer=re}spriteLoaded(ne,re){this.isSpriteLoaded[ne]=re;for(const be in this.workerSources[ne]){const Le=this.workerSources[ne][be];for(const Fe in Le)Le[Fe]instanceof o.VectorTileWorkerSource&&(Le[Fe].isSpriteLoaded=re,Le[Fe].fire(new o.Event("isSpriteLoaded")))}}setImages(ne,re,be){this.availableImages[ne]=re;for(const Le in this.workerSources[ne]){const Fe=this.workerSources[ne][Le];for(const Ze in Fe)Fe[Ze].availableImages=re}be()}enableTerrain(ne,re,be){this.terrain=re,be()}setProjection(ne,re){this.projections[ne]=o.getProjection(re)}setLayers(ne,re,be){this.getLayerIndex(ne).replace(re),be()}updateLayers(ne,re,be){this.getLayerIndex(ne).update(re.layers,re.removedIds),be()}loadTile(ne,re,be){const Le=this.enableTerrain?o.extend({enableTerrain:this.terrain},re):re;Le.projection=this.projections[ne]||this.defaultProjection,this.getWorkerSource(ne,re.type,re.source).loadTile(Le,be)}loadDEMTile(ne,re,be){const Le=this.enableTerrain?o.extend({buildQuadTree:this.terrain},re):re;this.getDEMWorkerSource(ne,re.source).loadTile(Le,be)}reloadTile(ne,re,be){const Le=this.enableTerrain?o.extend({enableTerrain:this.terrain},re):re;Le.projection=this.projections[ne]||this.defaultProjection,this.getWorkerSource(ne,re.type,re.source).reloadTile(Le,be)}abortTile(ne,re,be){this.getWorkerSource(ne,re.type,re.source).abortTile(re,be)}removeTile(ne,re,be){this.getWorkerSource(ne,re.type,re.source).removeTile(re,be)}removeSource(ne,re,be){if(!this.workerSources[ne]||!this.workerSources[ne][re.type]||!this.workerSources[ne][re.type][re.source])return;const Le=this.workerSources[ne][re.type][re.source];delete this.workerSources[ne][re.type][re.source],Le.removeSource!==void 0?Le.removeSource(re,be):be()}loadWorkerSource(ne,re,be){try{this.self.importScripts(re.url),be()}catch(Le){be(Le.toString())}}syncRTLPluginState(ne,re,be){try{o.plugin.setState(re);const Le=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&Le!=null){this.self.importScripts(Le);const Fe=o.plugin.isParsed();be(Fe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Le}`),Fe)}}catch(Le){be(Le.toString())}}getAvailableImages(ne){let re=this.availableImages[ne];return re||(re=[]),re}getLayerIndex(ne){let re=this.layerIndexes[ne];return re||(re=this.layerIndexes[ne]=new y),re}getWorkerSource(ne,re,be){if(this.workerSources[ne]||(this.workerSources[ne]={}),this.workerSources[ne][re]||(this.workerSources[ne][re]={}),!this.workerSources[ne][re][be]){const Le={send:(Fe,Ze,qe,Ne,ot,Rt)=>{this.actor.send(Fe,Ze,qe,ne,ot,Rt)},scheduler:this.actor.scheduler};this.workerSources[ne][re][be]=new this.workerSourceTypes[re](Le,this.getLayerIndex(ne),this.getAvailableImages(ne),this.isSpriteLoaded[ne])}return this.workerSources[ne][re][be]}getDEMWorkerSource(ne,re){return this.demWorkerSources[ne]||(this.demWorkerSources[ne]={}),this.demWorkerSources[ne][re]||(this.demWorkerSources[ne][re]=new x),this.demWorkerSources[ne][re]}enforceCacheSizeLimit(ne,re){o.enforceCacheSizeLimit(re)}getWorkerPerformanceMetrics(ne,re,be){be(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new vg(self)),vg}),a(["./shared"],function(o){function f(v,h){if(Array.isArray(v)){if(!Array.isArray(h)||v.length!==h.length)return!1;for(let g=0;g<v.length;g++)if(!f(v[g],h[g]))return!1;return!0}if(typeof v=="object"&&v!==null&&h!==null){if(typeof h!="object"||Object.keys(v).length!==Object.keys(h).length)return!1;for(const g in v)if(!f(v[g],h[g]))return!1;return!0}return v===h}var p=y;function y(v){return!function(h){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var b,T,C=new Blob([""],{type:"text/javascript"}),O=URL.createObjectURL(C);try{T=new Worker(O),b=!0}catch{b=!1}return T&&T.terminate(),URL.revokeObjectURL(O),b}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var b=document.createElement("canvas");b.width=b.height=1;var T=b.getContext("2d");if(!T)return!1;var C=T.getImageData(0,0,1,1);return C&&C.width===b.width}()?(x[g=h&&h.failIfMajorPerformanceCaveat]===void 0&&(x[g]=function(b){var T,C=function(O){var R=document.createElement("canvas"),F=Object.create(y.webGLContextAttributes);return F.failIfMajorPerformanceCaveat=O,R.getContext("webgl",F)||R.getContext("experimental-webgl",F)}(b);if(!C)return!1;try{T=C.createShader(C.VERTEX_SHADER)}catch{return!1}return!(!T||C.isContextLost())&&(C.shaderSource(T,"void main() {}"),C.compileShader(T),C.getShaderParameter(T,C.COMPILE_STATUS)===!0)}(g)),x[g]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var g}(v)}var x={};function w(v,h,g){const b=o.window.document.createElement(v);return h!==void 0&&(b.className=h),g&&g.appendChild(b),b}function S(v,h,g){const b=o.window.document.createElementNS("http://www.w3.org/2000/svg",v);for(const T of Object.keys(h))b.setAttributeNS(null,T,h[T]);return g&&g.appendChild(b),b}y.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const L=o.window.document&&o.window.document.documentElement.style,D=L&&L.userSelect!==void 0?"userSelect":"WebkitUserSelect";let B;function z(){L&&D&&(B=L[D],L[D]="none")}function M(){L&&D&&(L[D]=B)}function k(v){v.preventDefault(),v.stopPropagation(),o.window.removeEventListener("click",k,!0)}function V(){o.window.addEventListener("click",k,!0),o.window.setTimeout(()=>{o.window.removeEventListener("click",k,!0)},0)}function q(v,h){const g=v.getBoundingClientRect();return X(v,g,h)}function Y(v,h){const g=v.getBoundingClientRect(),b=[];for(let T=0;T<h.length;T++)b.push(X(v,g,h[T]));return b}function K(v){return o.window.InstallTrigger!==void 0&&v.button===2&&v.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:v.button}function X(v,h,g){const b=v.offsetWidth===h.width?1:v.offsetWidth/h.width;return new o.Point((g.clientX-h.left)*b,(g.clientY-h.top)*b)}function U(v,h){var g=h[0],b=h[1],T=h[2],C=h[3],O=g*C-T*b;return O?(v[0]=C*(O=1/O),v[1]=-b*O,v[2]=-T*O,v[3]=g*O,v):null}function le(v){const{userImage:h}=v;return!!(h&&h.render&&h.render())&&(v.data.replace(new Uint8Array(h.data.buffer)),!0)}class ue extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(h){if(this.loaded!==h&&(this.loaded=h,h)){for(const{ids:g,callback:b}of this.requestors)this._notify(g,b);this.requestors=[]}}hasImage(h){return!!this.getImage(h)}getImage(h){return this.images[h]}addImage(h,g){this._validate(h,g)&&(this.images[h]=g)}_validate(h,g){let b=!0;return this._validateStretch(g.stretchX,g.data&&g.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${h}" has invalid "stretchX" value`))),b=!1),this._validateStretch(g.stretchY,g.data&&g.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${h}" has invalid "stretchY" value`))),b=!1),this._validateContent(g.content,g)||(this.fire(new o.ErrorEvent(new Error(`Image "${h}" has invalid "content" value`))),b=!1),b}_validateStretch(h,g){if(!h)return!0;let b=0;for(const T of h){if(T[0]<b||T[1]<T[0]||g<T[1])return!1;b=T[1]}return!0}_validateContent(h,g){return!(h&&(h.length!==4||h[0]<0||g.data.width<h[0]||h[1]<0||g.data.height<h[1]||h[2]<0||g.data.width<h[2]||h[3]<0||g.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))}updateImage(h,g){g.version=this.images[h].version+1,this.images[h]=g,this.updatedImages[h]=!0}removeImage(h){const g=this.images[h];delete this.images[h],delete this.patterns[h],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(h,g){let b=!0;if(!this.isLoaded())for(const T of h)this.images[T]||(b=!1);this.isLoaded()||b?this._notify(h,g):this.requestors.push({ids:h,callback:g})}_notify(h,g){const b={};for(const T of h){this.images[T]||this.fire(new o.Event("styleimagemissing",{id:T}));const C=this.images[T];C?b[T]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:o.warnOnce(`Image "${T}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}g(null,b)}getPixelSize(){const{width:h,height:g}=this.atlasImage;return{width:h,height:g}}getPattern(h){const g=this.patterns[h],b=this.getImage(h);if(!b)return null;if(g&&g.position.version===b.version)return g.position;if(g)g.position.version=b.version;else{const T={w:b.data.width+2,h:b.data.height+2,x:0,y:0},C=new o.ImagePosition(T,b);this.patterns[h]={bin:T,position:C}}return this._updatePatternAtlas(),this.patterns[h].position}bind(h){const g=h.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(h,this.atlasImage,g.RGBA),this.atlasTexture&&this.atlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(){const h=[];for(const C in this.patterns)h.push(this.patterns[C].bin);const{w:g,h:b}=o.potpack(h),T=this.atlasImage;T.resize({width:g||1,height:b||1});for(const C in this.patterns){const{bin:O}=this.patterns[C],R=O.x+1,F=O.y+1,Z=this.images[C].data,j=Z.width,Q=Z.height;o.RGBAImage.copy(Z,T,{x:0,y:0},{x:R,y:F},{width:j,height:Q}),o.RGBAImage.copy(Z,T,{x:0,y:Q-1},{x:R,y:F-1},{width:j,height:1}),o.RGBAImage.copy(Z,T,{x:0,y:0},{x:R,y:F+Q},{width:j,height:1}),o.RGBAImage.copy(Z,T,{x:j-1,y:0},{x:R-1,y:F},{width:1,height:Q}),o.RGBAImage.copy(Z,T,{x:0,y:0},{x:R+j,y:F},{width:1,height:Q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(h){for(const g of h){if(this.callbackDispatchedThisFrame[g])continue;this.callbackDispatchedThisFrame[g]=!0;const b=this.images[g];le(b)&&this.updateImage(g,b)}}}const ae=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(v,h){return function([g,b,T]){const C=o.degToRad(b+90),O=o.degToRad(T);return{x:g*Math.cos(C)*Math.sin(O),y:g*Math.sin(C)*Math.sin(O),z:g*Math.cos(O),azimuthal:b,polar:T}}(v.expression.evaluate(h))}interpolate(v,h,g){return{x:o.number(v.x,h.x,g),y:o.number(v.y,h.y,g),z:o.number(v.z,h.z,g),azimuthal:o.number(v.azimuthal,h.azimuthal,g),polar:o.number(v.polar,h.polar,g)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)});class ve extends o.Evented{constructor(h){super(),this._transitionable=new o.Transitionable(ae),this.setLight(h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(h,g={}){if(!this._validate(o.validateLight,h,g))for(const b in h){const T=h[b];o.endsWith(b,"-transition")?this._transitionable.setTransition(b.slice(0,-11),T):this._transitionable.setValue(b,T)}}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,g,b){return(!b||b.validate!==!1)&&o.emitValidationErrors(this,h.call(o.validateStyle,o.extend({value:g,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}const Ee=new o.Properties({source:new o.DataConstantProperty(o.spec.terrain.source),exaggeration:new o.DataConstantProperty(o.spec.terrain.exaggeration)});let He=class extends o.Evented{constructor(v,h){super(),this._transitionable=new o.Transitionable(Ee),this.set(v),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=h}get(){return this._transitionable.serialize()}set(v){for(const h in v){const g=v[h];o.endsWith(h,"-transition")?this._transitionable.setTransition(h.slice(0,-11),g):this._transitionable.setValue(h,g)}}updateTransitions(v){this._transitioning=this._transitionable.transitioned(v,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(v){this.properties=this._transitioning.possiblyEvaluate(v)}};function Oe(v,h,g,b){const T=o.smoothstep(45,65,g),[C,O]=Ve(v,b),R=o.length(h);let F=1-Math.min(1,Math.exp((R-C)/(O-C)*-6));return F*=F*F,F=Math.min(1,1.00747*F),F*T*v.alpha}function Ve(v,h){const g=.5/Math.tan(.5*h);return[v.range[0]+g,v.range[1]+g]}const Pe=new o.Properties({range:new o.DataConstantProperty(o.spec.fog.range),color:new o.DataConstantProperty(o.spec.fog.color),"high-color":new o.DataConstantProperty(o.spec.fog["high-color"]),"space-color":new o.DataConstantProperty(o.spec.fog["space-color"]),"horizon-blend":new o.DataConstantProperty(o.spec.fog["horizon-blend"]),"star-intensity":new o.DataConstantProperty(o.spec.fog["star-intensity"])});class Ke extends o.Evented{constructor(h,g){super(),this._transitionable=new o.Transitionable(Pe),this.set(h),this._transitioning=this._transitionable.untransitioned(),this._transform=g}get state(){const h=this._transform,g=h.projection.name==="globe",b=o.globeToMercatorTransition(h.zoom),T=this.properties.get("range"),C=[.5,3];return{range:g?[o.number(C[0],T[0],b),o.number(C[1],T[1],b)]:T,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(h,g={}){if(!this._validate(o.validateFog,h,g)){for(const b of Object.keys(o.spec.fog))h&&h[b]===void 0&&(h[b]=o.spec.fog[b].default);for(const b in h){const T=h[b];o.endsWith(b,"-transition")?this._transitionable.setTransition(b.slice(0,-11),T):this._transitionable.setValue(b,T)}}}getOpacity(h){if(!this._transform.projection.supportsFog)return 0;const g=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.smoothstep(45,65,h))*g.a}getOpacityAtLatLng(h,g){return this._transform.projection.supportsFog?function(b,T,C){const O=o.MercatorCoordinate.fromLngLat(T),R=C.elevation?C.elevation.getAtPointOrZero(O):0,F=[O.x,O.y,R];return o.transformMat4(F,F,C.mercatorFogMatrix),Oe(b,F,C.pitch,C._fov)}(this.state,h,g):0}getFovAdjustedRange(h){return this._transform.projection.supportsFog?Ve(this.state,h):[0,1]}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,g,b){return(!b||b.validate!==!1)&&o.emitValidationErrors(this,h.call(o.validateStyle,o.extend({value:g,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class Be{constructor(h,g){this.workerPool=h,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const b=this.workerPool.acquire(this.id);for(let T=0;T<b.length;T++){const C=new Be.Actor(b[T],g,this.id);C.name=`Worker ${T}`,this.actors.push(C)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(h,g,b){o.asyncAll(this.actors,(T,C)=>{T.send(h,g,C)},b=b||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(h=>{h.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ue(v,h,g){return h*(o.EXTENT/(v.tileSize*Math.pow(2,g-v.tileID.overscaledZ)))}Be.Actor=o.Actor;class lt{constructor(h,g,b,T){this.screenBounds=h,this.cameraPoint=g,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=b,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,T)}static createFromScreenPoints(h,g){let b,T;if(h instanceof o.Point||typeof h[0]=="number"){const C=o.Point.convert(h);b=[C],T=g.isPointAboveHorizon(C)}else{const C=o.Point.convert(h[0]),O=o.Point.convert(h[1]);b=[C,O],T=o.polygonizeBounds(C,O).every(R=>g.isPointAboveHorizon(R))}return new lt(b,g.getCameraPoint(),T,g)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(h){return o.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],h)}bufferedCameraGeometry(h){const g=this.screenBounds[0],b=this.screenBounds.length===1?this.screenBounds[0].add(new o.Point(1,1)):this.screenBounds[1],T=o.polygonizeBounds(g,b,0,!1);return this.cameraPoint.y>b.y&&(this.cameraPoint.x>g.x&&this.cameraPoint.x<b.x?T.splice(3,0,this.cameraPoint):this.cameraPoint.x>=b.x?T[2]=this.cameraPoint:this.cameraPoint.x<=g.x&&(T[3]=this.cameraPoint)),o.bufferConvexPolygon(T,h)}bufferedCameraGeometryGlobe(h){const g=this.screenBounds[0],b=this.screenBounds.length===1?this.screenBounds[0].add(new o.Point(1,1)):this.screenBounds[1],T=o.polygonizeBounds(g,b,h),C=this.cameraPoint.clone();switch(3*((C.y>g.y)+(C.y>b.y))+((C.x>g.x)+(C.x>b.x))){case 0:T[0]=C,T[4]=C.clone();break;case 1:T.splice(1,0,C);break;case 2:T[1]=C;break;case 3:T.splice(4,0,C);break;case 5:T.splice(2,0,C);break;case 6:T[3]=C;break;case 7:T.splice(3,0,C);break;case 8:T[2]=C}return T}containsTile(h,g,b,T=0){const C=h.queryPadding/g._pixelsPerMercatorPixel+1,O=b?this._bufferedCameraMercator(C,g):this._bufferedScreenMercator(C,g);let R=h.tileID.wrap+(O.unwrapped?T:0);const F=O.polygon.map(ge=>o.getTilePoint(h.tileTransform,ge,R));if(!o.polygonIntersectsBox(F,0,0,o.EXTENT,o.EXTENT))return;R=h.tileID.wrap+(this.screenGeometryMercator.unwrapped?T:0);const Z=this.screenGeometryMercator.polygon.map(ge=>o.getTileVec3(h.tileTransform,ge,R)),j=Z.map(ge=>new o.Point(ge[0],ge[1])),Q=g.getFreeCameraOptions().position||new o.MercatorCoordinate(0,0,0),oe=o.getTileVec3(h.tileTransform,Q,R),he=Z.map(ge=>{const ee=o.sub(ge,ge,oe);return o.normalize(ee,ee),new o.Ray(oe,ee)}),pe=Ue(h,1,g.zoom)*g._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:j,tilespaceRays:he,bufferedTilespaceGeometry:F,bufferedTilespaceBounds:(de=o.getBounds(F),de.min.x=o.clamp(de.min.x,0,o.EXTENT),de.min.y=o.clamp(de.min.y,0,o.EXTENT),de.max.x=o.clamp(de.max.x,0,o.EXTENT),de.max.y=o.clamp(de.max.y,0,o.EXTENT),de),tile:h,tileID:h.tileID,pixelToTileUnitsFactor:pe};var de}_bufferedScreenMercator(h,g){const b=Wt(h);if(this._screenRaycastCache[b])return this._screenRaycastCache[b];{let T;return T=g.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(h),g):{polygon:this.bufferedScreenGeometry(h).map(C=>g.pointCoordinate3D(C)),unwrapped:!0},this._screenRaycastCache[b]=T,T}}_bufferedCameraMercator(h,g){const b=Wt(h);if(this._cameraRaycastCache[b])return this._cameraRaycastCache[b];{let T;return T=g.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(h),g):{polygon:this.bufferedCameraGeometry(h).map(C=>g.pointCoordinate3D(C)),unwrapped:!0},this._cameraRaycastCache[b]=T,T}}_projectAndResample(h,g){const b=function(C,O){const R=o.multiply([],O.pixelMatrix,O.globeMatrix),F=[0,-o.GLOBE_RADIUS,0,1],Z=[0,o.GLOBE_RADIUS,0,1],j=[0,0,0,1];o.transformMat4$1(F,F,R),o.transformMat4$1(Z,Z,R),o.transformMat4$1(j,j,R);const Q=new o.Point(F[0]/F[3],F[1]/F[3]),oe=new o.Point(Z[0]/Z[3],Z[1]/Z[3]),he=o.polygonContainsPoint(C,Q)&&F[3]<j[3],pe=o.polygonContainsPoint(C,oe)&&Z[3]<j[3];if(!he&&!pe)return null;const de=function(Re,Ge,ze){for(let Qe=1;Qe<Re.length;Qe++){const Et=Nt(Ge.pointCoordinate3D(Re[Qe-1]).x),Xe=Nt(Ge.pointCoordinate3D(Re[Qe]).x);if(ze<0){if(Et<Xe)return{idx:Qe,t:-Et/(Xe-1-Et)}}else if(Xe<Et)return{idx:Qe,t:(1-Et)/(Xe+1-Et)}}return null}(C,O,he?-1:1);if(!de)return null;const{idx:ge,t:ee}=de;let ce=ge>1?xt(C.slice(0,ge),O):[],_e=ge<C.length?xt(C.slice(ge),O):[];ce=ce.map(Re=>new o.Point(Nt(Re.x),Re.y)),_e=_e.map(Re=>new o.Point(Nt(Re.x),Re.y));const xe=[...ce];xe.length===0&&xe.push(_e[_e.length-1]);const De=o.number(xe[xe.length-1].y,(_e.length===0?ce[0]:_e[0]).y,ee);let ke;return ke=he?[new o.Point(0,De),new o.Point(0,0),new o.Point(1,0),new o.Point(1,De)]:[new o.Point(1,De),new o.Point(1,1),new o.Point(0,1),new o.Point(0,De)],xe.push(...ke),_e.length===0?xe.push(ce[0]):xe.push(..._e),{polygon:xe.map(Re=>new o.MercatorCoordinate(Re.x,Re.y)),unwrapped:!1}}(h,g);if(b)return b;const T=function(C,O){let R=!1,F=-1/0,Z=0;for(let Q=0;Q<C.length-1;Q++)C[Q].x>F&&(F=C[Q].x,Z=Q);for(let Q=0;Q<C.length-1;Q++){const oe=(Z+Q)%(C.length-1),he=C[oe],pe=C[oe+1];Math.abs(he.x-pe.x)>.5&&(he.x<pe.x?(he.x+=1,oe===0&&(C[C.length-1].x+=1)):(pe.x+=1,oe+1===C.length-1&&(C[0].x+=1)),R=!0)}const j=o.mercatorXfromLng(O.center.lng);return R&&j<Math.abs(j-1)&&C.forEach(Q=>{Q.x-=1}),{polygon:C,unwrapped:R}}(xt(h,g).map(C=>new o.Point(Nt(C.x),C.y)),g);return{polygon:T.polygon.map(C=>new o.MercatorCoordinate(C.x,C.y)),unwrapped:T.unwrapped}}}function xt(v,h){return o.resample(v,g=>{const b=h.pointCoordinate3D(g);g.x=b.x,g.y=b.y},1/256)}function Nt(v){return v<0?1+v%1:v%1}function Wt(v){return 100*v|0}function Je(v,h,g,b,T){const C=function(O,R){if(O)return T(O);if(R){v.url&&R.tiles&&v.tiles&&delete v.tiles;const F=o.pick(o.extend(R,v),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);R.vector_layers&&(F.vectorLayers=R.vector_layers,F.vectorLayerIds=F.vectorLayers.map(Z=>Z.id)),F.tiles=h.canonicalizeTileset(F,v.url),T(null,F)}};return v.url?o.getJSON(h.transformRequest(h.normalizeSourceURL(v.url,null,g,b),o.ResourceType.Source),C):o.exported.frame(()=>C(null,v))}class Kt{constructor(h,g,b){this.bounds=o.LngLatBounds.convert(this.validateBounds(h)),this.minzoom=g||0,this.maxzoom=b||24}validateBounds(h){return Array.isArray(h)&&h.length===4?[Math.max(-180,h[0]),Math.max(-90,h[1]),Math.min(180,h[2]),Math.min(90,h[3])]:[-180,-90,180,90]}contains(h){const g=Math.pow(2,h.z),b=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*g),T=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*g),C=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*g),O=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*g);return h.x>=b&&h.x<C&&h.y>=T&&h.y<O}}class Vt{constructor(h,g,b){this.context=h;const T=h.gl;this.buffer=T.createBuffer(),this.dynamicDraw=!!b,this.context.unbindVAO(),h.bindElementBuffer.set(this.buffer),T.bufferData(T.ELEMENT_ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||g.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(h){const g=this.context.gl;this.context.unbindVAO(),this.bind(),g.bufferSubData(g.ELEMENT_ARRAY_BUFFER,0,h.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const dt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Jt{constructor(h,g,b,T){this.length=g.length,this.attributes=b,this.itemSize=g.bytesPerElement,this.dynamicDraw=T,this.context=h;const C=h.gl;this.buffer=C.createBuffer(),h.bindVertexBuffer.set(this.buffer),C.bufferData(C.ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||g.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(h){const g=this.context.gl;this.bind(),g.bufferSubData(g.ARRAY_BUFFER,0,h.arrayBuffer)}enableAttributes(h,g){for(let b=0;b<this.attributes.length;b++){const T=g.attributes[this.attributes[b].name];T!==void 0&&h.enableVertexAttribArray(T)}}setVertexAttribPointers(h,g,b){for(let T=0;T<this.attributes.length;T++){const C=this.attributes[T],O=g.attributes[C.name];O!==void 0&&h.vertexAttribPointer(O,C.components,h[dt[C.type]],!1,this.itemSize,C.offset+this.itemSize*(b||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ut{constructor(h){this.gl=h.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(h){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class we extends Ut{getDefault(){return o.Color.transparent}set(h){const g=this.current;(h.r!==g.r||h.g!==g.g||h.b!==g.b||h.a!==g.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class Ce extends Ut{getDefault(){return 1}set(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)}}class je extends Ut{getDefault(){return 0}set(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)}}class nt extends Ut{getDefault(){return[!0,!0,!0,!0]}set(h){const g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||h[3]!==g[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class st extends Ut{getDefault(){return!0}set(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)}}class vt extends Ut{getDefault(){return 255}set(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)}}class Dt extends Ut{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(h){const g=this.current;(h.func!==g.func||h.ref!==g.ref||h.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)}}class Ct extends Ut{getDefault(){const h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]}set(h){const g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)}}class Gt extends Ut{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;h?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=h,this.dirty=!1}}class Tt extends Ut{getDefault(){return[0,1]}set(h){const g=this.current;(h[0]!==g[0]||h[1]!==g[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)}}class fn extends Ut{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;h?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=h,this.dirty=!1}}class un extends Ut{getDefault(){return this.gl.LESS}set(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)}}class xn extends Ut{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;h?g.enable(g.BLEND):g.disable(g.BLEND),this.current=h,this.dirty=!1}}class Mn extends Ut{getDefault(){const h=this.gl;return[h.ONE,h.ZERO]}set(h){const g=this.current;(h[0]!==g[0]||h[1]!==g[1]||this.dirty)&&(this.gl.blendFunc(h[0],h[1]),this.current=h,this.dirty=!1)}}class Wn extends Ut{getDefault(){return o.Color.transparent}set(h){const g=this.current;(h.r!==g.r||h.g!==g.g||h.b!==g.b||h.a!==g.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class hr extends Ut{getDefault(){return this.gl.FUNC_ADD}set(h){(h!==this.current||this.dirty)&&(this.gl.blendEquation(h),this.current=h,this.dirty=!1)}}class gr extends Ut{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;h?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=h,this.dirty=!1}}class ki extends Ut{getDefault(){return this.gl.BACK}set(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)}}class Uo extends Ut{getDefault(){return this.gl.CCW}set(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)}}let Ss,Cc=class extends Ut{getDefault(){return null}set(v){(v!==this.current||this.dirty)&&(this.gl.useProgram(v),this.current=v,this.dirty=!1)}};class Ts extends Ut{getDefault(){return this.gl.TEXTURE0}set(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)}}class pl extends Ut{getDefault(){const h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]}set(h){const g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||h[3]!==g[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class vo extends Ut{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,h),this.current=h,this.dirty=!1}}class Wo extends Ut{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class Fu extends Ut{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;g.bindTexture(g.TEXTURE_2D,h),this.current=h,this.dirty=!1}}class vg extends Ut{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class Te extends Ut{getDefault(){return null}set(h){const g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class ne extends Ut{constructor(h){super(h),this.vao=h.extVertexArrayObject}getDefault(){return null}set(h){this.vao&&(h!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(h),this.current=h,this.dirty=!1)}}class re extends Ut{getDefault(){return 4}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}}class be extends Ut{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}}class Le extends Ut{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}}class Fe extends Ut{constructor(h,g){super(h),this.context=h,this.parent=g}getDefault(){return null}}class Ze extends Fe{setDirty(){this.dirty=!0}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}}class qe extends Fe{attachment(){return this.gl.DEPTH_ATTACHMENT}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,this.attachment(),g.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class Ne extends qe{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class ot{constructor(h,g,b,T){this.context=h,this.width=g,this.height=b;const C=this.framebuffer=h.gl.createFramebuffer();this.colorAttachment=new Ze(h,C),T&&(this.depthAttachment=new qe(h,C))}destroy(){const h=this.context.gl,g=this.colorAttachment.get();if(g&&h.deleteTexture(g),this.depthAttachment){const b=this.depthAttachment.get();b&&h.deleteRenderbuffer(b)}h.deleteFramebuffer(this.framebuffer)}}class Rt{constructor(h,g=!1){if(this.gl=h,this.isWebGL2=g,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),g){const b=h;this.extVertexArrayObject={createVertexArrayOES:b.createVertexArray.bind(h),deleteVertexArrayOES:b.deleteVertexArray.bind(h),bindVertexArrayOES:b.bindVertexArray.bind(h)}}this.clearColor=new we(this),this.clearDepth=new Ce(this),this.clearStencil=new je(this),this.colorMask=new nt(this),this.depthMask=new st(this),this.stencilMask=new vt(this),this.stencilFunc=new Dt(this),this.stencilOp=new Ct(this),this.stencilTest=new Gt(this),this.depthRange=new Tt(this),this.depthTest=new fn(this),this.depthFunc=new un(this),this.blend=new xn(this),this.blendFunc=new Mn(this),this.blendColor=new Wn(this),this.blendEquation=new hr(this),this.cullFace=new gr(this),this.cullFaceSide=new ki(this),this.frontFace=new Uo(this),this.program=new Cc(this),this.activeTexture=new Ts(this),this.viewport=new pl(this),this.bindFramebuffer=new vo(this),this.bindRenderbuffer=new Wo(this),this.bindTexture=new Fu(this),this.bindVertexBuffer=new vg(this),this.bindElementBuffer=new Te(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ne(this),this.pixelStoreUnpack=new re(this),this.pixelStoreUnpackPremultiplyAlpha=new be(this),this.pixelStoreUnpackFlipY=new Le(this),this.extTextureFilterAnisotropic=h.getExtension("EXT_texture_filter_anisotropic")||h.getExtension("MOZ_EXT_texture_filter_anisotropic")||h.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=h.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=h.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=h.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=h.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),g||(this.extTextureHalfFloat=h.getExtension("OES_texture_half_float")),(g||this.extTextureHalfFloat&&h.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=h.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=g||h.getExtension("OES_standard_derivatives"),this.extTimerQuery=h.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=h.getParameter(h.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(h,g){return new Vt(this,h,g)}createVertexBuffer(h,g,b){return new Jt(this,h,g,b)}createRenderbuffer(h,g,b){const T=this.gl,C=T.createRenderbuffer();return this.bindRenderbuffer.set(C),T.renderbufferStorage(T.RENDERBUFFER,h,g,b),this.bindRenderbuffer.set(null),C}createFramebuffer(h,g,b){return new ot(this,h,g,b)}clear({color:h,depth:g,stencil:b}){const T=this.gl;let C=0;h&&(C|=T.COLOR_BUFFER_BIT,this.clearColor.set(h),this.colorMask.set([!0,!0,!0,!0])),g!==void 0&&(C|=T.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(g),this.depthMask.set(!0)),b!==void 0&&(C|=T.STENCIL_BUFFER_BIT,this.clearStencil.set(b),this.stencilMask.set(255)),T.clear(C)}setCullFace(h){h.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(h.mode),this.frontFace.set(h.frontFace))}setDepthMode(h){h.func!==this.gl.ALWAYS||h.mask?(this.depthTest.set(!0),this.depthFunc.set(h.func),this.depthMask.set(h.mask),this.depthRange.set(h.range)):this.depthTest.set(!1)}setStencilMode(h){h.test.func!==this.gl.ALWAYS||h.mask?(this.stencilTest.set(!0),this.stencilMask.set(h.mask),this.stencilOp.set([h.fail,h.depthFail,h.pass]),this.stencilFunc.set({func:h.test.func,ref:h.ref,mask:h.test.mask})):this.stencilTest.set(!1)}setColorMode(h){f(h.blendFunction,o.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(h.blendFunction),this.blendColor.set(h.blendColor)),this.colorMask.set(h.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class zt extends o.Evented{constructor(h,g,b,T){if(super(),this.id=h,this.dispatcher=b,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(g,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},g),this._collectResourceTiming=g.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(T),this._tileWorkers={},this._deduped=new o.DedupedRequest}load(h){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"}));const g=Array.isArray(this.map._language)?this.map._language.join():this.map._language,b=this.map._worldview;this._tileJSONRequest=Je(this._options,this.map._requestManager,g,b,(T,C)=>{this._tileJSONRequest=null,this._loaded=!0,T?(g&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${g}`),b&&b.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${b}`),this.fire(new o.ErrorEvent(T))):C&&(o.extend(this,C),C.bounds&&(this.tileBounds=new Kt(C.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(C.tiles,this.map._requestManager._customAccessToken),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(T)})}loaded(){return this._loaded}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}loadTile(h,g){const b=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),T={request:this.map._requestManager.transformRequest(b,o.ResourceType.Tile),data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:h.isSymbolTile};if(T.request.collectResourceTiming=this._collectResourceTiming,h.actor&&h.state!=="expired")h.state==="loading"?h.reloadCallback=g:h.request=h.actor.send("reloadTile",T,C.bind(this));else if(h.actor=this._tileWorkers[b]=this._tileWorkers[b]||this.dispatcher.getActor(),this.dispatcher.ready)h.request=h.actor.send("loadTile",T,C.bind(this),void 0,!0);else{const O=o.loadVectorTile.call({deduped:this._deduped},T,(R,F)=>{R||!F?C.call(this,R):(T.data={cacheControl:F.cacheControl,expires:F.expires,rawData:F.rawData.slice(0)},h.actor&&h.actor.send("loadTile",T,C.bind(this),void 0,!0))},!0);h.request={cancel:O}}function C(O,R){return delete h.request,h.aborted?g(null):O&&O.status!==404?g(O):(R&&R.resourceTiming&&(h.resourceTiming=R.resourceTiming),this.map._refreshExpiredTiles&&R&&h.setExpiryData(R),h.loadVectorData(R,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),g(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id})}unloadTile(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class At extends o.Evented{constructor(h,g,b,T){super(),this.id=h,this.dispatcher=b,this.setEventedParent(T),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},g),o.extend(this,o.pick(g,["url","scheme","tileSize"]))}load(h){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Je(this._options,this.map._requestManager,null,null,(g,b)=>{this._tileJSONRequest=null,this._loaded=!0,g?this.fire(new o.ErrorEvent(g)):b&&(o.extend(this,b),b.bounds&&(this.tileBounds=new Kt(b.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(b.tiles),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(g)})}loaded(){return this._loaded}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,g){const b=o.exported.devicePixelRatio>=2,T=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),b,this.tileSize);h.request=o.getImage(this.map._requestManager.transformRequest(T,o.ResourceType.Tile),(C,O,R,F)=>(delete h.request,h.aborted?(h.state="unloaded",g(null)):C?(h.state="errored",g(C)):O?(this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:R,expires:F}),h.setTexture(O,this.map.painter),h.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),void g(null)):g(null)))}static loadTileData(h,g,b){h.setTexture(g,b)}static unloadTileData(h,g){h.texture&&g.saveTileTexture(h.texture)}abortTile(h,g){h.request&&(h.request.cancel(),delete h.request),g()}unloadTile(h,g){h.texture&&this.map.painter.saveTileTexture(h.texture),g()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Vn(v,h,g,b,T,C,O,R){const F=[v,g,T,h,b,C,1,1,1],Z=[O,R,1],j=o.adjoint([],F),[Q,oe,he]=o.transformMat3(Z,Z,o.transpose(j,j));return o.multiply$1(F,[Q,0,0,0,oe,0,0,0,he],F)}class Hn extends o.Evented{constructor(h,g,b,T){super(),this.id=h,this.dispatcher=b,this.coordinates=g.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(T),this.options=g,this._dirty=!1}load(h,g){this._loaded=g||!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(b,T)=>{if(this._imageRequest=null,this._loaded=!0,b)this.fire(new o.ErrorEvent(b));else if(T){const{HTMLImageElement:C}=o.window;this.image=T instanceof C?o.exported.getImageData(T):T,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,h&&(this.coordinates=h),this._finishLoading()}})}loaded(){return this._loaded}updateImage(h){return this.image&&h.url?(this._imageRequest&&h.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=h.url,this.load(h.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(h){this.map=h,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(h){this.coordinates=h,this._boundsArray=void 0;const g=h.map(o.MercatorCoordinate.fromLngLat);return this.tileID=function(b){let T=1/0,C=1/0,O=-1/0,R=-1/0;for(const Q of b)T=Math.min(T,Q.x),C=Math.min(C,Q.y),O=Math.max(O,Q.x),R=Math.max(R,Q.y);const F=Math.max(O-T,R-C),Z=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),j=Math.pow(2,Z);return new o.CanonicalTileID(Z,Math.floor((T+O)/2*j),Math.floor((C+R)/2*j))}(g),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(h){for(const F in this.tiles){const Z=this.tiles[F];Z.state!=="loaded"&&(Z.state="loaded",Z.texture=this.texture)}if(this._boundsArray)return;const g=o.tileTransform(this.tileID,this.map.transform.projection),[b,T,C,O]=this.coordinates.map(F=>{const Z=g.projection.project(F[0],F[1]);return o.getTilePoint(g,Z)._round()});this.perspectiveTransform=function(F,Z,j,Q,oe,he,pe,de,ge,ee){const ce=Vn(0,0,F,0,0,Z,F,Z),_e=Vn(j,Q,oe,he,pe,de,ge,ee);return o.multiply$1(_e,o.adjoint(ce,ce),_e),[_e[6]/_e[8]*F/o.EXTENT,_e[7]/_e[8]*Z/o.EXTENT]}(this.width,this.height,b.x,b.y,T.x,T.y,O.x,O.y,C.x,C.y);const R=this._boundsArray=new o.StructArrayLayout4i8;R.emplaceBack(b.x,b.y,0,0),R.emplaceBack(T.x,T.y,o.EXTENT,0),R.emplaceBack(O.x,O.y,0,o.EXTENT),R.emplaceBack(C.x,C.y,o.EXTENT,o.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=h.createVertexBuffer(R,o.boundsAttributes.members),this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const h=this.map.painter.context,g=h.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new o.Texture(h,this.image,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(h)}loadTile(h,g){this.tileID&&this.tileID.equals(h.tileID.canonical)?(this.tiles[String(h.tileID.wrap)]=h,h.buckets={},g(null)):(h.state="errored",g(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Gn={vector:zt,raster:At,"raster-dem":class extends At{constructor(v,h,g,b){super(v,h,g,b),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}loadTile(v,h){const g=this.map._requestManager.normalizeTileURL(v.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function b(T,C){T&&(v.state="errored",h(T)),C&&(v.dem=C,v.dem.onDeserialize(),v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0,v.state="loaded",h(null))}v.request=o.getImage(this.map._requestManager.transformRequest(g,o.ResourceType.Tile),(function(T,C,O,R){if(delete v.request,v.aborted)v.state="unloaded",h(null);else if(T)v.state="errored",h(T);else if(C){this.map._refreshExpiredTiles&&v.setExpiryData({cacheControl:O,expires:R});const F=o.window.ImageBitmap&&C instanceof o.window.ImageBitmap&&(Ss==null&&(Ss=o.window.OffscreenCanvas&&new o.window.OffscreenCanvas(1,1).getContext("2d")&&typeof o.window.createImageBitmap=="function"),Ss),Z=1-(C.width-o.prevPowerOfTwo(C.width))/2;Z<1||v.neighboringTiles||(v.neighboringTiles=this._getNeighboringTiles(v.tileID));const j=F?C:o.exported.getImageData(C,Z),Q={uid:v.uid,coord:v.tileID,source:this.id,rawImageData:j,encoding:this.encoding,padding:Z};v.actor&&v.state!=="expired"||(v.actor=this.dispatcher.getActor(),v.actor.send("loadDEMTile",Q,b.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(v){const h=v.canonical,g=Math.pow(2,h.z),b=(h.x-1+g)%g,T=h.x===0?v.wrap-1:v.wrap,C=(h.x+1+g)%g,O=h.x+1===g?v.wrap+1:v.wrap,R={};return R[new o.OverscaledTileID(v.overscaledZ,T,h.z,b,h.y).key]={backfilled:!1},R[new o.OverscaledTileID(v.overscaledZ,O,h.z,C,h.y).key]={backfilled:!1},h.y>0&&(R[new o.OverscaledTileID(v.overscaledZ,T,h.z,b,h.y-1).key]={backfilled:!1},R[new o.OverscaledTileID(v.overscaledZ,v.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},R[new o.OverscaledTileID(v.overscaledZ,O,h.z,C,h.y-1).key]={backfilled:!1}),h.y+1<g&&(R[new o.OverscaledTileID(v.overscaledZ,T,h.z,b,h.y+1).key]={backfilled:!1},R[new o.OverscaledTileID(v.overscaledZ,v.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},R[new o.OverscaledTileID(v.overscaledZ,O,h.z,C,h.y+1).key]={backfilled:!1}),R}unloadTile(v){v.demTexture&&this.map.painter.saveTileTexture(v.demTexture),v.fbo&&(v.fbo.destroy(),delete v.fbo),v.dem&&delete v.dem,delete v.neighboringTiles,v.state="unloaded"}},geojson:class extends o.Evented{constructor(v,h,g,b){super(),this.id=v,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=g.getActor(),this.setEventedParent(b),this._data=h.data,this._options=o.extend({},h),this._collectResourceTiming=h.collectResourceTiming,h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const T=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*T,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*T,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:o.EXTENT,radius:(h.clusterRadius!==void 0?h.clusterRadius:50)*T,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions)}onAdd(v){this.map=v,this.setData(this._data)}setData(v){return this._data=v,this._updateWorkerData(),this}getClusterExpansionZoom(v,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:v,source:this.id},h),this}getClusterChildren(v,h){return this.actor.send("geojson.getClusterChildren",{clusterId:v,source:this.id},h),this}getClusterLeaves(v,h,g,b){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:v,limit:h,offset:g},b),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.Event("dataloading",{dataType:"source"})),this._loaded=!1;const v=o.extend({},this.workerOptions),h=this._data;typeof h=="string"?(v.request=this.map._requestManager.transformRequest(o.exported.resolveURL(h),o.ResourceType.Source),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(h),this._pendingLoad=this.actor.send(`${this.type}.loadData`,v,(g,b)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new o.ErrorEvent(g));else{const T={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&b&&b.resourceTiming&&b.resourceTiming[this.id]&&(T.resourceTiming=b.resourceTiming[this.id]),this.fire(new o.Event("data",T)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(v,h){const g=v.actor?"reloadTile":"loadTile";v.actor=this.actor,v.request=this.actor.send(g,{type:this.type,uid:v.uid,tileID:v.tileID,tileZoom:v.tileZoom,zoom:v.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(b,T)=>(delete v.request,v.unloadVectorData(),v.aborted?h(null):b?h(b):(v.loadVectorData(T,this.map.painter,g==="reloadTile"),h(null))),void 0,g==="loadTile")}abortTile(v){v.request&&(v.request.cancel(),delete v.request),v.aborted=!0}unloadTile(v){v.unloadVectorData(),this.actor.send("removeTile",{uid:v.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Hn{constructor(v,h,g,b){super(v,h,g,b),this.roundZoom=!0,this.type="video",this.options=h}load(){this._loaded=!1;const v=this.options;this.urls=[];for(const h of v.urls)this.urls.push(this.map._requestManager.transformRequest(h,o.ResourceType.Source).url);o.getVideo(this.urls,(h,g)=>{this._loaded=!0,h?this.fire(new o.ErrorEvent(h)):g&&(this.video=g,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(v){if(this.video){const h=this.video.seekable;v<h.start(0)||v>h.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=v}}getVideo(){return this.video}onAdd(v){this.map||(this.map=v,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const v=this.map.painter.context,h=v.gl;this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(v,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(v)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Hn,canvas:class extends Hn{constructor(v,h,g,b){super(v,h,g,b),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some(T=>!Array.isArray(T)||T.length!==2||T.some(C=>typeof C!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${v}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${v}`,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${v}`,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${v}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${v}`,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(v){this.map=v,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let v=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,v=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,v=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const h=this.map.painter.context;this.texture?(v||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(h,this.canvas,h.gl.RGBA,{premultiply:!0}),this._prepareData(h)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const v of[this.canvas.width,this.canvas.height])if(isNaN(v)||v<=0)return!0;return!1}},custom:class extends o.Evented{constructor(v,h,g,b){super(),this.id=v,this.type="custom",this._dataType="raster",this._dispatcher=g,this._implementation=h,this.setEventedParent(b),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Kt(this._implementation.bounds,this.minzoom,this.maxzoom)),h.update=this._update.bind(this),h.clearTiles=this._clearTiles.bind(this),h.coveringTiles=this._coveringTiles.bind(this),o.extend(this,o.pick(h,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(v){this._map=v,this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(v),this.load()}onRemove(v){this._implementation.onRemove&&this._implementation.onRemove(v)}hasTile(v){if(this._implementation.hasTile){const{x:h,y:g,z:b}=v.canonical;return this._implementation.hasTile({x:h,y:g,z:b})}return!this.tileBounds||this.tileBounds.contains(v.canonical)}loadTile(v,h){const{x:g,y:b,z:T}=v.tileID.canonical,C=new o.window.AbortController;v.request=Promise.resolve(this._implementation.loadTile({x:g,y:b,z:T},{signal:C.signal})).then((function(O){return delete v.request,v.aborted?(v.state="unloaded",h(null)):O===void 0?(v.state="errored",h(null)):O===null?(this.loadTileData(v,{width:this.tileSize,height:this.tileSize,data:null}),v.state="loaded",h(null)):function(R){return R instanceof o.window.ImageData||R instanceof o.window.HTMLCanvasElement||R instanceof o.window.ImageBitmap||R instanceof o.window.HTMLImageElement}(O)?(this.loadTileData(v,O),v.state="loaded",void h(null)):(v.state="errored",h(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(O=>{O.code!==20&&(v.state="errored",h(O))}),v.request.cancel=()=>C.abort()}loadTileData(v,h){At.loadTileData(v,h,this._map.painter)}unloadTileData(v){At.unloadTileData(v,this._map.painter)}unloadTile(v,h){if(this.unloadTileData(v),this._implementation.unloadTile){const{x:g,y:b,z:T}=v.tileID.canonical;this._implementation.unloadTile({x:g,y:b,z:T})}h()}abortTile(v,h){v.request&&v.request.cancel&&(v.request.cancel(),delete v.request),h()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(v=>({x:v.canonical.x,y:v.canonical.y,z:v.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Yn=function(v,h,g,b){const T=new Gn[h.type](v,h,g,b);if(T.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${T.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],T),T};function lr(v,h){const g=o.identity([]);return o.scale(g,g,[.5*v.width,.5*-v.height,1]),o.translate(g,g,[1,-1,0]),o.multiply(g,g,v.calculateProjMatrix(h.toUnwrapped())),Float32Array.from(g)}function $i(v,h,g,b,T,C,O,R=!1){const F=v.tilesIn(b,O,R);F.sort(Ia);const Z=[];for(const Q of F)Z.push({wrappedTileID:Q.tile.tileID.wrapped().key,queryResults:Q.tile.queryRenderedFeatures(h,g,v._state,Q,T,C,lr(v.transform,Q.tile.tileID),R)});const j=function(Q){const oe={},he={};for(const pe of Q){const de=pe.queryResults,ge=pe.wrappedTileID,ee=he[ge]=he[ge]||{};for(const ce in de){const _e=de[ce],xe=ee[ce]=ee[ce]||{},De=oe[ce]=oe[ce]||[];for(const ke of _e)xe[ke.featureIndex]||(xe[ke.featureIndex]=!0,De.push(ke))}}return oe}(Z);for(const Q in j)j[Q].forEach(oe=>{const he=oe.feature,pe=he.layer;pe&&pe.type!=="background"&&pe.type!=="sky"&&(he.source=pe.source,pe["source-layer"]&&(he.sourceLayer=pe["source-layer"]),he.state=he.id!==void 0?v.getFeatureState(pe["source-layer"],he.id):{})});return j}function _o(v,h){const g=v.getRenderableIds().map(C=>v.getTileByID(C)),b=[],T={};for(let C=0;C<g.length;C++){const O=g[C],R=O.tileID.canonical.key;T[R]||(T[R]=!0,O.querySourceFeatures(b,h))}return b}function Ia(v,h){const g=v.tileID,b=h.tileID;return g.overscaledZ-b.overscaledZ||g.canonical.y-b.canonical.y||g.wrap-b.wrap||g.canonical.x-b.canonical.x}function No(){return Lf.workerClass!=null?new Lf.workerClass:new o.window.Worker(Lf.workerUrl)}const Gl="mapboxgl_preloaded_worker_pool";class Ho{constructor(){this.active={}}acquire(h){if(!this.workers)for(this.workers=[];this.workers.length<Ho.workerCount;)this.workers.push(new No);return this.active[h]=!0,this.workers.slice()}release(h){delete this.active[h],this.numActive()===0&&(this.workers.forEach(g=>{g.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Gl]}numActive(){return Object.keys(this.active).length}}let Xa;function df(){return Xa||(Xa=new Ho),Xa}function dE(v,h){const g={};for(const b in v)b!=="ref"&&(g[b]=v[b]);return o.refProperties.forEach(b=>{b in h&&(g[b]=h[b])}),g}function c1(v){v=v.slice();const h=Object.create(null);for(let g=0;g<v.length;g++)h[v[g].id]=v[g];for(let g=0;g<v.length;g++)"ref"in v[g]&&(v[g]=dE(v[g],h[v[g].ref]));return v}Ho.workerCount=2;const Kr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function qy(v,h,g){g.push({command:Kr.addSource,args:[v,h[v]]})}function Id(v,h,g){h.push({command:Kr.removeSource,args:[v]}),g[v]=!0}function Zy(v,h,g,b){Id(v,g,b),qy(v,h,g)}function _g(v,h,g){let b;for(b in v[g])if(v[g].hasOwnProperty(b)&&b!=="data"&&!f(v[g][b],h[g][b]))return!1;for(b in h[g])if(h[g].hasOwnProperty(b)&&b!=="data"&&!f(v[g][b],h[g][b]))return!1;return!0}function $l(v,h,g,b,T,C){let O;for(O in h=h||{},v=v||{})v.hasOwnProperty(O)&&(f(v[O],h[O])||g.push({command:C,args:[b,O,h[O],T]}));for(O in h)h.hasOwnProperty(O)&&!v.hasOwnProperty(O)&&(f(v[O],h[O])||g.push({command:C,args:[b,O,h[O],T]}))}function Bu(v){return v.id}function Xy(v,h){return v[h.id]=h,v}class Wy{constructor(h,g){this.reset(h,g)}reset(h,g){this.points=h||[],this._distances=[0];for(let b=1;b<this.points.length;b++)this._distances[b]=this._distances[b-1]+this.points[b].dist(this.points[b-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(g||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(h){if(this.points.length===1)return this.points[0];h=o.clamp(h,0,1);let g=1,b=this._distances[g];const T=h*this.paddedLength+this.padding;for(;b<T&&g<this._distances.length;)b=this._distances[++g];const C=g-1,O=this._distances[C],R=b-O,F=R>0?(T-O)/R:0;return this.points[C].mult(1-F).add(this.points[g].mult(F))}}class fh{constructor(h,g,b){const T=this.boxCells=[],C=this.circleCells=[];this.xCellCount=Math.ceil(h/b),this.yCellCount=Math.ceil(g/b);for(let O=0;O<this.xCellCount*this.yCellCount;O++)T.push([]),C.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=h,this.height=g,this.xScale=this.xCellCount/h,this.yScale=this.yCellCount/g,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(h,g,b,T,C){this._forEachCell(g,b,T,C,this._insertBoxCell,this.boxUid++),this.boxKeys.push(h),this.bboxes.push(g),this.bboxes.push(b),this.bboxes.push(T),this.bboxes.push(C)}insertCircle(h,g,b,T){this._forEachCell(g-T,b-T,g+T,b+T,this._insertCircleCell,this.circleUid++),this.circleKeys.push(h),this.circles.push(g),this.circles.push(b),this.circles.push(T)}_insertBoxCell(h,g,b,T,C,O){this.boxCells[C].push(O)}_insertCircleCell(h,g,b,T,C,O){this.circleCells[C].push(O)}_query(h,g,b,T,C,O){if(b<0||h>this.width||T<0||g>this.height)return!C&&[];const R=[];if(h<=0&&g<=0&&this.width<=b&&this.height<=T){if(C)return!0;for(let F=0;F<this.boxKeys.length;F++)R.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(let F=0;F<this.circleKeys.length;F++){const Z=this.circles[3*F],j=this.circles[3*F+1],Q=this.circles[3*F+2];R.push({key:this.circleKeys[F],x1:Z-Q,y1:j-Q,x2:Z+Q,y2:j+Q})}return O?R.filter(O):R}return this._forEachCell(h,g,b,T,this._queryCell,R,{hitTest:C,seenUids:{box:{},circle:{}}},O),C?R.length>0:R}_queryCircle(h,g,b,T,C){const O=h-b,R=h+b,F=g-b,Z=g+b;if(R<0||O>this.width||Z<0||F>this.height)return!T&&[];const j=[];return this._forEachCell(O,F,R,Z,this._queryCellCircle,j,{hitTest:T,circle:{x:h,y:g,radius:b},seenUids:{box:{},circle:{}}},C),T?j.length>0:j}query(h,g,b,T,C){return this._query(h,g,b,T,!1,C)}hitTest(h,g,b,T,C){return this._query(h,g,b,T,!0,C)}hitTestCircle(h,g,b,T){return this._queryCircle(h,g,b,!0,T)}_queryCell(h,g,b,T,C,O,R,F){const Z=R.seenUids,j=this.boxCells[C];if(j!==null){const oe=this.bboxes;for(const he of j)if(!Z.box[he]){Z.box[he]=!0;const pe=4*he;if(h<=oe[pe+2]&&g<=oe[pe+3]&&b>=oe[pe+0]&&T>=oe[pe+1]&&(!F||F(this.boxKeys[he]))){if(R.hitTest)return O.push(!0),!0;O.push({key:this.boxKeys[he],x1:oe[pe],y1:oe[pe+1],x2:oe[pe+2],y2:oe[pe+3]})}}}const Q=this.circleCells[C];if(Q!==null){const oe=this.circles;for(const he of Q)if(!Z.circle[he]){Z.circle[he]=!0;const pe=3*he;if(this._circleAndRectCollide(oe[pe],oe[pe+1],oe[pe+2],h,g,b,T)&&(!F||F(this.circleKeys[he]))){if(R.hitTest)return O.push(!0),!0;{const de=oe[pe],ge=oe[pe+1],ee=oe[pe+2];O.push({key:this.circleKeys[he],x1:de-ee,y1:ge-ee,x2:de+ee,y2:ge+ee})}}}}}_queryCellCircle(h,g,b,T,C,O,R,F){const Z=R.circle,j=R.seenUids,Q=this.boxCells[C];if(Q!==null){const he=this.bboxes;for(const pe of Q)if(!j.box[pe]){j.box[pe]=!0;const de=4*pe;if(this._circleAndRectCollide(Z.x,Z.y,Z.radius,he[de+0],he[de+1],he[de+2],he[de+3])&&(!F||F(this.boxKeys[pe])))return O.push(!0),!0}}const oe=this.circleCells[C];if(oe!==null){const he=this.circles;for(const pe of oe)if(!j.circle[pe]){j.circle[pe]=!0;const de=3*pe;if(this._circlesCollide(he[de],he[de+1],he[de+2],Z.x,Z.y,Z.radius)&&(!F||F(this.circleKeys[pe])))return O.push(!0),!0}}}_forEachCell(h,g,b,T,C,O,R,F){const Z=this._convertToXCellCoord(h),j=this._convertToYCellCoord(g),Q=this._convertToXCellCoord(b),oe=this._convertToYCellCoord(T);for(let he=Z;he<=Q;he++)for(let pe=j;pe<=oe;pe++)if(C.call(this,h,g,b,T,this.xCellCount*pe+he,O,R,F))return}_convertToXCellCoord(h){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(h*this.xScale)))}_convertToYCellCoord(h){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(h*this.yScale)))}_circlesCollide(h,g,b,T,C,O){const R=T-h,F=C-g,Z=b+O;return Z*Z>R*R+F*F}_circleAndRectCollide(h,g,b,T,C,O,R){const F=(O-T)/2,Z=Math.abs(h-(T+F));if(Z>F+b)return!1;const j=(R-C)/2,Q=Math.abs(g-(C+j));if(Q>j+b)return!1;if(Z<=F||Q<=j)return!0;const oe=Z-F,he=Q-j;return oe*oe+he*he<=b*b}}const zu={unknown:0,flipRequired:1,flipNotRequired:2},Cd=Math.tan(85*Math.PI/180);function ct(v,h,g,b,T,C,O){const R=o.create();if(g)if(C.name==="globe"){const F=o.calculateGlobeLabelMatrix(T,h);o.multiply(R,R,F)}else{const F=U([],O);R[0]=F[0],R[1]=F[1],R[4]=F[2],R[5]=F[3],b||o.rotateZ(R,R,T.angle)}else o.multiply(R,T.labelPlaneMatrix,v);return R}function Uu(v,h,g,b,T,C,O){const R=ct(v,h,g,b,T,C,O);return C.name==="globe"&&g||(R[2]=R[6]=R[10]=R[14]=0),R}function xo(v,h,g,b,T,C,O){if(g){if(C.name==="globe"){const R=ct(v,h,g,b,T,C,O);return o.invert(R,R),o.multiply(R,v,R),R}{const R=o.clone(v),F=o.identity([]);return F[0]=O[0],F[1]=O[1],F[4]=O[2],F[5]=O[3],o.multiply(R,R,F),b||o.rotateZ(R,R,-T.angle),R}}return T.glCoordMatrix}function Yo(v,h,g,b){const T=[v,h,g,1];g?o.transformMat4$1(T,T,b):er(T,T,b);const C=T[3];return T[0]/=C,T[1]/=C,T[2]/=C,T}function h1(v,h){return Math.min(.5+v/h*.5,1.5)}function jl(v,h){const g=v[0]/v[3],b=v[1]/v[3];return g>=-h[0]&&g<=h[0]&&b>=-h[1]&&b<=h[1]}function Hy(v,h,g,b,T,C,O,R,F,Z){const j=g.transform,Q=b?v.textSizeData:v.iconSizeData,oe=o.evaluateSizeForZoom(Q,g.transform.zoom),he=j.projection.name==="globe",pe=[256/g.width*2+1,256/g.height*2+1],de=b?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;de.clear();let ge=null;he&&(ge=b?v.text.globeExtVertexArray:v.icon.globeExtVertexArray);const ee=v.lineVertexArray,ce=b?v.text.placedSymbolArray:v.icon.placedSymbolArray,_e=g.transform.width/g.transform.height;let xe,De=!1;for(let ke=0;ke<ce.length;ke++){const Re=ce.get(ke),{numGlyphs:Ge,writingMode:ze}=Re;if(ze!==o.WritingMode.vertical||De||xe===o.WritingMode.horizontal||(De=!0),xe=ze,(Re.hidden||ze===o.WritingMode.vertical)&&!De){gl(Ge,de);continue}De=!1;const Qe=new o.Point(Re.tileAnchorX,Re.tileAnchorY);let{x:Et,y:Xe,z:gt}=j.projection.projectTilePoint(Qe.x,Qe.y,Z.canonical);if(F){const[Ln,an,En]=F(Qe);Et+=Ln,Xe+=an,gt+=En}const rt=[Et,Xe,gt,1];if(o.transformMat4$1(rt,rt,h),!jl(rt,pe)){gl(Ge,de);continue}const wt=h1(g.transform.cameraToCenterDistance,rt[3]),Ye=o.evaluateSizeForFeature(Q,oe,Re),pt=O?Ye/wt:Ye*wt,It=Yo(Et,Xe,gt,T);if(It[3]<=0){gl(Ge,de);continue}let _t={};const Pt=O?null:F,yn=Ht(Re,pt,!1,R,h,T,C,v.glyphOffsetArray,ee,de,ge,It,Qe,_t,_e,Pt,j.projection,Z,O);De=yn.useVertical,Pt&&yn.needsFlipping&&(_t={}),(yn.notEnoughRoom||De||yn.needsFlipping&&Ht(Re,pt,!0,R,h,T,C,v.glyphOffsetArray,ee,de,ge,It,Qe,_t,_e,Pt,j.projection,Z,O).notEnoughRoom)&&gl(Ge,de)}b?(v.text.dynamicLayoutVertexBuffer.updateData(de),ge&&v.text.globeExtVertexBuffer.updateData(ge)):(v.icon.dynamicLayoutVertexBuffer.updateData(de),ge&&v.icon.globeExtVertexBuffer.updateData(ge))}function f1(v,h,g,b,T,C,O,R,F,Z,j,Q,oe,he,pe,de){const{lineStartIndex:ge,glyphStartIndex:ee,segment:ce}=R,_e=ee+R.numGlyphs,xe=ge+R.lineLength,De=h.getoffsetX(ee),ke=h.getoffsetX(_e-1),Re=Is(v*De,g,b,T,C,O,ce,ge,xe,F,Z,j,Q,oe,!0,he,pe,de);if(!Re)return null;const Ge=Is(v*ke,g,b,T,C,O,ce,ge,xe,F,Z,j,Q,oe,!0,he,pe,de);return Ge?{first:Re,last:Ge}:null}function pf(v,h,g,b){return v===o.WritingMode.horizontal&&Math.abs(b)>Math.abs(g)?{useVertical:!0}:v===o.WritingMode.vertical?b>0?{needsFlipping:!0}:null:h!==zu.unknown&&function(T,C){return T===0||Math.abs(C/T)>Cd}(g,b)?h===zu.flipRequired?{needsFlipping:!0}:null:g<0?{needsFlipping:!0}:null}function Ht(v,h,g,b,T,C,O,R,F,Z,j,Q,oe,he,pe,de,ge,ee,ce){const _e=h/24,xe=v.lineOffsetX*_e,De=v.lineOffsetY*_e,{lineStartIndex:ke,glyphStartIndex:Re,numGlyphs:Ge,segment:ze,writingMode:Qe,flipState:Et}=v,Xe=ke+v.lineLength,gt=rt=>{if(j){const[It,_t,Pt]=rt.up,yn=Z.length;o.updateGlobeVertexNormal(j,yn+0,It,_t,Pt),o.updateGlobeVertexNormal(j,yn+1,It,_t,Pt),o.updateGlobeVertexNormal(j,yn+2,It,_t,Pt),o.updateGlobeVertexNormal(j,yn+3,It,_t,Pt)}const[wt,Ye,pt]=rt.point;o.addDynamicAttributes(Z,wt,Ye,pt,rt.angle)};if(Ge>1){const rt=f1(_e,R,xe,De,g,Q,oe,v,F,C,he,de,!1,ge,ee,ce);if(!rt)return{notEnoughRoom:!0};if(b&&!g){let[wt,Ye,pt]=rt.first.point,[It,_t,Pt]=rt.last.point;[wt,Ye]=Yo(wt,Ye,pt,O),[It,_t]=Yo(It,_t,Pt,O);const yn=pf(Qe,Et,(It-wt)*pe,_t-Ye);if(v.flipState=yn&&yn.needsFlipping?zu.flipRequired:zu.flipNotRequired,yn)return yn}gt(rt.first);for(let wt=Re+1;wt<Re+Ge-1;wt++){const Ye=Is(_e*R.getoffsetX(wt),xe,De,g,Q,oe,ze,ke,Xe,F,C,he,de,!1,!1,ge,ee,ce);if(!Ye)return Z.length-=4*(wt-Re),{notEnoughRoom:!0};gt(Ye)}gt(rt.last)}else{if(b&&!g){const wt=Yo(oe.x,oe.y,0,T),Ye=ke+ze+1,pt=new o.Point(F.getx(Ye),F.gety(Ye)),It=Yo(pt.x,pt.y,0,T),_t=It[3]>0?It:Qn(oe,pt,wt,1,T,void 0,ge,ee.canonical),Pt=pf(Qe,Et,(_t[0]-wt[0])*pe,_t[1]-wt[1]);if(v.flipState=Pt&&Pt.needsFlipping?zu.flipRequired:zu.flipNotRequired,Pt)return Pt}const rt=Is(_e*R.getoffsetX(Re),xe,De,g,Q,oe,ze,ke,Xe,F,C,he,de,!1,!1,ge,ee,ce);if(!rt)return{notEnoughRoom:!0};gt(rt)}return{}}function ar(v,h,g,b,T){const{x:C,y:O,z:R}=b.projectTilePoint(v.x,v.y,h);if(!T)return Yo(C,O,R,g);const[F,Z,j]=T(v);return Yo(C+F,O+Z,R+j,g)}function Qn(v,h,g,b,T,C,O,R){const F=ar(v.sub(h)._unit()._add(v),R,T,O,C);return o.sub(F,g,F),o.normalize(F,F),o.scaleAndAdd(F,g,F,b)}function Is(v,h,g,b,T,C,O,R,F,Z,j,Q,oe,he,pe,de,ge,ee){const ce=b?v-h:v+h;let _e=ce>0?1:-1,xe=0;b&&(_e*=-1,xe=Math.PI),_e<0&&(xe+=Math.PI);let De=R+O+(_e>0?0:1)|0,ke=T,Re=T,Ge=0,ze=0;const Qe=Math.abs(ce),Et=[],Xe=[];let gt=C,rt=gt;const wt=()=>Qn(rt,gt,Re,Qe-Ge+1,j,oe,de,ge.canonical);for(;Ge+ze<=Qe;){if(De+=_e,De<R||De>=F)return null;if(Re=ke,rt=gt,Et.push(Re),he&&Xe.push(rt),gt=new o.Point(Z.getx(De),Z.gety(De)),ke=Q[De],!ke){const En=ar(gt,ge.canonical,j,de,oe);ke=En[3]>0?Q[De]=En:wt()}Ge+=ze,ze=o.distance(Re,ke)}pe&&oe&&(Q[De]&&(ke=wt(),ze=o.distance(Re,ke)),Q[De]=ke);const Ye=(Qe-Ge)/ze,pt=gt.sub(rt)._mult(Ye)._add(rt),It=o.sub([],ke,Re),_t=o.scaleAndAdd([],Re,It,Ye);let Pt=[0,0,1],yn=It[0],Ln=It[1];if(ee&&(Pt=de.upVector(ge.canonical,pt.x,pt.y),Pt[0]!==0||Pt[1]!==0||Pt[2]!==1)){const En=[Pt[2],0,-Pt[0]],tr=o.cross([],Pt,En);o.normalize(En,En),o.normalize(tr,tr),yn=o.dot(It,En),Ln=o.dot(It,tr)}if(g){const En=o.cross([],Pt,It);o.normalize(En,En),o.scaleAndAdd(_t,_t,En,g*_e)}const an=xe+Math.atan2(Ln,yn);return Et.push(_t),he&&Xe.push(pt),{point:_t,angle:an,path:Et,tilePath:Xe,up:Pt}}function gl(v,h){const g=h.length,b=g+4*v;h.resize(b),h.float32.fill(-1/0,4*g,4*b)}function er(v,h,g){const b=h[0],T=h[1];return v[0]=g[0]*b+g[4]*T+g[12],v[1]=g[1]*b+g[5]*T+g[13],v[3]=g[3]*b+g[7]*T+g[15],v}const Cs=100;class Pd{constructor(h,g,b=new fh(h.width+200,h.height+200,25),T=new fh(h.width+200,h.height+200,25)){this.transform=h,this.grid=b,this.ignoredGrid=T,this.pitchfactor=Math.cos(h._pitch)*h.cameraToCenterDistance,this.screenRightBoundary=h.width+Cs,this.screenBottomBoundary=h.height+Cs,this.gridRightBoundary=h.width+200,this.gridBottomBoundary=h.height+200,this.fogState=g}placeCollisionBox(h,g,b,T,C,O,R,F){let Z=b.projectedAnchorX,j=b.projectedAnchorY,Q=b.projectedAnchorZ;const oe=b.elevation,he=b.tileID,pe=h.getProjection();if(oe&&he){const[ke,Re,Ge]=pe.upVector(he.canonical,b.tileAnchorX,b.tileAnchorY),ze=pe.upVectorScale(he.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;Z+=ke*oe*ze,j+=Re*oe*ze,Q+=Ge*oe*ze}const de=this.projectAndGetPerspectiveRatio(R,Z,j,Q,b.tileID,pe.name==="globe"||!!oe||this.transform.pitch>0,pe),ge=O*de.perspectiveRatio,ee=(b.x1*g+T.x-b.padding)*ge+de.point.x,ce=(b.y1*g+T.y-b.padding)*ge+de.point.y,_e=(b.x2*g+T.x+b.padding)*ge+de.point.x,xe=(b.y2*g+T.y+b.padding)*ge+de.point.y,De=de.perspectiveRatio<=.55||de.occluded;return!this.isInsideGrid(ee,ce,_e,xe)||!C&&this.grid.hitTest(ee,ce,_e,xe,F)||De?{box:[],offscreen:!1,occluded:de.occluded}:{box:[ee,ce,_e,xe],offscreen:this.isOffscreen(ee,ce,_e,xe),occluded:!1}}placeCollisionCircles(h,g,b,T,C,O,R,F,Z,j,Q,oe,he,pe,de){const ge=[],ee=this.transform.elevation,ce=h.getProjection(),_e=ee?ee.getAtTileOffsetFunc(de,this.transform.center.lat,this.transform.worldSize,ce):null,xe=new o.Point(b.tileAnchorX,b.tileAnchorY);let{x:De,y:ke,z:Re}=ce.projectTilePoint(xe.x,xe.y,de.canonical);if(_e){const[pt,It,_t]=_e(xe);De+=pt,ke+=It,Re+=_t}const Ge=ce.name==="globe",ze=this.projectAndGetPerspectiveRatio(R,De,ke,Re,de,Ge||!!ee||this.transform.pitch>0,ce),{perspectiveRatio:Qe}=ze,Et=(Q?O/Qe:O*Qe)/o.ONE_EM,Xe=Yo(De,ke,Re,F),gt=ze.signedDistanceFromCamera>0?f1(Et,C,b.lineOffsetX*Et,b.lineOffsetY*Et,!1,Xe,xe,b,T,F,{},ee&&!Q?_e:null,Q&&!!ee,ce,de,Q):null;let rt=!1,wt=!1,Ye=!0;if(gt&&!ze.occluded){const pt=.5*he*Qe+pe,It=new o.Point(-100,-100),_t=new o.Point(this.screenRightBoundary,this.screenBottomBoundary),Pt=new Wy,{first:yn,last:Ln}=gt,an=yn.path.length;let En=[];for(let gn=an-1;gn>=1;gn--)En.push(yn.path[gn]);for(let gn=1;gn<Ln.path.length;gn++)En.push(Ln.path[gn]);const tr=2.5*pt;Z&&(En=En.map(([gn,ni,ui],ci)=>(_e&&!Ge&&(ui=_e(ci<an-1?yn.tilePath[an-1-ci]:Ln.tilePath[ci-an+2])[2]),Yo(gn,ni,ui,Z))),En.some(gn=>gn[3]<=0)&&(En=[]));let Kn=[];if(En.length>0){let gn=1/0,ni=-1/0,ui=1/0,ci=-1/0;for(const hi of En)gn=Math.min(gn,hi[0]),ui=Math.min(ui,hi[1]),ni=Math.max(ni,hi[0]),ci=Math.max(ci,hi[1]);ni>=It.x&&gn<=_t.x&&ci>=It.y&&ui<=_t.y&&(Kn=[En.map(hi=>new o.Point(hi[0],hi[1]))],(gn<It.x||ni>_t.x||ui<It.y||ci>_t.y)&&(Kn=o.clipLine(Kn,It.x,It.y,_t.x,_t.y)))}for(const gn of Kn){Pt.reset(gn,.25*pt);let ni=0;ni=Pt.length<=.5*pt?1:Math.ceil(Pt.paddedLength/tr)+1;for(let ui=0;ui<ni;ui++){const ci=ui/Math.max(ni-1,1),hi=Pt.lerp(ci),Pa=hi.x+Cs,Jo=hi.y+Cs;ge.push(Pa,Jo,pt,0);const Zs=Pa-pt,Wl=Jo-pt,Fi=Pa+pt,fi=Jo+pt;if(Ye=Ye&&this.isOffscreen(Zs,Wl,Fi,fi),wt=wt||this.isInsideGrid(Zs,Wl,Fi,fi),!g&&this.grid.hitTestCircle(Pa,Jo,pt,oe)&&(rt=!0,!j))return{circles:[],offscreen:!1,collisionDetected:rt,occluded:!1}}}}return{circles:!j&&rt||!wt?[]:ge,offscreen:Ye,collisionDetected:rt,occluded:ze.occluded}}queryRenderedSymbols(h){if(h.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const g=[];let b=1/0,T=1/0,C=-1/0,O=-1/0;for(const j of h){const Q=new o.Point(j.x+Cs,j.y+Cs);b=Math.min(b,Q.x),T=Math.min(T,Q.y),C=Math.max(C,Q.x),O=Math.max(O,Q.y),g.push(Q)}const R=this.grid.query(b,T,C,O).concat(this.ignoredGrid.query(b,T,C,O)),F={},Z={};for(const j of R){const Q=j.key;if(F[Q.bucketInstanceId]===void 0&&(F[Q.bucketInstanceId]={}),F[Q.bucketInstanceId][Q.featureIndex])continue;const oe=[new o.Point(j.x1,j.y1),new o.Point(j.x2,j.y1),new o.Point(j.x2,j.y2),new o.Point(j.x1,j.y2)];o.polygonIntersectsPolygon(g,oe)&&(F[Q.bucketInstanceId][Q.featureIndex]=!0,Z[Q.bucketInstanceId]===void 0&&(Z[Q.bucketInstanceId]=[]),Z[Q.bucketInstanceId].push(Q.featureIndex))}return Z}insertCollisionBox(h,g,b,T,C){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:b,featureIndex:T,collisionGroupID:C},h[0],h[1],h[2],h[3])}insertCollisionCircles(h,g,b,T,C){const O=g?this.ignoredGrid:this.grid,R={bucketInstanceId:b,featureIndex:T,collisionGroupID:C};for(let F=0;F<h.length;F+=4)O.insertCircle(R,h[F],h[F+1],h[F+2])}projectAndGetPerspectiveRatio(h,g,b,T,C,O,R){const F=[g,b,T,1];let Z=!1;T||this.transform.pitch>0?(o.transformMat4$1(F,F,h),this.fogState&&C&&R.name!=="globe"&&(Z=function(oe,he,pe,de,ge,ee){const ce=ee.calculateFogTileMatrix(ge),_e=[he,pe,de];return o.transformMat4(_e,_e,ce),Oe(oe,_e,ee.pitch,ee._fov)}(this.fogState,g,b,T,C.toUnwrapped(),this.transform)>.9)):er(F,F,h);const j=F[3];return{point:new o.Point((F[0]/j+1)/2*this.transform.width+Cs,(-F[1]/j+1)/2*this.transform.height+Cs),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(R)/j*.5,1.5),signedDistanceFromCamera:j,occluded:O&&F[2]>j||Z}}isOffscreen(h,g,b,T){return b<Cs||h>=this.screenRightBoundary||T<Cs||g>this.screenBottomBoundary}isInsideGrid(h,g,b,T){return b>=0&&h<this.gridRightBoundary&&T>=0&&g<this.gridBottomBoundary}getViewportMatrix(){const h=o.identity([]);return o.translate(h,h,[-100,-100,0]),h}}function dh(v,h,g){const b=h.createTileMatrix(v,v.worldSize,g.toUnwrapped());return o.multiply(new Float32Array(16),v.projMatrix,b)}function Gs(v,h,g){if(h.projection.name===g.projection.name)return v.projMatrix;const b=g.clone();return b.setProjection(h.projection),dh(b,h.getProjection(),v)}function Ni(v,h,g){return h.name===g.projection.name?v.projMatrix:dh(g,h,v)}class d1{constructor(h,g,b,T){this.opacity=h?Math.max(0,Math.min(1,h.opacity+(h.placed?g:-g))):T&&b?1:0,this.placed=b}isHidden(){return this.opacity===0&&!this.placed}}class Vu{constructor(h,g,b,T,C,O=!1){this.text=new d1(h?h.text:null,g,b,C),this.icon=new d1(h?h.icon:null,g,T,C),this.clipped=O}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ad{constructor(h,g,b,T=!1){this.text=h,this.icon=g,this.skipFade=b,this.clipped=T}}class Md{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class Yy{constructor(h,g,b,T,C){this.bucketInstanceId=h,this.featureIndex=g,this.sourceLayerIndex=b,this.bucketIndex=T,this.tileID=C}}class p1{constructor(h){this.crossSourceCollisions=h,this.maxGroupID=0,this.collisionGroups={}}get(h){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[h]){const g=++this.maxGroupID;this.collisionGroups[h]={ID:g,predicate:b=>b.collisionGroupID===g}}return this.collisionGroups[h]}}function Ld(v,h,g,b,T){const{horizontalAlign:C,verticalAlign:O}=o.getAnchorAlignment(v),R=-(C-.5)*h,F=-(O-.5)*g,Z=o.evaluateVariableOffset(v,b);return new o.Point(R+Z[0]*T,F+Z[1]*T)}function Od(v,h,g,b,T){const C=new o.Point(v,h);return g&&C._rotate(b?T:-T),C}class xg{constructor(h,g,b,T,C){this.transform=h.clone(),this.projection=h.projection.name,this.collisionIndex=new Pd(this.transform,C),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new p1(b),this.collisionCircleArrays={},this.prevPlacement=T,T&&(T.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(h,g,b,T){const C=b.getBucket(g),O=b.latestFeatureIndex;if(!C||!O||g.id!==C.layerIds[0])return;const R=C.layers[0].layout,F=b.collisionBoxArray,Z=Math.pow(2,this.transform.zoom-b.tileID.overscaledZ),j=b.tileSize/o.EXTENT,Q=b.tileID.toUnwrapped();this.transform.setProjection(C.projection);const oe=(he=b.tileID,pe=C.getProjection(),de=this.transform,pe.name===this.projection?de.calculateProjMatrix(he.toUnwrapped()):dh(de,pe,he));var he,pe,de;const ge=R.get("text-pitch-alignment")==="map",ee=R.get("text-rotation-alignment")==="map";g.compileFilter();const ce=g.dynamicFilter(),_e=g.dynamicFilterNeedsFeature(),xe=this.transform.calculatePixelsToTileUnitsMatrix(b),De=Uu(oe,b.tileID.canonical,ge,ee,this.transform,C.getProjection(),xe);let ke=null;if(ge){const ze=xo(oe,b.tileID.canonical,ge,ee,this.transform,C.getProjection(),xe);ke=o.multiply([],this.transform.labelPlaneMatrix,ze)}let Re=null;ce&&b.latestFeatureIndex&&(Re={unwrappedTileID:Q,dynamicFilter:ce,dynamicFilterNeedsFeature:_e,featureIndex:b.latestFeatureIndex}),this.retainedQueryData[C.bucketInstanceId]=new Yy(C.bucketInstanceId,O,C.sourceLayerIndex,C.index,b.tileID);const Ge={bucket:C,layout:R,posMatrix:oe,textLabelPlaneMatrix:De,labelToScreenMatrix:ke,clippingData:Re,scale:Z,textPixelRatio:j,holdingForFade:b.holdingForFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(C.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:o.evaluateSizeForZoom(C.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(C.sourceID)};if(T)for(const ze of C.sortKeyRanges){const{sortKey:Qe,symbolInstanceStart:Et,symbolInstanceEnd:Xe}=ze;h.push({sortKey:Qe,symbolInstanceStart:Et,symbolInstanceEnd:Xe,parameters:Ge})}else h.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:Ge})}attemptAnchorPlacement(h,g,b,T,C,O,R,F,Z,j,Q,oe,he,pe,de,ge,ee,ce){const{textOffset0:_e,textOffset1:xe,crossTileID:De}=oe,ke=[_e,xe],Re=Ld(h,b,T,ke,C),Ge=this.collisionIndex.placeCollisionBox(pe,C,g,Od(Re.x,Re.y,O,R,this.transform.angle),Q,F,Z,j.predicate);if(ge){const ze=pe.getSymbolInstanceIconSize(ce,this.transform.zoom,oe.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(pe,ze,ge,Od(Re.x,Re.y,O,R,this.transform.angle),Q,F,Z,j.predicate).box.length===0)return}if(Ge.box.length>0){let ze;return this.prevPlacement&&this.prevPlacement.variableOffsets[De]&&this.prevPlacement.placements[De]&&this.prevPlacement.placements[De].text&&(ze=this.prevPlacement.variableOffsets[De].anchor),this.variableOffsets[De]={textOffset:ke,width:b,height:T,anchor:h,textScale:C,prevAnchor:ze},this.markUsedJustification(pe,h,oe,de),pe.allowVerticalPlacement&&(this.markUsedOrientation(pe,de,oe),this.placedOrientations[De]=de),{shift:Re,placedGlyphBoxes:Ge}}}placeLayerBucketPart(h,g,b,T){const{bucket:C,layout:O,posMatrix:R,textLabelPlaneMatrix:F,labelToScreenMatrix:Z,clippingData:j,textPixelRatio:Q,holdingForFade:oe,collisionBoxArray:he,partiallyEvaluatedTextSize:pe,partiallyEvaluatedIconSize:de,collisionGroup:ge}=h.parameters,ee=O.get("text-optional"),ce=O.get("icon-optional"),_e=O.get("text-allow-overlap"),xe=O.get("icon-allow-overlap"),De=O.get("text-rotation-alignment")==="map",ke=O.get("text-pitch-alignment")==="map",Re=O.get("icon-text-fit")!=="none",Ge=O.get("symbol-z-order")==="viewport-y";this.transform.setProjection(C.projection);let ze=_e&&(xe||!C.hasIconData()||ce),Qe=xe&&(_e||!C.hasTextData()||ee);!C.collisionArrays&&he&&C.deserializeCollisionBoxes(he),b&&T&&C.updateCollisionDebugBuffers(this.transform.zoom,he);const Et=(Xe,gt,rt)=>{const{crossTileID:wt,numVerticalGlyphVertices:Ye}=Xe;if(j){const Fi={zoom:this.transform.zoom,pitch:this.transform.pitch};let fi=null;if(j.dynamicFilterNeedsFeature){const qr=this.retainedQueryData[C.bucketInstanceId];fi=j.featureIndex.loadFeature({featureIndex:Xe.featureIndex,bucketIndex:qr.bucketIndex,sourceLayerIndex:qr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,j.dynamicFilter)(Fi,fi,this.retainedQueryData[C.bucketInstanceId].tileID.canonical,new o.Point(Xe.tileAnchorX,Xe.tileAnchorY),this.transform.calculateDistanceTileData(j.unwrappedTileID)))return this.placements[wt]=new Ad(!1,!1,!1,!0),void g.add(wt)}if(g.has(wt))return;if(oe)return void(this.placements[wt]=new Ad(!1,!1,!1));let pt=!1,It=!1,_t=!0,Pt=!1,yn=!1,Ln=null,an={box:null,offscreen:null,occluded:null},En={box:null,offscreen:null,occluded:null},tr=null,Kn=null,gn=null,ni=0,ui=0,ci=0;rt.textFeatureIndex?ni=rt.textFeatureIndex:Xe.useRuntimeCollisionCircles&&(ni=Xe.featureIndex),rt.verticalTextFeatureIndex&&(ui=rt.verticalTextFeatureIndex);const hi=Fi=>{Fi.tileID=this.retainedQueryData[C.bucketInstanceId].tileID;const fi=this.transform.elevation;(fi||Fi.elevation)&&(Fi.elevation=fi?fi.getAtTileOffset(Fi.tileID,Fi.tileAnchorX,Fi.tileAnchorY):0)},Pa=rt.textBox;if(Pa){hi(Pa);const Fi=qr=>{let bo=o.WritingMode.horizontal;if(C.allowVerticalPlacement&&!qr&&this.prevPlacement){const Wa=this.prevPlacement.placedOrientations[wt];Wa&&(this.placedOrientations[wt]=Wa,bo=Wa,this.markUsedOrientation(C,bo,Xe))}return bo},fi=(qr,bo)=>{if(C.allowVerticalPlacement&&Ye>0&&rt.verticalTextBox){for(const Wa of C.writingModes)if(Wa===o.WritingMode.vertical?(an=bo(),En=an):an=qr(),an&&an.box&&an.box.length)break}else an=qr()};if(O.get("text-variable-anchor")){let qr=O.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[wt]){const Ai=this.prevPlacement.variableOffsets[wt];qr.indexOf(Ai.anchor)>0&&(qr=qr.filter(as=>as!==Ai.anchor),qr.unshift(Ai.anchor))}const bo=(Ai,as,Xg)=>{const bh=C.getSymbolInstanceTextSize(pe,Xe,this.transform.zoom,gt),Jd=(Ai.x2-Ai.x1)*bh+2*Ai.padding,Wu=(Ai.y2-Ai.y1)*bh+2*Ai.padding,Mc=Re&&!xe?as:null;Mc&&hi(Mc);let wh={box:[],offscreen:!1,occluded:!1};const Wg=_e?2*qr.length:qr.length;for(let Qd=0;Qd<Wg;++Qd){const Uv=this.attemptAnchorPlacement(qr[Qd%qr.length],Ai,Jd,Wu,bh,De,ke,Q,R,ge,Qd>=qr.length,Xe,gt,C,Xg,Mc,pe,de);if(Uv&&(wh=Uv.placedGlyphBoxes,wh&&wh.box&&wh.box.length)){pt=!0,Ln=Uv.shift;break}}return wh};fi(()=>bo(Pa,rt.iconBox,o.WritingMode.horizontal),()=>{const Ai=rt.verticalTextBox;return Ai&&hi(Ai),C.allowVerticalPlacement&&!(an&&an.box&&an.box.length)&&Ye>0&&Ai?bo(Ai,rt.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),an&&(pt=an.box,_t=an.offscreen,Pt=an.occluded);const Wa=Fi(!(!an||!an.box));if(!pt&&this.prevPlacement){const Ai=this.prevPlacement.variableOffsets[wt];Ai&&(this.variableOffsets[wt]=Ai,this.markUsedJustification(C,Ai.anchor,Xe,Wa))}}else{const qr=(bo,Wa)=>{const Ai=C.getSymbolInstanceTextSize(pe,Xe,this.transform.zoom,gt),as=this.collisionIndex.placeCollisionBox(C,Ai,bo,new o.Point(0,0),_e,Q,R,ge.predicate);return as&&as.box&&as.box.length&&(this.markUsedOrientation(C,Wa,Xe),this.placedOrientations[wt]=Wa),as};fi(()=>qr(Pa,o.WritingMode.horizontal),()=>{const bo=rt.verticalTextBox;return C.allowVerticalPlacement&&Ye>0&&bo?(hi(bo),qr(bo,o.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Fi(!!(an&&an.box&&an.box.length))}}if(tr=an,pt=tr&&tr.box&&tr.box.length>0,_t=tr&&tr.offscreen,Pt=tr&&tr.occluded,Xe.useRuntimeCollisionCircles){const Fi=C.text.placedSymbolArray.get(Xe.centerJustifiedTextSymbolIndex>=0?Xe.centerJustifiedTextSymbolIndex:Xe.verticalPlacedTextSymbolIndex),fi=o.evaluateSizeForFeature(C.textSizeData,pe,Fi),qr=O.get("text-padding");Kn=this.collisionIndex.placeCollisionCircles(C,_e,Fi,C.lineVertexArray,C.glyphOffsetArray,fi,R,F,Z,b,ke,ge.predicate,Xe.collisionCircleDiameter*fi/o.ONE_EM,qr,this.retainedQueryData[C.bucketInstanceId].tileID),pt=_e||Kn.circles.length>0&&!Kn.collisionDetected,_t=_t&&Kn.offscreen,Pt=Kn.occluded}if(rt.iconFeatureIndex&&(ci=rt.iconFeatureIndex),rt.iconBox){const Fi=fi=>{hi(fi);const qr=Re&&Ln?Od(Ln.x,Ln.y,De,ke,this.transform.angle):new o.Point(0,0),bo=C.getSymbolInstanceIconSize(de,this.transform.zoom,Xe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(C,bo,fi,qr,xe,Q,R,ge.predicate)};En&&En.box&&En.box.length&&rt.verticalIconBox?(gn=Fi(rt.verticalIconBox),It=gn.box.length>0):(gn=Fi(rt.iconBox),It=gn.box.length>0),_t=_t&&gn.offscreen,yn=gn.occluded}const Jo=ee||Xe.numHorizontalGlyphVertices===0&&Ye===0,Zs=ce||Xe.numIconVertices===0;if(Jo||Zs?Zs?Jo||(It=It&&pt):pt=It&&pt:It=pt=It&&pt,pt&&tr&&tr.box&&this.collisionIndex.insertCollisionBox(tr.box,O.get("text-ignore-placement"),C.bucketInstanceId,En&&En.box&&ui?ui:ni,ge.ID),It&&gn&&this.collisionIndex.insertCollisionBox(gn.box,O.get("icon-ignore-placement"),C.bucketInstanceId,ci,ge.ID),Kn&&(pt&&this.collisionIndex.insertCollisionCircles(Kn.circles,O.get("text-ignore-placement"),C.bucketInstanceId,ni,ge.ID),b)){const Fi=C.bucketInstanceId;let fi=this.collisionCircleArrays[Fi];fi===void 0&&(fi=this.collisionCircleArrays[Fi]=new Md);for(let qr=0;qr<Kn.circles.length;qr+=4)fi.circles.push(Kn.circles[qr+0]),fi.circles.push(Kn.circles[qr+1]),fi.circles.push(Kn.circles[qr+2]),fi.circles.push(Kn.collisionDetected?1:0)}const Wl=C.projection.name!=="globe";ze=ze&&(Wl||!Pt),Qe=Qe&&(Wl||!yn),this.placements[wt]=new Ad(pt||ze,It||Qe,_t||C.justReloaded),g.add(wt)};if(Ge){const Xe=C.getSortedSymbolIndexes(this.transform.angle);for(let gt=Xe.length-1;gt>=0;--gt){const rt=Xe[gt];Et(C.symbolInstances.get(rt),rt,C.collisionArrays[rt])}}else for(let Xe=h.symbolInstanceStart;Xe<h.symbolInstanceEnd;Xe++)Et(C.symbolInstances.get(Xe),Xe,C.collisionArrays[Xe]);if(b&&C.bucketInstanceId in this.collisionCircleArrays){const Xe=this.collisionCircleArrays[C.bucketInstanceId];o.invert(Xe.invProjMatrix,R),Xe.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(h,g,b,T){const{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:R,verticalPlacedTextSymbolIndex:F,crossTileID:Z}=b,j=o.getAnchorJustification(g),Q=T===o.WritingMode.vertical?F:j==="left"?C:j==="center"?O:j==="right"?R:-1;C>=0&&(h.text.placedSymbolArray.get(C).crossTileID=Q>=0&&C!==Q?0:Z),O>=0&&(h.text.placedSymbolArray.get(O).crossTileID=Q>=0&&O!==Q?0:Z),R>=0&&(h.text.placedSymbolArray.get(R).crossTileID=Q>=0&&R!==Q?0:Z),F>=0&&(h.text.placedSymbolArray.get(F).crossTileID=Q>=0&&F!==Q?0:Z)}markUsedOrientation(h,g,b){const T=g===o.WritingMode.horizontal||g===o.WritingMode.horizontalOnly?g:0,C=g===o.WritingMode.vertical?g:0,{leftJustifiedTextSymbolIndex:O,centerJustifiedTextSymbolIndex:R,rightJustifiedTextSymbolIndex:F,verticalPlacedTextSymbolIndex:Z}=b,j=h.text.placedSymbolArray;O>=0&&(j.get(O).placedOrientation=T),R>=0&&(j.get(R).placedOrientation=T),F>=0&&(j.get(F).placedOrientation=T),Z>=0&&(j.get(Z).placedOrientation=C)}commit(h){this.commitTime=h,this.zoomAtLastRecencyCheck=this.transform.zoom;const g=this.prevPlacement;let b=!1;this.prevZoomAdjustment=g?g.zoomAdjustment(this.transform.zoom):0;const T=g?g.symbolFadeChange(h):1,C=g?g.opacities:{},O=g?g.variableOffsets:{},R=g?g.placedOrientations:{};for(const F in this.placements){const Z=this.placements[F],j=C[F];j?(this.opacities[F]=new Vu(j,T,Z.text,Z.icon,null,Z.clipped),b=b||Z.text!==j.text.placed||Z.icon!==j.icon.placed):(this.opacities[F]=new Vu(null,T,Z.text,Z.icon,Z.skipFade,Z.clipped),b=b||Z.text||Z.icon)}for(const F in C){const Z=C[F];if(!this.opacities[F]){const j=new Vu(Z,T,!1,!1);j.isHidden()||(this.opacities[F]=j,b=b||Z.text.placed||Z.icon.placed)}}for(const F in O)this.variableOffsets[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.variableOffsets[F]=O[F]);for(const F in R)this.placedOrientations[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.placedOrientations[F]=R[F]);b?this.lastPlacementChangeTime=h:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=g?g.lastPlacementChangeTime:h)}updateLayerOpacities(h,g){const b=new Set;for(const T of g){const C=T.getBucket(h);C&&T.latestFeatureIndex&&h.id===C.layerIds[0]&&this.updateBucketOpacities(C,b,T.collisionBoxArray)}}updateBucketOpacities(h,g,b){h.hasTextData()&&h.text.opacityVertexArray.clear(),h.hasIconData()&&h.icon.opacityVertexArray.clear(),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexArray.clear(),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexArray.clear();const T=h.layers[0].layout,C=!!h.layers[0].dynamicFilter(),O=new Vu(null,0,!1,!1,!0),R=T.get("text-allow-overlap"),F=T.get("icon-allow-overlap"),Z=T.get("text-variable-anchor"),j=T.get("text-rotation-alignment")==="map",Q=T.get("text-pitch-alignment")==="map",oe=T.get("icon-text-fit")!=="none",he=new Vu(null,0,R&&(F||!h.hasIconData()||T.get("icon-optional")),F&&(R||!h.hasTextData()||T.get("text-optional")),!0);!h.collisionArrays&&b&&(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData())&&h.deserializeCollisionBoxes(b);const pe=(ge,ee,ce)=>{for(let _e=0;_e<ee/4;_e++)ge.opacityVertexArray.emplaceBack(ce)};let de=0;for(let ge=0;ge<h.symbolInstances.length;ge++){const ee=h.symbolInstances.get(ge),{numHorizontalGlyphVertices:ce,numVerticalGlyphVertices:_e,crossTileID:xe,numIconVertices:De}=ee,ke=g.has(xe);let Re=this.opacities[xe];ke?Re=O:Re||(Re=he,this.opacities[xe]=Re),g.add(xe);const Ge=ce>0||_e>0,ze=De>0,Qe=this.placedOrientations[xe],Et=Qe===o.WritingMode.vertical,Xe=Qe===o.WritingMode.horizontal||Qe===o.WritingMode.horizontalOnly;if(!Ge&&!ze||Re.isHidden()||de++,Ge){const gt=Dd(Re.text);pe(h.text,ce,Et?eo:gt),pe(h.text,_e,Xe?eo:gt);const rt=Re.text.isHidden(),{leftJustifiedTextSymbolIndex:wt,centerJustifiedTextSymbolIndex:Ye,rightJustifiedTextSymbolIndex:pt,verticalPlacedTextSymbolIndex:It}=ee,_t=h.text.placedSymbolArray,Pt=rt||Et?1:0;wt>=0&&(_t.get(wt).hidden=Pt),Ye>=0&&(_t.get(Ye).hidden=Pt),pt>=0&&(_t.get(pt).hidden=Pt),It>=0&&(_t.get(It).hidden=rt||Xe?1:0);const yn=this.variableOffsets[xe];yn&&this.markUsedJustification(h,yn.anchor,ee,Qe);const Ln=this.placedOrientations[xe];Ln&&(this.markUsedJustification(h,"left",ee,Ln),this.markUsedOrientation(h,Ln,ee))}if(ze){const gt=Dd(Re.icon),{placedIconSymbolIndex:rt,verticalPlacedIconSymbolIndex:wt}=ee,Ye=h.icon.placedSymbolArray,pt=Re.icon.isHidden()?1:0;rt>=0&&(pe(h.icon,De,Et?eo:gt),Ye.get(rt).hidden=pt),wt>=0&&(pe(h.icon,ee.numVerticalIconVertices,Xe?eo:gt),Ye.get(wt).hidden=pt)}if(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData()){const gt=h.collisionArrays[ge];if(gt){let rt=new o.Point(0,0),wt=!0;if(gt.textBox||gt.verticalTextBox){if(Z){const pt=this.variableOffsets[xe];pt?(rt=Ld(pt.anchor,pt.width,pt.height,pt.textOffset,pt.textScale),j&&rt._rotate(Q?this.transform.angle:-this.transform.angle)):wt=!1}C&&(wt=!Re.clipped),gt.textBox&&gf(h.textCollisionBox.collisionVertexArray,Re.text.placed,!wt||Et,rt.x,rt.y),gt.verticalTextBox&&gf(h.textCollisionBox.collisionVertexArray,Re.text.placed,!wt||Xe,rt.x,rt.y)}const Ye=wt&&!!(!Xe&&gt.verticalIconBox);gt.iconBox&&gf(h.iconCollisionBox.collisionVertexArray,Re.icon.placed,Ye,oe?rt.x:0,oe?rt.y:0),gt.verticalIconBox&&gf(h.iconCollisionBox.collisionVertexArray,Re.icon.placed,!Ye,oe?rt.x:0,oe?rt.y:0)}}}if(h.fullyClipped=de===0,h.sortFeatures(this.transform.angle),this.retainedQueryData[h.bucketInstanceId]&&(this.retainedQueryData[h.bucketInstanceId].featureSortOrder=h.featureSortOrder),h.hasTextData()&&h.text.opacityVertexBuffer&&h.text.opacityVertexBuffer.updateData(h.text.opacityVertexArray),h.hasIconData()&&h.icon.opacityVertexBuffer&&h.icon.opacityVertexBuffer.updateData(h.icon.opacityVertexArray),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexBuffer&&h.iconCollisionBox.collisionVertexBuffer.updateData(h.iconCollisionBox.collisionVertexArray),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexBuffer&&h.textCollisionBox.collisionVertexBuffer.updateData(h.textCollisionBox.collisionVertexArray),h.bucketInstanceId in this.collisionCircleArrays){const ge=this.collisionCircleArrays[h.bucketInstanceId];h.placementInvProjMatrix=ge.invProjMatrix,h.placementViewportMatrix=ge.viewportMatrix,h.collisionCircleArray=ge.circles,delete this.collisionCircleArrays[h.bucketInstanceId]}}symbolFadeChange(h){return this.fadeDuration===0?1:(h-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(h){return Math.max(0,(this.transform.zoom-h)/1.5)}hasTransitions(h){return this.stale||h-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(h,g){const b=this.zoomAtLastRecencyCheck===g?1-this.zoomAdjustment(g):1;return this.zoomAtLastRecencyCheck=g,this.commitTime+this.fadeDuration*b>h}setStale(){this.stale=!0}}function gf(v,h,g,b,T){v.emplaceBack(h?1:0,g?1:0,b||0,T||0),v.emplaceBack(h?1:0,g?1:0,b||0,T||0),v.emplaceBack(h?1:0,g?1:0,b||0,T||0),v.emplaceBack(h?1:0,g?1:0,b||0,T||0)}const is=Math.pow(2,25),uo=Math.pow(2,24),Ky=Math.pow(2,17),Jy=Math.pow(2,16),os=Math.pow(2,9),$s=Math.pow(2,8),g1=Math.pow(2,1);function Dd(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const h=v.placed?1:0,g=Math.floor(127*v.opacity);return g*is+h*uo+g*Ky+h*Jy+g*os+h*$s+g*g1+h}const eo=0;class Rd{constructor(h){this._sortAcrossTiles=h.layout.get("symbol-z-order")!=="viewport-y"&&h.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(h,g,b,T,C){const O=this._bucketParts;for(;this._currentTileIndex<h.length;)if(g.getBucketParts(O,T,h[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,C())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,O.sort((R,F)=>R.sortKey-F.sortKey));this._currentPartIndex<O.length;){const R=O[this._currentPartIndex];if(g.placeLayerBucketPart(R,this._seenCrossTileIDs,b,R.symbolInstanceStart===0),this._currentPartIndex++,C())return!0}return!1}}class Qy{constructor(h,g,b,T,C,O,R,F){this.placement=new xg(h,C,O,R,F),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=b,this._showCollisionBoxes=T,this._done=!1}isDone(){return this._done}continuePlacement(h,g,b){const T=o.exported.now(),C=()=>{const O=o.exported.now()-T;return!this._forceFullPlacement&&O>2};for(;this._currentPlacementIndex>=0;){const O=g[h[this._currentPlacementIndex]],R=this.placement.collisionIndex.transform.zoom;if(O.type==="symbol"&&(!O.minzoom||O.minzoom<=R)&&(!O.maxzoom||O.maxzoom>R)){if(this._inProgressLayer||(this._inProgressLayer=new Rd(O)),this._inProgressLayer.continuePlacement(b[O.source],this.placement,this._showCollisionBoxes,O,C))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(h){return this.placement.commit(h),this.placement}}const ph=512/o.EXTENT/2;class pa{constructor(h,g,b){this.tileID=h,this.bucketInstanceId=b,this.index=new o.KDBush(g.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const T=h.canonical.x*o.EXTENT,C=h.canonical.y*o.EXTENT;for(let O=0;O<g.length;O++){const{key:R,crossTileID:F,tileAnchorX:Z,tileAnchorY:j}=g.get(O),Q=Math.floor((T+Z)*ph),oe=Math.floor((C+j)*ph);this.index.add(Q,oe),this.keys.push(R),this.crossTileIDs.push(F)}this.index.finish()}findMatches(h,g,b){const T=this.tileID.canonical.z<g.canonical.z?1:Math.pow(2,this.tileID.canonical.z-g.canonical.z),C=ph/Math.pow(2,g.canonical.z-this.tileID.canonical.z),O=g.canonical.x*o.EXTENT,R=g.canonical.y*o.EXTENT;for(let F=0;F<h.length;F++){const Z=h.get(F);if(Z.crossTileID)continue;const{key:j,tileAnchorX:Q,tileAnchorY:oe}=Z,he=Math.floor((O+Q)*C),pe=Math.floor((R+oe)*C),de=this.index.range(he-T,pe-T,he+T,pe+T);for(const ge of de){const ee=this.crossTileIDs[ge];if(this.keys[ge]===j&&!b.has(ee)){b.add(ee),Z.crossTileID=ee;break}}}}}class ev{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class tv{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(h){const g=Math.round((h-this.lng)/360);if(g!==0)for(const b in this.indexes){const T=this.indexes[b],C={};for(const O in T){const R=T[O];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+g),C[R.tileID.key]=R}this.indexes[b]=C}this.lng=h}addBucket(h,g,b){if(this.indexes[h.overscaledZ]&&this.indexes[h.overscaledZ][h.key]){if(this.indexes[h.overscaledZ][h.key].bucketInstanceId===g.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(h.overscaledZ,this.indexes[h.overscaledZ][h.key])}for(let C=0;C<g.symbolInstances.length;C++)g.symbolInstances.get(C).crossTileID=0;this.usedCrossTileIDs[h.overscaledZ]||(this.usedCrossTileIDs[h.overscaledZ]=new Set);const T=this.usedCrossTileIDs[h.overscaledZ];for(const C in this.indexes){const O=this.indexes[C];if(Number(C)>h.overscaledZ)for(const R in O){const F=O[R];F.tileID.isChildOf(h)&&F.findMatches(g.symbolInstances,h,T)}else{const R=O[h.scaledTo(Number(C)).key];R&&R.findMatches(g.symbolInstances,h,T)}}for(let C=0;C<g.symbolInstances.length;C++){const O=g.symbolInstances.get(C);O.crossTileID||(O.crossTileID=b.generate(),T.add(O.crossTileID))}return this.indexes[h.overscaledZ]===void 0&&(this.indexes[h.overscaledZ]={}),this.indexes[h.overscaledZ][h.key]=new pa(h,g.symbolInstances,g.bucketInstanceId),!0}removeBucketCrossTileIDs(h,g){for(const b of g.crossTileIDs)this.usedCrossTileIDs[h].delete(b)}removeStaleBuckets(h){let g=!1;for(const b in this.indexes){const T=this.indexes[b];for(const C in T)h[T[C].bucketInstanceId]||(this.removeBucketCrossTileIDs(b,T[C]),delete T[C],g=!0)}return g}}class Gu{constructor(){this.layerIndexes={},this.crossTileIDs=new ev,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(h,g,b,T){let C=this.layerIndexes[h.id];C===void 0&&(C=this.layerIndexes[h.id]=new tv);let O=!1;const R={};T.name!=="globe"&&C.handleWrapJump(b);for(const F of g){const Z=F.getBucket(h);Z&&h.id===Z.layerIds[0]&&(Z.bucketInstanceId||(Z.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(F.tileID,Z,this.crossTileIDs)&&(O=!0),R[Z.bucketInstanceId]=!0)}return C.removeStaleBuckets(R)&&(O=!0),O}pruneUnusedLayers(h){const g={};h.forEach(b=>{g[b]=!0});for(const b in this.layerIndexes)g[b]||delete this.layerIndexes[b]}}const Pc=(v,h)=>o.emitValidationErrors(v,h&&h.filter(g=>g.identifier!=="source.canvas")),bg=o.pick(Kr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),pE=o.pick(Kr,["setCenter","setZoom","setBearing","setPitch"]),nv={version:8,layers:[],sources:{}},mf={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ql extends o.Evented{constructor(h,g={}){super(),this.map=h,this.dispatcher=new Be(df(),this),this.imageManager=new ue,this.imageManager.setEventedParent(this),this.glyphManager=new o.GlyphManager(h._requestManager,g.localFontFamily?o.LocalGlyphMode.all:g.localIdeographFontFamily?o.LocalGlyphMode.ideographs:o.LocalGlyphMode.none,g.localFontFamily||g.localIdeographFontFamily),this.crossTileSymbolIndex=new Gu,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const b=this;this._rtlTextPluginCallback=ql.registerForPluginStateChange(T=>{b.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:T.pluginStatus,pluginURL:T.pluginURL},(C,O)=>{if(o.triggerPluginCompletionEvent(C),O&&O.every(R=>R))for(const R in b._sourceCaches){const F=b._sourceCaches[R],Z=F.getSource().type;Z!=="vector"&&Z!=="geojson"||F.reload()}})}),this.on("data",T=>{if(T.dataType!=="source"||T.sourceDataType!=="metadata")return;const C=this.getSource(T.sourceId);if(C&&C.vectorLayerIds)for(const O in this._layers){const R=this._layers[O];R.source===C.id&&this._validateLayer(R)}})}loadURL(h,g={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const b=typeof g.validate=="boolean"?g.validate:!o.isMapboxURL(h);h=this.map._requestManager.normalizeStyleURL(h,g.accessToken);const T=this.map._requestManager.transformRequest(h,o.ResourceType.Style);this._request=o.getJSON(T,(C,O)=>{this._request=null,C?this.fire(new o.ErrorEvent(C)):O&&this._load(O,b)})}loadJSON(h,g={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(h,g.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(nv,!1)}_updateLayerCount(h,g){const b=g?1:-1;h.is3D()&&(this._num3DLayers+=b),h.type==="circle"&&(this._numCircleLayers+=b),h.type==="symbol"&&(this._numSymbolLayers+=b)}_load(h,g){if(g&&Pc(this,o.validateStyle(h)))return;this._loaded=!0,this.stylesheet=o.clone$1(h),this._updateMapProjection();for(const T in h.sources)this.addSource(T,h.sources[T],{validate:!1});this._changed=!1,h.sprite?this._loadSprite(h.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(h.glyphs);const b=c1(this.stylesheet.layers);this._order=b.map(T=>T.id),this._layers={},this._serializedLayers={};for(const T of b){const C=o.createStyleLayer(T);C.setEventedParent(this,{layer:{id:C.id}}),this._layers[C.id]=C,this._serializedLayers[C.id]=C.serialize(),this._updateLayerCount(C,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ve(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(h){h?this.stylesheet.projection=h:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(h){this._spriteRequest=function(g,b,T){let C,O,R;const F=o.exported.devicePixelRatio>1?"@2x":"";let Z=o.getJSON(b.transformRequest(b.normalizeSpriteURL(g,F,".json"),o.ResourceType.SpriteJSON),(oe,he)=>{Z=null,R||(R=oe,C=he,Q())}),j=o.getImage(b.transformRequest(b.normalizeSpriteURL(g,F,".png"),o.ResourceType.SpriteImage),(oe,he)=>{j=null,R||(R=oe,O=he,Q())});function Q(){if(R)T(R);else if(C&&O){const oe=o.exported.getImageData(O),he={};for(const pe in C){const{width:de,height:ge,x:ee,y:ce,sdf:_e,pixelRatio:xe,stretchX:De,stretchY:ke,content:Re}=C[pe],Ge=new o.RGBAImage({width:de,height:ge});o.RGBAImage.copy(oe,Ge,{x:ee,y:ce},{x:0,y:0},{width:de,height:ge}),he[pe]={data:Ge,pixelRatio:xe,sdf:_e,stretchX:De,stretchY:ke,content:Re}}T(null,he)}}return{cancel(){Z&&(Z.cancel(),Z=null),j&&(j.cancel(),j=null)}}}(h,this.map._requestManager,(g,b)=>{if(this._spriteRequest=null,g)this.fire(new o.ErrorEvent(g));else if(b)for(const T in b)this.imageManager.addImage(T,b[T]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(h){const g=this.getSource(h.source);if(!g)return;const b=h.sourceLayer;b&&(g.type==="geojson"||g.vectorLayerIds&&g.vectorLayerIds.indexOf(b)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${b}" does not exist on source "${g.id}" as specified by style layer "${h.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const h in this._sourceCaches)if(!this._sourceCaches[h].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(h){const g=[];for(const b of h){const T=this._layers[b];T.type!=="custom"&&g.push(T.serialize())}return g}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const h in this._sourceCaches)if(this._sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(h){return!!this.terrain&&(typeof h.isLayerDraped=="function"?h.isLayerDraped():mf[h.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(h){if(!this._loaded)return;const g=this._changed;if(this._changed){const T=Object.keys(this._updatedLayers),C=Object.keys(this._removedLayers);(T.length||C.length)&&this._updateWorkerLayers(T,C);for(const O in this._updatedSources){const R=this._updatedSources[O];R==="reload"?this._reloadSource(O):R==="clear"&&this._clearSource(O)}this._updateTilesForChangedImages();for(const O in this._updatedPaintProps)this._layers[O].updateTransitions(h);this.light.updateTransitions(h),this.fog&&this.fog.updateTransitions(h),this._resetUpdates()}const b={};for(const T in this._sourceCaches){const C=this._sourceCaches[T];b[T]=C.used,C.used=!1}for(const T of this._order){const C=this._layers[T];if(C.recalculate(h,this._availableImages),!C.isHidden(h.zoom)){const R=this._getLayerSourceCache(C);R&&(R.used=!0)}const O=this.map.painter;if(O){const R=C.getProgramIds();if(!R)continue;const F=C.getProgramConfiguration(h.zoom);for(const Z of R)O.useProgram(Z,F)}}for(const T in b){const C=this._sourceCaches[T];b[T]!==C.used&&C.getSource().fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:C.getSource().id}))}this.light.recalculate(h),this.terrain&&this.terrain.recalculate(h),this.fog&&this.fog.recalculate(h),this.z=h.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),g&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const h=Object.keys(this._changedImages);if(h.length){for(const g in this._sourceCaches)this._sourceCaches[g].reloadTilesForDependencies(["icons","patterns"],h);this._changedImages={}}}_updateWorkerLayers(h,g){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(h),removedIds:g})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(h){if(this._checkLoaded(),Pc(this,o.validateStyle(h)))return!1;(h=o.clone$1(h)).layers=c1(h.layers);const g=function(T,C){if(!T)return[{command:Kr.setStyle,args:[C]}];let O=[];try{if(!f(T.version,C.version))return[{command:Kr.setStyle,args:[C]}];f(T.center,C.center)||O.push({command:Kr.setCenter,args:[C.center]}),f(T.zoom,C.zoom)||O.push({command:Kr.setZoom,args:[C.zoom]}),f(T.bearing,C.bearing)||O.push({command:Kr.setBearing,args:[C.bearing]}),f(T.pitch,C.pitch)||O.push({command:Kr.setPitch,args:[C.pitch]}),f(T.sprite,C.sprite)||O.push({command:Kr.setSprite,args:[C.sprite]}),f(T.glyphs,C.glyphs)||O.push({command:Kr.setGlyphs,args:[C.glyphs]}),f(T.transition,C.transition)||O.push({command:Kr.setTransition,args:[C.transition]}),f(T.light,C.light)||O.push({command:Kr.setLight,args:[C.light]}),f(T.fog,C.fog)||O.push({command:Kr.setFog,args:[C.fog]}),f(T.projection,C.projection)||O.push({command:Kr.setProjection,args:[C.projection]});const R={},F=[];(function(Q,oe,he,pe){let de;for(de in oe=oe||{},Q=Q||{})Q.hasOwnProperty(de)&&(oe.hasOwnProperty(de)||Id(de,he,pe));for(de in oe){if(!oe.hasOwnProperty(de))continue;const ge=oe[de];Q.hasOwnProperty(de)?f(Q[de],ge)||(Q[de].type==="geojson"&&ge.type==="geojson"&&_g(Q,oe,de)?he.push({command:Kr.setGeoJSONSourceData,args:[de,ge.data]}):Zy(de,oe,he,pe)):qy(de,oe,he)}})(T.sources,C.sources,F,R);const Z=[];T.layers&&T.layers.forEach(Q=>{Q.source&&R[Q.source]?O.push({command:Kr.removeLayer,args:[Q.id]}):Z.push(Q)});let j=T.terrain;j&&R[j.source]&&(O.push({command:Kr.setTerrain,args:[void 0]}),j=void 0),O=O.concat(F),f(j,C.terrain)||O.push({command:Kr.setTerrain,args:[C.terrain]}),function(Q,oe,he){oe=oe||[];const pe=(Q=Q||[]).map(Bu),de=oe.map(Bu),ge=Q.reduce(Xy,{}),ee=oe.reduce(Xy,{}),ce=pe.slice(),_e=Object.create(null);let xe,De,ke,Re,Ge,ze,Qe;for(xe=0,De=0;xe<pe.length;xe++)ke=pe[xe],ee.hasOwnProperty(ke)?De++:(he.push({command:Kr.removeLayer,args:[ke]}),ce.splice(ce.indexOf(ke,De),1));for(xe=0,De=0;xe<de.length;xe++)ke=de[de.length-1-xe],ce[ce.length-1-xe]!==ke&&(ge.hasOwnProperty(ke)?(he.push({command:Kr.removeLayer,args:[ke]}),ce.splice(ce.lastIndexOf(ke,ce.length-De),1)):De++,ze=ce[ce.length-xe],he.push({command:Kr.addLayer,args:[ee[ke],ze]}),ce.splice(ce.length-xe,0,ke),_e[ke]=!0);for(xe=0;xe<de.length;xe++)if(ke=de[xe],Re=ge[ke],Ge=ee[ke],!_e[ke]&&!f(Re,Ge))if(f(Re.source,Ge.source)&&f(Re["source-layer"],Ge["source-layer"])&&f(Re.type,Ge.type)){for(Qe in $l(Re.layout,Ge.layout,he,ke,null,Kr.setLayoutProperty),$l(Re.paint,Ge.paint,he,ke,null,Kr.setPaintProperty),f(Re.filter,Ge.filter)||he.push({command:Kr.setFilter,args:[ke,Ge.filter]}),f(Re.minzoom,Ge.minzoom)&&f(Re.maxzoom,Ge.maxzoom)||he.push({command:Kr.setLayerZoomRange,args:[ke,Ge.minzoom,Ge.maxzoom]}),Re)Re.hasOwnProperty(Qe)&&Qe!=="layout"&&Qe!=="paint"&&Qe!=="filter"&&Qe!=="metadata"&&Qe!=="minzoom"&&Qe!=="maxzoom"&&(Qe.indexOf("paint.")===0?$l(Re[Qe],Ge[Qe],he,ke,Qe.slice(6),Kr.setPaintProperty):f(Re[Qe],Ge[Qe])||he.push({command:Kr.setLayerProperty,args:[ke,Qe,Ge[Qe]]}));for(Qe in Ge)Ge.hasOwnProperty(Qe)&&!Re.hasOwnProperty(Qe)&&Qe!=="layout"&&Qe!=="paint"&&Qe!=="filter"&&Qe!=="metadata"&&Qe!=="minzoom"&&Qe!=="maxzoom"&&(Qe.indexOf("paint.")===0?$l(Re[Qe],Ge[Qe],he,ke,Qe.slice(6),Kr.setPaintProperty):f(Re[Qe],Ge[Qe])||he.push({command:Kr.setLayerProperty,args:[ke,Qe,Ge[Qe]]}))}else he.push({command:Kr.removeLayer,args:[ke]}),ze=ce[ce.lastIndexOf(ke)+1],he.push({command:Kr.addLayer,args:[Ge,ze]})}(Z,C.layers,O)}catch(R){console.warn("Unable to compute style diff:",R),O=[{command:Kr.setStyle,args:[C]}]}return O}(this.serialize(),h).filter(T=>!(T.command in pE));if(g.length===0)return!1;const b=g.filter(T=>!(T.command in bg));if(b.length>0)throw new Error(`Unimplemented: ${b.map(T=>T.command).join(", ")}.`);return g.forEach(T=>{T.command!=="setTransition"&&T.command!=="setProjection"&&this[T.command].apply(this,T.args)}),this.stylesheet=h,this._updateMapProjection(),!0}addImage(h,g){return this.getImage(h)?this.fire(new o.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(h,g),this._afterImageUpdated(h),this)}updateImage(h,g){this.imageManager.updateImage(h,g)}getImage(h){return this.imageManager.getImage(h)}removeImage(h){return this.getImage(h)?(this.imageManager.removeImage(h),this._afterImageUpdated(h),this):this.fire(new o.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(h){this._availableImages=this.imageManager.listImages(),this._changedImages[h]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(h,g,b={}){if(this._checkLoaded(),this.getSource(h)!==void 0)throw new Error("There is already a source with this ID");if(!g.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(g).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(o.validateSource,`sources.${h}`,g,null,b))return;this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);const T=Yn(h,g,this.dispatcher,this);T.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(h),source:T.serialize(),sourceId:h}));const C=O=>{const R=(O?"symbol:":"other:")+h,F=this._sourceCaches[R]=new o.SourceCache(R,T,O);(O?this._symbolSourceCaches:this._otherSourceCaches)[h]=F,F.style=this,F.onAdd(this.map)};C(!1),g.type!=="vector"&&g.type!=="geojson"||C(!0),T.onAdd&&T.onAdd(this.map),this._changed=!0}removeSource(h){this._checkLoaded();const g=this.getSource(h);if(!g)throw new Error("There is no source with this ID");for(const T in this._layers)if(this._layers[T].source===h)return this.fire(new o.ErrorEvent(new Error(`Source "${h}" cannot be removed while layer "${T}" is using it.`)));if(this.terrain&&this.terrain.get().source===h)return this.fire(new o.ErrorEvent(new Error(`Source "${h}" cannot be removed while terrain is using it.`)));const b=this._getSourceCaches(h);for(const T of b)delete this._sourceCaches[T.id],delete this._updatedSources[T.id],T.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:T.getSource().id})),T.setEventedParent(null),T.clearTiles();return delete this._otherSourceCaches[h],delete this._symbolSourceCaches[h],g.setEventedParent(null),g.onRemove&&g.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(h,g){this._checkLoaded(),this.getSource(h).setData(g),this._changed=!0}getSource(h){const g=this._getSourceCache(h);return g&&g.getSource()}_getSources(){const h=[];for(const g in this._otherSourceCaches){const b=this._getSourceCache(g);b&&h.push(b.getSource())}return h}addLayer(h,g,b={}){this._checkLoaded();const T=h.id;if(this.getLayer(T))return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${T}" already exists on this map`)));let C;if(h.type==="custom"){if(Pc(this,o.validateCustomStyleLayer(h)))return;C=o.createStyleLayer(h)}else{if(typeof h.source=="object"&&(this.addSource(T,h.source),h=o.clone$1(h),h=o.extend(h,{source:T})),this._validate(o.validateLayer,`layers.${T}`,h,{arrayIndex:-1},b))return;C=o.createStyleLayer(h),this._validateLayer(C),C.setEventedParent(this,{layer:{id:T}}),this._serializedLayers[C.id]=C.serialize(),this._updateLayerCount(C,!0)}const O=g?this._order.indexOf(g):this._order.length;if(g&&O===-1)return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${g}" does not exist on this map.`)));this._order.splice(O,0,T),this._layerOrderChanged=!0,this._layers[T]=C;const R=this._getLayerSourceCache(C);if(this._removedLayers[T]&&C.source&&R&&C.type!=="custom"){const F=this._removedLayers[T];delete this._removedLayers[T],F.type!==C.type?this._updatedSources[C.source]="clear":(this._updatedSources[C.source]="reload",R.pause())}this._updateLayer(C),C.onAdd&&C.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(h,g){if(this._checkLoaded(),this._changed=!0,!this._layers[h])return void this.fire(new o.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be moved.`)));if(h===g)return;const b=this._order.indexOf(h);this._order.splice(b,1);const T=g?this._order.indexOf(g):this._order.length;g&&T===-1?this.fire(new o.ErrorEvent(new Error(`Layer with id "${g}" does not exist on this map.`))):(this._order.splice(T,0,h),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(h){this._checkLoaded();const g=this._layers[h];if(!g)return void this.fire(new o.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be removed.`)));g.setEventedParent(null),this._updateLayerCount(g,!1);const b=this._order.indexOf(h);this._order.splice(b,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[h]=g,delete this._layers[h],delete this._serializedLayers[h],delete this._updatedLayers[h],delete this._updatedPaintProps[h],g.onRemove&&g.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(h){return this._layers[h]}hasLayer(h){return h in this._layers}hasLayerType(h){for(const g in this._layers)if(this._layers[g].type===h)return!0;return!1}setLayerZoomRange(h,g,b){this._checkLoaded();const T=this.getLayer(h);T?T.minzoom===g&&T.maxzoom===b||(g!=null&&(T.minzoom=g),b!=null&&(T.maxzoom=b),this._updateLayer(T)):this.fire(new o.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(h,g,b={}){this._checkLoaded();const T=this.getLayer(h);if(T){if(!f(T.filter,g))return g==null?(T.filter=void 0,void this._updateLayer(T)):void(this._validate(o.validateFilter,`layers.${T.id}.filter`,g,{layerType:T.type},b)||(T.filter=o.clone$1(g),this._updateLayer(T)))}else this.fire(new o.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be filtered.`)))}getFilter(h){const g=this.getLayer(h);return g&&o.clone$1(g.filter)}setLayoutProperty(h,g,b,T={}){this._checkLoaded();const C=this.getLayer(h);C?f(C.getLayoutProperty(g),b)||(C.setLayoutProperty(g,b,T),this._updateLayer(C)):this.fire(new o.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(h,g){const b=this.getLayer(h);if(b)return b.getLayoutProperty(g);this.fire(new o.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style.`)))}setPaintProperty(h,g,b,T={}){this._checkLoaded();const C=this.getLayer(h);C?f(C.getPaintProperty(g),b)||(C.setPaintProperty(g,b,T)&&this._updateLayer(C),this._changed=!0,this._updatedPaintProps[h]=!0):this.fire(new o.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(h,g){const b=this.getLayer(h);return b&&b.getPaintProperty(g)}setFeatureState(h,g){this._checkLoaded();const b=h.source,T=h.sourceLayer,C=this.getSource(b);if(!C)return void this.fire(new o.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const O=C.type;if(O==="geojson"&&T)return void this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(O==="vector"&&!T)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));h.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided.")));const R=this._getSourceCaches(b);for(const F of R)F.setFeatureState(T,h.id,g)}removeFeatureState(h,g){this._checkLoaded();const b=h.source,T=this.getSource(b);if(!T)return void this.fire(new o.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const C=T.type,O=C==="vector"?h.sourceLayer:void 0;if(C==="vector"&&!O)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(g&&typeof h.id!="string"&&typeof h.id!="number")return void this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const R=this._getSourceCaches(b);for(const F of R)F.removeFeatureState(O,h.id,g)}getFeatureState(h){this._checkLoaded();const g=h.source,b=h.sourceLayer,T=this.getSource(g);if(T){if(T.type!=="vector"||b)return h.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(g)[0].getFeatureState(b,h.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const h={};for(const g in this._sourceCaches){const b=this._sourceCaches[g].getSource();h[b.id]||(h[b.id]=b.serialize())}return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:h,layers:this._serializeLayers(this._order)},g=>g!==void 0)}_updateLayer(h){this._updatedLayers[h.id]=!0;const g=this._getLayerSourceCache(h);h.source&&!this._updatedSources[h.source]&&g&&g.getSource().type!=="raster"&&(this._updatedSources[h.source]="reload",g.pause()),this._changed=!0,h.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(h){const g=O=>this._layers[O].type==="fill-extrusion",b={},T=[];for(let O=this._order.length-1;O>=0;O--){const R=this._order[O];if(g(R)){b[R]=O;for(const F of h){const Z=F[R];if(Z)for(const j of Z)T.push(j)}}}T.sort((O,R)=>R.intersectionZ-O.intersectionZ);const C=[];for(let O=this._order.length-1;O>=0;O--){const R=this._order[O];if(g(R))for(let F=T.length-1;F>=0;F--){const Z=T[F].feature;if(b[Z.layer.id]<O)break;C.push(Z),T.pop()}else for(const F of h){const Z=F[R];if(Z)for(const j of Z)C.push(j.feature)}}return C}queryRenderedFeatures(h,g,b){g&&g.filter&&this._validate(o.validateFilter,"queryRenderedFeatures.filter",g.filter,null,g);const T={};if(g&&g.layers){if(!Array.isArray(g.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const F of g.layers){const Z=this._layers[F];if(!Z)return this.fire(new o.ErrorEvent(new Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];T[Z.source]=!0}}const C=[];g.availableImages=this._availableImages;const O=g&&g.layers?g.layers.some(F=>{const Z=this.getLayer(F);return Z&&Z.is3D()}):this.has3DLayers(),R=lt.createFromScreenPoints(h,b);for(const F in this._sourceCaches){const Z=this._sourceCaches[F].getSource().id;g.layers&&!T[Z]||C.push($i(this._sourceCaches[F],this._layers,this._serializedLayers,R,g,b,O,!!this.map._showQueryGeometry))}return this.placement&&C.push(function(F,Z,j,Q,oe,he,pe){const de={},ge=he.queryRenderedSymbols(Q),ee=[];for(const ce of Object.keys(ge).map(Number))ee.push(pe[ce]);ee.sort(Ia);for(const ce of ee){const _e=ce.featureIndex.lookupSymbolFeatures(ge[ce.bucketInstanceId],Z,ce.bucketIndex,ce.sourceLayerIndex,oe.filter,oe.layers,oe.availableImages,F);for(const xe in _e){const De=de[xe]=de[xe]||[],ke=_e[xe];ke.sort((Re,Ge)=>{const ze=ce.featureSortOrder;if(ze){const Qe=ze.indexOf(Re.featureIndex);return ze.indexOf(Ge.featureIndex)-Qe}return Ge.featureIndex-Re.featureIndex});for(const Re of ke)De.push(Re)}}for(const ce in de)de[ce].forEach(_e=>{const xe=_e.feature,De=j(F[ce]);if(!De)return;const ke=De.getFeatureState(xe.layer["source-layer"],xe.id);xe.source=xe.layer.source,xe.layer["source-layer"]&&(xe.sourceLayer=xe.layer["source-layer"]),xe.state=ke});return de}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),R.screenGeometry,g,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(C)}querySourceFeatures(h,g){g&&g.filter&&this._validate(o.validateFilter,"querySourceFeatures.filter",g.filter,null,g);const b=this._getSourceCaches(h);let T=[];for(const C of b)T=T.concat(_o(C,g));return T}addSourceType(h,g,b){return ql.getSourceType(h)?b(new Error(`A source type called "${h}" already exists.`)):(ql.setSourceType(h,g),g.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:g.workerSourceURL},b):b(null,null))}getLight(){return this.light.getLight()}setLight(h,g={}){this._checkLoaded();const b=this.light.getLight();let T=!1;for(const O in h)if(!f(h[O],b[O])){T=!0;break}if(!T)return;const C=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(h,g),this.light.updateTransitions(C)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(h,g=1){if(this._checkLoaded(),!h)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let b=h;if(g===1){if(typeof b.source=="object"){const T="terrain-dem-src";this.addSource(T,b.source),b=o.clone$1(b),b=o.extend(b,{source:T})}if(this._validate(o.validateTerrain,"terrain",b))return}if(!this.terrain||this.terrain&&g!==this.terrain.drapeRenderMode){if(!b)return;this._createTerrain(b,g)}else{const T=this.terrain,C=T.get();for(const O of Object.keys(o.spec.terrain))!b.hasOwnProperty(O)&&o.spec.terrain[O].default&&(b[O]=o.spec.terrain[O].default);for(const O in b)if(!f(b[O],C[O])){T.set(b),this.stylesheet.terrain=b;const R=this._setTransitionParameters({duration:0});T.updateTransitions(R);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(h){const g=this.fog=new Ke(h,this.map.transform);this.stylesheet.fog=h;const b=this._setTransitionParameters({duration:0});g.updateTransitions(b)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const h of this.map._markers)h._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(h){if(this._checkLoaded(),!h)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const g=this.fog,b=g.get();Object.keys(h).length===0&&g.set(h);for(const T in h)if(!f(h[T],b[T])){g.set(h),this.stylesheet.fog=h;const C=this._setTransitionParameters({duration:0});g.updateTransitions(C);break}}else this._createFog(h);this._markersNeedUpdate=!0}_setTransitionParameters(h){return{now:o.exported.now(),transition:o.extend(h,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const h=this._order.filter(b=>this.isLayerDraped(this._layers[b])),g=this._order.filter(b=>!this.isLayerDraped(this._layers[b]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...h),this._drapedFirstOrder.push(...g)}_createTerrain(h,g){const b=this.terrain=new He(h,g);this.stylesheet.terrain=h,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const T=this._setTransitionParameters({duration:0});b.updateTransitions(T)}_force3DLayerUpdate(){for(const h in this._layers){const g=this._layers[h];g.type==="fill-extrusion"&&this._updateLayer(g)}}_forceSymbolLayerUpdate(){for(const h in this._layers){const g=this._layers[h];g.type==="symbol"&&this._updateLayer(g)}}_validate(h,g,b,T,C={}){return(!C||C.validate!==!1)&&Pc(this,h.call(o.validateStyle,o.extend({key:g,style:this.serialize(),value:b,styleSpec:o.spec},T)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const h in this._layers)this._layers[h].setEventedParent(null);for(const h in this._sourceCaches)this._sourceCaches[h].clearTiles(),this._sourceCaches[h].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(h){const g=this._getSourceCaches(h);for(const b of g)b.clearTiles()}_reloadSource(h){const g=this._getSourceCaches(h);for(const b of g)b.resume(),b.reload()}_reloadSources(){for(const h of this._getSources())h.reload&&h.reload()}_updateSources(h){for(const g in this._sourceCaches)this._sourceCaches[g].update(h)}_generateCollisionBoxes(){for(const h in this._sourceCaches){const g=this._sourceCaches[h];g.resume(),g.reload()}}_updatePlacement(h,g,b,T,C=!1){let O=!1,R=!1;const F={};for(const Z of this._order){const j=this._layers[Z];if(j.type!=="symbol")continue;if(!F[j.source]){const oe=this._getLayerSourceCache(j);if(!oe)continue;F[j.source]=oe.getRenderableIds(!0).map(he=>oe.getTileByID(he)).sort((he,pe)=>pe.tileID.overscaledZ-he.tileID.overscaledZ||(he.tileID.isLessThan(pe.tileID)?-1:1))}const Q=this.crossTileSymbolIndex.addLayer(j,F[j.source],h.center.lng,h.projection);O=O||Q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),C=C||this._layerOrderChanged||b===0,this._layerOrderChanged&&this.fire(new o.Event("neworder")),(C||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),h.zoom))&&(this.pauseablePlacement=new Qy(h,this._order,C,g,b,T,this.placement,this.fog&&h.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,F),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),R=!0),O&&this.pauseablePlacement.placement.setStale()),R||O)for(const Z of this._order){const j=this._layers[Z];j.type==="symbol"&&this.placement.updateLayerOpacities(j,F[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const h in this._sourceCaches)this._sourceCaches[h].releaseSymbolFadeTiles()}getImages(h,g,b){this.imageManager.getImages(g.icons,b),this._updateTilesForChangedImages();const T=C=>{C&&C.setDependencies(g.tileID.key,g.type,g.icons)};T(this._otherSourceCaches[g.source]),T(this._symbolSourceCaches[g.source])}getGlyphs(h,g,b){this.glyphManager.getGlyphs(g.stacks,b)}getResource(h,g,b){return o.makeRequest(g,b)}_getSourceCache(h){return this._otherSourceCaches[h]}_getLayerSourceCache(h){return h.type==="symbol"?this._symbolSourceCaches[h.source]:this._otherSourceCaches[h.source]}_getSourceCaches(h){const g=[];return this._otherSourceCaches[h]&&g.push(this._otherSourceCaches[h]),this._symbolSourceCaches[h]&&g.push(this._symbolSourceCaches[h]),g}_isSourceCacheLoaded(h){const g=this._getSourceCaches(h);return g.length===0?(this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${h}'`))),!1):g.every(b=>b.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ql.getSourceType=function(v){return Gn[v]},ql.setSourceType=function(v,h){Gn[v]=h},ql.registerForPluginStateChange=o.registerForPluginStateChange;var rv=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,gh="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",$u=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,kd=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,ju=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let wg={},yf={};const Nd=[];vf(rv,Nd),vf($u,Nd),vf(kd,Nd),vf(ju,Nd),wg=Jr("",$u),yf=Jr(ju,kd);const m1=Jr(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Eg=rv,iv=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var ov={background:Jr(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Jr(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Jr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Jr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Jr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Jr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Jr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Jr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Jr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Jr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Jr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Jr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Jr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Jr(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Jr(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Jr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Jr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Jr(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Jr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Jr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Jr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Jr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Jr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Jr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Jr(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Jr(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,gh),skyboxGradient:Jr(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,gh),skyboxCapture:Jr(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Jr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Jr(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function vf(v,h){const g=v.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let b of g)if(b=b.trim(),b[0]==="#"&&b.includes("if")&&!b.includes("endif")){b=b.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const T=b.split(" ");for(const C of T)h.includes(C)||h.push(C)}}function Jr(v,h){const g=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,b=h.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),T={},C=[...Nd];return vf(v,C),vf(h,C),{fragmentSource:v=v.replace(g,(O,R,F,Z,j)=>(T[j]=!0,R==="define"?`
#ifndef HAS_UNIFORM_u_${j}
varying ${F} ${Z} ${j};
#else
uniform ${F} ${Z} u_${j};
#endif
`:`
#ifdef HAS_UNIFORM_u_${j}
    ${F} ${Z} ${j} = u_${j};
#endif
`)),vertexSource:h=h.replace(g,(O,R,F,Z,j)=>{const Q=Z==="float"?"vec2":"vec4",oe=j.match(/color/)?"color":Q;return T[j]?R==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
attribute ${F} ${Q} a_${j};
varying ${F} ${Z} ${j};
#else
uniform ${F} ${Z} u_${j};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = a_${j};
#else
    ${F} ${Z} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = unpack_mix_${oe}(a_${j}, u_${j}_t);
#else
    ${F} ${Z} ${j} = u_${j};
#endif
`:R==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
attribute ${F} ${Q} a_${j};
#else
uniform ${F} ${Z} u_${j};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${F} ${Z} ${j} = a_${j};
#else
    ${F} ${Z} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${F} ${Z} ${j} = unpack_mix_${oe}(a_${j}, u_${j}_t);
#else
    ${F} ${Z} ${j} = u_${j};
#endif
`}),staticAttributes:b,usedDefines:C}}class gE{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(h,g,b,T,C,O,R){this.context=h;let F=this.boundPaintVertexBuffers.length!==T.length;for(let j=0;!F&&j<T.length;j++)this.boundPaintVertexBuffers[j]!==T[j]&&(F=!0);let Z=this.boundDynamicVertexBuffers.length!==R.length;for(let j=0;!Z&&j<R.length;j++)this.boundDynamicVertexBuffers[j]!==R[j]&&(Z=!0);if(!h.extVertexArrayObject||!this.vao||this.boundProgram!==g||this.boundLayoutVertexBuffer!==b||F||Z||this.boundIndexBuffer!==C||this.boundVertexOffset!==O)this.freshBind(g,b,T,C,O,R);else{h.bindVertexArrayOES.set(this.vao);for(const j of R)j&&j.bind();C&&C.dynamicDraw&&C.bind()}}freshBind(h,g,b,T,C,O){let R;const F=h.numAttributes,Z=this.context,j=Z.gl;if(Z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Z.extVertexArrayObject.createVertexArrayOES(),Z.bindVertexArrayOES.set(this.vao),R=0,this.boundProgram=h,this.boundLayoutVertexBuffer=g,this.boundPaintVertexBuffers=b,this.boundIndexBuffer=T,this.boundVertexOffset=C,this.boundDynamicVertexBuffers=O;else{R=Z.currentNumAttributes||0;for(let Q=F;Q<R;Q++)j.disableVertexAttribArray(Q)}g.enableAttributes(j,h),g.bind(),g.setVertexAttribPointers(j,h,C);for(const Q of b)Q.enableAttributes(j,h),Q.bind(),Q.setVertexAttribPointers(j,h,C);for(const Q of O)Q&&(Q.enableAttributes(j,h),Q.bind(),Q.setVertexAttribPointers(j,h,C));T&&T.bind(),Z.currentNumAttributes=F}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function av(v,h){const g=Math.pow(2,h.canonical.z),b=h.canonical.y;return[new o.MercatorCoordinate(0,b/g).toLngLat().lat,new o.MercatorCoordinate(0,(b+1)/g).toLngLat().lat]}function y1(v,h,g,b,T,C,O){const R=v.context,F=R.gl,Z=g.fbo;if(!Z)return;v.prepareDrawTile();const j=v.useProgram("hillshade");R.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,Z.colorAttachment.get());const Q=((de,ge,ee,ce)=>{const _e=ee.paint.get("hillshade-shadow-color"),xe=ee.paint.get("hillshade-highlight-color"),De=ee.paint.get("hillshade-accent-color");let ke=ee.paint.get("hillshade-illumination-direction")*(Math.PI/180);ee.paint.get("hillshade-illumination-anchor")==="viewport"&&(ke-=de.transform.angle);const Re=!de.options.moving;return{u_matrix:ce||de.transform.calculateProjMatrix(ge.tileID.toUnwrapped(),Re),u_image:0,u_latrange:av(0,ge.tileID),u_light:[ee.paint.get("hillshade-exaggeration"),ke],u_shadow:_e,u_highlight:xe,u_accent:De}})(v,g,b,v.terrain?h.projMatrix:null);v.prepareDrawProgram(R,j,h.toUnwrapped());const{tileBoundsBuffer:oe,tileBoundsIndexBuffer:he,tileBoundsSegments:pe}=v.getTileBoundsBuffers(g);j.draw(R,F.TRIANGLES,T,C,O,o.CullFaceMode.disabled,Q,b.id,oe,he,pe)}function sv(v,h,g){if(!h.needsDEMTextureUpload)return;const b=v.context,T=b.gl;b.pixelStoreUnpackPremultiplyAlpha.set(!1),h.demTexture=h.demTexture||v.getTileTexture(g.stride);const C=g.getPixels();h.demTexture?h.demTexture.update(C,{premultiply:!1}):h.demTexture=new o.Texture(b,C,T.RGBA,{premultiply:!1}),h.needsDEMTextureUpload=!1}function v1(v,h,g,b,T,C){const O=v.context,R=O.gl;if(!h.dem)return;const F=h.dem;if(O.activeTexture.set(R.TEXTURE1),sv(v,h,F),!h.demTexture)return;h.demTexture.bind(R.NEAREST,R.CLAMP_TO_EDGE);const Z=F.dim;O.activeTexture.set(R.TEXTURE0);let j=h.fbo;if(!j){const pe=new o.Texture(O,{width:Z,height:Z,data:null},R.RGBA);pe.bind(R.LINEAR,R.CLAMP_TO_EDGE),j=h.fbo=O.createFramebuffer(Z,Z,!0),j.colorAttachment.set(pe.texture)}O.bindFramebuffer.set(j.framebuffer),O.viewport.set([0,0,Z,Z]);const{tileBoundsBuffer:Q,tileBoundsIndexBuffer:oe,tileBoundsSegments:he}=v.getMercatorTileBoundsBuffers();v.useProgram("hillshadePrepare").draw(O,R.TRIANGLES,b,T,C,o.CullFaceMode.disabled,((pe,de)=>{const ge=de.stride,ee=o.create();return o.ortho(ee,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(ee,ee,[0,-o.EXTENT,0]),{u_matrix:ee,u_image:1,u_dimension:[ge,ge],u_zoom:pe.overscaledZ,u_unpack:de.unpackVector}})(h.tileID,F),g.id,Q,oe,he),h.needsHillshadePrepare=!1}const lv=v=>({u_matrix:new o.UniformMatrix4f(v),u_image0:new o.Uniform1i(v),u_skirt_height:new o.Uniform1f(v)}),_f=(v,h)=>({u_matrix:v,u_image0:0,u_skirt_height:h}),Sg=(v,h,g,b,T,C,O,R,F,Z,j,Q,oe,he,pe)=>({u_proj_matrix:Float32Array.from(v),u_globe_matrix:h,u_normalize_matrix:Float32Array.from(b),u_merc_matrix:g,u_zoom_transition:T,u_merc_center:C,u_image0:0,u_frustum_tl:O,u_frustum_tr:R,u_frustum_br:F,u_frustum_bl:Z,u_globe_pos:j,u_globe_radius:Q,u_viewport:oe,u_grid_matrix:pe?Float32Array.from(pe):new Float32Array(9),u_skirt_height:he});function xf(v,h){return v!=null&&h!=null&&!(!v.hasData()||!h.hasData())&&v.demTexture!=null&&h.demTexture!=null&&v.tileID.key!==h.tileID.key}const qu=new class{constructor(){this.operations={}}newMorphing(v,h,g,b,T){if(v in this.operations){const C=this.operations[v];C.to.tileID.key!==g.tileID.key&&(C.queued=g)}else this.operations[v]={startTime:b,phase:0,duration:T,from:h,to:g,queued:null}}getMorphValuesForProxy(v){if(!(v in this.operations))return null;const h=this.operations[v];return{from:h.from,to:h.to,phase:h.phase}}update(v){for(const h in this.operations){const g=this.operations[h];for(g.phase=(v-g.startTime)/g.duration;g.phase>=1||!this._validOp(g);)if(!this._nextOp(g,v)){delete this.operations[h];break}}}_nextOp(v,h){return!!v.queued&&(v.from=v.to,v.to=v.queued,v.queued=null,v.phase=0,v.startTime=h,!0)}_validOp(v){return v.from.hasData()&&v.to.hasData()}},mh={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Tg(v){return 6*Math.pow(1.5,22-v)}function _1(v,h){const g=1<<v.z;return!h&&(v.x===0||v.x===g-1)||v.y===0||v.y===g-1}const Fd=v=>({u_matrix:v});function uv(v,h,g,b,T){if(T>0){const C=o.exported.now(),O=(C-v.timeAdded)/T,R=h?(C-h.timeAdded)/T:-1,F=g.getSource(),Z=b.coveringZoomLevel({tileSize:F.tileSize,roundZoom:F.roundZoom}),j=!h||Math.abs(h.tileID.overscaledZ-Z)>Math.abs(v.tileID.overscaledZ-Z),Q=j&&v.refreshedUponExpiration?1:o.clamp(j?O:1-R,0,1);return v.refreshedUponExpiration&&O>=1&&(v.refreshedUponExpiration=!1),h?{opacity:1,mix:1-Q}:{opacity:Q,mix:0}}return{opacity:1,mix:0}}class cv extends o.SourceCache{constructor(h){const g={type:"raster-dem",maxzoom:h.transform.maxZoom},b=new Be(df(),null),T=Yn("mock-dem",g,b,h.style);super("mock-dem",T,!1),T.setEventedParent(this),this._sourceLoaded=!0}_loadTile(h,g){h.state="loaded",g(null)}}class Ig extends o.SourceCache{constructor(h){const g=Yn("proxy",{type:"geojson",maxzoom:h.transform.maxZoom},new Be(df(),null),h.style);super("proxy",g,!1),g.setEventedParent(this),this.map=this.getSource().map=h,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(h,g,b){if(h.freezeTileCoverage)return;this.transform=h;const T=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((C,O)=>{if(C[O.key]="",!this._tiles[O.key]){const R=new o.Tile(O,this._source.tileSize*O.overscaleFactor(),h.tileZoom);R.state="loaded",this._tiles[O.key]=R}return C},{});for(const C in this._tiles)C in T||(this.freeFBO(C),this._tiles[C].unloadVectorData(),delete this._tiles[C])}freeFBO(h){const g=this.proxyCachedFBO[h];if(g!==void 0){const b=Object.values(g);this.renderCachePool.push(...b),delete this.proxyCachedFBO[h]}}deallocRenderCache(){this.renderCache.forEach(h=>h.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Cg extends o.OverscaledTileID{constructor(h,g,b){super(h.overscaledZ,h.wrap,h.canonical.z,h.canonical.x,h.canonical.y),this.proxyTileKey=g,this.projMatrix=b}}class hv extends o.Elevation{constructor(h,g){super(),this.painter=h,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[b,T,C]=function(F){const Z=new o.StructArrayLayout2i4,j=new o.StructArrayLayout3ui6,Q=131;Z.reserve(17161),j.reserve(33800);const oe=o.EXTENT/128,he=o.EXTENT+oe/2,pe=he+oe;for(let ge=-oe;ge<pe;ge+=oe)for(let ee=-oe;ee<pe;ee+=oe){const ce=ee<0||ee>he||ge<0||ge>he?24575:0,_e=o.clamp(Math.round(ee),0,o.EXTENT),xe=o.clamp(Math.round(ge),0,o.EXTENT);Z.emplaceBack(_e+ce,xe)}const de=(ge,ee)=>{const ce=ee*Q+ge;j.emplaceBack(ce+1,ce,ce+Q),j.emplaceBack(ce+Q,ce+Q+1,ce+1)};for(let ge=1;ge<129;ge++)for(let ee=1;ee<129;ee++)de(ee,ge);return[0,129].forEach(ge=>{for(let ee=0;ee<130;ee++)de(ee,ge),de(ge,ee)}),[Z,j,32768]}(),O=h.context;this.gridBuffer=O.createVertexBuffer(b,o.posAttributes.members),this.gridIndexBuffer=O.createIndexBuffer(T),this.gridSegments=o.SegmentVector.simpleSegment(0,0,b.length,T.length),this.gridNoSkirtSegments=o.SegmentVector.simpleSegment(0,0,b.length,C),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ig(g.map),this.orthoMatrix=o.create(),o.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.EXTENT,0,o.EXTENT,0,1);const R=O.gl;this._overlapStencilMode=new o.StencilMode({func:R.GEQUAL,mask:255},0,255,R.KEEP,R.KEEP,R.REPLACE),this._previousZoom=h.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=g,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new cv(g.map)}set style(h){h.on("data",this._onStyleDataEvent.bind(this)),h.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=h,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(h,g,b){if(h&&h.terrain){this._style!==h&&(this.style=h),this.enabled=!0;const T=h.terrain.properties;this.sourceCache=h.terrain.drapeRenderMode===0?this._mockSourceCache:h._getSourceCache(T.get("source")),this._exaggeration=T.get("exaggeration");const C=()=>{this.sourceCache.used&&o.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const O=this.getScaledDemTileSize();this.sourceCache.update(g,O,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,C(),this._initializing=!0),C(),g.updateElevation(!0,b),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(g),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(h){this._findCoveringTileCache[h]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const h=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||h.efficiency!==100&&o.warnOnce(`Terrain render cache efficiency is not optimal (${h.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${h.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(h){h.coord&&h.dataType==="source"?this._clearRenderCacheForTile(h.sourceCacheId,h.coord):h.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const h in this._style._sourceCaches)this._style._sourceCaches[h].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(h=>h.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const h=2*this.proxySourceCache.getSource().tileSize;return[h,h]}set useVertexMorphing(h){this._useVertexMorphing=h}updateTileBinding(h){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const g=this.proxySourceCache,b=this.painter.transform;this._initializing&&(this._initializing=b._centerAltitude===0&&this.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(b.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const T=this.proxyCoords=g.getIds().map(F=>{const Z=g.getTileByID(F).tileID;return Z.projMatrix=b.calculateProjMatrix(Z.toUnwrapped()),Z});(function(F,Z){const j=Z.transform.pointCoordinate(Z.transform.getCameraPoint()),Q=new o.Point(j.x,j.y);F.sort((oe,he)=>{if(he.overscaledZ-oe.overscaledZ)return he.overscaledZ-oe.overscaledZ;const pe=new o.Point(oe.canonical.x+(1<<oe.canonical.z)*oe.wrap,oe.canonical.y),de=new o.Point(he.canonical.x+(1<<he.canonical.z)*he.wrap,he.canonical.y),ge=Q.mult(1<<oe.canonical.z);return ge.x-=.5,ge.y-=.5,ge.distSqr(pe)-ge.distSqr(de)})})(T,this.painter),this._previousZoom=b.zoom;const C=this.proxyToSource||{};this.proxyToSource={},T.forEach(F=>{this.proxyToSource[F.key]={}}),this.terrainTileForTile={};const O=this._style._sourceCaches;for(const F in O){const Z=O[F];if(!Z.used||(Z!==this.sourceCache&&this.resetTileLookupCache(Z.id),this._setupProxiedCoordsForOrtho(Z,h[F],C),Z.usedForTerrain))continue;const j=h[F];Z.getSource().reparseOverscaled&&this._assignTerrainTiles(j)}this.proxiedCoords[g.id]=T.map(F=>new Cg(F,F.key,this.orthoMatrix)),this._assignTerrainTiles(T),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(C),this.renderingToTexture=!1,this._updateTimestamp=o.exported.now();const R={};this._visibleDemTiles=[];for(const F of this.proxyCoords){const Z=this.terrainTileForTile[F.key];if(!Z)continue;const j=Z.tileID.key;j in R||(this._visibleDemTiles.push(Z),R[j]=j)}}_assignTerrainTiles(h){this._initializing||h.forEach(g=>{if(this.terrainTileForTile[g.key])return;const b=this._findTileCoveringTileID(g,this.sourceCache);b&&(this.terrainTileForTile[g.key]=b)})}_prepareDEMTextures(){const h=this.painter.context,g=h.gl;for(const b in this.terrainTileForTile){const T=this.terrainTileForTile[b],C=T.dem;!C||T.demTexture&&!T.needsDEMTextureUpload||(h.activeTexture.set(g.TEXTURE1),sv(this.painter,T,C))}}_prepareDemTileUniforms(h,g,b,T){if(!g||g.demTexture==null)return!1;const C=h.tileID.canonical,O=Math.pow(2,g.tileID.canonical.z-C.z),R=T||"";return b[`u_dem_tl${R}`]=[C.x*O%1,C.y*O%1],b[`u_dem_scale${R}`]=O,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const h=this.painter.context,g=h.gl;if(!this._emptyDepthBufferTexture){const b=new o.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new o.Texture(h,b,g.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let h=0;const g=this._visibleDemTiles.reduce((b,T)=>{if(!T.dem)return b;const C=T.dem.tree.minimums[0];return C>0&&h++,b+C},0);return h?g/h:0}_updateEmptyDEMTexture(){const h=this.painter.context,g=h.gl;h.activeTexture.set(g.TEXTURE2);const b=this._getLoadedAreaMinimum(),T=new o.RGBAImage({width:1,height:1},new Uint8Array(o.DEMData.pack(b,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let C=this._emptyDEMTexture;return C?C.update(T,{premultiply:!1}):C=this._emptyDEMTexture=new o.Texture(h,T,g.RGBA,{premultiply:!1}),C}setupElevationDraw(h,g,b){const T=this.painter.context,C=T.gl,O=(R=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:o.DEMData.getUnpackVector(R),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var R;O.u_dem_size=this.sourceCache.getSource().tileSize,O.u_exaggeration=this.exaggeration();let F=null,Z=null,j=1;if(b&&b.morphing&&this._useVertexMorphing){const Q=b.morphing.srcDemTile,oe=b.morphing.dstDemTile;j=b.morphing.phase,Q&&oe&&(this._prepareDemTileUniforms(h,Q,O,"_prev")&&(Z=Q),this._prepareDemTileUniforms(h,oe,O)&&(F=oe))}if(Z&&F?(T.activeTexture.set(C.TEXTURE2),F.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),T.activeTexture.set(C.TEXTURE4),Z.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),O.u_dem_lerp=j):(F=this.terrainTileForTile[h.tileID.key],T.activeTexture.set(C.TEXTURE2),(this._prepareDemTileUniforms(h,F,O)?F.demTexture:this.emptyDEMTexture).bind(C.NEAREST,C.CLAMP_TO_EDGE)),T.activeTexture.set(C.TEXTURE3),b&&b.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),this._depthFBO&&(O.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),O.u_depth_size_inv=[1,1]),b&&b.useMeterToDem&&F){const Q=(1<<F.tileID.canonical.z)*o.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;O.u_meter_to_dem=Q}if(b&&b.labelPlaneMatrixInv&&(O.u_label_plane_matrix_inv=b.labelPlaneMatrixInv),g.setTerrainUniformValues(T,O),this.painter.transform.projection.name==="globe"){const Q=this.globeUniformValues(this.painter.transform,h.tileID.canonical,b&&b.useDenormalizedUpVectorScale);g.setGlobeUniformValues(T,Q)}}globeUniformValues(h,g,b){const T=h.projection;return{u_tile_tl_up:T.upVector(g,0,0),u_tile_tr_up:T.upVector(g,o.EXTENT,0),u_tile_br_up:T.upVector(g,o.EXTENT,o.EXTENT),u_tile_bl_up:T.upVector(g,0,o.EXTENT),u_tile_up_scale:b?o.globeMetersToEcef(1):T.upVectorScale(g,h.center.lat,h.worldSize).metersToTile}}renderToBackBuffer(h){const g=this.painter,b=this.painter.context;h.length!==0&&(b.bindFramebuffer.set(null),b.viewport.set([0,0,g.width,g.height]),g.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(T,C,O,R,F){if(T.transform.projection.name==="globe")(function(Z,j,Q,oe,he){const pe=Z.context,de=pe.gl;let ge,ee;const ce=Z.options.showTerrainWireframe?2:0,_e=Z.transform,xe=o.globeUseCustomAntiAliasing(Z,pe,_e),De=(wt,Ye)=>{if(ee===wt)return;const pt=[mh[wt],"PROJECTION_GLOBE_VIEW"];xe&&pt.push("CUSTOM_ANTIALIASING"),Ye&&pt.push(mh[ce]),ge=Z.useProgram("globeRaster",null,pt),ee=wt},ke=Z.colorModeForRenderPass(),Re=new o.DepthMode(de.LEQUAL,o.DepthMode.ReadWrite,Z.depthRangeFor3D);qu.update(he);const Ge=o.calculateGlobeMercatorMatrix(_e),ze=[o.mercatorXfromLng(_e.center.lng),o.mercatorYfromLat(_e.center.lat)],Qe=ce?[!1,!0]:[!1],Et=Z.globeSharedBuffers,Xe=[_e.width*o.exported.devicePixelRatio,_e.height*o.exported.devicePixelRatio],gt=Float32Array.from(_e.globeMatrix),rt={useDenormalizedUpVectorScale:!0};if(Qe.forEach(wt=>{const Ye=Z.transform,pt=Tg(Ye.zoom)*j.exaggeration();ee=-1;const It=wt?de.LINES:de.TRIANGLES;for(const _t of oe){const Pt=Q.getTile(_t),yn=o.StencilMode.disabled,Ln=j.prevTerrainTileForTile[_t.key],an=j.terrainTileForTile[_t.key];xf(Ln,an)&&qu.newMorphing(_t.key,Ln,an,he,250),pe.activeTexture.set(de.TEXTURE0),Pt.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE);const En=qu.getMorphValuesForProxy(_t.key),tr=En?1:0;En&&o.extend$1(rt,{morphing:{srcDemTile:En.from,dstDemTile:En.to,phase:o.easeCubicInOut(En.phase)}});const Kn=o.tileCornersToBounds(_t.canonical),gn=o.getLatitudinalLod(Kn.getCenter().lat),ni=o.getGridMatrix(_t.canonical,Kn,gn,Ye.worldSize/Ye._pixelsPerMercatorPixel),ui=o.globeNormalizeECEF(o.globeTileBounds(_t.canonical)),ci=Sg(Ye.projMatrix,gt,Ge,ui,o.globeToMercatorTransition(Ye.zoom),ze,Ye.frustumCorners.TL,Ye.frustumCorners.TR,Ye.frustumCorners.BR,Ye.frustumCorners.BL,Ye.globeCenterInViewSpace,Ye.globeRadius,Xe,pt,ni);if(De(tr,wt),j.setupElevationDraw(Pt,ge,rt),Z.prepareDrawProgram(pe,ge,_t.toUnwrapped()),Et){const[hi,Pa,Jo]=wt?Et.getWirefameBuffers(Z.context,gn):Et.getGridBuffers(gn,pt!==0);ge.draw(pe,It,Re,yn,ke,o.CullFaceMode.backCCW,ci,"globe_raster",hi,Pa,Jo)}}}),Et){const wt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];xe&&wt.push("CUSTOM_ANTIALIASING"),ge=Z.useProgram("globeRaster",null,wt);for(const Ye of oe){const{x:pt,y:It,z:_t}=Ye.canonical,Pt=It===0,yn=It===(1<<_t)-1,[Ln,an,En,tr]=Et.getPoleBuffers(_t);if(tr&&(Pt||yn)){const Kn=Q.getTile(Ye);pe.activeTexture.set(de.TEXTURE0),Kn.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE);let gn=o.globePoleMatrixForTile(_t,pt,_e);const ni=o.globeNormalizeECEF(o.globeTileBounds(Ye.canonical)),ui=(ci,hi)=>ci.draw(pe,de.TRIANGLES,Re,o.StencilMode.disabled,ke,o.CullFaceMode.disabled,Sg(_e.projMatrix,gn,gn,ni,0,ze,_e.frustumCorners.TL,_e.frustumCorners.TR,_e.frustumCorners.BR,_e.frustumCorners.BL,_e.globeCenterInViewSpace,_e.globeRadius,Xe,0),"globe_pole_raster",hi,En,tr);j.setupElevationDraw(Kn,ge,rt),Z.prepareDrawProgram(pe,ge,Ye.toUnwrapped()),Pt&&ui(ge,Ln),yn&&(gn=o.scale(o.create(),gn,[1,-1,1]),ui(ge,an))}}}})(T,C,O,R,F);else{const Z=T.context,j=Z.gl;let Q,oe;const he=T.options.showTerrainWireframe?2:0,pe=(_e,xe)=>{if(oe===_e)return;const De=[mh[_e]];xe&&De.push(mh[he]),Q=T.useProgram("terrainRaster",null,De),oe=_e},de=T.colorModeForRenderPass(),ge=new o.DepthMode(j.LEQUAL,o.DepthMode.ReadWrite,T.depthRangeFor3D);qu.update(F);const ee=T.transform,ce=Tg(ee.zoom)*C.exaggeration();(he?[!1,!0]:[!1]).forEach(_e=>{oe=-1;const xe=_e?j.LINES:j.TRIANGLES,[De,ke]=_e?C.getWirefameBuffer():[C.gridIndexBuffer,C.gridSegments];for(const Re of R){const Ge=O.getTile(Re),ze=o.StencilMode.disabled,Qe=C.prevTerrainTileForTile[Re.key],Et=C.terrainTileForTile[Re.key];xf(Qe,Et)&&qu.newMorphing(Re.key,Qe,Et,F,250),Z.activeTexture.set(j.TEXTURE0),Ge.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST);const Xe=qu.getMorphValuesForProxy(Re.key),gt=Xe?1:0;let rt;Xe&&(rt={morphing:{srcDemTile:Xe.from,dstDemTile:Xe.to,phase:o.easeCubicInOut(Xe.phase)}});const wt=_f(Re.projMatrix,_1(Re.canonical,ee.renderWorldCopies)?ce/10:ce);pe(gt,_e),C.setupElevationDraw(Ge,Q,rt),T.prepareDrawProgram(Z,Q,Re.toUnwrapped()),Q.draw(Z,xe,ge,ze,de,o.CullFaceMode.backCCW,wt,"terrain_raster",C.gridBuffer,De,ke)}})}}(g,this,this.proxySourceCache,h,this._updateTimestamp),this.renderingToTexture=!0,g.gpuTimingDeferredRenderEnd(),h.splice(0,h.length))}renderBatch(h){if(this._drapedRenderBatches.length===0)return h+1;this.renderingToTexture=!0;const g=this.painter,b=this.painter.context,T=this.proxySourceCache,C=this.proxiedCoords[T.id],O=this._drapedRenderBatches.shift(),R=[],F=g.style.order;let Z=0;for(const j of C){const Q=T.getTileByID(j.proxyTileKey),oe=T.proxyCachedFBO[j.key]?T.proxyCachedFBO[j.key][h]:void 0,he=oe!==void 0?T.renderCache[oe]:this.pool[Z++],pe=oe!==void 0;if(Q.texture=he.tex,pe&&!he.dirty){R.push(Q.tileID);continue}let de;b.bindFramebuffer.set(he.fb.framebuffer),this.renderedToTile=!1,he.dirty&&(b.clear({color:o.Color.transparent,stencil:0}),he.dirty=!1);for(let ge=O.start;ge<=O.end;++ge){const ee=g.style._layers[F[ge]];if(ee.isHidden(g.transform.zoom))continue;const ce=g.style._getLayerSourceCache(ee),_e=ce?this.proxyToSource[j.key][ce.id]:[j];if(!_e)continue;const xe=_e;b.viewport.set([0,0,he.fb.width,he.fb.height]),de!==(ce?ce.id:null)&&(this._setupStencil(he,_e,ee,ce),de=ce?ce.id:null),g.renderLayer(g,ce,ee,xe)}this.renderedToTile?(he.dirty=!0,R.push(Q.tileID)):pe||--Z,Z===5&&(Z=0,this.renderToBackBuffer(R))}return this.renderToBackBuffer(R),this.renderingToTexture=!1,b.bindFramebuffer.set(null),b.viewport.set([0,0,g.width,g.height]),O.end+1}postRender(){}renderCacheEfficiency(h){const g=h.order.length;if(g===0)return{efficiency:100};let b,T=0,C=0,O=!1;for(let R=0;R<g;++R){const F=h._layers[h.order[R]];this._style.isLayerDraped(F)?(O&&++T,++C):O||(O=!0,b=F.id)}return C===0?{efficiency:100}:{efficiency:100*(1-T/C),firstUndrapedLayer:b}}getMinElevationBelowMSL(){let h=0;return this._visibleDemTiles.filter(g=>g.dem).forEach(g=>{h=Math.min(h,g.dem.tree.minimums[0])}),h===0?h:(h-30)*this._exaggeration}raycast(h,g,b){if(!this._visibleDemTiles)return null;const T=this._visibleDemTiles.filter(C=>C.dem).map(C=>{const O=C.tileID,R=1<<O.overscaledZ,{x:F,y:Z}=O.canonical,j=F/R,Q=(F+1)/R,oe=Z/R,he=(Z+1)/R;return{minx:j,miny:oe,maxx:Q,maxy:he,t:C.dem.tree.raycastRoot(j,oe,Q,he,h,g,b),tile:C}});T.sort((C,O)=>(C.t!==null?C.t:Number.MAX_VALUE)-(O.t!==null?O.t:Number.MAX_VALUE));for(const C of T){if(C.t==null)return null;const O=C.tile.dem.tree.raycast(C.minx,C.miny,C.maxx,C.maxy,h,g,b);if(O!=null)return O}return null}_createFBO(){const h=this.painter.context,g=h.gl,b=this.drapeBufferSize;h.activeTexture.set(g.TEXTURE0);const T=new o.Texture(h,{width:b[0],height:b[1],data:null},g.RGBA);T.bind(g.LINEAR,g.CLAMP_TO_EDGE);const C=h.createFramebuffer(b[0],b[1],!1);return C.colorAttachment.set(T.texture),C.depthAttachment=new Ne(h,C.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=h.createRenderbuffer(h.gl.DEPTH_STENCIL,b[0],b[1]),this._stencilRef=0,C.depthAttachment.set(this._sharedDepthStencil),h.clear({stencil:0})):C.depthAttachment.set(this._sharedDepthStencil),h.extTextureFilterAnisotropic&&!h.extTextureFilterAnisotropicForceOff&&g.texParameterf(g.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax),{fb:C,tex:T,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const h in this._style._sourceCaches)if(this._style._sourceCaches[h].hasTransition())return!0;return this._style.order.some(h=>{const g=this._style._layers[h],b=g.isHidden(this.painter.transform.zoom);return g.type==="custom"?!b&&g.shouldRedrape():!b&&g.hasTransition()})}_clearLineLayersFromRenderCache(){let h=!1;for(const b of this._style._getSources())if(b instanceof zt){h=!0;break}if(!h)return;const g={};for(let b=0;b<this._style.order.length;++b){const T=this._style._layers[this._style.order[b]],C=this._style._getLayerSourceCache(T);if(C&&!g[C.id]&&!T.isHidden(this.painter.transform.zoom)&&T.type==="line"&&T.widthExpression()instanceof o.ZoomDependentExpression){g[C.id]=!0;for(const O of this.proxyCoords){const R=this.proxyToSource[O.key][C.id];if(R)for(const F of R)this._clearRenderCacheForTile(C.id,F)}}}}_clearRasterLayersFromRenderCache(){let h=!1;for(const b in this._style._sourceCaches)if(this._style._sourceCaches[b]._source instanceof At){h=!0;break}if(!h)return;const g={};for(let b=0;b<this._style.order.length;++b){const T=this._style._layers[this._style.order[b]],C=this._style._getLayerSourceCache(T);if(!C||g[C.id]||T.isHidden(this.painter.transform.zoom)||T.type!=="raster")continue;const O=T.paint.get("raster-fade-duration");for(const R of this.proxyCoords){const F=this.proxyToSource[R.key][C.id];if(F)for(const Z of F){const j=uv(C.getTile(Z),C.findLoadedParent(Z,0),C,this.painter.transform,O);(j.opacity!==1||j.mix!==0)&&this._clearRenderCacheForTile(C.id,Z)}}}}_setupDrapedRenderBatches(){const h=this._style.order,g=h.length;if(g===0)return;const b=[];let T,C=0,O=this._style._layers[h[C]];for(;!this._style.isLayerDraped(O)&&O.isHidden(this.painter.transform.zoom)&&++C<g;)O=this._style._layers[h[C]];for(;C<g;++C){const R=this._style._layers[h[C]];R.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(R)?T===void 0&&(T=C):T!==void 0&&(b.push({start:T,end:C-1}),T=void 0))}T!==void 0&&b.push({start:T,end:C-1}),this._drapedRenderBatches=b}_setupRenderCache(h){const g=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,g.renderCache.length>g.renderCachePool.length){const O=Object.values(g.proxyCachedFBO);g.proxyCachedFBO={};for(let R=0;R<O.length;++R){const F=Object.values(O[R]);g.renderCachePool.push(...F)}}return}this._clearRasterLayersFromRenderCache();const b=this.proxyCoords,T=this._tilesDirty;for(let O=b.length-1;O>=0;O--){const R=b[O];if(g.getTileByID(R.key),g.proxyCachedFBO[R.key]!==void 0){const F=h[R.key],Z=this.proxyToSource[R.key];let j=0;for(const Q in Z){const oe=Z[Q],he=F[Q];if(!he||he.length!==oe.length||oe.some((pe,de)=>pe!==he[de]||T[Q]&&T[Q].hasOwnProperty(pe.key))){j=-1;break}++j}for(const Q in g.proxyCachedFBO[R.key])g.renderCache[g.proxyCachedFBO[R.key][Q]].dirty=j<0||j!==Object.values(F).length}}const C=[...this._drapedRenderBatches];C.sort((O,R)=>R.end-R.start-(O.end-O.start));for(const O of C)for(const R of b){if(g.proxyCachedFBO[R.key])continue;let F=g.renderCachePool.pop();F===void 0&&g.renderCache.length<50&&(F=g.renderCache.length,g.renderCache.push(this._createFBO())),F!==void 0&&(g.proxyCachedFBO[R.key]={},g.proxyCachedFBO[R.key][O.start]=F,g.renderCache[F].dirty=!0)}this._tilesDirty={}}_setupStencil(h,g,b,T){if(!T||!this._sourceTilesOverlap[T.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const C=this.painter.context,O=C.gl;if(g.length<=1)return void(this._overlapStencilType=!1);let R;if(b.isTileClipped())R=g.length,this._overlapStencilMode.test={func:O.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(g[0].overscaledZ>g[g.length-1].overscaledZ))return void(this._overlapStencilType=!1);R=1,this._overlapStencilMode.test={func:O.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+R>255&&(C.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=R,this._overlapStencilMode.ref=this._stencilRef,b.isTileClipped()&&this._renderTileClippingMasks(g,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(h){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[h.key]),this._overlapStencilMode):o.StencilMode.disabled}_renderTileClippingMasks(h,g){const b=this.painter,T=this.painter.context,C=T.gl;b._tileClippingMaskIDs={},T.setColorMode(o.ColorMode.disabled),T.setDepthMode(o.DepthMode.disabled);const O=b.useProgram("clippingMask");for(const R of h){const F=b._tileClippingMaskIDs[R.key]=--g;O.draw(T,C.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:C.ALWAYS,mask:0},F,255,C.KEEP,C.KEEP,C.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,Fd(R.projMatrix),"$clipping",b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}}pointCoordinate(h){const g=this.painter.transform;if(h.x<0||h.x>g.width||h.y<0||h.y>g.height)return null;const b=[h.x,h.y,1,1];o.transformMat4$1(b,b,g.pixelMatrixInverse),o.scale$1(b,b,1/b[3]),b[0]/=g.worldSize,b[1]/=g.worldSize;const T=g._camera.position,C=o.mercatorZfromAltitude(1,g.center.lat),O=[T[0],T[1],T[2]/C,0],R=o.subtract([],b.slice(0,3),O);o.normalize(R,R);const F=this.raycast(O,R,this._exaggeration);return F!==null&&F?(o.scaleAndAdd(O,O,R,F),O[3]=O[2],O[2]*=C,O):null}drawDepth(){const h=this.painter,g=h.context,b=this.proxySourceCache,T=Math.ceil(h.width),C=Math.ceil(h.height);if(!this._depthFBO||this._depthFBO.width===T&&this._depthFBO.height===C||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const O=g.gl,R=g.createFramebuffer(T,C,!0);g.activeTexture.set(O.TEXTURE0);const F=new o.Texture(g,{width:T,height:C,data:null},O.RGBA);F.bind(O.NEAREST,O.CLAMP_TO_EDGE),R.colorAttachment.set(F.texture);const Z=g.createRenderbuffer(g.gl.DEPTH_COMPONENT16,T,C);R.depthAttachment.set(Z),this._depthFBO=R,this._depthTexture=F}g.bindFramebuffer.set(this._depthFBO.framebuffer),g.viewport.set([0,0,T,C]),function(O,R,F,Z){if(O.transform.projection.name==="globe")return;const j=O.context,Q=j.gl;j.clear({depth:1});const oe=O.useProgram("terrainDepth"),he=new o.DepthMode(Q.LESS,o.DepthMode.ReadWrite,O.depthRangeFor3D);for(const pe of Z){const de=F.getTile(pe),ge=_f(pe.projMatrix,0);R.setupElevationDraw(de,oe),oe.draw(j,Q.TRIANGLES,he,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.backCCW,ge,"terrain_depth",R.gridBuffer,R.gridIndexBuffer,R.gridNoSkirtSegments)}}(h,this,b,this.proxyCoords)}_setupProxiedCoordsForOrtho(h,g,b){if(h.getSource()instanceof Hn)return this._setupProxiedCoordsForImageSource(h,g,b);this._findCoveringTileCache[h.id]=this._findCoveringTileCache[h.id]||{};const T=this.proxiedCoords[h.id]=[],C=this.proxyCoords;for(let R=0;R<C.length;R++){const F=C[R],Z=this._findTileCoveringTileID(F,h);if(Z){const j=this._createProxiedId(F,Z,b[F.key]&&b[F.key][h.id]);T.push(j),this.proxyToSource[F.key][h.id]=[j]}}let O=!1;for(let R=0;R<g.length;R++){const F=h.getTile(g[R]);if(!F||!F.hasData())continue;const Z=this._findTileCoveringTileID(F.tileID,this.proxySourceCache);if(Z&&Z.tileID.canonical.z!==F.tileID.canonical.z){const j=this.proxyToSource[Z.tileID.key][h.id],Q=this._createProxiedId(Z.tileID,F,b[Z.tileID.key]&&b[Z.tileID.key][h.id]);j?j.splice(j.length-1,0,Q):this.proxyToSource[Z.tileID.key][h.id]=[Q],T.push(Q),O=!0}}this._sourceTilesOverlap[h.id]=O}_setupProxiedCoordsForImageSource(h,g,b){if(!h.getSource().loaded())return;const T=this.proxiedCoords[h.id]=[],C=this.proxyCoords,O=h.getSource(),R=new o.Point(O.tileID.x,O.tileID.y)._div(1<<O.tileID.z),F=O.coordinates.map(o.MercatorCoordinate.fromLngLat).reduce((j,Q)=>(j.min.x=Math.min(j.min.x,Q.x-R.x),j.min.y=Math.min(j.min.y,Q.y-R.y),j.max.x=Math.max(j.max.x,Q.x-R.x),j.max.y=Math.max(j.max.y,Q.y-R.y),j),{min:new o.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Z=(j,Q)=>{const oe=j.wrap+j.canonical.x/(1<<j.canonical.z),he=j.canonical.y/(1<<j.canonical.z),pe=o.EXTENT/(1<<j.canonical.z),de=Q.wrap+Q.canonical.x/(1<<Q.canonical.z),ge=Q.canonical.y/(1<<Q.canonical.z);return oe+pe<de+F.min.x||oe>de+F.max.x||he+pe<ge+F.min.y||he>ge+F.max.y};for(let j=0;j<C.length;j++){const Q=C[j];for(let oe=0;oe<g.length;oe++){const he=h.getTile(g[oe]);if(!he||!he.hasData()||Z(Q,he.tileID))continue;const pe=this._createProxiedId(Q,he,b[Q.key]&&b[Q.key][h.id]),de=this.proxyToSource[Q.key][h.id];de?de.push(pe):this.proxyToSource[Q.key][h.id]=[pe],T.push(pe)}}}_createProxiedId(h,g,b){let T=this.orthoMatrix;if(b){const C=b.find(O=>O.key===g.tileID.key);if(C)return C}if(g.tileID.key!==h.key){const C=h.canonical.z-g.tileID.canonical.z;let O,R,F;T=o.create();const Z=g.tileID.wrap-h.wrap<<h.overscaledZ;C>0?(O=o.EXTENT>>C,R=O*((g.tileID.canonical.x<<C)-h.canonical.x+Z),F=O*((g.tileID.canonical.y<<C)-h.canonical.y)):(O=o.EXTENT<<-C,R=o.EXTENT*(g.tileID.canonical.x-(h.canonical.x+Z<<-C)),F=o.EXTENT*(g.tileID.canonical.y-(h.canonical.y<<-C))),o.ortho(T,0,O,0,O,0,1),o.translate(T,T,[R,F,0])}return new Cg(g.tileID,h.key,T)}_findTileCoveringTileID(h,g){let b=g.getTile(h);if(b&&b.hasData())return b;const T=this._findCoveringTileCache[g.id],C=T[h.key];if(b=C?g.getTileByID(C):null,b&&b.hasData()||C===null)return b;let O=b?b.tileID:h,R=O.overscaledZ;const F=g.getSource().minzoom,Z=[];if(!C){const Q=g.getSource().maxzoom;if(h.canonical.z>=Q){const oe=h.canonical.z-Q;g.getSource().reparseOverscaled?(R=Math.max(h.canonical.z+2,g.transform.tileZoom),O=new o.OverscaledTileID(R,h.wrap,Q,h.canonical.x>>oe,h.canonical.y>>oe)):oe!==0&&(R=Q,O=new o.OverscaledTileID(R,h.wrap,Q,h.canonical.x>>oe,h.canonical.y>>oe))}O.key!==h.key&&(Z.push(O.key),b=g.getTile(O))}const j=Q=>{Z.forEach(oe=>{T[oe]=Q}),Z.length=0};for(R-=1;R>=F&&(!b||!b.hasData());R--){b&&j(b.tileID.key);const Q=O.calculateScaledKey(R);if(b=g.getTileByID(Q),b&&b.hasData())break;const oe=T[Q];if(oe===null)break;oe===void 0?Z.push(Q):b=g.getTileByID(oe)}return j(b?b.tileID.key:null),b&&b.hasData()?b:null}findDEMTileFor(h){return this.enabled?this._findTileCoveringTileID(h,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(h,g){let b=this._tilesDirty[h];b||(b=this._tilesDirty[h]={}),b[g.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const h=function(g){let b=0;const T=new o.StructArrayLayout2ui4,C=131;for(let O=1;O<129;O++){for(let R=1;R<129;R++)b=O*C+R,T.emplaceBack(b,b+1),T.emplaceBack(b,b+C),T.emplaceBack(b+1,b+C),O===128&&T.emplaceBack(b+C,b+C+1);T.emplaceBack(b+1,b+1+C)}return T}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(h),this.wireframeSegments=o.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,h.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class mr{static cacheKey(h,g,b,T){let C=`${g}${T?T.cacheKey:""}`;for(const O of b)h.usedDefines.includes(O)&&(C+=`/${O}`);return C}constructor(h,g,b,T,C,O){const R=h.gl;this.program=R.createProgram();const F=function(ee){const ce=[];for(let _e=0;_e<ee.length;_e++){if(ee[_e]===null)continue;const xe=ee[_e].split(" ");ce.push(xe.pop())}return ce}(b.staticAttributes),Z=T?T.getBinderAttributes():[],j=F.concat(Z);let Q=T?T.defines():[];Q=Q.concat(O.map(ee=>`#define ${ee}`));const oe=h.isWebGL2?`#version 300 es
`:"",he=oe+Q.concat(h.extStandardDerivatives&&oe.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(iv):iv,iv,Eg,m1.fragmentSource,yf.fragmentSource,b.fragmentSource).join(`
`),pe=oe+Q.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Eg,m1.vertexSource,yf.vertexSource,wg.vertexSource,b.vertexSource).join(`
`),de=R.createShader(R.FRAGMENT_SHADER);if(R.isContextLost())return void(this.failedToCreate=!0);R.shaderSource(de,he),R.compileShader(de),R.attachShader(this.program,de);const ge=R.createShader(R.VERTEX_SHADER);if(R.isContextLost())this.failedToCreate=!0;else{R.shaderSource(ge,pe),R.compileShader(ge),R.attachShader(this.program,ge),this.attributes={},this.numAttributes=j.length;for(let ee=0;ee<this.numAttributes;ee++)j[ee]&&(R.bindAttribLocation(this.program,ee,j[ee]),this.attributes[j[ee]]=ee);R.linkProgram(this.program),R.deleteShader(ge),R.deleteShader(de),this.fixedUniforms=C(h),this.binderUniforms=T?T.getUniforms(h):[],O.includes("TERRAIN")&&(this.terrainUniforms=(ee=>({u_dem:new o.Uniform1i(ee),u_dem_prev:new o.Uniform1i(ee),u_dem_unpack:new o.Uniform4f(ee),u_dem_tl:new o.Uniform2f(ee),u_dem_scale:new o.Uniform1f(ee),u_dem_tl_prev:new o.Uniform2f(ee),u_dem_scale_prev:new o.Uniform1f(ee),u_dem_size:new o.Uniform1f(ee),u_dem_lerp:new o.Uniform1f(ee),u_exaggeration:new o.Uniform1f(ee),u_depth:new o.Uniform1i(ee),u_depth_size_inv:new o.Uniform2f(ee),u_meter_to_dem:new o.Uniform1f(ee),u_label_plane_matrix_inv:new o.UniformMatrix4f(ee)}))(h)),O.includes("GLOBE")&&(this.globeUniforms=(ee=>({u_tile_tl_up:new o.Uniform3f(ee),u_tile_tr_up:new o.Uniform3f(ee),u_tile_br_up:new o.Uniform3f(ee),u_tile_bl_up:new o.Uniform3f(ee),u_tile_up_scale:new o.Uniform1f(ee)}))(h)),O.includes("FOG")&&(this.fogUniforms=(ee=>({u_fog_matrix:new o.UniformMatrix4f(ee),u_fog_range:new o.Uniform2f(ee),u_fog_color:new o.Uniform4f(ee),u_fog_horizon_blend:new o.Uniform1f(ee),u_fog_temporal_offset:new o.Uniform1f(ee),u_frustum_tl:new o.Uniform3f(ee),u_frustum_tr:new o.Uniform3f(ee),u_frustum_br:new o.Uniform3f(ee),u_frustum_bl:new o.Uniform3f(ee),u_globe_pos:new o.Uniform3f(ee),u_globe_radius:new o.Uniform1f(ee),u_globe_transition:new o.Uniform1f(ee),u_is_globe:new o.Uniform1i(ee),u_viewport:new o.Uniform2f(ee)}))(h))}}setTerrainUniformValues(h,g){if(!this.terrainUniforms)return;const b=this.terrainUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const T in g)b[T]&&b[T].set(this.program,T,g[T])}}setGlobeUniformValues(h,g){if(!this.globeUniforms)return;const b=this.globeUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const T in g)b[T]&&b[T].set(this.program,T,g[T])}}setFogUniformValues(h,g){if(!this.fogUniforms)return;const b=this.fogUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const T in g)b[T].set(this.program,T,g[T])}}draw(h,g,b,T,C,O,R,F,Z,j,Q,oe,he,pe,de){const ge=h.gl;if(this.failedToCreate)return;h.program.set(this.program),h.setDepthMode(b),h.setStencilMode(T),h.setColorMode(C),h.setCullFace(O);for(const ce of Object.keys(this.fixedUniforms))this.fixedUniforms[ce].set(this.program,ce,R[ce]);pe&&pe.setUniforms(this.program,h,this.binderUniforms,oe,{zoom:he});const ee={[ge.LINES]:2,[ge.TRIANGLES]:3,[ge.LINE_STRIP]:1}[g];for(const ce of Q.get()){const _e=ce.vaos||(ce.vaos={});(_e[F]||(_e[F]=new gE)).bind(h,this,Z,pe?pe.getPaintVertexBuffers():[],j,ce.vertexOffset,de||[]),ge.drawElements(g,ce.primitiveLength*ee,ge.UNSIGNED_SHORT,ce.primitiveOffset*ee*2)}}}function Bd(v,h){const g=Math.pow(2,h.tileID.overscaledZ),b=h.tileSize*Math.pow(2,v.transform.tileZoom)/g,T=b*(h.tileID.canonical.x+h.tileID.wrap*g),C=b*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_tile_units_to_pixels:1/Ue(h,1,v.transform.tileZoom),u_pixel_coord_upper:[T>>16,C>>16],u_pixel_coord_lower:[65535&T,65535&C]}}const x1=o.create(),fv=(v,h,g,b,T,C,O,R,F,Z,j)=>{const Q=h.style.light,oe=Q.properties.get("position"),he=[oe.x,oe.y,oe.z],pe=o.create$1();Q.properties.get("anchor")==="viewport"&&(o.fromRotation(pe,-h.transform.angle),o.transformMat3(he,he,pe));const de=Q.properties.get("color"),ge=h.transform,ee={u_matrix:v,u_lightpos:he,u_lightintensity:Q.properties.get("intensity"),u_lightcolor:[de.r,de.g,de.b],u_vertical_gradient:+g,u_opacity:b,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:x1,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:T,u_edge_radius:C};return ge.projection.name==="globe"&&(ee.u_tile_id=[O.canonical.x,O.canonical.y,1<<O.canonical.z],ee.u_zoom_transition=F,ee.u_inv_rot_matrix=j,ee.u_merc_center=Z,ee.u_up_dir=ge.projection.upVector(new o.CanonicalTileID(0,0,0),Z[0]*o.EXTENT,Z[1]*o.EXTENT),ee.u_height_lift=R),ee},b1=(v,h,g,b,T,C,O,R,F,Z,j,Q)=>{const oe=fv(v,h,g,b,T,C,O,F,Z,j,Q),he={u_height_factor:-Math.pow(2,O.overscaledZ)/R.tileSize/8};return o.extend(oe,Bd(h,R),he)},yh=v=>({u_matrix:v}),dv=(v,h,g)=>o.extend(yh(v),Bd(h,g)),mE=(v,h)=>({u_matrix:v,u_world:h}),yE=(v,h,g,b)=>o.extend(dv(v,h,g),{u_world:b}),vE=o.create(),pv=(v,h,g,b,T,C)=>{const O=v.transform,R=O.projection.name==="globe";let F;if(C.paint.get("circle-pitch-alignment")==="map")if(R){const j=o.globePixelsToTileUnits(O.zoom,h.canonical)*O._pixelsPerMercatorPixel;F=Float32Array.from([j,0,0,j])}else F=O.calculatePixelsToTileUnitsMatrix(g);else F=new Float32Array([O.pixelsToGLUnits[0],0,0,O.pixelsToGLUnits[1]]);const Z={u_camera_to_center_distance:O.cameraToCenterDistance,u_matrix:v.translatePosMatrix(h.projMatrix,g,C.paint.get("circle-translate"),C.paint.get("circle-translate-anchor")),u_device_pixel_ratio:o.exported.devicePixelRatio,u_extrude_scale:F,u_inv_rot_matrix:vE,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(R){Z.u_inv_rot_matrix=b,Z.u_merc_center=T,Z.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],Z.u_zoom_transition=o.globeToMercatorTransition(O.zoom);const j=T[0]*o.EXTENT,Q=T[1]*o.EXTENT;Z.u_up_dir=O.projection.upVector(new o.CanonicalTileID(0,0,0),j,Q)}return Z},gv=v=>{const h=[];return v.paint.get("circle-pitch-alignment")==="map"&&h.push("PITCH_WITH_MAP"),v.paint.get("circle-pitch-scale")==="map"&&h.push("SCALE_WITH_MAP"),h},mv=(v,h,g,b)=>{const T=o.EXTENT/g.tileSize;return{u_matrix:v,u_camera_to_center_distance:h.getCameraToCenterDistance(b),u_extrude_scale:[h.pixelsToGLUnits[0]/T,h.pixelsToGLUnits[1]/T]}},Pg=(v,h,g=1)=>({u_matrix:v,u_color:h,u_overlay:0,u_overlay_scale:g}),w1=o.create(),E1=(v,h,g,b,T,C,O)=>{const R=v.transform,F=R.projection.name==="globe",Z=F?o.globePixelsToTileUnits(R.zoom,h.canonical)*R._pixelsPerMercatorPixel:Ue(g,1,C),j={u_matrix:h.projMatrix,u_extrude_scale:Z,u_intensity:O,u_inv_rot_matrix:w1,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(F){j.u_inv_rot_matrix=b,j.u_merc_center=T,j.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],j.u_zoom_transition=o.globeToMercatorTransition(R.zoom);const Q=T[0]*o.EXTENT,oe=T[1]*o.EXTENT;j.u_up_dir=R.projection.upVector(new o.CanonicalTileID(0,0,0),Q,oe)}return j},_E=(v,h,g,b,T,C,O)=>{const R=v.transform,F=R.calculatePixelsToTileUnitsMatrix(h);return{u_matrix:yv(v,h,g,b),u_pixels_to_tile_units:F,u_device_pixel_ratio:C,u_units_to_pixels:[1/R.pixelsToGLUnits[0],1/R.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:T,u_texsize:Ud(g)?h.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:bf(h,v.transform),u_alpha_discard_threshold:0,u_trim_offset:O}},zd=(v,h,g,b,T)=>{const C=v.transform;return{u_matrix:yv(v,h,g,b),u_texsize:h.imageAtlasTexture.size,u_pixels_to_tile_units:C.calculatePixelsToTileUnitsMatrix(h),u_device_pixel_ratio:T,u_image:0,u_tile_units_to_pixels:bf(h,C),u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function bf(v,h){return 1/Ue(v,1,h.tileZoom)}function yv(v,h,g,b){return v.translatePosMatrix(b||h.tileID.projMatrix,h,g.paint.get("line-translate"),g.paint.get("line-translate-anchor"))}function Ud(v){const h=v.paint.get("line-dasharray").value;return h.value||h.kind!=="constant"}const vv=(v,h,g,b,T,C)=>{return{u_matrix:v,u_tl_parent:h,u_scale_parent:g,u_fade_t:b.mix,u_opacity:b.opacity*T.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:T.paint.get("raster-brightness-min"),u_brightness_high:T.paint.get("raster-brightness-max"),u_saturation_factor:(R=T.paint.get("raster-saturation"),R>0?1-1/(1.001-R):-R),u_contrast_factor:(O=T.paint.get("raster-contrast"),O>0?1/(1-O):1+O),u_spin_weights:Zl(T.paint.get("raster-hue-rotate")),u_perspective_transform:C};var O,R};function Zl(v){v*=Math.PI/180;const h=Math.sin(v),g=Math.cos(v);return[(2*g+1)/3,(-Math.sqrt(3)*h-g+1)/3,(Math.sqrt(3)*h-g+1)/3]}const Ag=o.create(),_v=(v,h,g,b,T,C,O,R,F,Z,j,Q,oe,he,pe,de)=>{const ge=T.transform,ee={u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:h?h.uSizeT:0,u_size:h?h.uSize:0,u_camera_to_center_distance:ge.cameraToCenterDistance,u_rotate_symbol:+g,u_aspect_ratio:ge.width/ge.height,u_fade_change:T.options.fadeDuration?T.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:O,u_coord_matrix:R,u_is_text:+F,u_pitch_with_map:+b,u_texsize:Z,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ag,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Ag,u_up_vector:[0,-1,0]};return de.name==="globe"&&(ee.u_tile_id=[j.canonical.x,j.canonical.y,1<<j.canonical.z],ee.u_zoom_transition=Q,ee.u_inv_rot_matrix=he,ee.u_merc_center=oe,ee.u_camera_forward=ge._camera.forward(),ee.u_ecef_origin=o.globeECEFOrigin(ge.globeMatrix,j.toUnwrapped()),ee.u_tile_matrix=Float32Array.from(ge.globeMatrix),ee.u_up_vector=pe),ee},Mg=(v,h,g,b,T,C,O,R,F,Z,j,Q,oe,he,pe,de,ge)=>o.extend(_v(v,h,g,b,T,C,O,R,F,Z,Q,oe,he,pe,de,ge),{u_gamma_scale:b?T.transform.cameraToCenterDistance*Math.cos(T.terrain?0:T.transform._pitch):1,u_device_pixel_ratio:o.exported.devicePixelRatio,u_is_halo:+j}),S1=(v,h,g,b,T,C,O,R,F,Z,j,Q,oe,he,pe,de)=>o.extend(Mg(v,h,g,b,T,C,O,R,!0,F,!0,j,Q,oe,he,pe,de),{u_texsize_icon:Z,u_texture_icon:1}),xv=(v,h,g)=>({u_matrix:v,u_opacity:h,u_color:g}),xE=(v,h,g,b,T)=>o.extend(function(C,O,R){const F=O.imageManager.getPattern(C.toString()),{width:Z,height:j}=O.imageManager.getPixelSize(),Q=Math.pow(2,R.tileID.overscaledZ),oe=R.tileSize*Math.pow(2,O.transform.tileZoom)/Q,he=oe*(R.tileID.canonical.x+R.tileID.wrap*Q),pe=oe*R.tileID.canonical.y;return{u_image:0,u_pattern_tl:F.tl,u_pattern_br:F.br,u_texsize:[Z,j],u_pattern_size:F.displaySize,u_tile_units_to_pixels:1/Ue(R,1,O.transform.tileZoom),u_pixel_coord_upper:[he>>16,pe>>16],u_pixel_coord_lower:[65535&he,65535&pe]}}(b,g,T),{u_matrix:v,u_opacity:h}),bv={fillExtrusion:v=>({u_matrix:new o.UniformMatrix4f(v),u_lightpos:new o.Uniform3f(v),u_lightintensity:new o.Uniform1f(v),u_lightcolor:new o.Uniform3f(v),u_vertical_gradient:new o.Uniform1f(v),u_opacity:new o.Uniform1f(v),u_edge_radius:new o.Uniform1f(v),u_ao:new o.Uniform2f(v),u_tile_id:new o.Uniform3f(v),u_zoom_transition:new o.Uniform1f(v),u_inv_rot_matrix:new o.UniformMatrix4f(v),u_merc_center:new o.Uniform2f(v),u_up_dir:new o.Uniform3f(v),u_height_lift:new o.Uniform1f(v)}),fillExtrusionPattern:v=>({u_matrix:new o.UniformMatrix4f(v),u_lightpos:new o.Uniform3f(v),u_lightintensity:new o.Uniform1f(v),u_lightcolor:new o.Uniform3f(v),u_vertical_gradient:new o.Uniform1f(v),u_height_factor:new o.Uniform1f(v),u_edge_radius:new o.Uniform1f(v),u_ao:new o.Uniform2f(v),u_tile_id:new o.Uniform3f(v),u_zoom_transition:new o.Uniform1f(v),u_inv_rot_matrix:new o.UniformMatrix4f(v),u_merc_center:new o.Uniform2f(v),u_up_dir:new o.Uniform3f(v),u_height_lift:new o.Uniform1f(v),u_image:new o.Uniform1i(v),u_texsize:new o.Uniform2f(v),u_pixel_coord_upper:new o.Uniform2f(v),u_pixel_coord_lower:new o.Uniform2f(v),u_tile_units_to_pixels:new o.Uniform1f(v),u_opacity:new o.Uniform1f(v)}),fill:v=>({u_matrix:new o.UniformMatrix4f(v)}),fillPattern:v=>({u_matrix:new o.UniformMatrix4f(v),u_image:new o.Uniform1i(v),u_texsize:new o.Uniform2f(v),u_pixel_coord_upper:new o.Uniform2f(v),u_pixel_coord_lower:new o.Uniform2f(v),u_tile_units_to_pixels:new o.Uniform1f(v)}),fillOutline:v=>({u_matrix:new o.UniformMatrix4f(v),u_world:new o.Uniform2f(v)}),fillOutlinePattern:v=>({u_matrix:new o.UniformMatrix4f(v),u_world:new o.Uniform2f(v),u_image:new o.Uniform1i(v),u_texsize:new o.Uniform2f(v),u_pixel_coord_upper:new o.Uniform2f(v),u_pixel_coord_lower:new o.Uniform2f(v),u_tile_units_to_pixels:new o.Uniform1f(v)}),circle:v=>({u_camera_to_center_distance:new o.Uniform1f(v),u_extrude_scale:new o.UniformMatrix2f(v),u_device_pixel_ratio:new o.Uniform1f(v),u_matrix:new o.UniformMatrix4f(v),u_inv_rot_matrix:new o.UniformMatrix4f(v),u_merc_center:new o.Uniform2f(v),u_tile_id:new o.Uniform3f(v),u_zoom_transition:new o.Uniform1f(v),u_up_dir:new o.Uniform3f(v)}),collisionBox:v=>({u_matrix:new o.UniformMatrix4f(v),u_camera_to_center_distance:new o.Uniform1f(v),u_extrude_scale:new o.Uniform2f(v)}),collisionCircle:v=>({u_matrix:new o.UniformMatrix4f(v),u_inv_matrix:new o.UniformMatrix4f(v),u_camera_to_center_distance:new o.Uniform1f(v),u_viewport_size:new o.Uniform2f(v)}),debug:v=>({u_color:new o.UniformColor(v),u_matrix:new o.UniformMatrix4f(v),u_overlay:new o.Uniform1i(v),u_overlay_scale:new o.Uniform1f(v)}),clippingMask:v=>({u_matrix:new o.UniformMatrix4f(v)}),heatmap:v=>({u_extrude_scale:new o.Uniform1f(v),u_intensity:new o.Uniform1f(v),u_matrix:new o.UniformMatrix4f(v),u_inv_rot_matrix:new o.UniformMatrix4f(v),u_merc_center:new o.Uniform2f(v),u_tile_id:new o.Uniform3f(v),u_zoom_transition:new o.Uniform1f(v),u_up_dir:new o.Uniform3f(v)}),heatmapTexture:v=>({u_image:new o.Uniform1i(v),u_color_ramp:new o.Uniform1i(v),u_opacity:new o.Uniform1f(v)}),hillshade:v=>({u_matrix:new o.UniformMatrix4f(v),u_image:new o.Uniform1i(v),u_latrange:new o.Uniform2f(v),u_light:new o.Uniform2f(v),u_shadow:new o.UniformColor(v),u_highlight:new o.UniformColor(v),u_accent:new o.UniformColor(v)}),hillshadePrepare:v=>({u_matrix:new o.UniformMatrix4f(v),u_image:new o.Uniform1i(v),u_dimension:new o.Uniform2f(v),u_zoom:new o.Uniform1f(v),u_unpack:new o.Uniform4f(v)}),line:v=>({u_matrix:new o.UniformMatrix4f(v),u_pixels_to_tile_units:new o.UniformMatrix2f(v),u_device_pixel_ratio:new o.Uniform1f(v),u_units_to_pixels:new o.Uniform2f(v),u_dash_image:new o.Uniform1i(v),u_gradient_image:new o.Uniform1i(v),u_image_height:new o.Uniform1f(v),u_texsize:new o.Uniform2f(v),u_tile_units_to_pixels:new o.Uniform1f(v),u_alpha_discard_threshold:new o.Uniform1f(v),u_trim_offset:new o.Uniform2f(v)}),linePattern:v=>({u_matrix:new o.UniformMatrix4f(v),u_texsize:new o.Uniform2f(v),u_pixels_to_tile_units:new o.UniformMatrix2f(v),u_device_pixel_ratio:new o.Uniform1f(v),u_image:new o.Uniform1i(v),u_units_to_pixels:new o.Uniform2f(v),u_tile_units_to_pixels:new o.Uniform1f(v),u_alpha_discard_threshold:new o.Uniform1f(v)}),raster:v=>({u_matrix:new o.UniformMatrix4f(v),u_tl_parent:new o.Uniform2f(v),u_scale_parent:new o.Uniform1f(v),u_fade_t:new o.Uniform1f(v),u_opacity:new o.Uniform1f(v),u_image0:new o.Uniform1i(v),u_image1:new o.Uniform1i(v),u_brightness_low:new o.Uniform1f(v),u_brightness_high:new o.Uniform1f(v),u_saturation_factor:new o.Uniform1f(v),u_contrast_factor:new o.Uniform1f(v),u_spin_weights:new o.Uniform3f(v),u_perspective_transform:new o.Uniform2f(v)}),symbolIcon:v=>({u_is_size_zoom_constant:new o.Uniform1i(v),u_is_size_feature_constant:new o.Uniform1i(v),u_size_t:new o.Uniform1f(v),u_size:new o.Uniform1f(v),u_camera_to_center_distance:new o.Uniform1f(v),u_rotate_symbol:new o.Uniform1i(v),u_aspect_ratio:new o.Uniform1f(v),u_fade_change:new o.Uniform1f(v),u_matrix:new o.UniformMatrix4f(v),u_label_plane_matrix:new o.UniformMatrix4f(v),u_coord_matrix:new o.UniformMatrix4f(v),u_is_text:new o.Uniform1i(v),u_pitch_with_map:new o.Uniform1i(v),u_texsize:new o.Uniform2f(v),u_tile_id:new o.Uniform3f(v),u_zoom_transition:new o.Uniform1f(v),u_inv_rot_matrix:new o.UniformMatrix4f(v),u_merc_center:new o.Uniform2f(v),u_camera_forward:new o.Uniform3f(v),u_tile_matrix:new o.UniformMatrix4f(v),u_up_vector:new o.Uniform3f(v),u_ecef_origin:new o.Uniform3f(v),u_texture:new o.Uniform1i(v)}),symbolSDF:v=>({u_is_size_zoom_constant:new o.Uniform1i(v),u_is_size_feature_constant:new o.Uniform1i(v),u_size_t:new o.Uniform1f(v),u_size:new o.Uniform1f(v),u_camera_to_center_distance:new o.Uniform1f(v),u_rotate_symbol:new o.Uniform1i(v),u_aspect_ratio:new o.Uniform1f(v),u_fade_change:new o.Uniform1f(v),u_matrix:new o.UniformMatrix4f(v),u_label_plane_matrix:new o.UniformMatrix4f(v),u_coord_matrix:new o.UniformMatrix4f(v),u_is_text:new o.Uniform1i(v),u_pitch_with_map:new o.Uniform1i(v),u_texsize:new o.Uniform2f(v),u_texture:new o.Uniform1i(v),u_gamma_scale:new o.Uniform1f(v),u_device_pixel_ratio:new o.Uniform1f(v),u_tile_id:new o.Uniform3f(v),u_zoom_transition:new o.Uniform1f(v),u_inv_rot_matrix:new o.UniformMatrix4f(v),u_merc_center:new o.Uniform2f(v),u_camera_forward:new o.Uniform3f(v),u_tile_matrix:new o.UniformMatrix4f(v),u_up_vector:new o.Uniform3f(v),u_ecef_origin:new o.Uniform3f(v),u_is_halo:new o.Uniform1i(v)}),symbolTextAndIcon:v=>({u_is_size_zoom_constant:new o.Uniform1i(v),u_is_size_feature_constant:new o.Uniform1i(v),u_size_t:new o.Uniform1f(v),u_size:new o.Uniform1f(v),u_camera_to_center_distance:new o.Uniform1f(v),u_rotate_symbol:new o.Uniform1i(v),u_aspect_ratio:new o.Uniform1f(v),u_fade_change:new o.Uniform1f(v),u_matrix:new o.UniformMatrix4f(v),u_label_plane_matrix:new o.UniformMatrix4f(v),u_coord_matrix:new o.UniformMatrix4f(v),u_is_text:new o.Uniform1i(v),u_pitch_with_map:new o.Uniform1i(v),u_texsize:new o.Uniform2f(v),u_texsize_icon:new o.Uniform2f(v),u_texture:new o.Uniform1i(v),u_texture_icon:new o.Uniform1i(v),u_gamma_scale:new o.Uniform1f(v),u_device_pixel_ratio:new o.Uniform1f(v),u_is_halo:new o.Uniform1i(v)}),background:v=>({u_matrix:new o.UniformMatrix4f(v),u_opacity:new o.Uniform1f(v),u_color:new o.UniformColor(v)}),backgroundPattern:v=>({u_matrix:new o.UniformMatrix4f(v),u_opacity:new o.Uniform1f(v),u_image:new o.Uniform1i(v),u_pattern_tl:new o.Uniform2f(v),u_pattern_br:new o.Uniform2f(v),u_texsize:new o.Uniform2f(v),u_pattern_size:new o.Uniform2f(v),u_pixel_coord_upper:new o.Uniform2f(v),u_pixel_coord_lower:new o.Uniform2f(v),u_tile_units_to_pixels:new o.Uniform1f(v)}),terrainRaster:lv,terrainDepth:lv,skybox:v=>({u_matrix:new o.UniformMatrix4f(v),u_sun_direction:new o.Uniform3f(v),u_cubemap:new o.Uniform1i(v),u_opacity:new o.Uniform1f(v),u_temporal_offset:new o.Uniform1f(v)}),skyboxGradient:v=>({u_matrix:new o.UniformMatrix4f(v),u_color_ramp:new o.Uniform1i(v),u_center_direction:new o.Uniform3f(v),u_radius:new o.Uniform1f(v),u_opacity:new o.Uniform1f(v),u_temporal_offset:new o.Uniform1f(v)}),skyboxCapture:v=>({u_matrix_3f:new o.UniformMatrix3f(v),u_sun_direction:new o.Uniform3f(v),u_sun_intensity:new o.Uniform1f(v),u_color_tint_r:new o.Uniform4f(v),u_color_tint_m:new o.Uniform4f(v),u_luminance:new o.Uniform1f(v)}),globeRaster:v=>({u_proj_matrix:new o.UniformMatrix4f(v),u_globe_matrix:new o.UniformMatrix4f(v),u_normalize_matrix:new o.UniformMatrix4f(v),u_merc_matrix:new o.UniformMatrix4f(v),u_zoom_transition:new o.Uniform1f(v),u_merc_center:new o.Uniform2f(v),u_image0:new o.Uniform1i(v),u_grid_matrix:new o.UniformMatrix3f(v),u_skirt_height:new o.Uniform1f(v),u_frustum_tl:new o.Uniform3f(v),u_frustum_tr:new o.Uniform3f(v),u_frustum_br:new o.Uniform3f(v),u_frustum_bl:new o.Uniform3f(v),u_globe_pos:new o.Uniform3f(v),u_globe_radius:new o.Uniform1f(v),u_viewport:new o.Uniform2f(v)}),globeAtmosphere:v=>({u_frustum_tl:new o.Uniform3f(v),u_frustum_tr:new o.Uniform3f(v),u_frustum_br:new o.Uniform3f(v),u_frustum_bl:new o.Uniform3f(v),u_horizon:new o.Uniform1f(v),u_transition:new o.Uniform1f(v),u_fadeout_range:new o.Uniform1f(v),u_color:new o.Uniform4f(v),u_high_color:new o.Uniform4f(v),u_space_color:new o.Uniform4f(v),u_star_intensity:new o.Uniform1f(v),u_star_density:new o.Uniform1f(v),u_star_size:new o.Uniform1f(v),u_temporal_offset:new o.Uniform1f(v),u_horizon_angle:new o.Uniform1f(v),u_rotation_matrix:new o.UniformMatrix4f(v)})};let Lg;function Vd(v,h,g,b,T,C,O){const R=v.context,F=R.gl,Z=v.transform,j=v.useProgram("collisionBox"),Q=[];let oe=0,he=0;for(let xe=0;xe<b.length;xe++){const De=b[xe],ke=h.getTile(De),Re=ke.getBucket(g);if(!Re)continue;const Ge=Gs(De,Re,Z);let ze=Ge;T[0]===0&&T[1]===0||(ze=v.translatePosMatrix(Ge,ke,T,C));const Qe=O?Re.textCollisionBox:Re.iconCollisionBox,Et=Re.collisionCircleArray;if(Et.length>0){const Xe=o.create(),gt=ze;o.mul(Xe,Re.placementInvProjMatrix,Z.glCoordMatrix),o.mul(Xe,Xe,Re.placementViewportMatrix),Q.push({circleArray:Et,circleOffset:he,transform:gt,invTransform:Xe,projection:Re.getProjection()}),oe+=Et.length/4,he=oe}Qe&&(v.terrain&&v.terrain.setupElevationDraw(ke,j),j.draw(R,F.LINES,o.DepthMode.disabled,o.StencilMode.disabled,v.colorModeForRenderPass(),o.CullFaceMode.disabled,mv(ze,Z,ke,Re.getProjection()),g.id,Qe.layoutVertexBuffer,Qe.indexBuffer,Qe.segments,null,Z.zoom,null,[Qe.collisionVertexBuffer,Qe.collisionVertexBufferExt]))}if(!O||!Q.length)return;const pe=v.useProgram("collisionCircle"),de=new o.StructArrayLayout2f1f2i16;de.resize(4*oe),de._trim();let ge=0;for(const xe of Q)for(let De=0;De<xe.circleArray.length/4;De++){const ke=4*De,Re=xe.circleArray[ke+0],Ge=xe.circleArray[ke+1],ze=xe.circleArray[ke+2],Qe=xe.circleArray[ke+3];de.emplace(ge++,Re,Ge,ze,Qe,0),de.emplace(ge++,Re,Ge,ze,Qe,1),de.emplace(ge++,Re,Ge,ze,Qe,2),de.emplace(ge++,Re,Ge,ze,Qe,3)}(!Lg||Lg.length<2*oe)&&(Lg=function(xe){const De=2*xe,ke=new o.StructArrayLayout3ui6;ke.resize(De),ke._trim();for(let Re=0;Re<De;Re++){const Ge=6*Re;ke.uint16[Ge+0]=4*Re+0,ke.uint16[Ge+1]=4*Re+1,ke.uint16[Ge+2]=4*Re+2,ke.uint16[Ge+3]=4*Re+2,ke.uint16[Ge+4]=4*Re+3,ke.uint16[Ge+5]=4*Re+0}return ke}(oe));const ee=R.createIndexBuffer(Lg,!0),ce=R.createVertexBuffer(de,o.collisionCircleLayout.members,!0);for(const xe of Q){const De={u_matrix:xe.transform,u_inv_matrix:xe.invTransform,u_camera_to_center_distance:(_e=Z).getCameraToCenterDistance(xe.projection),u_viewport_size:[_e.width,_e.height]};pe.draw(R,F.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,v.colorModeForRenderPass(),o.CullFaceMode.disabled,De,g.id,ce,ee,o.SegmentVector.simpleSegment(0,2*xe.circleOffset,xe.circleArray.length,xe.circleArray.length/2),null,Z.zoom)}var _e;ce.destroy(),ee.destroy()}const T1=o.create();function wv({width:v,height:h,anchor:g,textOffset:b,textScale:T},C){const{horizontalAlign:O,verticalAlign:R}=o.getAnchorAlignment(g),F=-(O-.5)*v,Z=-(R-.5)*h,j=o.evaluateVariableOffset(g,b);return new o.Point((F/T+j[0])*C,(Z/T+j[1])*C)}function bE(v,h,g,b,T,C,O,R,F,Z,j){const Q=v.text.placedSymbolArray,oe=v.text.dynamicLayoutVertexArray,he=v.icon.dynamicLayoutVertexArray,pe={},de=v.getProjection(),ge=Ni(R,de,C),ee=C.elevation,ce=de.upVectorScale(R.canonical,C.center.lat,C.worldSize).metersToTile;oe.clear();for(let _e=0;_e<Q.length;_e++){const xe=Q.get(_e),{tileAnchorX:De,tileAnchorY:ke,numGlyphs:Re}=xe,Ge=xe.hidden||!xe.crossTileID||v.allowVerticalPlacement&&!xe.placedOrientation?null:b[xe.crossTileID];if(Ge){let ze=0,Qe=0,Et=0;if(ee){const Pt=ee?ee.getAtTileOffset(R,De,ke):0,[yn,Ln,an]=de.upVector(R.canonical,De,ke);ze=Pt*yn*ce,Qe=Pt*Ln*ce,Et=Pt*an*ce}let[Xe,gt,rt,wt]=Yo(xe.projectedAnchorX+ze,xe.projectedAnchorY+Qe,xe.projectedAnchorZ+Et,g?ge:O);const Ye=h1(C.getCameraToCenterDistance(de),wt);let pt=T.evaluateSizeForFeature(v.textSizeData,Z,xe)*Ye/o.ONE_EM;g&&(pt*=v.tilePixelRatio/F);const It=wv(Ge,pt);g?({x:Xe,y:gt,z:rt}=de.projectTilePoint(De+It.x,ke+It.y,R.canonical),[Xe,gt,rt]=Yo(Xe+ze,gt+Qe,rt+Et,O)):(h&&It._rotate(-C.angle),Xe+=It.x,gt+=It.y,rt=0);const _t=v.allowVerticalPlacement&&xe.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let Pt=0;Pt<Re;Pt++)o.addDynamicAttributes(oe,Xe,gt,rt,_t);j&&xe.associatedIconIndex>=0&&(pe[xe.associatedIconIndex]={x:Xe,y:gt,z:rt,angle:_t})}else gl(Re,oe)}if(j){he.clear();const _e=v.icon.placedSymbolArray;for(let xe=0;xe<_e.length;xe++){const De=_e.get(xe),{numGlyphs:ke}=De,Re=pe[xe];if(De.hidden||!Re)gl(ke,he);else{const{x:Ge,y:ze,z:Qe,angle:Et}=Re;for(let Xe=0;Xe<ke;Xe++)o.addDynamicAttributes(he,Ge,ze,Qe,Et)}}v.icon.dynamicLayoutVertexBuffer.updateData(he)}v.text.dynamicLayoutVertexBuffer.updateData(oe)}function Ev(v,h,g){return g.iconsInText&&h?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function I1(v,h,g,b,T,C,O,R,F,Z,j,Q){const oe=v.context,he=oe.gl,pe=v.transform,de=R==="map",ge=F==="map",ee=de&&g.layout.get("symbol-placement")!=="point",ce=de&&!ge&&!ee,_e=g.layout.get("symbol-sort-key").constantOr(1)!==void 0;let xe=!1;const De=v.depthModeForSublayer(0,o.DepthMode.ReadOnly),ke=[o.mercatorXfromLng(pe.center.lng),o.mercatorYfromLat(pe.center.lat)],Re=g.layout.get("text-variable-anchor"),Ge=pe.projection.name==="globe",ze=[],Qe=[0,-1,0];let Et=Qe;!Ge&&!pe.mercatorFromTransition||de||(Et=function(Xe){const gt=Xe._camera.getWorldToCamera(Xe.worldSize,1),rt=o.multiply([],gt,Xe.globeMatrix);o.invert(rt,rt);const wt=[0,0,0],Ye=[0,1,0,0];return o.transformMat4$1(Ye,Ye,rt),wt[0]=Ye[0],wt[1]=Ye[1],wt[2]=Ye[2],o.normalize(wt,wt),wt}(pe));for(const Xe of b){const gt=h.getTile(Xe),rt=gt.getBucket(g);if(!rt||rt.projection.name==="mercator"&&Ge)continue;const wt=T?rt.text:rt.icon;if(!wt||rt.fullyClipped||!wt.segments.get().length)continue;const Ye=wt.programConfigurations.get(g.id),pt=T||rt.sdfIcons,It=T?rt.textSizeData:rt.iconSizeData,_t=ge||pe.pitch!==0,Pt=o.evaluateSizeForZoom(It,pe.zoom);let yn,Ln,an,En,tr=[0,0],Kn=null;if(T)Ln=gt.glyphAtlasTexture,an=he.LINEAR,yn=gt.glyphAtlasTexture.size,rt.iconsInText&&(tr=gt.imageAtlasTexture.size,Kn=gt.imageAtlasTexture,En=_t||v.options.rotating||v.options.zooming||It.kind==="composite"||It.kind==="camera"?he.LINEAR:he.NEAREST);else{const Wu=g.layout.get("icon-size").constantOr(0)!==1||rt.iconsNeedLinear;Ln=gt.imageAtlasTexture,an=pt||v.options.rotating||v.options.zooming||Wu||_t?he.LINEAR:he.NEAREST,yn=gt.imageAtlasTexture.size}const gn=rt.projection.name==="globe",ni=gn?Et:Qe,ui=gn?o.globeToMercatorTransition(pe.zoom):0,ci=Ni(Xe,rt.getProjection(),pe),hi=pe.calculatePixelsToTileUnitsMatrix(gt),Pa=ct(ci,gt.tileID.canonical,ge,de,pe,rt.getProjection(),hi),Jo=v.terrain&&ge&&ee?o.invert(o.create(),Pa):T1,Zs=xo(ci,gt.tileID.canonical,ge,de,pe,rt.getProjection(),hi),Wl=Re&&rt.hasTextData(),Fi=g.layout.get("icon-text-fit")!=="none"&&Wl&&rt.hasIconData();if(ee){const Wu=pe.elevation,Mc=Wu?Wu.getAtTileOffsetFunc(Xe,pe.center.lat,pe.worldSize,rt.getProjection()):null,wh=Uu(ci,gt.tileID.canonical,ge,de,pe,rt.getProjection(),hi);Hy(rt,ci,v,T,wh,Zs,ge,Z,Mc,Xe)}const fi=ee||T&&Re||Fi,qr=v.translatePosMatrix(ci,gt,C,O),bo=fi?T1:Pa,Wa=v.translatePosMatrix(Zs,gt,C,O,!0),Ai=rt.getProjection().createInversionMatrix(pe,Xe.canonical),as=[];v.terrainRenderModeElevated()&&ge&&as.push("PITCH_WITH_MAP_TERRAIN"),gn&&as.push("PROJECTION_GLOBE_VIEW"),fi&&as.push("PROJECTED_POS_ON_VIEWPORT");const Xg=pt&&g.paint.get(T?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let bh;bh=pt?rt.iconsInText?S1(It.kind,Pt,ce,ge,v,qr,bo,Wa,yn,tr,Xe,ui,ke,Ai,ni,rt.getProjection()):Mg(It.kind,Pt,ce,ge,v,qr,bo,Wa,T,yn,!0,Xe,ui,ke,Ai,ni,rt.getProjection()):_v(It.kind,Pt,ce,ge,v,qr,bo,Wa,T,yn,Xe,ui,ke,Ai,ni,rt.getProjection());const Jd={program:v.useProgram(Ev(pt,T,rt),Ye,as),buffers:wt,uniformValues:bh,atlasTexture:Ln,atlasTextureIcon:Kn,atlasInterpolation:an,atlasInterpolationIcon:En,isSDF:pt,hasHalo:Xg,tile:gt,labelPlaneMatrixInv:Jo};if(_e&&rt.canOverlap){xe=!0;const Wu=wt.segments.get();for(const Mc of Wu)ze.push({segments:new o.SegmentVector([Mc]),sortKey:Mc.sortKey,state:Jd})}else ze.push({segments:wt.segments,sortKey:0,state:Jd})}xe&&ze.sort((Xe,gt)=>Xe.sortKey-gt.sortKey);for(const Xe of ze){const gt=Xe.state;if(v.terrain&&v.terrain.setupElevationDraw(gt.tile,gt.program,{useDepthForOcclusion:!Ge,labelPlaneMatrixInv:gt.labelPlaneMatrixInv}),oe.activeTexture.set(he.TEXTURE0),gt.atlasTexture.bind(gt.atlasInterpolation,he.CLAMP_TO_EDGE),gt.atlasTextureIcon&&(oe.activeTexture.set(he.TEXTURE1),gt.atlasTextureIcon&&gt.atlasTextureIcon.bind(gt.atlasInterpolationIcon,he.CLAMP_TO_EDGE)),gt.isSDF){const rt=gt.uniformValues;gt.hasHalo&&(rt.u_is_halo=1,Gd(gt.buffers,Xe.segments,g,v,gt.program,De,j,Q,rt)),rt.u_is_halo=0}Gd(gt.buffers,Xe.segments,g,v,gt.program,De,j,Q,gt.uniformValues)}}function Gd(v,h,g,b,T,C,O,R,F){const Z=b.context,j=[v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer,v.globeExtVertexBuffer];T.draw(Z,Z.gl.TRIANGLES,C,O,R,o.CullFaceMode.disabled,F,g.id,v.layoutVertexBuffer,v.indexBuffer,h,g.paint,b.transform.zoom,v.programConfigurations.get(g.id),j)}function C1(v,h,g,b,T,C,O){const R=v.context.gl,F=g.paint.get("fill-pattern"),Z=F&&F.constantOr(1);let j,Q,oe,he,pe;O?(Q=Z&&!g.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=R.LINES):(Q=Z?"fillPattern":"fill",j=R.TRIANGLES);for(const de of b){const ge=h.getTile(de);if(Z&&!ge.patternsLoaded())continue;const ee=ge.getBucket(g);if(!ee)continue;v.prepareDrawTile();const ce=ee.programConfigurations.get(g.id),_e=v.useProgram(Q,ce);Z&&(v.context.activeTexture.set(R.TEXTURE0),ge.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),ce.updatePaintBuffers());const xe=F.constantOr(null);if(xe&&ge.imageAtlas){const ke=ge.imageAtlas.patternPositions[xe.toString()];ke&&ce.setConstantPatternPositions(ke)}const De=v.translatePosMatrix(de.projMatrix,ge,g.paint.get("fill-translate"),g.paint.get("fill-translate-anchor"));if(O){he=ee.indexBuffer2,pe=ee.segments2;const ke=v.terrain&&v.terrain.renderingToTexture?v.terrain.drapeBufferSize:[R.drawingBufferWidth,R.drawingBufferHeight];oe=Q==="fillOutlinePattern"&&Z?yE(De,v,ge,ke):mE(De,ke)}else he=ee.indexBuffer,pe=ee.segments,oe=Z?dv(De,v,ge):yh(De);v.prepareDrawProgram(v.context,_e,de.toUnwrapped()),_e.draw(v.context,j,T,v.stencilModeForClipping(de),C,o.CullFaceMode.disabled,oe,g.id,ee.layoutVertexBuffer,he,pe,g.paint,v.transform.zoom,ce)}}function Og(v,h,g,b,T,C,O){const R=v.context,F=R.gl,Z=v.transform,j=g.paint.get("fill-extrusion-pattern"),Q=j.constantOr(1),oe=g.paint.get("fill-extrusion-opacity"),he=[g.paint.get("fill-extrusion-ambient-occlusion-intensity"),g.paint.get("fill-extrusion-ambient-occlusion-radius")],pe=g.layout.get("fill-extrusion-edge-radius"),de=pe>0&&!g.paint.get("fill-extrusion-rounded-roof"),ge=de?0:pe,ee=Z.projection.name==="globe"?o.fillExtrusionHeightLift():0,ce=Z.projection.name==="globe",_e=ce?o.globeToMercatorTransition(Z.zoom):0,xe=[o.mercatorXfromLng(Z.center.lng),o.mercatorYfromLat(Z.center.lat)],De=[];ce&&De.push("PROJECTION_GLOBE_VIEW"),he[0]>0&&De.push("FAUX_AO"),de&&De.push("ZERO_ROOF_RADIUS");for(const ke of b){const Re=h.getTile(ke),Ge=Re.getBucket(g);if(!Ge||Ge.projection.name!==Z.projection.name)continue;const ze=Ge.programConfigurations.get(g.id),Qe=v.useProgram(Q?"fillExtrusionPattern":"fillExtrusion",ze,De);if(v.terrain){const pt=v.terrain;if(v.style.terrainSetForDrapingOnly())pt.setupElevationDraw(Re,Qe,{useMeterToDem:!0});else{if(!Ge.enableTerrain)continue;if(pt.setupElevationDraw(Re,Qe,{useMeterToDem:!0}),P1(R,h,ke,Ge,g,pt),!Ge.centroidVertexBuffer){const It=Qe.attributes.a_centroid_pos;It!==void 0&&F.vertexAttrib2f(It,0,0)}}}Q&&(v.context.activeTexture.set(F.TEXTURE0),Re.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),ze.updatePaintBuffers());const Et=j.constantOr(null);if(Et&&Re.imageAtlas){const pt=Re.imageAtlas.patternPositions[Et.toString()];pt&&ze.setConstantPatternPositions(pt)}const Xe=v.translatePosMatrix(ke.projMatrix,Re,g.paint.get("fill-extrusion-translate"),g.paint.get("fill-extrusion-translate-anchor")),gt=Z.projection.createInversionMatrix(Z,ke.canonical),rt=g.paint.get("fill-extrusion-vertical-gradient"),wt=Q?b1(Xe,v,rt,oe,he,ge,ke,Re,ee,_e,xe,gt):fv(Xe,v,rt,oe,he,ge,ke,ee,_e,xe,gt);v.prepareDrawProgram(R,Qe,ke.toUnwrapped());const Ye=[];v.terrain&&Ye.push(Ge.centroidVertexBuffer),ce&&Ye.push(Ge.layoutVertexExtBuffer),Qe.draw(R,R.gl.TRIANGLES,T,C,O,o.CullFaceMode.backCCW,wt,g.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,g.paint,v.transform.zoom,ze,Ye)}}function P1(v,h,g,b,T,C){const O=[ee=>{let ce=ee.canonical.x-1,_e=ee.wrap;return ce<0&&(ce=(1<<ee.canonical.z)-1,_e--),new o.OverscaledTileID(ee.overscaledZ,_e,ee.canonical.z,ce,ee.canonical.y)},ee=>{let ce=ee.canonical.x+1,_e=ee.wrap;return ce===1<<ee.canonical.z&&(ce=0,_e++),new o.OverscaledTileID(ee.overscaledZ,_e,ee.canonical.z,ce,ee.canonical.y)},ee=>new o.OverscaledTileID(ee.overscaledZ,ee.wrap,ee.canonical.z,ee.canonical.x,(ee.canonical.y===0?1<<ee.canonical.z:ee.canonical.y)-1),ee=>new o.OverscaledTileID(ee.overscaledZ,ee.wrap,ee.canonical.z,ee.canonical.x,ee.canonical.y===(1<<ee.canonical.z)-1?0:ee.canonical.y+1)],R=ee=>{const ce=h.getSource().minzoom,_e=De=>{const ke=h.getTileByID(De);if(ke&&ke.hasData())return ke.getBucket(T)},xe=[0,-1,1];for(const De of xe){if(ee.overscaledZ+De<ce)continue;const ke=_e(ee.calculateScaledKey(ee.overscaledZ+De));if(ke)return ke}},F=[0,0,0],Z=(ee,ce)=>(F[0]=Math.min(ee.min.y,ce.min.y),F[1]=Math.max(ee.max.y,ce.max.y),F[2]=o.EXTENT-ce.min.x>ee.max.x?ce.min.x-o.EXTENT:ee.max.x,F),j=(ee,ce)=>(F[0]=Math.min(ee.min.x,ce.min.x),F[1]=Math.max(ee.max.x,ce.max.x),F[2]=o.EXTENT-ce.min.y>ee.max.y?ce.min.y-o.EXTENT:ee.max.y,F),Q=[(ee,ce)=>Z(ee,ce),(ee,ce)=>Z(ce,ee),(ee,ce)=>j(ee,ce),(ee,ce)=>j(ce,ee)],oe=new o.Point(0,0);let he,pe,de;const ge=(ee,ce,_e,xe,De)=>{const ke=[[xe?_e:ee,xe?ee:_e,0],[xe?_e:ce,xe?ce:_e,0]],Re=De<0?o.EXTENT+De:De,Ge=[xe?Re:(ee+ce)/2,xe?(ee+ce)/2:Re,0];return _e===0&&De<0||_e!==0&&De>0?C.getForTilePoints(de,[Ge],!0,pe):ke.push(Ge),C.getForTilePoints(g,ke,!0,he),Math.max(ke[0][2],ke[1][2],Ge[2])/C.exaggeration()};for(let ee=0;ee<4;ee++){const ce=(ee<2?1:5)-ee,_e=b.borders[ee];if(_e.length===0)continue;const xe=de=O[ee](g),De=R(xe);if(!(De&&De instanceof o.FillExtrusionBucket&&De.enableTerrain)||b.borderDoneWithNeighborZ[ee]===De.canonical.z&&De.borderDoneWithNeighborZ[ce]===b.canonical.z||(pe=C.findDEMTileFor(xe),!pe||!pe.dem))continue;if(!he){const ze=C.findDEMTileFor(g);if(!ze||!ze.dem)return;he=ze}const ke=De.borders[ce];let Re=0;const Ge=De.borderDoneWithNeighborZ[ce]!==b.canonical.z;if(b.canonical.z===De.canonical.z){for(let ze=0;ze<_e.length;ze++){const Qe=b.featuresOnBorder[_e[ze]],Et=Qe.borders[ee];let Xe;for(;Re<ke.length&&(Xe=De.featuresOnBorder[ke[Re]],!(Xe.borders[ce][1]>Et[0]+3));)Ge&&De.encodeCentroid(void 0,Xe,!1),Re++;if(Xe&&Re<ke.length){const gt=Re;let rt=0;for(;!(Xe.borders[ce][0]>Et[1]-3)&&(rt++,++Re!==ke.length);)Xe=De.featuresOnBorder[ke[Re]];if(Xe=De.featuresOnBorder[ke[gt]],Qe.intersectsCount()>1||Xe.intersectsCount()>1||rt!==1){rt!==1&&(Re=gt),b.encodeCentroid(void 0,Qe,!1),Ge&&De.encodeCentroid(void 0,Xe,!1);continue}const wt=Q[ee](Qe,Xe),Ye=ee%2?o.EXTENT-1:0;oe.x=ge(wt[0],Math.min(o.EXTENT-1,wt[1]),Ye,ee<2,wt[2]),oe.y=0,b.encodeCentroid(oe,Qe,!1),Ge&&De.encodeCentroid(oe,Xe,!1)}else b.encodeCentroid(void 0,Qe,!1)}b.borderDoneWithNeighborZ[ee]=De.canonical.z,b.needsCentroidUpdate=!0,Ge&&(De.borderDoneWithNeighborZ[ce]=b.canonical.z,De.needsCentroidUpdate=!0)}else{for(const ze of _e)b.encodeCentroid(void 0,b.featuresOnBorder[ze],!1);if(Ge){for(const ze of ke)De.encodeCentroid(void 0,De.featuresOnBorder[ze],!1);De.borderDoneWithNeighborZ[ce]=b.canonical.z,De.needsCentroidUpdate=!0}b.borderDoneWithNeighborZ[ee]=De.canonical.z,b.needsCentroidUpdate=!0}}(b.needsCentroidUpdate||!b.centroidVertexBuffer&&b.centroidVertexArray.length!==0)&&b.uploadCentroid(v)}const wf=new o.Color(1,0,0,1),wE=new o.Color(0,1,0,1),EE=new o.Color(0,0,1,1),SE=new o.Color(1,0,1,1),TE=new o.Color(0,1,1,1);function IE(v,h,g){const b=v.context,T=v.transform,C=b.gl,O=T.projection.name==="globe",R=O?["PROJECTION_GLOBE_VIEW"]:null;let F=g.projMatrix;if(O&&o.globeToMercatorTransition(T.zoom)>0){const Qe=o.transitionTileAABBinECEF(g.canonical,T),Et=o.globeDenormalizeECEF(Qe);F=o.multiply(new Float32Array(16),T.globeMatrix,Et),o.multiply(F,T.projMatrix,F)}const Z=v.useProgram("debug",null,R),j=h.getTileByID(g.key);v.terrain&&v.terrain.setupElevationDraw(j,Z);const Q=o.DepthMode.disabled,oe=o.StencilMode.disabled,he=v.colorModeForRenderPass(),pe="$debug";b.activeTexture.set(C.TEXTURE0),v.emptyTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),O?j._makeGlobeTileDebugBuffers(v.context,T):j._makeDebugTileBoundsBuffers(v.context,T.projection);const de=j._tileDebugBuffer||v.debugBuffer,ge=j._tileDebugIndexBuffer||v.debugIndexBuffer,ee=j._tileDebugSegments||v.debugSegments;Z.draw(b,C.LINE_STRIP,Q,oe,he,o.CullFaceMode.disabled,Pg(F,o.Color.red),pe,de,ge,ee,null,null,null,[j._globeTileDebugBorderBuffer]);const ce=j.latestRawTileData,_e=Math.floor((ce&&ce.byteLength||0)/1024),xe=h.getTile(g).tileSize,De=512/Math.min(xe,512)*(g.overscaledZ/T.zoom)*.5;let ke=g.canonical.toString();g.overscaledZ!==g.canonical.z&&(ke+=` => ${g.overscaledZ}`),ke+=` ${_e}kb`,function(Qe,Et){Qe.initDebugOverlayCanvas();const Xe=Qe.debugOverlayCanvas,gt=Qe.context.gl,rt=Qe.debugOverlayCanvas.getContext("2d");rt.clearRect(0,0,Xe.width,Xe.height),rt.shadowColor="white",rt.shadowBlur=2,rt.lineWidth=1.5,rt.strokeStyle="white",rt.textBaseline="top",rt.font="bold 36px Open Sans, sans-serif",rt.fillText(Et,5,5),rt.strokeText(Et,5,5),Qe.debugOverlayTexture.update(Xe),Qe.debugOverlayTexture.bind(gt.LINEAR,gt.CLAMP_TO_EDGE)}(v,ke);const Re=j._tileDebugTextBuffer||v.debugBuffer,Ge=j._tileDebugTextIndexBuffer||v.quadTriangleIndexBuffer,ze=j._tileDebugTextSegments||v.debugSegments;Z.draw(b,C.TRIANGLES,Q,oe,o.ColorMode.alphaBlended,o.CullFaceMode.disabled,Pg(F,o.Color.transparent,De),pe,Re,Ge,ze,null,null,null,[j._globeTileDebugTextBuffer])}function A1(v,h,g,b){Ef(v,0,h+g/2,v.transform.width,g,b)}function Dg(v,h,g,b){Ef(v,h-g/2,0,g,v.transform.height,b)}function Ef(v,h,g,b,T,C){const O=v.context,R=O.gl;R.enable(R.SCISSOR_TEST),R.scissor(h*o.exported.devicePixelRatio,g*o.exported.devicePixelRatio,b*o.exported.devicePixelRatio,T*o.exported.devicePixelRatio),O.clear({color:C}),R.disable(R.SCISSOR_TEST)}const M1=o.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:L1}=M1;function Zu(v,h,g,b){v.emplaceBack(h,g,b)}class Rg{constructor(h){this.vertexArray=new o.StructArrayLayout3f12,this.indices=new o.StructArrayLayout3ui6,Zu(this.vertexArray,-1,-1,1),Zu(this.vertexArray,1,-1,1),Zu(this.vertexArray,-1,1,1),Zu(this.vertexArray,1,1,1),Zu(this.vertexArray,-1,-1,-1),Zu(this.vertexArray,1,-1,-1),Zu(this.vertexArray,-1,1,-1),Zu(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=h.createVertexBuffer(this.vertexArray,L1),this.indexBuffer=h.createIndexBuffer(this.indices),this.segment=o.SegmentVector.simpleSegment(0,0,36,12)}}function js(v,h,g,b,T,C){const O=v.gl,R=h.paint.get("sky-atmosphere-color"),F=h.paint.get("sky-atmosphere-halo-color"),Z=h.paint.get("sky-atmosphere-sun-intensity"),j=((Q,oe,he,pe,de)=>({u_matrix_3f:Q,u_sun_direction:oe,u_sun_intensity:he,u_color_tint_r:[pe.r,pe.g,pe.b,pe.a],u_color_tint_m:[de.r,de.g,de.b,de.a],u_luminance:5e-5}))(o.fromMat4(o.create$1(),b),T,Z,R,F);O.framebufferTexture2D(O.FRAMEBUFFER,O.COLOR_ATTACHMENT0,O.TEXTURE_CUBE_MAP_POSITIVE_X+C,h.skyboxTexture,0),g.draw(v,O.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.frontCW,j,"skyboxCapture",h.skyboxGeometry.vertexBuffer,h.skyboxGeometry.indexBuffer,h.skyboxGeometry.segment)}const $d=o.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class O1{constructor(h){const g=new o.StructArrayLayout5f20;g.emplaceBack(-1,1,1,0,0),g.emplaceBack(1,1,1,1,0),g.emplaceBack(1,-1,1,1,1),g.emplaceBack(-1,-1,1,0,1);const b=new o.StructArrayLayout3ui6;b.emplaceBack(0,1,2),b.emplaceBack(2,3,0),this.vertexBuffer=h.createVertexBuffer(g,$d.members),this.indexBuffer=h.createIndexBuffer(b),this.segments=o.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const vh={symbol:function(v,h,g,b,T){if(v.renderPass!=="translucent")return;const C=o.StencilMode.disabled,O=v.colorModeForRenderPass();g.layout.get("text-variable-anchor")&&function(R,F,Z,j,Q,oe,he){const pe=F.transform,de=Q==="map",ge=oe==="map";for(const ee of R){const ce=j.getTile(ee),_e=ce.getBucket(Z);if(!_e||!_e.text||!_e.text.segments.get().length)continue;const xe=o.evaluateSizeForZoom(_e.textSizeData,pe.zoom),De=Ni(ee,_e.getProjection(),pe),ke=pe.calculatePixelsToTileUnitsMatrix(ce),Re=ct(De,ce.tileID.canonical,ge,de,pe,_e.getProjection(),ke),Ge=Z.layout.get("icon-text-fit")!=="none"&&_e.hasIconData();if(xe){const ze=Math.pow(2,pe.zoom-ce.tileID.overscaledZ);bE(_e,de,ge,he,o.symbolSize,pe,Re,ee,ze,xe,Ge)}}}(b,v,g,h,g.layout.get("text-rotation-alignment"),g.layout.get("text-pitch-alignment"),T),g.paint.get("icon-opacity").constantOr(1)!==0&&I1(v,h,g,b,!1,g.paint.get("icon-translate"),g.paint.get("icon-translate-anchor"),g.layout.get("icon-rotation-alignment"),g.layout.get("icon-pitch-alignment"),g.layout.get("icon-keep-upright"),C,O),g.paint.get("text-opacity").constantOr(1)!==0&&I1(v,h,g,b,!0,g.paint.get("text-translate"),g.paint.get("text-translate-anchor"),g.layout.get("text-rotation-alignment"),g.layout.get("text-pitch-alignment"),g.layout.get("text-keep-upright"),C,O),h.map.showCollisionBoxes&&(Vd(v,h,g,b,g.paint.get("text-translate"),g.paint.get("text-translate-anchor"),!0),Vd(v,h,g,b,g.paint.get("icon-translate"),g.paint.get("icon-translate-anchor"),!1))},circle:function(v,h,g,b){if(v.renderPass!=="translucent")return;const T=g.paint.get("circle-opacity"),C=g.paint.get("circle-stroke-width"),O=g.paint.get("circle-stroke-opacity"),R=g.layout.get("circle-sort-key").constantOr(1)!==void 0;if(T.constantOr(1)===0&&(C.constantOr(1)===0||O.constantOr(1)===0))return;const F=v.context,Z=F.gl,j=v.transform,Q=v.depthModeForSublayer(0,o.DepthMode.ReadOnly),oe=o.StencilMode.disabled,he=v.colorModeForRenderPass(),pe=j.projection.name==="globe",de=[o.mercatorXfromLng(j.center.lng),o.mercatorYfromLat(j.center.lat)],ge=[];for(let ce=0;ce<b.length;ce++){const _e=b[ce],xe=h.getTile(_e),De=xe.getBucket(g);if(!De||De.projection.name!==j.projection.name)continue;const ke=De.programConfigurations.get(g.id),Re=gv(g);pe&&Re.push("PROJECTION_GLOBE_VIEW");const Ge=v.useProgram("circle",ke,Re),ze=De.layoutVertexBuffer,Qe=De.globeExtVertexBuffer,Et=De.indexBuffer,Xe=j.projection.createInversionMatrix(j,_e.canonical),gt={programConfiguration:ke,program:Ge,layoutVertexBuffer:ze,globeExtVertexBuffer:Qe,indexBuffer:Et,uniformValues:pv(v,_e,xe,Xe,de,g),tile:xe};if(R){const rt=De.segments.get();for(const wt of rt)ge.push({segments:new o.SegmentVector([wt]),sortKey:wt.sortKey,state:gt})}else ge.push({segments:De.segments,sortKey:0,state:gt})}R&&ge.sort((ce,_e)=>ce.sortKey-_e.sortKey);const ee={useDepthForOcclusion:!pe};for(const ce of ge){const{programConfiguration:_e,program:xe,layoutVertexBuffer:De,globeExtVertexBuffer:ke,indexBuffer:Re,uniformValues:Ge,tile:ze}=ce.state,Qe=ce.segments;v.terrain&&v.terrain.setupElevationDraw(ze,xe,ee),v.prepareDrawProgram(F,xe,ze.tileID.toUnwrapped()),xe.draw(F,Z.TRIANGLES,Q,oe,he,o.CullFaceMode.disabled,Ge,g.id,De,Re,Qe,g.paint,j.zoom,_e,[ke])}},heatmap:function(v,h,g,b){if(g.paint.get("heatmap-opacity")!==0)if(v.renderPass==="offscreen"){const T=v.context,C=T.gl,O=o.StencilMode.disabled,R=new o.ColorMode([C.ONE,C.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(he,pe,de,ge){const ee=he.gl,ce=pe.width*ge,_e=pe.height*ge;he.activeTexture.set(ee.TEXTURE1),he.viewport.set([0,0,ce,_e]);let xe=de.heatmapFbo;if(!xe||xe&&(xe.width!==ce||xe.height!==_e)){xe&&xe.destroy();const De=ee.createTexture();ee.bindTexture(ee.TEXTURE_2D,De),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MAG_FILTER,ee.LINEAR),xe=de.heatmapFbo=he.createFramebuffer(ce,_e,!1),function(ke,Re,Ge,ze,Qe,Et){const Xe=ke.gl;Xe.texImage2D(Xe.TEXTURE_2D,0,ke.isWebGL2&&ke.extRenderToTextureHalfFloat?Xe.RGBA16F:Xe.RGBA,Qe,Et,0,Xe.RGBA,ke.extRenderToTextureHalfFloat?ke.isWebGL2?Xe.HALF_FLOAT:ke.extTextureHalfFloat.HALF_FLOAT_OES:Xe.UNSIGNED_BYTE,null),ze.colorAttachment.set(Ge)}(he,0,De,xe,ce,_e)}else ee.bindTexture(ee.TEXTURE_2D,xe.colorAttachment.get()),he.bindFramebuffer.set(xe.framebuffer)})(T,v,g,v.transform.projection.name==="globe"?.5:.25),T.clear({color:o.Color.transparent});const F=v.transform,Z=F.projection.name==="globe",j=Z?["PROJECTION_GLOBE_VIEW"]:null,Q=Z?o.CullFaceMode.frontCCW:o.CullFaceMode.disabled,oe=[o.mercatorXfromLng(F.center.lng),o.mercatorYfromLat(F.center.lat)];for(let he=0;he<b.length;he++){const pe=b[he];if(h.hasRenderableParent(pe))continue;const de=h.getTile(pe),ge=de.getBucket(g);if(!ge||ge.projection.name!==F.projection.name)continue;const ee=ge.programConfigurations.get(g.id),ce=v.useProgram("heatmap",ee,j),{zoom:_e}=v.transform;v.terrain&&v.terrain.setupElevationDraw(de,ce),v.prepareDrawProgram(T,ce,pe.toUnwrapped());const xe=F.projection.createInversionMatrix(F,pe.canonical);ce.draw(T,C.TRIANGLES,o.DepthMode.disabled,O,R,Q,E1(v,pe,de,xe,oe,_e,g.paint.get("heatmap-intensity")),g.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,g.paint,v.transform.zoom,ee,Z?[ge.globeExtVertexBuffer]:null)}T.viewport.set([0,0,v.width,v.height])}else v.renderPass==="translucent"&&(v.context.setColorMode(v.colorModeForRenderPass()),function(T,C){const O=T.context,R=O.gl,F=C.heatmapFbo;if(!F)return;O.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,F.colorAttachment.get()),O.activeTexture.set(R.TEXTURE1);let Z=C.colorRampTexture;Z||(Z=C.colorRampTexture=new o.Texture(O,C.colorRamp,R.RGBA)),Z.bind(R.LINEAR,R.CLAMP_TO_EDGE),T.useProgram("heatmapTexture").draw(O,R.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,T.colorModeForRenderPass(),o.CullFaceMode.disabled,((j,Q,oe,he)=>({u_image:0,u_color_ramp:1,u_opacity:Q.paint.get("heatmap-opacity")}))(0,C),C.id,T.viewportBuffer,T.quadTriangleIndexBuffer,T.viewportSegments,C.paint,T.transform.zoom)}(v,g))},line:function(v,h,g,b){if(v.renderPass!=="translucent")return;const T=g.paint.get("line-opacity"),C=g.paint.get("line-width");if(T.constantOr(1)===0||C.constantOr(1)===0)return;const O=v.depthModeForSublayer(0,o.DepthMode.ReadOnly),R=v.colorModeForRenderPass(),F=v.terrain&&v.terrain.renderingToTexture?1:o.exported.devicePixelRatio,Z=g.paint.get("line-dasharray"),j=Z.constantOr(1),Q=g.layout.get("line-cap"),oe=g.paint.get("line-pattern"),he=oe.constantOr(1),pe=g.paint.get("line-gradient"),de=he?"linePattern":"line",ge=v.context,ee=ge.gl,ce=(xe=>{const De=[];Ud(xe)&&De.push("RENDER_LINE_DASH"),xe.paint.get("line-gradient")&&De.push("RENDER_LINE_GRADIENT");const ke=xe.paint.get("line-trim-offset");ke[0]===0&&ke[1]===0||De.push("RENDER_LINE_TRIM_OFFSET");const Re=xe.paint.get("line-pattern").constantOr(1),Ge=xe.paint.get("line-opacity").constantOr(1)!==1;return!Re&&Ge&&De.push("RENDER_LINE_ALPHA_DISCARD"),De})(g);let _e=ce.includes("RENDER_LINE_ALPHA_DISCARD");v.terrain&&v.terrain.clipOrMaskOverlapStencilType()&&(_e=!1);for(const xe of b){const De=h.getTile(xe);if(he&&!De.patternsLoaded())continue;const ke=De.getBucket(g);if(!ke)continue;v.prepareDrawTile();const Re=ke.programConfigurations.get(g.id),Ge=v.useProgram(de,Re,ce),ze=oe.constantOr(null);if(ze&&De.imageAtlas){const pt=De.imageAtlas.patternPositions[ze.toString()];pt&&Re.setConstantPatternPositions(pt)}const Qe=Z.constantOr(null),Et=Q.constantOr(null);if(!he&&Qe&&Et&&De.lineAtlas){const pt=De.lineAtlas.getDash(Qe,Et);pt&&Re.setConstantPatternPositions(pt)}let[Xe,gt]=g.paint.get("line-trim-offset");(Et==="round"||Et==="square")&&Xe!==gt&&(Xe===0&&(Xe-=1),gt===1&&(gt+=1));const rt=v.terrain?xe.projMatrix:null,wt=he?zd(v,De,g,rt,F):_E(v,De,g,rt,ke.lineClipsArray.length,F,[Xe,gt]);if(pe){const pt=ke.gradients[g.id];let It=pt.texture;if(g.gradientVersion!==pt.version){let _t=256;if(g.stepInterpolant){const Pt=h.getSource().maxzoom,yn=xe.canonical.z===Pt?Math.ceil(1<<v.transform.maxZoom-xe.canonical.z):1;_t=o.clamp(o.nextPowerOfTwo(ke.maxLineLength/o.EXTENT*1024*yn),256,ge.maxTextureSize)}pt.gradient=o.renderColorRamp({expression:g.gradientExpression(),evaluationKey:"lineProgress",resolution:_t,image:pt.gradient||void 0,clips:ke.lineClipsArray}),pt.texture?pt.texture.update(pt.gradient):pt.texture=new o.Texture(ge,pt.gradient,ee.RGBA),pt.version=g.gradientVersion,It=pt.texture}ge.activeTexture.set(ee.TEXTURE1),It.bind(g.stepInterpolant?ee.NEAREST:ee.LINEAR,ee.CLAMP_TO_EDGE)}j&&(ge.activeTexture.set(ee.TEXTURE0),De.lineAtlasTexture.bind(ee.LINEAR,ee.REPEAT),Re.updatePaintBuffers()),he&&(ge.activeTexture.set(ee.TEXTURE0),De.imageAtlasTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),Re.updatePaintBuffers()),v.prepareDrawProgram(ge,Ge,xe.toUnwrapped());const Ye=pt=>{Ge.draw(ge,ee.TRIANGLES,O,pt,R,o.CullFaceMode.disabled,wt,g.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,g.paint,v.transform.zoom,Re,[ke.layoutVertexBuffer2])};if(_e){const pt=v.stencilModeForClipping(xe).ref;pt===0&&v.terrain&&ge.clear({stencil:0});const It={func:ee.EQUAL,mask:255};wt.u_alpha_discard_threshold=.8,Ye(new o.StencilMode(It,pt,255,ee.KEEP,ee.KEEP,ee.INVERT)),wt.u_alpha_discard_threshold=0,Ye(new o.StencilMode(It,pt,255,ee.KEEP,ee.KEEP,ee.KEEP))}else Ye(v.stencilModeForClipping(xe))}_e&&(v.resetStencilClippingMasks(),v.terrain&&ge.clear({stencil:0}))},fill:function(v,h,g,b){const T=g.paint.get("fill-color"),C=g.paint.get("fill-opacity");if(C.constantOr(1)===0)return;const O=v.colorModeForRenderPass(),R=g.paint.get("fill-pattern"),F=v.opaquePassEnabledForLayer()&&!R.constantOr(1)&&T.constantOr(o.Color.transparent).a===1&&C.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===F){const Z=v.depthModeForSublayer(1,v.renderPass==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly);C1(v,h,g,b,Z,O,!1)}if(v.renderPass==="translucent"&&g.paint.get("fill-antialias")){const Z=v.depthModeForSublayer(g.getPaintProperty("fill-outline-color")?2:0,o.DepthMode.ReadOnly);C1(v,h,g,b,Z,O,!0)}},"fill-extrusion":function(v,h,g,b){const T=g.paint.get("fill-extrusion-opacity");if(T!==0&&v.renderPass==="translucent"){const C=new o.DepthMode(v.context.gl.LEQUAL,o.DepthMode.ReadWrite,v.depthRangeFor3D);if(T!==1||g.paint.get("fill-extrusion-pattern").constantOr(1))Og(v,h,g,b,C,o.StencilMode.disabled,o.ColorMode.disabled),Og(v,h,g,b,C,v.stencilModeFor3D(),v.colorModeForRenderPass()),v.resetStencilClippingMasks();else{const O=v.colorModeForRenderPass();Og(v,h,g,b,C,o.StencilMode.disabled,O)}}},hillshade:function(v,h,g,b){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const T=v.context,C=v.depthModeForSublayer(0,o.DepthMode.ReadOnly),O=v.colorModeForRenderPass(),R=v.terrain&&v.terrain.renderingToTexture,[F,Z]=v.renderPass!=="translucent"||R?[{},b]:v.stencilConfigForOverlap(b);for(const j of Z){const Q=h.getTile(j);if(Q.needsHillshadePrepare&&v.renderPass==="offscreen")v1(v,Q,g,C,o.StencilMode.disabled,O);else if(v.renderPass==="translucent"){const oe=R&&v.terrain?v.terrain.stencilModeForRTTOverlap(j):F[j.overscaledZ];y1(v,j,Q,g,C,oe,O)}}T.viewport.set([0,0,v.width,v.height]),v.resetStencilClippingMasks()},raster:function(v,h,g,b,T,C){if(v.renderPass!=="translucent"||g.paint.get("raster-opacity")===0||!b.length)return;const O=v.context,R=O.gl,F=h.getSource(),Z=v.useProgram("raster"),j=v.colorModeForRenderPass(),Q=v.terrain&&v.terrain.renderingToTexture,[oe,he]=F instanceof Hn||Q?[{},b]:v.stencilConfigForOverlap(b),pe=he[he.length-1].overscaledZ,de=!v.options.moving;for(const ge of he){const ee=Q?o.DepthMode.disabled:v.depthModeForSublayer(ge.overscaledZ-pe,g.paint.get("raster-opacity")===1?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly,R.LESS),ce=ge.toUnwrapped(),_e=h.getTile(ge);if(Q&&(!_e||!_e.hasData()))continue;const xe=Q?ge.projMatrix:v.transform.calculateProjMatrix(ce,de),De=v.terrain&&Q?v.terrain.stencilModeForRTTOverlap(ge):oe[ge.overscaledZ],ke=C?0:g.paint.get("raster-fade-duration");_e.registerFadeDuration(ke);const Re=h.findLoadedParent(ge,0),Ge=uv(_e,Re,h,v.transform,ke);let ze,Qe;v.terrain&&v.terrain.prepareDrawTile();const Et=g.paint.get("raster-resampling")==="nearest"?R.NEAREST:R.LINEAR;O.activeTexture.set(R.TEXTURE0),_e.texture.bind(Et,R.CLAMP_TO_EDGE),O.activeTexture.set(R.TEXTURE1),Re?(Re.texture.bind(Et,R.CLAMP_TO_EDGE),ze=Math.pow(2,Re.tileID.overscaledZ-_e.tileID.overscaledZ),Qe=[_e.tileID.canonical.x*ze%1,_e.tileID.canonical.y*ze%1]):_e.texture.bind(Et,R.CLAMP_TO_EDGE),_e.texture.useMipmap&&O.extTextureFilterAnisotropic&&v.transform.pitch>20&&R.texParameterf(R.TEXTURE_2D,O.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,O.extTextureFilterAnisotropicMax);const Xe=vv(xe,Qe||[0,0],ze||1,Ge,g,F instanceof Hn?F.perspectiveTransform:[0,0]);if(v.prepareDrawProgram(O,Z,ce),F instanceof Hn)F.boundsBuffer&&F.boundsSegments&&Z.draw(O,R.TRIANGLES,ee,o.StencilMode.disabled,j,o.CullFaceMode.disabled,Xe,g.id,F.boundsBuffer,v.quadTriangleIndexBuffer,F.boundsSegments);else{const{tileBoundsBuffer:gt,tileBoundsIndexBuffer:rt,tileBoundsSegments:wt}=v.getTileBoundsBuffers(_e);Z.draw(O,R.TRIANGLES,ee,De,j,o.CullFaceMode.disabled,Xe,g.id,gt,rt,wt)}}v.resetStencilClippingMasks()},background:function(v,h,g,b){const T=g.paint.get("background-color"),C=g.paint.get("background-opacity");if(C===0)return;const O=v.context,R=O.gl,F=v.transform,Z=F.tileSize,j=g.paint.get("background-pattern");if(v.isPatternMissing(j))return;const Q=!j&&T.a===1&&C===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==Q)return;const oe=o.StencilMode.disabled,he=v.depthModeForSublayer(0,Q==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly),pe=v.colorModeForRenderPass(),de=v.useProgram(j?"backgroundPattern":"background");let ge,ee=b;ee||(ge=v.getBackgroundTiles(),ee=Object.values(ge).map(ce=>ce.tileID)),j&&(O.activeTexture.set(R.TEXTURE0),v.imageManager.bind(v.context));for(const ce of ee){const _e=ce.toUnwrapped(),xe=b?ce.projMatrix:v.transform.calculateProjMatrix(_e);v.prepareDrawTile();const De=h?h.getTile(ce):ge?ge[ce.key]:new o.Tile(ce,Z,F.zoom,v),ke=j?xE(xe,C,v,j,{tileID:ce,tileSize:Z}):xv(xe,C,T);v.prepareDrawProgram(O,de,_e);const{tileBoundsBuffer:Re,tileBoundsIndexBuffer:Ge,tileBoundsSegments:ze}=v.getTileBoundsBuffers(De);de.draw(O,R.TRIANGLES,he,oe,pe,o.CullFaceMode.disabled,ke,g.id,Re,Ge,ze)}},sky:function(v,h,g){const b=v.transform,T=b.projection.name==="mercator"||b.projection.name==="globe"?1:o.smoothstep(7,8,b.zoom),C=g.paint.get("sky-opacity")*T;if(C===0)return;const O=v.context,R=g.paint.get("sky-type"),F=new o.DepthMode(O.gl.LEQUAL,o.DepthMode.ReadOnly,[0,1]),Z=v.frameCounter/1e3%1;R==="atmosphere"?v.renderPass==="offscreen"?g.needsSkyboxCapture(v)&&(function(j,Q,oe,he){const pe=j.context,de=pe.gl;let ge=Q.skyboxFbo;if(!ge){ge=Q.skyboxFbo=pe.createFramebuffer(32,32,!1),Q.skyboxGeometry=new Rg(pe),Q.skyboxTexture=pe.gl.createTexture(),de.bindTexture(de.TEXTURE_CUBE_MAP,Q.skyboxTexture),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_S,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_T,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MIN_FILTER,de.LINEAR),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MAG_FILTER,de.LINEAR);for(let xe=0;xe<6;++xe)de.texImage2D(de.TEXTURE_CUBE_MAP_POSITIVE_X+xe,0,de.RGBA,32,32,0,de.RGBA,de.UNSIGNED_BYTE,null)}pe.bindFramebuffer.set(ge.framebuffer),pe.viewport.set([0,0,32,32]);const ee=Q.getCenter(j,!0),ce=j.useProgram("skyboxCapture"),_e=new Float64Array(16);o.identity(_e),o.rotateY(_e,_e,.5*-Math.PI),js(pe,Q,ce,_e,ee,0),o.identity(_e),o.rotateY(_e,_e,.5*Math.PI),js(pe,Q,ce,_e,ee,1),o.identity(_e),o.rotateX(_e,_e,.5*-Math.PI),js(pe,Q,ce,_e,ee,2),o.identity(_e),o.rotateX(_e,_e,.5*Math.PI),js(pe,Q,ce,_e,ee,3),o.identity(_e),js(pe,Q,ce,_e,ee,4),o.identity(_e),o.rotateY(_e,_e,Math.PI),js(pe,Q,ce,_e,ee,5),pe.viewport.set([0,0,j.width,j.height])}(v,g),g.markSkyboxValid(v)):v.renderPass==="sky"&&function(j,Q,oe,he,pe){const de=j.context,ge=de.gl,ee=j.transform,ce=j.useProgram("skybox");de.activeTexture.set(ge.TEXTURE0),ge.bindTexture(ge.TEXTURE_CUBE_MAP,Q.skyboxTexture);const _e=((xe,De,ke,Re,Ge)=>({u_matrix:xe,u_sun_direction:De,u_cubemap:0,u_opacity:Re,u_temporal_offset:Ge}))(ee.skyboxMatrix,Q.getCenter(j,!1),0,he,pe);j.prepareDrawProgram(de,ce),ce.draw(de,ge.TRIANGLES,oe,o.StencilMode.disabled,j.colorModeForRenderPass(),o.CullFaceMode.backCW,_e,"skybox",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(v,g,F,C,Z):R==="gradient"&&v.renderPass==="sky"&&function(j,Q,oe,he,pe){const de=j.context,ge=de.gl,ee=j.transform,ce=j.useProgram("skyboxGradient");Q.skyboxGeometry||(Q.skyboxGeometry=new Rg(de)),de.activeTexture.set(ge.TEXTURE0);let _e=Q.colorRampTexture;_e||(_e=Q.colorRampTexture=new o.Texture(de,Q.colorRamp,ge.RGBA)),_e.bind(ge.LINEAR,ge.CLAMP_TO_EDGE);const xe=((De,ke,Re,Ge,ze)=>({u_matrix:De,u_color_ramp:0,u_center_direction:ke,u_radius:o.degToRad(Re),u_opacity:Ge,u_temporal_offset:ze}))(ee.skyboxMatrix,Q.getCenter(j,!1),Q.paint.get("sky-gradient-radius"),he,pe);j.prepareDrawProgram(de,ce),ce.draw(de,ge.TRIANGLES,oe,o.StencilMode.disabled,j.colorModeForRenderPass(),o.CullFaceMode.backCW,xe,"skyboxGradient",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(v,g,F,C,Z)},debug:function(v,h,g){for(let b=0;b<g.length;b++)IE(v,h,g[b])},custom:function(v,h,g,b){const T=v.context,C=g.implementation;if(!v.transform.projection.unsupportedLayers||!v.transform.projection.unsupportedLayers.includes("custom")||v.terrain&&(v.terrain.renderingToTexture||v.renderPass==="offscreen")&&g.isLayerDraped()){if(v.renderPass==="offscreen"){const O=C.prerender;if(O){if(v.setCustomLayerDefaults(),T.setColorMode(v.colorModeForRenderPass()),v.transform.projection.name==="globe"){const R=v.transform.pointMerc;O.call(C,T.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(v.transform.zoom),[R.x,R.y],v.transform.pixelsPerMeterRatio)}else O.call(C,T.gl,v.transform.customLayerMatrix());T.setDirty(),v.setBaseState()}}else if(v.renderPass==="translucent"){if(v.terrain&&v.terrain.renderingToTexture){const R=C.renderToTile;if(R){const F=b[0].canonical,Z=new o.MercatorCoordinate(F.x+b[0].wrap*(1<<F.z),F.y,F.z);T.setDepthMode(o.DepthMode.disabled),T.setStencilMode(o.StencilMode.disabled),T.setColorMode(v.colorModeForRenderPass()),v.setCustomLayerDefaults(),R.call(C,T.gl,Z),T.setDirty(),v.setBaseState()}return}v.setCustomLayerDefaults(),T.setColorMode(v.colorModeForRenderPass()),T.setStencilMode(o.StencilMode.disabled);const O=C.renderingMode==="3d"?new o.DepthMode(v.context.gl.LEQUAL,o.DepthMode.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,o.DepthMode.ReadOnly);if(T.setDepthMode(O),v.transform.projection.name==="globe"){const R=v.transform.pointMerc;C.render(T.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(v.transform.zoom),[R.x,R.y],v.transform.pixelsPerMeterRatio)}else C.render(T.gl,v.transform.customLayerMatrix());T.setDirty(),v.setBaseState(),T.bindFramebuffer.set(null)}}else o.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Sf{constructor(h,g,b=!1){this.context=new Rt(h,b),this.transform=g,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=o.SourceCache.maxUnderzooming+o.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(h,g){const b=!!h&&!!h.terrain&&this.transform.projection.supportsTerrain;if(!(b||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new hv(this,h));const T=this._terrain;this.transform.elevation=b?T:null,T.update(h,this.transform,g)}_updateFog(h){const g=h.fog;if(!g||this.transform.projection.name==="globe"||g.getOpacity(this.transform.pitch)<1||g.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[b,T]=g.getFovAdjustedRange(this.transform._fov);if(b>T)return void(this.transform.fogCullDistSq=null);const C=b+.78*(T-b);this.transform.fogCullDistSq=C*C}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(h,g){if(this.width=h*o.exported.devicePixelRatio,this.height=g*o.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const b of this.style.order)this.style._layers[b].resize()}setup(){const h=this.context,g=new o.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(o.EXTENT,0),g.emplaceBack(0,o.EXTENT),g.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=h.createVertexBuffer(g,o.posAttributes.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const b=new o.StructArrayLayout2i4;b.emplaceBack(0,0),b.emplaceBack(o.EXTENT,0),b.emplaceBack(0,o.EXTENT),b.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=h.createVertexBuffer(b,o.posAttributes.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const T=new o.StructArrayLayout2i4;T.emplaceBack(-1,-1),T.emplaceBack(1,-1),T.emplaceBack(-1,1),T.emplaceBack(1,1),this.viewportBuffer=h.createVertexBuffer(T,o.posAttributes.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const C=new o.StructArrayLayout4i8;C.emplaceBack(0,0,0,0),C.emplaceBack(o.EXTENT,0,o.EXTENT,0),C.emplaceBack(0,o.EXTENT,0,o.EXTENT),C.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.mercatorBoundsBuffer=h.createVertexBuffer(C,o.boundsAttributes.members),this.mercatorBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const O=new o.StructArrayLayout3ui6;O.emplaceBack(0,1,2),O.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=h.createIndexBuffer(O);const R=new o.StructArrayLayout1ui2;for(const Z of[0,1,3,2,0])R.emplaceBack(Z);this.debugIndexBuffer=h.createIndexBuffer(R),this.emptyTexture=new o.Texture(h,new o.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),h.gl.RGBA),this.identityMat=o.create();const F=this.context.gl;this.stencilClearMode=new o.StencilMode({func:F.ALWAYS,mask:0},0,255,F.ZERO,F.ZERO,F.ZERO),this.loadTimeStamps.push(o.window.performance.now()),this.atmosphereBuffer=new O1(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(h){return h._makeTileBoundsBuffers(this.context,this.transform.projection),h._tileBoundsBuffer?{tileBoundsBuffer:h._tileBoundsBuffer,tileBoundsIndexBuffer:h._tileBoundsIndexBuffer,tileBoundsSegments:h._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const h=this.context,g=h.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(h,g.TRIANGLES,o.DepthMode.disabled,this.stencilClearMode,o.ColorMode.disabled,o.CullFaceMode.disabled,Fd(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(h,g,b){if(!g||this.currentStencilSource===g.id||!h.isTileClipped()||!b||b.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let R=!1;for(const F of b)if(this._tileClippingMaskIDs[F.key]===void 0){R=!0;break}if(!R)return}this.currentStencilSource=g.id;const T=this.context,C=T.gl;this.nextStencilID+b.length>256&&this.clearStencil(),T.setColorMode(o.ColorMode.disabled),T.setDepthMode(o.DepthMode.disabled);const O=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const R of b){const F=g.getTile(R),Z=this._tileClippingMaskIDs[R.key]=this.nextStencilID++,{tileBoundsBuffer:j,tileBoundsIndexBuffer:Q,tileBoundsSegments:oe}=this.getTileBoundsBuffers(F);O.draw(T,C.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:C.ALWAYS,mask:0},Z,255,C.KEEP,C.KEEP,C.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,Fd(R.projMatrix),"$clipping",j,Q,oe)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const h=this.nextStencilID++,g=this.context.gl;return new o.StencilMode({func:g.NOTEQUAL,mask:255},h,255,g.KEEP,g.KEEP,g.REPLACE)}stencilModeForClipping(h){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(h);const g=this.context.gl;return new o.StencilMode({func:g.EQUAL,mask:255},this._tileClippingMaskIDs[h.key],0,g.KEEP,g.KEEP,g.REPLACE)}stencilConfigForOverlap(h){const g=this.context.gl,b=h.sort((O,R)=>R.overscaledZ-O.overscaledZ),T=b[b.length-1].overscaledZ,C=b[0].overscaledZ-T+1;if(C>1){this.currentStencilSource=void 0,this.nextStencilID+C>256&&this.clearStencil();const O={};for(let R=0;R<C;R++)O[R+T]=new o.StencilMode({func:g.GEQUAL,mask:255},R+this.nextStencilID,255,g.KEEP,g.KEEP,g.REPLACE);return this.nextStencilID+=C,[O,b]}return[{[T]:o.StencilMode.disabled},b]}colorModeForRenderPass(){const h=this.context.gl;return this._showOverdrawInspector?new o.ColorMode([h.CONSTANT_COLOR,h.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?o.ColorMode.unblended:o.ColorMode.alphaBlended}depthModeForSublayer(h,g,b){if(!this.opaquePassEnabledForLayer())return o.DepthMode.disabled;const T=1-((1+this.currentLayer)*this.numSublayers+h)*this.depthEpsilon;return new o.DepthMode(b||this.context.gl.LEQUAL,g,[T,T])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(h,g){this.style=h,this.options=g,this.imageManager=h.imageManager,this.glyphManager=h.glyphManager,this.symbolFadeChange=h.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const b=this.style.order,T=this.style._sourceCaches;for(const Z in T){const j=T[Z];j.used&&j.prepare(this.context)}const C={},O={},R={};for(const Z in T){const j=T[Z];C[Z]=j.getVisibleCoordinates(),O[Z]=C[Z].slice().reverse(),R[Z]=j.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Z=0;Z<b.length;Z++)if(this.style._layers[b[Z]].is3D()){this.opaquePassCutoff=Z;break}if(this.terrain&&(this.terrain.updateTileBinding(R),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.GlobeSharedBuffers(this.context)),!o.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const Z of b){const j=this.style._layers[Z],Q=h._getLayerSourceCache(j);if(!j.hasOffscreenPass()||j.isHidden(this.transform.zoom))continue;const oe=Q?O[Q.id]:void 0;(j.type==="custom"||j.isSky()||oe&&oe.length)&&this.renderLayer(this,Q,j,oe)}this.depthRangeFor3D=[0,1-(h.order.length+2)*this.numSublayers*this.depthEpsilon];const F=this.terrain;if(F&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&F.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:g.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=g.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=b.length-1;this.currentLayer>=0;this.currentLayer--){const Z=this.style._layers[b[this.currentLayer]],j=h._getLayerSourceCache(Z);if(Z.isSky())continue;const Q=j?O[j.id]:void 0;this._renderTileClippingMasks(Z,j,Q),this.renderLayer(this,j,Z,Q)}if(this.style.fog&&this.transform.projection.supportsFog&&function(Z,j){const Q=Z.context,oe=Q.gl,he=Z.transform,pe=new o.DepthMode(oe.LEQUAL,o.DepthMode.ReadOnly,[0,1]),de=Z.useProgram("globeAtmosphere",null,he.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ge=o.globeToMercatorTransition(he.zoom),ee=j.properties.get("color").toArray01(),ce=j.properties.get("high-color").toArray01(),_e=j.properties.get("space-color").toArray01PremultipliedAlpha(),xe=o.identity$1([]);o.rotateY$1(xe,xe,-o.degToRad(he._center.lng)),o.rotateX$1(xe,xe,o.degToRad(he._center.lat)),o.rotateZ$1(xe,xe,he.angle),o.rotateX$1(xe,xe,-he._pitch);const De=o.fromQuat(new Float32Array(16),xe),ke=o.mapValue(j.properties.get("star-intensity"),0,1,0,.25),Re=5e-4,Ge=o.mapValue(j.properties.get("horizon-blend"),0,1,Re,.25),ze=o.globeUseCustomAntiAliasing(Z,Q,he)&&Ge===Re?he.worldSize/(2*Math.PI*1.025)-1:he.globeRadius,Qe=Z.frameCounter/1e3%1,Et=o.length(he.globeCenterInViewSpace),Xe=Math.sqrt(Math.pow(Et,2)-Math.pow(ze,2)),gt=Math.acos(Xe/Et),rt=((Ye,pt,It,_t,Pt,yn,Ln,an,En,tr,Kn,gn,ni,ui)=>({u_frustum_tl:Ye,u_frustum_tr:pt,u_frustum_br:It,u_frustum_bl:_t,u_horizon:Pt,u_transition:yn,u_fadeout_range:Ln,u_color:an,u_high_color:En,u_space_color:tr,u_star_intensity:Kn,u_star_size:5*o.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:gn,u_horizon_angle:ni,u_rotation_matrix:ui}))(he.frustumCorners.TL,he.frustumCorners.TR,he.frustumCorners.BR,he.frustumCorners.BL,he.frustumCorners.horizon,ge,Ge,ee,ce,_e,ke,Qe,gt,De);Z.prepareDrawProgram(Q,de);const wt=Z.atmosphereBuffer;wt&&de.draw(Q,oe.TRIANGLES,pe,o.StencilMode.disabled,o.ColorMode.alphaBlended,o.CullFaceMode.backCW,rt,"skybox",wt.vertexBuffer,wt.indexBuffer,wt.segments)}(this,this.style.fog),this.renderPass="sky",(o.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<b.length;this.currentLayer++){const Z=this.style._layers[b[this.currentLayer]],j=h._getLayerSourceCache(Z);Z.isSky()&&this.renderLayer(this,j,Z,j?O[j.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<b.length;){const Z=this.style._layers[b[this.currentLayer]],j=h._getLayerSourceCache(Z);if(Z.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(Z)){if(Z.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const Q=j?(Z.type==="symbol"?R:O)[j.id]:void 0;this._renderTileClippingMasks(Z,j,j?C[j.id]:void 0),this.renderLayer(this,j,Z,Q),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Z=null;o.values(this.style._layers).forEach(j=>{const Q=h._getLayerSourceCache(j);Q&&!j.isHidden(this.transform.zoom)&&(!Z||Z.getSource().maxzoom<Q.getSource().maxzoom)&&(Z=Q)}),Z&&this.options.showTileBoundaries&&vh.debug(this,Z,Z.getVisibleCoordinates())}this.options.showPadding&&function(Z){const j=Z.transform.padding;A1(Z,Z.transform.height-(j.top||0),3,wf),A1(Z,j.bottom||0,3,wE),Dg(Z,j.left||0,3,EE),Dg(Z,Z.transform.width-(j.right||0),3,SE);const Q=Z.transform.centerPoint;(function(oe,he,pe,de){Ef(oe,he-1,pe-10,2,20,de),Ef(oe,he-10,pe-1,20,2,de)})(Z,Q.x,Z.transform.height-Q.y,TE)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(o.window.performance.now()),this.saveCanvasCopy())}renderLayer(h,g,b,T){b.isHidden(this.transform.zoom)||(b.type==="background"||b.type==="sky"||b.type==="custom"||T&&T.length)&&(this.id=b.id,this.gpuTimingStart(b),(!h.transform.projection.unsupportedLayers||!h.transform.projection.unsupportedLayers.includes(b.type)||h.terrain&&b.type==="custom")&&vh[b.type](h,g,b,T,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(h){if(!this.options.gpuTiming)return;const g=this.context.extTimerQuery;let b=this.gpuTimers[h.id];b||(b=this.gpuTimers[h.id]={calls:0,cpuTime:0,query:g.createQueryEXT()}),b.calls++,g.beginQueryEXT(g.TIME_ELAPSED_EXT,b.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const h=this.context.extTimerQuery,g=h.createQueryEXT();this.deferredRenderGpuTimeQueries.push(g),h.beginQueryEXT(h.TIME_ELAPSED_EXT,g)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}collectGpuTimers(){const h=this.gpuTimers;return this.gpuTimers={},h}collectDeferredRenderGpuQueries(){const h=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],h}queryGpuTimers(h){const g={};for(const b in h){const T=h[b],C=this.context.extTimerQuery,O=C.getQueryObjectEXT(T.query,C.QUERY_RESULT_EXT)/1e6;C.deleteQueryEXT(T.query),g[b]=O}return g}queryGpuTimeDeferredRender(h){if(!this.options.gpuTimingDeferredRender)return 0;const g=this.context.extTimerQuery;let b=0;for(const T of h)b+=g.getQueryObjectEXT(T,g.QUERY_RESULT_EXT)/1e6,g.deleteQueryEXT(T);return b}translatePosMatrix(h,g,b,T,C){if(!b[0]&&!b[1])return h;const O=C?T==="map"?this.transform.angle:0:T==="viewport"?-this.transform.angle:0;if(O){const Z=Math.sin(O),j=Math.cos(O);b=[b[0]*j-b[1]*Z,b[0]*Z+b[1]*j]}const R=[C?b[0]:Ue(g,b[0],this.transform.zoom),C?b[1]:Ue(g,b[1],this.transform.zoom),0],F=new Float32Array(16);return o.translate(F,h,R),F}saveTileTexture(h){const g=this._tileTextures[h.size[0]];g?g.push(h):this._tileTextures[h.size[0]]=[h]}getTileTexture(h){const g=this._tileTextures[h];return g&&g.length>0?g.pop():null}isPatternMissing(h){return h===null||h!==void 0&&!this.imageManager.getPattern(h.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const h=this.terrain&&this.terrain.renderingToTexture,g=this.terrain&&this.terrain.exaggeration()===0,b=this.style&&this.style.fog,T=[];return this.terrainRenderModeElevated()&&T.push("TERRAIN"),this.transform.projection.name==="globe"&&T.push("GLOBE"),g&&T.push("ZERO_EXAGGERATION"),b&&!h&&b.getOpacity(this.transform.pitch)!==0&&T.push("FOG"),h&&T.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&T.push("OVERDRAW_INSPECTOR"),T}useProgram(h,g,b){this.cache=this.cache||{};const T=b||[],C=this.currentGlobalDefines().concat(T),O=mr.cacheKey(ov[h],h,C,g);return this.cache[O]||(this.cache[O]=new mr(this.context,h,ov[h],g,bv[h],C)),this.cache[O]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const h=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(h.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(h,g,b){if(this.terrain&&this.terrain.renderingToTexture)return;const T=this.style.fog;if(T){const C=T.getOpacity(this.transform.pitch),O=((R,F,Z,j,Q,oe,he,pe,de,ge,ee)=>{const ce=R.transform,_e=F.properties.get("color").toArray01();_e[3]=j;const xe=R.frameCounter/1e3%1;return{u_fog_matrix:Z?ce.calculateFogTileMatrix(Z):R.identityMat,u_fog_range:F.getFovAdjustedRange(ce._fov),u_fog_color:_e,u_fog_horizon_blend:F.properties.get("horizon-blend"),u_fog_temporal_offset:xe,u_frustum_tl:Q,u_frustum_tr:oe,u_frustum_br:he,u_frustum_bl:pe,u_globe_pos:de,u_globe_radius:ge,u_viewport:ee,u_globe_transition:o.globeToMercatorTransition(ce.zoom),u_is_globe:+(ce.projection.name==="globe")}})(this,T,b,C,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.exported.devicePixelRatio,this.transform.height*o.exported.devicePixelRatio]);g.setFogUniformValues(h,O)}}setTileLoadedFlag(h){this.tileLoaded=h}saveCanvasCopy(){const h=this.canvasCopy();h&&(this.frameCopies.push(h),this.tileLoaded=!1)}canvasCopy(){const h=this.context.gl,g=h.createTexture();return h.bindTexture(h.TEXTURE_2D,g),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,0,0,h.drawingBufferWidth,h.drawingBufferHeight,0),g}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const h=this.style&&this.style.fog;return!!h&&h.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const h=this._backgroundTiles,g=this._backgroundTiles={},b=this.transform.coveringTiles({tileSize:512});for(const T of b)g[T.key]=h[T.key]||new o.Tile(T,512,this.transform.tileZoom,this);return g}clearBackgroundTiles(){this._backgroundTiles={}}}class kg{constructor(h=0,g=0,b=0,T=0){if(isNaN(h)||h<0||isNaN(g)||g<0||isNaN(b)||b<0||isNaN(T)||T<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=h,this.bottom=g,this.left=b,this.right=T}interpolate(h,g,b){return g.top!=null&&h.top!=null&&(this.top=o.number(h.top,g.top,b)),g.bottom!=null&&h.bottom!=null&&(this.bottom=o.number(h.bottom,g.bottom,b)),g.left!=null&&h.left!=null&&(this.left=o.number(h.left,g.left,b)),g.right!=null&&h.right!=null&&(this.right=o.number(h.right,g.right,b)),this}getCenter(h,g){const b=o.clamp((this.left+h-this.right)/2,0,h),T=o.clamp((this.top+g-this.bottom)/2,0,g);return new o.Point(b,T)}equals(h){return this.top===h.top&&this.bottom===h.bottom&&this.left===h.left&&this.right===h.right}clone(){return new kg(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ng(v,h){const g=o.getColumn(v,3);o.fromQuat(v,h),o.setColumn(v,3,g)}function Gr(v,h){const g=o.identity$1([]);return o.rotateZ$1(g,g,-h),o.rotateX$1(g,g,-v),g}function jd(v,h){const g=[v[0],v[1],0],b=[h[0],h[1],0];if(o.length(g)>=1e-15){const O=o.normalize([],g);o.scale$2(b,O,o.dot(b,O)),h[0]=b[0],h[1]=b[1]}const T=o.cross([],h,v);if(o.len(T)<1e-15)return null;const C=Math.atan2(-T[1],T[0]);return Gr(Math.atan2(Math.sqrt(v[0]*v[0]+v[1]*v[1]),-v[2]),C)}class D1{constructor(h,g){this.position=h,this.orientation=g}get position(){return this._position}set position(h){if(h){const g=h instanceof o.MercatorCoordinate?h:new o.MercatorCoordinate(h[0],h[1],h[2]);this._renderWorldCopies&&(g.x=o.wrap(g.x,0,1)),this._position=g}else this._position=null}lookAtPoint(h,g){if(this.orientation=null,!this.position)return;const b=this.position,T=this._elevation?this._elevation.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(h)):0,C=o.MercatorCoordinate.fromLngLat(h,T),O=[C.x-b.x,C.y-b.y,C.z-b.z];g||(g=[0,0,1]),g[2]=Math.abs(g[2]),this.orientation=jd(O,g)}setPitchBearing(h,g){this.orientation=Gr(o.degToRad(h),o.degToRad(-g))}}class Fg{constructor(h,g){this._transform=o.identity([]),this.orientation=g,this.position=h}get mercatorPosition(){const h=this.position;return new o.MercatorCoordinate(h[0],h[1],h[2])}get position(){const h=o.getColumn(this._transform,3);return[h[0],h[1],h[2]]}set position(h){var g;h&&o.setColumn(this._transform,3,[(g=h)[0],g[1],g[2],1])}get orientation(){return this._orientation}set orientation(h){this._orientation=h||o.identity$1([]),h&&Ng(this._transform,this._orientation)}getPitchBearing(){const h=this.forward(),g=this.right();return{bearing:Math.atan2(-g[1],g[0]),pitch:Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2])}}setPitchBearing(h,g){this._orientation=Gr(h,g),Ng(this._transform,this._orientation)}forward(){const h=o.getColumn(this._transform,2);return[-h[0],-h[1],-h[2]]}up(){const h=o.getColumn(this._transform,1);return[-h[0],-h[1],-h[2]]}right(){const h=o.getColumn(this._transform,0);return[h[0],h[1],h[2]]}getCameraToWorld(h,g){const b=new Float64Array(16);return o.invert(b,this.getWorldToCamera(h,g)),b}getWorldToCameraPosition(h,g,b){const T=this.position;o.scale$2(T,T,-h);const C=new Float64Array(16);return o.fromScaling(C,[b,b,b]),o.translate(C,C,T),C[10]*=g,C}getWorldToCamera(h,g){const b=new Float64Array(16),T=new Float64Array(4),C=this.position;return o.conjugate(T,this._orientation),o.scale$2(C,C,-h),o.fromQuat(b,T),o.translate(b,b,C),b[1]*=-1,b[5]*=-1,b[9]*=-1,b[13]*=-1,b[8]*=g,b[9]*=g,b[10]*=g,b[11]*=g,b}getCameraToClipPerspective(h,g,b,T){const C=new Float64Array(16);return o.perspective(C,h,g,b,T),C}getDistanceToElevation(h,g=!1){const b=h===0?0:o.mercatorZfromAltitude(h,g?o.latFromMercatorY(this.position[1]):this.position[1]),T=this.forward();return(b-this.position[2])/T[2]}clone(){return new Fg([...this.position],[...this.orientation])}}function Tf(v,h){const g=Bg(v.projection,v.zoom,v.width,v.height),b=function(C,O,R,F,Z){const j=new o.LngLat(R.lng-180*Xu,R.lat),Q=new o.LngLat(R.lng+180*Xu,R.lat),oe=C.project(j.lng,j.lat),he=C.project(Q.lng,Q.lat),pe=-Math.atan2(he.y-oe.y,he.x-oe.x),de=o.MercatorCoordinate.fromLngLat(R);de.y=o.clamp(de.y,-1+Xu,1-Xu);const ge=de.toLngLat(),ee=C.project(ge.lng,ge.lat),ce=o.MercatorCoordinate.fromLngLat(ge);ce.x+=Xu;const _e=ce.toLngLat(),xe=C.project(_e.lng,_e.lat),De=zg(xe.x-ee.x,xe.y-ee.y,pe),ke=o.MercatorCoordinate.fromLngLat(ge);ke.y+=Xu;const Re=ke.toLngLat(),Ge=C.project(Re.lng,Re.lat),ze=zg(Ge.x-ee.x,Ge.y-ee.y,pe),Qe=Math.abs(De.x)/Math.abs(ze.y),Et=o.identity([]);o.rotateZ(Et,Et,-pe*(1-(Z?0:F)));const Xe=o.identity([]);return o.scale(Xe,Xe,[1,1-(1-Qe)*F,1]),Xe[4]=-ze.x/ze.y*F,o.rotateZ(Xe,Xe,pe),o.multiply(Xe,Et,Xe),Xe}(v.projection,0,v.center,g,h),T=R1(v);return o.scale(b,b,[T,T,1]),b}function R1(v){const h=v.projection,g=Bg(v.projection,v.zoom,v.width,v.height),b=k1(h,v.center),T=k1(h,o.LngLat.convert(h.center));return Math.pow(2,b*g+(1-g)*T)}function Bg(v,h,g,b,T=1/0){const C=v.range;if(!C)return 0;const O=Math.min(T,Math.max(g,b)),R=Math.log(O/1024)/Math.LN2;return o.smoothstep(C[0]+R,C[1]+R,h)}const Xu=1/4e4;function k1(v,h){const g=o.clamp(h.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),b=new o.LngLat(h.lng-180*Xu,g),T=new o.LngLat(h.lng+180*Xu,g),C=v.project(b.lng,g),O=v.project(T.lng,g),R=o.MercatorCoordinate.fromLngLat(b),F=o.MercatorCoordinate.fromLngLat(T),Z=O.x-C.x,j=O.y-C.y,Q=F.x-R.x,oe=F.y-R.y,he=Math.sqrt((Q*Q+oe*oe)/(Z*Z+j*j));return Math.log(he)/Math.LN2}function zg(v,h,g){const b=Math.cos(g),T=Math.sin(g);return{x:v*b-h*T,y:v*T+h*b}}class If{constructor(h,g,b,T,C,O,R){this.tileSize=512,this._renderWorldCopies=C===void 0||C,this._minZoom=h||0,this._maxZoom=g||22,this._minPitch=b??0,this._maxPitch=T??60,this.setProjection(O),this.setMaxBounds(R),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new kg,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Fg,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const h=new If(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return h._elevation=this._elevation,h._centerAltitude=this._centerAltitude,h._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,h.tileSize=this.tileSize,h.mercatorFromTransition=this.mercatorFromTransition,h.width=this.width,h.height=this.height,h.cameraElevationReference=this.cameraElevationReference,h._center=this._center,h._setZoom(this.zoom),h._seaLevelZoom=this._seaLevelZoom,h.angle=this.angle,h._fov=this._fov,h._pitch=this._pitch,h._nearZ=this._nearZ,h._farZ=this._farZ,h._averageElevation=this._averageElevation,h._unmodified=this._unmodified,h._edgeInsets=this._edgeInsets.clone(),h._camera=this._camera.clone(),h._calcMatrices(),h.freezeTileCoverage=this.freezeTileCoverage,h.frustumCorners=this.frustumCorners,h}get elevation(){return this._elevation}set elevation(h){this._elevation!==h&&(this._elevation=h,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(h,g=!1){const b=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||b)&&this._updateCameraOnTerrain(),(h||b)&&this._constrainCamera(g),this._calcMatrices()}getProjection(){return o.pick(this.projection,["name","center","parallels"])}setProjection(h){this.projectionOptions=h||{name:"mercator"};const g=this.projection?this.getProjection():void 0;this.projection=o.getProjection(this.projectionOptions);const b=!f(g,this.getProjection());return b&&this._calcMatrices(),this.mercatorFromTransition=!1,b}setMercatorFromTransition(){const h=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.getProjection({name:"mercator"});const g=h!==this.projection.name;return g&&this._calcMatrices(),g}get minZoom(){return this._minZoom}set minZoom(h){this._minZoom!==h&&(this._minZoom=h,this.zoom=Math.max(this.zoom,h))}get maxZoom(){return this._maxZoom}set maxZoom(h){this._maxZoom!==h&&(this._maxZoom=h,this.zoom=Math.min(this.zoom,h))}get minPitch(){return this._minPitch}set minPitch(h){this._minPitch!==h&&(this._minPitch=h,this.pitch=Math.max(this.pitch,h))}get maxPitch(){return this._maxPitch}set maxPitch(h){this._maxPitch!==h&&(this._maxPitch=h,this.pitch=Math.min(this.pitch,h))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(h){h===void 0?h=!0:h===null&&(h=!1),this._renderWorldCopies=h}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get cameraWorldSize(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.Point(this.width,this.height)}get bearing(){return o.wrap(this.rotation,-180,180)}set bearing(h){this.rotation=h}get rotation(){return-this.angle/Math.PI*180}set rotation(h){const g=-h*Math.PI/180;var b;this.angle!==g&&(this._unmodified=!1,this.angle=g,this._calcMatrices(),this.rotationMatrix=(b=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b),function(T,C,O){var R=C[0],F=C[1],Z=C[2],j=C[3],Q=Math.sin(O),oe=Math.cos(O);T[0]=R*oe+Z*Q,T[1]=F*oe+j*Q,T[2]=R*-Q+Z*oe,T[3]=F*-Q+j*oe}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(h){const g=o.clamp(h,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==g&&(this._unmodified=!1,this._pitch=g,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const h=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/h)}set fov(h){h=Math.max(.01,Math.min(60,h)),this._fov!==h&&(this._unmodified=!1,this._fov=o.degToRad(h),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(h){this._averageElevation=h,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(h){const g=Math.min(Math.max(h,this.minZoom),this.maxZoom);this._zoom!==g&&(this._unmodified=!1,this._setZoom(g),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(h){this._zoom=h,this.scale=this.zoomScale(h),this.tileZoom=Math.floor(h),this.zoomFraction=h-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const h=this._elevation;this._centerAltitude=h.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=h.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const h=this._elevation,g=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],b=this.horizonLineFromTop();let T=0,C=0;for(let O=0;O<g.length;O++){const R=new o.Point(g[O][0]*this.width,b+g[O][1]*(this.height-b)),F=h.pointCoordinate(R);if(!F)continue;const Z=1/Math.hypot(F[0]-this._camera.position[0],F[1]-this._camera.position[1]);T+=F[3]*Z,C+=Z}return C===0?NaN:T/C}get center(){return this._center}set center(h){h.lat===this._center.lat&&h.lng===this._center.lng||(this._unmodified=!1,this._center=h,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const h=this._seaLevelZoom,g=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),b=this.pixelsPerMeter/this.worldSize*g,T=this._mercatorZfromZoom(h),C=this._mercatorZfromZoom(this._maxZoom),O=Math.max(T-b,C);this._setZoom(this._zoomFromMercatorZ(O))}get padding(){return this._edgeInsets.toJSON()}set padding(h){this._edgeInsets.equals(h)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,h,1),this._calcMatrices())}computeZoomRelativeTo(h){const g=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,h.toAltitude()));let b;b=h.z<this._camera.position[2]?[g.x,g.y,g.z]:[h.x,h.y,h.z];const T=o.length(o.sub([],this._camera.position,b));return o.clamp(this._zoomFromMercatorZ(T),this._minZoom,this._maxZoom)}setFreeCameraOptions(h){if(!this.height||!h.position&&!h.orientation)return;this._updateCameraState();let g=!1;if(h.orientation&&!o.exactEquals(h.orientation,this._camera.orientation)&&(g=this._setCameraOrientation(h.orientation)),h.position){const b=[h.position.x,h.position.y,h.position.z];o.exactEquals$1(b,this._camera.position)||(this._setCameraPosition(b),g=!0)}g&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const h=this._camera.position,g=new D1;return g.position=new o.MercatorCoordinate(h[0],h[1],h[2]),g.orientation=this._camera.orientation,g._elevation=this.elevation,g._renderWorldCopies=this.renderWorldCopies,g}_setCameraOrientation(h){if(!o.length$1(h))return!1;o.normalize$1(h,h);const g=o.transformQuat([],[0,0,-1],h),b=o.transformQuat([],[0,-1,0],h);if(b[2]<0)return!1;const T=jd(g,b);return!!T&&(this._camera.orientation=T,!0)}_setCameraPosition(h){const g=this.zoomScale(this.minZoom)*this.tileSize,b=this.zoomScale(this.maxZoom)*this.tileSize,T=this.cameraToCenterDistance;h[2]=o.clamp(h[2],T/b,T/g),this._camera.position=h}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(h){return this._edgeInsets.equals(h)}interpolatePadding(h,g,b){this._unmodified=!1,this._edgeInsets.interpolate(h,g,b),this._constrain(),this._calcMatrices()}coveringZoomLevel(h){const g=(h.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/h.tileSize));return Math.max(0,g)}getVisibleUnwrappedCoordinates(h){const g=[new o.UnwrappedTileID(0,h)];if(this.renderWorldCopies){const b=this.pointCoordinate(new o.Point(0,0)),T=this.pointCoordinate(new o.Point(this.width,0)),C=this.pointCoordinate(new o.Point(this.width,this.height)),O=this.pointCoordinate(new o.Point(0,this.height)),R=Math.floor(Math.min(b.x,T.x,C.x,O.x)),F=Math.floor(Math.max(b.x,T.x,C.x,O.x)),Z=1;for(let j=R-Z;j<=F+Z;j++)j!==0&&g.push(new o.UnwrappedTileID(j,h))}return g}coveringTiles(h){let g=this.coveringZoomLevel(h);const b=g,T=this.elevation&&!h.isTerrainDEM,C=this.projection.name==="mercator";if(h.minzoom!==void 0&&g<h.minzoom)return[];h.maxzoom!==void 0&&g>h.maxzoom&&(g=h.maxzoom);const O=this.locationCoordinate(this.center),R=this.center.lat,F=1<<g,Z=[F*O.x,F*O.y,0],j=this.projection.name==="globe",Q=!j,oe=o.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,g,Q),he=j?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),pe=F*o.mercatorZfromAltitude(1,this.center.lat),de=this._camera.position[2]/o.mercatorZfromAltitude(1,this.center.lat),ge=[F*he.x,F*he.y,de*(Q?1:pe)],ee=this.cameraToCenterDistance/h.tileSize*(h.roundZoom?1:.502),ce=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?g:0,_e=h.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,xe=h.isTerrainDEM?-_e:this._elevation?this._elevation.getMinElevationBelowMSL():0,De=this.projection.isReprojectedInTileSpace?R1(this):1,ke=Ye=>{const It=new o.MercatorCoordinate(Ye.x+25e-6,Ye.y,Ye.z),_t=new o.MercatorCoordinate(Ye.x,Ye.y+25e-6,Ye.z),Pt=Ye.toLngLat(),yn=It.toLngLat(),Ln=_t.toLngLat(),an=this.locationCoordinate(Pt),En=this.locationCoordinate(yn),tr=this.locationCoordinate(Ln),Kn=Math.hypot(En.x-an.x,En.y-an.y),gn=Math.hypot(tr.x-an.x,tr.y-an.y);return Math.sqrt(Kn*gn)*De/25e-6},Re=Ye=>{const pt=_e,It=xe;return{aabb:o.tileAABB(this,F,0,0,0,Ye,It,pt,this.projection),zoom:0,x:0,y:0,minZ:It,maxZ:pt,wrap:Ye,fullyVisible:!1}},Ge=[];let ze=[];const Qe=g,Et=h.reparseOverscaled?b:g,Xe=Ye=>Ye*Ye,gt=Xe((de-this._centerAltitude)*pe),rt=Ye=>{if(!this._elevation||!Ye.tileID||!C)return;const pt=this._elevation.getMinMaxForTile(Ye.tileID),It=Ye.aabb;pt?(It.min[2]=pt.min,It.max[2]=pt.max,It.center[2]=(It.min[2]+It.max[2])/2):(Ye.shouldSplit=wt(Ye),Ye.shouldSplit||(It.min[2]=It.max[2]=It.center[2]=this._centerAltitude))},wt=Ye=>{if(Ye.zoom<ce)return!0;if(Ye.zoom===Qe)return!1;if(Ye.shouldSplit!=null)return Ye.shouldSplit;const pt=Ye.aabb.distanceX(ge),It=Ye.aabb.distanceY(ge);let _t=gt,Pt=1;if(j){_t=Xe(Ye.aabb.distanceZ(ge));const an=Math.pow(2,Ye.zoom),En=o.latFromMercatorY((Ye.y+1)/an),tr=o.latFromMercatorY(Ye.y/an),Kn=Math.min(Math.max(R,En),tr),gn=o.circumferenceAtLatitude(Kn)/o.circumferenceAtLatitude(R);if(Pt=Kn===R?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,gn/this._mercatorScaleRatio),this.zoom<=o.GLOBE_ZOOM_THRESHOLD_MIN&&Ye.zoom===Qe-1&&gn>=.9)return!0}else if(T&&(_t=Xe(Ye.aabb.distanceZ(ge)*pe)),this.projection.isReprojectedInTileSpace&&b<=5){const an=Math.pow(2,Ye.zoom),En=ke(new o.MercatorCoordinate((Ye.x+.5)/an,(Ye.y+.5)/an));Pt=En>.85?1:En}const yn=pt*pt+It*It+_t,Ln=Xe((1<<Qe-Ye.zoom)*ee*Pt*((an,En)=>{if(En*Xe(.707)<an)return 1;const tr=Math.sqrt(En/an);return tr/(1.4144271570014144+(Math.pow(1.1,tr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(_t,gt),yn));return yn<Ln};if(this.renderWorldCopies)for(let Ye=1;Ye<=3;Ye++)Ge.push(Re(-Ye)),Ge.push(Re(Ye));for(Ge.push(Re(0));Ge.length>0;){const Ye=Ge.pop(),pt=Ye.x,It=Ye.y;let _t=Ye.fullyVisible;if(!_t){const Pt=Ye.aabb.intersects(oe);if(Pt===0)continue;_t=Pt===2}if(Ye.zoom!==Qe&&wt(Ye))for(let Pt=0;Pt<4;Pt++){const yn=(pt<<1)+Pt%2,Ln=(It<<1)+(Pt>>1),an={aabb:C?Ye.aabb.quadrant(Pt):o.tileAABB(this,F,Ye.zoom+1,yn,Ln,Ye.wrap,Ye.minZ,Ye.maxZ,this.projection),zoom:Ye.zoom+1,x:yn,y:Ln,wrap:Ye.wrap,fullyVisible:_t,tileID:void 0,shouldSplit:void 0,minZ:Ye.minZ,maxZ:Ye.maxZ};T&&!j&&(an.tileID=new o.OverscaledTileID(Ye.zoom+1===Qe?Et:Ye.zoom+1,Ye.wrap,Ye.zoom+1,yn,Ln),rt(an)),Ge.push(an)}else{const Pt=Ye.zoom===Qe?Et:Ye.zoom;if(h.minzoom&&h.minzoom>Pt)continue;const yn=Z[0]-(.5+pt+(Ye.wrap<<Ye.zoom))*(1<<g-Ye.zoom),Ln=Z[1]-.5-It,an=Ye.tileID?Ye.tileID:new o.OverscaledTileID(Pt,Ye.wrap,Ye.zoom,pt,It);ze.push({tileID:an,distanceSq:yn*yn+Ln*Ln})}}if(this.fogCullDistSq){const Ye=this.fogCullDistSq,pt=this.horizonLineFromTop();ze=ze.filter(It=>{const _t=[0,0,0,1],Pt=[o.EXTENT,o.EXTENT,0,1],yn=this.calculateFogTileMatrix(It.tileID.toUnwrapped());o.transformMat4$1(_t,_t,yn),o.transformMat4$1(Pt,Pt,yn);const Ln=o.getAABBPointSquareDist(_t,Pt);if(Ln===0)return!0;let an=!1;const En=this._elevation;if(En&&Ln>Ye&&pt!==0){const tr=this.calculateProjMatrix(It.tileID.toUnwrapped());let Kn;h.isTerrainDEM||(Kn=En.getMinMaxForTile(It.tileID)),Kn||(Kn={min:xe,max:_e});const gn=o.furthestTileCorner(this.rotation),ni=[gn[0]*o.EXTENT,gn[1]*o.EXTENT,Kn.max];o.transformMat4(ni,ni,tr),an=(1-ni[1])*this.height*.5<pt}return Ln<Ye||an})}return ze.sort((Ye,pt)=>Ye.distanceSq-pt.distanceSq).map(Ye=>Ye.tileID)}resize(h,g){this.width=h,this.height=g,this.pixelsToGLUnits=[2/h,-2/g],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(h){return Math.pow(2,h)}scaleZoom(h){return Math.log(h)/Math.LN2}project(h){const g=o.clamp(h.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),b=this.projection.project(h.lng,g);return new o.Point(b.x*this.worldSize,b.y*this.worldSize)}unproject(h){return this.projection.unproject(h.x/this.worldSize,h.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(h,g){let b,T;const C=this.centerPoint;if(this.projection.name==="globe"){const R=this.worldSize;b=(g.x-C.x)/R,T=(g.y-C.y)/R}else{const R=this.pointCoordinate(g),F=this.pointCoordinate(C);b=R.x-F.x,T=R.y-F.y}const O=this.locationCoordinate(h);this.setLocation(new o.MercatorCoordinate(O.x-b,O.y-T))}setLocation(h){this.center=this.coordinateLocation(h),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(h){return this.projection.locationPoint(this,h)}locationPoint3D(h){return this.projection.locationPoint(this,h,!0)}pointLocation(h){return this.coordinateLocation(this.pointCoordinate(h))}pointLocation3D(h){return this.coordinateLocation(this.pointCoordinate3D(h))}locationCoordinate(h,g){const b=g?o.mercatorZfromAltitude(g,h.lat):void 0,T=this.projection.project(h.lng,h.lat);return new o.MercatorCoordinate(T.x,T.y,b)}coordinateLocation(h){return this.projection.unproject(h.x,h.y)}pointRayIntersection(h,g){const b=g??this._centerAltitude,T=[h.x,h.y,0,1],C=[h.x,h.y,1,1];o.transformMat4$1(T,T,this.pixelMatrixInverse),o.transformMat4$1(C,C,this.pixelMatrixInverse);const O=C[3];o.scale$1(T,T,1/T[3]),o.scale$1(C,C,1/O);const R=T[2],F=C[2];return{p0:T,p1:C,t:R===F?0:(b-R)/(F-R)}}screenPointToMercatorRay(h){const g=[h.x,h.y,0,1],b=[h.x,h.y,1,1];return o.transformMat4$1(g,g,this.pixelMatrixInverse),o.transformMat4$1(b,b,this.pixelMatrixInverse),o.scale$1(g,g,1/g[3]),o.scale$1(b,b,1/b[3]),g[2]=o.mercatorZfromAltitude(g[2],this._center.lat)*this.worldSize,b[2]=o.mercatorZfromAltitude(b[2],this._center.lat)*this.worldSize,o.scale$1(g,g,1/this.worldSize),o.scale$1(b,b,1/this.worldSize),new o.Ray([g[0],g[1],g[2]],o.normalize([],o.sub([],b,g)))}rayIntersectionCoordinate(h){const{p0:g,p1:b,t:T}=h,C=o.mercatorZfromAltitude(g[2],this._center.lat),O=o.mercatorZfromAltitude(b[2],this._center.lat);return new o.MercatorCoordinate(o.number(g[0],b[0],T)/this.worldSize,o.number(g[1],b[1],T)/this.worldSize,o.number(C,O,T))}pointCoordinate(h,g=this._centerAltitude){return this.projection.pointCoordinate(this,h.x,h.y,g)}pointCoordinate3D(h){if(!this.elevation)return this.pointCoordinate(h);let g=this.projection.pointCoordinate3D(this,h.x,h.y);if(g)return new o.MercatorCoordinate(g[0],g[1],g[2]);let b=0,T=this.horizonLineFromTop();if(h.y>T)return this.pointCoordinate(h);const C=.02*T,O=h.clone();for(let R=0;R<10&&T-b>C;R++){O.y=o.number(b,T,.66);const F=this.projection.pointCoordinate3D(this,O.x,O.y);F?(T=O.y,g=F):b=O.y}return g?new o.MercatorCoordinate(g[0],g[1],g[2]):this.pointCoordinate(h)}isPointAboveHorizon(h){return this.projection.isPointAboveHorizon(this,h)}isPointOnSurface(h){if(h.y<0||h.y>this.height||h.x<0||h.x>this.width)return!1;if(this.elevation||this.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(h);const g=this.pointCoordinate(h);return g.y>=0&&g.y<=1}_coordinatePoint(h,g){const b=g&&this.elevation?this.elevation.getAtPointOrZero(h,this._centerAltitude):this._centerAltitude,T=[h.x*this.worldSize,h.y*this.worldSize,b+h.toAltitude(),1];return o.transformMat4$1(T,T,this.pixelMatrix),T[3]>0?new o.Point(T[0]/T[3],T[1]/T[3]):new o.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:h,left:g}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,T=this.width-this._edgeInsets.right,C=this.pointLocation3D(new o.Point(g,h)),O=this.pointLocation3D(new o.Point(T,h)),R=this.pointLocation3D(new o.Point(T,b)),F=this.pointLocation3D(new o.Point(g,b));let Z=Math.min(C.lng,O.lng,R.lng,F.lng),j=Math.max(C.lng,O.lng,R.lng,F.lng),Q=Math.min(C.lat,O.lat,R.lat,F.lat),oe=Math.max(C.lat,O.lat,R.lat,F.lat);const he=Math.pow(2,-this.zoom)/16*270,pe=this.projection.name==="globe"?1:4,de=(ge,ee,ce,_e,xe)=>{const De=(ge+ce)/2,ke=(ee+_e)/2,Re=new o.Point(De,ke),{lng:Ge,lat:ze}=this.pointLocation3D(Re),Qe=Math.max(0,Z-Ge,Q-ze,Ge-j,ze-oe);Z=Math.min(Z,Ge),j=Math.max(j,Ge),Q=Math.min(Q,ze),oe=Math.max(oe,ze),(xe<pe||Qe>he)&&(de(ge,ee,De,ke,xe+1),de(De,ke,ce,_e,xe+1))};if(de(g,h,T,h,1),de(T,h,T,b,1),de(T,b,g,b,1),de(g,b,g,h,1),this.projection.name==="globe"){const[ge,ee]=o.polesInViewport(this);ge?(oe=90,j=180,Z=-180):ee&&(Q=-90,j=180,Z=-180)}return new o.LngLatBounds(new o.LngLat(Z,Q),new o.LngLat(j,oe))}_getBoundsRectangular(h,g){const{top:b,left:T}=this._edgeInsets,C=this.height-this._edgeInsets.bottom,O=this.width-this._edgeInsets.right,R=new o.Point(T,b),F=new o.Point(O,b),Z=new o.Point(O,C),j=new o.Point(T,C);let Q=this.pointCoordinate(R,h),oe=this.pointCoordinate(F,h);const he=this.pointCoordinate(Z,g),pe=this.pointCoordinate(j,g),de=(ge,ee)=>(ee.y-ge.y)/(ee.x-ge.x);return Q.y>1&&oe.y>=0?Q=new o.MercatorCoordinate((1-pe.y)/de(pe,Q)+pe.x,1):Q.y<0&&oe.y<=1&&(Q=new o.MercatorCoordinate(-pe.y/de(pe,Q)+pe.x,0)),oe.y>1&&Q.y>=0?oe=new o.MercatorCoordinate((1-he.y)/de(he,oe)+he.x,1):oe.y<0&&Q.y<=1&&(oe=new o.MercatorCoordinate(-he.y/de(he,oe)+he.x,0)),new o.LngLatBounds().extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(oe)).extend(this.coordinateLocation(pe)).extend(this.coordinateLocation(he))}_getBoundsRectangularTerrain(){const h=this.elevation;if(!h.visibleDemTiles.length||h.isUsingMockSource())return this._getBoundsRectangular(0,0);const g=h.visibleDemTiles.reduce((b,T)=>{if(T.dem){const C=T.dem.tree;b.min=Math.min(b.min,C.minimums[0]),b.max=Math.max(b.max,C.maximums[0])}return b},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(g.min*h.exaggeration(),g.max*h.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(h=!0){const g=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,b=this.height/2-g*(1-this._horizonShift);return h?Math.max(0,b):b}getMaxBounds(){return this.maxBounds}setMaxBounds(h){this.maxBounds=h,this.minLat=-o.MAX_MERCATOR_LATITUDE,this.maxLat=o.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,h&&(this.minLat=h.getSouth(),this.maxLat=h.getNorth(),this.minLng=h.getWest(),this.maxLng=h.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=o.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=o.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=o.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(h,g){return this.projection.createTileMatrix(this,g,h)}calculateDistanceTileData(h){const g=h.key,b=this._distanceTileDataCache;if(b[g])return b[g];const T=h.canonical,C=1/this.height,O=this.cameraWorldSize,R=O/this.zoomScale(T.z),F=(T.x+Math.pow(2,T.z)*h.wrap)*R,Z=T.y*R,j=this.point;j.x*=O/this.worldSize,j.y*=O/this.worldSize;const Q=this.angle,oe=Math.sin(-Q),he=-Math.cos(-Q);return b[g]={bearing:[oe,he],center:[(j.x-F)*C,(j.y-Z)*C],scale:R/o.EXTENT*C},b[g]}calculateFogTileMatrix(h){const g=h.key,b=this._fogTileMatrixCache;if(b[g])return b[g];const T=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,h);return o.multiply(T,this.worldToFogMatrix,T),b[g]=new Float32Array(T),b[g]}calculateProjMatrix(h,g=!1){const b=h.key,T=g?this._alignedProjMatrixCache:this._projMatrixCache;if(T[b])return T[b];const C=this.calculatePosMatrix(h,this.worldSize);return o.multiply(C,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:g?this.alignedProjMatrix:this.projMatrix,C),T[b]=new Float32Array(C),T[b]}calculatePixelsToTileUnitsMatrix(h){const g=h.tileID.key,b=this._pixelsToTileUnitsCache;if(b[g])return b[g];const T=function(C,O){const{scale:R}=C.tileTransform,F=R*o.EXTENT/(C.tileSize*Math.pow(2,O.zoom-C.tileID.overscaledZ+C.tileID.canonical.z));return Z=new Float32Array(4),oe=(j=O.inverseAdjustmentMatrix)[1],he=j[2],pe=j[3],ge=(Q=[F,F])[1],Z[0]=j[0]*(de=Q[0]),Z[1]=oe*de,Z[2]=he*ge,Z[3]=pe*ge,Z;var Z,j,Q,oe,he,pe,de,ge}(h,this);return b[g]=T,b[g]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const h=1/this.worldSize,g=o.fromScaling([],[h,h,h]);return o.multiply(g,g,this.globeMatrix),g}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const h=this._elevation;this._updateCameraState();const g=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(g),T=this._camera.forward(),C=o.mercatorZfromAltitude(1,this._center.lat);b[2]/=C,T[2]/=C,o.normalize(T,T);const O=h.raycast(b,T,h.exaggeration());if(O){const R=o.scaleAndAdd([],b,T,O),F=new o.MercatorCoordinate(R[0],R[1],o.mercatorZfromAltitude(R[2],o.latFromMercatorY(R[1]))),Z=(F.z+o.length([F.x-b[0],F.y-b[1],F.z-b[2]*C]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(Z),this._centerAltitude=F.toAltitude(),this._center=this.coordinateLocation(F),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(h=!1){if(!this._elevation)return;const g=this._elevation,b=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,T=this._computeCameraPosition(b),C=g.getAtPointOrZero(new o.MercatorCoordinate(...T)),O=this.pixelsPerMeter/this.worldSize*C,R=this._minimumHeightOverTerrain(),F=T[2]-O;if(F<=R)if(F<0||h){const Z=this.locationCoordinate(this._center,this._centerAltitude),j=[T[0],T[1],Z.z-T[2]],Q=o.length(j);j[2]-=(R-F)/this._pixelsPerMercatorPixel;const oe=o.length(j);if(oe===0)return;o.scale$2(j,j,Q/oe*this._pixelsPerMercatorPixel),this._camera.position=[T[0],T[1],Z.z*this._pixelsPerMercatorPixel-j[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const h=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||h){const oe=this.center;return oe.lat=o.clamp(oe.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!h)&&(oe.lng=o.clamp(oe.lng,this.minLng,this.maxLng)),this.center=oe,void(this._constraining=!1)}const g=this._unmodified,{x:b,y:T}=this.point;let C=0,O=b,R=T;const F=this.width/2,Z=this.height/2,j=this.worldMinY*this.scale,Q=this.worldMaxY*this.scale;if(T-Z<j&&(R=j+Z),T+Z>Q&&(R=Q-Z),Q-j<this.height&&(C=Math.max(C,this.height/(Q-j)),R=(Q+j)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const oe=this.worldMinX*this.scale,he=this.worldMaxX*this.scale,pe=this.worldSize/2-(oe+he)/2;O=(b+pe+this.worldSize)%this.worldSize-pe,O-F<oe&&(O=oe+F),O+F>he&&(O=he-F),he-oe<this.width&&(C=Math.max(C,this.width/(he-oe)),O=(he+oe)/2)}O===b&&R===T||(this.center=this.unproject(new o.Point(O,R))),C&&(this.zoom+=this.scaleZoom(C)),this._constrainCamera(),this._unmodified=g,this._constraining=!1}_minZoomForBounds(){let h=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(h=Math.max(h,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),h}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const h=this.centerOffset,g=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.mercatorZfromAltitude(1,this.center.lat)/o.mercatorZfromAltitude(1,o.GLOBE_SCALE_MATCH_LATITUDE));const b=Bg(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,b),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const T=this.projection.zAxisUnit==="meters"?g:1,C=this._camera.getWorldToCamera(this.worldSize,T),O=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);O[8]=2*-h.x/this.width,O[9]=2*h.y/this.height;let R=o.mul([],O,C);if(this.projection.isReprojectedInTileSpace){const ke=this.locationCoordinate(this.center),Re=o.identity([]);o.translate(Re,Re,[ke.x*this.worldSize,ke.y*this.worldSize,0]),o.multiply(Re,Re,Tf(this)),o.translate(Re,Re,[-ke.x*this.worldSize,-ke.y*this.worldSize,0]),o.multiply(R,R,Re),this.inverseAdjustmentMatrix=function(Ge){const ze=Tf(Ge,!0);return U([],[ze[0],ze[1],ze[4],ze[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=o.scale([],R,[this.worldSize,this.worldSize,this.worldSize/T,1]),this.projMatrix=R,this.invProjMatrix=o.invert(new Float64Array(16),this.projMatrix);const F=o.invert([],O);this.frustumCorners=o.FrustumCorners.fromInvProjectionMatrix(F,this.horizonLineFromTop(),this.height);const Z=new Float32Array(16);o.identity(Z),o.scale(Z,Z,[1,-1,1]),o.rotateX(Z,Z,this._pitch),o.rotateZ(Z,Z,this.angle);const j=o.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),Q=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;j[8]=2*-h.x/this.width,j[9]=2*(h.y+Q)/this.height,this.skyboxMatrix=o.multiply(Z,j,Z);const oe=this.point,he=oe.x,pe=oe.y,de=this.width%2/2,ge=this.height%2/2,ee=Math.cos(this.angle),ce=Math.sin(this.angle),_e=he-Math.round(he)+ee*de+ce*ge,xe=pe-Math.round(pe)+ee*ge+ce*de,De=new Float64Array(R);if(o.translate(De,De,[_e>.5?_e-1:_e,xe>.5?xe-1:xe,0]),this.alignedProjMatrix=De,R=o.create(),o.scale(R,R,[this.width/2,-this.height/2,1]),o.translate(R,R,[1,-1,0]),this.labelPlaneMatrix=R,R=o.create(),o.scale(R,R,[1,-1,1]),o.translate(R,R,[-1,-1,0]),o.scale(R,R,[2/this.width,2/this.height,1]),this.glCoordMatrix=R,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},R=o.invert(new Float64Array(16),this.pixelMatrix),!R)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=R,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.calculateGlobeMatrix(this);const ke=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.transformMat4(ke,ke,C),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=R;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const h=this.cameraWorldSizeForFog,g=this.cameraPixelsPerMeter,b=this._camera.position,T=1/this.height/this._pixelsPerMercatorPixel,C=[h,h,g];o.scale$2(C,C,T),o.scale$2(b,b,-1),o.multiply$2(b,b,C);const O=o.create();o.translate(O,O,b),o.scale(O,O,C),this.mercatorFogMatrix=O,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(h,g,T)}_computeCameraPosition(h){const g=(h=h||this.pixelsPerMeter)/this.pixelsPerMeter,b=this._camera.forward(),T=this.point,C=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*g-h/this.worldSize*this._centerAltitude;return[T.x/this.worldSize-b[0]*C,T.y/this.worldSize-b[1]*C,h/this.worldSize*this._centerAltitude-b[2]*C]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(h){const g=this._maxCameraBoundsDistance()*Math.cos(this._pitch),b=this._camera.position[2],T=h[2];let C=1;this.projection.wrap&&(this.center=this.center.wrap()),T>0&&(C=Math.min((g-b)/T,1)),this._camera.position=o.scaleAndAdd([],this._camera.position,h,C),this._updateStateFromCamera()}_updateStateFromCamera(){const h=this._camera.position,g=this._camera.forward(),{pitch:b,bearing:T}=this._camera.getPitchBearing(),C=o.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,O=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.degToRad(this._maxPitch)),R=Math.max((h[2]-C)/Math.cos(b),O),F=this._zoomFromMercatorZ(R);o.scaleAndAdd(h,h,g,R),this._pitch=o.clamp(b,o.degToRad(this.minPitch),o.degToRad(this.maxPitch)),this.angle=o.wrap(T,-Math.PI,Math.PI),this._setZoom(o.clamp(F,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.MercatorCoordinate(h[0],h[1],h[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(h){return Math.pow(2,h)*this.tileSize}_mercatorZfromZoom(h){return this.cameraToCenterDistance/this._worldSizeFromZoom(h)}_minimumHeightOverTerrain(){const h=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(h)}_zoomFromMercatorZ(h){return this.scaleZoom(this.cameraToCenterDistance/(h*this.tileSize))}zoomFromMercatorZAdjusted(h){let g=0,b=o.GLOBE_ZOOM_THRESHOLD_MAX,T=0,C=1/0;for(;b-g>1e-6&&b>g;){const O=g+.5*(b-g),R=this.tileSize*Math.pow(2,O),F=this.getCameraToCenterDistance(this.projection,O,R),Z=this.scaleZoom(F/(h*this.tileSize)),j=Math.abs(O-Z);j<C&&(C=j,T=O),O<Z?g=O:b=O}return T}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(h,g){const b=Math.min(h.x,g.x),T=Math.max(h.x,g.x),C=Math.min(h.y,g.y),O=Math.max(h.y,g.y);if(C<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const R=[new o.Point(b,C),new o.Point(T,O),new o.Point(b,O),new o.Point(T,C)],F=this.renderWorldCopies?-3:0,Z=this.renderWorldCopies?4:1;for(const j of R){const Q=this.pointRayIntersection(j);if(Q.t<0)return!0;const oe=this.rayIntersectionCoordinate(Q);if(oe.x<F||oe.y<0||oe.x>Z||oe.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.Point(0,0),new o.Point(this.width,this.height))}zoomDeltaToMovement(h,g){const b=o.length(o.sub([],this._camera.position,h)),T=this._zoomFromMercatorZ(b)+g;return b-this._mercatorZfromZoom(T)}getCameraPoint(){if(this.projection.name==="globe"){const h=function([g,b,T],C){const O=[g,b,T,1];o.transformMat4$1(O,O,C);const R=O[3]=Math.max(O[3],1e-6);return O[0]/=R,O[1]/=R,O[2]/=R,O}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.Point(h[0],h[1])}{const h=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.Point(0,h))}}getCameraToCenterDistance(h,g=this.zoom,b=this.worldSize){const T=Bg(h,g,this.width,this.height,1024),C=h.pixelSpaceConversion(this.center.lat,b,T);return .5/Math.tan(.5*this._fov)*this.height*C}getWorldToCameraMatrix(){const h=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.multiply(h,h,this.globeMatrix),h}}function Cf(v,h){let g=!1,b=null;const T=()=>{b=null,g&&(v(),b=setTimeout(T,h),g=!1)};return()=>(g=!0,b||T(),b)}class Sv{constructor(h){this._hashName=h&&encodeURIComponent(h),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Cf(this._updateHashUnthrottled.bind(this),300)}addTo(h){return this._map=h,o.window.addEventListener("hashchange",this._onHashChange,!1),h.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),o.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const h=this._map;if(!h)return"";const g=qd(h);if(this._hashName){const b=this._hashName;let T=!1;const C=o.window.location.hash.slice(1).split("&").map(O=>{const R=O.split("=")[0];return R===b?(T=!0,`${R}=${g}`):O}).filter(O=>O);return T||C.push(`${b}=${g}`),`#${C.join("&")}`}return`#${g}`}_getCurrentHash(){const h=o.window.location.hash.replace("#","");if(this._hashName){let g;return h.split("&").map(b=>b.split("=")).forEach(b=>{b[0]===this._hashName&&(g=b)}),(g&&g[1]||"").split("/")}return h.split("/")}_onHashChange(){const h=this._map;if(!h)return!1;const g=this._getCurrentHash();if(g.length>=3&&!g.some(b=>isNaN(b))){const b=h.dragRotate.isEnabled()&&h.touchZoomRotate.isEnabled()?+(g[3]||0):h.getBearing();return h.jumpTo({center:[+g[2],+g[1]],zoom:+g[0],bearing:b,pitch:+(g[4]||0)}),!0}return!1}_updateHashUnthrottled(){const h=o.window.location.href.replace(/(#.+)?$/,this.getHashString());o.window.history.replaceState(o.window.history.state,null,h)}}function qd(v,h){const g=v.getCenter(),b=Math.round(100*v.getZoom())/100,T=Math.ceil((b*Math.LN2+Math.log(512/360/.5))/Math.LN10),C=Math.pow(10,T),O=Math.round(g.lng*C)/C,R=Math.round(g.lat*C)/C,F=v.getBearing(),Z=v.getPitch();let j=h?`/${O}/${R}/${b}`:`${b}/${R}/${O}`;return(F||Z)&&(j+="/"+Math.round(10*F)/10),Z&&(j+=`/${Math.round(Z)}`),j}const Zd={linearity:.3,easing:o.bezier(0,0,.3,1)},Ug=o.extend({deceleration:2500,maxSpeed:1400},Zd),Vg=o.extend({deceleration:20,maxSpeed:1400},Zd),Yt=o.extend({deceleration:1e3,maxSpeed:360},Zd),ml=o.extend({deceleration:1e3,maxSpeed:90},Zd);class N1{constructor(h){this._map=h,this.clear()}clear(){this._inertiaBuffer=[]}record(h){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:h})}_drainInertiaBuffer(){const h=this._inertiaBuffer,g=o.exported.now();for(;h.length>0&&g-h[0].time>160;)h.shift()}_onMoveEnd(h){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const g={zoom:0,bearing:0,pitch:0,pan:new o.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:C}of this._inertiaBuffer)g.zoom+=C.zoomDelta||0,g.bearing+=C.bearingDelta||0,g.pitch+=C.pitchDelta||0,C.panDelta&&g.pan._add(C.panDelta),C.around&&(g.around=C.around),C.pinchAround&&(g.pinchAround=C.pinchAround);const b=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,T={};if(g.pan.mag()){const C=Wd(g.pan.mag(),b,o.extend({},Ug,h||{}));T.offset=g.pan.mult(C.amount/g.pan.mag()),T.center=this._map.transform.center,Xd(T,C)}if(g.zoom){const C=Wd(g.zoom,b,Vg);T.zoom=this._map.transform.zoom+C.amount,Xd(T,C)}if(g.bearing){const C=Wd(g.bearing,b,Yt);T.bearing=this._map.transform.bearing+o.clamp(C.amount,-179,179),Xd(T,C)}if(g.pitch){const C=Wd(g.pitch,b,ml);T.pitch=this._map.transform.pitch+C.amount,Xd(T,C)}if(T.zoom||T.bearing){const C=g.pinchAround===void 0?g.around:g.pinchAround;T.around=C?this._map.unproject(C):this._map.getCenter()}return this.clear(),T.noMoveStart=!0,T}}function Xd(v,h){(!v.duration||v.duration<h.duration)&&(v.duration=h.duration,v.easing=h.easing)}function Wd(v,h,g){const{maxSpeed:b,linearity:T,deceleration:C}=g,O=o.clamp(v*T/(h/1e3),-b,b),R=Math.abs(O)/(C*T);return{easing:g.easing,duration:1e3*R,amount:O*(R/2)}}class Ko extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,g,b,T={}){const C=q(g.getCanvasContainer(),b),O=g.unproject(C);super(h,o.extend({point:C,lngLat:O,originalEvent:b},T)),this._defaultPrevented=!1,this.target=g}}class Hd extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,g,b){const T=h==="touchend"?b.changedTouches:b.touches,C=Y(g.getCanvasContainer(),T),O=C.map(F=>g.unproject(F)),R=C.reduce((F,Z,j,Q)=>F.add(Z.div(Q.length)),new o.Point(0,0));super(h,{points:C,point:R,lngLats:O,lngLat:g.unproject(R),originalEvent:b}),this._defaultPrevented=!1}}class Gg extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,g,b){super(h,{originalEvent:b}),this._defaultPrevented=!1}}class Tv{constructor(h,g){this._map=h,this._clickTolerance=g.clickTolerance}reset(){this._mousedownPos=void 0}wheel(h){return this._firePreventable(new Gg(h.type,this._map,h))}mousedown(h,g){return this._mousedownPos=g,this._firePreventable(new Ko(h.type,this._map,h))}mouseup(h){this._map.fire(new Ko(h.type,this._map,h))}preclick(h){const g=o.extend({},h);g.type="preclick",this._map.fire(new Ko(g.type,this._map,g))}click(h,g){this._mousedownPos&&this._mousedownPos.dist(g)>=this._clickTolerance||(this.preclick(h),this._map.fire(new Ko(h.type,this._map,h)))}dblclick(h){return this._firePreventable(new Ko(h.type,this._map,h))}mouseover(h){this._map.fire(new Ko(h.type,this._map,h))}mouseout(h){this._map.fire(new Ko(h.type,this._map,h))}touchstart(h){return this._firePreventable(new Hd(h.type,this._map,h))}touchmove(h){this._map.fire(new Hd(h.type,this._map,h))}touchend(h){this._map.fire(new Hd(h.type,this._map,h))}touchcancel(h){this._map.fire(new Hd(h.type,this._map,h))}_firePreventable(h){if(this._map.fire(h),h.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class $g{constructor(h){this._map=h}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(h){this._map.fire(new Ko(h.type,this._map,h))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ko("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(h){this._delayContextMenu?this._contextMenuEvent=h:this._map.fire(new Ko(h.type,this._map,h)),this._map.listens("contextmenu")&&h.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class F1{constructor(h,g){this._map=h,this._el=h.getCanvasContainer(),this._container=h.getContainer(),this._clickTolerance=g.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(h,g){this.isEnabled()&&h.shiftKey&&h.button===0&&(z(),this._startPos=this._lastPos=g,this._active=!0)}mousemoveWindow(h,g){if(!this._active)return;const b=g,T=this._startPos,C=this._lastPos;if(!T||!C||C.equals(b)||!this._box&&b.dist(T)<this._clickTolerance)return;this._lastPos=b,this._box||(this._box=w("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",h));const O=Math.min(T.x,b.x),R=Math.max(T.x,b.x),F=Math.min(T.y,b.y),Z=Math.max(T.y,b.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${O}px,${F}px)`,this._box.style.width=R-O+"px",this._box.style.height=Z-F+"px")})}mouseupWindow(h,g){if(!this._active)return;const b=this._startPos,T=g;if(b&&h.button===0){if(this.reset(),V(),b.x!==T.x||b.y!==T.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:h})),{cameraAnimation:C=>C.fitScreenCoordinates(b,T,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",h)}}keydown(h){this._active&&h.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",h))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),M(),delete this._startPos,delete this._lastPos}_fireEvent(h,g){return this._map.fire(new o.Event(h,{originalEvent:g}))}}function jg(v,h){const g={};for(let b=0;b<v.length;b++)g[v[b].identifier]=h[b];return g}class Pf{constructor(h){this.reset(),this.numTouches=h.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(h,g,b){(this.centroid||b.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=h.timeStamp),b.length===this.numTouches&&(this.centroid=function(T){const C=new o.Point(0,0);for(const O of T)C._add(O);return C.div(T.length)}(g),this.touches=jg(b,g)))}touchmove(h,g,b){if(this.aborted||!this.centroid)return;const T=jg(b,g);for(const C in this.touches){const O=T[C];(!O||O.dist(this.touches[C])>30)&&(this.aborted=!0)}}touchend(h,g,b){if((!this.centroid||h.timeStamp-this.startTime>500)&&(this.aborted=!0),b.length===0){const T=!this.aborted&&this.centroid;if(this.reset(),T)return T}}}class Iv{constructor(h){this.singleTap=new Pf(h),this.numTaps=h.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(h,g,b){this.singleTap.touchstart(h,g,b)}touchmove(h,g,b){this.singleTap.touchmove(h,g,b)}touchend(h,g,b){const T=this.singleTap.touchend(h,g,b);if(T){const C=h.timeStamp-this.lastTime<500,O=!this.lastTap||this.lastTap.dist(T)<30;if(C&&O||this.reset(),this.count++,this.lastTime=h.timeStamp,this.lastTap=T,this.count===this.numTaps)return this.reset(),T}}}class CE{constructor(){this._zoomIn=new Iv({numTouches:1,numTaps:2}),this._zoomOut=new Iv({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(h,g,b){this._zoomIn.touchstart(h,g,b),this._zoomOut.touchstart(h,g,b)}touchmove(h,g,b){this._zoomIn.touchmove(h,g,b),this._zoomOut.touchmove(h,g,b)}touchend(h,g,b){const T=this._zoomIn.touchend(h,g,b),C=this._zoomOut.touchend(h,g,b);return T?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:O.getZoom()+1,around:O.unproject(T)},{originalEvent:h})}):C?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:O.getZoom()-1,around:O.unproject(C)},{originalEvent:h})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const B1={0:1,2:2};class Af{constructor(h){this.reset(),this._clickTolerance=h.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(h,g){return!1}_move(h,g){return{}}mousedown(h,g){if(this._lastPoint)return;const b=K(h);this._correctButton(h,b)&&(this._lastPoint=g,this._eventButton=b)}mousemoveWindow(h,g){const b=this._lastPoint;if(b){if(h.preventDefault(),this._eventButton!=null&&function(T,C){const O=B1[C];return T.buttons===void 0||(T.buttons&O)!==O}(h,this._eventButton))this.reset();else if(this._moved||!(g.dist(b)<this._clickTolerance))return this._moved=!0,this._lastPoint=g,this._move(b,g)}}mouseupWindow(h){this._lastPoint&&K(h)===this._eventButton&&(this._moved&&V(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cv extends Af{mousedown(h,g){super.mousedown(h,g),this._lastPoint&&(this._active=!0)}_correctButton(h,g){return g===0&&!h.ctrlKey}_move(h,g){return{around:g,panDelta:g.sub(h)}}}class Pv extends Af{_correctButton(h,g){return g===0&&h.ctrlKey||g===2}_move(h,g){const b=.8*(g.x-h.x);if(b)return this._active=!0,{bearingDelta:b}}contextmenu(h){h.preventDefault()}}class Av extends Af{_correctButton(h,g){return g===0&&h.ctrlKey||g===2}_move(h,g){const b=-.5*(g.y-h.y);if(b)return this._active=!0,{pitchDelta:b}}contextmenu(h){h.preventDefault()}}class qg{constructor(h,g){this._map=h,this._el=h.getCanvasContainer(),this._minTouches=1,this._clickTolerance=g.clickTolerance||1,this.reset(),o.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.Point(0,0)}touchstart(h,g,b){return this._calculateTransform(h,g,b)}touchmove(h,g,b){if(this._active&&!(b.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(b.length===1&&!o.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return h.cancelable&&h.preventDefault(),this._calculateTransform(h,g,b)}}touchend(h,g,b){this._calculateTransform(h,g,b),this._active&&b.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(h,g,b){b.length>0&&(this._active=!0);const T=jg(b,g),C=new o.Point(0,0),O=new o.Point(0,0);let R=0;for(const Z in T){const j=T[Z],Q=this._touches[Z];Q&&(C._add(j),O._add(j.sub(Q)),R++,T[Z]=j)}if(this._touches=T,R<this._minTouches||!O.mag())return;const F=O.div(R);return this._sum._add(F),this._sum.mag()<this._clickTolerance?void 0:{around:C.div(R),panDelta:F}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=w("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Yd{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(h){}_move(h,g,b){return{}}touchstart(h,g,b){this._firstTwoTouches||b.length<2||(this._firstTwoTouches=[b[0].identifier,b[1].identifier],this._start([g[0],g[1]]))}touchmove(h,g,b){const T=this._firstTwoTouches;if(!T)return;h.preventDefault();const[C,O]=T,R=Kd(b,g,C),F=Kd(b,g,O);if(!R||!F)return;const Z=this._aroundCenter?null:R.add(F).div(2);return this._move([R,F],Z,h)}touchend(h,g,b){if(!this._firstTwoTouches)return;const[T,C]=this._firstTwoTouches,O=Kd(b,g,T),R=Kd(b,g,C);O&&R||(this._active&&V(),this.reset())}touchcancel(){this.reset()}enable(h){this._enabled=!0,this._aroundCenter=!!h&&h.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Kd(v,h,g){for(let b=0;b<v.length;b++)if(v[b].identifier===g)return h[b]}function Mv(v,h){return Math.log(v/h)/Math.LN2}class z1 extends Yd{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(h){this._startDistance=this._distance=h[0].dist(h[1])}_move(h,g){const b=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs(Mv(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Mv(this._distance,b),pinchAround:g}}}function Lv(v,h){return 180*v.angleWith(h)/Math.PI}class U1 extends Yd{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])}_move(h,g){const b=this._vector;if(this._vector=h[0].sub(h[1]),b&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Lv(this._vector,b),pinchAround:g}}_isBelowThreshold(h){this._minDiameter=Math.min(this._minDiameter,h.mag());const g=25/(Math.PI*this._minDiameter)*360,b=this._startVector;if(!b)return!1;const T=Lv(h,b);return Math.abs(T)<g}}function Ac(v){return Math.abs(v.y)>Math.abs(v.x)}class V1 extends Yd{constructor(h){super(),this._map=h}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(h){this._lastPoints=h,Ac(h[0].sub(h[1]))&&(this._valid=!1)}_move(h,g,b){const T=this._lastPoints;if(!T)return;const C=h[0].sub(T[0]),O=h[1].sub(T[1]);return this._map._cooperativeGestures&&!o.isFullscreen()&&b.touches.length<3||(this._valid=this.gestureBeginsVertically(C,O,b.timeStamp),!this._valid)?void 0:(this._lastPoints=h,this._active=!0,{pitchDelta:(C.y+O.y)/2*-.5})}gestureBeginsVertically(h,g,b){if(this._valid!==void 0)return this._valid;const T=h.mag()>=2,C=g.mag()>=2;if(!T&&!C)return;if(!T||!C)return this._firstMove==null&&(this._firstMove=b),b-this._firstMove<100&&void 0;const O=h.y>0==g.y>0;return Ac(h)&&Ac(g)&&O}}const G1={panStep:100,bearingStep:15,pitchStep:10};class PE{constructor(){const h=G1;this._panStep=h.panStep,this._bearingStep=h.bearingStep,this._pitchStep=h.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(h){if(h.altKey||h.ctrlKey||h.metaKey)return;let g=0,b=0,T=0,C=0,O=0;switch(h.keyCode){case 61:case 107:case 171:case 187:g=1;break;case 189:case 109:case 173:g=-1;break;case 37:h.shiftKey?b=-1:(h.preventDefault(),C=-1);break;case 39:h.shiftKey?b=1:(h.preventDefault(),C=1);break;case 38:h.shiftKey?T=1:(h.preventDefault(),O=-1);break;case 40:h.shiftKey?T=-1:(h.preventDefault(),O=1);break;default:return}return this._rotationDisabled&&(b=0,T=0),{cameraAnimation:R=>{const F=R.getZoom();R.easeTo({duration:300,easeId:"keyboardHandler",easing:$1,zoom:g?Math.round(F)+g*(h.shiftKey?2:1):F,bearing:R.getBearing()+b*this._bearingStep,pitch:R.getPitch()+T*this._pitchStep,offset:[-C*this._panStep,-O*this._panStep],center:R.getCenter()},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function $1(v){return v*(2-v)}const Ov=4.000244140625;class j1{constructor(h,g){this._map=h,this._el=h.getCanvasContainer(),this._handler=g,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(h){this._defaultZoomRate=h}setWheelZoomRate(h){this._wheelZoomRate=h}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(h){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!h&&h.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(h){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(h.ctrlKey||h.metaKey||this.isZooming()||o.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let g=h.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*h.deltaY:h.deltaY;const b=o.exported.now(),T=b-(this._lastWheelEventTime||0);this._lastWheelEventTime=b,g!==0&&g%Ov==0?this._type="wheel":g!==0&&Math.abs(g)<4?this._type="trackpad":T>400?(this._type=null,this._lastValue=g,this._timeout=setTimeout(this._onTimeout,40,h)):this._type||(this._type=Math.abs(T*g)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,g+=this._lastValue)),h.shiftKey&&g&&(g/=4),this._type&&(this._lastWheelEvent=h,this._delta-=g,this._active||this._start(h)),h.preventDefault()}_onTimeout(h){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)}_start(h){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const g=q(this._el,h);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:g,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const h=this._map.transform;this._type==="wheel"&&h.projection.wrap&&(h._center.lng>=180||h._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const g=()=>h._terrainEnabled()&&this._aroundCoord?h.computeZoomRelativeTo(this._aroundCoord):h.zoom;if(this._delta!==0){const F=this._type==="wheel"&&Math.abs(this._delta)>Ov?this._wheelZoomRate:this._defaultZoomRate;let Z=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&Z!==0&&(Z=1/Z);const j=g(),Q=Math.pow(2,j),oe=typeof this._targetZoom=="number"?h.zoomScale(this._targetZoom):Q;this._targetZoom=Math.min(h.maxZoom,Math.max(h.minZoom,h.scaleZoom(oe*Z))),this._type==="wheel"&&(this._startZoom=j,this._easing=this._smoothOutEasing(200)),this._delta=0}const b=typeof this._targetZoom=="number"?this._targetZoom:g(),T=this._startZoom,C=this._easing;let O,R=!1;if(this._type==="wheel"&&T&&C){const F=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),Z=C(F);O=o.number(T,b,Z),F<1?this._frameId||(this._frameId=!0):R=!0}else O=b,R=!0;return this._active=!0,R&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!R,zoomDelta:O-g(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(h){let g=o.ease;if(this._prevEase){const b=this._prevEase,T=(o.exported.now()-b.start)/b.duration,C=b.easing(T+.01)-b.easing(T),O=.27/Math.sqrt(C*C+1e-4)*.01,R=Math.sqrt(.0729-O*O);g=o.bezier(O,R,.25,1)}return this._prevEase={start:o.exported.now(),duration:h,easing:g},g}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=w("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(o.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class q1{constructor(h,g){this._clickZoom=h,this._tapZoom=g}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ca{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(h,g){return h.preventDefault(),{cameraAnimation:b=>{b.easeTo({duration:300,zoom:b.getZoom()+(h.shiftKey?-1:1),around:b.unproject(g)},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class AE{constructor(){this._tap=new Iv({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(h,g,b){this._swipePoint||(this._tapTime&&h.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?b.length>0&&(this._swipePoint=g[0],this._swipeTouch=b[0].identifier):this._tap.touchstart(h,g,b))}touchmove(h,g,b){if(this._tapTime){if(this._swipePoint){if(b[0].identifier!==this._swipeTouch)return;const T=g[0],C=T.y-this._swipePoint.y;return this._swipePoint=T,h.preventDefault(),this._active=!0,{zoomDelta:C/128}}}else this._tap.touchmove(h,g,b)}touchend(h,g,b){this._tapTime?this._swipePoint&&b.length===0&&this.reset():this._tap.touchend(h,g,b)&&(this._tapTime=h.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Z1{constructor(h,g,b){this._el=h,this._mousePan=g,this._touchPan=b}enable(h){this._inertiaOptions=h||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ME{constructor(h,g,b){this._pitchWithRotate=h.pitchWithRotate,this._mouseRotate=g,this._mousePitch=b}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class LE{constructor(h,g,b,T){this._el=h,this._touchZoom=g,this._touchRotate=b,this._tapDragZoom=T,this._rotationDisabled=!1,this._enabled=!0}enable(h){this._touchZoom.enable(h),this._rotationDisabled||this._touchRotate.enable(h),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const qs=v=>v.zoom||v.drag||v.pitch||v.rotate;class X1 extends o.Event{}class OE{constructor(){this.constants=[1,1,.01],this.radius=0}setup(h,g){const b=o.sub([],g,h);this.radius=o.length(b[2]<0?o.div([],b,this.constants):[b[0],b[1],0])}projectRay(h){o.div(h,h,this.constants),o.normalize(h,h),o.mul$1(h,h,this.constants);const g=o.scale$2([],h,this.radius);if(g[2]>0){const b=o.scale$2([],[0,0,1],o.dot(g,[0,0,1])),T=o.scale$2([],o.normalize([],[g[0],g[1],0]),this.radius),C=o.add([],g,o.scale$2([],o.sub([],o.add([],T,b),g),2));g[0]=C[0],g[1]=C[1]}return g}}function yl(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class Xl{constructor(h,g){this._map=h,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new N1(h),this._bearingSnap=g.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new OE,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(g),o.bindAll(["handleEvent","handleWindowEvent"],this);const b=this._el;this._listeners=[[b,"touchstart",{passive:!0}],[b,"touchmove",{passive:!1}],[b,"touchend",void 0],[b,"touchcancel",void 0],[b,"mousedown",void 0],[b,"mousemove",void 0],[b,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[b,"mouseover",void 0],[b,"mouseout",void 0],[b,"dblclick",void 0],[b,"click",void 0],[b,"keydown",{capture:!1}],[b,"keyup",void 0],[b,"wheel",{passive:!1}],[b,"contextmenu",void 0],[o.window,"blur",void 0]];for(const[T,C,O]of this._listeners)T.addEventListener(C,T===o.window.document?this.handleWindowEvent:this.handleEvent,O)}destroy(){for(const[h,g,b]of this._listeners)h.removeEventListener(g,h===o.window.document?this.handleWindowEvent:this.handleEvent,b)}_addDefaultHandlers(h){const g=this._map,b=g.getCanvasContainer();this._add("mapEvent",new Tv(g,h));const T=g.boxZoom=new F1(g,h);this._add("boxZoom",T);const C=new CE,O=new Ca;g.doubleClickZoom=new q1(O,C),this._add("tapZoom",C),this._add("clickZoom",O);const R=new AE;this._add("tapDragZoom",R);const F=g.touchPitch=new V1(g);this._add("touchPitch",F);const Z=new Pv(h),j=new Av(h);g.dragRotate=new ME(h,Z,j),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]);const Q=new Cv(h),oe=new qg(g,h);g.dragPan=new Z1(b,Q,oe),this._add("mousePan",Q),this._add("touchPan",oe,["touchZoom","touchRotate"]);const he=new U1,pe=new z1;g.touchZoomRotate=new LE(b,pe,he,R),this._add("touchRotate",he,["touchPan","touchZoom"]),this._add("touchZoom",pe,["touchPan","touchRotate"]),this._add("blockableMapEvent",new $g(g));const de=g.scrollZoom=new j1(g,this);this._add("scrollZoom",de,["mousePan"]);const ge=g.keyboard=new PE;this._add("keyboard",ge);for(const ee of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])h.interactive&&h[ee]&&g[ee].enable(h[ee])}_add(h,g,b){this._handlers.push({handlerName:h,handler:g,allowed:b}),this._handlersById[h]=g}stop(h){if(!this._updatingCamera){for(const{handler:g}of this._handlers)g.reset();this._inertia.clear(),this._fireEvents({},{},h),this._changes=[]}}isActive(){for(const{handler:h}of this._handlers)if(h.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!qs(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(h,g,b){for(const T in h)if(T!==b&&(!g||g.indexOf(T)<0))return!0;return!1}handleWindowEvent(h){this.handleEvent(h,`${h.type}Window`)}_getMapTouches(h){const g=[];for(const b of h)this._el.contains(b.target)&&g.push(b);return g}handleEvent(h,g){this._updatingCamera=!0;const b=h.type==="renderFrame",T=b?void 0:h,C={needsRenderFrame:!1},O={},R={},F=h.touches?this._getMapTouches(h.touches):void 0,Z=F?Y(this._el,F):b?void 0:q(this._el,h);for(const{handlerName:oe,handler:he,allowed:pe}of this._handlers){if(!he.isEnabled())continue;let de;this._blockedByActive(R,pe,oe)?he.reset():he[g||h.type]&&(de=he[g||h.type](h,Z,F),this.mergeHandlerResult(C,O,de,oe,T),de&&de.needsRenderFrame&&this._triggerRenderFrame()),(de||he.isActive())&&(R[oe]=he)}const j={};for(const oe in this._previousActiveHandlers)R[oe]||(j[oe]=T);this._previousActiveHandlers=R,(Object.keys(j).length||yl(C))&&(this._changes.push([C,O,j]),this._triggerRenderFrame()),(Object.keys(R).length||yl(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Q}=C;Q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Q(this._map))}mergeHandlerResult(h,g,b,T,C){if(!b)return;o.extend(h,b);const O={handlerName:T,originalEvent:b.originalEvent||C};b.zoomDelta!==void 0&&(g.zoom=O),b.panDelta!==void 0&&(g.drag=O),b.pitchDelta!==void 0&&(g.pitch=O),b.bearingDelta!==void 0&&(g.rotate=O)}_applyChanges(){const h={},g={},b={};for(const[T,C,O]of this._changes)T.panDelta&&(h.panDelta=(h.panDelta||new o.Point(0,0))._add(T.panDelta)),T.zoomDelta&&(h.zoomDelta=(h.zoomDelta||0)+T.zoomDelta),T.bearingDelta&&(h.bearingDelta=(h.bearingDelta||0)+T.bearingDelta),T.pitchDelta&&(h.pitchDelta=(h.pitchDelta||0)+T.pitchDelta),T.around!==void 0&&(h.around=T.around),T.aroundCoord!==void 0&&(h.aroundCoord=T.aroundCoord),T.pinchAround!==void 0&&(h.pinchAround=T.pinchAround),T.noInertia&&(h.noInertia=T.noInertia),o.extend(g,C),o.extend(b,O);this._updateMapTransform(h,g,b),this._changes=[]}_updateMapTransform(h,g,b){const T=this._map,C=T.transform,O=ce=>[ce.x,ce.y,ce.z];if((ce=>{const _e=this._eventsInProgress.drag;return _e&&!this._handlersById[_e.handlerName].isActive()})()&&!yl(h)){const ce=C.zoom;C.cameraElevationReference="sea",C.recenterOnTerrain(),C.cameraElevationReference="ground",ce!==C.zoom&&this._map._update(!0)}if(C._isCameraConstrained&&T._stop(!0),!yl(h))return void this._fireEvents(g,b,!0);let{panDelta:R,zoomDelta:F,bearingDelta:Z,pitchDelta:j,around:Q,aroundCoord:oe,pinchAround:he}=h;C._isCameraConstrained&&(F>0&&(F=0),C._isCameraConstrained=!1),he!==void 0&&(Q=he),(F||(ce=>g[ce]&&!this._eventsInProgress[ce])("drag"))&&Q&&(this._dragOrigin=O(C.pointCoordinate3D(Q)),this._trackingEllipsoid.setup(C._camera.position,this._dragOrigin)),C.cameraElevationReference="sea",T._stop(!0),Q=Q||T.transform.centerPoint,Z&&(C.bearing+=Z),j&&(C.pitch+=j),C._updateCameraState();const pe=[0,0,0];if(R)if(C.projection.name==="mercator"){const ce=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(Q).dir),_e=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(Q.sub(R)).dir);pe[0]=_e[0]-ce[0],pe[1]=_e[1]-ce[1]}else{const ce=C.pointCoordinate(Q);if(C.projection.name==="globe"){R=R.rotate(-C.angle);const _e=C._pixelsPerMercatorPixel/C.worldSize;pe[0]=-R.x*o.mercatorScale(o.latFromMercatorY(ce.y))*_e,pe[1]=-R.y*o.mercatorScale(C.center.lat)*_e}else{const _e=C.pointCoordinate(Q.sub(R));ce&&_e&&(pe[0]=_e.x-ce.x,pe[1]=_e.y-ce.y)}}const de=C.zoom,ge=[0,0,0];if(F){const ce=O(oe||C.pointCoordinate3D(Q)),_e={dir:o.normalize([],o.sub([],ce,C._camera.position))};if(_e.dir[2]<0){const xe=C.zoomDeltaToMovement(ce,F);o.scale$2(ge,_e.dir,xe)}}const ee=o.add(pe,pe,ge);C._translateCameraConstrained(ee),F&&Math.abs(C.zoom-de)>1e-4&&C.recenterOnTerrain(),C.cameraElevationReference="ground",this._map._update(),h.noInertia||this._inertia.record(h),this._fireEvents(g,b,!0)}_fireEvents(h,g,b){const T=qs(this._eventsInProgress),C=qs(h),O={};for(const j in h){const{originalEvent:Q}=h[j];this._eventsInProgress[j]||(O[`${j}start`]=Q),this._eventsInProgress[j]=h[j]}!T&&C&&this._fireEvent("movestart",C.originalEvent);for(const j in O)this._fireEvent(j,O[j]);C&&this._fireEvent("move",C.originalEvent);for(const j in h){const{originalEvent:Q}=h[j];this._fireEvent(j,Q)}const R={};let F;for(const j in this._eventsInProgress){const{handlerName:Q,originalEvent:oe}=this._eventsInProgress[j];this._handlersById[Q].isActive()||(delete this._eventsInProgress[j],F=g[Q]||oe,R[`${j}end`]=F)}for(const j in R)this._fireEvent(j,R[j]);const Z=qs(this._eventsInProgress);if(b&&(T||C)&&!Z){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Q=oe=>oe!==0&&-this._bearingSnap<oe&&oe<this._bearingSnap;j?(Q(j.bearing||this._map.getBearing())&&(j.bearing=0),this._map.easeTo(j,{originalEvent:F})):(this._map.fire(new o.Event("moveend",{originalEvent:F})),Q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(h,g){this._map.fire(new o.Event(h,g?{originalEvent:g}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(h=>{this._frameId=void 0,this.handleEvent(new X1("renderFrame",{timeStamp:h})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const _h="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Zg extends o.Evented{constructor(h,g){super(),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=g.bearingSnap,this._respectPrefersReducedMotion=g.respectPrefersReducedMotion!==!1,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(h,g){return this.jumpTo({center:h},g)}panBy(h,g,b){return h=o.Point.convert(h).mult(-1),this.panTo(this.transform.center,o.extend({offset:h},g),b)}panTo(h,g,b){return this.easeTo(o.extend({center:h},g),b)}getZoom(){return this.transform.zoom}setZoom(h,g){return this.jumpTo({zoom:h},g),this}zoomTo(h,g,b){return this.easeTo(o.extend({zoom:h},g),b)}zoomIn(h,g){return this.zoomTo(this.getZoom()+1,h,g),this}zoomOut(h,g){return this.zoomTo(this.getZoom()-1,h,g),this}getBearing(){return this.transform.bearing}setBearing(h,g){return this.jumpTo({bearing:h},g),this}getPadding(){return this.transform.padding}setPadding(h,g){return this.jumpTo({padding:h},g),this}rotateTo(h,g,b){return this.easeTo(o.extend({bearing:h},g),b)}resetNorth(h,g){return this.rotateTo(0,o.extend({duration:1e3},h),g),this}resetNorthPitch(h,g){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},h),g),this}snapToNorth(h,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,g):this}getPitch(){return this.transform.pitch}setPitch(h,g){return this.jumpTo({pitch:h},g),this}cameraForBounds(h,g){h=o.LngLatBounds.convert(h);const b=g&&g.bearing||0,T=g&&g.pitch||0,C=h.getNorthWest(),O=h.getSouthEast();return this._cameraForBounds(this.transform,C,O,b,T,g)}_extendCameraOptions(h){const g={top:0,bottom:0,right:0,left:0};if(typeof(h=o.extend({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const b=h.padding;h.padding={top:b,bottom:b,right:b,left:b}}return h.padding=o.extend(g,h.padding),h}_minimumAABBFrustumDistance(h,g){const b=g.max[0]-g.min[0],T=g.max[1]-g.min[1];return b/T>h.aspect?b/(2*Math.tan(.5*h.fovX)*h.aspect):T/(2*Math.tan(.5*h.fovY)*h.aspect)}_cameraForBoundsOnGlobe(h,g,b,T,C,O){const R=h.clone(),F=this._extendCameraOptions(O);R.bearing=T,R.pitch=C;const Z=o.LngLat.convert(g),j=o.LngLat.convert(b),Q=.5*(Z.lat+j.lat),oe=.5*(Z.lng+j.lng),he=o.latLngToECEF(Q,oe),pe=o.normalize([],he),de=o.normalize([],o.cross([],pe,[0,1,0])),ge=o.cross([],de,pe),ee=[de[0],de[1],de[2],0,ge[0],ge[1],ge[2],0,pe[0],pe[1],pe[2],0,0,0,0,1],ce=[he,o.latLngToECEF(Z.lat,Z.lng),o.latLngToECEF(j.lat,Z.lng),o.latLngToECEF(j.lat,j.lng),o.latLngToECEF(Z.lat,j.lng),o.latLngToECEF(Q,Z.lng),o.latLngToECEF(Q,j.lng),o.latLngToECEF(Z.lat,oe),o.latLngToECEF(j.lat,oe)];let _e=o.Aabb.fromPoints(ce.map(_t=>[o.dot(de,_t),o.dot(ge,_t),o.dot(pe,_t)]));const xe=o.transformMat4([],_e.center,ee);o.squaredLength(xe)===0&&o.set(xe,0,0,1),o.normalize(xe,xe),o.scale$2(xe,xe,o.GLOBE_RADIUS),R.center=o.ecefToLatLng(xe);const De=R.getWorldToCameraMatrix(),ke=o.invert(new Float64Array(16),De);_e=o.Aabb.applyTransform(_e,o.multiply([],De,ee)),o.transformMat4(xe,xe,De);const Re=.5*(_e.max[2]-_e.min[2]),Ge=this._minimumAABBFrustumDistance(R,_e),ze=o.scale$2([],[0,0,1],Re),Qe=o.add(ze,xe,ze),Et=Ge+(R.pitch===0?0:o.distance(xe,Qe)),Xe=R.globeCenterInViewSpace,gt=o.sub([],xe,[Xe[0],Xe[1],Xe[2]]);o.normalize(gt,gt),o.scale$2(gt,gt,Et);const rt=o.add([],xe,gt);o.transformMat4(rt,rt,ke);const wt=o.earthRadius/o.GLOBE_RADIUS,Ye=o.length(rt),pt=o.mercatorZfromAltitude(Math.max(Ye*wt-o.earthRadius,Number.EPSILON),0),It=Math.min(R.zoomFromMercatorZAdjusted(pt),F.maxZoom);return It>.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(R.setProjection({name:"mercator"}),R.zoom=It,this._cameraForBounds(R,g,b,T,C,O)):{center:R.center,zoom:It,bearing:T,pitch:C}}queryTerrainElevation(h,g){const b=this.transform.elevation;return b?(g=o.extend({},{exaggerated:!0},g),b.getAtPoint(o.MercatorCoordinate.fromLngLat(h),null,g.exaggerated)):null}_cameraForBounds(h,g,b,T,C,O){if(h.projection.name==="globe")return this._cameraForBoundsOnGlobe(h,g,b,T,C,O);const R=h.clone(),F=this._extendCameraOptions(O),Z=R.padding;R.bearing=T,R.pitch=C;const j=o.LngLat.convert(g),Q=o.LngLat.convert(b),oe=new o.LngLat(j.lng,Q.lat),he=new o.LngLat(Q.lng,j.lat),pe=R.project(j),de=R.project(Q),ge=this.queryTerrainElevation(j),ee=this.queryTerrainElevation(Q),ce=this.queryTerrainElevation(oe),_e=this.queryTerrainElevation(he),xe=[[pe.x,pe.y,Math.min(ge||0,ee||0,ce||0,_e||0)],[de.x,de.y,Math.max(ge||0,ee||0,ce||0,_e||0)]];let De=o.Aabb.fromPoints(xe);const ke=R.getWorldToCameraMatrix(),Re=o.invert(new Float64Array(16),ke);De=o.Aabb.applyTransform(De,ke);const Ge=o.sub([],De.max,De.min),ze=Z.left||0,Qe=Z.right||0,Et=Z.bottom||0,Xe=Z.top||0,{left:gt,right:rt,top:wt,bottom:Ye}=F.padding,pt=.5*(ze+Qe),It=.5*(Xe+Et),_t=Math.min(R.scaleZoom(R.scale*Math.min((R.width-(ze+Qe+gt+rt))/Ge[0],(R.height-(Et+Xe+Ye+wt))/Ge[1])),F.maxZoom),Pt=R.scale/R.zoomScale(_t);De=new o.Aabb([De.min[0]-(gt+pt)*Pt,De.min[1]-(Ye+It)*Pt,De.min[2]],[De.max[0]+(rt+pt)*Pt,De.max[1]+(wt+It)*Pt,De.max[2]]);const yn=.5*Ge[2],Ln=this._minimumAABBFrustumDistance(R,De),an=[0,0,1,0];o.transformMat4$1(an,an,ke),o.normalize$2(an,an);const En=o.scale$2([],an,Ln+yn),tr=o.add([],De.center,En),Kn=(typeof F.offset.x=="number"&&typeof F.offset.y=="number"?new o.Point(F.offset.x,F.offset.y):o.Point.convert(F.offset)).rotate(-o.degToRad(T));De.center[0]-=Kn.x*Pt,De.center[1]+=Kn.y*Pt,o.transformMat4(De.center,De.center,Re),o.transformMat4(tr,tr,Re);const gn=[De.center[0],De.center[1],tr[2]*R.pixelsPerMeter];o.scale$2(gn,gn,1/R.worldSize);const ni=o.lngFromMercatorX(gn[0]),ui=o.latFromMercatorY(gn[1]),ci=Math.min(R._zoomFromMercatorZ(gn[2]),F.maxZoom),hi=new o.LngLat(ni,ui);return R.mercatorFromTransition&&ci<.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(R.setProjection({name:"globe"}),R.zoom=ci,this._cameraForBounds(R,g,b,T,C,O)):{center:hi,zoom:ci,bearing:T,pitch:C}}fitBounds(h,g,b){const T=this.cameraForBounds(h,g);return this._fitInternal(T,g,b)}fitScreenCoordinates(h,g,b,T,C){const O=o.Point.convert(h),R=o.Point.convert(g),F=new o.Point(Math.min(O.x,R.x),Math.min(O.y,R.y)),Z=new o.Point(Math.max(O.x,R.x),Math.max(O.y,R.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(O,R))return this;const j=this.transform.pointLocation3D(F),Q=this.transform.pointLocation3D(Z),oe=this.transform.pointLocation3D(new o.Point(F.x,Z.y)),he=this.transform.pointLocation3D(new o.Point(Z.x,F.y)),pe=[Math.min(j.lng,Q.lng,oe.lng,he.lng),Math.min(j.lat,Q.lat,oe.lat,he.lat)],de=[Math.max(j.lng,Q.lng,oe.lng,he.lng),Math.max(j.lat,Q.lat,oe.lat,he.lat)],ge=T&&T.pitch?T.pitch:this.getPitch(),ee=this._cameraForBounds(this.transform,pe,de,b,ge,T);return this._fitInternal(ee,T,C)}_fitInternal(h,g,b){return h?(delete(g=o.extend(h,g)).padding,g.linear?this.easeTo(g,b):this.flyTo(g,b)):this}jumpTo(h,g){this.stop();const b=h.preloadOnly?this.transform.clone():this.transform;let T=!1,C=!1,O=!1;return"zoom"in h&&b.zoom!==+h.zoom&&(T=!0,b.zoom=+h.zoom),h.center!==void 0&&(b.center=o.LngLat.convert(h.center)),"bearing"in h&&b.bearing!==+h.bearing&&(C=!0,b.bearing=+h.bearing),"pitch"in h&&b.pitch!==+h.pitch&&(O=!0,b.pitch=+h.pitch),h.padding==null||b.isPaddingEqual(h.padding)||(b.padding=h.padding),h.preloadOnly?(this._preloadTiles(b),this):(this.fire(new o.Event("movestart",g)).fire(new o.Event("move",g)),T&&this.fire(new o.Event("zoomstart",g)).fire(new o.Event("zoom",g)).fire(new o.Event("zoomend",g)),C&&this.fire(new o.Event("rotatestart",g)).fire(new o.Event("rotate",g)).fire(new o.Event("rotateend",g)),O&&this.fire(new o.Event("pitchstart",g)).fire(new o.Event("pitch",g)).fire(new o.Event("pitchend",g)),this.fire(new o.Event("moveend",g)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.warnOnce(_h),this.transform.getFreeCameraOptions()}setFreeCameraOptions(h,g){const b=this.transform;if(!b.projection.supportsFreeCamera)return o.warnOnce(_h),this;this.stop();const T=b.zoom,C=b.pitch,O=b.bearing;b.setFreeCameraOptions(h);const R=T!==b.zoom,F=C!==b.pitch,Z=O!==b.bearing;return this.fire(new o.Event("movestart",g)).fire(new o.Event("move",g)),R&&this.fire(new o.Event("zoomstart",g)).fire(new o.Event("zoom",g)).fire(new o.Event("zoomend",g)),Z&&this.fire(new o.Event("rotatestart",g)).fire(new o.Event("rotate",g)).fire(new o.Event("rotateend",g)),F&&this.fire(new o.Event("pitchstart",g)).fire(new o.Event("pitch",g)).fire(new o.Event("pitchend",g)),this.fire(new o.Event("moveend",g)),this}easeTo(h,g){this._stop(!1,h.easeId),((h=o.extend({offset:[0,0],duration:500,easing:o.ease},h)).animate===!1||this._prefersReducedMotion(h))&&(h.duration=0);const b=this.transform,T=this.getZoom(),C=this.getBearing(),O=this.getPitch(),R=this.getPadding(),F="zoom"in h?+h.zoom:T,Z="bearing"in h?this._normalizeBearing(h.bearing,C):C,j="pitch"in h?+h.pitch:O,Q="padding"in h?h.padding:b.padding,oe=o.Point.convert(h.offset);let he,pe,de;if(b.projection.name==="globe"){const ze=o.MercatorCoordinate.fromLngLat(b.center),Qe=oe.rotate(-b.angle);ze.x+=Qe.x/b.worldSize,ze.y+=Qe.y/b.worldSize;const Et=ze.toLngLat(),Xe=o.LngLat.convert(h.center||Et);this._normalizeCenter(Xe),he=b.centerPoint.add(Qe),pe=new o.Point(ze.x,ze.y).mult(b.worldSize),de=new o.Point(o.mercatorXfromLng(Xe.lng),o.mercatorYfromLat(Xe.lat)).mult(b.worldSize).sub(pe)}else{he=b.centerPoint.add(oe);const ze=b.pointLocation(he),Qe=o.LngLat.convert(h.center||ze);this._normalizeCenter(Qe),pe=b.project(ze),de=b.project(Qe).sub(pe)}const ge=b.zoomScale(F-T);let ee,ce;h.around&&(ee=o.LngLat.convert(h.around),ce=b.locationPoint(ee));const _e=this._zooming||F!==T,xe=this._rotating||C!==Z,De=this._pitching||j!==O,ke=!b.isPaddingEqual(Q),Re=ze=>Qe=>{if(_e&&(ze.zoom=o.number(T,F,Qe)),xe&&(ze.bearing=o.number(C,Z,Qe)),De&&(ze.pitch=o.number(O,j,Qe)),ke&&(ze.interpolatePadding(R,Q,Qe),he=ze.centerPoint.add(oe)),ee)ze.setLocationAtPoint(ee,ce);else{const Et=ze.zoomScale(ze.zoom-T),Xe=F>T?Math.min(2,ge):Math.max(.5,ge),gt=Math.pow(Xe,1-Qe),rt=ze.unproject(pe.add(de.mult(Qe*gt)).mult(Et));ze.setLocationAtPoint(ze.renderWorldCopies?rt.wrap():rt,he)}return h.preloadOnly||this._fireMoveEvents(g),ze};if(h.preloadOnly){const ze=this._emulate(Re,h.duration,b);return this._preloadTiles(ze),this}const Ge={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=_e,this._rotating=xe,this._pitching=De,this._padding=ke,this._easeId=h.easeId,this._prepareEase(g,h.noMoveStart,Ge),this._ease(Re(b),ze=>{b.recenterOnTerrain(),this._afterEase(g,ze)},h),this}_prepareEase(h,g,b={}){this._moving=!0,this.transform.cameraElevationReference="sea",g||b.moving||this.fire(new o.Event("movestart",h)),this._zooming&&!b.zooming&&this.fire(new o.Event("zoomstart",h)),this._rotating&&!b.rotating&&this.fire(new o.Event("rotatestart",h)),this._pitching&&!b.pitching&&this.fire(new o.Event("pitchstart",h))}_fireMoveEvents(h){this.fire(new o.Event("move",h)),this._zooming&&this.fire(new o.Event("zoom",h)),this._rotating&&this.fire(new o.Event("rotate",h)),this._pitching&&this.fire(new o.Event("pitch",h))}_afterEase(h,g){if(this._easeId&&g&&this._easeId===g)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const b=this._zooming,T=this._rotating,C=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,b&&this.fire(new o.Event("zoomend",h)),T&&this.fire(new o.Event("rotateend",h)),C&&this.fire(new o.Event("pitchend",h)),this.fire(new o.Event("moveend",h))}flyTo(h,g){if(this._prefersReducedMotion(h)){const _t=o.pick(h,["center","zoom","bearing","pitch","around"]);return this.jumpTo(_t,g)}this.stop(),h=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},h);const b=this.transform,T=this.getZoom(),C=this.getBearing(),O=this.getPitch(),R=this.getPadding(),F="zoom"in h?o.clamp(+h.zoom,b.minZoom,b.maxZoom):T,Z="bearing"in h?this._normalizeBearing(h.bearing,C):C,j="pitch"in h?+h.pitch:O,Q="padding"in h?h.padding:b.padding,oe=b.zoomScale(F-T),he=o.Point.convert(h.offset);let pe=b.centerPoint.add(he);const de=b.pointLocation(pe),ge=o.LngLat.convert(h.center||de);this._normalizeCenter(ge);const ee=b.project(de),ce=b.project(ge).sub(ee);let _e=h.curve;const xe=Math.max(b.width,b.height),De=xe/oe,ke=ce.mag();if("minZoom"in h){const _t=o.clamp(Math.min(h.minZoom,T,F),b.minZoom,b.maxZoom),Pt=xe/b.zoomScale(_t-T);_e=Math.sqrt(Pt/ke*2)}const Re=_e*_e;function Ge(_t){const Pt=(De*De-xe*xe+(_t?-1:1)*Re*Re*ke*ke)/(2*(_t?De:xe)*Re*ke);return Math.log(Math.sqrt(Pt*Pt+1)-Pt)}function ze(_t){return(Math.exp(_t)-Math.exp(-_t))/2}function Qe(_t){return(Math.exp(_t)+Math.exp(-_t))/2}const Et=Ge(0);let Xe=function(_t){return Qe(Et)/Qe(Et+_e*_t)},gt=function(_t){return xe*((Qe(Et)*(ze(Pt=Et+_e*_t)/Qe(Pt))-ze(Et))/Re)/ke;var Pt},rt=(Ge(1)-Et)/_e;if(Math.abs(ke)<1e-6||!isFinite(rt)){if(Math.abs(xe-De)<1e-6)return this.easeTo(h,g);const _t=De<xe?-1:1;rt=Math.abs(Math.log(De/xe))/_e,gt=function(){return 0},Xe=function(Pt){return Math.exp(_t*_e*Pt)}}h.duration="duration"in h?+h.duration:1e3*rt/("screenSpeed"in h?+h.screenSpeed/_e:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0);const wt=C!==Z,Ye=j!==O,pt=!b.isPaddingEqual(Q),It=_t=>Pt=>{const yn=Pt*rt,Ln=1/Xe(yn);_t.zoom=Pt===1?F:T+_t.scaleZoom(Ln),wt&&(_t.bearing=o.number(C,Z,Pt)),Ye&&(_t.pitch=o.number(O,j,Pt)),pt&&(_t.interpolatePadding(R,Q,Pt),pe=_t.centerPoint.add(he));const an=Pt===1?ge:_t.unproject(ee.add(ce.mult(gt(yn))).mult(Ln));return _t.setLocationAtPoint(_t.renderWorldCopies?an.wrap():an,pe),_t._updateCameraOnTerrain(),h.preloadOnly||this._fireMoveEvents(g),_t};if(h.preloadOnly){const _t=this._emulate(It,h.duration,b);return this._preloadTiles(_t),this}return this._zooming=!0,this._rotating=wt,this._pitching=Ye,this._padding=pt,this._prepareEase(g,!1),this._ease(It(b),()=>this._afterEase(g),h),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(h,g){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const b=this._onEaseEnd;this._onEaseEnd=void 0,b.call(this,g)}if(!h){const b=this.handlers;b&&b.stop(!1)}return this}_ease(h,g,b){b.animate===!1||b.duration===0?(h(1),g()):(this._easeStart=o.exported.now(),this._easeOptions=b,this._onEaseFrame=h,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const h=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1),g=this._onEaseFrame;g&&g(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(h,g){h=o.wrap(h,-180,180);const b=Math.abs(h-g);return Math.abs(h-360-g)<b&&(h-=360),Math.abs(h+360-g)<b&&(h+=360),h}_normalizeCenter(h){const g=this.transform;if(!g.renderWorldCopies||g.maxBounds)return;const b=h.lng-g.center.lng;h.lng+=b>180?-360:b<-180?360:0}_prefersReducedMotion(h){return this._respectPrefersReducedMotion&&o.exported.prefersReducedMotion&&!(h&&h.essential)}_emulate(h,g,b){const T=Math.ceil(15*g/1e3),C=[],O=h(b.clone());for(let R=0;R<=T;R++){const F=O(R/T);C.push(F.clone())}return C}}class nn{constructor(h={}){this.options=h,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(h){const g=this.options&&this.options.compact;return this._map=h,this._container=w("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=w("button","mapboxgl-ctrl-attrib-button",this._container),w("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=w("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),g&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),g===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(h,g){const b=this._map._getUIString(`AttributionControl.${g}`);h.setAttribute("aria-label",b),h.removeAttribute("title"),h.firstElementChild&&h.firstElementChild.setAttribute("title",b)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let h=this._editLink;h||(h=this._editLink=this._container.querySelector(".mapbox-improve-map"));const g=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(h){const b=g.reduce((T,C,O)=>(C.value&&(T+=`${C.key}=${C.value}${O<g.length-1?"&":""}`),T),"?");h.href=`${o.config.FEEDBACK_URL}/${b}#${qd(this._map,!0)}`,h.rel="noopener nofollow",this._setElementTitle(h,"MapFeedback")}}_updateData(h){!h||h.sourceDataType!=="metadata"&&h.sourceDataType!=="visibility"&&h.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let h=[];if(this._map.style.stylesheet){const T=this._map.style.stylesheet;this.styleOwner=T.owner,this.styleId=T.id}const g=this._map.style._sourceCaches;for(const T in g){const C=g[T];if(C.used){const O=C.getSource();O.attribution&&h.indexOf(O.attribution)<0&&h.push(O.attribution)}}h.sort((T,C)=>T.length-C.length),h=h.filter((T,C)=>{for(let O=C+1;O<h.length;O++)if(h[O].indexOf(T)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?h=[...this.options.customAttribution,...h]:h.unshift(this.options.customAttribution));const b=h.join(" | ");b!==this._attribHTML&&(this._attribHTML=b,h.length?(this._innerContainer.innerHTML=b,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Dv{constructor(){o.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(h){this._map=h,this._container=w("div","mapboxgl-ctrl");const g=w("a","mapboxgl-ctrl-logo");return g.target="_blank",g.rel="noopener nofollow",g.href="https://www.mapbox.com/",g.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),g.setAttribute("rel","noopener nofollow"),this._container.appendChild(g),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(h){h&&h.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const h=this._map.style._sourceCaches;if(Object.entries(h).length===0)return!0;for(const g in h){const b=h[g].getSource();if(b.hasOwnProperty("mapbox_logo")&&!b.mapbox_logo)return!1}return!0}_updateCompact(){const h=this._container.children;if(h.length){const g=h[0];this._map.getCanvasContainer().offsetWidth<250?g.classList.add("mapboxgl-compact"):g.classList.remove("mapboxgl-compact")}}}class Rv{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(h){const g=++this._id;return this._queue.push({callback:h,id:g,cancelled:!1}),g}remove(h){const g=this._currentlyRunning,b=g?this._queue.concat(g):this._queue;for(const T of b)if(T.id===h)return void(T.cancelled=!0)}run(h=0){const g=this._currentlyRunning=this._queue;this._queue=[];for(const b of g)if(!b.cancelled&&(b.callback(h),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Mf(v,h,g){if(v=new o.LngLat(v.lng,v.lat),h){const b=new o.LngLat(v.lng-360,v.lat),T=new o.LngLat(v.lng+360,v.lat),C=360*Math.ceil(Math.abs(v.lng-g.center.lng)/360),O=g.locationPoint(v).distSqr(h),R=h.x<0||h.y<0||h.x>g.width||h.y>g.height;g.locationPoint(b).distSqr(h)<O&&(R||Math.abs(b.lng-g.center.lng)<C)?v=b:g.locationPoint(T).distSqr(h)<O&&(R||Math.abs(T.lng-g.center.lng)<C)&&(v=T)}for(;Math.abs(v.lng-g.center.lng)>180;){const b=g.locationPoint(v);if(b.x>=0&&b.y>=0&&b.x<=g.width&&b.y<=g.height)break;v.lng>g.center.lng?v.lng-=360:v.lng+=360}return v}const xh={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Zt extends o.Evented{constructor(h,g){if(super(),(h instanceof o.window.HTMLElement||g)&&(h=o.extend({element:h},g)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&h.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=h&&h.occludedOpacity||.2,h&&h.element)this._element=h.element,this._offset=o.Point.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=w("div");const T=41,C=27,O=S("svg",{display:"block",height:T*this._scale+"px",width:C*this._scale+"px",viewBox:`0 0 ${C} ${T}`},this._element),R=S("radialGradient",{id:"shadowGradient"},S("defs",{},O));S("stop",{offset:"10%","stop-opacity":.4},R),S("stop",{offset:"100%","stop-opacity":.05},R),S("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},O),S("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},O),S("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},O),S("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},O),this._offset=o.Point.convert(h&&h.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",T=>{T.preventDefault()}),this._element.addEventListener("mousedown",T=>{T.preventDefault()});const b=this._element.classList;for(const T in xh)b.remove(`mapboxgl-marker-anchor-${T}`);b.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(h){return h===this._map||(this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._updateMoving),h.on("moveend",this._update),h.on("remove",this._clearFadeTimer),h._addMarker(this),this.setDraggable(this._draggable),this._update(),h.on("click",this._onMapClick)),this}remove(){const h=this._map;return h&&(h.off("click",this._onMapClick),h.off("move",this._updateMoving),h.off("moveend",this._update),h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler),h.off("mouseup",this._onUp),h.off("touchend",this._onUp),h.off("mousemove",this._onMove),h.off("touchmove",this._onMove),h.off("remove",this._clearFadeTimer),h._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=o.LngLat.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){const T=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[T,-1*(38.1-13.5+T)],"bottom-right":[-T,-1*(38.1-13.5+T)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=h,h._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(h){const g=h.code,b=h.charCode||h.keyCode;g!=="Space"&&g!=="Enter"&&b!==32&&b!==13||this.togglePopup()}_onMapClick(h){const g=h.originalEvent.target,b=this._element;this._popup&&(g===b||b.contains(g))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const h=this._popup;return h?(h.isOpen()?(h.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(h.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const h=this._map,g=this._pos;if(!h||!g)return!1;const b=h.unproject(g),T=h.getFreeCameraOptions();if(!T.position)return!1;const C=T.position.toLngLat();return C.distanceTo(b)<.9*C.distanceTo(this._lngLat)}_evaluateOpacity(){const h=this._map;if(!h)return;const g=this._pos;if(!g||g.x<0||g.x>h.transform.width||g.y<0||g.y>h.transform.height)return void this._clearFadeTimer();const b=h.unproject(g);let T;h._showingGlobe()&&o.isLngLatBehindGlobe(h.transform,this._lngLat)?T=0:(T=1-h._queryFogOpacity(b),h.transform._terrainEnabled()&&h.getTerrain()&&this._behindTerrain()&&(T*=this._occludedOpacity)),this._element.style.opacity=`${T}`,this._element.style.pointerEvents=T>0?"auto":"none",this._popup&&this._popup._setOpacity(T),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const h=this._pos;if(!h||!this._map)return;const g=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${h.x}px,${h.y}px)
            ${xh[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${g.x}px,${g.y}px)
        `}_calculateXYTransform(){const h=this._pos,g=this._map,b=this.getPitchAlignment();if(!g||!h||b!=="map")return"";if(!g._showingGlobe()){const F=g.getPitch();return F?`rotateX(${F}deg)`:""}const T=o.radToDeg(o.globeTiltAtLngLat(g.transform,this._lngLat)),C=h.sub(o.globeCenterToScreenPoint(g.transform)),O=Math.abs(C.x)+Math.abs(C.y);if(O===0)return"";const R=T/O;return`rotateX(${-C.y*R}deg) rotateY(${C.x*R}deg)`}_calculateZTransform(){const h=this._pos,g=this._map;if(!g||!h)return"";let b=0;const T=this.getRotationAlignment();if(T==="map")if(g._showingGlobe()){const C=g.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),O=g.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(C);b=o.radToDeg(Math.atan2(O.y,O.x))-90}else b=-g.getBearing();else if(T==="horizon"){const C=o.smoothstep(4,6,g.getZoom()),O=o.globeCenterToScreenPoint(g.transform);O.y+=C*g.transform.height;const R=h.sub(O),F=o.radToDeg(Math.atan2(R.y,R.x));b=(F>90?F-270:F+90)*(1-C)}return b+=this._rotation,b?`rotateZ(${b}deg)`:""}_update(h){o.window.cancelAnimationFrame(this._updateFrameId);const g=this._map;g&&(g.transform.renderWorldCopies&&(this._lngLat=Mf(this._lngLat,this._pos,g.transform)),this._pos=g.project(this._lngLat),h===!0?this._updateFrameId=o.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),g._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(g._showingGlobe()||g.getTerrain()||g.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(h){return this._offset=o.Point.convert(h),this._update(),this}_onMove(h){const g=this._map;if(!g)return;const b=this._pointerdownPos,T=this._positionDelta;if(b&&T){if(!this._isDragging){const C=this._clickTolerance||g._clickTolerance;if(h.point.dist(b)<C)return;this._isDragging=!0}this._pos=h.point.sub(T),this._lngLat=g.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const h=this._map;h&&(h.off("mousemove",this._onMove),h.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(h){const g=this._map,b=this._pos;g&&b&&this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(b),this._pointerdownPos=h.point,this._state="pending",g.on("mousemove",this._onMove),g.on("touchmove",this._onMove),g.once("mouseup",this._onUp),g.once("touchend",this._onUp))}setDraggable(h){this._draggable=!!h;const g=this._map;return g&&(h?(g.on("mousedown",this._addDragHandler),g.on("touchstart",this._addDragHandler)):(g.off("mousedown",this._addDragHandler),g.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(h){return this._rotation=h||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(h){return this._rotationAlignment=h||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(h){return this._pitchAlignment=h||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(h){return this._occludedOpacity=h||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const kv={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},DE=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function W1(v=new o.Point(0,0),h="bottom"){if(typeof v=="number"){const g=Math.round(Math.sqrt(.5*Math.pow(v,2)));switch(h){case"top":return new o.Point(0,v);case"top-left":return new o.Point(g,g);case"top-right":return new o.Point(-g,g);case"bottom":return new o.Point(0,-v);case"bottom-left":return new o.Point(g,-g);case"bottom-right":return new o.Point(-g,-g);case"left":return new o.Point(v,0);case"right":return new o.Point(-v,0)}return new o.Point(0,0)}return v instanceof o.Point||Array.isArray(v)?o.Point.convert(v):o.Point.convert(v[h]||[0,0])}class Nv{constructor(h){this.jumpTo(h)}getValue(h){if(h<=this._startTime)return this._start;if(h>=this._endTime)return this._end;const g=o.easeCubicInOut((h-this._startTime)/(this._endTime-this._startTime));return this._start*(1-g)+this._end*g}isEasing(h){return h>=this._startTime&&h<=this._endTime}jumpTo(h){this._startTime=-1/0,this._endTime=-1/0,this._start=h,this._end=h}easeTo(h,g,b){this._start=this.getValue(g),this._end=h,this._startTime=g,this._endTime=g+b}}const H1={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Y1={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},RE={showCompass:!0,showZoom:!0,visualizePitch:!1};class kE{constructor(h,g,b=!1){this._clickTolerance=10,this.element=g,this.mouseRotate=new Pv({clickTolerance:h.dragRotate._mouseRotate._clickTolerance}),this.map=h,b&&(this.mousePitch=new Av({clickTolerance:h.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),g.addEventListener("mousedown",this.mousedown),g.addEventListener("touchstart",this.touchstart,{passive:!1}),g.addEventListener("touchmove",this.touchmove),g.addEventListener("touchend",this.touchend),g.addEventListener("touchcancel",this.reset)}down(h,g){this.mouseRotate.mousedown(h,g),this.mousePitch&&this.mousePitch.mousedown(h,g),z()}move(h,g){const b=this.map,T=this.mouseRotate.mousemoveWindow(h,g),C=T&&T.bearingDelta;if(C&&b.setBearing(b.getBearing()+C),this.mousePitch){const O=this.mousePitch.mousemoveWindow(h,g),R=O&&O.pitchDelta;R&&b.setPitch(b.getPitch()+R)}}off(){const h=this.element;h.removeEventListener("mousedown",this.mousedown),h.removeEventListener("touchstart",this.touchstart,{passive:!1}),h.removeEventListener("touchmove",this.touchmove),h.removeEventListener("touchend",this.touchend),h.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){M(),o.window.removeEventListener("mousemove",this.mousemove),o.window.removeEventListener("mouseup",this.mouseup)}mousedown(h){this.down(o.extend({},h,{ctrlKey:!0,preventDefault:()=>h.preventDefault()}),q(this.element,h)),o.window.addEventListener("mousemove",this.mousemove),o.window.addEventListener("mouseup",this.mouseup)}mousemove(h){this.move(h,q(this.element,h))}mouseup(h){this.mouseRotate.mouseupWindow(h),this.mousePitch&&this.mousePitch.mouseupWindow(h),this.offTemp()}touchstart(h){h.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Y(this.element,h.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>h.preventDefault()},this._startPos))}touchmove(h){h.targetTouches.length!==1?this.reset():(this._lastPos=Y(this.element,h.targetTouches)[0],this.move({preventDefault:()=>h.preventDefault()},this._lastPos))}touchend(h){h.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Fv={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Bv={maxWidth:100,unit:"metric"},zv={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Lf={version:o.version,supported:p,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends Zg{constructor(v){if(o.LivePerformanceUtils.mark(o.PerformanceMarkers.create),(v=o.extend({},Y1,v)).minZoom!=null&&v.maxZoom!=null&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(v.minPitch!=null&&v.maxPitch!=null&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(v.minPitch!=null&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(v.maxPitch!=null&&v.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(v.antialias&&o.isSafariWithAntialiasingBug(o.window)&&(v.antialias=!1,o.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new If(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies),v),this._interactive=v.interactive,this._minTileCacheSize=v.minTileCacheSize,this._maxTileCacheSize=v.maxTileCacheSize,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._useWebGL2=v.useWebGL2,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=v.crossSourceCollisions,this._collectResourceTiming=v.collectResourceTiming,this._optimizeForTerrain=v.optimizeForTerrain,this._language=this._parseLanguage(v.language),this._worldview=v.worldview,this._renderTaskQueue=new Rv,this._domRenderTaskQueue=new Rv,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.uniqueId(),this._locale=o.extend({},H1,v.locale),this._clickTolerance=v.clickTolerance,this._cooperativeGestures=v.cooperativeGestures,this._performanceMetricsCollection=v.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Nv(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new o.RequestManager(v.transformRequest,v.accessToken,v.testMode),this._silenceAuthErrors=!!v.testMode,typeof v.container=="string"){if(this._container=o.window.document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof o.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(this._container.childNodes.length>0&&o.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),v.maxBounds&&this.setMaxBounds(v.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1),o.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Xl(this,v),this._localFontFamily=v.localFontFamily,this._localIdeographFontFamily=v.localIdeographFontFamily,v.style&&this.setStyle(v.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),v.projection&&this.setProjection(v.projection),this._hash=v.hash&&new Sv(typeof v.hash=="string"&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,o.extend({},v.fitBoundsOptions,{duration:0})))),this.resize(),v.attributionControl&&this.addControl(new nn({customAttribution:v.customAttribution})),this._logoControl=new Dv,this.addControl(this._logoControl,v.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new o.Event(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new o.Event(`${h.dataType}dataloading`,h))})}_getMapId(){return this._mapId}addControl(v,h){if(h===void 0&&(h=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const g=v.onAdd(this);this._controls.push(v);const b=this._controlPositions[h];return h.indexOf("bottom")!==-1?b.insertBefore(g,b.firstChild):b.appendChild(g),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const h=this._controls.indexOf(v);return h>-1&&this._controls.splice(h,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(v){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const h=!this._moving;return h&&this.fire(new o.Event("movestart",v)).fire(new o.Event("move",v)),this.fire(new o.Event("resize",v)),h&&this.fire(new o.Event("moveend",v)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(v){return this.transform.setMaxBounds(o.LngLatBounds.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v?this.setZoom(v):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v?this.setZoom(v):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v?this.setPitch(v):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v?this.setPitch(v):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(v){return v==="auto"?o.window.navigator.language:Array.isArray(v)?v.length===0?void 0:v.map(h=>h==="auto"?o.window.navigator.language:h):v}setLanguage(v){const h=this._parseLanguage(v);if(!this.style||h===this._language)return this;this._language=h,this.style._reloadSources();for(const g of this._controls)g._setLanguage&&g._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(v){return this.style&&v!==this._worldview?(this._worldview=v,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(v){return this._lazyInitEmptyStyle(),v?typeof v=="string"&&(v={name:v}):v=null,this._useExplicitProjection=!!v,this._prioritizeAndUpdateProjection(v,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const v=this.transform,h=v.projection.name;let g;h==="globe"&&v.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?(v.setMercatorFromTransition(),g=!0):h==="mercator"&&v.zoom<o.GLOBE_ZOOM_THRESHOLD_MAX&&(v.setProjection({name:"globe"}),g=!0),g&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(v,h){return this._updateProjection(v||h||{name:"mercator"})}_updateProjection(v){let h;if(h=v.name==="globe"&&this.transform.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(v),this.style.applyProjectionUpdate(),h){this.painter.clearBackgroundTiles();for(const g in this.style._sourceCaches)this.style._sourceCaches[g].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(v){return this.transform.locationPoint3D(o.LngLat.convert(v))}unproject(v){return this.transform.pointLocation3D(o.Point.convert(v))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(v,h,g){if(v==="mouseenter"||v==="mouseover"){let b=!1;const T=O=>{const R=h.filter(Z=>this.getLayer(Z)),F=R.length?this.queryRenderedFeatures(O.point,{layers:R}):[];F.length?b||(b=!0,g.call(this,new Ko(v,this,O.originalEvent,{features:F}))):b=!1},C=()=>{b=!1};return{layers:new Set(h),listener:g,delegates:{mousemove:T,mouseout:C}}}if(v==="mouseleave"||v==="mouseout"){let b=!1;const T=O=>{const R=h.filter(F=>this.getLayer(F));(R.length?this.queryRenderedFeatures(O.point,{layers:R}):[]).length?b=!0:b&&(b=!1,g.call(this,new Ko(v,this,O.originalEvent)))},C=O=>{b&&(b=!1,g.call(this,new Ko(v,this,O.originalEvent)))};return{layers:new Set(h),listener:g,delegates:{mousemove:T,mouseout:C}}}{const b=T=>{const C=h.filter(R=>this.getLayer(R)),O=C.length?this.queryRenderedFeatures(T.point,{layers:C}):[];O.length&&(T.features=O,g.call(this,T),delete T.features)};return{layers:new Set(h),listener:g,delegates:{[v]:b}}}}on(v,h,g){if(g===void 0)return super.on(v,h);Array.isArray(h)||(h=[h]);const b=this._createDelegatedListener(v,h,g);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(b);for(const T in b.delegates)this.on(T,b.delegates[T]);return this}once(v,h,g){if(g===void 0)return super.once(v,h);Array.isArray(h)||(h=[h]);const b=this._createDelegatedListener(v,h,g);for(const T in b.delegates)this.once(T,b.delegates[T]);return this}off(v,h,g){if(g===void 0)return super.off(v,h);h=new Set(Array.isArray(h)?h:[h]);const b=(C,O)=>{if(C.size!==O.size)return!1;for(const R of C)if(!O.has(R))return!1;return!0},T=this._delegatedListeners?this._delegatedListeners[v]:void 0;return T&&(C=>{for(let O=0;O<C.length;O++){const R=C[O];if(R.listener===g&&b(R.layers,h)){for(const F in R.delegates)this.off(F,R.delegates[F]);return C.splice(O,1),this}}})(T),this}queryRenderedFeatures(v,h){return this.style?(h!==void 0||v===void 0||v instanceof o.Point||Array.isArray(v)||(h=v,v=void 0),this.style.queryRenderedFeatures(v=v||[[0,0],[this.transform.width,this.transform.height]],h=h||{},this.transform)):[]}querySourceFeatures(v,h){return this.style.querySourceFeatures(v,h)}isPointOnSurface(v){const{name:h}=this.transform.projection;return h!=="globe"&&h!=="mercator"&&o.warnOnce(`${h} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(o.Point.convert(v))}setStyle(v,h){return(h=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},h)).diff!==!1&&h.localIdeographFontFamily===this._localIdeographFontFamily&&h.localFontFamily===this._localFontFamily&&this.style&&v?(this._diffStyle(v,h),this):(this._localIdeographFontFamily=h.localIdeographFontFamily,this._localFontFamily=h.localFontFamily,this._updateStyle(v,h))}_getUIString(v){const h=this._locale[v];if(h==null)throw new Error(`Missing UI string '${v}'`);return h}_updateStyle(v,h){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),v&&(this.style=new ql(this,h||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v):this.style.loadJSON(v)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ql(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,h){if(typeof v=="string"){const g=this._requestManager.normalizeStyleURL(v),b=this._requestManager.transformRequest(g,o.ResourceType.Style);o.getJSON(b,(T,C)=>{T?this.fire(new o.ErrorEvent(T)):C&&this._updateDiff(C,h)})}else typeof v=="object"&&this._updateDiff(v,h)}_updateDiff(v,h){try{this.style.setState(v)&&this._update(!0)}catch(g){o.warnOnce(`Unable to perform style diff: ${g.message||g.error||g}.  Rebuilding the style from scratch.`),this._updateStyle(v,h)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.warnOnce("There is no style added to the map."),!1)}addSource(v,h){return this._lazyInitEmptyStyle(),this.style.addSource(v,h),this._update(!0)}isSourceLoaded(v){return!!this.style&&this.style._isSourceCacheLoaded(v)}areTilesLoaded(){const v=this.style&&this.style._sourceCaches;for(const h in v){const g=v[h]._tiles;for(const b in g){const T=g[b];if(T.state!=="loaded"&&T.state!=="errored")return!1}}return!0}addSourceType(v,h,g){this._lazyInitEmptyStyle(),this.style.addSourceType(v,h,g)}removeSource(v){return this.style.removeSource(v),this._updateTerrain(),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,h,{pixelRatio:g=1,sdf:b=!1,stretchX:T,stretchY:C,content:O}={}){if(this._lazyInitEmptyStyle(),h instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&h instanceof o.window.ImageBitmap){const{width:R,height:F,data:Z}=o.exported.getImageData(h);this.style.addImage(v,{data:new o.RGBAImage({width:R,height:F},Z),pixelRatio:g,stretchX:T,stretchY:C,content:O,sdf:b,version:0})}else if(h.width===void 0||h.height===void 0)this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:R,height:F}=h,Z=h;this.style.addImage(v,{data:new o.RGBAImage({width:R,height:F},new Uint8Array(Z.data)),pixelRatio:g,stretchX:T,stretchY:C,content:O,sdf:b,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,v)}}updateImage(v,h){const g=this.style.getImage(v);if(!g)return void this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const b=h instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&h instanceof o.window.ImageBitmap?o.exported.getImageData(h):h,{width:T,height:C}=b;T!==void 0&&C!==void 0?T===g.data.width&&C===g.data.height?(g.data.replace(b.data,!(h instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&h instanceof o.window.ImageBitmap)),this.style.updateImage(v,g)):this.fire(new o.ErrorEvent(new Error(`The width and height of the updated image (${T}, ${C})
                must be that same as the previous version of the image
                (${g.data.width}, ${g.data.height})`))):this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v,h){o.getImage(this._requestManager.transformRequest(v,o.ResourceType.Image),(g,b)=>{h(g,b instanceof o.window.HTMLImageElement?o.exported.getImageData(b):b)})}listImages(){return this.style.listImages()}addLayer(v,h){return this._lazyInitEmptyStyle(),this.style.addLayer(v,h),this._update(!0)}moveLayer(v,h){return this.style.moveLayer(v,h),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}setLayerZoomRange(v,h,g){return this.style.setLayerZoomRange(v,h,g),this._update(!0)}setFilter(v,h,g={}){return this.style.setFilter(v,h,g),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,h,g,b={}){return this.style.setPaintProperty(v,h,g,b),this._update(!0)}getPaintProperty(v,h){return this.style.getPaintProperty(v,h)}setLayoutProperty(v,h,g,b={}){return this.style.setLayoutProperty(v,h,g,b),this._update(!0)}getLayoutProperty(v,h){return this.style.getLayoutProperty(v,h)}setLight(v,h={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,h),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(v){return this._lazyInitEmptyStyle(),!v&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(v),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(v){return this._lazyInitEmptyStyle(),this.style.setFog(v),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(v){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.LngLat.convert(v),this.transform):0}setFeatureState(v,h){return this.style.setFeatureState(v,h),this._update()}removeFeatureState(v,h){return this.style.removeFeatureState(v,h),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}_updateContainerDimensions(){if(!this._container)return;const v=this._container.getBoundingClientRect().width||400,h=this._container.getBoundingClientRect().height||300;let g,b,T,C=this._container;for(;C&&(!b||!T);){const O=o.window.getComputedStyle(C).transform;O&&O!=="none"&&(g=O.match(/matrix.*\((.+)\)/)[1].split(", "),g[0]&&g[0]!=="0"&&g[0]!=="1"&&(b=g[0]),g[3]&&g[3]!=="0"&&g[3]!=="1"&&(T=g[3])),C=C.parentElement}this._containerWidth=b?Math.abs(v/b):v,this._containerHeight=T?Math.abs(h/T):h}_detectMissingCSS(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const v=this._container;v.classList.add("mapboxgl-map"),(this._missingCSSCanary=w("div","mapboxgl-canary",v)).style.visibility="hidden",this._detectMissingCSS();const h=this._canvasContainer=w("div","mapboxgl-canvas-container",v);this._interactive&&h.classList.add("mapboxgl-interactive"),this._canvas=w("canvas","mapboxgl-canvas",h),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const g=this._controlContainer=w("div","mapboxgl-control-container",v),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(T=>{b[T]=w("div",`mapboxgl-ctrl-${T}`,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,h){const g=o.exported.devicePixelRatio||1;this._canvas.width=g*Math.ceil(v),this._canvas.height=g*Math.ceil(h),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${h}px`}_addMarker(v){this._markers.push(v)}_removeMarker(v){const h=this._markers.indexOf(v);h!==-1&&this._markers.splice(h,1)}_addPopup(v){this._popups.push(v)}_removePopup(v){const h=this._popups.indexOf(v);h!==-1&&this._popups.splice(h,1)}_setupPainter(){const v=o.extend({},p.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),h=this._useWebGL2&&this._canvas.getContext("webgl2",v),g=h||this._canvas.getContext("webgl",v)||this._canvas.getContext("experimental-webgl",v);g?(this._useWebGL2&&!h&&o.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),o.storeAuthState(g,!0),this.painter=new Sf(g,this.transform,!!h),this.on("data",b=>{b.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.exported$1.testSupport(g)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(v){v.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:v}))}_contextRestored(v){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:v}))}_onMapScroll(v){if(v.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_requestDomTask(v){!this.loaded()||this.loaded()&&!this.isMoving()?v():this._domRenderTaskQueue.add(v)}_render(v){let h;const g=this.painter.context.extTimerQuery,b=o.exported.now();if(this.listens("gpu-timing-frame")&&(h=g.createQueryEXT(),g.beginQueryEXT(g.TIME_ELAPSED_EXT,h)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],o.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],o.window.performance.now())),this._renderTaskQueue.run(v),this._domRenderTaskQueue.run(v),this._removed)return;this._updateProjectionTransition();const T=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const R=this.transform.zoom,F=this.transform.pitch,Z=o.exported.now(),j=new o.EvaluationParameters(R,{now:Z,fadeDuration:T,pitch:F,transition:this.style.getTransition()});this.style.update(j)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let C=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),C=this._updateAverageElevation(b),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):C=this._updateAverageElevation(b),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,T,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:T,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),h){const R=o.exported.now()-b;g.endQueryEXT(g.TIME_ELAPSED_EXT,h),setTimeout(()=>{const F=g.getQueryObjectEXT(h,g.QUERY_RESULT_EXT)/1e6;g.deleteQueryEXT(h),this.fire(new o.Event("gpu-timing-frame",{cpuTime:R,gpuTime:F})),o.window.performance.mark("frame-gpu",{startTime:b,detail:{gpuTime:F}})},50)}if(this.listens("gpu-timing-layer")){const R=this.painter.collectGpuTimers();setTimeout(()=>{const F=this.painter.queryGpuTimers(R);this.fire(new o.Event("gpu-timing-layer",{layerTimes:F}))},50)}if(this.listens("gpu-timing-deferred-render")){const R=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const F=this.painter.queryGpuTimeDeferredRender(R);this.fire(new o.Event("gpu-timing-deferred-render",{gpuTime:F}))},50)}const O=this._sourcesDirty||this._styleDirty||this._placementDirty||C;if(O||this._repaint)this.triggerRepaint();else{const R=!this.isMoving()&&this.loaded();if(R&&(C=this._updateAverageElevation(b,!0)),C)this.triggerRepaint();else if(this._triggerFrame(!1),R&&(this.fire(new o.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const F=this._calculateSpeedIndex();this.fire(new o.Event("speedindexcompleted",{speedIndex:F})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||O||(this._fullyLoaded=!0,o.LivePerformanceUtils.mark(o.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&o.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(v){for(const h of this._markers)v&&!this.getRenderWorldCopies()&&(h._lngLat=h._lngLat.wrap()),h._update();for(const h of this._popups)!v||this.getRenderWorldCopies()||h._trackPointer||(h._lngLat=h._lngLat.wrap()),h._update()}_updateAverageElevation(v,h=!1){const g=b=>(this.transform.averageElevation=b,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&g(0);if((h||v-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(v)){const b=this.transform.averageElevation;let T=this.transform.sampleAverageElevation(),C=!1;this.transform.elevation&&(C=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(T)?T=0:this._averageElevationLastSampledAt=v;const O=Math.abs(b-T);if(O>1){if(this._isInitialLoad||C)return this._averageElevation.jumpTo(T),g(T);this._averageElevation.easeTo(T,v,300)}else if(O>1e-4)return this._averageElevation.jumpTo(T),g(T)}return!!this._averageElevation.isEasing(v)&&g(this._averageElevation.getValue(v))}_authenticate(){o.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,v=>{if(v&&(v.message===o.AUTH_ERR_MSG||v.status===401)){const h=this.painter.context.gl;o.storeAuthState(h,!1),this._logoControl instanceof Dv&&this._logoControl._updateLogo(),h&&h.clear(h.DEPTH_BUFFER_BIT|h.COLOR_BUFFER_BIT|h.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),o.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const v=this._isDragging();this.painter.updateTerrain(this.style,v)}_calculateSpeedIndex(){const v=this.painter.canvasCopy(),h=this.painter.getCanvasCopiesAndTimestamps();h.timeStamps.push(performance.now());const g=this.painter.context.gl,b=g.createFramebuffer();function T(C){g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,C,0);const O=new Uint8Array(g.drawingBufferWidth*g.drawingBufferHeight*4);return g.readPixels(0,0,g.drawingBufferWidth,g.drawingBufferHeight,g.RGBA,g.UNSIGNED_BYTE,O),O}return g.bindFramebuffer(g.FRAMEBUFFER,b),this._canvasPixelComparison(T(v),h.canvasCopies.map(T),h.timeStamps)}_canvasPixelComparison(v,h,g){let b=g[1]-g[0];const T=v.length/4;for(let C=0;C<h.length;C++){const O=h[C];let R=0;for(let F=0;F<O.length;F+=4)O[F]===v[F]&&O[F+1]===v[F+1]&&O[F+2]===v[F+2]&&O[F+3]===v[F+3]&&(R+=1);b+=(g[C+2]-g[C+1])*(1-R/T)}return b}remove(){this._hash&&this._hash.remove();for(const h of this._controls)h.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1),o.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const v=this.painter.context.gl.getExtension("WEBGL_lose_context");v&&v.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),o.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(v){this._renderNextFrame=this._renderNextFrame||v,this.style&&!this._frame&&(this._frame=o.exported.frame(h=>{const g=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,g&&this._render(h)}))}_preloadTiles(v){const h=this.style?Object.values(this.style._sourceCaches):[];return o.asyncAll(h,(g,b)=>g._preloadTiles(v,b),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(v){this._trackResize&&this.resize({originalEvent:v})._update()}_onVisibilityChange(){o.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(v){this._showTerrainWireframe!==v&&(this._showTerrainWireframe=v,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(v){this._speedIndexTiming!==v&&(this._speedIndexTiming=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(v){this._showTileAABBs!==v&&(this._showTileAABBs=v,v&&this._update())}_setCacheLimits(v,h){o.setCacheLimits(v,h)}get version(){return o.version}},NavigationControl:class{constructor(v){this.options=o.extend({},RE,v),this._container=w("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",h=>h.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",h=>{this._map&&this._map.zoomIn({},{originalEvent:h})}),w("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",h=>{this._map&&this._map.zoomOut({},{originalEvent:h})}),w("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",h=>{const g=this._map;g&&(this.options.visualizePitch?g.resetNorthPitch({},{originalEvent:h}):g.resetNorth({},{originalEvent:h}))}),this._compassIcon=w("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const v=this._map;if(!v)return;const h=v.getZoom(),g=h===v.getMaxZoom(),b=h===v.getMinZoom();this._zoomInButton.disabled=g,this._zoomOutButton.disabled=b,this._zoomInButton.setAttribute("aria-disabled",g.toString()),this._zoomOutButton.setAttribute("aria-disabled",b.toString())}_rotateCompassArrow(){const v=this._map;if(!v)return;const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(v.transform.pitch*(Math.PI/180)),.5)}) rotateX(${v.transform.pitch}deg) rotateZ(${v.transform.angle*(180/Math.PI)}deg)`:`rotate(${v.transform.angle*(180/Math.PI)}deg)`;v._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=h)})}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),v.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&v.on("pitch",this._rotateCompassArrow),v.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new kE(v,this._compass,this.options.visualizePitch)),this._container}onRemove(){const v=this._map;v&&(this._container.remove(),this.options.showZoom&&v.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&v.off("pitch",this._rotateCompassArrow),v.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(v,h){const g=w("button",v,this._container);return g.type="button",g.addEventListener("click",h),g}_setButtonTitle(v,h){if(!this._map)return;const g=this._map._getUIString(`NavigationControl.${h}`);v.setAttribute("aria-label",g),v.firstElementChild&&v.firstElementChild.setAttribute("title",g)}},GeolocateControl:class extends o.Evented{constructor(v){super(),this.options=o.extend({geolocation:o.window.navigator.geolocation},Fv,v),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Cf(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(v){return this._map=v,this._container=w("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(v){const h=(g=!!this.options.geolocation)=>{this._supportsGeolocation=g,v(g)};this._supportsGeolocation!==void 0?v(this._supportsGeolocation):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(g=>h(g.state!=="denied")).catch(()=>h()):h()}_isOutOfMapMaxBounds(v){const h=this._map.getMaxBounds(),g=v.coords;return!!h&&(g.longitude<h.getWest()||g.longitude>h.getEast()||g.latitude<h.getSouth()||g.latitude>h.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(v){if(this._map){if(this._isOutOfMapMaxBounds(v))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",v)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=v,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(v),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(v),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",v)),this._finish()}}_updateCamera(v){const h=new o.LngLat(v.coords.longitude,v.coords.latitude),g=v.coords.accuracy,b=this._map.getBearing(),T=o.extend({bearing:b},this.options.fitBoundsOptions);this._map.fitBounds(h.toBounds(g),T,{geolocateSource:!0})}_updateMarker(v){if(v){const h=new o.LngLat(v.coords.longitude,v.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=v.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const v=this._map.transform,h=o.mercatorZfromAltitude(1,v._center.lat)*v.worldSize,g=Math.ceil(2*this._accuracy*h);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(v){if(this._map){if(this.options.trackUserLocation)if(v.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(v.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",v)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(v){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",h=>h.preventDefault()),this._geolocateButton=w("button","mapboxgl-ctrl-geolocate",this._container),w("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",v===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}else{const h=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=w("div","mapboxgl-user-location"),this._dotElement.appendChild(w("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(w("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Zt({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=w("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Zt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",h=>{h.geolocateSource||this._watchState!=="ACTIVE_LOCK"||h.originalEvent&&h.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}}_onDeviceOrientation(v){this._userLocationDotMarker&&(v.webkitCompassHeading?this._heading=v.webkitCompassHeading:v.absolute===!0&&(this._heading=-1*v.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(v={maximumAge:6e5,timeout:0},this._noTimeout=!0):(v=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,v),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const v=()=>{o.window.addEventListener("ondeviceorientationabsolute"in o.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};o.window.DeviceMotionEvent!==void 0&&typeof o.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(h=>{h==="granted"&&v()}).catch(console.error):v()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),o.window.removeEventListener("deviceorientation",this._onDeviceOrientation),o.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:nn,ScaleControl:class{constructor(v){this.options=o.extend({},Bv,v),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),o.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const v=this.options.maxWidth||100,h=this._map,g=h._containerHeight/2,b=h._containerWidth/2-v/2,T=h.unproject([b,g]),C=h.unproject([b+v,g]),O=T.distanceTo(C);if(this.options.unit==="imperial"){const R=3.2808*O;R>5280?this._setScale(v,R/5280,"mile"):this._setScale(v,R,"foot")}else this.options.unit==="nautical"?this._setScale(v,O/1852,"nautical-mile"):O>=1e3?this._setScale(v,O/1e3,"kilometer"):this._setScale(v,O,"meter")}_setScale(v,h,g){this._map._requestDomTask(()=>{const b=function(C){const O=Math.pow(10,`${Math.floor(C)}`.length-1);let R=C/O;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(F){const Z=Math.pow(10,Math.ceil(-Math.log(F)/Math.LN10));return Math.round(F*Z)/Z}(R),O*R}(h),T=b/h;this._container.innerHTML=this._isNumberFormatSupported&&g!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:g}).format(b):`${b}&nbsp;${zv[g]}`,this._container.style.width=v*T+"px"})}onAdd(v){return this._map=v,this._language=v.getLanguage(),this._container=w("div","mapboxgl-ctrl mapboxgl-ctrl-scale",v.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(v){this._language=v,this._update()}setUnit(v){this.options.unit=v,this._update()}},FullscreenControl:class{constructor(v){this._fullscreen=!1,v&&v.container&&(v.container instanceof o.window.HTMLElement?this._container=v.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in o.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=w("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!o.window.document.fullscreenEnabled&&!o.window.document.webkitFullscreenEnabled)}_setupUI(){const v=this._fullscreenButton=w("button","mapboxgl-ctrl-fullscreen",this._controlContainer);w("span","mapboxgl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",v)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(o.window.document.fullscreenElement||o.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.Evented{constructor(v){super(),this.options=o.extend(Object.create(kv),v),o.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(v&&v.className?v.className.trim().split(/\s+/):[])}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&v.on("preclick",this._onClose),this.options.closeOnMove&&v.on("move",this._onClose),v.on("remove",this.remove),this._update(),v._addPopup(this),this._focusFirstElement(),this._trackPointer?(v.on("mousemove",this._onMouseEvent),v.on("mouseup",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")):v.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const v=this._map;return v&&(v.off("move",this._update),v.off("move",this._onClose),v.off("preclick",this._onClose),v.off("click",this._onClose),v.off("remove",this.remove),v.off("mousemove",this._onMouseEvent),v.off("mouseup",this._onMouseEvent),v.off("drag",this._onMouseEvent),v._canvasContainer&&v._canvasContainer.classList.remove("mapboxgl-track-pointer"),v._removePopup(this),this._map=void 0),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(v){this._lngLat=o.LngLat.convert(v),this._pos=null,this._trackPointer=!1,this._update();const h=this._map;return h&&(h.on("move",this._update),h.off("mousemove",this._onMouseEvent),h._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const v=this._map;return v&&(v.off("move",this._update),v.on("mousemove",this._onMouseEvent),v.on("drag",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(o.window.document.createTextNode(v))}setHTML(v){const h=o.window.document.createDocumentFragment(),g=o.window.document.createElement("body");let b;for(g.innerHTML=v;b=g.firstChild,b;)h.appendChild(b);return this.setDOMContent(h)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){let h=this._content;if(h)for(;h.hasChildNodes();)h.firstChild&&h.removeChild(h.firstChild);else h=this._content=w("div","mapboxgl-popup-content",this._container||void 0);if(h.appendChild(v),this.options.closeButton){const g=this._closeButton=w("button","mapboxgl-popup-close-button",h);g.type="button",g.setAttribute("aria-label","Close popup"),g.setAttribute("aria-hidden","true"),g.innerHTML="&#215;",g.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(v){return this._classList.add(v),this._updateClassList(),this}removeClassName(v){return this._classList.delete(v),this._updateClassList(),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){let h;return this._classList.delete(v)?h=!1:(this._classList.add(v),h=!0),this._updateClassList(),h}_onMouseEvent(v){this._update(v.point)}_getAnchor(v){if(this.options.anchor)return this.options.anchor;const h=this._map,g=this._container,b=this._pos;if(!h||!g||!b)return"bottom";const T=g.offsetWidth,C=g.offsetHeight,O=b.x<T/2,R=b.x>h.transform.width-T/2;if(b.y+v<C)return O?"top-left":R?"top-right":"top";if(b.y>h.transform.height-C){if(O)return"bottom-left";if(R)return"bottom-right"}return O?"left":R?"right":"bottom"}_updateClassList(){const v=this._container;if(!v)return;const h=[...this._classList];h.push("mapboxgl-popup"),this._anchor&&h.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&h.push("mapboxgl-popup-track-pointer"),v.className=h.join(" ")}_update(v){const h=this._map,g=this._content;if(!h||!this._lngLat&&!this._trackPointer||!g)return;let b=this._container;if(b||(b=this._container=w("div","mapboxgl-popup",h.getContainer()),this._tip=w("div","mapboxgl-popup-tip",b),b.appendChild(g)),this.options.maxWidth&&b.style.maxWidth!==this.options.maxWidth&&(b.style.maxWidth=this.options.maxWidth),h.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Mf(this._lngLat,this._pos,h.transform)),!this._trackPointer||v){const T=this._pos=this._trackPointer&&v?v:h.project(this._lngLat),C=W1(this.options.offset),O=this._anchor=this._getAnchor(C.y),R=W1(this.options.offset,O),F=T.add(R).round();h._requestDomTask(()=>{this._container&&O&&(this._container.style.transform=`${xh[O]} translate(${F.x}px,${F.y}px)`)})}if(!this._marker&&h._showingGlobe()){const T=o.isLngLatBehindGlobe(h.transform,this._lngLat)?0:1;this._setOpacity(T)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(DE);v&&v.focus()}_onClose(){this.remove()}_setOpacity(v){this._container&&(this._container.style.opacity=`${v}`),this._content&&(this._content.style.pointerEvents=v?"auto":"none")}},Marker:Zt,Style:ql,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.Point,MercatorCoordinate:o.MercatorCoordinate,FreeCameraOptions:D1,Evented:o.Evented,config:o.config,prewarm:function(){df().acquire(Gl)},clearPrewarmedResources:function(){const v=Xa;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(Gl),Xa=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(v){o.config.ACCESS_TOKEN=v},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(v){o.config.API_URL=v},get workerCount(){return Ho.workerCount},set workerCount(v){Ho.workerCount=v},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(v){o.config.MAX_PARALLEL_IMAGE_REQUESTS=v},clearStorage(v){o.clearTileCache(v)},workerUrl:"",workerClass:null,setNow:o.exported.setNow,restoreNow:o.exported.restoreNow};return Lf});var l=i;return l})})(Ik);var NV=Ik.exports;const eT=Vs(NV);function La(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Kf={paints:"fill-antialias,fill-opacity,fill-color,fill-outline-color,fill-translate,fill-translate-anchor,fill-pattern,fill-extrusion-opacity,fill-extrusion-color,fill-extrusion-translate,fill-extrusion-translate-anchor,fill-extrusion-pattern,fill-extrusion-height,fill-extrusion-base,fill-extrusion-vertical-gradient,line-opacity,line-color,line-translate,line-translate-anchor,line-width,line-gap-width,line-offset,line-blur,line-dasharray,line-pattern,line-gradient,circle-radius,circle-color,circle-blur,circle-opacity,circle-translate,circle-translate-anchor,circle-pitch-scale,circle-pitch-alignment,circle-stroke-width,circle-stroke-color,circle-stroke-opacity,heatmap-radius,heatmap-weight,heatmap-intensity,heatmap-color,heatmap-opacity,icon-opacity,icon-color,icon-halo-color,icon-halo-width,icon-halo-blur,icon-translate,icon-translate-anchor,text-opacity,text-color,text-halo-color,text-halo-width,text-halo-blur,text-translate,text-translate-anchor,raster-opacity,raster-hue-rotate,raster-brightness-min,raster-brightness-max,raster-saturation,raster-contrast,raster-resampling,raster-fade-duration,hillshade-illumination-direction,hillshade-illumination-anchor,hillshade-exaggeration,hillshade-shadow-color,hillshade-highlight-color,hillshade-accent-color,background-color,background-pattern,background-opacity,sky-type,sky-atmosphere-sun,sky-atmosphere-sun-intensity,sky-gradient-center,sky-gradient-radius,sky-gradient,sky-atmosphere-halo-color,sky-atmosphere-color,sky-opacity".split(","),layouts:"visibility,fill-sort-key,circle-sort-key,line-cap,line-join,line-miter-limit,line-round-limit,line-sort-key,symbol-placement,symbol-spacing,symbol-avoid-edges,symbol-sort-key,symbol-z-order,icon-allow-overlap,icon-ignore-placement,icon-optional,icon-rotation-alignment,icon-size,icon-text-fit,icon-text-fit-padding,icon-image,icon-rotate,icon-padding,icon-keep-upright,icon-offset,icon-anchor,icon-pitch-alignment,text-pitch-alignment,text-rotation-alignment,text-field,text-font,text-size,text-max-width,text-line-height,text-letter-spacing,text-justify,text-radial-offset,text-variable-anchor,text-anchor,text-max-angle,text-writing-mode,text-rotate,text-padding,text-keep-upright,text-transform,text-offset,text-allow-overlap,text-ignore-placement,text-optional".split(",")};const tT=e=>e.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`),eI=e=>e.replace(/(^|-)([a-z])/g,(t,n,r)=>`${r.toUpperCase()}`);function FV(e){return Kf.paints.indexOf(e)>=0}function BV(e){return Kf.layouts.indexOf(e)>=0}function zV(e){return Kf.paints.indexOf(e)>=0?"paint":Kf.layouts.indexOf(e)>=0?"layout":"other"}function UV(e){return String(e).match(/\.(geo)?json/)||e.type==="Feature"||e.type==="FeatureCollection"?{type:"geojson",data:e}:String(e).match(/^mapbox:\/\//)?{type:"vector",url:e}:e}const Cb=(e,t)=>Array.isArray(e)?e:e instanceof RegExp?t.getStyle().layers.map(n=>n.id).filter(n=>n.match(e)):e instanceof Function?t.getStyle().layers.filter(n=>e(n)).map(n=>n.id):[e],Ks=e=>function(t,...n){return Cb(t,this.map).forEach(i=>e.call(this,i,...n))},S_=e=>function(t,...n){const i=Cb(t,this.map).map(a=>e.call(this,a,...n));return()=>i.forEach(a=>a())},Pk=["line","fill","circle","symbol","video","raster","fill-extrusion","heatmap","hillshade"];class Tp{constructor(){La(this,"_loaded",!1),La(this,"_mapgl",null),La(this,"map",null),La(this,"hoverFeatureState",S_(function(t,n,r,i,a){if(Array.isArray(n)){let y=n.map(([x,w])=>this.hoverFeatureState(t,x,w));return()=>y.forEach(x=>x())}if(n===void 0){const y=this.getLayerStyle(t);n=y.source,r=y["source-layer"]}let l;const o=y=>{l&&this.map.setFeatureState({source:n,sourceLayer:r,id:l},{hover:y})},f=y=>{const x=y.features[0];x&&x.id===l||(o(!1),x&&(l&&a&&a({...y,oldFeatureId:l}),l=x.id,o(!0),i&&i(y)))},p=y=>{o(!1),y&&y.oldFeatureId&&(y.oldFeatureId=l),l=void 0,a&&a(y)};return this.map.on("mousemove",t,f),this.map.on("mouseleave",t,p),()=>{this.map.off("mousemove",t,f),this.map.off("mouseleave",t,p),p()}})),La(this,"clickLayer",S_(function(t,n){const r=i=>{i.features=this.map.queryRenderedFeatures(i.point,{layers:[t]}),n(i)};return this.map.on("click",t,r),()=>this.map.off("click",t,r)})),La(this,"hoverLayer",S_(function(t,n){const r=i=>{i.features=this.map.queryRenderedFeatures(i.point,{layers:[t]}),n(i)};return this.map.on("click",t,r),()=>this.map.off("click",t,r)})),La(this,"removeLayer",Ks(function(t){const n=r=>{r.error.message.match(/does not exist/)||console.error(r.error)};this.map.once("error",n),this.map.removeLayer(t),this.map.off("error",n)})),La(this,"setProperty",Ks(function(t,n,r){if(typeof n=="object")Object.keys(n).forEach(i=>this.setProperty(t,i,n[i]));else{const i=tT(n);FV(i)?this.map.setPaintProperty(t,i,r):BV(i)&&this.map.setLayoutProperty(t,i,r)}})),La(this,"setLayerStyle",Ks(function(t,n){const r=(l={},o={})=>Object.keys(l).forEach(f=>{f in o||this.setProperty(t,f,void 0)});typeof t=="object"&&!Array.isArray(t)&&t.id&&!n&&(n=t,t=n.id);const i=this.getLayerStyle(t),a=this.properties(n);r(i.paint,a.paint),r(i.layout,a.layout),this.setProperty(t,{...a.paint,...a.layout})})),La(this,"show",Ks(function(t){this.setVisibility(t,"visible")})),La(this,"hide",Ks(function(t){this.setVisibility(t,"none")})),La(this,"toggle",Ks(function(t,n){this.setVisibility(t,n?"visible":"none")})),La(this,"showSource",Ks(function(t){this.setVisibility(this.layersBySource(t),"visible")})),La(this,"hideSource",Ks(function(t){this.setVisibility(this.layersBySource(t),"none")})),La(this,"toggleSource",Ks(function(t,n){this.setVisibility(this.layersBySource(t),n?"visible":"none")})),La(this,"setFilter",Ks(function(t,n){this.map.setFilter(t,n)})),La(this,"removeSource",Ks(function(t){const n=this.layersBySource(t);this.removeLayer(n),this.map.getSource(t)&&this.map.removeSource(t)})),La(this,"setLayerSource",Ks(function(t,n,r){const i=this.map.getStyle().layers,a=i.findIndex(f=>f.id===t),l=i[a],o=i[a+1]&&i[a+1].id;l.source=n,r?l["source-layer"]=r:r!==void 0&&delete l["source-layer"],this.map.removeLayer(t),this._mapAddLayerBefore(l,o)}))}static init(t,n){return t.U=new Tp,t.U._mapgl=n,t.U.map=t,t.U}static async newMap(t,n={},r={}){function i(p,y=[]){p.layers=[...p.layers,...y.map(x=>this.layerStyle(x))]}function a(p,y={}){p.sources={...p.sources,...y}}function l(p,y=x=>x){p=y(p)}function o(p,y={}){Object.keys(y).forEach(x=>{const w=y[x].layers;delete y[x].layers,p.sources[x]=y[x],p.layers=[...p.layers,...w.map(S=>this.layerStyle({source:x,...S}))]})}if(n.style||(n.style={version:8,layers:[],sources:{}}),r.addLayers||r.addSources||r.transformStyle||r.mixStyles){let p=n.style,y;if(typeof p=="string"){const w=p.replace(/^mapbox:\/\/styles\//,"https://api.mapbox.com/styles/v1/");y=await(await fetch(w)).json()}else y=p;const x=new Tp;i.call(x,y,r.addLayers),a(y,r.addSources),l(y,r.transformStyle),o.call(x,y,r.mixStyles),n.style=y}const f=new t.Map(n);return Tp.init(f,t),f}hoverPointer(t){const n=Cb(t,this.map),r=l=>this.map.getCanvas().style.cursor="pointer",i=l=>{this.map.queryRenderedFeatures(l.point,{layers:n}).length===0&&(this.map.getCanvas().style.cursor=a)},a=this.map.getCanvas().style.cursor;for(const l of n)this.map.on("mouseleave",l,i),this.map.on("mouseenter",l,r);return()=>{for(const l of n)this.map.off("mouseenter",l,r),this.map.off("mouseleave",l,i);this.map.getCanvas().style.cursor=a}}hoverPopup(t,n,r={}){if(!this._mapgl)throw"Mapbox GL JS or MapLibre GL JS object required when initialising";const i=new this._mapgl.Popup({closeButton:!1,...r});return S_(function(a,l){const o=p=>{p.features[0]&&(i.setLngLat(p.lngLat),i.setHTML(l(p.features[0],i)),i.addTo(this.map))},f=p=>{i.remove()};return this.map.on("mouseenter",a,o),this.map.on("mouseout",a,f),()=>{this.map.off("mouseenter",a,o),this.map.off("mouseout",a,f),f()}}).call(this,t,n)}clickPopup(t,n,r={}){if(!this._mapgl)throw"Mapbox GL JS or Maplibre GL JS object required when initialising";const i=new this._mapgl.Popup({...r});return S_(function(a,l){const o=f=>{f.features[0]&&(i.setLngLat(f.features[0].geometry.coordinates.slice()),i.setHTML(l(f.features[0],i)),i.addTo(this.map))};return this.map.on("click",a,o),()=>this.map.off("click",a,o)}).call(this,t,n)}clickOneLayer(t,n,r){const i=Cb(t,this.map),a=l=>{let o=!1;for(const f of i){const p=this.map.queryRenderedFeatures(l.point,{layers:[f]});if(p[0])try{n({event:l,layer:f,feature:p[0],features:p})}finally{o=!0;break}}!o&&r&&r(l)};return this.map.on("click",a),()=>this.map.off("click",a)}_mapAddLayerBefore(t,n){n?this.map.addLayer(t,n):this.map.addLayer(t)}addLayer(t,n,r,i,a){return this._mapAddLayerBefore(this.layerStyle(t,n,r,i),a),this._makeSource(n)}add(t,n,r,i,a){if(this._mapAddLayerBefore({...this.properties(i),id:t,type:r,source:UV(n)},a),typeof n=="string")return this._makeSource(n)}setLayer(t,n,r,i,a){const l=this.layerStyle(t,n,r,i),o=this.map.getStyle(),f=o.layers.findIndex(p=>p.id===l.id);if(o.layers.findIndex(p=>p.id===a),f>=0){this.map.removeLayer(l.id);let p=a;!a&&o.layers[f+1]&&(p=o.layers[f+1].id),this.map.addLayer(l,p)}else this.map.addLayer(l,a||void 0);return this._makeSource(n)}addLineLayer(t,n,r){}addFillLayer(t,n,r){}addCircleLayer(t,n,r){}addSymbolLayer(t,n,r){}addVideoLayer(t,n,r){}addRasterLayer(t,n,r){}addFillExtrusionLayer(t,n,r){}addHeatmapLayer(t,n,r){}addHillshadeLayer(t,n,r){}addGeoJSONSource(t,n={type:"FeatureCollection",features:[]},r){return this.addSource(t,{type:"geojson",data:n,...r})}addGeoJSON(t,n={type:"FeatureCollection",features:[]},r){return this.addGeoJSONSource(t,n,r)}addSource(t,n){const r=this.map.getStyle();return r.sources[t]=n,this.map.setStyle(r),this._makeSource(t)}layersBySource(t){return this.map.getStyle().layers.filter(n=>n.source===t).map(n=>n.id)}addVectorSource(t,n,r={}){return typeof n=="string"?n.match(/\{z\}/)?this.addSource(t,{...r,type:"vector",tiles:[n]}):this.addSource(t,{...r,type:"vector",url:n}):this.addSource(t,{...n,type:"vector"})}addVector(t,n,r={}){return this.addVectorSource(t,n,r)}addRasterSource(t,n){return this.addSource(t,{...n,type:"raster"})}addRasterDemSource(t,n){return this.addSource(t,{...n,type:"raster-dem"})}addRasterSource(t,n){return this.addSource(t,{...n,type:"raster"})}addImageSource(t,n){return this.addSource(t,{...n,type:"image"})}addVideoSource(t,n){return this.addSource(t,{...n,type:"video"})}properties(t){if(!t)return;const n={},r={paint:{},layout:{},other:{}};return Object.keys(t).forEach(i=>{const a=tT(i);r[zV(a)][a]=t[i]}),Object.keys(r.paint).length&&(n.paint=r.paint),Object.keys(r.layout).length&&(n.layout=r.layout),Object.assign(n,r.other),n}layerStyle(...t){const[n,r,i]=t,a=t.find(o=>typeof o=="object"&&!Array.isArray(o)),l=typeof a=="object"?this.properties(a)||{}:{};return typeof n=="string"&&(l.id=n),typeof r=="string"&&(l.source=r),typeof i=="string"&&(l.type=i),l}getLayerStyle(t){return this.map.getStyle().layers.find(n=>n.id===t)}setData(t,n={type:"FeatureCollection",features:[]}){this.map.getSource(t).setData(n)}onLoad(t){if(t)this.map.loaded()||this._loaded?t():this.map.once("load",()=>{this._loaded=!0,t()});else return new Promise(n=>this.onLoad(n))}setRootProperty(t,n){const r=this.map.getStyle();r[tT(t)]=n,this.map.setStyle(r)}setTransition(t){this.setRootProperty("transition",t)}loadImage(t,n,r){return typeof n=="string"?new Promise((i,a)=>{this.map.loadImage(n,(l,o)=>{l?(console.error(`Error loading image ${n}`,l),a(`Error loading image ${n}`)):(this.map.addImage(t,o,r),i(t))})}):this.map.addImage(t,n,r)}lockOrientation(){this.map.touchZoomRotate.disableRotation(),this.map.dragRotate.disable()}fontsInUse(){function t(i){Array.isArray(i)&&(i[0]==="literal"?n.push(...i[1]):i.forEach(t))}let n=[];const r=this.map.getStyle().layers.map(i=>i.layout&&i.layout["text-font"]).filter(Boolean);for(const i of r)if(i.stops)try{n.push(...i.stops.flat().filter(Array.isArray).flat())}catch{console.log("Couldn't process font expression:",i)}else i.every(a=>typeof a=="string")?n.push(...i):t(i);return[...new Set(n)]}_makeSource(t){const n=new Tp;return n.map=this.map,n._mapgl=this._mapgl,Pk.forEach(function(r){Ak(r,n,t)}),n}}const Ak=(e,t,n)=>{let r;n?r=function(a,l,o){return this.setLayer(a,n,e,l,o)}:r=function(a,l,o,f){return this.setLayer(a,l,e,o,f)};const i=eI(e);t[`add${i}`]=r,t[`add${i}Layer`]=r};function VV(e){const t=(r,i)=>{const a="set"+eI(r);e[a]=Ks(function(l,o){return this.map[i](l,r,o)})},n=(r,i)=>{const a="get"+eI(r);e[a]=Ks(function(l){return this.map[i](l,r)})};e.update=e.setData,Kf.paints.forEach(r=>t(r,"setPaintProperty")),Kf.layouts.forEach(r=>t(r,"setLayoutProperty")),Kf.paints.forEach(r=>n(r,"getPaintProperty")),Kf.layouts.forEach(r=>n(r,"getLayoutProperty")),Pk.forEach(r=>Ak(r,e))}const GV=Tp.prototype;VV(GV);var na=63710088e-1,_w={centimeters:na*100,centimetres:na*100,degrees:na/111325,feet:na*3.28084,inches:na*39.37,kilometers:na/1e3,kilometres:na/1e3,meters:na,metres:na,miles:na/1609.344,millimeters:na*1e3,millimetres:na*1e3,nauticalmiles:na/1852,radians:1,yards:na*1.0936},Mk={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/na,yards:1.0936133},Pb={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function $o(e,t,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=e,r}function Lk(e,t,n){switch(e){case"Point":return sr(t).geometry;case"LineString":return oi(t).geometry;case"Polygon":return fr(t).geometry;case"MultiPoint":return G0(t).geometry;case"MultiLineString":return _d(t).geometry;case"MultiPolygon":return al(t).geometry;default:throw new Error(e+" is invalid")}}function sr(e,t,n){if(n===void 0&&(n={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!sa(e[0])||!sa(e[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:e};return $o(r,t,n)}function Ok(e,t,n){return n===void 0&&(n={}),An(e.map(function(r){return sr(r,t)}),n)}function fr(e,t,n){n===void 0&&(n={});for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var l=0;l<a[a.length-1].length;l++)if(a[a.length-1][l]!==a[0][l])throw new Error("First and last Position are not equivalent.")}var o={type:"Polygon",coordinates:e};return $o(o,t,n)}function Dk(e,t,n){return n===void 0&&(n={}),An(e.map(function(r){return fr(r,t)}),n)}function oi(e,t,n){if(n===void 0&&(n={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var r={type:"LineString",coordinates:e};return $o(r,t,n)}function Rk(e,t,n){return n===void 0&&(n={}),An(e.map(function(r){return oi(r,t)}),n)}function An(e,t){t===void 0&&(t={});var n={type:"FeatureCollection"};return t.id&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.features=e,n}function _d(e,t,n){n===void 0&&(n={});var r={type:"MultiLineString",coordinates:e};return $o(r,t,n)}function G0(e,t,n){n===void 0&&(n={});var r={type:"MultiPoint",coordinates:e};return $o(r,t,n)}function al(e,t,n){n===void 0&&(n={});var r={type:"MultiPolygon",coordinates:e};return $o(r,t,n)}function BC(e,t,n){n===void 0&&(n={});var r={type:"GeometryCollection",geometries:e};return $o(r,t,n)}function kk(e,t){if(t===void 0&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,t||0);return Math.round(e*n)/n}function Xm(e,t){t===void 0&&(t="kilometers");var n=_w[t];if(!n)throw new Error(t+" units is invalid");return e*n}function kp(e,t){t===void 0&&(t="kilometers");var n=_w[t];if(!n)throw new Error(t+" units is invalid");return e/n}function Ab(e,t){return id(kp(e,t))}function Np(e){var t=e%360;return t<0&&(t+=360),t}function id(e){var t=e%(2*Math.PI);return t*180/Math.PI}function oa(e){var t=e%360;return t*Math.PI/180}function Fp(e,t,n){if(t===void 0&&(t="kilometers"),n===void 0&&(n="kilometers"),!(e>=0))throw new Error("length must be a positive number");return Xm(kp(e,t),n)}function Nk(e,t,n){if(t===void 0&&(t="meters"),n===void 0&&(n="kilometers"),!(e>=0))throw new Error("area must be a positive number");var r=Pb[t];if(!r)throw new Error("invalid original units");var i=Pb[n];if(!i)throw new Error("invalid final units");return e/r*i}function sa(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function li(e){return!!e&&e.constructor===Object}function Fk(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(t){if(!sa(t))throw new Error("bbox must only contain numbers")})}function Bk(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}const zk=Object.freeze(Object.defineProperty({__proto__:null,areaFactors:Pb,bearingToAzimuth:Np,convertArea:Nk,convertLength:Fp,degreesToRadians:oa,earthRadius:na,factors:_w,feature:$o,featureCollection:An,geometry:Lk,geometryCollection:BC,isNumber:sa,isObject:li,lengthToDegrees:Ab,lengthToRadians:kp,lineString:oi,lineStrings:Rk,multiLineString:_d,multiPoint:G0,multiPolygon:al,point:sr,points:Ok,polygon:fr,polygons:Dk,radiansToDegrees:id,radiansToLength:Xm,round:kk,unitsFactors:Mk,validateBBox:Fk,validateId:Bk},Symbol.toStringTag,{value:"Module"}));function mo(e,t,n){if(e!==null)for(var r,i,a,l,o,f,p,y=0,x=0,w,S=e.type,L=S==="FeatureCollection",D=S==="Feature",B=L?e.features.length:1,z=0;z<B;z++){p=L?e.features[z].geometry:D?e.geometry:e,w=p?p.type==="GeometryCollection":!1,o=w?p.geometries.length:1;for(var M=0;M<o;M++){var k=0,V=0;if(l=w?p.geometries[M]:p,l!==null){f=l.coordinates;var q=l.type;switch(y=n&&(q==="Polygon"||q==="MultiPolygon")?1:0,q){case null:break;case"Point":if(t(f,x,z,k,V)===!1)return!1;x++,k++;break;case"LineString":case"MultiPoint":for(r=0;r<f.length;r++){if(t(f[r],x,z,k,V)===!1)return!1;x++,q==="MultiPoint"&&k++}q==="LineString"&&k++;break;case"Polygon":case"MultiLineString":for(r=0;r<f.length;r++){for(i=0;i<f[r].length-y;i++){if(t(f[r][i],x,z,k,V)===!1)return!1;x++}q==="MultiLineString"&&k++,q==="Polygon"&&V++}q==="Polygon"&&k++;break;case"MultiPolygon":for(r=0;r<f.length;r++){for(V=0,i=0;i<f[r].length;i++){for(a=0;a<f[r][i].length-y;a++){if(t(f[r][i][a],x,z,k,V)===!1)return!1;x++}V++}k++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(mo(l.geometries[r],t,n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function zC(e,t,n,r){var i=n;return mo(e,function(a,l,o,f,p){l===0&&n===void 0?i=a:i=t(i,a,l,o,f,p)},r),i}function UC(e,t){var n;switch(e.type){case"FeatureCollection":for(n=0;n<e.features.length&&t(e.features[n].properties,n)!==!1;n++);break;case"Feature":t(e.properties,0);break}}function Uk(e,t,n){var r=n;return UC(e,function(i,a){a===0&&n===void 0?r=i:r=t(r,i,a)}),r}function ti(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var n=0;n<e.features.length&&t(e.features[n],n)!==!1;n++);}function VC(e,t,n){var r=n;return ti(e,function(i,a){a===0&&n===void 0?r=i:r=t(r,i,a)}),r}function Wm(e){var t=[];return mo(e,function(n){t.push(n)}),t}function sl(e,t){var n,r,i,a,l,o,f,p,y,x,w=0,S=e.type==="FeatureCollection",L=e.type==="Feature",D=S?e.features.length:1;for(n=0;n<D;n++){for(o=S?e.features[n].geometry:L?e.geometry:e,p=S?e.features[n].properties:L?e.properties:{},y=S?e.features[n].bbox:L?e.bbox:void 0,x=S?e.features[n].id:L?e.id:void 0,f=o?o.type==="GeometryCollection":!1,l=f?o.geometries.length:1,i=0;i<l;i++){if(a=f?o.geometries[i]:o,a===null){if(t(null,w,p,y,x)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(a,w,p,y,x)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<a.geometries.length;r++)if(t(a.geometries[r],w,p,y,x)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}w++}}function GC(e,t,n){var r=n;return sl(e,function(i,a,l,o,f){a===0&&n===void 0?r=i:r=t(r,i,a,l,o,f)}),r}function xa(e,t){sl(e,function(n,r,i,a,l){var o=n===null?null:n.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return t($o(n,i,{bbox:a,id:l}),r,0)===!1?!1:void 0}var f;switch(o){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon";break}for(var p=0;p<n.coordinates.length;p++){var y=n.coordinates[p],x={type:f,coordinates:y};if(t($o(x,i),r,p)===!1)return!1}})}function Vk(e,t,n){var r=n;return xa(e,function(i,a,l){a===0&&l===0&&n===void 0?r=i:r=t(r,i,a,l)}),r}function Rh(e,t){xa(e,function(n,r,i){var a=0;if(n.geometry){var l=n.geometry.type;if(!(l==="Point"||l==="MultiPoint")){var o,f=0,p=0,y=0;if(mo(n,function(x,w,S,L,D){if(o===void 0||r>f||L>p||D>y){o=x,f=r,p=L,y=D,a=0;return}var B=oi([o,x],n.properties);if(t(B,r,i,D,a)===!1)return!1;a++,o=x})===!1)return!1}}})}function $C(e,t,n){var r=n,i=!1;return Rh(e,function(a,l,o,f,p){i===!1&&n===void 0?r=a:r=t(r,a,l,o,f,p),i=!0}),r}function jC(e,t){if(!e)throw new Error("geojson is required");xa(e,function(n,r,i){if(n.geometry!==null){var a=n.geometry.type,l=n.geometry.coordinates;switch(a){case"LineString":if(t(n,r,i,0,0)===!1)return!1;break;case"Polygon":for(var o=0;o<l.length;o++)if(t(oi(l[o],n.properties),r,i,o)===!1)return!1;break}}})}function qC(e,t,n){var r=n;return jC(e,function(i,a,l,o){a===0&&n===void 0?r=i:r=t(r,i,a,l,o)}),r}function Gk(e,t){if(t=t||{},!li(t))throw new Error("options is invalid");var n=t.featureIndex||0,r=t.multiFeatureIndex||0,i=t.geometryIndex||0,a=t.segmentIndex||0,l=t.properties,o;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),l=l||e.features[n].properties,o=e.features[n].geometry;break;case"Feature":l=l||e.properties,o=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":o=e;break;default:throw new Error("geojson is invalid")}if(o===null)return null;var f=o.coordinates;switch(o.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=f.length+a-1),oi([f[a],f[a+1]],l,t);case"Polygon":return i<0&&(i=f.length+i),a<0&&(a=f[i].length+a-1),oi([f[i][a],f[i][a+1]],l,t);case"MultiLineString":return r<0&&(r=f.length+r),a<0&&(a=f[r].length+a-1),oi([f[r][a],f[r][a+1]],l,t);case"MultiPolygon":return r<0&&(r=f.length+r),i<0&&(i=f[r].length+i),a<0&&(a=f[r][i].length-a-1),oi([f[r][i][a],f[r][i][a+1]],l,t)}throw new Error("geojson is invalid")}function $k(e,t){if(t=t||{},!li(t))throw new Error("options is invalid");var n=t.featureIndex||0,r=t.multiFeatureIndex||0,i=t.geometryIndex||0,a=t.coordIndex||0,l=t.properties,o;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),l=l||e.features[n].properties,o=e.features[n].geometry;break;case"Feature":l=l||e.properties,o=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":o=e;break;default:throw new Error("geojson is invalid")}if(o===null)return null;var f=o.coordinates;switch(o.type){case"Point":return sr(f,l,t);case"MultiPoint":return r<0&&(r=f.length+r),sr(f[r],l,t);case"LineString":return a<0&&(a=f.length+a),sr(f[a],l,t);case"Polygon":return i<0&&(i=f.length+i),a<0&&(a=f[i].length+a),sr(f[i][a],l,t);case"MultiLineString":return r<0&&(r=f.length+r),a<0&&(a=f[r].length+a),sr(f[r][a],l,t);case"MultiPolygon":return r<0&&(r=f.length+r),i<0&&(i=f[r].length+i),a<0&&(a=f[r][i].length-a),sr(f[r][i][a],l,t)}throw new Error("geojson is invalid")}const jk=Object.freeze(Object.defineProperty({__proto__:null,coordAll:Wm,coordEach:mo,coordReduce:zC,featureEach:ti,featureReduce:VC,findPoint:$k,findSegment:Gk,flattenEach:xa,flattenReduce:Vk,geomEach:sl,geomReduce:GC,lineEach:jC,lineReduce:qC,propEach:UC,propReduce:Uk,segmentEach:Rh,segmentReduce:$C},Symbol.toStringTag,{value:"Module"}));function ao(e){var t=[1/0,1/0,-1/0,-1/0];return mo(e,function(n){t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]<n[0]&&(t[2]=n[0]),t[3]<n[1]&&(t[3]=n[1])}),t}ao.default=ao;const $V=Object.freeze(Object.defineProperty({__proto__:null,default:ao},Symbol.toStringTag,{value:"Module"}));function Ti(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function kn(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function ZC(e){if(e.length>1&&sa(e[0])&&sa(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return ZC(e[0]);throw new Error("coordinates must only contain numbers")}function qk(e,t,n){if(!t||!n)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+e.type)}function a0(e,t,n){if(!e)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+e.geometry.type)}function af(e,t,n){if(!e)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0,i=e.features;r<i.length;r++){var a=i[r];if(!a||a.type!=="Feature"||!a.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!a.geometry||a.geometry.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+a.geometry.type)}}function Oi(e){return e.type==="Feature"?e.geometry:e}function Ds(e,t){return e.type==="FeatureCollection"?"FeatureCollection":e.type==="GeometryCollection"?"GeometryCollection":e.type==="Feature"&&e.geometry!==null?e.geometry.type:e.type}const jV=Object.freeze(Object.defineProperty({__proto__:null,collectionOf:af,containsNumber:ZC,featureOf:a0,geojsonType:qk,getCoord:Ti,getCoords:kn,getGeom:Oi,getType:Ds},Symbol.toStringTag,{value:"Module"}));/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var rO=Object.getOwnPropertySymbols,qV=Object.prototype.hasOwnProperty,ZV=Object.prototype.propertyIsEnumerable;function XV(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function WV(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(a){return t[a]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(a){i[a]=a}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var HV=WV()?Object.assign:function(e,t){for(var n,r=XV(e),i,a=1;a<arguments.length;a++){n=Object(arguments[a]);for(var l in n)qV.call(n,l)&&(r[l]=n[l]);if(rO){i=rO(n);for(var o=0;o<i.length;o++)ZV.call(n,i[o])&&(r[i[o]]=n[i[o]])}}return r};const XC=Vs(HV);/**
 * @license GNU Affero General Public License.
 * Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 * v. 1.2.0
 * https://github.com/RaumZeit/MarchingSquares.js
 *
 * MarchingSquaresJS is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * MarchingSquaresJS is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * As additional permission under GNU Affero General Public License version 3
 * section 7, third-party projects (personal or commercial) may distribute,
 * include, or link against UNMODIFIED VERSIONS of MarchingSquaresJS without the
 * requirement that said third-party project for that reason alone becomes
 * subject to any requirement of the GNU Affero General Public License version 3.
 * Any modifications to MarchingSquaresJS, however, must be shared with the public
 * and made available.
 *
 * In summary this:
 * - allows you to use MarchingSquaresJS at no cost
 * - allows you to use MarchingSquaresJS for both personal and commercial purposes
 * - allows you to distribute UNMODIFIED VERSIONS of MarchingSquaresJS under any
 *   license as long as this license notice is included
 * - enables you to keep the source code of your program that uses MarchingSquaresJS
 *   undisclosed
 * - forces you to share any modifications you have made to MarchingSquaresJS,
 *   e.g. bug-fixes
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with MarchingSquaresJS.  If not, see <http://www.gnu.org/licenses/>.
 */var iO={successCallback:null,verbose:!1},Gx={};function YV(e,t,n){n=n||{};for(var r=Object.keys(iO),i=0;i<r.length;i++){var a=r[i],l=n[a];l=typeof l<"u"&&l!==null?l:iO[a],Gx[a]=l}Gx.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+t);var o=QV(KV(e,t));return typeof Gx.successCallback=="function"&&Gx.successCallback(o),o}function yi(e,t,n){return(e-t)/(n-t)}function KV(e,t){for(var n=e.length-1,r=e[0].length-1,i={rows:n,cols:r,cells:[]},a=0;a<n;++a){i.cells[a]=[];for(var l=0;l<r;++l){var o=0,f=e[a+1][l],p=e[a+1][l+1],y=e[a][l+1],x=e[a][l];if(!(isNaN(f)||isNaN(p)||isNaN(y)||isNaN(x))){o|=f>=t?8:0,o|=p>=t?4:0,o|=y>=t?2:0,o|=x>=t?1:0;var w=!1;if(o===5||o===10){var S=(f+p+y+x)/4;o===5&&S<t?(o=10,w=!0):o===10&&S<t&&(o=5,w=!0)}if(o!==0&&o!==15){var L,D,B,z;L=D=B=z=.5,o===1?(B=1-yi(t,f,x),D=1-yi(t,y,x)):o===2?(D=yi(t,x,y),z=1-yi(t,p,y)):o===3?(B=1-yi(t,f,x),z=1-yi(t,p,y)):o===4?(L=yi(t,f,p),z=yi(t,y,p)):o===5?(L=yi(t,f,p),z=yi(t,y,p),D=1-yi(t,y,x),B=1-yi(t,f,x)):o===6?(D=yi(t,x,y),L=yi(t,f,p)):o===7?(B=1-yi(t,f,x),L=yi(t,f,p)):o===8?(B=yi(t,x,f),L=1-yi(t,p,f)):o===9?(D=1-yi(t,y,x),L=1-yi(t,p,f)):o===10?(L=1-yi(t,p,f),z=1-yi(t,p,y),D=yi(t,x,y),B=yi(t,x,f)):o===11?(L=1-yi(t,p,f),z=1-yi(t,p,y)):o===12?(B=yi(t,x,f),z=yi(t,y,p)):o===13?(D=1-yi(t,y,x),z=yi(t,y,p)):o===14?(B=yi(t,x,f),D=yi(t,x,y)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+o),i.cells[a][l]={cval:o,flipped:w,top:L,right:z,bottom:D,left:B}}}}}return i}function JV(e){return e.cval===5||e.cval===10}function Zk(e){return e.cval===0||e.cval===15}function oO(e){!Zk(e)&&e.cval!==5&&e.cval!==10&&(e.cval=15)}function nT(e,t){if(t==="top")return[e.top,1];if(t==="bottom")return[e.bottom,0];if(t==="right")return[1,e.right];if(t==="left")return[0,e.left]}function QV(e){var t=[],n=0,r=1e-7;return e.cells.forEach(function(i,a){i.forEach(function(l,o){if(typeof l<"u"&&!JV(l)&&!Zk(l)){var f=e7(e.cells,a,o),p=!1;if(f.info==="mergeable"){for(var y=f.path[f.path.length-1][0],x=f.path[f.path.length-1][1],w=n-1;w>=0;w--)if(Math.abs(t[w][0][0]-y)<=r&&Math.abs(t[w][0][1]-x)<=r){for(var S=f.path.length-2;S>=0;--S)t[w].unshift(f.path[S]);p=!0;break}}p||(t[n++]=f.path)}})}),t}function e7(e,t,n){var r=e.length,i=[],a=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],l=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],o,f,p=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"],y=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],S,x=e[t][n],w=x.cval,S=p[w],L=nT(x,S);i.push([n+L[0],t+L[1]]),S=y[w],L=nT(x,S),i.push([n+L[0],t+L[1]]),oO(x);for(var D=n+a[w],B=t+l[w],z=w;D>=0&&B>=0&&B<r&&(D!=n||B!=t)&&(x=e[B][D],!(typeof x>"u"));){if(w=x.cval,w===0||w===15)return{path:i,info:"mergeable"};S=y[w],o=a[w],f=l[w],(w===5||w===10)&&(w===5?x.flipped?l[z]===-1?(S="left",o=-1,f=0):(S="right",o=1,f=0):a[z]===-1&&(S="bottom",o=0,f=-1):w===10&&(x.flipped?a[z]===-1?(S="top",o=0,f=1):(S="bottom",o=0,f=-1):l[z]===1&&(S="left",o=-1,f=0))),L=nT(x,S),i.push([D+L[0],B+L[1]]),oO(x),D+=o,B+=f,z=w}return{path:i,info:"closed"}}function t7(e,t){if(t=t||{},!li(t))throw new Error("options is invalid");var n=t.zProperty||"elevation",r=t.flip,i=t.flags;af(e,"Point","input must contain Points");for(var a=n7(e,r),l=[],o=0;o<a.length;o++){for(var f=a[o],p=[],y=0;y<f.length;y++){var x=f[y];x.properties[n]?p.push(x.properties[n]):p.push(0),i===!0&&(x.properties.matrixPosition=[o,y])}l.push(p)}return l}function n7(e,t){var n={};ti(e,function(a){var l=kn(a)[1];n[l]||(n[l]=[]),n[l].push(a)});var r=Object.keys(n).map(function(a){var l=n[a],o=l.sort(function(f,p){return kn(f)[0]-kn(p)[0]});return o}),i=r.sort(function(a,l){return t?kn(a[0])[1]-kn(l[0])[1]:kn(l[0])[1]-kn(a[0])[1]});return i}function r7(e,t,n){if(n=n||{},!li(n))throw new Error("options is invalid");var r=n.zProperty||"elevation",i=n.commonProperties||{},a=n.breaksProperties||[];if(af(e,"Point","Input must contain Points"),!t)throw new Error("breaks is required");if(!Array.isArray(t))throw new Error("breaks must be an Array");if(!li(i))throw new Error("commonProperties must be an Object");if(!Array.isArray(a))throw new Error("breaksProperties must be an Array");var l=t7(e,{zProperty:r,flip:!0}),o=i7(l,t,r,i,a),f=o7(o,l,e);return An(f)}function i7(e,t,n,r,i){for(var a=[],l=1;l<t.length;l++){var o=+t[l],f=XC({},r,i[l]);f[n]=o;var p=_d(YV(e,o),f);a.push(p)}return a}function o7(e,t,n){var r=ao(n),i=r[2]-r[0],a=r[3]-r[1],l=r[0],o=r[1],f=t[0].length-1,p=t.length-1,y=i/f,x=a/p,w=function(S){S[0]=S[0]*y+l,S[1]=S[1]*x+o};return e.forEach(function(S){mo(S,w)}),e}var WC={exports:{}},Xk={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(V0,function(){function n(M,k,V,q,Y){(function K(X,U,le,ue,ae){for(;ue>le;){if(ue-le>600){var ve=ue-le+1,Ee=U-le+1,He=Math.log(ve),Oe=.5*Math.exp(2*He/3),Ve=.5*Math.sqrt(He*Oe*(ve-Oe)/ve)*(Ee-ve/2<0?-1:1),Pe=Math.max(le,Math.floor(U-Ee*Oe/ve+Ve)),Ke=Math.min(ue,Math.floor(U+(ve-Ee)*Oe/ve+Ve));K(X,U,Pe,Ke,ae)}var Be=X[U],Ue=le,lt=ue;for(r(X,le,U),ae(X[ue],Be)>0&&r(X,le,ue);Ue<lt;){for(r(X,Ue,lt),Ue++,lt--;ae(X[Ue],Be)<0;)Ue++;for(;ae(X[lt],Be)>0;)lt--}ae(X[le],Be)===0?r(X,le,lt):r(X,++lt,ue),lt<=U&&(le=lt+1),U<=lt&&(ue=lt-1)}})(M,k,V||0,q||M.length-1,Y||i)}function r(M,k,V){var q=M[k];M[k]=M[V],M[V]=q}function i(M,k){return M<k?-1:M>k?1:0}var a=function(M){M===void 0&&(M=9),this._maxEntries=Math.max(4,M),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function l(M,k,V){if(!V)return k.indexOf(M);for(var q=0;q<k.length;q++)if(V(M,k[q]))return q;return-1}function o(M,k){f(M,0,M.children.length,k,M)}function f(M,k,V,q,Y){Y||(Y=B(null)),Y.minX=1/0,Y.minY=1/0,Y.maxX=-1/0,Y.maxY=-1/0;for(var K=k;K<V;K++){var X=M.children[K];p(Y,M.leaf?q(X):X)}return Y}function p(M,k){return M.minX=Math.min(M.minX,k.minX),M.minY=Math.min(M.minY,k.minY),M.maxX=Math.max(M.maxX,k.maxX),M.maxY=Math.max(M.maxY,k.maxY),M}function y(M,k){return M.minX-k.minX}function x(M,k){return M.minY-k.minY}function w(M){return(M.maxX-M.minX)*(M.maxY-M.minY)}function S(M){return M.maxX-M.minX+(M.maxY-M.minY)}function L(M,k){return M.minX<=k.minX&&M.minY<=k.minY&&k.maxX<=M.maxX&&k.maxY<=M.maxY}function D(M,k){return k.minX<=M.maxX&&k.minY<=M.maxY&&k.maxX>=M.minX&&k.maxY>=M.minY}function B(M){return{children:M,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function z(M,k,V,q,Y){for(var K=[k,V];K.length;)if(!((V=K.pop())-(k=K.pop())<=q)){var X=k+Math.ceil((V-k)/q/2)*q;n(M,X,k,V,Y),K.push(k,X,X,V)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(M){var k=this.data,V=[];if(!D(M,k))return V;for(var q=this.toBBox,Y=[];k;){for(var K=0;K<k.children.length;K++){var X=k.children[K],U=k.leaf?q(X):X;D(M,U)&&(k.leaf?V.push(X):L(M,U)?this._all(X,V):Y.push(X))}k=Y.pop()}return V},a.prototype.collides=function(M){var k=this.data;if(!D(M,k))return!1;for(var V=[];k;){for(var q=0;q<k.children.length;q++){var Y=k.children[q],K=k.leaf?this.toBBox(Y):Y;if(D(M,K)){if(k.leaf||L(M,K))return!0;V.push(Y)}}k=V.pop()}return!1},a.prototype.load=function(M){if(!M||!M.length)return this;if(M.length<this._minEntries){for(var k=0;k<M.length;k++)this.insert(M[k]);return this}var V=this._build(M.slice(),0,M.length-1,0);if(this.data.children.length)if(this.data.height===V.height)this._splitRoot(this.data,V);else{if(this.data.height<V.height){var q=this.data;this.data=V,V=q}this._insert(V,this.data.height-V.height-1,!0)}else this.data=V;return this},a.prototype.insert=function(M){return M&&this._insert(M,this.data.height-1),this},a.prototype.clear=function(){return this.data=B([]),this},a.prototype.remove=function(M,k){if(!M)return this;for(var V,q,Y,K=this.data,X=this.toBBox(M),U=[],le=[];K||U.length;){if(K||(K=U.pop(),q=U[U.length-1],V=le.pop(),Y=!0),K.leaf){var ue=l(M,K.children,k);if(ue!==-1)return K.children.splice(ue,1),U.push(K),this._condense(U),this}Y||K.leaf||!L(K,X)?q?(V++,K=q.children[V],Y=!1):K=null:(U.push(K),le.push(V),V=0,q=K,K=K.children[0])}return this},a.prototype.toBBox=function(M){return M},a.prototype.compareMinX=function(M,k){return M.minX-k.minX},a.prototype.compareMinY=function(M,k){return M.minY-k.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(M){return this.data=M,this},a.prototype._all=function(M,k){for(var V=[];M;)M.leaf?k.push.apply(k,M.children):V.push.apply(V,M.children),M=V.pop();return k},a.prototype._build=function(M,k,V,q){var Y,K=V-k+1,X=this._maxEntries;if(K<=X)return o(Y=B(M.slice(k,V+1)),this.toBBox),Y;q||(q=Math.ceil(Math.log(K)/Math.log(X)),X=Math.ceil(K/Math.pow(X,q-1))),(Y=B([])).leaf=!1,Y.height=q;var U=Math.ceil(K/X),le=U*Math.ceil(Math.sqrt(X));z(M,k,V,le,this.compareMinX);for(var ue=k;ue<=V;ue+=le){var ae=Math.min(ue+le-1,V);z(M,ue,ae,U,this.compareMinY);for(var ve=ue;ve<=ae;ve+=U){var Ee=Math.min(ve+U-1,ae);Y.children.push(this._build(M,ve,Ee,q-1))}}return o(Y,this.toBBox),Y},a.prototype._chooseSubtree=function(M,k,V,q){for(;q.push(k),!k.leaf&&q.length-1!==V;){for(var Y=1/0,K=1/0,X=void 0,U=0;U<k.children.length;U++){var le=k.children[U],ue=w(le),ae=(ve=M,Ee=le,(Math.max(Ee.maxX,ve.maxX)-Math.min(Ee.minX,ve.minX))*(Math.max(Ee.maxY,ve.maxY)-Math.min(Ee.minY,ve.minY))-ue);ae<K?(K=ae,Y=ue<Y?ue:Y,X=le):ae===K&&ue<Y&&(Y=ue,X=le)}k=X||k.children[0]}var ve,Ee;return k},a.prototype._insert=function(M,k,V){var q=V?M:this.toBBox(M),Y=[],K=this._chooseSubtree(q,this.data,k,Y);for(K.children.push(M),p(K,q);k>=0&&Y[k].children.length>this._maxEntries;)this._split(Y,k),k--;this._adjustParentBBoxes(q,Y,k)},a.prototype._split=function(M,k){var V=M[k],q=V.children.length,Y=this._minEntries;this._chooseSplitAxis(V,Y,q);var K=this._chooseSplitIndex(V,Y,q),X=B(V.children.splice(K,V.children.length-K));X.height=V.height,X.leaf=V.leaf,o(V,this.toBBox),o(X,this.toBBox),k?M[k-1].children.push(X):this._splitRoot(V,X)},a.prototype._splitRoot=function(M,k){this.data=B([M,k]),this.data.height=M.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(M,k,V){for(var q,Y,K,X,U,le,ue,ae=1/0,ve=1/0,Ee=k;Ee<=V-k;Ee++){var He=f(M,0,Ee,this.toBBox),Oe=f(M,Ee,V,this.toBBox),Ve=(Y=He,K=Oe,X=void 0,U=void 0,le=void 0,ue=void 0,X=Math.max(Y.minX,K.minX),U=Math.max(Y.minY,K.minY),le=Math.min(Y.maxX,K.maxX),ue=Math.min(Y.maxY,K.maxY),Math.max(0,le-X)*Math.max(0,ue-U)),Pe=w(He)+w(Oe);Ve<ae?(ae=Ve,q=Ee,ve=Pe<ve?Pe:ve):Ve===ae&&Pe<ve&&(ve=Pe,q=Ee)}return q||V-k},a.prototype._chooseSplitAxis=function(M,k,V){var q=M.leaf?this.compareMinX:y,Y=M.leaf?this.compareMinY:x;this._allDistMargin(M,k,V,q)<this._allDistMargin(M,k,V,Y)&&M.children.sort(q)},a.prototype._allDistMargin=function(M,k,V,q){M.children.sort(q);for(var Y=this.toBBox,K=f(M,0,k,Y),X=f(M,V-k,V,Y),U=S(K)+S(X),le=k;le<V-k;le++){var ue=M.children[le];p(K,M.leaf?Y(ue):ue),U+=S(K)}for(var ae=V-k-1;ae>=k;ae--){var ve=M.children[ae];p(X,M.leaf?Y(ve):ve),U+=S(X)}return U},a.prototype._adjustParentBBoxes=function(M,k,V){for(var q=V;q>=0;q--)p(k[q],M)},a.prototype._condense=function(M){for(var k=M.length-1,V=void 0;k>=0;k--)M[k].children.length===0?k>0?(V=M[k-1].children).splice(V.indexOf(M[k]),1):this.clear():o(M[k],this.toBBox)},a})})(Xk);var a7=Xk.exports;class s7{constructor(t=[],n=l7){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:r}=this,i=n[t];for(;t>0;){const a=t-1>>1,l=n[a];if(r(i,l)>=0)break;n[t]=l,t=a}n[t]=i}_down(t){const{data:n,compare:r}=this,i=this.length>>1,a=n[t];for(;t<i;){let l=(t<<1)+1,o=n[l];const f=l+1;if(f<this.length&&r(n[f],o)<0&&(l=f,o=n[f]),r(o,a)>=0)break;n[t]=o,t=l}n[t]=a}}function l7(e,t){return e<t?-1:e>t?1:0}const u7=Object.freeze(Object.defineProperty({__proto__:null,default:s7},Symbol.toStringTag,{value:"Module"})),c7=vw(u7);var xw={exports:{}},h7=function(t,n,r,i){var a=t[0],l=t[1],o=!1;r===void 0&&(r=0),i===void 0&&(i=n.length);for(var f=(i-r)/2,p=0,y=f-1;p<f;y=p++){var x=n[r+p*2+0],w=n[r+p*2+1],S=n[r+y*2+0],L=n[r+y*2+1],D=w>l!=L>l&&a<(S-x)*(l-w)/(L-w)+x;D&&(o=!o)}return o},f7=function(t,n,r,i){var a=t[0],l=t[1],o=!1;r===void 0&&(r=0),i===void 0&&(i=n.length);for(var f=i-r,p=0,y=f-1;p<f;y=p++){var x=n[p+r][0],w=n[p+r][1],S=n[y+r][0],L=n[y+r][1],D=w>l!=L>l&&a<(S-x)*(l-w)/(L-w)+x;D&&(o=!o)}return o},Wk=h7,Hk=f7;xw.exports=function(t,n,r,i){return n.length>0&&Array.isArray(n[0])?Hk(t,n,r,i):Wk(t,n,r,i)};xw.exports.nested=Hk;xw.exports.flat=Wk;var d7=xw.exports,tI={exports:{}};(function(e,t){(function(n,r){r(t)})(V0,function(n){const i=33306690738754706e-32;function a(D,B,z,M,k){let V,q,Y,K,X=B[0],U=M[0],le=0,ue=0;U>X==U>-X?(V=X,X=B[++le]):(V=U,U=M[++ue]);let ae=0;if(le<D&&ue<z)for(U>X==U>-X?(Y=V-((q=X+V)-X),X=B[++le]):(Y=V-((q=U+V)-U),U=M[++ue]),V=q,Y!==0&&(k[ae++]=Y);le<D&&ue<z;)U>X==U>-X?(Y=V-((q=V+X)-(K=q-V))+(X-K),X=B[++le]):(Y=V-((q=V+U)-(K=q-V))+(U-K),U=M[++ue]),V=q,Y!==0&&(k[ae++]=Y);for(;le<D;)Y=V-((q=V+X)-(K=q-V))+(X-K),X=B[++le],V=q,Y!==0&&(k[ae++]=Y);for(;ue<z;)Y=V-((q=V+U)-(K=q-V))+(U-K),U=M[++ue],V=q,Y!==0&&(k[ae++]=Y);return V===0&&ae!==0||(k[ae++]=V),ae}function l(D){return new Float64Array(D)}const o=33306690738754716e-32,f=22204460492503146e-32,p=11093356479670487e-47,y=l(4),x=l(8),w=l(12),S=l(16),L=l(4);n.orient2d=function(D,B,z,M,k,V){const q=(B-V)*(z-k),Y=(D-k)*(M-V),K=q-Y;if(q===0||Y===0||q>0!=Y>0)return K;const X=Math.abs(q+Y);return Math.abs(K)>=o*X?K:-function(U,le,ue,ae,ve,Ee,He){let Oe,Ve,Pe,Ke,Be,Ue,lt,xt,Nt,Wt,Je,Kt,Vt,dt,Jt,Ut,we,Ce;const je=U-ve,nt=ue-ve,st=le-Ee,vt=ae-Ee;Be=(Jt=(xt=je-(lt=(Ue=134217729*je)-(Ue-je)))*(Wt=vt-(Nt=(Ue=134217729*vt)-(Ue-vt)))-((dt=je*vt)-lt*Nt-xt*Nt-lt*Wt))-(Je=Jt-(we=(xt=st-(lt=(Ue=134217729*st)-(Ue-st)))*(Wt=nt-(Nt=(Ue=134217729*nt)-(Ue-nt)))-((Ut=st*nt)-lt*Nt-xt*Nt-lt*Wt))),y[0]=Jt-(Je+Be)+(Be-we),Be=(Vt=dt-((Kt=dt+Je)-(Be=Kt-dt))+(Je-Be))-(Je=Vt-Ut),y[1]=Vt-(Je+Be)+(Be-Ut),Be=(Ce=Kt+Je)-Kt,y[2]=Kt-(Ce-Be)+(Je-Be),y[3]=Ce;let Dt=function(un,xn){let Mn=xn[0];for(let Wn=1;Wn<un;Wn++)Mn+=xn[Wn];return Mn}(4,y),Ct=f*He;if(Dt>=Ct||-Dt>=Ct||(Oe=U-(je+(Be=U-je))+(Be-ve),Pe=ue-(nt+(Be=ue-nt))+(Be-ve),Ve=le-(st+(Be=le-st))+(Be-Ee),Ke=ae-(vt+(Be=ae-vt))+(Be-Ee),Oe===0&&Ve===0&&Pe===0&&Ke===0)||(Ct=p*He+i*Math.abs(Dt),(Dt+=je*Ke+vt*Oe-(st*Pe+nt*Ve))>=Ct||-Dt>=Ct))return Dt;Be=(Jt=(xt=Oe-(lt=(Ue=134217729*Oe)-(Ue-Oe)))*(Wt=vt-(Nt=(Ue=134217729*vt)-(Ue-vt)))-((dt=Oe*vt)-lt*Nt-xt*Nt-lt*Wt))-(Je=Jt-(we=(xt=Ve-(lt=(Ue=134217729*Ve)-(Ue-Ve)))*(Wt=nt-(Nt=(Ue=134217729*nt)-(Ue-nt)))-((Ut=Ve*nt)-lt*Nt-xt*Nt-lt*Wt))),L[0]=Jt-(Je+Be)+(Be-we),Be=(Vt=dt-((Kt=dt+Je)-(Be=Kt-dt))+(Je-Be))-(Je=Vt-Ut),L[1]=Vt-(Je+Be)+(Be-Ut),Be=(Ce=Kt+Je)-Kt,L[2]=Kt-(Ce-Be)+(Je-Be),L[3]=Ce;const Gt=a(4,y,4,L,x);Be=(Jt=(xt=je-(lt=(Ue=134217729*je)-(Ue-je)))*(Wt=Ke-(Nt=(Ue=134217729*Ke)-(Ue-Ke)))-((dt=je*Ke)-lt*Nt-xt*Nt-lt*Wt))-(Je=Jt-(we=(xt=st-(lt=(Ue=134217729*st)-(Ue-st)))*(Wt=Pe-(Nt=(Ue=134217729*Pe)-(Ue-Pe)))-((Ut=st*Pe)-lt*Nt-xt*Nt-lt*Wt))),L[0]=Jt-(Je+Be)+(Be-we),Be=(Vt=dt-((Kt=dt+Je)-(Be=Kt-dt))+(Je-Be))-(Je=Vt-Ut),L[1]=Vt-(Je+Be)+(Be-Ut),Be=(Ce=Kt+Je)-Kt,L[2]=Kt-(Ce-Be)+(Je-Be),L[3]=Ce;const Tt=a(Gt,x,4,L,w);Be=(Jt=(xt=Oe-(lt=(Ue=134217729*Oe)-(Ue-Oe)))*(Wt=Ke-(Nt=(Ue=134217729*Ke)-(Ue-Ke)))-((dt=Oe*Ke)-lt*Nt-xt*Nt-lt*Wt))-(Je=Jt-(we=(xt=Ve-(lt=(Ue=134217729*Ve)-(Ue-Ve)))*(Wt=Pe-(Nt=(Ue=134217729*Pe)-(Ue-Pe)))-((Ut=Ve*Pe)-lt*Nt-xt*Nt-lt*Wt))),L[0]=Jt-(Je+Be)+(Be-we),Be=(Vt=dt-((Kt=dt+Je)-(Be=Kt-dt))+(Je-Be))-(Je=Vt-Ut),L[1]=Vt-(Je+Be)+(Be-Ut),Be=(Ce=Kt+Je)-Kt,L[2]=Kt-(Ce-Be)+(Je-Be),L[3]=Ce;const fn=a(Tt,w,4,L,S);return S[fn-1]}(D,B,z,M,k,V,X)},n.orient2dfast=function(D,B,z,M,k,V){return(B-V)*(z-k)-(D-k)*(M-V)},Object.defineProperty(n,"__esModule",{value:!0})})})(tI,tI.exports);var p7=tI.exports,aO=a7,cb=c7,g7=d7,m7=p7.orient2d;cb.default&&(cb=cb.default);WC.exports=Yk;WC.exports.default=Yk;function Yk(e,t,n){t=Math.max(0,t===void 0?2:t),n=n||0;var r=b7(e),i=new aO(16);i.toBBox=function(M){return{minX:M[0],minY:M[1],maxX:M[0],maxY:M[1]}},i.compareMinX=function(M,k){return M[0]-k[0]},i.compareMinY=function(M,k){return M[1]-k[1]},i.load(e);for(var a=[],l=0,o;l<r.length;l++){var f=r[l];i.remove(f),o=uO(f,o),a.push(o)}var p=new aO(16);for(l=0;l<a.length;l++)p.insert(rT(a[l]));for(var y=t*t,x=n*n;a.length;){var w=a.shift(),S=w.p,L=w.next.p,D=iT(S,L);if(!(D<x)){var B=D/y;f=y7(i,w.prev.p,S,L,w.next.next.p,B,p),f&&Math.min(iT(f,S),iT(f,L))<=B&&(a.push(w),a.push(uO(f,w)),i.remove(f),p.remove(w),p.insert(rT(w)),p.insert(rT(w.next)))}}w=o;var z=[];do z.push(w.p),w=w.next;while(w!==o);return z.push(w.p),z}function y7(e,t,n,r,i,a,l){for(var o=new cb([],v7),f=e.data;f;){for(var p=0;p<f.children.length;p++){var y=f.children[p],x=f.leaf?oT(y,n,r):_7(n,r,y);x>a||o.push({node:y,dist:x})}for(;o.length&&!o.peek().node.children;){var w=o.pop(),S=w.node,L=oT(S,t,n),D=oT(S,r,i);if(w.dist<L&&w.dist<D&&lO(n,S,l)&&lO(r,S,l))return S}f=o.pop(),f&&(f=f.node)}return null}function v7(e,t){return e.dist-t.dist}function _7(e,t,n){if(sO(e,n)||sO(t,n))return 0;var r=$x(e[0],e[1],t[0],t[1],n.minX,n.minY,n.maxX,n.minY);if(r===0)return 0;var i=$x(e[0],e[1],t[0],t[1],n.minX,n.minY,n.minX,n.maxY);if(i===0)return 0;var a=$x(e[0],e[1],t[0],t[1],n.maxX,n.minY,n.maxX,n.maxY);if(a===0)return 0;var l=$x(e[0],e[1],t[0],t[1],n.minX,n.maxY,n.maxX,n.maxY);return l===0?0:Math.min(r,i,a,l)}function sO(e,t){return e[0]>=t.minX&&e[0]<=t.maxX&&e[1]>=t.minY&&e[1]<=t.maxY}function lO(e,t,n){for(var r=Math.min(e[0],t[0]),i=Math.min(e[1],t[1]),a=Math.max(e[0],t[0]),l=Math.max(e[1],t[1]),o=n.search({minX:r,minY:i,maxX:a,maxY:l}),f=0;f<o.length;f++)if(x7(o[f].p,o[f].next.p,e,t))return!1;return!0}function Mm(e,t,n){return m7(e[0],e[1],t[0],t[1],n[0],n[1])}function x7(e,t,n,r){return e!==r&&t!==n&&Mm(e,t,n)>0!=Mm(e,t,r)>0&&Mm(n,r,e)>0!=Mm(n,r,t)>0}function rT(e){var t=e.p,n=e.next.p;return e.minX=Math.min(t[0],n[0]),e.minY=Math.min(t[1],n[1]),e.maxX=Math.max(t[0],n[0]),e.maxY=Math.max(t[1],n[1]),e}function b7(e){for(var t=e[0],n=e[0],r=e[0],i=e[0],a=0;a<e.length;a++){var l=e[a];l[0]<t[0]&&(t=l),l[0]>r[0]&&(r=l),l[1]<n[1]&&(n=l),l[1]>i[1]&&(i=l)}var o=[t,n,r,i],f=o.slice();for(a=0;a<e.length;a++)g7(e[a],o)||f.push(e[a]);return E7(f)}function uO(e,t){var n={p:e,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return t?(n.next=t.next,n.prev=t,t.next.prev=n,t.next=n):(n.prev=n,n.next=n),n}function iT(e,t){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function oT(e,t,n){var r=t[0],i=t[1],a=n[0]-r,l=n[1]-i;if(a!==0||l!==0){var o=((e[0]-r)*a+(e[1]-i)*l)/(a*a+l*l);o>1?(r=n[0],i=n[1]):o>0&&(r+=a*o,i+=l*o)}return a=e[0]-r,l=e[1]-i,a*a+l*l}function $x(e,t,n,r,i,a,l,o){var f=n-e,p=r-t,y=l-i,x=o-a,w=e-i,S=t-a,L=f*f+p*p,D=f*y+p*x,B=y*y+x*x,z=f*w+p*S,M=y*w+x*S,k=L*B-D*D,V,q,Y,K,X=k,U=k;k===0?(q=0,X=1,K=M,U=B):(q=D*M-B*z,K=L*M-D*z,q<0?(q=0,K=M,U=B):q>X&&(q=X,K=M+D,U=B)),K<0?(K=0,-z<0?q=0:-z>L?q=X:(q=-z,X=L)):K>U&&(K=U,-z+D<0?q=0:-z+D>L?q=X:(q=-z+D,X=L)),V=q===0?0:q/X,Y=K===0?0:K/U;var le=(1-V)*e+V*n,ue=(1-V)*t+V*r,ae=(1-Y)*i+Y*l,ve=(1-Y)*a+Y*o,Ee=ae-le,He=ve-ue;return Ee*Ee+He*He}function w7(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]}function E7(e){e.sort(w7);for(var t=[],n=0;n<e.length;n++){for(;t.length>=2&&Mm(t[t.length-2],t[t.length-1],e[n])<=0;)t.pop();t.push(e[n])}for(var r=[],i=e.length-1;i>=0;i--){for(;r.length>=2&&Mm(r[r.length-2],r[r.length-1],e[i])<=0;)r.pop();r.push(e[i])}return r.pop(),t.pop(),t.concat(r)}var S7=WC.exports;const T7=Vs(S7);function Kk(e,t){t===void 0&&(t={}),t.concavity=t.concavity||1/0;var n=[];if(mo(e,function(i){n.push([i[0],i[1]])}),!n.length)return null;var r=T7(n,t.concavity);return r.length>3?fr([r]):null}function Li(e,t,n){if(n===void 0&&(n={}),!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var r=Ti(e),i=Oi(t),a=i.type,l=t.bbox,o=i.coordinates;if(l&&I7(r,l)===!1)return!1;a==="Polygon"&&(o=[o]);for(var f=!1,p=0;p<o.length&&!f;p++)if(cO(r,o[p][0],n.ignoreBoundary)){for(var y=!1,x=1;x<o[p].length&&!y;)cO(r,o[p][x],!n.ignoreBoundary)&&(y=!0),x++;y||(f=!0)}return f}function cO(e,t,n){var r=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var i=0,a=t.length-1;i<t.length;a=i++){var l=t[i][0],o=t[i][1],f=t[a][0],p=t[a][1],y=e[1]*(l-f)+o*(f-e[0])+p*(e[0]-l)===0&&(l-e[0])*(f-e[0])<=0&&(o-e[1])*(p-e[1])<=0;if(y)return!n;var x=o>e[1]!=p>e[1]&&e[0]<(f-l)*(e[1]-o)/(p-o)+l;x&&(r=!r)}return r}function I7(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}function nI(e,t){var n=[];return ti(e,function(r){var i=!1;if(r.geometry.type==="Point")sl(t,function(l){Li(r,l)&&(i=!0)}),i&&n.push(r);else if(r.geometry.type==="MultiPoint"){var a=[];sl(t,function(l){mo(r,function(o){Li(o,l)&&(i=!0,a.push(o))})}),i&&n.push(G0(a))}else throw new Error("Input geometry must be a Point or MultiPoint")}),An(n)}function ei(e,t,n){n===void 0&&(n={});var r=Ti(e),i=Ti(t),a=oa(i[1]-r[1]),l=oa(i[0]-r[0]),o=oa(r[1]),f=oa(i[1]),p=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(o)*Math.cos(f);return Xm(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)),n.units)}function Jk(e,t){var n=!1;return An(A7(e.features.map(function(r){var i={x:r.geometry.coordinates[0],y:r.geometry.coordinates[1]};return t?i.z=r.properties[t]:r.geometry.coordinates.length===3&&(n=!0,i.z=r.geometry.coordinates[2]),i})).map(function(r){var i=[r.a.x,r.a.y],a=[r.b.x,r.b.y],l=[r.c.x,r.c.y],o={};return n?(i.push(r.a.z),a.push(r.b.z),l.push(r.c.z)):o={a:r.a.z,b:r.b.z,c:r.c.z},fr([[i,a,l,i]],o)}))}var hO=function(){function e(t,n,r){this.a=t,this.b=n,this.c=r;var i=n.x-t.x,a=n.y-t.y,l=r.x-t.x,o=r.y-t.y,f=i*(t.x+n.x)+a*(t.y+n.y),p=l*(t.x+r.x)+o*(t.y+r.y),y=2*(i*(r.y-n.y)-a*(r.x-n.x)),x,w;this.x=(o*f-a*p)/y,this.y=(i*p-l*f)/y,x=this.x-t.x,w=this.y-t.y,this.r=x*x+w*w}return e}();function C7(e,t){return t.x-e.x}function P7(e){var t=e.length,n,r,i,a,l;e:for(;t;)for(r=e[--t],n=e[--t],i=t;i;)if(l=e[--i],a=e[--i],n===a&&r===l||n===l&&r===a){e.splice(t,2),e.splice(i,2),t-=2;continue e}}function A7(e){if(e.length<3)return[];e.sort(C7);for(var t=e.length-1,n=e[t].x,r=e[0].x,i=e[t].y,a=i,l=1e-12,o,f,p,y,x,w;t--;)e[t].y<i&&(i=e[t].y),e[t].y>a&&(a=e[t].y);var S=r-n,L=a-i,D=S>L?S:L,B=(r+n)*.5,z=(a+i)*.5,M=[new hO({__sentinel:!0,x:B-20*D,y:z-D},{__sentinel:!0,x:B,y:z+20*D},{__sentinel:!0,x:B+20*D,y:z-D})],k=[],V=[],q;for(t=e.length;t--;){for(V.length=0,q=M.length;q--;){if(S=e[t].x-M[q].x,S>0&&S*S>M[q].r){k.push(M[q]),M.splice(q,1);continue}L=e[t].y-M[q].y,!(S*S+L*L>M[q].r)&&(V.push(M[q].a,M[q].b,M[q].b,M[q].c,M[q].c,M[q].a),M.splice(q,1))}for(P7(V),q=V.length;q;)f=V[--q],o=V[--q],p=e[t],y=f.x-o.x,x=f.y-o.y,w=2*(y*(p.y-f.y)-x*(p.x-f.x)),Math.abs(w)>l&&M.push(new hO(o,f,p))}for(Array.prototype.push.apply(k,M),t=k.length;t--;)(k[t].a.__sentinel||k[t].b.__sentinel||k[t].c.__sentinel)&&k.splice(t,1);return k}function Ua(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return Qk(e);case"FeatureCollection":return M7(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return HC(e);default:throw new Error("unknown GeoJSON type")}}function Qk(e){var t={type:"Feature"};return Object.keys(e).forEach(function(n){switch(n){case"type":case"properties":case"geometry":return;default:t[n]=e[n]}}),t.properties=eN(e.properties),t.geometry=HC(e.geometry),t}function eN(e){var t={};return e&&Object.keys(e).forEach(function(n){var r=e[n];typeof r=="object"?r===null?t[n]=null:Array.isArray(r)?t[n]=r.map(function(i){return i}):t[n]=eN(r):t[n]=r}),t}function M7(e){var t={type:"FeatureCollection"};return Object.keys(e).forEach(function(n){switch(n){case"type":case"features":return;default:t[n]=e[n]}}),t.features=e.features.map(function(n){return Qk(n)}),t}function HC(e){var t={type:e.type};return e.bbox&&(t.bbox=e.bbox),e.type==="GeometryCollection"?(t.geometries=e.geometries.map(function(n){return HC(n)}),t):(t.coordinates=tN(e.coordinates),t)}function tN(e){var t=e;return typeof t[0]!="object"?t.slice():t.map(function(n){return tN(n)})}function L7(e,t){if(t===void 0&&(t={}),t=t||{},!li(t))throw new Error("options is invalid");var n=t.mutate;if(Ds(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(n===!1||n===void 0)&&(e=Ua(e));var r=[],i=qC(e,function(a,l){var o=O7(a,l);return o||(r.push(a),l)});return i&&r.push(i),r.length?r.length===1?r[0]:_d(r.map(function(a){return a.coordinates})):null}function jx(e){return e[0].toString()+","+e[1].toString()}function O7(e,t){var n=e.geometry.coordinates,r=t.geometry.coordinates,i=jx(n[0]),a=jx(n[n.length-1]),l=jx(r[0]),o=jx(r[r.length-1]),f;if(i===o)f=r.concat(n.slice(1));else if(l===a)f=n.concat(r.slice(1));else if(i===l)f=n.slice(1).reverse().concat(r);else if(a===o)f=n.concat(r.reverse().slice(1));else return null;return oi(f)}function D7(e){return e}function R7(e){if(e==null)return D7;var t,n,r=e.scale[0],i=e.scale[1],a=e.translate[0],l=e.translate[1];return function(o,f){f||(t=n=0);var p=2,y=o.length,x=new Array(y);for(x[0]=(t+=o[0])*r+a,x[1]=(n+=o[1])*i+l;p<y;)x[p]=o[p],++p;return x}}function k7(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function nN(e,t){var n=R7(e.transform),r=e.arcs;function i(y,x){x.length&&x.pop();for(var w=r[y<0?~y:y],S=0,L=w.length;S<L;++S)x.push(n(w[S],S));y<0&&k7(x,L)}function a(y){return n(y)}function l(y){for(var x=[],w=0,S=y.length;w<S;++w)i(y[w],x);return x.length<2&&x.push(x[0]),x}function o(y){for(var x=l(y);x.length<4;)x.push(x[0]);return x}function f(y){return y.map(o)}function p(y){var x=y.type,w;switch(x){case"GeometryCollection":return{type:x,geometries:y.geometries.map(p)};case"Point":w=a(y.coordinates);break;case"MultiPoint":w=y.coordinates.map(a);break;case"LineString":w=l(y.arcs);break;case"MultiLineString":w=y.arcs.map(l);break;case"Polygon":w=f(y.arcs);break;case"MultiPolygon":w=y.arcs.map(f);break;default:return null}return{type:x,coordinates:w}}return p(t)}function N7(e,t){var n={},r={},i={},a=[],l=-1;t.forEach(function(p,y){var x=e.arcs[p<0?~p:p],w;x.length<3&&!x[1][0]&&!x[1][1]&&(w=t[++l],t[l]=p,t[y]=w)}),t.forEach(function(p){var y=o(p),x=y[0],w=y[1],S,L;if(S=i[x])if(delete i[S.end],S.push(p),S.end=w,L=r[w]){delete r[L.start];var D=L===S?S:S.concat(L);r[D.start=S.start]=i[D.end=L.end]=D}else r[S.start]=i[S.end]=S;else if(S=r[w])if(delete r[S.start],S.unshift(p),S.start=x,L=i[x]){delete i[L.end];var B=L===S?S:L.concat(S);r[B.start=L.start]=i[B.end=S.end]=B}else r[S.start]=i[S.end]=S;else S=[p],r[S.start=x]=i[S.end=w]=S});function o(p){var y=e.arcs[p<0?~p:p],x=y[0],w;return e.transform?(w=[0,0],y.forEach(function(S){w[0]+=S[0],w[1]+=S[1]})):w=y[y.length-1],p<0?[w,x]:[x,w]}function f(p,y){for(var x in p){var w=p[x];delete y[w.start],delete w.start,delete w.end,w.forEach(function(S){n[S<0?~S:S]=1}),a.push(w)}}return f(i,r),f(r,i),t.forEach(function(p){n[p<0?~p:p]||a.push([p])}),a}function F7(e){for(var t=-1,n=e.length,r,i=e[n-1],a=0;++t<n;)r=i,i=e[t],a+=r[0]*i[1]-r[1]*i[0];return Math.abs(a)}function B7(e){return nN(e,z7.apply(this,arguments))}function z7(e,t){var n={},r=[],i=[];t.forEach(a);function a(f){switch(f.type){case"GeometryCollection":f.geometries.forEach(a);break;case"Polygon":l(f.arcs);break;case"MultiPolygon":f.arcs.forEach(l);break}}function l(f){f.forEach(function(p){p.forEach(function(y){(n[y=y<0?~y:y]||(n[y]=[])).push(f)})}),r.push(f)}function o(f){return F7(nN(e,{type:"Polygon",arcs:[f]}).coordinates[0])}return r.forEach(function(f){if(!f._){var p=[],y=[f];for(f._=1,i.push(p);f=y.pop();)p.push(f),f.forEach(function(x){x.forEach(function(w){n[w<0?~w:w].forEach(function(S){S._||(S._=1,y.push(S))})})})}}),r.forEach(function(f){delete f._}),{type:"MultiPolygon",arcs:i.map(function(f){var p=[],y;if(f.forEach(function(D){D.forEach(function(B){B.forEach(function(z){n[z<0?~z:z].length<2&&p.push(z)})})}),p=N7(e,p),(y=p.length)>1)for(var x=1,w=o(p[0]),S,L;x<y;++x)(S=o(p[x]))>w&&(L=p[0],p[0]=p[x],p[x]=L,w=S);return p}).filter(function(f){return f.length>0})}}var bw=Object.prototype.hasOwnProperty;function U7(e){var t=1/0,n=1/0,r=-1/0,i=-1/0;function a(x){x!=null&&bw.call(l,x.type)&&l[x.type](x)}var l={GeometryCollection:function(x){x.geometries.forEach(a)},Point:function(x){o(x.coordinates)},MultiPoint:function(x){x.coordinates.forEach(o)},LineString:function(x){f(x.arcs)},MultiLineString:function(x){x.arcs.forEach(f)},Polygon:function(x){x.arcs.forEach(f)},MultiPolygon:function(x){x.arcs.forEach(p)}};function o(x){var w=x[0],S=x[1];w<t&&(t=w),w>r&&(r=w),S<n&&(n=S),S>i&&(i=S)}function f(x){x.forEach(o)}function p(x){x.forEach(f)}for(var y in e)a(e[y]);return r>=t&&i>=n?[t,n,r,i]:void 0}function V7(e,t,n,r,i){arguments.length===3&&(r=Array,i=null);for(var a=new r(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),l=e-1,o=0;o<e;++o)a[o]=i;function f(x){for(var w=t(x)&l,S=a[w],L=0;S!=i;){if(n(S,x))return!0;if(++L>=e)throw new Error("full hashset");S=a[w=w+1&l]}return a[w]=x,!0}function p(x){for(var w=t(x)&l,S=a[w],L=0;S!=i;){if(n(S,x))return!0;if(++L>=e)break;S=a[w=w+1&l]}return!1}function y(){for(var x=[],w=0,S=a.length;w<S;++w){var L=a[w];L!=i&&x.push(L)}return x}return{add:f,has:p,values:y}}function YC(e,t,n,r,i,a){arguments.length===3&&(r=a=Array,i=null);for(var l=new r(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),o=new a(e),f=e-1,p=0;p<e;++p)l[p]=i;function y(L,D){for(var B=t(L)&f,z=l[B],M=0;z!=i;){if(n(z,L))return o[B]=D;if(++M>=e)throw new Error("full hashmap");z=l[B=B+1&f]}return l[B]=L,o[B]=D,D}function x(L,D){for(var B=t(L)&f,z=l[B],M=0;z!=i;){if(n(z,L))return o[B];if(++M>=e)throw new Error("full hashmap");z=l[B=B+1&f]}return l[B]=L,o[B]=D,D}function w(L,D){for(var B=t(L)&f,z=l[B],M=0;z!=i;){if(n(z,L))return o[B];if(++M>=e)break;z=l[B=B+1&f]}return D}function S(){for(var L=[],D=0,B=l.length;D<B;++D){var z=l[D];z!=i&&L.push(z)}return L}return{set:y,maybeSet:x,get:w,keys:S}}function wp(e,t){return e[0]===t[0]&&e[1]===t[1]}var rN=new ArrayBuffer(16),fO=new Float64Array(rN),qx=new Uint32Array(rN);function rI(e){fO[0]=e[0],fO[1]=e[1];var t=qx[0]^qx[1];return t=t<<5^t>>7^qx[2]^qx[3],t&2147483647}function G7(e){var t=e.coordinates,n=e.lines,r=e.rings,i=Y(),a=new Int32Array(t.length),l=new Int32Array(t.length),o=new Int32Array(t.length),f=new Int8Array(t.length),p=0,y,x,w,S,L;for(y=0,x=t.length;y<x;++y)a[y]=l[y]=o[y]=-1;for(y=0,x=n.length;y<x;++y){var D=n[y],B=D[0],z=D[1];for(S=i[B],L=i[++B],++p,f[S]=1;++B<=z;)q(y,w=S,S=L,L=i[B]);++p,f[L]=1}for(y=0,x=t.length;y<x;++y)a[y]=-1;for(y=0,x=r.length;y<x;++y){var M=r[y],k=M[0]+1,V=M[1];for(w=i[V-1],S=i[k-1],L=i[k],q(y,w,S,L);++k<=V;)q(y,w=S,S=L,L=i[k])}function q(ue,ae,ve,Ee){if(a[ve]!==ue){a[ve]=ue;var He=l[ve];if(He>=0){var Oe=o[ve];(He!==ae||Oe!==Ee)&&(He!==Ee||Oe!==ae)&&(++p,f[ve]=1)}else l[ve]=ae,o[ve]=Ee}}function Y(){for(var ue=YC(t.length*1.4,K,X,Int32Array,-1,Int32Array),ae=new Int32Array(t.length),ve=0,Ee=t.length;ve<Ee;++ve)ae[ve]=ue.maybeSet(ve,ve);return ae}function K(ue){return rI(t[ue])}function X(ue,ae){return wp(t[ue],t[ae])}a=l=o=null;var U=V7(p*1.4,rI,wp),le;for(y=0,x=t.length;y<x;++y)f[le=i[y]]&&U.add(t[le]);return U}function $7(e){var t=G7(e),n=e.coordinates,r=e.lines,i=e.rings,a,l,o;for(l=0,o=r.length;l<o;++l)for(var f=r[l],p=f[0],y=f[1];++p<y;)t.has(n[p])&&(a={0:p,1:f[1]},f[1]=p,f=f.next=a);for(l=0,o=i.length;l<o;++l)for(var x=i[l],w=x[0],S=w,L=x[1],D=t.has(n[w]);++S<L;)t.has(n[S])&&(D?(a={0:S,1:x[1]},x[1]=S,x=x.next=a):(j7(n,w,L,L-S),n[L]=n[w],D=!0,S=w));return e}function j7(e,t,n,r){aT(e,t,n),aT(e,t,t+r),aT(e,t+r,n)}function aT(e,t,n){for(var r=t+(n---t>>1),i;t<r;++t,--n)i=e[t],e[t]=e[n],e[n]=i}function q7(e){var t=e.coordinates,n=e.lines,r,i=e.rings,a,l=n.length+i.length,o,f;for(delete e.lines,delete e.rings,o=0,f=n.length;o<f;++o)for(r=n[o];r=r.next;)++l;for(o=0,f=i.length;o<f;++o)for(a=i[o];a=a.next;)++l;var p=YC(l*2*1.4,rI,wp),y=e.arcs=[];for(o=0,f=n.length;o<f;++o){r=n[o];do x(r);while(r=r.next)}for(o=0,f=i.length;o<f;++o)if(a=i[o],a.next)do x(a);while(a=a.next);else w(a);function x(M){var k,V,q,Y,K,X,U,le;if(q=p.get(k=t[M[0]])){for(U=0,le=q.length;U<le;++U)if(Y=q[U],S(Y,M)){M[0]=Y[0],M[1]=Y[1];return}}if(K=p.get(V=t[M[1]])){for(U=0,le=K.length;U<le;++U)if(X=K[U],L(X,M)){M[1]=X[0],M[0]=X[1];return}}q?q.push(M):p.set(k,[M]),K?K.push(M):p.set(V,[M]),y.push(M)}function w(M){var k,V,q,Y,K;if(V=p.get(k=t[M[0]]))for(Y=0,K=V.length;Y<K;++Y){if(q=V[Y],D(q,M)){M[0]=q[0],M[1]=q[1];return}if(B(q,M)){M[0]=q[1],M[1]=q[0];return}}if(V=p.get(k=t[M[0]+z(M)]))for(Y=0,K=V.length;Y<K;++Y){if(q=V[Y],D(q,M)){M[0]=q[0],M[1]=q[1];return}if(B(q,M)){M[0]=q[1],M[1]=q[0];return}}V?V.push(M):p.set(k,[M]),y.push(M)}function S(M,k){var V=M[0],q=k[0],Y=M[1],K=k[1];if(V-Y!==q-K)return!1;for(;V<=Y;++V,++q)if(!wp(t[V],t[q]))return!1;return!0}function L(M,k){var V=M[0],q=k[0],Y=M[1],K=k[1];if(V-Y!==q-K)return!1;for(;V<=Y;++V,--K)if(!wp(t[V],t[K]))return!1;return!0}function D(M,k){var V=M[0],q=k[0],Y=M[1],K=k[1],X=Y-V;if(X!==K-q)return!1;for(var U=z(M),le=z(k),ue=0;ue<X;++ue)if(!wp(t[V+(ue+U)%X],t[q+(ue+le)%X]))return!1;return!0}function B(M,k){var V=M[0],q=k[0],Y=M[1],K=k[1],X=Y-V;if(X!==K-q)return!1;for(var U=z(M),le=X-z(k),ue=0;ue<X;++ue)if(!wp(t[V+(ue+U)%X],t[K-(ue+le)%X]))return!1;return!0}function z(M){for(var k=M[0],V=M[1],q=k,Y=q,K=t[q];++q<V;){var X=t[q];(X[0]<K[0]||X[0]===K[0]&&X[1]<K[1])&&(Y=q,K=X)}return Y-k}return e}function Z7(e){for(var t=-1,n=e.length;++t<n;){for(var r=e[t],i=0,a=1,l=r.length,o=r[0],f=o[0],p=o[1],y,x;++i<l;)o=r[i],y=o[0],x=o[1],(y!==f||x!==p)&&(r[a++]=[y-f,x-p],f=y,p=x);a===1&&(r[a++]=[0,0]),r.length=a}return e}function X7(e){var t=-1,n=[],r=[],i=[];function a(x){x&&bw.call(l,x.type)&&l[x.type](x)}var l={GeometryCollection:function(x){x.geometries.forEach(a)},LineString:function(x){x.arcs=o(x.arcs)},MultiLineString:function(x){x.arcs=x.arcs.map(o)},Polygon:function(x){x.arcs=x.arcs.map(f)},MultiPolygon:function(x){x.arcs=x.arcs.map(p)}};function o(x){for(var w=0,S=x.length;w<S;++w)i[++t]=x[w];var L={0:t-S+1,1:t};return n.push(L),L}function f(x){for(var w=0,S=x.length;w<S;++w)i[++t]=x[w];var L={0:t-S+1,1:t};return r.push(L),L}function p(x){return x.map(f)}for(var y in e)a(e[y]);return{type:"Topology",coordinates:i,lines:n,rings:r,objects:e}}function W7(e){var t={},n;for(n in e)t[n]=H7(e[n]);return t}function H7(e){return e==null?{type:null}:(e.type==="FeatureCollection"?Y7:e.type==="Feature"?iN:KC)(e)}function Y7(e){var t={type:"GeometryCollection",geometries:e.features.map(iN)};return e.bbox!=null&&(t.bbox=e.bbox),t}function iN(e){var t=KC(e.geometry),n;e.id!=null&&(t.id=e.id),e.bbox!=null&&(t.bbox=e.bbox);for(n in e.properties){t.properties=e.properties;break}return t}function KC(e){if(e==null)return{type:null};var t=e.type==="GeometryCollection"?{type:"GeometryCollection",geometries:e.geometries.map(KC)}:e.type==="Point"||e.type==="MultiPoint"?{type:e.type,coordinates:e.coordinates}:{type:e.type,arcs:e.coordinates};return e.bbox!=null&&(t.bbox=e.bbox),t}function K7(e,t,n){var r=t[0],i=t[1],a=t[2],l=t[3],o=a-r?(n-1)/(a-r):1,f=l-i?(n-1)/(l-i):1;function p(z){return[Math.round((z[0]-r)*o),Math.round((z[1]-i)*f)]}function y(z,M){for(var k=-1,V=0,q=z.length,Y=new Array(q),K,X,U,le,ue;++k<q;)K=z[k],le=Math.round((K[0]-r)*o),ue=Math.round((K[1]-i)*f),(le!==X||ue!==U)&&(Y[V++]=[X=le,U=ue]);for(Y.length=V;V<M;)V=Y.push([Y[0][0],Y[0][1]]);return Y}function x(z){return y(z,2)}function w(z){return y(z,4)}function S(z){return z.map(w)}function L(z){z!=null&&bw.call(D,z.type)&&D[z.type](z)}var D={GeometryCollection:function(z){z.geometries.forEach(L)},Point:function(z){z.coordinates=p(z.coordinates)},MultiPoint:function(z){z.coordinates=z.coordinates.map(p)},LineString:function(z){z.arcs=x(z.arcs)},MultiLineString:function(z){z.arcs=z.arcs.map(x)},Polygon:function(z){z.arcs=S(z.arcs)},MultiPolygon:function(z){z.arcs=z.arcs.map(S)}};for(var B in e)L(e[B]);return{scale:[1/o,1/f],translate:[r,i]}}function J7(e,t){var n=U7(e=W7(e)),r=t>0&&n&&K7(e,n,t),i=q7($7(X7(e))),a=i.coordinates,l=YC(i.arcs.length*1.4,Q7,eG);e=i.objects,i.bbox=n,i.arcs=i.arcs.map(function(w,S){return l.set(w,S),a.slice(w[0],w[1]+1)}),delete i.coordinates,a=null;function o(w){w&&bw.call(f,w.type)&&f[w.type](w)}var f={GeometryCollection:function(w){w.geometries.forEach(o)},LineString:function(w){w.arcs=p(w.arcs)},MultiLineString:function(w){w.arcs=w.arcs.map(p)},Polygon:function(w){w.arcs=w.arcs.map(p)},MultiPolygon:function(w){w.arcs=w.arcs.map(y)}};function p(w){var S=[];do{var L=l.get(w);S.push(w[0]<w[1]?L:~L)}while(w=w.next);return S}function y(w){return w.map(p)}for(var x in e)o(e[x]);return r&&(i.transform=r,i.arcs=Z7(i.arcs)),i}function Q7(e){var t=e[0],n=e[1],r;return n<t&&(r=t,t=n,n=r),t+31*n}function eG(e,t){var n=e[0],r=e[1],i=t[0],a=t[1],l;return r<n&&(l=n,n=r,r=l),a<i&&(l=i,i=a,a=l),n===i&&r===a}function tG(e,t){if(t===void 0&&(t={}),Ds(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(t.mutate===!1||t.mutate===void 0)&&(e=Ua(e));var n=[];xa(e,function(a){n.push(a.geometry)});var r=J7({geoms:BC(n).geometry}),i=B7(r,r.objects.geoms.geometries);return i}function nG(e,t){if(t===void 0&&(t={}),t=t||{},!li(t))throw new Error("options is invalid");var n=t.mutate;if(Ds(e)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!e.features.length)throw new Error("geojson is empty");(n===!1||n===void 0)&&(e=Ua(e));var r=rG(e);if(!r)throw new Error("geojson must be homogenous");var i=e;switch(r){case"LineString":return L7(i,t);case"Polygon":return tG(i,t);default:throw new Error(r+" is not supported")}}function rG(e){var t={};xa(e,function(r){t[r.geometry.type]=!0});var n=Object.keys(t);return n.length===1?n[0]:null}function iG(e,t){t===void 0&&(t={});var n=t.maxEdge||1/0,r=oG(e),i=Jk(r);if(i.features=i.features.filter(function(l){var o=l.geometry.coordinates[0][0],f=l.geometry.coordinates[0][1],p=l.geometry.coordinates[0][2],y=ei(o,f,t),x=ei(f,p,t),w=ei(o,p,t);return y<=n&&x<=n&&w<=n}),i.features.length<1)return null;var a=nG(i);return a.coordinates.length===1&&(a.coordinates=a.coordinates[0],a.type="Polygon"),$o(a)}function oG(e){var t=[],n={};return ti(e,function(r){if(r.geometry){var i=r.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(n,i)||(t.push(r),n[i]=!0)}}),An(t)}var JC={exports:{}},oN={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(V0,function(){function n(l,o,f,p,y){r(l,o,f||0,p||l.length-1,y||a)}function r(l,o,f,p,y){for(;p>f;){if(p-f>600){var x=p-f+1,w=o-f+1,S=Math.log(x),L=.5*Math.exp(2*S/3),D=.5*Math.sqrt(S*L*(x-L)/x)*(w-x/2<0?-1:1),B=Math.max(f,Math.floor(o-w*L/x+D)),z=Math.min(p,Math.floor(o+(x-w)*L/x+D));r(l,o,B,z,y)}var M=l[o],k=f,V=p;for(i(l,f,o),y(l[p],M)>0&&i(l,f,p);k<V;){for(i(l,k,V),k++,V--;y(l[k],M)<0;)k++;for(;y(l[V],M)>0;)V--}y(l[f],M)===0?i(l,f,V):(V++,i(l,V,p)),V<=o&&(f=V+1),o<=V&&(p=V-1)}}function i(l,o,f){var p=l[o];l[o]=l[f],l[f]=p}function a(l,o){return l<o?-1:l>o?1:0}return n})})(oN);var aG=oN.exports;JC.exports=s0;JC.exports.default=s0;var sG=aG;function s0(e,t){if(!(this instanceof s0))return new s0(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),t&&this._initFormat(t),this.clear()}s0.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,n=[],r=this.toBBox;if(!Xx(e,t))return n;for(var i=[],a,l,o,f;t;){for(a=0,l=t.children.length;a<l;a++)o=t.children[a],f=t.leaf?r(o):o,Xx(e,f)&&(t.leaf?n.push(o):lT(e,f)?this._all(o,n):i.push(o));t=i.pop()}return n},collides:function(e){var t=this.data,n=this.toBBox;if(!Xx(e,t))return!1;for(var r=[],i,a,l,o;t;){for(i=0,a=t.children.length;i<a;i++)if(l=t.children[i],o=t.leaf?n(l):l,Xx(e,o)){if(t.leaf||lT(e,o))return!0;r.push(l)}t=r.pop()}return!1},load:function(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(var t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=r;else if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=Cm([]),this},remove:function(e,t){if(!e)return this;for(var n=this.data,r=this.toBBox(e),i=[],a=[],l,o,f,p;n||i.length;){if(n||(n=i.pop(),o=i[i.length-1],l=a.pop(),p=!0),n.leaf&&(f=lG(e,n.children,t),f!==-1))return n.children.splice(f,1),i.push(n),this._condense(i),this;!p&&!n.leaf&&lT(n,r)?(i.push(n),a.push(l),l=0,o=n,n=n.children[0]):o?(l++,n=o.children[l],p=!1):n=null}return this},toBBox:function(e){return e},compareMinX:dO,compareMinY:pO,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},_build:function(e,t,n,r){var i=n-t+1,a=this._maxEntries,l;if(i<=a)return l=Cm(e.slice(t,n+1)),ym(l,this.toBBox),l;r||(r=Math.ceil(Math.log(i)/Math.log(a)),a=Math.ceil(i/Math.pow(a,r-1))),l=Cm([]),l.leaf=!1,l.height=r;var o=Math.ceil(i/a),f=o*Math.ceil(Math.sqrt(a)),p,y,x,w;for(gO(e,t,n,f,this.compareMinX),p=t;p<=n;p+=f)for(x=Math.min(p+f-1,n),gO(e,p,x,o,this.compareMinY),y=p;y<=x;y+=o)w=Math.min(y+o-1,x),l.children.push(this._build(e,y,w,r-1));return ym(l,this.toBBox),l},_chooseSubtree:function(e,t,n,r){for(var i,a,l,o,f,p,y,x;r.push(t),!(t.leaf||r.length-1===n);){for(y=x=1/0,i=0,a=t.children.length;i<a;i++)l=t.children[i],f=sT(l),p=uG(e,l)-f,p<x?(x=p,y=f<y?f:y,o=l):p===x&&f<y&&(y=f,o=l);t=o||t.children[0]}return t},_insert:function(e,t,n){var r=this.toBBox,i=n?e:r(e),a=[],l=this._chooseSubtree(i,this.data,t,a);for(l.children.push(e),F_(l,i);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(i,a,t)},_split:function(e,t){var n=e[t],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var a=this._chooseSplitIndex(n,i,r),l=Cm(n.children.splice(a,n.children.length-a));l.height=n.height,l.leaf=n.leaf,ym(n,this.toBBox),ym(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(n,l)},_splitRoot:function(e,t){this.data=Cm([e,t]),this.data.height=e.height+1,this.data.leaf=!1,ym(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,n){var r,i,a,l,o,f,p,y;for(f=p=1/0,r=t;r<=n-t;r++)i=N_(e,0,r,this.toBBox),a=N_(e,r,n,this.toBBox),l=cG(i,a),o=sT(i)+sT(a),l<f?(f=l,y=r,p=o<p?o:p):l===f&&o<p&&(p=o,y=r);return y},_chooseSplitAxis:function(e,t,n){var r=e.leaf?this.compareMinX:dO,i=e.leaf?this.compareMinY:pO,a=this._allDistMargin(e,t,n,r),l=this._allDistMargin(e,t,n,i);a<l&&e.children.sort(r)},_allDistMargin:function(e,t,n,r){e.children.sort(r);var i=this.toBBox,a=N_(e,0,t,i),l=N_(e,n-t,n,i),o=Zx(a)+Zx(l),f,p;for(f=t;f<n-t;f++)p=e.children[f],F_(a,e.leaf?i(p):p),o+=Zx(a);for(f=n-t-1;f>=t;f--)p=e.children[f],F_(l,e.leaf?i(p):p),o+=Zx(l);return o},_adjustParentBBoxes:function(e,t,n){for(var r=n;r>=0;r--)F_(t[r],e)},_condense:function(e){for(var t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():ym(e[t],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}};function lG(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function ym(e,t){N_(e,0,e.children.length,t,e)}function N_(e,t,n,r,i){i||(i=Cm(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var a=t,l;a<n;a++)l=e.children[a],F_(i,e.leaf?r(l):l);return i}function F_(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function dO(e,t){return e.minX-t.minX}function pO(e,t){return e.minY-t.minY}function sT(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function Zx(e){return e.maxX-e.minX+(e.maxY-e.minY)}function uG(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function cG(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,i-n)*Math.max(0,a-r)}function lT(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function Xx(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function Cm(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function gO(e,t,n,r,i){for(var a=[t,n],l;a.length;)n=a.pop(),t=a.pop(),!(n-t<=r)&&(l=t+Math.ceil((n-t)/r/2)*r,sG(e,l,t,n,i),a.push(t,l,l,n))}var hG=JC.exports;const QC=Vs(hG);function fG(e,t,n,r){var i=QC(6),a=t.features.map(function(l){var o;return{minX:l.geometry.coordinates[0],minY:l.geometry.coordinates[1],maxX:l.geometry.coordinates[0],maxY:l.geometry.coordinates[1],property:(o=l.properties)===null||o===void 0?void 0:o[n]}});return i.load(a),e.features.forEach(function(l){l.properties||(l.properties={});var o=ao(l),f=i.search({minX:o[0],minY:o[1],maxX:o[2],maxY:o[3]}),p=[];f.forEach(function(y){Li([y.minX,y.minY],l)&&p.push(y.property)}),l.properties[r]=p}),e}function dG(e,t){if(t=t||{},!li(t))throw new Error("options is invalid");var n=t.mutate;if(!e)throw new Error("geojson is required");return(n===!1||n===void 0)&&(e=Ua(e)),mo(e,function(r){var i=r[0],a=r[1];r[0]=a,r[1]=i}),e}function Bp(e,t){t===void 0&&(t={});var n=typeof t=="object"?t.mutate:t;if(!e)throw new Error("geojson is required");var r=Ds(e),i=[];switch(r){case"LineString":i=uT(e);break;case"MultiLineString":case"Polygon":kn(e).forEach(function(l){i.push(uT(l))});break;case"MultiPolygon":kn(e).forEach(function(l){var o=[];l.forEach(function(f){o.push(uT(f))}),i.push(o)});break;case"Point":return e;case"MultiPoint":var a={};kn(e).forEach(function(l){var o=l.join("-");Object.prototype.hasOwnProperty.call(a,o)||(i.push(l),a[o]=!0)});break;default:throw new Error(r+" geometry not supported")}return e.coordinates?n===!0?(e.coordinates=i,e):{type:r,coordinates:i}:n===!0?(e.geometry.coordinates=i,e):$o({type:r,coordinates:i},e.properties,{bbox:e.bbox,id:e.id})}function uT(e){var t=kn(e);if(t.length===2&&!mO(t[0],t[1]))return t;var n=[],r=t.length-1,i=n.length;n.push(t[0]);for(var a=1;a<r;a++){var l=n[n.length-1];t[a][0]===l[0]&&t[a][1]===l[1]||(n.push(t[a]),i=n.length,i>2&&yO(n[i-3],n[i-1],n[i-2])&&n.splice(n.length-2,1))}if(n.push(t[t.length-1]),i=n.length,mO(t[0],t[t.length-1])&&i<4)throw new Error("invalid polygon");return yO(n[i-3],n[i-1],n[i-2])&&n.splice(n.length-2,1),n}function mO(e,t){return e[0]===t[0]&&e[1]===t[1]}function yO(e,t,n){var r=n[0],i=n[1],a=e[0],l=e[1],o=t[0],f=t[1],p=r-a,y=i-l,x=o-a,w=f-l,S=p*w-y*x;return S!==0?!1:Math.abs(x)>=Math.abs(w)?x>0?a<=r&&r<=o:o<=r&&r<=a:w>0?l<=i&&i<=f:f<=i&&i<=l}function pG(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function gG(e,t,n){var r=t.x,i=t.y,a=n.x-r,l=n.y-i;if(a!==0||l!==0){var o=((e.x-r)*a+(e.y-i)*l)/(a*a+l*l);o>1?(r=n.x,i=n.y):o>0&&(r+=a*o,i+=l*o)}return a=e.x-r,l=e.y-i,a*a+l*l}function mG(e,t){for(var n=e[0],r=[n],i,a=1,l=e.length;a<l;a++)i=e[a],pG(i,n)>t&&(r.push(i),n=i);return n!==i&&r.push(i),r}function iI(e,t,n,r,i){for(var a=r,l,o=t+1;o<n;o++){var f=gG(e[o],e[t],e[n]);f>a&&(l=o,a=f)}a>r&&(l-t>1&&iI(e,t,l,r,i),i.push(e[l]),n-l>1&&iI(e,l,n,r,i))}function yG(e,t){var n=e.length-1,r=[e[0]];return iI(e,0,n,t,r),r.push(e[n]),r}function oI(e,t,n){if(e.length<=2)return e;var r=t!==void 0?t*t:1;return e=n?e:mG(e,r),e=yG(e,r),e}function vG(e,t){if(t=t||{},!li(t))throw new Error("options is invalid");var n=t.tolerance!==void 0?t.tolerance:1,r=t.highQuality||!1,i=t.mutate||!1;if(!e)throw new Error("geojson is required");if(n&&n<0)throw new Error("invalid tolerance");return i!==!0&&(e=Ua(e)),sl(e,function(a){_G(a,n,r)}),e}function _G(e,t,n){var r=e.type;if(r==="Point"||r==="MultiPoint")return e;Bp(e,!0);var i=e.coordinates;switch(r){case"LineString":e.coordinates=vO(i,t,n);break;case"MultiLineString":e.coordinates=i.map(function(a){return vO(a,t,n)});break;case"Polygon":e.coordinates=_O(i,t,n);break;case"MultiPolygon":e.coordinates=i.map(function(a){return _O(a,t,n)})}return e}function vO(e,t,n){return oI(e.map(function(r){return{x:r[0],y:r[1],z:r[2]}}),t,n).map(function(r){return r.z?[r.x,r.y,r.z]:[r.x,r.y]})}function _O(e,t,n){return e.map(function(r){var i=r.map(function(l){return{x:l[0],y:l[1]}});if(i.length<4)throw new Error("invalid polygon");for(var a=oI(i,t,n).map(function(l){return[l.x,l.y]});!xG(a);)t-=t*.01,a=oI(i,t,n).map(function(l){return[l.x,l.y]});return(a[a.length-1][0]!==a[0][0]||a[a.length-1][1]!==a[0][1])&&a.push(a[0]),a})}function xG(e){return e.length<3?!1:!(e.length===3&&e[2][0]===e[0][0]&&e[2][1]===e[0][1])}var bG=function(){function e(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var n=0;n<this.length;n++)this.points[n].z=this.points[n].z||0;for(var n=0;n<this.length-1;n++){var r=this.points[n],i=this.points[n+1];this.centers.push({x:(r.x+i.x)/2,y:(r.y+i.y)/2,z:(r.z+i.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(var n=0;n<this.centers.length-1;n++){var a=this.points[n+1].x-(this.centers[n].x+this.centers[n+1].x)/2,l=this.points[n+1].y-(this.centers[n].y+this.centers[n+1].y)/2,o=this.points[n+1].z-(this.centers[n].y+this.centers[n+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[n+1].x+this.sharpness*(this.centers[n].x+a),y:(1-this.sharpness)*this.points[n+1].y+this.sharpness*(this.centers[n].y+l),z:(1-this.sharpness)*this.points[n+1].z+this.sharpness*(this.centers[n].z+o)},{x:(1-this.sharpness)*this.points[n+1].x+this.sharpness*(this.centers[n+1].x+a),y:(1-this.sharpness)*this.points[n+1].y+this.sharpness*(this.centers[n+1].y+l),z:(1-this.sharpness)*this.points[n+1].z+this.sharpness*(this.centers[n+1].z+o)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return e.prototype.cacheSteps=function(t){var n=[],r=this.pos(0);n.push(0);for(var i=0;i<this.duration;i+=10){var a=this.pos(i),l=Math.sqrt((a.x-r.x)*(a.x-r.x)+(a.y-r.y)*(a.y-r.y)+(a.z-r.z)*(a.z-r.z));l>t&&(n.push(i),r=a)}return n},e.prototype.vector=function(t){var n=this.pos(t+10),r=this.pos(t-10);return{angle:180*Math.atan2(n.y-r.y,n.x-r.x)/3.14,speed:Math.sqrt((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y)+(r.z-n.z)*(r.z-n.z))}},e.prototype.pos=function(t){var n=t-this.delay;n<0&&(n=0),n>this.duration&&(n=this.duration-1);var r=n/this.duration;if(r>=1)return this.points[this.length-1];var i=Math.floor((this.points.length-1)*r),a=(this.length-1)*r-i;return wG(a,this.points[i],this.controls[i][1],this.controls[i+1][0],this.points[i+1])},e}();function wG(e,t,n,r,i){var a=EG(e),l={x:i.x*a[0]+r.x*a[1]+n.x*a[2]+t.x*a[3],y:i.y*a[0]+r.y*a[1]+n.y*a[2]+t.y*a[3],z:i.z*a[0]+r.z*a[1]+n.z*a[2]+t.z*a[3]};return l}function EG(e){var t=e*e,n=t*e;return[n,3*t*(1-e),3*e*(1-e)*(1-e),(1-e)*(1-e)*(1-e)]}function xO(e,t){t===void 0&&(t={});for(var n=t.resolution||1e4,r=t.sharpness||.85,i=[],a=Oi(e).coordinates.map(function(p){return{x:p[0],y:p[1]}}),l=new bG({duration:n,points:a,sharpness:r}),o=function(p){var y=l.pos(p);Math.floor(p/100)%2===0&&i.push([y.x,y.y])},f=0;f<l.duration;f+=10)o(f);return o(l.duration),oi(i,t.properties)}function SG(e,t,n,r){return e=Ua(e),t=Ua(t),ti(e,function(i){i.properties||(i.properties={}),ti(t,function(a){i.properties[r]===void 0&&Li(i,a)&&(i.properties[r]=a.properties[n])})}),e}function TG(e,t){if(!e)throw new Error("featurecollection is required");if(t==null)throw new Error("num is required");if(typeof t!="number")throw new Error("num must be a number");var n=An(IG(e.features,t));return n}function IG(e,t){for(var n=e.slice(0),r=e.length,i=r-t,a,l;r-- >i;)l=Math.floor((r+1)*Math.random()),a=n[l],n[l]=n[r],n[r]=a;return n.slice(i)}function e2(e,t){t===void 0&&(t={});var n=Number(e[0]),r=Number(e[1]),i=Number(e[2]),a=Number(e[3]);if(e.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var l=[n,r],o=[n,a],f=[i,a],p=[i,r];return fr([[l,p,f,o,l]],t.properties,{bbox:e,id:t.id})}function aN(e){return e2(ao(e))}function sN(e){var t=e[0],n=e[1],r=e[2],i=e[3],a=ei(e.slice(0,2),[r,n]),l=ei(e.slice(0,2),[t,i]);if(a>=l){var o=(n+i)/2;return[t,o-(r-t)/2,r,o+(r-t)/2]}else{var f=(t+r)/2;return[f-(i-n)/2,n,f+(i-n)/2,i]}}function eh(e,t,n,r){r===void 0&&(r={});var i=Ti(e),a=oa(i[0]),l=oa(i[1]),o=oa(n),f=kp(t,r.units),p=Math.asin(Math.sin(l)*Math.cos(f)+Math.cos(l)*Math.sin(f)*Math.cos(o)),y=a+Math.atan2(Math.sin(o)*Math.sin(f)*Math.cos(l),Math.cos(f)-Math.sin(l)*Math.sin(p)),x=id(y),w=id(p);return sr([x,w],r.properties)}function t2(e,t,n){n===void 0&&(n={});for(var r=n.steps||64,i=n.properties?n.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},a=[],l=0;l<r;l++)a.push(eh(e,t,l*-360/r,n).geometry.coordinates);return a.push(a[0]),fr([a],i)}function jh(e,t,n){if(n===void 0&&(n={}),n.final===!0)return CG(e,t);var r=Ti(e),i=Ti(t),a=oa(r[0]),l=oa(i[0]),o=oa(r[1]),f=oa(i[1]),p=Math.sin(l-a)*Math.cos(f),y=Math.cos(o)*Math.sin(f)-Math.sin(o)*Math.cos(f)*Math.cos(l-a);return id(Math.atan2(p,y))}function CG(e,t){var n=jh(t,e);return n=(n+180)%360,n}function PG(e,t){var n=ei(e,t),r=jh(e,t),i=eh(e,n/2,r);return i}function ww(e,t){t===void 0&&(t={});var n=ao(e),r=(n[0]+n[2])/2,i=(n[1]+n[3])/2;return sr([r,i],t.properties,t)}function od(e,t){t===void 0&&(t={});var n=0,r=0,i=0;return mo(e,function(a){n+=a[0],r+=a[1],i++},!0),sr([n/i,r/i],t.properties)}function lN(e,t){switch(t===void 0&&(t={}),Ds(e)){case"Point":return sr(Ti(e),t.properties);case"Polygon":var n=[];mo(e,function(V){n.push(V)});var r=od(e,{properties:t.properties}),i=r.geometry.coordinates,a=0,l=0,o=0,f,p,y,x,w,S,L,D,B=n.map(function(V){return[V[0]-i[0],V[1]-i[1]]});for(f=0;f<n.length-1;f++)p=B[f],x=p[0],S=p[1],y=B[f+1],w=y[0],L=y[1],D=x*L-w*S,o+=D,a+=(x+w)*D,l+=(S+L)*D;if(o===0)return r;var z=o*.5,M=1/(6*z);return sr([i[0]+M*a,i[1]+M*l],t.properties);default:var k=Kk(e);return k?lN(k,{properties:t.properties}):od(e,{properties:t.properties})}}function AG(e){var t={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return ti(e,function(n){var r,i,a,l;switch((l=n.geometry)===null||l===void 0?void 0:l.type){case"Point":t.MultiPoint.coordinates.push(n.geometry.coordinates),t.MultiPoint.properties.push(n.properties);break;case"MultiPoint":(r=t.MultiPoint.coordinates).push.apply(r,n.geometry.coordinates),t.MultiPoint.properties.push(n.properties);break;case"LineString":t.MultiLineString.coordinates.push(n.geometry.coordinates),t.MultiLineString.properties.push(n.properties);break;case"MultiLineString":(i=t.MultiLineString.coordinates).push.apply(i,n.geometry.coordinates),t.MultiLineString.properties.push(n.properties);break;case"Polygon":t.MultiPolygon.coordinates.push(n.geometry.coordinates),t.MultiPolygon.properties.push(n.properties);break;case"MultiPolygon":(a=t.MultiPolygon.coordinates).push.apply(a,n.geometry.coordinates),t.MultiPolygon.properties.push(n.properties);break}}),An(Object.keys(t).filter(function(n){return t[n].coordinates.length}).sort().map(function(n){var r={type:n,coordinates:t[n].coordinates},i={collectedProperties:t[n].properties};return $o(r,i)}))}function Ew(e){var t=[];return e.type==="FeatureCollection"?ti(e,function(n){mo(n,function(r){t.push(sr(r,n.properties))})}):mo(e,function(n){t.push(sr(n,e.properties))}),An(t)}var n2={exports:{}};n2.exports=Sw;n2.exports.default=Sw;function Sw(e,t,n){n=n||2;var r=t&&t.length,i=r?t[0]*n:e.length,a=uN(e,0,i,n,!0),l=[];if(!a||a.next===a.prev)return l;var o,f,p,y,x,w,S;if(r&&(a=RG(e,t,a,n)),e.length>80*n){o=p=e[0],f=y=e[1];for(var L=n;L<i;L+=n)x=e[L],w=e[L+1],x<o&&(o=x),w<f&&(f=w),x>p&&(p=x),w>y&&(y=w);S=Math.max(p-o,y-f),S=S!==0?32767/S:0}return l0(a,l,n,o,f,S,0),l}function uN(e,t,n,r,i){var a,l;if(i===lI(e,t,n,r)>0)for(a=t;a<n;a+=r)l=bO(a,e[a],e[a+1],l);else for(a=n-r;a>=t;a-=r)l=bO(a,e[a],e[a+1],l);return l&&Tw(l,l.next)&&(c0(l),l=l.next),l}function zp(e,t){if(!e)return e;t||(t=e);var n=e,r;do if(r=!1,!n.steiner&&(Tw(n,n.next)||Lo(n.prev,n,n.next)===0)){if(c0(n),n=t=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function l0(e,t,n,r,i,a,l){if(e){!l&&a&&zG(e,r,i,a);for(var o=e,f,p;e.prev!==e.next;){if(f=e.prev,p=e.next,a?LG(e,r,i,a):MG(e)){t.push(f.i/n|0),t.push(e.i/n|0),t.push(p.i/n|0),c0(e),e=p.next,o=p.next;continue}if(e=p,e===o){l?l===1?(e=OG(zp(e),t,n),l0(e,t,n,r,i,a,2)):l===2&&DG(e,t,n,r,i,a):l0(zp(e),t,n,r,i,a,1);break}}}}function MG(e){var t=e.prev,n=e,r=e.next;if(Lo(t,n,r)>=0)return!1;for(var i=t.x,a=n.x,l=r.x,o=t.y,f=n.y,p=r.y,y=i<a?i<l?i:l:a<l?a:l,x=o<f?o<p?o:p:f<p?f:p,w=i>a?i>l?i:l:a>l?a:l,S=o>f?o>p?o:p:f>p?f:p,L=r.next;L!==t;){if(L.x>=y&&L.x<=w&&L.y>=x&&L.y<=S&&Lm(i,o,a,f,l,p,L.x,L.y)&&Lo(L.prev,L,L.next)>=0)return!1;L=L.next}return!0}function LG(e,t,n,r){var i=e.prev,a=e,l=e.next;if(Lo(i,a,l)>=0)return!1;for(var o=i.x,f=a.x,p=l.x,y=i.y,x=a.y,w=l.y,S=o<f?o<p?o:p:f<p?f:p,L=y<x?y<w?y:w:x<w?x:w,D=o>f?o>p?o:p:f>p?f:p,B=y>x?y>w?y:w:x>w?x:w,z=aI(S,L,t,n,r),M=aI(D,B,t,n,r),k=e.prevZ,V=e.nextZ;k&&k.z>=z&&V&&V.z<=M;){if(k.x>=S&&k.x<=D&&k.y>=L&&k.y<=B&&k!==i&&k!==l&&Lm(o,y,f,x,p,w,k.x,k.y)&&Lo(k.prev,k,k.next)>=0||(k=k.prevZ,V.x>=S&&V.x<=D&&V.y>=L&&V.y<=B&&V!==i&&V!==l&&Lm(o,y,f,x,p,w,V.x,V.y)&&Lo(V.prev,V,V.next)>=0))return!1;V=V.nextZ}for(;k&&k.z>=z;){if(k.x>=S&&k.x<=D&&k.y>=L&&k.y<=B&&k!==i&&k!==l&&Lm(o,y,f,x,p,w,k.x,k.y)&&Lo(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;V&&V.z<=M;){if(V.x>=S&&V.x<=D&&V.y>=L&&V.y<=B&&V!==i&&V!==l&&Lm(o,y,f,x,p,w,V.x,V.y)&&Lo(V.prev,V,V.next)>=0)return!1;V=V.nextZ}return!0}function OG(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!Tw(i,a)&&cN(i,r,r.next,a)&&u0(i,a)&&u0(a,i)&&(t.push(i.i/n|0),t.push(r.i/n|0),t.push(a.i/n|0),c0(r),c0(r.next),r=e=a),r=r.next}while(r!==e);return zp(r)}function DG(e,t,n,r,i,a){var l=e;do{for(var o=l.next.next;o!==l.prev;){if(l.i!==o.i&&GG(l,o)){var f=hN(l,o);l=zp(l,l.next),f=zp(f,f.next),l0(l,t,n,r,i,a,0),l0(f,t,n,r,i,a,0);return}o=o.next}l=l.next}while(l!==e)}function RG(e,t,n,r){var i=[],a,l,o,f,p;for(a=0,l=t.length;a<l;a++)o=t[a]*r,f=a<l-1?t[a+1]*r:e.length,p=uN(e,o,f,r,!1),p===p.next&&(p.steiner=!0),i.push(VG(p));for(i.sort(kG),a=0;a<i.length;a++)n=NG(i[a],n);return n}function kG(e,t){return e.x-t.x}function NG(e,t){var n=FG(e,t);if(!n)return t;var r=hN(n,e);return zp(r,r.next),zp(n,n.next)}function FG(e,t){var n=t,r=e.x,i=e.y,a=-1/0,l;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var o=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=r&&o>a&&(a=o,l=n.x<n.next.x?n:n.next,o===r))return l}n=n.next}while(n!==t);if(!l)return null;var f=l,p=l.x,y=l.y,x=1/0,w;n=l;do r>=n.x&&n.x>=p&&r!==n.x&&Lm(i<y?r:a,i,p,y,i<y?a:r,i,n.x,n.y)&&(w=Math.abs(i-n.y)/(r-n.x),u0(n,e)&&(w<x||w===x&&(n.x>l.x||n.x===l.x&&BG(l,n)))&&(l=n,x=w)),n=n.next;while(n!==f);return l}function BG(e,t){return Lo(e.prev,e,t.prev)<0&&Lo(t.next,e,e.next)<0}function zG(e,t,n,r){var i=e;do i.z===0&&(i.z=aI(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,UG(i)}function UG(e){var t,n,r,i,a,l,o,f,p=1;do{for(n=e,e=null,a=null,l=0;n;){for(l++,r=n,o=0,t=0;t<p&&(o++,r=r.nextZ,!!r);t++);for(f=p;o>0||f>0&&r;)o!==0&&(f===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,o--):(i=r,r=r.nextZ,f--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,p*=2}while(l>1);return e}function aI(e,t,n,r,i){return e=(e-n)*i|0,t=(t-r)*i|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function VG(e){var t=e,n=e;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==e);return n}function Lm(e,t,n,r,i,a,l,o){return(i-l)*(t-o)>=(e-l)*(a-o)&&(e-l)*(r-o)>=(n-l)*(t-o)&&(n-l)*(a-o)>=(i-l)*(r-o)}function GG(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!$G(e,t)&&(u0(e,t)&&u0(t,e)&&jG(e,t)&&(Lo(e.prev,e,t.prev)||Lo(e,t.prev,t))||Tw(e,t)&&Lo(e.prev,e,e.next)>0&&Lo(t.prev,t,t.next)>0)}function Lo(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Tw(e,t){return e.x===t.x&&e.y===t.y}function cN(e,t,n,r){var i=Hx(Lo(e,t,n)),a=Hx(Lo(e,t,r)),l=Hx(Lo(n,r,e)),o=Hx(Lo(n,r,t));return!!(i!==a&&l!==o||i===0&&Wx(e,n,t)||a===0&&Wx(e,r,t)||l===0&&Wx(n,e,r)||o===0&&Wx(n,t,r))}function Wx(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Hx(e){return e>0?1:e<0?-1:0}function $G(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&cN(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function u0(e,t){return Lo(e.prev,e,e.next)<0?Lo(e,t,e.next)>=0&&Lo(e,e.prev,t)>=0:Lo(e,t,e.prev)<0||Lo(e,e.next,t)<0}function jG(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}function hN(e,t){var n=new sI(e.i,e.x,e.y),r=new sI(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function bO(e,t,n,r){var i=new sI(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function c0(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function sI(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Sw.deviation=function(e,t,n,r){var i=t&&t.length,a=i?t[0]*n:e.length,l=Math.abs(lI(e,0,a,n));if(i)for(var o=0,f=t.length;o<f;o++){var p=t[o]*n,y=o<f-1?t[o+1]*n:e.length;l-=Math.abs(lI(e,p,y,n))}var x=0;for(o=0;o<r.length;o+=3){var w=r[o]*n,S=r[o+1]*n,L=r[o+2]*n;x+=Math.abs((e[w]-e[L])*(e[S+1]-e[w+1])-(e[w]-e[S])*(e[L+1]-e[w+1]))}return l===0&&x===0?0:Math.abs((x-l)/l)};function lI(e,t,n,r){for(var i=0,a=t,l=n-r;a<n;a+=r)i+=(e[l]-e[a])*(e[a+1]+e[l+1]),l=a;return i}Sw.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var l=0;l<t;l++)n.vertices.push(e[i][a][l]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n};var qG=n2.exports;const ZG=Vs(qG);function XG(e){if(!e.geometry||e.geometry.type!=="Polygon"&&e.geometry.type!=="MultiPolygon")throw new Error("input must be a Polygon or MultiPolygon");var t={type:"FeatureCollection",features:[]};return e.geometry.type==="Polygon"?t.features=wO(e.geometry.coordinates):e.geometry.coordinates.forEach(function(n){t.features=t.features.concat(wO(n))}),t}function wO(e){var t=WG(e),n=2,r=ZG(t.vertices,t.holes,n),i=[],a=[];r.forEach(function(f,p){var y=r[p];a.push([t.vertices[y*n],t.vertices[y*n+1]])});for(var l=0;l<a.length;l+=3){var o=a.slice(l,l+3);o.push(a[l]),i.push(fr([o]))}return i}function WG(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var l=0;l<t;l++)n.vertices.push(e[i][a][l]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n}function Mb(e,t){if(!e)throw new Error("targetPoint is required");if(!t)throw new Error("points is required");var n,r=1/0,i=0;return ti(t,function(a,l){var o=ei(e,a);o<r&&(i=l,r=o)}),n=Ua(t.features[i]),n.properties.featureIndex=i,n.properties.distanceToPoint=r,n}function Up(e){if(!e)throw new Error("geojson is required");var t=[];return xa(e,function(n){HG(n,t)}),An(t)}function HG(e,t){var n=[],r=e.geometry;if(r!==null){switch(r.type){case"Polygon":n=kn(r);break;case"LineString":n=[kn(r)]}n.forEach(function(i){var a=YG(i,e.properties);a.forEach(function(l){l.id=t.length,t.push(l)})})}}function YG(e,t){var n=[];return e.reduce(function(r,i){var a=oi([r,i],t);return a.bbox=KG(r,i),n.push(a),i}),n}function KG(e,t){var n=e[0],r=e[1],i=t[0],a=t[1],l=n<i?n:i,o=r<a?r:a,f=n>i?n:i,p=r>a?r:a;return[l,o,f,p]}var r2={exports:{}},fN={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(V0,function(){function n(M,k,V,q,Y){(function K(X,U,le,ue,ae){for(;ue>le;){if(ue-le>600){var ve=ue-le+1,Ee=U-le+1,He=Math.log(ve),Oe=.5*Math.exp(2*He/3),Ve=.5*Math.sqrt(He*Oe*(ve-Oe)/ve)*(Ee-ve/2<0?-1:1),Pe=Math.max(le,Math.floor(U-Ee*Oe/ve+Ve)),Ke=Math.min(ue,Math.floor(U+(ve-Ee)*Oe/ve+Ve));K(X,U,Pe,Ke,ae)}var Be=X[U],Ue=le,lt=ue;for(r(X,le,U),ae(X[ue],Be)>0&&r(X,le,ue);Ue<lt;){for(r(X,Ue,lt),Ue++,lt--;ae(X[Ue],Be)<0;)Ue++;for(;ae(X[lt],Be)>0;)lt--}ae(X[le],Be)===0?r(X,le,lt):r(X,++lt,ue),lt<=U&&(le=lt+1),U<=lt&&(ue=lt-1)}})(M,k,V||0,q||M.length-1,Y||i)}function r(M,k,V){var q=M[k];M[k]=M[V],M[V]=q}function i(M,k){return M<k?-1:M>k?1:0}var a=function(M){M===void 0&&(M=9),this._maxEntries=Math.max(4,M),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function l(M,k,V){if(!V)return k.indexOf(M);for(var q=0;q<k.length;q++)if(V(M,k[q]))return q;return-1}function o(M,k){f(M,0,M.children.length,k,M)}function f(M,k,V,q,Y){Y||(Y=B(null)),Y.minX=1/0,Y.minY=1/0,Y.maxX=-1/0,Y.maxY=-1/0;for(var K=k;K<V;K++){var X=M.children[K];p(Y,M.leaf?q(X):X)}return Y}function p(M,k){return M.minX=Math.min(M.minX,k.minX),M.minY=Math.min(M.minY,k.minY),M.maxX=Math.max(M.maxX,k.maxX),M.maxY=Math.max(M.maxY,k.maxY),M}function y(M,k){return M.minX-k.minX}function x(M,k){return M.minY-k.minY}function w(M){return(M.maxX-M.minX)*(M.maxY-M.minY)}function S(M){return M.maxX-M.minX+(M.maxY-M.minY)}function L(M,k){return M.minX<=k.minX&&M.minY<=k.minY&&k.maxX<=M.maxX&&k.maxY<=M.maxY}function D(M,k){return k.minX<=M.maxX&&k.minY<=M.maxY&&k.maxX>=M.minX&&k.maxY>=M.minY}function B(M){return{children:M,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function z(M,k,V,q,Y){for(var K=[k,V];K.length;)if(!((V=K.pop())-(k=K.pop())<=q)){var X=k+Math.ceil((V-k)/q/2)*q;n(M,X,k,V,Y),K.push(k,X,X,V)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(M){var k=this.data,V=[];if(!D(M,k))return V;for(var q=this.toBBox,Y=[];k;){for(var K=0;K<k.children.length;K++){var X=k.children[K],U=k.leaf?q(X):X;D(M,U)&&(k.leaf?V.push(X):L(M,U)?this._all(X,V):Y.push(X))}k=Y.pop()}return V},a.prototype.collides=function(M){var k=this.data;if(!D(M,k))return!1;for(var V=[];k;){for(var q=0;q<k.children.length;q++){var Y=k.children[q],K=k.leaf?this.toBBox(Y):Y;if(D(M,K)){if(k.leaf||L(M,K))return!0;V.push(Y)}}k=V.pop()}return!1},a.prototype.load=function(M){if(!M||!M.length)return this;if(M.length<this._minEntries){for(var k=0;k<M.length;k++)this.insert(M[k]);return this}var V=this._build(M.slice(),0,M.length-1,0);if(this.data.children.length)if(this.data.height===V.height)this._splitRoot(this.data,V);else{if(this.data.height<V.height){var q=this.data;this.data=V,V=q}this._insert(V,this.data.height-V.height-1,!0)}else this.data=V;return this},a.prototype.insert=function(M){return M&&this._insert(M,this.data.height-1),this},a.prototype.clear=function(){return this.data=B([]),this},a.prototype.remove=function(M,k){if(!M)return this;for(var V,q,Y,K=this.data,X=this.toBBox(M),U=[],le=[];K||U.length;){if(K||(K=U.pop(),q=U[U.length-1],V=le.pop(),Y=!0),K.leaf){var ue=l(M,K.children,k);if(ue!==-1)return K.children.splice(ue,1),U.push(K),this._condense(U),this}Y||K.leaf||!L(K,X)?q?(V++,K=q.children[V],Y=!1):K=null:(U.push(K),le.push(V),V=0,q=K,K=K.children[0])}return this},a.prototype.toBBox=function(M){return M},a.prototype.compareMinX=function(M,k){return M.minX-k.minX},a.prototype.compareMinY=function(M,k){return M.minY-k.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(M){return this.data=M,this},a.prototype._all=function(M,k){for(var V=[];M;)M.leaf?k.push.apply(k,M.children):V.push.apply(V,M.children),M=V.pop();return k},a.prototype._build=function(M,k,V,q){var Y,K=V-k+1,X=this._maxEntries;if(K<=X)return o(Y=B(M.slice(k,V+1)),this.toBBox),Y;q||(q=Math.ceil(Math.log(K)/Math.log(X)),X=Math.ceil(K/Math.pow(X,q-1))),(Y=B([])).leaf=!1,Y.height=q;var U=Math.ceil(K/X),le=U*Math.ceil(Math.sqrt(X));z(M,k,V,le,this.compareMinX);for(var ue=k;ue<=V;ue+=le){var ae=Math.min(ue+le-1,V);z(M,ue,ae,U,this.compareMinY);for(var ve=ue;ve<=ae;ve+=U){var Ee=Math.min(ve+U-1,ae);Y.children.push(this._build(M,ve,Ee,q-1))}}return o(Y,this.toBBox),Y},a.prototype._chooseSubtree=function(M,k,V,q){for(;q.push(k),!k.leaf&&q.length-1!==V;){for(var Y=1/0,K=1/0,X=void 0,U=0;U<k.children.length;U++){var le=k.children[U],ue=w(le),ae=(ve=M,Ee=le,(Math.max(Ee.maxX,ve.maxX)-Math.min(Ee.minX,ve.minX))*(Math.max(Ee.maxY,ve.maxY)-Math.min(Ee.minY,ve.minY))-ue);ae<K?(K=ae,Y=ue<Y?ue:Y,X=le):ae===K&&ue<Y&&(Y=ue,X=le)}k=X||k.children[0]}var ve,Ee;return k},a.prototype._insert=function(M,k,V){var q=V?M:this.toBBox(M),Y=[],K=this._chooseSubtree(q,this.data,k,Y);for(K.children.push(M),p(K,q);k>=0&&Y[k].children.length>this._maxEntries;)this._split(Y,k),k--;this._adjustParentBBoxes(q,Y,k)},a.prototype._split=function(M,k){var V=M[k],q=V.children.length,Y=this._minEntries;this._chooseSplitAxis(V,Y,q);var K=this._chooseSplitIndex(V,Y,q),X=B(V.children.splice(K,V.children.length-K));X.height=V.height,X.leaf=V.leaf,o(V,this.toBBox),o(X,this.toBBox),k?M[k-1].children.push(X):this._splitRoot(V,X)},a.prototype._splitRoot=function(M,k){this.data=B([M,k]),this.data.height=M.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(M,k,V){for(var q,Y,K,X,U,le,ue,ae=1/0,ve=1/0,Ee=k;Ee<=V-k;Ee++){var He=f(M,0,Ee,this.toBBox),Oe=f(M,Ee,V,this.toBBox),Ve=(Y=He,K=Oe,X=void 0,U=void 0,le=void 0,ue=void 0,X=Math.max(Y.minX,K.minX),U=Math.max(Y.minY,K.minY),le=Math.min(Y.maxX,K.maxX),ue=Math.min(Y.maxY,K.maxY),Math.max(0,le-X)*Math.max(0,ue-U)),Pe=w(He)+w(Oe);Ve<ae?(ae=Ve,q=Ee,ve=Pe<ve?Pe:ve):Ve===ae&&Pe<ve&&(ve=Pe,q=Ee)}return q||V-k},a.prototype._chooseSplitAxis=function(M,k,V){var q=M.leaf?this.compareMinX:y,Y=M.leaf?this.compareMinY:x;this._allDistMargin(M,k,V,q)<this._allDistMargin(M,k,V,Y)&&M.children.sort(q)},a.prototype._allDistMargin=function(M,k,V,q){M.children.sort(q);for(var Y=this.toBBox,K=f(M,0,k,Y),X=f(M,V-k,V,Y),U=S(K)+S(X),le=k;le<V-k;le++){var ue=M.children[le];p(K,M.leaf?Y(ue):ue),U+=S(K)}for(var ae=V-k-1;ae>=k;ae--){var ve=M.children[ae];p(X,M.leaf?Y(ve):ve),U+=S(X)}return U},a.prototype._adjustParentBBoxes=function(M,k,V){for(var q=V;q>=0;q--)p(k[q],M)},a.prototype._condense=function(M){for(var k=M.length-1,V=void 0;k>=0;k--)M[k].children.length===0?k>0?(V=M[k-1].children).splice(V.indexOf(M[k]),1):this.clear():o(M[k],this.toBBox)},a})})(fN);var JG=fN.exports;const QG=vw(zk),e$=vw(jk),t$=vw($V);var Uc=JG,dN=QG,pN=e$,vm=t$.default,n$=pN.featureEach;pN.coordEach;dN.polygon;var EO=dN.featureCollection;function gN(e){var t=new Uc(e);return t.insert=function(n){if(n.type!=="Feature")throw new Error("invalid feature");return n.bbox=n.bbox?n.bbox:vm(n),Uc.prototype.insert.call(this,n)},t.load=function(n){var r=[];return Array.isArray(n)?n.forEach(function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:vm(i),r.push(i)}):n$(n,function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:vm(i),r.push(i)}),Uc.prototype.load.call(this,r)},t.remove=function(n,r){if(n.type!=="Feature")throw new Error("invalid feature");return n.bbox=n.bbox?n.bbox:vm(n),Uc.prototype.remove.call(this,n,r)},t.clear=function(){return Uc.prototype.clear.call(this)},t.search=function(n){var r=Uc.prototype.search.call(this,this.toBBox(n));return EO(r)},t.collides=function(n){return Uc.prototype.collides.call(this,this.toBBox(n))},t.all=function(){var n=Uc.prototype.all.call(this);return EO(n)},t.toJSON=function(){return Uc.prototype.toJSON.call(this)},t.fromJSON=function(n){return Uc.prototype.fromJSON.call(this,n)},t.toBBox=function(n){var r;if(n.bbox)r=n.bbox;else if(Array.isArray(n)&&n.length===4)r=n;else if(Array.isArray(n)&&n.length===6)r=[n[0],n[1],n[3],n[4]];else if(n.type==="Feature")r=vm(n);else if(n.type==="FeatureCollection")r=vm(n);else throw new Error("invalid geojson");return{minX:r[0],minY:r[1],maxX:r[2],maxY:r[3]}},t}r2.exports=gN;r2.exports.default=gN;var r$=r2.exports;const Iw=Vs(r$);function sf(e,t){var n={},r=[];if(e.type==="LineString"&&(e=$o(e)),t.type==="LineString"&&(t=$o(t)),e.type==="Feature"&&t.type==="Feature"&&e.geometry!==null&&t.geometry!==null&&e.geometry.type==="LineString"&&t.geometry.type==="LineString"&&e.geometry.coordinates.length===2&&t.geometry.coordinates.length===2){var i=SO(e,t);return i&&r.push(i),An(r)}var a=Iw();return a.load(Up(t)),ti(Up(e),function(l){ti(a.search(l),function(o){var f=SO(l,o);if(f){var p=kn(f).join(",");n[p]||(n[p]=!0,r.push(f))}})}),An(r)}function SO(e,t){var n=kn(e),r=kn(t);if(n.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(r.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=n[0][0],a=n[0][1],l=n[1][0],o=n[1][1],f=r[0][0],p=r[0][1],y=r[1][0],x=r[1][1],w=(x-p)*(l-i)-(y-f)*(o-a),S=(y-f)*(a-p)-(x-p)*(i-f),L=(l-i)*(a-p)-(o-a)*(i-f);if(w===0)return null;var D=S/w,B=L/w;if(D>=0&&D<=1&&B>=0&&B<=1){var z=i+D*(l-i),M=a+D*(o-a);return sr([z,M])}return null}function kh(e,t,n){n===void 0&&(n={});var r=sr([1/0,1/0],{dist:1/0}),i=0;return xa(e,function(a){for(var l=kn(a),o=0;o<l.length-1;o++){var f=sr(l[o]);f.properties.dist=ei(t,f,n);var p=sr(l[o+1]);p.properties.dist=ei(t,p,n);var y=ei(f,p,n),x=Math.max(f.properties.dist,p.properties.dist),w=jh(f,p),S=eh(t,x,w+90,n),L=eh(t,x,w-90,n),D=sf(oi([S.geometry.coordinates,L.geometry.coordinates]),oi([f.geometry.coordinates,p.geometry.coordinates])),B=null;D.features.length>0&&(B=D.features[0],B.properties.dist=ei(t,B,n),B.properties.location=i+ei(f,B,n)),f.properties.dist<r.properties.dist&&(r=f,r.properties.index=o,r.properties.location=i),p.properties.dist<r.properties.dist&&(r=p,r.properties.index=o+1,r.properties.location=i+y),B&&B.properties.dist<r.properties.dist&&(r=B,r.properties.index=o),i+=y}}),r}function Cw(e,t,n){n===void 0&&(n={});var r=Ti(e),i=Ti(t);i[0]+=i[0]-r[0]>180?-360:r[0]-i[0]>180?360:0;var a=i$(r,i),l=Fp(a,"meters",n.units);return l}function i$(e,t,n){n=n===void 0?na:Number(n);var r=n,i=e[1]*Math.PI/180,a=t[1]*Math.PI/180,l=a-i,o=Math.abs(t[0]-e[0])*Math.PI/180;o>Math.PI&&(o-=2*Math.PI);var f=Math.log(Math.tan(a/2+Math.PI/4)/Math.tan(i/2+Math.PI/4)),p=Math.abs(f)>1e-11?l/f:Math.cos(i),y=Math.sqrt(l*l+p*p*o*o),x=y*r;return x}function mN(e,t,n){if(n===void 0&&(n={}),n.method||(n.method="geodesic"),n.units||(n.units="kilometers"),!e)throw new Error("pt is required");if(Array.isArray(e)?e=sr(e):e.type==="Point"?e=$o(e):a0(e,"Point","point"),!t)throw new Error("line is required");Array.isArray(t)?t=oi(t):t.type==="LineString"?t=$o(t):a0(t,"LineString","line");var r=1/0,i=e.geometry.coordinates;return Rh(t,function(a){var l=a.geometry.coordinates[0],o=a.geometry.coordinates[1],f=o$(i,l,o,n);f<r&&(r=f)}),Fp(r,"degrees",n.units)}function o$(e,t,n,r){var i=[n[0]-t[0],n[1]-t[1]],a=[e[0]-t[0],e[1]-t[1]],l=TO(a,i);if(l<=0)return cT(e,t,{method:r.method,units:"degrees"});var o=TO(i,i);if(o<=l)return cT(e,n,{method:r.method,units:"degrees"});var f=l/o,p=[t[0]+f*i[0],t[1]+f*i[1]];return cT(e,p,{method:r.method,units:"degrees"})}function TO(e,t){return e[0]*t[0]+e[1]*t[1]}function cT(e,t,n){return n.method==="planar"?Cw(e,t,n):ei(e,t,n)}function a$(e,t,n){n===void 0&&(n={});var r=n.units,i=n.properties||{},a=s$(e);if(!a.features.length)throw new Error("points must contain features");if(!t)throw new Error("line is required");if(Ds(t)!=="LineString")throw new Error("line must be a LineString");var l=1/0,o=null;return ti(a,function(f){var p=mN(f,t,{units:r});p<l&&(l=p,o=f)}),o&&(o.properties=XC({dist:l},o.properties,i)),o}function s$(e){var t=[],n=e.geometry?e.geometry.type:e.type;switch(n){case"GeometryCollection":return sl(e,function(r){r.type==="Point"&&t.push({type:"Feature",properties:{},geometry:r})}),{type:"FeatureCollection",features:t};case"FeatureCollection":return e.features=e.features.filter(function(r){return r.geometry.type==="Point"}),e;default:throw new Error("points must be a Point Collection")}}function l$(e,t){var n=Ti(e),r=Oi(t),i=r.coordinates,a=i[0];if(a.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var l=t.properties||{},o=l.a,f=l.b,p=l.c,y=n[0],x=n[1],w=a[0][0],S=a[0][1],L=o!==void 0?o:a[0][2],D=a[1][0],B=a[1][1],z=f!==void 0?f:a[1][2],M=a[2][0],k=a[2][1],V=p!==void 0?p:a[2][2],q=(V*(y-w)*(x-B)+L*(y-D)*(x-k)+z*(y-M)*(x-S)-z*(y-w)*(x-k)-V*(y-D)*(x-S)-L*(y-M)*(x-B))/((y-w)*(x-B)+(y-D)*(x-k)+(y-M)*(x-S)-(y-w)*(x-k)-(y-D)*(x-S)-(y-M)*(x-B));return q}function u$(e){var t,n,r={type:"FeatureCollection",features:[]};if(e.type==="Feature"?n=e.geometry:n=e,n.type==="LineString")t=[n.coordinates];else if(n.type==="MultiLineString")t=n.coordinates;else if(n.type==="MultiPolygon")t=[].concat.apply([],n.coordinates);else if(n.type==="Polygon")t=n.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return t.forEach(function(i){t.forEach(function(a){for(var l=0;l<i.length-1;l++)for(var o=l;o<a.length-1;o++)if(!(i===a&&(Math.abs(l-o)===1||l===0&&o===i.length-2&&i[l][0]===i[i.length-1][0]&&i[l][1]===i[i.length-1][1]))){var f=c$(i[l][0],i[l][1],i[l+1][0],i[l+1][1],a[o][0],a[o][1],a[o+1][0],a[o+1][1]);f&&r.features.push(sr([f[0],f[1]]))}})}),r}function c$(e,t,n,r,i,a,l,o){var f,p,y,x,w,S={x:null,y:null,onLine1:!1,onLine2:!1};return f=(o-a)*(n-e)-(l-i)*(r-t),f===0?S.x!==null&&S.y!==null?S:!1:(p=t-a,y=e-i,x=(l-i)*p-(o-a)*y,w=(n-e)*p-(r-t)*y,p=x/f,y=w/f,S.x=e+p*(n-e),S.y=t+p*(r-t),p>=0&&p<=1&&(S.onLine1=!0),y>=0&&y<=1&&(S.onLine2=!0),S.onLine1&&S.onLine2?[S.x,S.y]:!1)}function IO(e){for(var t=h$(e),n=ww(t),r=!1,i=0;!r&&i<t.features.length;){var a=t.features[i].geometry,l,o,f,p,y,x,w,S=!1;if(a.type==="Point")n.geometry.coordinates[0]===a.coordinates[0]&&n.geometry.coordinates[1]===a.coordinates[1]&&(r=!0);else if(a.type==="MultiPoint"){var L=!1;for(w=0;!L&&w<a.coordinates.length;)n.geometry.coordinates[0]===a.coordinates[w][0]&&n.geometry.coordinates[1]===a.coordinates[w][1]&&(r=!0,L=!0),w++}else if(a.type==="LineString")for(w=0;!S&&w<a.coordinates.length-1;)l=n.geometry.coordinates[0],o=n.geometry.coordinates[1],f=a.coordinates[w][0],p=a.coordinates[w][1],y=a.coordinates[w+1][0],x=a.coordinates[w+1][1],CO(l,o,f,p,y,x)&&(S=!0,r=!0),w++;else if(a.type==="MultiLineString")for(var D=0;D<a.coordinates.length;){S=!1,w=0;for(var B=a.coordinates[D];!S&&w<B.length-1;)l=n.geometry.coordinates[0],o=n.geometry.coordinates[1],f=B[w][0],p=B[w][1],y=B[w+1][0],x=B[w+1][1],CO(l,o,f,p,y,x)&&(S=!0,r=!0),w++;D++}else(a.type==="Polygon"||a.type==="MultiPolygon")&&Li(n,a)&&(r=!0);i++}if(r)return n;var z=An([]);for(i=0;i<t.features.length;i++)z.features=z.features.concat(Ew(t.features[i]).features);return sr(Mb(n,z).geometry.coordinates)}function h$(e){return e.type!=="FeatureCollection"?e.type!=="Feature"?An([$o(e)]):An([e]):e}function CO(e,t,n,r,i,a){var l=Math.sqrt((i-n)*(i-n)+(a-r)*(a-r)),o=Math.sqrt((e-n)*(e-n)+(t-r)*(t-r)),f=Math.sqrt((i-e)*(i-e)+(a-t)*(a-t));return l===o+f}var PO=6378137;function i2(e){return GC(e,function(t,n){return t+f$(n)},0)}function f$(e){var t=0,n;switch(e.type){case"Polygon":return AO(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)t+=AO(e.coordinates[n]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function AO(e){var t=0;if(e&&e.length>0){t+=Math.abs(MO(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(MO(e[n]))}return t}function MO(e){var t,n,r,i,a,l,o,f=0,p=e.length;if(p>2){for(o=0;o<p;o++)o===p-2?(i=p-2,a=p-1,l=0):o===p-1?(i=p-1,a=0,l=1):(i=o,a=o+1,l=o+2),t=e[i],n=e[a],r=e[l],f+=(hT(r[0])-hT(t[0]))*Math.sin(hT(n[1]));f=f*PO*PO/2}return f}function hT(e){return e*Math.PI/180}function d$(e,t,n){n===void 0&&(n={});for(var r=Oi(e),i=r.coordinates,a=0,l=0;l<i.length&&!(t>=a&&l===i.length-1);l++)if(a>=t){var o=t-a;if(o){var f=jh(i[l],i[l-1])-180,p=eh(i[l],o,f,n);return p}else return sr(i[l])}else a+=ei(i[l],i[l+1],n);return sr(i[i.length-1])}function uI(e,t){return t===void 0&&(t={}),$C(e,function(n,r){var i=r.geometry.coordinates;return n+ei(i[0],i[1],t)},0)}function p$(e,t,n){var r=kn(n);if(Ds(n)!=="LineString")throw new Error("line must be a LineString");var i=kh(n,e),a=kh(n,t),l;i.properties.index<=a.properties.index?l=[i,a]:l=[a,i];for(var o=[l[0].geometry.coordinates],f=l[0].properties.index+1;f<l[1].properties.index+1;f++)o.push(r[f]);return o.push(l[1].geometry.coordinates),oi(o,n.properties)}function yN(e,t,n,r){if(r=r||{},!li(r))throw new Error("options is invalid");var i,a=[];if(e.type==="Feature")i=e.geometry.coordinates;else if(e.type==="LineString")i=e.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var l=i.length,o=0,f,p,y,x=0;x<i.length&&!(t>=o&&x===i.length-1);x++){if(o>t&&a.length===0){if(f=t-o,!f)return a.push(i[x]),oi(a);p=jh(i[x],i[x-1])-180,y=eh(i[x],f,p,r),a.push(y.geometry.coordinates)}if(o>=n)return f=n-o,f?(p=jh(i[x],i[x-1])-180,y=eh(i[x],f,p,r),a.push(y.geometry.coordinates),oi(a)):(a.push(i[x]),oi(a));if(o>=t&&a.push(i[x]),x===i.length-1)return oi(a);o+=ei(i[x],i[x+1],r)}if(o<t&&i.length===l)throw new Error("Start position is beyond line");var w=i[i.length-1];return oi([w,w])}function el(e,t,n){n===void 0&&(n={});for(var r=Ti(e),i=kn(t),a=0;a<i.length-1;a++){var l=!1;if(n.ignoreEndVertices&&(a===0&&(l="start"),a===i.length-2&&(l="end"),a===0&&a+1===i.length-1&&(l="both")),g$(i[a],i[a+1],r,l,typeof n.epsilon>"u"?null:n.epsilon))return!0}return!1}function g$(e,t,n,r,i){var a=n[0],l=n[1],o=e[0],f=e[1],p=t[0],y=t[1],x=n[0]-o,w=n[1]-f,S=p-o,L=y-f,D=x*L-w*S;if(i!==null){if(Math.abs(D)>i)return!1}else if(D!==0)return!1;if(r){if(r==="start")return Math.abs(S)>=Math.abs(L)?S>0?o<a&&a<=p:p<=a&&a<o:L>0?f<l&&l<=y:y<=l&&l<f;if(r==="end")return Math.abs(S)>=Math.abs(L)?S>0?o<=a&&a<p:p<a&&a<=o:L>0?f<=l&&l<y:y<l&&l<=f;if(r==="both")return Math.abs(S)>=Math.abs(L)?S>0?o<a&&a<p:p<a&&a<o:L>0?f<l&&l<y:y<l&&l<f}else return Math.abs(S)>=Math.abs(L)?S>0?o<=a&&a<=p:p<=a&&a<=o:L>0?f<=l&&l<=y:y<=l&&l<=f;return!1}function vN(e,t){var n=Oi(e),r=Oi(t),i=n.type,a=r.type;switch(i){case"Point":switch(a){case"MultiPoint":return m$(n,r);case"LineString":return el(n,r,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return Li(n,r,{ignoreBoundary:!0});default:throw new Error("feature2 "+a+" geometry not supported")}case"MultiPoint":switch(a){case"MultiPoint":return y$(n,r);case"LineString":return v$(n,r);case"Polygon":case"MultiPolygon":return _$(n,r);default:throw new Error("feature2 "+a+" geometry not supported")}case"LineString":switch(a){case"LineString":return x$(n,r);case"Polygon":case"MultiPolygon":return b$(n,r);default:throw new Error("feature2 "+a+" geometry not supported")}case"Polygon":switch(a){case"Polygon":case"MultiPolygon":return w$(n,r);default:throw new Error("feature2 "+a+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}function m$(e,t){var n,r=!1;for(n=0;n<t.coordinates.length;n++)if(xN(t.coordinates[n],e.coordinates)){r=!0;break}return r}function y$(e,t){for(var n=0;n<e.coordinates.length;n++){for(var r=!1,i=0;i<t.coordinates.length;i++)xN(e.coordinates[n],t.coordinates[i])&&(r=!0);if(!r)return!1}return!0}function v$(e,t){for(var n=!1,r=0;r<e.coordinates.length;r++){if(!el(e.coordinates[r],t))return!1;n||(n=el(e.coordinates[r],t,{ignoreEndVertices:!0}))}return n}function _$(e,t){for(var n=!0,r=!1,i=0;i<e.coordinates.length;i++){if(r=Li(e.coordinates[1],t),!r){n=!1;break}r=Li(e.coordinates[1],t,{ignoreBoundary:!0})}return n&&r}function x$(e,t){for(var n=0;n<e.coordinates.length;n++)if(!el(e.coordinates[n],t))return!1;return!0}function b$(e,t){var n=ao(t),r=ao(e);if(!_N(n,r))return!1;for(var i=!1,a=0;a<e.coordinates.length-1;a++){if(!Li(e.coordinates[a],t))return!1;if(i||(i=Li(e.coordinates[a],t,{ignoreBoundary:!0})),!i){var l=E$(e.coordinates[a],e.coordinates[a+1]);i=Li(l,t,{ignoreBoundary:!0})}}return i}function w$(e,t){var n=ao(e),r=ao(t);if(!_N(r,n))return!1;for(var i=0;i<e.coordinates[0].length;i++)if(!Li(e.coordinates[0][i],t))return!1;return!0}function _N(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}function xN(e,t){return e[0]===t[0]&&e[1]===t[1]}function E$(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}function bN(e,t,n){n===void 0&&(n={}),n.mask&&!n.units&&(n.units="kilometers");for(var r=[],i=e[0],a=e[1],l=e[2],o=e[3],f=t/ei([i,a],[l,a],n),p=f*(l-i),y=t/ei([i,a],[i,o],n),x=y*(o-a),w=l-i,S=o-a,L=Math.floor(w/p),D=Math.floor(S/x),B=(w-L*p)/2,z=(S-D*x)/2,M=i+B;M<=l;){for(var k=a+z;k<=o;){var V=sr([M,k],n.properties);n.mask?vN(V,n.mask)&&r.push(V):r.push(V),k+=x}M+=p}return An(r)}function wN(e,t){t===void 0&&(t={});var n=t.precision,r=t.coordinates,i=t.mutate;if(n=n==null||isNaN(n)?6:n,r=r==null||isNaN(r)?3:r,!e)throw new Error("<geojson> is required");if(typeof n!="number")throw new Error("<precision> must be a number");if(typeof r!="number")throw new Error("<coordinates> must be a number");(i===!1||i===void 0)&&(e=JSON.parse(JSON.stringify(e)));var a=Math.pow(10,n);return mo(e,function(l){S$(l,a,r)}),e}function S$(e,t,n){e.length>n&&e.splice(n,e.length);for(var r=0;r<e.length;r++)e[r]=Math.round(e[r]*t)/t;return e}function cI(e){if(!e)throw new Error("geojson is required");var t=[];return xa(e,function(n){t.push(n)}),An(t)}function T$(e,t,n){if(n=n||{},!li(n))throw new Error("options is invalid");var r=n.units,i=n.reverse;if(!e)throw new Error("geojson is required");if(t<=0)throw new Error("segmentLength must be greater than 0");var a=[];return xa(e,function(l){i&&(l.geometry.coordinates=l.geometry.coordinates.reverse()),I$(l,t,r,function(o){a.push(o)})}),An(a)}function I$(e,t,n,r){var i=uI(e,{units:n});if(i<=t)return r(e);var a=i/t;Number.isInteger(a)||(a=Math.floor(a)+1);for(var l=0;l<a;l++){var o=yN(e,t*l,t*(l+1),{units:n});r(o,l)}}function C$(e,t,n){if(e.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");n===void 0&&(n=1);var r=e.geometry.coordinates,i=[],a={};if(n){for(var l=[],o=0;o<r.length;o++)for(var f=0;f<r[o].length-1;f++)l.push(B(o,f));var p=QC();p.load(l)}for(var y=0;y<r.length;y++)for(var x=0;x<r[y].length-1;x++)if(n){var w=p.search(B(y,x));w.forEach(function(z){var M=z.ring,k=z.edge;D(y,x,M,k)})}else for(var S=0;S<r.length;S++)for(var L=0;L<r[S].length-1;L++)D(y,x,S,L);return t||(i={type:"Feature",geometry:{type:"MultiPoint",coordinates:i}}),i;function D(z,M,k,V){var q=r[z][M],Y=r[z][M+1],K=r[k][V],X=r[k][V+1],U=P$(q,Y,K,X);if(U!==null){var le,ue;if(Y[0]!==q[0]?le=(U[0]-q[0])/(Y[0]-q[0]):le=(U[1]-q[1])/(Y[1]-q[1]),X[0]!==K[0]?ue=(U[0]-K[0])/(X[0]-K[0]):ue=(U[1]-K[1])/(X[1]-K[1]),!(le>=1||le<=0||ue>=1||ue<=0)){var ae=U,ve=!a[ae];ve&&(a[ae]=!0),t?i.push(t(U,z,M,q,Y,le,k,V,K,X,ue,ve)):i.push(U)}}}function B(z,M){var k=r[z][M],V=r[z][M+1],q,Y,K,X;return k[0]<V[0]?(q=k[0],Y=V[0]):(q=V[0],Y=k[0]),k[1]<V[1]?(K=k[1],X=V[1]):(K=V[1],X=k[1]),{minX:q,minY:K,maxX:Y,maxY:X,ring:z,edge:M}}}function P$(e,t,n,r){if(B_(e,n)||B_(e,r)||B_(t,n)||B_(r,n))return null;var i=e[0],a=e[1],l=t[0],o=t[1],f=n[0],p=n[1],y=r[0],x=r[1],w=(i-l)*(p-x)-(a-o)*(f-y);if(w===0)return null;var S=((i*o-a*l)*(f-y)-(i-l)*(f*x-p*y))/w,L=((i*o-a*l)*(p-x)-(a-o)*(f*x-p*y))/w;return[S,L]}function B_(e,t){if(!e||!t||e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]instanceof Array&&t[n]instanceof Array){if(!B_(e[n],t[n]))return!1}else if(e[n]!==t[n])return!1;return!0}function A$(e){if(e.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(e.geometry===void 0||e.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(e.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var t=e.geometry.coordinates.length,n=[],M=0;M<t;M++){var r=e.geometry.coordinates[M];z_(r[0],r[r.length-1])||r.push(r[0]),n.push.apply(n,r.slice(0,r.length-1))}if(!L$(n))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var i=n.length,a=C$(e,function(Nt,Wt,Je,Kt,Vt,dt,Jt,Ut,we,Ce,je,nt){return[Nt,Wt,Je,Kt,Vt,dt,Jt,Ut,we,Ce,je,nt]}),l=a.length;if(l==0){for(var K=[],M=0;M<t;M++)K.push(fr([e.geometry.coordinates[M]],{parent:-1,winding:M$(e.geometry.coordinates[M])}));var Ke=An(K);return Be(),Ue(),Ke}for(var o=[],f=[],M=0;M<t;M++){o.push([]);for(var p=0;p<e.geometry.coordinates[M].length-1;p++)o[M].push([new LO(e.geometry.coordinates[M][Om(p+1,e.geometry.coordinates[M].length-1)],1,[M,p],[M,Om(p+1,e.geometry.coordinates[M].length-1)],void 0)]),f.push(new OO(e.geometry.coordinates[M][p],[M,Om(p-1,e.geometry.coordinates[M].length-1)],[M,p],void 0,void 0,!1,!0))}for(var M=0;M<l;M++)o[a[M][1]][a[M][2]].push(new LO(a[M][0],a[M][5],[a[M][1],a[M][2]],[a[M][6],a[M][7]],void 0)),a[M][11]&&f.push(new OO(a[M][0],[a[M][1],a[M][2]],[a[M][6],a[M][7]],void 0,void 0,!0,!0));for(var y=f.length,M=0;M<o.length;M++)for(var p=0;p<o[M].length;p++)o[M][p].sort(function(Wt,Je){return Wt.param<Je.param?-1:1});for(var x=[],M=0;M<y;M++)x.push({minX:f[M].coord[0],minY:f[M].coord[1],maxX:f[M].coord[0],maxY:f[M].coord[1],index:M});var w=QC();w.load(x);for(var M=0;M<o.length;M++)for(var p=0;p<o[M].length;p++)for(var S=0;S<o[M][p].length;S++){var L;S==o[M][p].length-1?L=o[M][Om(p+1,e.geometry.coordinates[M].length-1)][0].coord:L=o[M][p][S+1].coord;var D=w.search({minX:L[0],minY:L[1],maxX:L[0],maxY:L[1]})[0];o[M][p][S].nxtIsectAlongEdgeIn=D.index}for(var M=0;M<o.length;M++)for(var p=0;p<o[M].length;p++)for(var S=0;S<o[M][p].length;S++){var L=o[M][p][S].coord,D=w.search({minX:L[0],minY:L[1],maxX:L[0],maxY:L[1]})[0],B=D.index;B<i?f[B].nxtIsectAlongRingAndEdge2=o[M][p][S].nxtIsectAlongEdgeIn:z_(f[B].ringAndEdge1,o[M][p][S].ringAndEdgeIn)?f[B].nxtIsectAlongRingAndEdge1=o[M][p][S].nxtIsectAlongEdgeIn:f[B].nxtIsectAlongRingAndEdge2=o[M][p][S].nxtIsectAlongEdgeIn}for(var z=[],M=0,p=0;p<t;p++){for(var k=M,S=0;S<e.geometry.coordinates[p].length-1;S++)f[M].coord[0]<f[k].coord[0]&&(k=M),M++;for(var V=f[k].nxtIsectAlongRingAndEdge2,S=0;S<f.length;S++)if(f[S].nxtIsectAlongRingAndEdge1==k||f[S].nxtIsectAlongRingAndEdge2==k){var q=S;break}var Y=hb([f[q].coord,f[k].coord,f[V].coord],!0)?1:-1;z.push({isect:k,parent:-1,winding:Y})}z.sort(function(xt,Nt){return f[xt.isect].coord>f[Nt.isect].coord?-1:1});for(var K=[];z.length>0;){var X=z.pop(),U=X.isect,le=X.parent,ue=X.winding,ae=K.length,ve=[f[U].coord],Ee=U;if(f[U].ringAndEdge1Walkable)var He=f[U].ringAndEdge1,Oe=f[U].nxtIsectAlongRingAndEdge1;else var He=f[U].ringAndEdge2,Oe=f[U].nxtIsectAlongRingAndEdge2;for(;!z_(f[U].coord,f[Oe].coord);){ve.push(f[Oe].coord);for(var Ve=void 0,M=0;M<z.length;M++)if(z[M].isect==Oe){Ve=M;break}if(Ve!=null&&z.splice(Ve,1),z_(He,f[Oe].ringAndEdge1)){if(He=f[Oe].ringAndEdge2,f[Oe].ringAndEdge2Walkable=!1,f[Oe].ringAndEdge1Walkable){var Pe={isect:Oe};hb([f[Ee].coord,f[Oe].coord,f[f[Oe].nxtIsectAlongRingAndEdge2].coord],ue==1)?(Pe.parent=le,Pe.winding=-ue):(Pe.parent=ae,Pe.winding=ue),z.push(Pe)}Ee=Oe,Oe=f[Oe].nxtIsectAlongRingAndEdge2}else{if(He=f[Oe].ringAndEdge1,f[Oe].ringAndEdge1Walkable=!1,f[Oe].ringAndEdge2Walkable){var Pe={isect:Oe};hb([f[Ee].coord,f[Oe].coord,f[f[Oe].nxtIsectAlongRingAndEdge1].coord],ue==1)?(Pe.parent=le,Pe.winding=-ue):(Pe.parent=ae,Pe.winding=ue),z.push(Pe)}Ee=Oe,Oe=f[Oe].nxtIsectAlongRingAndEdge1}}ve.push(f[Oe].coord),K.push(fr([ve],{index:ae,parent:le,winding:ue,netWinding:void 0}))}var Ke=An(K);Be(),Ue();function Be(){for(var xt=[],Nt=0;Nt<Ke.features.length;Nt++)Ke.features[Nt].properties.parent==-1&&xt.push(Nt);if(xt.length>1)for(var Nt=0;Nt<xt.length;Nt++){for(var Wt=-1,Je=1/0,Kt=0;Kt<Ke.features.length;Kt++)xt[Nt]!=Kt&&Li(Ke.features[xt[Nt]].geometry.coordinates[0][0],Ke.features[Kt],{ignoreBoundary:!0})&&i2(Ke.features[Kt])<Je&&(Wt=Kt);Ke.features[xt[Nt]].properties.parent=Wt}}function Ue(){for(var xt=0;xt<Ke.features.length;xt++)if(Ke.features[xt].properties.parent==-1){var Nt=Ke.features[xt].properties.winding;Ke.features[xt].properties.netWinding=Nt,lt(xt,Nt)}}function lt(xt,Nt){for(var Wt=0;Wt<Ke.features.length;Wt++)if(Ke.features[Wt].properties.parent==xt){var Je=Nt+Ke.features[Wt].properties.winding;Ke.features[Wt].properties.netWinding=Je,lt(Wt,Je)}}return Ke}var LO=function(e,t,n,r,i){this.coord=e,this.param=t,this.ringAndEdgeIn=n,this.ringAndEdgeOut=r,this.nxtIsectAlongEdgeIn=i},OO=function(e,t,n,r,i,a,l){this.coord=e,this.ringAndEdge1=t,this.ringAndEdge2=n,this.nxtIsectAlongRingAndEdge1=r,this.nxtIsectAlongRingAndEdge2=i,this.ringAndEdge1Walkable=a,this.ringAndEdge2Walkable=l};function hb(e,t){if(typeof t>"u"&&(t=!0),e.length!=3)throw new Error("This function requires an array of three points [x,y]");var n=(e[1][0]-e[0][0])*(e[2][1]-e[0][1])-(e[1][1]-e[0][1])*(e[2][0]-e[0][0]);return n>=0==t}function M$(e){for(var t=0,n=0;n<e.length-1;n++)e[n][0]<e[t][0]&&(t=n);if(hb([e[Om(t-1,e.length-1)],e[t],e[Om(t+1,e.length-1)]],!0))var r=1;else var r=-1;return r}function z_(e,t){if(!e||!t||e.length!=t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]instanceof Array&&t[n]instanceof Array){if(!z_(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0}function Om(e,t){return(e%t+t)%t}function L$(e){for(var t={},n=1,r=0,i=e.length;r<i;++r){if(Object.prototype.hasOwnProperty.call(t,e[r])){n=0;break}t[e[r]]=1}return n}function O$(e){var t=[];return xa(e,function(n){n.geometry.type==="Polygon"&&ti(A$(n),function(r){t.push(fr(r.geometry.coordinates,n.properties))})}),An(t)}var DO=Math.PI/180,RO=180/Math.PI,h0=function(e,t){this.lon=e,this.lat=t,this.x=DO*e,this.y=DO*t};h0.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};h0.prototype.antipode=function(){var e=-1*this.lat,t=this.lon<0?180+this.lon:(180-this.lon)*-1;return new h0(t,e)};var EN=function(){this.coords=[],this.length=0};EN.prototype.move_to=function(e){this.length++,this.coords.push(e)};var o2=function(e){this.properties=e||{},this.geometries=[]};o2.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var e=[],t=0;t<this.geometries.length;t++)e.push(this.geometries[t].coords);return{geometry:{type:"MultiLineString",coordinates:e},type:"Feature",properties:this.properties}};o2.prototype.wkt=function(){for(var e="",t="LINESTRING(",n=function(a){t+=a[0]+" "+a[1]+","},r=0;r<this.geometries.length;r++){if(this.geometries[r].coords.length===0)return"LINESTRING(empty)";var i=this.geometries[r].coords;i.forEach(n),e+=t.substring(0,t.length-1)+")"}return e};var a2=function(e,t,n){if(!e||e.x===void 0||e.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!t||t.x===void 0||t.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new h0(e.x,e.y),this.end=new h0(t.x,t.y),this.properties=n||{};var r=this.start.x-this.end.x,i=this.start.y-this.end.y,a=Math.pow(Math.sin(i/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(r/2),2);if(this.g=2*Math.asin(Math.sqrt(a)),this.g===Math.PI)throw new Error("it appears "+e.view()+" and "+t.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+e+" and "+t)};a2.prototype.interpolate=function(e){var t=Math.sin((1-e)*this.g)/Math.sin(this.g),n=Math.sin(e*this.g)/Math.sin(this.g),r=t*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),i=t*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),a=t*Math.sin(this.start.y)+n*Math.sin(this.end.y),l=RO*Math.atan2(a,Math.sqrt(Math.pow(r,2)+Math.pow(i,2))),o=RO*Math.atan2(i,r);return[o,l]};a2.prototype.Arc=function(e,t){var n=[];if(!e||e<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var r=1/(e-1),i=0;i<e;++i){var a=r*i,l=this.interpolate(a);n.push(l)}for(var o=!1,f=0,p=t&&t.offset?t.offset:10,y=180-p,x=-180+p,w=360-p,S=1;S<n.length;++S){var L=n[S-1][0],D=n[S][0],B=Math.abs(D-L);B>w&&(D>y&&L<x||L>y&&D<x)?o=!0:B>f&&(f=B)}var z=[];if(o&&f<p){var M=[];z.push(M);for(var k=0;k<n.length;++k){var V=parseFloat(n[k][0]);if(k>0&&Math.abs(V-n[k-1][0])>w){var q=parseFloat(n[k-1][0]),Y=parseFloat(n[k-1][1]),K=parseFloat(n[k][0]),X=parseFloat(n[k][1]);if(q>-180&&q<x&&K===180&&k+1<n.length&&n[k-1][0]>-180&&n[k-1][0]<x){M.push([-180,n[k][1]]),k++,M.push([n[k][0],n[k][1]]);continue}else if(q>y&&q<180&&K===-180&&k+1<n.length&&n[k-1][0]>y&&n[k-1][0]<180){M.push([180,n[k][1]]),k++,M.push([n[k][0],n[k][1]]);continue}if(q<x&&K>y){var U=q;q=K,K=U;var le=Y;Y=X,X=le}if(q>y&&K<x&&(K+=360),q<=180&&K>=180&&q<K){var ue=(180-q)/(K-q),ae=ue*X+(1-ue)*Y;M.push([n[k-1][0]>y?180:-180,ae]),M=[],M.push([n[k-1][0]>y?-180:180,ae]),z.push(M)}else M=[],z.push(M);M.push([V,n[k][1]])}else M.push([n[k][0],n[k][1]])}}else{var ve=[];z.push(ve);for(var Ee=0;Ee<n.length;++Ee)ve.push([n[Ee][0],n[Ee][1]])}for(var He=new o2(this.properties),Oe=0;Oe<z.length;++Oe){var Ve=new EN;He.geometries.push(Ve);for(var Pe=z[Oe],Ke=0;Ke<Pe.length;++Ke)Ve.move_to(Pe[Ke])}return He};function D$(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.properties,i=n.npoints,a=n.offset;e=Ti(e),t=Ti(t),r=r||{},i=i||100,a=a||10;var l=new a2({x:e[0],y:e[1]},{x:t[0],y:t[1]},r),o=l.Arc(i,{offset:a});return o.json()}function R$(e,t){if(!e)throw new Error("line is required");if(!t)throw new Error("splitter is required");var n=Ds(e),r=Ds(t);if(n!=="LineString")throw new Error("line must be LineString");if(r==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(r==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var i=wN(t,{precision:7});switch(r){case"Point":return hI(e,i);case"MultiPoint":return kO(e,i);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return kO(e,sf(e,i))}}function kO(e,t){var n=[],r=Iw();return xa(t,function(i){if(n.forEach(function(o,f){o.id=f}),!n.length)n=hI(e,i).features,n.forEach(function(o){o.bbox||(o.bbox=sN(ao(o)))}),r.load(An(n));else{var a=r.search(i);if(a.features.length){var l=SN(i,a);n=n.filter(function(o){return o.id!==l.id}),r.remove(l),ti(hI(l,i),function(o){n.push(o),r.insert(o)})}}}),An(n)}function hI(e,t){var n=[],r=kn(e)[0],i=kn(e)[e.geometry.coordinates.length-1];if(fT(r,Ti(t))||fT(i,Ti(t)))return An([e]);var a=Iw(),l=Up(e);a.load(l);var o=a.search(t);if(!o.features.length)return An([e]);var f=SN(t,o),p=[r],y=VC(l,function(x,w,S){var L=kn(w)[1],D=Ti(t);return S===f.id?(x.push(D),n.push(oi(x)),fT(D,L)?[D]:[D,L]):(x.push(L),x)},p);return y.length>1&&n.push(oi(y)),An(n)}function SN(e,t){if(!t.features.length)throw new Error("lines must contain features");if(t.features.length===1)return t.features[0];var n,r=1/0;return ti(t,function(i){var a=kh(i,e),l=a.properties.dist;l<r&&(n=i,r=l)}),n}function fT(e,t){return e[0]===t[0]&&e[1]===t[1]}function TN(e,t,n,r,i){i===void 0&&(i={});var a=i.steps||64,l=NO(n),o=NO(r),f=!Array.isArray(e)&&e.type==="Feature"?e.properties:{};if(l===o)return oi(t2(e,t,i).geometry.coordinates[0],f);for(var p=l,y=l<o?o:o+360,x=p,w=[],S=0;x<y;)w.push(eh(e,t,x,i).geometry.coordinates),S++,x=p+S*360/a;return x>y&&w.push(eh(e,t,y,i).geometry.coordinates),oi(w,f)}function NO(e){var t=e%360;return t<0&&(t+=360),t}function f0(e,t){t===void 0&&(t={});var n=Oi(e);switch(!t.properties&&e.type==="Feature"&&(t.properties=e.properties),n.type){case"Polygon":return IN(n,t);case"MultiPolygon":return k$(n,t);default:throw new Error("invalid poly")}}function IN(e,t){t===void 0&&(t={});var n=Oi(e),r=n.coordinates,i=t.properties?t.properties:e.type==="Feature"?e.properties:{};return CN(r,i)}function k$(e,t){t===void 0&&(t={});var n=Oi(e),r=n.coordinates,i=t.properties?t.properties:e.type==="Feature"?e.properties:{},a=[];return r.forEach(function(l){a.push(CN(l,i))}),An(a)}function CN(e,t){return e.length>1?_d(e,t):oi(e[0],t)}function FO(e,t){t===void 0&&(t={});var n,r,i,a=t.properties,l=(n=t.autoComplete)!==null&&n!==void 0?n:!0,o=(r=t.orderCoords)!==null&&r!==void 0?r:!0,f=(i=t.mutate)!==null&&i!==void 0?i:!1;switch(f||(e=Ua(e)),e.type){case"FeatureCollection":var p=[];return e.features.forEach(function(y){p.push(kn(BO(y,{},l,o)))}),al(p,a);default:return BO(e,a,l,o)}}function BO(e,t,n,r){t=t||(e.type==="Feature"?e.properties:{});var i=Oi(e),a=i.coordinates,l=i.type;if(!a.length)throw new Error("line must contain coordinates");switch(l){case"LineString":return n&&(a=zO(a)),fr([a],t);case"MultiLineString":var o=[],f=0;return a.forEach(function(p){if(n&&(p=zO(p)),r){var y=N$(ao(oi(p)));y>f?(o.unshift(p),f=y):o.push(p)}else o.push(p)}),fr(o,t);default:throw new Error("geometry type "+l+" is not supported")}}function zO(e){var t=e[0],n=t[0],r=t[1],i=e[e.length-1],a=i[0],l=i[1];return(n!==a||r!==l)&&e.push(t),e}function N$(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.abs(t-r)*Math.abs(n-i)}function F$(e,t,n){var r=e.length,i=Dm(e[0],t),a=[],l,o,f,p,y;for(n||(n=[]),l=1;l<r;l++){for(p=e[l-1],y=e[l],o=f=Dm(y,t);;)if(i|o){if(i&o)break;i?(p=fI(p,y,i,t),i=Dm(p,t)):(y=fI(p,y,o,t),o=Dm(y,t))}else{a.push(p),o!==f?(a.push(y),l<r-1&&(n.push(a),a=[])):l===r-1&&a.push(y);break}i=f}return a.length&&n.push(a),n}function B$(e,t){var n,r,i,a,l,o,f;for(r=1;r<=8;r*=2){for(n=[],i=e[e.length-1],a=!(Dm(i,t)&r),l=0;l<e.length;l++)o=e[l],f=!(Dm(o,t)&r),f!==a&&n.push(fI(i,o,r,t)),f&&n.push(o),i=o,a=f;if(e=n,!e.length)break}return n}function fI(e,t,n,r){return n&8?[e[0]+(t[0]-e[0])*(r[3]-e[1])/(t[1]-e[1]),r[3]]:n&4?[e[0]+(t[0]-e[0])*(r[1]-e[1])/(t[1]-e[1]),r[1]]:n&2?[r[2],e[1]+(t[1]-e[1])*(r[2]-e[0])/(t[0]-e[0])]:n&1?[r[0],e[1]+(t[1]-e[1])*(r[0]-e[0])/(t[0]-e[0])]:null}function Dm(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function z$(e,t){var n=Oi(e),r=n.type,i=e.type==="Feature"?e.properties:{},a=n.coordinates;switch(r){case"LineString":case"MultiLineString":{var l=[];return r==="LineString"&&(a=[a]),a.forEach(function(o){F$(o,t,l)}),l.length===1?oi(l[0],i):_d(l,i)}case"Polygon":return fr(UO(a,t),i);case"MultiPolygon":return al(a.map(function(o){return UO(o,t)}),i);default:throw new Error("geometry "+r+" not supported")}}function UO(e,t){for(var n=[],r=0,i=e;r<i.length;r++){var a=i[r],l=B$(a,t);l.length>0&&((l[0][0]!==l[l.length-1][0]||l[0][1]!==l[l.length-1][1])&&l.push(l[0]),l.length>=4&&n.push(l))}return n}var VO=Object.prototype.toString,PN=function(t){var n=VO.call(t),r=n==="[object Arguments]";return r||(r=n!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&VO.call(t.callee)==="[object Function]"),r},dT,GO;function U$(){if(GO)return dT;GO=1;var e;if(!Object.keys){var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=PN,i=Object.prototype.propertyIsEnumerable,a=!i.call({toString:null},"toString"),l=i.call(function(){},"prototype"),o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],f=function(w){var S=w.constructor;return S&&S.prototype===w},p={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},y=function(){if(typeof window>"u")return!1;for(var w in window)try{if(!p["$"+w]&&t.call(window,w)&&window[w]!==null&&typeof window[w]=="object")try{f(window[w])}catch{return!0}}catch{return!0}return!1}(),x=function(w){if(typeof window>"u"||!y)return f(w);try{return f(w)}catch{return!1}};e=function(S){var L=S!==null&&typeof S=="object",D=n.call(S)==="[object Function]",B=r(S),z=L&&n.call(S)==="[object String]",M=[];if(!L&&!D&&!B)throw new TypeError("Object.keys called on a non-object");var k=l&&D;if(z&&S.length>0&&!t.call(S,0))for(var V=0;V<S.length;++V)M.push(String(V));if(B&&S.length>0)for(var q=0;q<S.length;++q)M.push(String(q));else for(var Y in S)!(k&&Y==="prototype")&&t.call(S,Y)&&M.push(String(Y));if(a)for(var K=x(S),X=0;X<o.length;++X)!(K&&o[X]==="constructor")&&t.call(S,o[X])&&M.push(o[X]);return M}}return dT=e,dT}var V$=Array.prototype.slice,G$=PN,$O=Object.keys,fb=$O?function(t){return $O(t)}:U$(),jO=Object.keys;fb.shim=function(){if(Object.keys){var t=function(){var n=Object.keys(arguments);return n&&n.length===arguments.length}(1,2);t||(Object.keys=function(r){return G$(r)?jO(V$.call(r)):jO(r)})}else Object.keys=fb;return Object.keys||fb};var AN=fb,MN=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},n=Symbol("test"),r=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;t[n]=i;for(n in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var a=Object.getOwnPropertySymbols(t);if(a.length!==1||a[0]!==n||!Object.prototype.propertyIsEnumerable.call(t,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var l=Object.getOwnPropertyDescriptor(t,n);if(l.value!==i||l.enumerable!==!0)return!1}return!0},$$=MN,s2=function(){return $$()&&!!Symbol.toStringTag},qO=typeof Symbol<"u"&&Symbol,j$=MN,q$=function(){return typeof qO!="function"||typeof Symbol!="function"||typeof qO("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:j$()},ZO={foo:{}},Z$=Object,X$=function(){return{__proto__:ZO}.foo===ZO.foo&&!({__proto__:null}instanceof Z$)},W$="Function.prototype.bind called on incompatible ",pT=Array.prototype.slice,H$=Object.prototype.toString,Y$="[object Function]",K$=function(t){var n=this;if(typeof n!="function"||H$.call(n)!==Y$)throw new TypeError(W$+n);for(var r=pT.call(arguments,1),i,a=function(){if(this instanceof i){var y=n.apply(this,r.concat(pT.call(arguments)));return Object(y)===y?y:this}else return n.apply(t,r.concat(pT.call(arguments)))},l=Math.max(0,n.length-r.length),o=[],f=0;f<l;f++)o.push("$"+f);if(i=Function("binder","return function ("+o.join(",")+"){ return binder.apply(this,arguments); }")(a),n.prototype){var p=function(){};p.prototype=n.prototype,i.prototype=new p,p.prototype=null}return i},J$=K$,l2=Function.prototype.bind||J$,Q$=l2,ej=Q$.call(Function.call,Object.prototype.hasOwnProperty),Qr,Hm=SyntaxError,LN=Function,Um=TypeError,gT=function(e){try{return LN('"use strict"; return ('+e+").constructor;")()}catch{}},Lp=Object.getOwnPropertyDescriptor;if(Lp)try{Lp({},"")}catch{Lp=null}var mT=function(){throw new Um},tj=Lp?function(){try{return arguments.callee,mT}catch{try{return Lp(arguments,"callee").get}catch{return mT}}}():mT,_m=q$(),nj=X$(),Oa=Object.getPrototypeOf||(nj?function(e){return e.__proto__}:null),Pm={},rj=typeof Uint8Array>"u"||!Oa?Qr:Oa(Uint8Array),Op={"%AggregateError%":typeof AggregateError>"u"?Qr:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Qr:ArrayBuffer,"%ArrayIteratorPrototype%":_m&&Oa?Oa([][Symbol.iterator]()):Qr,"%AsyncFromSyncIteratorPrototype%":Qr,"%AsyncFunction%":Pm,"%AsyncGenerator%":Pm,"%AsyncGeneratorFunction%":Pm,"%AsyncIteratorPrototype%":Pm,"%Atomics%":typeof Atomics>"u"?Qr:Atomics,"%BigInt%":typeof BigInt>"u"?Qr:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Qr:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Qr:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Qr:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?Qr:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Qr:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Qr:FinalizationRegistry,"%Function%":LN,"%GeneratorFunction%":Pm,"%Int8Array%":typeof Int8Array>"u"?Qr:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Qr:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Qr:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":_m&&Oa?Oa(Oa([][Symbol.iterator]())):Qr,"%JSON%":typeof JSON=="object"?JSON:Qr,"%Map%":typeof Map>"u"?Qr:Map,"%MapIteratorPrototype%":typeof Map>"u"||!_m||!Oa?Qr:Oa(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Qr:Promise,"%Proxy%":typeof Proxy>"u"?Qr:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?Qr:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Qr:Set,"%SetIteratorPrototype%":typeof Set>"u"||!_m||!Oa?Qr:Oa(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Qr:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":_m&&Oa?Oa(""[Symbol.iterator]()):Qr,"%Symbol%":_m?Symbol:Qr,"%SyntaxError%":Hm,"%ThrowTypeError%":tj,"%TypedArray%":rj,"%TypeError%":Um,"%Uint8Array%":typeof Uint8Array>"u"?Qr:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Qr:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Qr:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Qr:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?Qr:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Qr:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Qr:WeakSet};if(Oa)try{null.error}catch(e){var ij=Oa(Oa(e));Op["%Error.prototype%"]=ij}var oj=function e(t){var n;if(t==="%AsyncFunction%")n=gT("async function () {}");else if(t==="%GeneratorFunction%")n=gT("function* () {}");else if(t==="%AsyncGeneratorFunction%")n=gT("async function* () {}");else if(t==="%AsyncGenerator%"){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(t==="%AsyncIteratorPrototype%"){var i=e("%AsyncGenerator%");i&&Oa&&(n=Oa(i.prototype))}return Op[t]=n,n},XO={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},$0=l2,Lb=ej,aj=$0.call(Function.call,Array.prototype.concat),sj=$0.call(Function.apply,Array.prototype.splice),WO=$0.call(Function.call,String.prototype.replace),Ob=$0.call(Function.call,String.prototype.slice),lj=$0.call(Function.call,RegExp.prototype.exec),uj=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,cj=/\\(\\)?/g,hj=function(t){var n=Ob(t,0,1),r=Ob(t,-1);if(n==="%"&&r!=="%")throw new Hm("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new Hm("invalid intrinsic syntax, expected opening `%`");var i=[];return WO(t,uj,function(a,l,o,f){i[i.length]=o?WO(f,cj,"$1"):l||a}),i},fj=function(t,n){var r=t,i;if(Lb(XO,r)&&(i=XO[r],r="%"+i[0]+"%"),Lb(Op,r)){var a=Op[r];if(a===Pm&&(a=oj(r)),typeof a>"u"&&!n)throw new Um("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:a}}throw new Hm("intrinsic "+t+" does not exist!")},j0=function(t,n){if(typeof t!="string"||t.length===0)throw new Um("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new Um('"allowMissing" argument must be a boolean');if(lj(/^%?[^%]*%?$/,t)===null)throw new Hm("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=hj(t),i=r.length>0?r[0]:"",a=fj("%"+i+"%",n),l=a.name,o=a.value,f=!1,p=a.alias;p&&(i=p[0],sj(r,aj([0,1],p)));for(var y=1,x=!0;y<r.length;y+=1){var w=r[y],S=Ob(w,0,1),L=Ob(w,-1);if((S==='"'||S==="'"||S==="`"||L==='"'||L==="'"||L==="`")&&S!==L)throw new Hm("property names with quotes must have matching quotes");if((w==="constructor"||!x)&&(f=!0),i+="."+w,l="%"+i+"%",Lb(Op,l))o=Op[l];else if(o!=null){if(!(w in o)){if(!n)throw new Um("base intrinsic for "+t+" exists, but the property is not available.");return}if(Lp&&y+1>=r.length){var D=Lp(o,w);x=!!D,x&&"get"in D&&!("originalValue"in D.get)?o=D.get:o=o[w]}else x=Lb(o,w),o=o[w];x&&!f&&(Op[l]=o)}}return o},ON={exports:{}};(function(e){var t=l2,n=j0,r=n("%Function.prototype.apply%"),i=n("%Function.prototype.call%"),a=n("%Reflect.apply%",!0)||t.call(i,r),l=n("%Object.getOwnPropertyDescriptor%",!0),o=n("%Object.defineProperty%",!0),f=n("%Math.max%");if(o)try{o({},"a",{value:1})}catch{o=null}e.exports=function(x){var w=a(t,i,arguments);if(l&&o){var S=l(w,"length");S.configurable&&o(w,"length",{value:1+f(0,x.length-(arguments.length-1))})}return w};var p=function(){return a(t,r,arguments)};o?o(e.exports,"apply",{value:p}):e.exports.apply=p})(ON);var u2=ON.exports,DN=j0,RN=u2,dj=RN(DN("String.prototype.indexOf")),kN=function(t,n){var r=DN(t,!!n);return typeof r=="function"&&dj(t,".prototype.")>-1?RN(r):r},pj=s2(),gj=kN,dI=gj("Object.prototype.toString"),Pw=function(t){return pj&&t&&typeof t=="object"&&Symbol.toStringTag in t?!1:dI(t)==="[object Arguments]"},NN=function(t){return Pw(t)?!0:t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&dI(t)!=="[object Array]"&&dI(t.callee)==="[object Function]"},mj=function(){return Pw(arguments)}();Pw.isLegacyArguments=NN;var yj=mj?Pw:NN,vj=j0,pI=vj("%Object.defineProperty%",!0),gI=function(){if(pI)try{return pI({},"a",{value:1}),!0}catch{return!1}return!1};gI.hasArrayLengthDefineBug=function(){if(!gI())return null;try{return pI([],"length",{value:1}).length!==1}catch{return!0}};var c2=gI,yT,HO;function _j(){if(HO)return yT;HO=1;var e=j0,t=e("%Object.getOwnPropertyDescriptor%",!0);if(t)try{t([],"length")}catch{t=null}return yT=t,yT}var xj=c2(),h2=j0,YO=xj&&h2("%Object.defineProperty%",!0),bj=h2("%SyntaxError%"),xm=h2("%TypeError%"),KO=_j(),FN=function(t,n,r){if(!t||typeof t!="object"&&typeof t!="function")throw new xm("`obj` must be an object or a function`");if(typeof n!="string"&&typeof n!="symbol")throw new xm("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new xm("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new xm("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new xm("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new xm("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,a=arguments.length>4?arguments[4]:null,l=arguments.length>5?arguments[5]:null,o=arguments.length>6?arguments[6]:!1,f=!!KO&&KO(t,n);if(YO)YO(t,n,{configurable:l===null&&f?f.configurable:!l,enumerable:i===null&&f?f.enumerable:!i,value:r,writable:a===null&&f?f.writable:!a});else if(o||!i&&!a&&!l)t[n]=r;else throw new bj("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},wj=AN,Ej=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",Sj=Object.prototype.toString,Tj=Array.prototype.concat,JO=FN,Ij=function(e){return typeof e=="function"&&Sj.call(e)==="[object Function]"},BN=c2(),Cj=function(e,t,n,r){if(t in e){if(r===!0){if(e[t]===n)return}else if(!Ij(r)||!r())return}BN?JO(e,t,n,!0):JO(e,t,n)},zN=function(e,t){var n=arguments.length>2?arguments[2]:{},r=wj(t);Ej&&(r=Tj.call(r,Object.getOwnPropertySymbols(t)));for(var i=0;i<r.length;i+=1)Cj(e,r[i],t[r[i]],n[r[i]])};zN.supportsDescriptors=!!BN;var q0=zN,QO=function(e){return e!==e},UN=function(t,n){return t===0&&n===0?1/t===1/n:!!(t===n||QO(t)&&QO(n))},Pj=UN,VN=function(){return typeof Object.is=="function"?Object.is:Pj},Aj=VN,Mj=q0,Lj=function(){var t=Aj();return Mj(Object,{is:t},{is:function(){return Object.is!==t}}),t},Oj=q0,Dj=u2,Rj=UN,GN=VN,kj=Lj,$N=Dj(GN(),Object);Oj($N,{getPolyfill:GN,implementation:Rj,shim:kj});var Nj=$N,mI=kN,jN=s2(),qN,ZN,yI,vI;if(jN){qN=mI("Object.prototype.hasOwnProperty"),ZN=mI("RegExp.prototype.exec"),yI={};var vT=function(){throw yI};vI={toString:vT,valueOf:vT},typeof Symbol.toPrimitive=="symbol"&&(vI[Symbol.toPrimitive]=vT)}var Fj=mI("Object.prototype.toString"),Bj=Object.getOwnPropertyDescriptor,zj="[object RegExp]",Uj=jN?function(t){if(!t||typeof t!="object")return!1;var n=Bj(t,"lastIndex"),r=n&&qN(n,"value");if(!r)return!1;try{ZN(t,vI)}catch(i){return i===yI}}:function(t){return!t||typeof t!="object"&&typeof t!="function"?!1:Fj(t)===zj},d0=function(){return typeof(function(){}).name=="string"},W_=Object.getOwnPropertyDescriptor;if(W_)try{W_([],"length")}catch{W_=null}d0.functionsHaveConfigurableNames=function(){if(!d0()||!W_)return!1;var t=W_(function(){},"name");return!!t&&!!t.configurable};var Vj=Function.prototype.bind;d0.boundFunctionsHaveNames=function(){return d0()&&typeof Vj=="function"&&(function(){}).bind().name!==""};var Gj=d0,eD=FN,$j=c2(),jj=Gj.functionsHaveConfigurableNames(),qj=TypeError,Zj=function(t,n){if(typeof t!="function")throw new qj("`fn` is not a function");var r=arguments.length>2&&!!arguments[2];return(!r||jj)&&($j?eD(t,"name",n,!0,!0):eD(t,"name",n)),t},Xj=Zj,Wj=Object,Hj=TypeError,XN=Xj(function(){if(this!=null&&this!==Wj(this))throw new Hj("RegExp.prototype.flags getter called on non-object");var t="";return this.hasIndices&&(t+="d"),this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.unicodeSets&&(t+="v"),this.sticky&&(t+="y"),t},"get flags",!0),Yj=XN,Kj=q0.supportsDescriptors,Jj=Object.getOwnPropertyDescriptor,WN=function(){if(Kj&&/a/mig.flags==="gim"){var t=Jj(RegExp.prototype,"flags");if(t&&typeof t.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var n="",r={};if(Object.defineProperty(r,"hasIndices",{get:function(){n+="d"}}),Object.defineProperty(r,"sticky",{get:function(){n+="y"}}),n==="dy")return t.get}}return Yj},Qj=q0.supportsDescriptors,eq=WN,tq=Object.getOwnPropertyDescriptor,nq=Object.defineProperty,rq=TypeError,tD=Object.getPrototypeOf,iq=/a/,oq=function(){if(!Qj||!tD)throw new rq("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=eq(),n=tD(iq),r=tq(n,"flags");return(!r||r.get!==t)&&nq(n,"flags",{configurable:!0,enumerable:!1,get:t}),t},aq=q0,sq=u2,lq=XN,HN=WN,uq=oq,YN=sq(HN());aq(YN,{getPolyfill:HN,implementation:lq,shim:uq});var cq=YN,hq=Date.prototype.getDay,fq=function(t){try{return hq.call(t),!0}catch{return!1}},dq=Object.prototype.toString,pq="[object Date]",gq=s2(),mq=function(t){return typeof t!="object"||t===null?!1:gq?fq(t):dq.call(t)===pq},nD=AN,rD=yj,iD=Nj,oD=Uj,aD=cq,sD=mq,lD=Date.prototype.getTime;function KN(e,t,n){var r=n||{};return(r.strict?iD(e,t):e===t)?!0:!e||!t||typeof e!="object"&&typeof t!="object"?r.strict?iD(e,t):e==t:yq(e,t,r)}function uD(e){return e==null}function cD(e){return!(!e||typeof e!="object"||typeof e.length!="number"||typeof e.copy!="function"||typeof e.slice!="function"||e.length>0&&typeof e[0]!="number")}function yq(e,t,n){var r,i;if(typeof e!=typeof t||uD(e)||uD(t)||e.prototype!==t.prototype||rD(e)!==rD(t))return!1;var a=oD(e),l=oD(t);if(a!==l)return!1;if(a||l)return e.source===t.source&&aD(e)===aD(t);if(sD(e)&&sD(t))return lD.call(e)===lD.call(t);var o=cD(e),f=cD(t);if(o!==f)return!1;if(o||f){if(e.length!==t.length)return!1;for(r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}if(typeof e!=typeof t)return!1;try{var p=nD(e),y=nD(t)}catch{return!1}if(p.length!==y.length)return!1;for(p.sort(),y.sort(),r=p.length-1;r>=0;r--)if(p[r]!=y[r])return!1;for(r=p.length-1;r>=0;r--)if(i=p[r],!KN(e[i],t[i],n))return!1;return!0}var JN=KN;const U_=Vs(JN);function QN(e,t,n){if(n===void 0&&(n={}),n=n||{},!li(n))throw new Error("options is invalid");var r=n.tolerance||0,i=[],a=Iw(),l=Up(e);a.load(l);var o;return Rh(t,function(f){var p=!1;f&&(ti(a.search(f),function(y){if(p===!1){var x=kn(f).sort(),w=kn(y).sort();U_(x,w)||(r===0?el(x[0],y)&&el(x[1],y):kh(y,x[0]).properties.dist<=r&&kh(y,x[1]).properties.dist<=r)?(p=!0,o?o=_T(o,f):o=f):(r===0?el(w[0],f)&&el(w[1],f):kh(f,w[0]).properties.dist<=r&&kh(f,w[1]).properties.dist<=r)&&(o?o=_T(o,y):o=y)}}),p===!1&&o&&(i.push(o),o=void 0))}),o&&i.push(o),An(i)}function _T(e,t){var n=kn(t),r=kn(e),i=r[0],a=r[r.length-1],l=e.geometry.coordinates;return U_(n[0],i)?l.unshift(n[1]):U_(n[0],a)?l.push(n[1]):U_(n[1],i)?l.unshift(n[0]):U_(n[1],a)&&l.push(n[0]),e}function vq(e,t,n,r,i){if(i=i||{},!li(i))throw new Error("options is invalid");var a=i.properties;if(!e)throw new Error("center is required");if(n==null)throw new Error("bearing1 is required");if(r==null)throw new Error("bearing2 is required");if(!t)throw new Error("radius is required");if(typeof i!="object")throw new Error("options must be an object");if(hD(n)===hD(r))return t2(e,t,i);var l=kn(e),o=TN(e,t,n,r,i),f=[[l]];return mo(o,function(p){f[0].push(p)}),f[0].push(l),fr(f,a)}function hD(e){var t=e%360;return t<0&&(t+=360),t}function Vp(e,t,n){n===void 0&&(n={});var r;n.final?r=fD(Ti(t),Ti(e)):r=fD(Ti(e),Ti(t));var i=r>180?-(360-r):r;return i}function fD(e,t){var n=oa(e[1]),r=oa(t[1]),i=oa(t[0]-e[0]);i>Math.PI&&(i-=2*Math.PI),i<-Math.PI&&(i+=2*Math.PI);var a=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),l=Math.atan2(i,a);return(id(l)+360)%360}function Ym(e,t,n,r){r===void 0&&(r={});var i=t<0,a=Fp(Math.abs(t),r.units,"meters");i&&(a=-Math.abs(a));var l=Ti(e),o=_q(l,a,n);return o[0]+=o[0]-l[0]>180?-360:l[0]-o[0]>180?360:0,sr(o,r.properties)}function _q(e,t,n,r){r=r===void 0?na:Number(r);var i=t/r,a=e[0]*Math.PI/180,l=oa(e[1]),o=oa(n),f=i*Math.cos(o),p=l+f;Math.abs(p)>Math.PI/2&&(p=p>0?Math.PI-p:-Math.PI-p);var y=Math.log(Math.tan(p/2+Math.PI/4)/Math.tan(l/2+Math.PI/4)),x=Math.abs(y)>1e-11?f/y:Math.cos(l),w=i*Math.sin(o)/x,S=a+w;return[(S*180/Math.PI+540)%360-180,p*180/Math.PI]}function xq(e,t){var n=kn(e),r=kn(t),i,a,l,o,f=ao(t),p=0,y=null;n[0]>f[0]&&n[0]<f[2]&&n[1]>f[1]&&n[1]<f[3]&&(y=Mb(e,Ew(t)),p=y.properties.featureIndex);var x=Ds(t);switch(x){case"Polygon":i=r[0][p],a=r[0][0],y!==null&&y.geometry.coordinates[1]<n[1]&&(a=r[0][p]),o=p0(r[0][0],r[0][r[0].length-1],n);var w=dD(r[0],n,o,l,i,a);i=w[0],a=w[1];break;case"MultiPolygon":for(var S=0,L=0,D=0,B=0;B<r[0].length;B++){S=B;for(var z=!1,M=0;M<r[0][B].length;M++){if(L=M,D===p){z=!0;break}D++}if(z)break}i=r[0][S][L],a=r[0][S][L],o=p0(r[0][0][0],r[0][0][r[0][0].length-1],n),r.forEach(function(k){var V=dD(k[0],n,o,l,i,a);i=V[0],a=V[1]});break}return An([sr(i),sr(a)])}function dD(e,t,n,r,i,a){for(var l=0;l<e.length;l++){var o=e[l],f=e[l+1];l===e.length-1&&(f=e[0]),r=p0(o,f,t),n<=0&&r>0?wq(t,o,i)||(i=o):n>0&&r<=0&&(bq(t,o,a)||(a=o)),n=r}return[i,a]}function bq(e,t,n){return p0(e,t,n)>0}function wq(e,t,n){return p0(e,t,n)<0}function p0(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])}function Db(e){for(var t=kn(e),n=0,r=1,i,a;r<t.length;)i=a||t[0],a=t[r],n+=(a[0]-i[0])*(a[1]+i[1]),r++;return n>0}function Eq(e,t){if(t=t||{},!li(t))throw new Error("options is invalid");var n=t.reverse||!1,r=t.mutate||!1;if(!e)throw new Error("<geojson> is required");if(typeof n!="boolean")throw new Error("<reverse> must be a boolean");if(typeof r!="boolean")throw new Error("<mutate> must be a boolean");r===!1&&(e=Ua(e));var i=[];switch(e.type){case"GeometryCollection":return sl(e,function(a){db(a,n)}),e;case"FeatureCollection":return ti(e,function(a){ti(db(a,n),function(l){i.push(l)})}),An(i)}return db(e,n)}function db(e,t){var n=e.type==="Feature"?e.geometry.type:e.type;switch(n){case"GeometryCollection":return sl(e,function(r){db(r,t)}),e;case"LineString":return pD(kn(e),t),e;case"Polygon":return gD(kn(e),t),e;case"MultiLineString":return kn(e).forEach(function(r){pD(r,t)}),e;case"MultiPolygon":return kn(e).forEach(function(r){gD(r,t)}),e;case"Point":case"MultiPoint":return e}}function pD(e,t){Db(e)===t&&e.reverse()}function gD(e,t){Db(e[0])!==t&&e[0].reverse();for(var n=1;n<e.length;n++)Db(e[n])===t&&e[n].reverse()}function Sq(e,t){if(t=t||{},!li(t))throw new Error("options is invalid");var n=t.zProperty||"elevation",r=t.flip,i=t.flags;af(e,"Point","input must contain Points");for(var a=Tq(e,r),l=[],o=0;o<a.length;o++){for(var f=a[o],p=[],y=0;y<f.length;y++){var x=f[y];x.properties[n]?p.push(x.properties[n]):p.push(0),i===!0&&(x.properties.matrixPosition=[o,y])}l.push(p)}return l}function Tq(e,t){var n={};ti(e,function(a){var l=kn(a)[1];n[l]||(n[l]=[]),n[l].push(a)});var r=Object.keys(n).map(function(a){var l=n[a],o=l.sort(function(f,p){return kn(f)[0]-kn(p)[0]});return o}),i=r.sort(function(a,l){return t?kn(a[0])[1]-kn(l[0])[1]:kn(l[0])[1]-kn(a[0])[1]});return i}/*!
 * @license GNU Affero General Public License.
 * Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
 * v. 1.2.0
 * https://github.com/RaumZeit/MarchingSquares.js
 *
 * MarchingSquaresJS is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * MarchingSquaresJS is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * As additional permission under GNU Affero General Public License version 3
 * section 7, third-party projects (personal or commercial) may distribute,
 * include, or link against UNMODIFIED VERSIONS of MarchingSquaresJS without the
 * requirement that said third-party project for that reason alone becomes
 * subject to any requirement of the GNU Affero General Public License version 3.
 * Any modifications to MarchingSquaresJS, however, must be shared with the public
 * and made available.
 *
 * In summary this:
 * - allows you to use MarchingSquaresJS at no cost
 * - allows you to use MarchingSquaresJS for both personal and commercial purposes
 * - allows you to distribute UNMODIFIED VERSIONS of MarchingSquaresJS under any
 *   license as long as this license notice is included
 * - enables you to keep the source code of your program that uses MarchingSquaresJS
 *   undisclosed
 * - forces you to share any modifications you have made to MarchingSquaresJS,
 *   e.g. bug-fixes
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with MarchingSquaresJS.  If not, see <http://www.gnu.org/licenses/>.
 */var mD={successCallback:null,verbose:!1,polygons:!1},mp={};function Iq(e,t,n,r){r=r||{};for(var i=Object.keys(mD),a=0;a<i.length;a++){var l=i[a],o=r[l];o=typeof o<"u"&&o!==null?o:mD[l],mp[l]=o}mp.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+t+":"+(t+n)+"]");var f=oZ(e,t,n),p;return mp.polygons?(mp.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),p=hZ(f)):(mp.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),p=aZ(f)),typeof mp.successCallback=="function"&&mp.successCallback(p),p}var Ya=64,lu=16,ya=4,Da=1,yr=[],vr=[],_r=[],xr=[],br=[],wr=[],Er=[],Sr=[],Tr=[],Ir=[],Cr=[],Pr=[],Ar=[],Mr=[],Lr=[],Or=[],Dr=[],Rr=[],kr=[],Nr=[],Fr=[],Br=[],zr=[],Ur=[];Er[85]=Ir[85]=-1;Sr[85]=Cr[85]=0;Tr[85]=Pr[85]=1;kr[85]=Br[85]=1;Nr[85]=zr[85]=0;Fr[85]=Ur[85]=1;yr[85]=xr[85]=0;vr[85]=br[85]=-1;_r[85]=Lr[85]=0;Or[85]=Ar[85]=0;Dr[85]=Mr[85]=1;wr[85]=Rr[85]=1;Br[1]=Br[169]=0;zr[1]=zr[169]=-1;Ur[1]=Ur[169]=0;Ar[1]=Ar[169]=-1;Mr[1]=Mr[169]=0;Lr[1]=Lr[169]=0;Ir[4]=Ir[166]=0;Cr[4]=Cr[166]=-1;Pr[4]=Pr[166]=1;Or[4]=Or[166]=1;Dr[4]=Dr[166]=0;Rr[4]=Rr[166]=0;Er[16]=Er[154]=0;Sr[16]=Sr[154]=1;Tr[16]=Tr[154]=1;xr[16]=xr[154]=1;br[16]=br[154]=0;wr[16]=wr[154]=1;kr[64]=kr[106]=0;Nr[64]=Nr[106]=1;Fr[64]=Fr[106]=0;yr[64]=yr[106]=-1;vr[64]=vr[106]=0;_r[64]=_r[106]=1;kr[2]=kr[168]=0;Nr[2]=Nr[168]=-1;Fr[2]=Fr[168]=1;Br[2]=Br[168]=0;zr[2]=zr[168]=-1;Ur[2]=Ur[168]=0;Ar[2]=Ar[168]=-1;Mr[2]=Mr[168]=0;Lr[2]=Lr[168]=0;Or[2]=Or[168]=-1;Dr[2]=Dr[168]=0;Rr[2]=Rr[168]=1;Er[8]=Er[162]=0;Sr[8]=Sr[162]=-1;Tr[8]=Tr[162]=0;Ir[8]=Ir[162]=0;Cr[8]=Cr[162]=-1;Pr[8]=Pr[162]=1;Ar[8]=Ar[162]=1;Mr[8]=Mr[162]=0;Lr[8]=Lr[162]=1;Or[8]=Or[162]=1;Dr[8]=Dr[162]=0;Rr[8]=Rr[162]=0;Er[32]=Er[138]=0;Sr[32]=Sr[138]=1;Tr[32]=Tr[138]=1;Ir[32]=Ir[138]=0;Cr[32]=Cr[138]=1;Pr[32]=Pr[138]=0;yr[32]=yr[138]=1;vr[32]=vr[138]=0;_r[32]=_r[138]=0;xr[32]=xr[138]=1;br[32]=br[138]=0;wr[32]=wr[138]=1;Br[128]=Br[42]=0;zr[128]=zr[42]=1;Ur[128]=Ur[42]=1;kr[128]=kr[42]=0;Nr[128]=Nr[42]=1;Fr[128]=Fr[42]=0;yr[128]=yr[42]=-1;vr[128]=vr[42]=0;_r[128]=_r[42]=1;xr[128]=xr[42]=-1;br[128]=br[42]=0;wr[128]=wr[42]=0;Ir[5]=Ir[165]=-1;Cr[5]=Cr[165]=0;Pr[5]=Pr[165]=0;Br[5]=Br[165]=1;zr[5]=zr[165]=0;Ur[5]=Ur[165]=0;Or[20]=Or[150]=0;Dr[20]=Dr[150]=1;Rr[20]=Rr[150]=1;xr[20]=xr[150]=0;br[20]=br[150]=-1;wr[20]=wr[150]=1;Er[80]=Er[90]=-1;Sr[80]=Sr[90]=0;Tr[80]=Tr[90]=1;kr[80]=kr[90]=1;Nr[80]=Nr[90]=0;Fr[80]=Fr[90]=1;Ar[65]=Ar[105]=0;Mr[65]=Mr[105]=1;Lr[65]=Lr[105]=0;yr[65]=yr[105]=0;vr[65]=vr[105]=-1;_r[65]=_r[105]=0;Er[160]=Er[10]=-1;Sr[160]=Sr[10]=0;Tr[160]=Tr[10]=1;Ir[160]=Ir[10]=-1;Cr[160]=Cr[10]=0;Pr[160]=Pr[10]=0;Br[160]=Br[10]=1;zr[160]=zr[10]=0;Ur[160]=Ur[10]=0;kr[160]=kr[10]=1;Nr[160]=Nr[10]=0;Fr[160]=Fr[10]=1;Or[130]=Or[40]=0;Dr[130]=Dr[40]=1;Rr[130]=Rr[40]=1;Ar[130]=Ar[40]=0;Mr[130]=Mr[40]=1;Lr[130]=Lr[40]=0;yr[130]=yr[40]=0;vr[130]=vr[40]=-1;_r[130]=_r[40]=0;xr[130]=xr[40]=0;br[130]=br[40]=-1;wr[130]=wr[40]=1;Ir[37]=Ir[133]=0;Cr[37]=Cr[133]=1;Pr[37]=Pr[133]=1;Br[37]=Br[133]=0;zr[37]=zr[133]=1;Ur[37]=Ur[133]=0;yr[37]=yr[133]=-1;vr[37]=vr[133]=0;_r[37]=_r[133]=0;xr[37]=xr[133]=1;br[37]=br[133]=0;wr[37]=wr[133]=0;Or[148]=Or[22]=-1;Dr[148]=Dr[22]=0;Rr[148]=Rr[22]=0;Br[148]=Br[22]=0;zr[148]=zr[22]=-1;Ur[148]=Ur[22]=1;kr[148]=kr[22]=0;Nr[148]=Nr[22]=1;Fr[148]=Fr[22]=1;xr[148]=xr[22]=-1;br[148]=br[22]=0;wr[148]=wr[22]=1;Er[82]=Er[88]=0;Sr[82]=Sr[88]=-1;Tr[82]=Tr[88]=1;Or[82]=Or[88]=1;Dr[82]=Dr[88]=0;Rr[82]=Rr[88]=1;Ar[82]=Ar[88]=-1;Mr[82]=Mr[88]=0;Lr[82]=Lr[88]=1;kr[82]=kr[88]=0;Nr[82]=Nr[88]=-1;Fr[82]=Fr[88]=0;Er[73]=Er[97]=0;Sr[73]=Sr[97]=1;Tr[73]=Tr[97]=0;Ir[73]=Ir[97]=0;Cr[73]=Cr[97]=-1;Pr[73]=Pr[97]=0;Ar[73]=Ar[97]=1;Mr[73]=Mr[97]=0;Lr[73]=Lr[97]=0;yr[73]=yr[97]=1;vr[73]=vr[97]=0;_r[73]=_r[97]=1;Er[145]=Er[25]=0;Sr[145]=Sr[25]=-1;Tr[145]=Tr[25]=0;Ar[145]=Ar[25]=1;Mr[145]=Mr[25]=0;Lr[145]=Lr[25]=1;Br[145]=Br[25]=0;zr[145]=zr[25]=1;Ur[145]=Ur[25]=1;xr[145]=xr[25]=-1;br[145]=br[25]=0;wr[145]=wr[25]=0;Ir[70]=Ir[100]=0;Cr[70]=Cr[100]=1;Pr[70]=Pr[100]=0;Or[70]=Or[100]=-1;Dr[70]=Dr[100]=0;Rr[70]=Rr[100]=1;kr[70]=kr[100]=0;Nr[70]=Nr[100]=-1;Fr[70]=Fr[100]=1;yr[70]=yr[100]=1;vr[70]=vr[100]=0;_r[70]=_r[100]=0;Ir[101]=Ir[69]=0;Cr[101]=Cr[69]=1;Pr[101]=Pr[69]=0;yr[101]=yr[69]=1;vr[101]=vr[69]=0;_r[101]=_r[69]=0;Br[149]=Br[21]=0;zr[149]=zr[21]=1;Ur[149]=Ur[21]=1;xr[149]=xr[21]=-1;br[149]=br[21]=0;wr[149]=wr[21]=0;Or[86]=Or[84]=-1;Dr[86]=Dr[84]=0;Rr[86]=Rr[84]=1;kr[86]=kr[84]=0;Nr[86]=Nr[84]=-1;Fr[86]=Fr[84]=1;Er[89]=Er[81]=0;Sr[89]=Sr[81]=-1;Tr[89]=Tr[81]=0;Ar[89]=Ar[81]=1;Mr[89]=Mr[81]=0;Lr[89]=Lr[81]=1;Er[96]=Er[74]=0;Sr[96]=Sr[74]=1;Tr[96]=Tr[74]=0;Ir[96]=Ir[74]=-1;Cr[96]=Cr[74]=0;Pr[96]=Pr[74]=1;kr[96]=kr[74]=1;Nr[96]=Nr[74]=0;Fr[96]=Fr[74]=0;yr[96]=yr[74]=1;vr[96]=vr[74]=0;_r[96]=_r[74]=1;Er[24]=Er[146]=0;Sr[24]=Sr[146]=-1;Tr[24]=Tr[146]=1;Or[24]=Or[146]=1;Dr[24]=Dr[146]=0;Rr[24]=Rr[146]=1;Ar[24]=Ar[146]=0;Mr[24]=Mr[146]=1;Lr[24]=Lr[146]=1;xr[24]=xr[146]=0;br[24]=br[146]=-1;wr[24]=wr[146]=0;Ir[6]=Ir[164]=-1;Cr[6]=Cr[164]=0;Pr[6]=Pr[164]=1;Or[6]=Or[164]=-1;Dr[6]=Dr[164]=0;Rr[6]=Rr[164]=0;Br[6]=Br[164]=0;zr[6]=zr[164]=-1;Ur[6]=Ur[164]=1;kr[6]=kr[164]=1;Nr[6]=Nr[164]=0;Fr[6]=Fr[164]=0;Ar[129]=Ar[41]=0;Mr[129]=Mr[41]=1;Lr[129]=Lr[41]=1;Br[129]=Br[41]=0;zr[129]=zr[41]=1;Ur[129]=Ur[41]=0;yr[129]=yr[41]=-1;vr[129]=vr[41]=0;_r[129]=_r[41]=0;xr[129]=xr[41]=0;br[129]=br[41]=-1;wr[129]=wr[41]=0;Or[66]=Or[104]=0;Dr[66]=Dr[104]=1;Rr[66]=Rr[104]=0;Ar[66]=Ar[104]=-1;Mr[66]=Mr[104]=0;Lr[66]=Lr[104]=1;kr[66]=kr[104]=0;Nr[66]=Nr[104]=-1;Fr[66]=Fr[104]=0;yr[66]=yr[104]=0;vr[66]=vr[104]=-1;_r[66]=_r[104]=1;Er[144]=Er[26]=-1;Sr[144]=Sr[26]=0;Tr[144]=Tr[26]=0;Br[144]=Br[26]=1;zr[144]=zr[26]=0;Ur[144]=Ur[26]=1;kr[144]=kr[26]=0;Nr[144]=Nr[26]=1;Fr[144]=Fr[26]=1;xr[144]=xr[26]=-1;br[144]=br[26]=0;wr[144]=wr[26]=1;Ir[36]=Ir[134]=0;Cr[36]=Cr[134]=1;Pr[36]=Pr[134]=1;Or[36]=Or[134]=0;Dr[36]=Dr[134]=1;Rr[36]=Rr[134]=0;yr[36]=yr[134]=0;vr[36]=vr[134]=-1;_r[36]=_r[134]=1;xr[36]=xr[134]=1;br[36]=br[134]=0;wr[36]=wr[134]=0;Er[9]=Er[161]=-1;Sr[9]=Sr[161]=0;Tr[9]=Tr[161]=0;Ir[9]=Ir[161]=0;Cr[9]=Cr[161]=-1;Pr[9]=Pr[161]=0;Ar[9]=Ar[161]=1;Mr[9]=Mr[161]=0;Lr[9]=Lr[161]=0;Br[9]=Br[161]=1;zr[9]=zr[161]=0;Ur[9]=Ur[161]=1;Er[136]=0;Sr[136]=1;Tr[136]=1;Ir[136]=0;Cr[136]=1;Pr[136]=0;Or[136]=-1;Dr[136]=0;Rr[136]=1;Ar[136]=-1;Mr[136]=0;Lr[136]=0;Br[136]=0;zr[136]=-1;Ur[136]=0;kr[136]=0;Nr[136]=-1;Fr[136]=1;yr[136]=1;vr[136]=0;_r[136]=0;xr[136]=1;br[136]=0;wr[136]=1;Er[34]=0;Sr[34]=-1;Tr[34]=0;Ir[34]=0;Cr[34]=-1;Pr[34]=1;Or[34]=1;Dr[34]=0;Rr[34]=0;Ar[34]=1;Mr[34]=0;Lr[34]=1;Br[34]=0;zr[34]=1;Ur[34]=1;kr[34]=0;Nr[34]=1;Fr[34]=0;yr[34]=-1;vr[34]=0;_r[34]=1;xr[34]=-1;br[34]=0;wr[34]=0;Er[35]=0;Sr[35]=1;Tr[35]=1;Ir[35]=0;Cr[35]=-1;Pr[35]=1;Or[35]=1;Dr[35]=0;Rr[35]=0;Ar[35]=-1;Mr[35]=0;Lr[35]=0;Br[35]=0;zr[35]=-1;Ur[35]=0;kr[35]=0;Nr[35]=1;Fr[35]=0;yr[35]=-1;vr[35]=0;_r[35]=1;xr[35]=1;br[35]=0;wr[35]=1;Er[153]=0;Sr[153]=1;Tr[153]=1;Ar[153]=-1;Mr[153]=0;Lr[153]=0;Br[153]=0;zr[153]=-1;Ur[153]=0;xr[153]=1;br[153]=0;wr[153]=1;Ir[102]=0;Cr[102]=-1;Pr[102]=1;Or[102]=1;Dr[102]=0;Rr[102]=0;kr[102]=0;Nr[102]=1;Fr[102]=0;yr[102]=-1;vr[102]=0;_r[102]=1;Er[155]=0;Sr[155]=-1;Tr[155]=0;Ar[155]=1;Mr[155]=0;Lr[155]=1;Br[155]=0;zr[155]=1;Ur[155]=1;xr[155]=-1;br[155]=0;wr[155]=0;Ir[103]=0;Cr[103]=1;Pr[103]=0;Or[103]=-1;Dr[103]=0;Rr[103]=1;kr[103]=0;Nr[103]=-1;Fr[103]=1;yr[103]=1;vr[103]=0;_r[103]=0;Er[152]=0;Sr[152]=1;Tr[152]=1;Or[152]=-1;Dr[152]=0;Rr[152]=1;Ar[152]=-1;Mr[152]=0;Lr[152]=0;Br[152]=0;zr[152]=-1;Ur[152]=0;kr[152]=0;Nr[152]=-1;Fr[152]=1;xr[152]=1;br[152]=0;wr[152]=1;Er[156]=0;Sr[156]=-1;Tr[156]=1;Or[156]=1;Dr[156]=0;Rr[156]=1;Ar[156]=-1;Mr[156]=0;Lr[156]=0;Br[156]=0;zr[156]=-1;Ur[156]=0;kr[156]=0;Nr[156]=1;Fr[156]=1;xr[156]=-1;br[156]=0;wr[156]=1;Er[137]=0;Sr[137]=1;Tr[137]=1;Ir[137]=0;Cr[137]=1;Pr[137]=0;Ar[137]=-1;Mr[137]=0;Lr[137]=0;Br[137]=0;zr[137]=-1;Ur[137]=0;yr[137]=1;vr[137]=0;_r[137]=0;xr[137]=1;br[137]=0;wr[137]=1;Er[139]=0;Sr[139]=1;Tr[139]=1;Ir[139]=0;Cr[139]=-1;Pr[139]=0;Ar[139]=1;Mr[139]=0;Lr[139]=0;Br[139]=0;zr[139]=1;Ur[139]=0;yr[139]=-1;vr[139]=0;_r[139]=0;xr[139]=1;br[139]=0;wr[139]=1;Er[98]=0;Sr[98]=-1;Tr[98]=0;Ir[98]=0;Cr[98]=-1;Pr[98]=1;Or[98]=1;Dr[98]=0;Rr[98]=0;Ar[98]=1;Mr[98]=0;Lr[98]=1;kr[98]=0;Nr[98]=1;Fr[98]=0;yr[98]=-1;vr[98]=0;_r[98]=1;Er[99]=0;Sr[99]=1;Tr[99]=0;Ir[99]=0;Cr[99]=-1;Pr[99]=1;Or[99]=1;Dr[99]=0;Rr[99]=0;Ar[99]=-1;Mr[99]=0;Lr[99]=1;kr[99]=0;Nr[99]=-1;Fr[99]=0;yr[99]=1;vr[99]=0;_r[99]=1;Ir[38]=0;Cr[38]=-1;Pr[38]=1;Or[38]=1;Dr[38]=0;Rr[38]=0;Br[38]=0;zr[38]=1;Ur[38]=1;kr[38]=0;Nr[38]=1;Fr[38]=0;yr[38]=-1;vr[38]=0;_r[38]=1;xr[38]=-1;br[38]=0;wr[38]=0;Ir[39]=0;Cr[39]=1;Pr[39]=1;Or[39]=-1;Dr[39]=0;Rr[39]=0;Br[39]=0;zr[39]=-1;Ur[39]=1;kr[39]=0;Nr[39]=1;Fr[39]=0;yr[39]=-1;vr[39]=0;_r[39]=1;xr[39]=1;br[39]=0;wr[39]=0;var f2=function(e){return[[e.bottomleft,0],[0,0],[0,e.leftbottom]]},d2=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0]]},p2=function(e){return[[e.topright,1],[1,1],[1,e.righttop]]},g2=function(e){return[[0,e.lefttop],[0,1],[e.topleft,1]]},m2=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop]]},y2=function(e){return[[e.bottomright,0],[e.bottomleft,0],[1,e.righttop],[1,e.rightbottom]]},v2=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.topleft,1],[e.topright,1]]},_2=function(e){return[[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},Cq=function(e){return[[0,0],[0,e.leftbottom],[1,e.rightbottom],[1,0]]},Pq=function(e){return[[1,0],[e.bottomright,0],[e.topright,1],[1,1]]},Aq=function(e){return[[1,1],[1,e.righttop],[0,e.lefttop],[0,1]]},Mq=function(e){return[[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},Lq=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.leftbottom],[0,e.lefttop]]},Oq=function(e){return[[e.topleft,1],[e.topright,1],[e.bottomright,0],[e.bottomleft,0]]},Dq=function(){return[[0,0],[0,1],[1,1],[1,0]]},Rq=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,1],[e.topleft,1]]},kq=function(e){return[[e.topright,1],[1,1],[1,0],[0,0],[0,e.leftbottom]]},Nq=function(e){return[[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[1,1]]},Fq=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,1]]},Bq=function(e){return[[1,e.righttop],[1,e.rightbottom],[0,e.lefttop],[0,1],[e.topleft,1]]},zq=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[e.topright,1]]},Uq=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop]]},Vq=function(e){return[[e.topright,1],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1]]},Gq=function(e){return[[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},$q=function(e){return[[1,1],[1,e.righttop],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},jq=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[e.topleft,1],[e.topright,1]]},qq=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom]]},Zq=function(e){return[[1,e.rightbottom],[1,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},Xq=function(e){return[[1,1],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},Wq=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1]]},Hq=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,1],[e.topleft,1]]},Yq=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},Kq=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},Jq=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},Qq=function(e){return[[1,1],[1,e.righttop],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topright,1]]},eZ=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.lefttop],[0,1],[e.topleft,1]]},tZ=function(e){return[[1,1],[1,e.righttop],[e.bottomright,0],[e.bottomleft,0],[0,e.leftbottom],[0,e.lefttop],[e.topright,1]]},nZ=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomleft,0],[0,0],[0,e.leftbottom],[e.topleft,1],[e.topright,1]]},rZ=function(e){return[[1,e.righttop],[1,e.rightbottom],[e.bottomright,0],[e.bottomleft,0],[0,e.lefttop],[0,1],[e.topleft,1]]},iZ=function(e){return[[1,e.rightbottom],[1,0],[e.bottomright,0],[0,e.leftbottom],[0,e.lefttop],[e.topleft,1],[e.topright,1]]},pn=[],hn=[],In=[],Sn=[],Rn=[],On=[],Vr=[],jr=[];Sn[1]=Rn[1]=18;Sn[169]=Rn[169]=18;In[4]=hn[4]=12;In[166]=hn[166]=12;pn[16]=jr[16]=4;pn[154]=jr[154]=4;On[64]=Vr[64]=22;On[106]=Vr[106]=22;In[2]=On[2]=17;Sn[2]=Rn[2]=18;In[168]=On[168]=17;Sn[168]=Rn[168]=18;pn[8]=Sn[8]=9;hn[8]=In[8]=12;pn[162]=Sn[162]=9;hn[162]=In[162]=12;pn[32]=jr[32]=4;hn[32]=Vr[32]=1;pn[138]=jr[138]=4;hn[138]=Vr[138]=1;Rn[128]=jr[128]=21;On[128]=Vr[128]=22;Rn[42]=jr[42]=21;On[42]=Vr[42]=22;hn[5]=Rn[5]=14;hn[165]=Rn[165]=14;In[20]=jr[20]=6;In[150]=jr[150]=6;pn[80]=On[80]=11;pn[90]=On[90]=11;Sn[65]=Vr[65]=3;Sn[105]=Vr[105]=3;pn[160]=On[160]=11;hn[160]=Rn[160]=14;pn[10]=On[10]=11;hn[10]=Rn[10]=14;In[130]=jr[130]=6;Sn[130]=Vr[130]=3;In[40]=jr[40]=6;Sn[40]=Vr[40]=3;hn[101]=Vr[101]=1;hn[69]=Vr[69]=1;Rn[149]=jr[149]=21;Rn[21]=jr[21]=21;In[86]=On[86]=17;In[84]=On[84]=17;pn[89]=Sn[89]=9;pn[81]=Sn[81]=9;pn[96]=Vr[96]=0;hn[96]=On[96]=15;pn[74]=Vr[74]=0;hn[74]=On[74]=15;pn[24]=In[24]=8;Sn[24]=jr[24]=7;pn[146]=In[146]=8;Sn[146]=jr[146]=7;hn[6]=On[6]=15;In[6]=Rn[6]=16;hn[164]=On[164]=15;In[164]=Rn[164]=16;Sn[129]=jr[129]=7;Rn[129]=Vr[129]=20;Sn[41]=jr[41]=7;Rn[41]=Vr[41]=20;In[66]=Vr[66]=2;Sn[66]=On[66]=19;In[104]=Vr[104]=2;Sn[104]=On[104]=19;pn[144]=Rn[144]=10;On[144]=jr[144]=23;pn[26]=Rn[26]=10;On[26]=jr[26]=23;hn[36]=jr[36]=5;In[36]=Vr[36]=2;hn[134]=jr[134]=5;In[134]=Vr[134]=2;pn[9]=Rn[9]=10;hn[9]=Sn[9]=13;pn[161]=Rn[161]=10;hn[161]=Sn[161]=13;hn[37]=jr[37]=5;Rn[37]=Vr[37]=20;hn[133]=jr[133]=5;Rn[133]=Vr[133]=20;In[148]=Rn[148]=16;On[148]=jr[148]=23;In[22]=Rn[22]=16;On[22]=jr[22]=23;pn[82]=In[82]=8;Sn[82]=On[82]=19;pn[88]=In[88]=8;Sn[88]=On[88]=19;pn[73]=Vr[73]=0;hn[73]=Sn[73]=13;pn[97]=Vr[97]=0;hn[97]=Sn[97]=13;pn[145]=Sn[145]=9;Rn[145]=jr[145]=21;pn[25]=Sn[25]=9;Rn[25]=jr[25]=21;hn[70]=Vr[70]=1;In[70]=On[70]=17;hn[100]=Vr[100]=1;In[100]=On[100]=17;pn[34]=Sn[34]=9;hn[34]=In[34]=12;Rn[34]=jr[34]=21;On[34]=Vr[34]=22;pn[136]=jr[136]=4;hn[136]=Vr[136]=1;In[136]=On[136]=17;Sn[136]=Rn[136]=18;pn[35]=jr[35]=4;hn[35]=In[35]=12;Sn[35]=Rn[35]=18;On[35]=Vr[35]=22;pn[153]=jr[153]=4;Sn[153]=Rn[153]=18;hn[102]=In[102]=12;On[102]=Vr[102]=22;pn[155]=Sn[155]=9;Rn[155]=jr[155]=23;hn[103]=Vr[103]=1;In[103]=On[103]=17;pn[152]=jr[152]=4;In[152]=On[152]=17;Sn[152]=Rn[152]=18;pn[156]=In[156]=8;Sn[156]=Rn[156]=18;On[156]=jr[156]=23;pn[137]=jr[137]=4;hn[137]=Vr[137]=1;Sn[137]=Rn[137]=18;pn[139]=jr[139]=4;hn[139]=Sn[139]=13;Rn[139]=Vr[139]=20;pn[98]=Sn[98]=9;hn[98]=In[98]=12;On[98]=Vr[98]=22;pn[99]=Vr[99]=0;hn[99]=In[99]=12;Sn[99]=On[99]=19;hn[38]=In[38]=12;Rn[38]=jr[38]=21;On[38]=Vr[38]=22;hn[39]=jr[39]=5;In[39]=Rn[39]=16;On[39]=Vr[39]=22;var rn=[];rn[1]=rn[169]=f2;rn[4]=rn[166]=d2;rn[16]=rn[154]=p2;rn[64]=rn[106]=g2;rn[168]=rn[2]=m2;rn[162]=rn[8]=y2;rn[138]=rn[32]=v2;rn[42]=rn[128]=_2;rn[5]=rn[165]=Cq;rn[20]=rn[150]=Pq;rn[80]=rn[90]=Aq;rn[65]=rn[105]=Mq;rn[160]=rn[10]=Lq;rn[130]=rn[40]=Oq;rn[85]=Dq;rn[101]=rn[69]=Rq;rn[149]=rn[21]=kq;rn[86]=rn[84]=Nq;rn[89]=rn[81]=Fq;rn[96]=rn[74]=Bq;rn[24]=rn[146]=zq;rn[6]=rn[164]=Uq;rn[129]=rn[41]=Vq;rn[66]=rn[104]=Gq;rn[144]=rn[26]=$q;rn[36]=rn[134]=jq;rn[9]=rn[161]=qq;rn[37]=rn[133]=Zq;rn[148]=rn[22]=Xq;rn[82]=rn[88]=Wq;rn[73]=rn[97]=Hq;rn[145]=rn[25]=Yq;rn[70]=rn[100]=Kq;rn[34]=function(e){return[_2(e),y2(e)]};rn[35]=Jq;rn[136]=function(e){return[v2(e),m2(e)]};rn[153]=function(e){return[p2(e),f2(e)]};rn[102]=function(e){return[d2(e),g2(e)]};rn[155]=Qq;rn[103]=eZ;rn[152]=function(e){return[p2(e),m2(e)]};rn[156]=tZ;rn[137]=function(e){return[v2(e),f2(e)]};rn[139]=nZ;rn[98]=function(e){return[y2(e),g2(e)]};rn[99]=rZ;rn[38]=function(e){return[d2(e),_2(e)]};rn[39]=iZ;function ie(e,t,n){return(e-t)/(n-t)}function xT(e){return e.constructor.toString().indexOf("Array")>-1}function oZ(e,t,n){for(var r=e.length-1,i=e[0].length-1,a={rows:r,cols:i,cells:[]},l=t+Math.abs(n),o=0;o<r;++o){a.cells[o]=[];for(var f=0;f<i;++f){var p=0,y=e[o+1][f],x=e[o+1][f+1],w=e[o][f+1],S=e[o][f];if(!(isNaN(y)||isNaN(x)||isNaN(w)||isNaN(S))){p|=y<t?0:y>l?128:64,p|=x<t?0:x>l?32:16,p|=w<t?0:w>l?8:4,p|=S<t?0:S>l?2:1;var L=+p,D=0;if(p===17||p===18||p===33||p===34||p===38||p===68||p===72||p===98||p===102||p===132||p===136||p===137||p===152||p===153){var B=(y+x+w+S)/4;D=B>l?2:B<t?0:1,p===34?D===1?p=35:D===0&&(p=136):p===136?D===1?(p=35,D=4):D===0&&(p=34):p===17?D===1?(p=155,D=4):D===0&&(p=153):p===68?D===1?(p=103,D=4):D===0&&(p=102):p===153?D===1&&(p=155):p===102?D===1&&(p=103):p===152?D<2&&(p=156,D=1):p===137?D<2&&(p=139,D=1):p===98?D<2&&(p=99,D=1):p===38?D<2&&(p=39,D=1):p===18?D>0?(p=156,D=4):p=152:p===33?D>0?(p=139,D=4):p=137:p===72?D>0?(p=99,D=4):p=98:p===132&&(D>0?(p=39,D=4):p=38)}if(p!=0&&p!=170){var z,M,k,V,q,Y,K,X;z=M=k=V=q=Y=K=X=.5;var U=[];p===1?(k=1-ie(t,w,S),X=1-ie(t,y,S),U.push(Sn[p])):p===169?(k=ie(l,S,w),X=ie(l,S,y),U.push(Sn[p])):p===4?(Y=1-ie(t,x,w),V=ie(t,S,w),U.push(hn[p])):p===166?(Y=ie(l,w,x),V=1-ie(l,w,S),U.push(hn[p])):p===16?(q=ie(t,w,x),M=ie(t,y,x),U.push(pn[p])):p===154?(q=1-ie(l,x,w),M=1-ie(l,x,y),U.push(pn[p])):p===64?(K=ie(t,S,y),z=1-ie(t,x,y),U.push(On[p])):p===106?(K=1-ie(l,y,S),z=ie(l,y,x),U.push(On[p])):p===168?(V=ie(l,S,w),k=ie(t,S,w),X=ie(t,S,y),K=ie(l,S,y),U.push(In[p]),U.push(Sn[p])):p===2?(V=1-ie(t,w,S),k=1-ie(l,w,S),X=1-ie(l,y,S),K=1-ie(t,y,S),U.push(In[p]),U.push(Sn[p])):p===162?(q=ie(l,w,x),Y=ie(t,w,x),V=1-ie(t,w,S),k=1-ie(l,w,S),U.push(In[p]),U.push(Sn[p])):p===8?(q=1-ie(t,x,w),Y=1-ie(l,x,w),V=ie(l,S,w),k=ie(t,S,w),U.push(pn[p]),U.push(hn[p])):p===138?(q=1-ie(t,x,w),Y=1-ie(l,x,w),z=1-ie(l,x,y),M=1-ie(t,x,y),U.push(pn[p]),U.push(hn[p])):p===32?(q=ie(l,w,x),Y=ie(t,w,x),z=ie(t,y,x),M=ie(l,y,x),U.push(pn[p]),U.push(hn[p])):p===42?(X=1-ie(l,y,S),K=1-ie(t,y,S),z=ie(t,y,x),M=ie(l,y,x),U.push(Rn[p]),U.push(On[p])):p===128&&(X=ie(t,S,y),K=ie(l,S,y),z=1-ie(l,x,y),M=1-ie(t,x,y),U.push(Rn[p]),U.push(On[p])),p===5?(Y=1-ie(t,x,w),X=1-ie(t,y,S),U.push(hn[p])):p===165?(Y=ie(l,w,x),X=ie(l,S,y),U.push(hn[p])):p===20?(V=ie(t,S,w),M=ie(t,y,x),U.push(In[p])):p===150?(V=1-ie(l,w,S),M=1-ie(l,x,y),U.push(In[p])):p===80?(q=ie(t,w,x),K=ie(t,S,y),U.push(pn[p])):p===90?(q=1-ie(l,x,w),K=1-ie(l,y,S),U.push(pn[p])):p===65?(k=1-ie(t,w,S),z=1-ie(t,x,y),U.push(Sn[p])):p===105?(k=ie(l,S,w),z=ie(l,y,x),U.push(Sn[p])):p===160?(q=ie(l,w,x),Y=ie(t,w,x),X=ie(t,S,y),K=ie(l,S,y),U.push(pn[p]),U.push(hn[p])):p===10?(q=1-ie(t,x,w),Y=1-ie(l,x,w),X=1-ie(l,y,S),K=1-ie(t,y,S),U.push(pn[p]),U.push(hn[p])):p===130?(V=1-ie(t,w,S),k=1-ie(l,w,S),z=1-ie(l,x,y),M=1-ie(t,x,y),U.push(In[p]),U.push(Sn[p])):p===40?(V=ie(l,S,w),k=ie(t,S,w),z=ie(t,y,x),M=ie(l,y,x),U.push(In[p]),U.push(Sn[p])):p===101?(Y=ie(l,w,x),z=ie(l,y,x),U.push(hn[p])):p===69?(Y=1-ie(t,x,w),z=1-ie(t,x,y),U.push(hn[p])):p===149?(X=ie(l,S,y),M=1-ie(l,x,y),U.push(Rn[p])):p===21?(X=1-ie(t,y,S),M=ie(t,y,x),U.push(Rn[p])):p===86?(V=1-ie(l,w,S),K=1-ie(l,y,S),U.push(In[p])):p===84?(V=ie(t,S,w),K=ie(t,S,y),U.push(In[p])):p===89?(q=1-ie(l,x,w),k=ie(l,S,w),U.push(Sn[p])):p===81?(q=ie(t,w,x),k=1-ie(t,w,S),U.push(Sn[p])):p===96?(q=ie(l,w,x),Y=ie(t,w,x),K=ie(t,S,y),z=ie(l,y,x),U.push(pn[p]),U.push(hn[p])):p===74?(q=1-ie(t,x,w),Y=1-ie(l,x,w),K=1-ie(l,y,S),z=1-ie(t,x,y),U.push(pn[p]),U.push(hn[p])):p===24?(q=1-ie(l,x,w),V=ie(l,S,w),k=ie(t,S,w),M=ie(t,y,x),U.push(pn[p]),U.push(Sn[p])):p===146?(q=ie(t,w,x),V=1-ie(t,w,S),k=1-ie(l,w,S),M=1-ie(l,x,y),U.push(pn[p]),U.push(Sn[p])):p===6?(Y=1-ie(t,x,w),V=1-ie(l,w,S),X=1-ie(l,y,S),K=1-ie(t,y,S),U.push(hn[p]),U.push(In[p])):p===164?(Y=ie(l,w,x),V=ie(t,S,w),X=ie(t,S,y),K=ie(l,S,y),U.push(hn[p]),U.push(In[p])):p===129?(k=1-ie(t,w,S),X=ie(l,S,y),z=1-ie(l,x,y),M=1-ie(t,x,y),U.push(Sn[p]),U.push(Rn[p])):p===41?(k=ie(l,S,w),X=1-ie(t,y,S),z=ie(t,y,x),M=ie(l,y,x),U.push(Sn[p]),U.push(Rn[p])):p===66?(V=1-ie(t,w,S),k=1-ie(l,w,S),K=1-ie(l,y,S),z=1-ie(t,x,y),U.push(In[p]),U.push(Sn[p])):p===104?(V=ie(l,S,w),k=ie(t,S,w),K=ie(t,S,y),z=ie(l,y,x),U.push(Sn[p]),U.push(Vr[p])):p===144?(q=ie(t,w,x),X=ie(t,S,y),K=ie(l,S,y),M=1-ie(l,x,y),U.push(pn[p]),U.push(On[p])):p===26?(q=1-ie(l,x,w),X=1-ie(l,y,S),K=1-ie(t,y,S),M=ie(t,y,x),U.push(pn[p]),U.push(On[p])):p===36?(Y=ie(l,w,x),V=ie(t,S,w),z=ie(t,y,x),M=ie(l,y,x),U.push(hn[p]),U.push(In[p])):p===134?(Y=1-ie(t,x,w),V=1-ie(l,w,S),z=1-ie(l,x,y),M=1-ie(t,x,y),U.push(hn[p]),U.push(In[p])):p===9?(q=1-ie(t,x,w),Y=1-ie(l,x,w),k=ie(l,S,w),X=1-ie(t,y,S),U.push(pn[p]),U.push(hn[p])):p===161?(q=ie(l,w,x),Y=ie(t,w,x),k=1-ie(t,w,S),X=ie(l,S,y),U.push(pn[p]),U.push(hn[p])):p===37?(Y=ie(l,w,x),X=1-ie(t,y,S),z=ie(t,y,x),M=ie(l,y,x),U.push(hn[p]),U.push(Rn[p])):p===133?(Y=1-ie(t,x,w),X=ie(l,S,y),z=1-ie(l,x,y),M=1-ie(t,x,y),U.push(hn[p]),U.push(Rn[p])):p===148?(V=ie(t,S,w),X=ie(t,S,y),K=ie(l,S,y),M=1-ie(l,x,y),U.push(In[p]),U.push(On[p])):p===22?(V=1-ie(l,w,S),X=1-ie(l,y,S),K=1-ie(t,y,S),M=ie(t,y,x),U.push(In[p]),U.push(On[p])):p===82?(q=ie(t,w,x),V=1-ie(t,w,S),k=1-ie(l,w,S),K=1-ie(l,y,S),U.push(pn[p]),U.push(Sn[p])):p===88?(q=1-ie(l,x,w),V=ie(l,S,w),k=ie(t,S,w),K=ie(t,S,y),U.push(pn[p]),U.push(Sn[p])):p===73?(q=1-ie(t,x,w),Y=1-ie(l,x,w),k=ie(l,S,w),z=1-ie(t,x,y),U.push(pn[p]),U.push(hn[p])):p===97?(q=ie(l,w,x),Y=ie(t,w,x),k=1-ie(t,w,S),z=ie(l,y,x),U.push(pn[p]),U.push(hn[p])):p===145?(q=ie(t,w,x),k=1-ie(t,w,S),X=ie(l,S,y),M=1-ie(l,x,y),U.push(pn[p]),U.push(Rn[p])):p===25?(q=1-ie(l,x,w),k=ie(l,S,w),X=1-ie(t,y,S),M=ie(t,y,x),U.push(pn[p]),U.push(Rn[p])):p===70?(Y=1-ie(t,x,w),V=1-ie(l,w,S),K=1-ie(l,y,S),z=1-ie(t,x,y),U.push(hn[p]),U.push(In[p])):p===100?(Y=ie(l,w,x),V=ie(t,S,w),K=ie(t,S,y),z=ie(l,y,x),U.push(hn[p]),U.push(In[p])):p===34?(D===0?(q=1-ie(t,x,w),Y=1-ie(l,x,w),V=ie(l,S,w),k=ie(t,S,w),X=ie(t,S,y),K=ie(l,S,y),z=1-ie(l,x,y),M=1-ie(t,x,y)):(q=ie(l,w,x),Y=ie(t,w,x),V=1-ie(t,w,S),k=1-ie(l,w,S),X=1-ie(l,y,S),K=1-ie(t,y,S),z=ie(t,y,x),M=ie(l,y,x)),U.push(pn[p]),U.push(hn[p]),U.push(Rn[p]),U.push(On[p])):p===35?(D===4?(q=1-ie(t,x,w),Y=1-ie(l,x,w),V=ie(l,S,w),k=ie(t,S,w),X=ie(t,S,y),K=ie(l,S,y),z=1-ie(l,x,y),M=1-ie(t,x,y)):(q=ie(l,w,x),Y=ie(t,w,x),V=1-ie(t,w,S),k=1-ie(l,w,S),X=1-ie(l,y,S),K=1-ie(t,y,S),z=ie(t,y,x),M=ie(l,y,x)),U.push(pn[p]),U.push(hn[p]),U.push(Sn[p]),U.push(On[p])):p===136?(D===0?(q=ie(l,w,x),Y=ie(t,w,x),V=1-ie(t,w,S),k=1-ie(l,w,S),X=1-ie(l,y,S),K=1-ie(t,y,S),z=ie(t,y,x),M=ie(l,y,x)):(q=1-ie(t,x,w),Y=1-ie(l,x,w),V=ie(l,S,w),k=ie(t,S,w),X=ie(t,S,y),K=ie(l,S,y),z=1-ie(l,x,y),M=1-ie(t,x,y)),U.push(pn[p]),U.push(hn[p]),U.push(Rn[p]),U.push(On[p])):p===153?(D===0?(q=ie(t,w,x),k=1-ie(t,w,S),X=1-ie(t,y,S),M=ie(t,y,x)):(q=1-ie(l,x,w),k=ie(l,S,w),X=ie(l,S,y),M=1-ie(l,x,y)),U.push(pn[p]),U.push(Sn[p])):p===102?(D===0?(Y=1-ie(t,x,w),V=ie(t,S,w),K=ie(t,S,y),z=1-ie(t,x,y)):(Y=ie(l,w,x),V=1-ie(l,w,S),K=1-ie(l,y,S),z=ie(l,y,x)),U.push(hn[p]),U.push(On[p])):p===155?(D===4?(q=ie(t,w,x),k=1-ie(t,w,S),X=1-ie(t,y,S),M=ie(t,y,x)):(q=1-ie(l,x,w),k=ie(l,S,w),X=ie(l,S,y),M=1-ie(l,x,y)),U.push(pn[p]),U.push(Rn[p])):p===103?(D===4?(Y=1-ie(t,x,w),V=ie(t,S,w),K=ie(t,S,y),z=1-ie(t,x,y)):(Y=ie(l,w,x),V=1-ie(l,w,S),K=1-ie(l,y,S),z=ie(l,y,x)),U.push(hn[p]),U.push(In[p])):p===152?(D===0?(q=ie(t,w,x),V=1-ie(t,w,S),k=1-ie(l,w,S),X=1-ie(l,y,S),K=1-ie(t,y,S),M=ie(t,y,x)):(q=1-ie(l,x,w),V=ie(l,S,w),k=ie(t,S,w),X=ie(t,S,y),K=ie(l,S,y),M=1-ie(l,x,y)),U.push(pn[p]),U.push(In[p]),U.push(Sn[p])):p===156?(D===4?(q=ie(t,w,x),V=1-ie(t,w,S),k=1-ie(l,w,S),X=1-ie(l,y,S),K=1-ie(t,y,S),M=ie(t,y,x)):(q=1-ie(l,x,w),V=ie(l,S,w),k=ie(t,S,w),X=ie(t,S,y),K=ie(l,S,y),M=1-ie(l,x,y)),U.push(pn[p]),U.push(Sn[p]),U.push(On[p])):p===137?(D===0?(q=ie(l,w,x),Y=ie(t,w,x),k=1-ie(t,w,S),X=1-ie(t,y,S),z=ie(t,y,x),M=ie(l,y,x)):(q=1-ie(t,x,w),Y=1-ie(l,x,w),k=ie(l,S,w),X=ie(l,S,y),z=1-ie(l,x,y),M=1-ie(t,x,y)),U.push(pn[p]),U.push(hn[p]),U.push(Sn[p])):p===139?(D===4?(q=ie(l,w,x),Y=ie(t,w,x),k=1-ie(t,w,S),X=1-ie(t,y,S),z=ie(t,y,x),M=ie(l,y,x)):(q=1-ie(t,x,w),Y=1-ie(l,x,w),k=ie(l,S,w),X=ie(l,S,y),z=1-ie(l,x,y),M=1-ie(t,x,y)),U.push(pn[p]),U.push(hn[p]),U.push(Rn[p])):p===98?(D===0?(q=1-ie(t,x,w),Y=1-ie(l,x,w),V=ie(l,S,w),k=ie(t,S,w),K=ie(t,S,y),z=1-ie(t,x,y)):(q=ie(l,w,x),Y=ie(t,w,x),V=1-ie(t,w,S),k=1-ie(l,w,S),K=1-ie(l,y,S),z=ie(l,y,x)),U.push(pn[p]),U.push(hn[p]),U.push(On[p])):p===99?(D===4?(q=1-ie(t,x,w),Y=1-ie(l,x,w),V=ie(l,S,w),k=ie(t,S,w),K=ie(t,S,y),z=1-ie(t,x,y)):(q=ie(l,w,x),Y=ie(t,w,x),V=1-ie(t,w,S),k=1-ie(l,w,S),K=1-ie(l,y,S),z=ie(l,y,x)),U.push(pn[p]),U.push(hn[p]),U.push(Sn[p])):p===38?(D===0?(Y=1-ie(t,x,w),V=ie(t,S,w),X=ie(t,S,y),K=ie(l,S,y),z=1-ie(l,x,y),M=1-ie(t,x,y)):(Y=ie(l,w,x),V=1-ie(l,w,S),X=1-ie(l,y,S),K=1-ie(t,y,S),z=ie(t,y,x),M=ie(l,y,x)),U.push(hn[p]),U.push(Rn[p]),U.push(On[p])):p===39?(D===4?(Y=1-ie(t,x,w),V=ie(t,S,w),X=ie(t,S,y),K=ie(l,S,y),z=1-ie(l,x,y),M=1-ie(t,x,y)):(Y=ie(l,w,x),V=1-ie(l,w,S),X=1-ie(l,y,S),K=1-ie(t,y,S),z=ie(t,y,x),M=ie(l,y,x)),U.push(hn[p]),U.push(In[p]),U.push(On[p])):p===85&&(q=1,Y=0,V=1,k=0,X=0,K=1,z=0,M=1),(z<0||z>1||M<0||M>1||q<0||q>1||V<0||V>1||X<0||X>1||K<0||K>1)&&console.log("MarchingSquaresJS-isoBands: "+p+" "+L+" "+y+","+x+","+w+","+S+" "+D+" "+z+" "+M+" "+q+" "+Y+" "+V+" "+k+" "+X+" "+K),a.cells[o][f]={cval:p,cval_real:L,flipped:D,topleft:z,topright:M,righttop:q,rightbottom:Y,bottomright:V,bottomleft:k,leftbottom:X,lefttop:K,edges:U}}}}}return a}function aZ(e){for(var t=[],n=e.rows,r=e.cols,i=[],a=0;a<n;a++)for(var l=0;l<r;l++)if(typeof e.cells[a][l]<"u"&&e.cells[a][l].edges.length>0){var o=e.cells[a][l],f=uZ(o),p=null,y=l,x=a;f!==null&&i.push([f.p[0]+y,f.p[1]+x]);do{if(p=cZ(e.cells[x][y],f.x,f.y,f.o),p!==null)i.push([p.p[0]+y,p.p[1]+x]),y+=p.x,x+=p.y,f=p;else break;if(x<0||x>=n||y<0||y>=r||typeof e.cells[x][y]>"u"){y-=p.x,x-=p.y;var w=sZ(e,y,x,p.x,p.y,p.o);if(w!==null)w.path.forEach(function(S){i.push(S)}),y=w.i,x=w.j,f=w;else break}}while(typeof e.cells[x][y]<"u"&&e.cells[x][y].edges.length>0);t.push(i),i=[],e.cells[a][l].edges.length>0&&l--}return t}function sZ(e,t,n,r,i,a){for(var l=e.cells[n][t],o=l.cval_real,f=t+r,p=n+i,y=[],x=!1;!x;){if(typeof e.cells[p]>"u"||typeof e.cells[p][f]>"u")if(p-=i,f-=r,l=e.cells[p][f],o=l.cval_real,i===-1)if(a===0)if(o&Da)y.push([f,p]),r=-1,i=0,a=0;else if(o&ya)y.push([f+1,p]),r=1,i=0,a=0;else{y.push([f+l.bottomright,p]),r=0,i=1,a=1,x=!0;break}else if(o&Da)y.push([f,p]),r=-1,i=0,a=0;else if(o&ya){y.push([f+l.bottomright,p]),r=0,i=1,a=1,x=!0;break}else{y.push([f+l.bottomleft,p]),r=0,i=1,a=0,x=!0;break}else if(i===1)if(a===0)if(o&lu)y.push([f+1,p+1]),r=1,i=0,a=1;else if(o&Ya){y.push([f+l.topleft,p+1]),r=0,i=-1,a=0,x=!0;break}else{y.push([f+l.topright,p+1]),r=0,i=-1,a=1,x=!0;break}else o&lu?(y.push([f+1,p+1]),r=1,i=0,a=1):(y.push([f+1,p+1]),r=1,i=0,a=1);else if(r===-1)if(a===0)if(o&Ya)y.push([f,p+1]),r=0,i=1,a=0;else if(o&Da){y.push([f,p+l.leftbottom]),r=1,i=0,a=0,x=!0;break}else{y.push([f,p+l.lefttop]),r=1,i=0,a=1,x=!0;break}else if(o&Ya)y.push([f,p+1]),r=0,i=1,a=0;else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(r===1)if(a===0)if(o&ya)y.push([f+1,p]),r=0,i=-1,a=1;else{y.push([f+1,p+l.rightbottom]),r=-1,i=0,a=0,x=!0;break}else if(o&ya)y.push([f+1,p]),r=0,i=-1,a=1;else if(o&lu){y.push([f+1,p+l.righttop]),r=-1,i=0,a=1;break}else{y.push([f+1,p+l.rightbottom]),r=-1,i=0,a=0,x=!0;break}else{console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}else if(l=e.cells[p][f],o=l.cval_real,r===-1)if(a===0)if(typeof e.cells[p-1]<"u"&&typeof e.cells[p-1][f]<"u")r=0,i=-1,a=1;else if(o&Da)y.push([f,p]);else{y.push([f+l.bottomright,p]),r=0,i=1,a=1,x=!0;break}else if(o&Ya)console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!");else{console.log("MarchingSquaresJS-isoBands: found entry from top at "+f+","+p);break}else if(r===1)if(a===0){console.log("MarchingSquaresJS-isoBands: wtf");break}else if(typeof e.cells[p+1]<"u"&&typeof e.cells[p+1][f]<"u")r=0,i=1,a=0;else if(o&lu)y.push([f+1,p+1]),r=1,i=0,a=1;else{y.push([f+l.topleft,p+1]),r=0,i=-1,a=0,x=!0;break}else if(i===-1)if(a===1)if(typeof e.cells[p][f+1]<"u")r=1,i=0,a=1;else if(o&ya)y.push([f+1,p]),r=0,i=-1,a=1;else{y.push([f+1,p+l.righttop]),r=-1,i=0,a=1,x=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else if(i===1)if(a===0)if(typeof e.cells[p][f-1]<"u")r=-1,i=0,a=0;else if(o&Ya)y.push([f,p+1]),r=0,i=1,a=0;else{y.push([f,p+l.leftbottom]),r=1,i=0,a=0,x=!0;break}else{console.log("MarchingSquaresJS-isoBands: wtf");break}else{console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(f+=r,p+=i,f===t&&p===n)break}return{path:y,i:f,j:p,x:r,y:i,o:a}}function lZ(e,t){delete e.edges[t];for(var n=t+1;n<e.edges.length;n++)e.edges[n-1]=e.edges[n];e.edges.pop()}function uZ(e){if(e.edges.length>0){var t=e.edges[e.edges.length-1],n=e.cval_real;switch(t){case 0:return n&lu?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.topleft,1],x:0,y:-1,o:0};case 1:return n&ya?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 2:return n&ya?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[e.topleft,1],x:0,y:-1,o:0};case 3:return n&Da?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 4:return n&lu?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};case 5:return n&ya?{p:[e.topright,1],x:0,y:-1,o:1}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 6:return n&ya?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};case 7:return n&Da?{p:[e.topright,1],x:0,y:-1,o:1}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 8:return n&ya?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[1,e.righttop],x:-1,y:0,o:1};case 9:return n&Da?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 10:return n&Da?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[1,e.righttop],x:-1,y:0,o:1};case 11:return n&Ya?{p:[1,e.righttop],x:-1,y:0,o:1}:{p:[0,e.lefttop],x:1,y:0,o:1};case 12:return n&ya?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 13:return n&Da?{p:[1,e.rightbottom],x:-1,y:0,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 14:return n&Da?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[1,e.rightbottom],x:-1,y:0,o:0};case 15:return n&Ya?{p:[1,e.rightbottom],x:-1,y:0,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 16:return n&ya?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[0,e.leftbottom],x:1,y:0,o:0};case 17:return n&Ya?{p:[e.bottomright,0],x:0,y:1,o:1}:{p:[0,e.lefttop],x:1,y:0,o:1};case 18:return n&Da?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[e.bottomleft,0],x:0,y:1,o:0};case 19:return n&Ya?{p:[e.bottomleft,0],x:0,y:1,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 20:return n&Ya?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[0,e.leftbottom],x:1,y:0,o:0};case 21:return n&lu?{p:[0,e.leftbottom],x:1,y:0,o:0}:{p:[e.topright,1],x:0,y:-1,o:1};case 22:return n&Ya?{p:[e.topleft,1],x:0,y:-1,o:0}:{p:[0,e.lefttop],x:1,y:0,o:1};case 23:return n&lu?{p:[0,e.lefttop],x:1,y:0,o:1}:{p:[e.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(e);break}}return null}function cZ(e,t,n,r){var i,a,l,o,f=e.cval,p;switch(t){case-1:switch(r){case 0:i=hn[f],l=Ir[f],o=Cr[f],p=Pr[f];break;default:i=pn[f],l=Er[f],o=Sr[f],p=Tr[f];break}break;case 1:switch(r){case 0:i=Rn[f],l=Br[f],o=zr[f],p=Ur[f];break;default:i=On[f],l=kr[f],o=Nr[f],p=Fr[f];break}break;default:switch(n){case-1:switch(r){case 0:i=Vr[f],l=yr[f],o=vr[f],p=_r[f];break;default:i=jr[f],l=xr[f],o=br[f],p=wr[f];break}break;case 1:switch(r){case 0:i=Sn[f],l=Ar[f],o=Mr[f],p=Lr[f];break;default:i=In[f],l=Or[f],o=Dr[f],p=Rr[f];break}break}break}if(a=e.edges.indexOf(i),typeof e.edges[a]<"u")lZ(e,a);else return null;switch(f=e.cval_real,i){case 0:f&lu?(t=e.topleft,n=1):(t=1,n=e.righttop);break;case 1:f&ya?(t=1,n=e.rightbottom):(t=e.topleft,n=1);break;case 2:f&ya?(t=e.topleft,n=1):(t=e.bottomright,n=0);break;case 3:f&Da?(t=e.bottomleft,n=0):(t=e.topleft,n=1);break;case 4:f&lu?(t=e.topright,n=1):(t=1,n=e.righttop);break;case 5:f&ya?(t=1,n=e.rightbottom):(t=e.topright,n=1);break;case 6:f&ya?(t=e.topright,n=1):(t=e.bottomright,n=0);break;case 7:f&Da?(t=e.bottomleft,n=0):(t=e.topright,n=1);break;case 8:f&ya?(t=1,n=e.righttop):(t=e.bottomright,n=0);break;case 9:f&Da?(t=e.bottomleft,n=0):(t=1,n=e.righttop);break;case 10:f&Da?(t=1,n=e.righttop):(t=0,n=e.leftbottom);break;case 11:f&Ya?(t=0,n=e.lefttop):(t=1,n=e.righttop);break;case 12:f&ya?(t=1,n=e.rightbottom):(t=e.bottomright,n=0);break;case 13:f&Da?(t=e.bottomleft,n=0):(t=1,n=e.rightbottom);break;case 14:f&Da?(t=1,n=e.rightbottom):(t=0,n=e.leftbottom);break;case 15:f&Ya?(t=0,n=e.lefttop):(t=1,n=e.rightbottom);break;case 16:f&ya?(t=0,n=e.leftbottom):(t=e.bottomright,n=0);break;case 17:f&Ya?(t=0,n=e.lefttop):(t=e.bottomright,n=0);break;case 18:f&Da?(t=e.bottomleft,n=0):(t=0,n=e.leftbottom);break;case 19:f&Ya?(t=0,n=e.lefttop):(t=e.bottomleft,n=0);break;case 20:f&Ya?(t=0,n=e.leftbottom):(t=e.topleft,n=1);break;case 21:f&lu?(t=e.topright,n=1):(t=0,n=e.leftbottom);break;case 22:f&Ya?(t=0,n=e.lefttop):(t=e.topleft,n=1);break;case 23:f&lu?(t=e.topright,n=1):(t=0,n=e.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(e),null}return(typeof t>"u"||typeof n>"u"||typeof l>"u"||typeof o>"u"||typeof p>"u")&&(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(e),console.log(t+" "+n+" "+l+" "+o+" "+p)),{p:[t,n],x:l,y:o,o:p}}function hZ(e){var t=[],n=0;return e.cells.forEach(function(r,i){r.forEach(function(a,l){if(typeof a<"u"){var o=rn[a.cval](a);typeof o=="object"&&xT(o)?typeof o[0]=="object"&&xT(o[0])?typeof o[0][0]=="object"&&xT(o[0][0])?o.forEach(function(f){f.forEach(function(p){p[0]+=l,p[1]+=i}),t[n++]=f}):(o.forEach(function(f){f[0]+=l,f[1]+=i}),t[n++]=o):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}})}),t}function fZ(e,t,n){if(n=n||{},!li(n))throw new Error("options is invalid");var r=n.zProperty||"elevation",i=n.commonProperties||{},a=n.breaksProperties||[];if(af(e,"Point","Input must contain Points"),!t)throw new Error("breaks is required");if(!Array.isArray(t))throw new Error("breaks is not an Array");if(!li(i))throw new Error("commonProperties is not an Object");if(!Array.isArray(a))throw new Error("breaksProperties is not an Array");var l=Sq(e,{zProperty:r,flip:!0}),o=dZ(l,t,r);o=pZ(o,l,e);var f=o.map(function(p,y){if(a[y]&&!li(a[y]))throw new Error("Each mappedProperty is required to be an Object");var x=XC({},i,a[y]);x[r]=p[r];var w=al(p.groupedRings,x);return w});return An(f)}function dZ(e,t,n){for(var r=[],i=1;i<t.length;i++){var a=+t[i-1],l=+t[i],o=Iq(e,a,l-a),f=gZ(o),p=mZ(f),y={};y.groupedRings=p,y[n]=a+"-"+l,r.push(y)}return r}function pZ(e,t,n){var r=ao(n),i=r[2]-r[0],a=r[3]-r[1],l=r[0],o=r[1],f=t[0].length-1,p=t.length-1,y=i/f,x=a/p,w=function(S){S[0]=S[0]*y+l,S[1]=S[1]*x+o};return e.forEach(function(S){S.groupedRings.forEach(function(L){L.forEach(function(D){D.forEach(w)})})}),e}function gZ(e){var t=[],n=[];e.forEach(function(i){var a=i2(fr([i]));n.push(a),t.push({ring:i,area:a})}),n.sort(function(i,a){return a-i});var r=[];return n.forEach(function(i){for(var a=0;a<t.length;a++)if(t[a].area===i){r.push(t[a].ring),t.splice(a,1);break}}),r}function mZ(e){for(var t=e.map(function(f){return{lrCoordinates:f,grouped:!1}}),n=[];!vZ(t);)for(var r=0;r<t.length;r++)if(!t[r].grouped){var i=[];i.push(t[r].lrCoordinates),t[r].grouped=!0;for(var a=fr([t[r].lrCoordinates]),l=r+1;l<t.length;l++)if(!t[l].grouped){var o=fr([t[l].lrCoordinates]);yZ(o,a)&&(i.push(t[l].lrCoordinates),t[l].grouped=!0)}n.push(i)}return n}function yZ(e,t){for(var n=Ew(e),r=0;r<n.features.length;r++)if(!Li(n.features[r],t))return!1;return!0}function vZ(e){for(var t=0;t<e.length;t++)if(e[t].grouped===!1)return!1;return!0}function e4(e,t,n){if(n=n||{},!li(n))throw new Error("options is invalid");var r=n.pivot,i=n.mutate;if(!e)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("angle is required");return t===0||(r||(r=od(e)),(i===!1||i===void 0)&&(e=Ua(e)),mo(e,function(a){var l=Vp(r,a),o=l+t,f=Cw(r,a),p=kn(Ym(r,f,o));a[0]=p[0],a[1]=p[1]})),e}function t4(e,t,n){if(n=n||{},!li(n))throw new Error("options is invalid");var r=n.origin,i=n.mutate;if(!e)throw new Error("geojson required");if(typeof t!="number"||t===0)throw new Error("invalid factor");var a=Array.isArray(r)||typeof r=="object";return i!==!0&&(e=Ua(e)),e.type==="FeatureCollection"&&!a?(ti(e,function(l,o){e.features[o]=yD(l,t,r)}),e):yD(e,t,r)}function yD(e,t,n){var r=Ds(e)==="Point";return n=_Z(e,n),t===1||r||mo(e,function(i){var a=Cw(n,i),l=Vp(n,i),o=a*t,f=kn(Ym(n,o,l));i[0]=f[0],i[1]=f[1],i.length===3&&(i[2]*=t)}),e}function _Z(e,t){if(t==null&&(t="centroid"),Array.isArray(t)||typeof t=="object")return Ti(t);var n=e.bbox?e.bbox:ao(e),r=n[0],i=n[1],a=n[2],l=n[3];switch(t){case"sw":case"southwest":case"westsouth":case"bottomleft":return sr([r,i]);case"se":case"southeast":case"eastsouth":case"bottomright":return sr([a,i]);case"nw":case"northwest":case"westnorth":case"topleft":return sr([r,l]);case"ne":case"northeast":case"eastnorth":case"topright":return sr([a,l]);case"center":return ww(e);case void 0:case null:case"centroid":return od(e);default:throw new Error("invalid origin")}}function xZ(e,t,n,r){if(r=r||{},!li(r))throw new Error("options is invalid");var i=r.units,a=r.zTranslation,l=r.mutate;if(!e)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("distance is required");if(a&&typeof a!="number"&&isNaN(a))throw new Error("zTranslation is not a number");if(a=a!==void 0?a:0,t===0&&a===0)return e;if(n==null||isNaN(n))throw new Error("direction is required");return t<0&&(t=-t,n=n+180),(l===!1||l===void 0)&&(e=Ua(e)),mo(e,function(o){var f=kn(Ym(o,t,n,{units:i}));o[0]=f[0],o[1]=f[1],a&&o.length===3&&(o[2]+=a)}),e}function Rb(e){var t=e[0],n=e[1];return[n[0]-t[0],n[1]-t[1]]}function _I(e,t){return e[0]*t[1]-t[0]*e[1]}function bZ(e,t){return[e[0]+t[0],e[1]+t[1]]}function wZ(e,t){return[e[0]-t[0],e[1]-t[1]]}function EZ(e,t){return[e*t[0],e*t[1]]}function SZ(e,t){var n=e[0],r=Rb(e),i=t[0],a=Rb(t),l=_I(r,a),o=wZ(i,n),f=_I(o,a),p=f/l,y=bZ(n,EZ(p,r));return y}function TZ(e,t){var n=Rb(e),r=Rb(t);return _I(n,r)===0}function IZ(e,t){return TZ(e,t)?!1:SZ(e,t)}function CZ(e,t,n){if(n=n||{},!li(n))throw new Error("options is invalid");var r=n.units;if(!e)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("distance is required");var i=Ds(e),a=e.properties;switch(i){case"LineString":return vD(e,t,r);case"MultiLineString":var l=[];return xa(e,function(o){l.push(vD(o,t,r).geometry.coordinates)}),_d(l,a);default:throw new Error("geometry "+i+" is not supported")}}function vD(e,t,n){var r=[],i=Ab(t,n),a=kn(e),l=[];return a.forEach(function(o,f){if(f!==a.length-1){var p=PZ(o,a[f+1],i);if(r.push(p),f>0){var y=r[f-1],x=IZ(p,y);x!==!1&&(y[1]=x,p[0]=x),l.push(y[0]),f===a.length-2&&(l.push(p[0]),l.push(p[1]))}a.length===2&&(l.push(p[0]),l.push(p[1]))}}),oi(l,e.properties)}function PZ(e,t,n){var r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),i=e[0]+n*(t[1]-e[1])/r,a=t[0]+n*(t[1]-e[1])/r,l=e[1]+n*(e[0]-t[0])/r,o=t[1]+n*(e[0]-t[0])/r;return[[i,l],[a,o]]}function AZ(e){return(e>0)-(e<0)||+e}function x2(e,t,n){var r=t[0]-e[0],i=t[1]-e[1],a=n[0]-t[0],l=n[1]-t[1];return AZ(r*l-a*i)}function MZ(e,t){var n=e.geometry.coordinates[0].map(function(l){return l[0]}),r=e.geometry.coordinates[0].map(function(l){return l[1]}),i=t.geometry.coordinates[0].map(function(l){return l[0]}),a=t.geometry.coordinates[0].map(function(l){return l[1]});return Math.max.apply(null,n)===Math.max.apply(null,i)&&Math.max.apply(null,r)===Math.max.apply(null,a)&&Math.min.apply(null,n)===Math.min.apply(null,i)&&Math.min.apply(null,r)===Math.min.apply(null,a)}function _D(e,t){return t.geometry.coordinates[0].every(function(n){return Li(sr(n),e)})}function LZ(e,t){return e[0]===t[0]&&e[1]===t[1]}var xD=function(){function e(t){this.id=e.buildId(t),this.coordinates=t,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return e.buildId=function(t){return t.join(",")},e.prototype.removeInnerEdge=function(t){this.innerEdges=this.innerEdges.filter(function(n){return n.from.id!==t.from.id})},e.prototype.removeOuterEdge=function(t){this.outerEdges=this.outerEdges.filter(function(n){return n.to.id!==t.to.id})},e.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1},e.prototype.sortOuterEdges=function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort(function(n,r){var i=n.to,a=r.to;if(i.coordinates[0]-t.coordinates[0]>=0&&a.coordinates[0]-t.coordinates[0]<0)return 1;if(i.coordinates[0]-t.coordinates[0]<0&&a.coordinates[0]-t.coordinates[0]>=0)return-1;if(i.coordinates[0]-t.coordinates[0]===0&&a.coordinates[0]-t.coordinates[0]===0)return i.coordinates[1]-t.coordinates[1]>=0||a.coordinates[1]-t.coordinates[1]>=0?i.coordinates[1]-a.coordinates[1]:a.coordinates[1]-i.coordinates[1];var l=x2(t.coordinates,i.coordinates,a.coordinates);if(l<0)return 1;if(l>0)return-1;var o=Math.pow(i.coordinates[0]-t.coordinates[0],2)+Math.pow(i.coordinates[1]-t.coordinates[1],2),f=Math.pow(a.coordinates[0]-t.coordinates[0],2)+Math.pow(a.coordinates[1]-t.coordinates[1],2);return o-f}),this.outerEdgesSorted=!0)},e.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},e.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]},e.prototype.addInnerEdge=function(t){this.innerEdges.push(t)},e}(),OZ=function(){function e(t,n){this.from=t,this.to=n,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return e.prototype.getSymetric=function(){return this.symetric||(this.symetric=new e(this.to,this.from),this.symetric.symetric=this),this.symetric},e.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},e.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id},e.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},e.prototype.toLineString=function(){return oi([this.from.coordinates,this.to.coordinates])},e.prototype.compareTo=function(t){return x2(t.from.coordinates,t.to.coordinates,this.to.coordinates)},e}(),DZ=function(){function e(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return e.prototype.push=function(t){this.edges.push(t),this.polygon=this.envelope=void 0},e.prototype.get=function(t){return this.edges[t]},Object.defineProperty(e.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),e.prototype.forEach=function(t){this.edges.forEach(t)},e.prototype.map=function(t){return this.edges.map(t)},e.prototype.some=function(t){return this.edges.some(t)},e.prototype.isValid=function(){return!0},e.prototype.isHole=function(){var t=this,n=this.edges.reduce(function(l,o,f){return o.from.coordinates[1]>t.edges[l].from.coordinates[1]&&(l=f),l},0),r=(n===0?this.length:n)-1,i=(n+1)%this.length,a=x2(this.edges[r].from.coordinates,this.edges[n].from.coordinates,this.edges[i].from.coordinates);return a===0?this.edges[r].from.coordinates[0]>this.edges[i].from.coordinates[0]:a>0},e.prototype.toMultiPoint=function(){return G0(this.edges.map(function(t){return t.from.coordinates}))},e.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map(function(n){return n.from.coordinates});return t.push(this.edges[0].from.coordinates),this.polygon=fr([t])},e.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=aN(this.toPolygon())},e.findEdgeRingContaining=function(t,n){var r=t.getEnvelope(),i,a;return n.forEach(function(l){var o=l.getEnvelope();if(a&&(i=a.getEnvelope()),!MZ(o,r)&&_D(o,r)){for(var f=t.map(function(L){return L.from.coordinates}),p=void 0,y=function(L){l.some(function(D){return LZ(L,D.from.coordinates)})||(p=L)},x=0,w=f;x<w.length;x++){var S=w[x];y(S)}p&&l.inside(sr(p))&&(!a||_D(i,o))&&(a=l)}}),a},e.prototype.inside=function(t){return Li(t,this.toPolygon())},e}();const n4=DZ;function RZ(e){if(!e)throw new Error("No geojson passed");if(e.type!=="FeatureCollection"&&e.type!=="GeometryCollection"&&e.type!=="MultiLineString"&&e.type!=="LineString"&&e.type!=="Feature")throw new Error("Invalid input type '"+e.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}var kZ=function(){function e(){this.edges=[],this.nodes={}}return e.fromGeoJson=function(t){RZ(t);var n=new e;return xa(t,function(r){a0(r,"LineString","Graph::fromGeoJson"),zC(r,function(i,a){if(i){var l=n.getNode(i),o=n.getNode(a);n.addEdge(l,o)}return a})}),n},e.prototype.getNode=function(t){var n=xD.buildId(t),r=this.nodes[n];return r||(r=this.nodes[n]=new xD(t)),r},e.prototype.addEdge=function(t,n){var r=new OZ(t,n),i=r.getSymetric();this.edges.push(r),this.edges.push(i)},e.prototype.deleteDangles=function(){var t=this;Object.keys(this.nodes).map(function(n){return t.nodes[n]}).forEach(function(n){return t._removeIfDangle(n)})},e.prototype._removeIfDangle=function(t){var n=this;if(t.innerEdges.length<=1){var r=t.getOuterEdges().map(function(i){return i.to});this.removeNode(t),r.forEach(function(i){return n._removeIfDangle(i)})}},e.prototype.deleteCutEdges=function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(n){n.label===n.symetric.label&&(t.removeEdge(n.symetric),t.removeEdge(n))})},e.prototype._computeNextCWEdges=function(t){var n=this;typeof t>"u"?Object.keys(this.nodes).forEach(function(r){return n._computeNextCWEdges(n.nodes[r])}):t.getOuterEdges().forEach(function(r,i){t.getOuterEdge((i===0?t.getOuterEdges().length:i)-1).symetric.next=r})},e.prototype._computeNextCCWEdges=function(t,n){for(var r=t.getOuterEdges(),i,a,l=r.length-1;l>=0;--l){var o=r[l],f=o.symetric,p=void 0,y=void 0;o.label===n&&(p=o),f.label===n&&(y=f),!(!p||!y)&&(y&&(a=y),p&&(a&&(a.next=p,a=void 0),i||(i=p)))}a&&(a.next=i)},e.prototype._findLabeledEdgeRings=function(){var t=[],n=0;return this.edges.forEach(function(r){if(!(r.label>=0)){t.push(r);var i=r;do i.label=n,i=i.next;while(!r.isEqual(i));n++}}),t},e.prototype.getEdgeRings=function(){var t=this;this._computeNextCWEdges(),this.edges.forEach(function(r){r.label=void 0}),this._findLabeledEdgeRings().forEach(function(r){t._findIntersectionNodes(r).forEach(function(i){t._computeNextCCWEdges(i,r.label)})});var n=[];return this.edges.forEach(function(r){r.ring||n.push(t._findEdgeRing(r))}),n},e.prototype._findIntersectionNodes=function(t){var n=[],r=t,i=function(){var a=0;r.from.getOuterEdges().forEach(function(l){l.label===t.label&&++a}),a>1&&n.push(r.from),r=r.next};do i();while(!t.isEqual(r));return n},e.prototype._findEdgeRing=function(t){var n=t,r=new n4;do r.push(n),n.ring=r,n=n.next;while(!t.isEqual(n));return r},e.prototype.removeNode=function(t){var n=this;t.getOuterEdges().forEach(function(r){return n.removeEdge(r)}),t.innerEdges.forEach(function(r){return n.removeEdge(r)}),delete this.nodes[t.id]},e.prototype.removeEdge=function(t){this.edges=this.edges.filter(function(n){return!n.isEqual(t)}),t.deleteEdge()},e}();const NZ=kZ;function FZ(e){var t=NZ.fromGeoJson(e);t.deleteDangles(),t.deleteCutEdges();var n=[],r=[];return t.getEdgeRings().filter(function(i){return i.isValid()}).forEach(function(i){i.isHole()?n.push(i):r.push(i)}),n.forEach(function(i){n4.findEdgeRingContaining(i,r)&&r.push(i)}),An(r.map(function(i){return i.toPolygon()}))}function r4(e,t){var n=!0;return xa(e,function(r){xa(t,function(i){if(n===!1)return!1;n=BZ(r.geometry,i.geometry)})}),n}function BZ(e,t){switch(e.type){case"Point":switch(t.type){case"Point":return!GZ(e.coordinates,t.coordinates);case"LineString":return!bD(t,e);case"Polygon":return!Li(e,t)}break;case"LineString":switch(t.type){case"Point":return!bD(e,t);case"LineString":return!zZ(e,t);case"Polygon":return!wD(t,e)}break;case"Polygon":switch(t.type){case"Point":return!Li(t,e);case"LineString":return!wD(e,t);case"Polygon":return!UZ(t,e)}}return!1}function bD(e,t){for(var n=0;n<e.coordinates.length-1;n++)if(VZ(e.coordinates[n],e.coordinates[n+1],t.coordinates))return!0;return!1}function zZ(e,t){var n=sf(e,t);return n.features.length>0}function wD(e,t){for(var n=0,r=t.coordinates;n<r.length;n++){var i=r[n];if(Li(i,e))return!0}var a=sf(t,f0(e));return a.features.length>0}function UZ(e,t){for(var n=0,r=e.coordinates[0];n<r.length;n++){var i=r[n];if(Li(i,t))return!0}for(var a=0,l=t.coordinates[0];a<l.length;a++){var o=l[a];if(Li(o,e))return!0}var f=sf(f0(e),f0(t));return f.features.length>0}function VZ(e,t,n){var r=n[0]-e[0],i=n[1]-e[1],a=t[0]-e[0],l=t[1]-e[1],o=r*l-i*a;return o!==0?!1:Math.abs(a)>=Math.abs(l)?a>0?e[0]<=n[0]&&n[0]<=t[0]:t[0]<=n[0]&&n[0]<=e[0]:l>0?e[1]<=n[1]&&n[1]<=t[1]:t[1]<=n[1]&&n[1]<=e[1]}function GZ(e,t){return e[0]===t[0]&&e[1]===t[1]}function $Z(e,t){var n=Oi(e),r=Oi(t),i=n.type,a=r.type,l=n.coordinates,o=r.coordinates;switch(i){case"Point":switch(a){case"Point":return b2(l,o);default:throw new Error("feature2 "+a+" geometry not supported")}case"MultiPoint":switch(a){case"Point":return jZ(n,r);case"MultiPoint":return qZ(n,r);default:throw new Error("feature2 "+a+" geometry not supported")}case"LineString":switch(a){case"Point":return el(r,n,{ignoreEndVertices:!0});case"LineString":return WZ(n,r);case"MultiPoint":return ZZ(n,r);default:throw new Error("feature2 "+a+" geometry not supported")}case"Polygon":switch(a){case"Point":return Li(r,n,{ignoreBoundary:!0});case"LineString":return HZ(n,r);case"Polygon":return YZ(n,r);case"MultiPoint":return XZ(n,r);default:throw new Error("feature2 "+a+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}function jZ(e,t){var n,r=!1;for(n=0;n<e.coordinates.length;n++)if(b2(e.coordinates[n],t.coordinates)){r=!0;break}return r}function qZ(e,t){for(var n=0,r=t.coordinates;n<r.length;n++){for(var i=r[n],a=!1,l=0,o=e.coordinates;l<o.length;l++){var f=o[l];if(b2(i,f)){a=!0;break}}if(!a)return!1}return!0}function ZZ(e,t){for(var n=!1,r=0,i=t.coordinates;r<i.length;r++){var a=i[r];if(el(a,e,{ignoreEndVertices:!0})&&(n=!0),!el(a,e))return!1}return!!n}function XZ(e,t){for(var n=0,r=t.coordinates;n<r.length;n++){var i=r[n];if(!Li(i,e,{ignoreBoundary:!0}))return!1}return!0}function WZ(e,t){for(var n=!1,r=0,i=t.coordinates;r<i.length;r++){var a=i[r];if(el({type:"Point",coordinates:a},e,{ignoreEndVertices:!0})&&(n=!0),!el({type:"Point",coordinates:a},e,{ignoreEndVertices:!1}))return!1}return n}function HZ(e,t){var n=!1,r=0,i=ao(e),a=ao(t);if(!i4(i,a))return!1;for(r;r<t.coordinates.length-1;r++){var l=KZ(t.coordinates[r],t.coordinates[r+1]);if(Li({type:"Point",coordinates:l},e,{ignoreBoundary:!0})){n=!0;break}}return n}function YZ(e,t){if(e.type==="Feature"&&e.geometry===null||t.type==="Feature"&&t.geometry===null)return!1;var n=ao(e),r=ao(t);if(!i4(n,r))return!1;for(var i=Oi(t).coordinates,a=0,l=i;a<l.length;a++)for(var o=l[a],f=0,p=o;f<p.length;f++){var y=p[f];if(!Li(y,e))return!1}return!0}function i4(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}function b2(e,t){return e[0]===t[0]&&e[1]===t[1]}function KZ(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}function JZ(e,t){var n=Oi(e),r=Oi(t),i=n.type,a=r.type;switch(i){case"MultiPoint":switch(a){case"LineString":return ED(n,r);case"Polygon":return TD(n,r);default:throw new Error("feature2 "+a+" geometry not supported")}case"LineString":switch(a){case"MultiPoint":return ED(r,n);case"LineString":return QZ(n,r);case"Polygon":return SD(n,r);default:throw new Error("feature2 "+a+" geometry not supported")}case"Polygon":switch(a){case"MultiPoint":return TD(r,n);case"LineString":return SD(r,n);default:throw new Error("feature2 "+a+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}function ED(e,t){for(var n=!1,r=!1,i=e.coordinates.length,a=0;a<i&&!n&&!r;){for(var l=0;l<t.coordinates.length-1;l++){var o=!0;(l===0||l===t.coordinates.length-2)&&(o=!1),o4(t.coordinates[l],t.coordinates[l+1],e.coordinates[a],o)?n=!0:r=!0}a++}return n&&r}function QZ(e,t){var n=sf(e,t);if(n.features.length>0)for(var r=0;r<e.coordinates.length-1;r++)for(var i=0;i<t.coordinates.length-1;i++){var a=!0;if((i===0||i===t.coordinates.length-2)&&(a=!1),o4(e.coordinates[r],e.coordinates[r+1],t.coordinates[i],a))return!0}return!1}function SD(e,t){var n=IN(t),r=sf(e,n);return r.features.length>0}function TD(e,t){for(var n=!1,r=!1,i=e.coordinates.length,a=0;a<i&&(!n||!r);a++)Li(sr(e.coordinates[a]),t)?n=!0:r=!0;return r&&n}function o4(e,t,n,r){var i=n[0]-e[0],a=n[1]-e[1],l=t[0]-e[0],o=t[1]-e[1],f=i*o-a*l;return f!==0?!1:r?Math.abs(l)>=Math.abs(o)?l>0?e[0]<=n[0]&&n[0]<=t[0]:t[0]<=n[0]&&n[0]<=e[0]:o>0?e[1]<=n[1]&&n[1]<=t[1]:t[1]<=n[1]&&n[1]<=e[1]:Math.abs(l)>=Math.abs(o)?l>0?e[0]<n[0]&&n[0]<t[0]:t[0]<n[0]&&n[0]<e[0]:o>0?e[1]<n[1]&&n[1]<t[1]:t[1]<n[1]&&n[1]<e[1]}var eX=JN,uh=function(e){this.precision=e&&e.precision?e.precision:17,this.direction=e&&e.direction?e.direction:!1,this.pseudoNode=e&&e.pseudoNode?e.pseudoNode:!1,this.objectComparator=e&&e.objectComparator?e.objectComparator:tX};uh.prototype.compare=function(e,t){if(e.type!==t.type||!a4(e,t))return!1;switch(e.type){case"Point":return this.compareCoord(e.coordinates,t.coordinates);case"LineString":return this.compareLine(e.coordinates,t.coordinates,0,!1);case"Polygon":return this.comparePolygon(e,t);case"Feature":return this.compareFeature(e,t);default:if(e.type.indexOf("Multi")===0){var n=this,r=ID(e),i=ID(t);return r.every(function(a){return this.some(function(l){return n.compare(a,l)})},i)}}return!1};function ID(e){return e.coordinates.map(function(t){return{type:e.type.replace("Multi",""),coordinates:t}})}function a4(e,t){return e.hasOwnProperty("coordinates")?e.coordinates.length===t.coordinates.length:e.length===t.length}uh.prototype.compareCoord=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n].toFixed(this.precision)!==t[n].toFixed(this.precision))return!1;return!0};uh.prototype.compareLine=function(e,t,n,r){if(!a4(e,t))return!1;var i=this.pseudoNode?e:this.removePseudo(e),a=this.pseudoNode?t:this.removePseudo(t);if(!(r&&!this.compareCoord(i[0],a[0])&&(a=this.fixStartIndex(a,i),!a))){var l=this.compareCoord(i[n],a[n]);return this.direction||l?this.comparePath(i,a):this.compareCoord(i[n],a[a.length-(1+n)])?this.comparePath(i.slice().reverse(),a):!1}};uh.prototype.fixStartIndex=function(e,t){for(var n,r=-1,i=0;i<e.length;i++)if(this.compareCoord(e[i],t[0])){r=i;break}return r>=0&&(n=[].concat(e.slice(r,e.length),e.slice(1,r+1))),n};uh.prototype.comparePath=function(e,t){var n=this;return e.every(function(r,i){return n.compareCoord(r,this[i])},t)};uh.prototype.comparePolygon=function(e,t){if(this.compareLine(e.coordinates[0],t.coordinates[0],1,!0)){var n=e.coordinates.slice(1,e.coordinates.length),r=t.coordinates.slice(1,t.coordinates.length),i=this;return n.every(function(a){return this.some(function(l){return i.compareLine(a,l,1,!0)})},r)}else return!1};uh.prototype.compareFeature=function(e,t){return e.id!==t.id||!this.objectComparator(e.properties,t.properties)||!this.compareBBox(e,t)?!1:this.compare(e.geometry,t.geometry)};uh.prototype.compareBBox=function(e,t){return!!(!e.bbox&&!t.bbox||e.bbox&&t.bbox&&this.compareCoord(e.bbox,t.bbox))};uh.prototype.removePseudo=function(e){return e};function tX(e,t){return eX(e,t,{strict:!0})}var nX=uh;const s4=Vs(nX);function rX(e,t){var n=Oi(e),r=Oi(t),i=n.type,a=r.type;if(i==="MultiPoint"&&a!=="MultiPoint"||(i==="LineString"||i==="MultiLineString")&&a!=="LineString"&&a!=="MultiLineString"||(i==="Polygon"||i==="MultiPolygon")&&a!=="Polygon"&&a!=="MultiPolygon")throw new Error("features must be of the same type");if(i==="Point")throw new Error("Point geometry not supported");var l=new s4({precision:6});if(l.compare(e,t))return!1;var o=0;switch(i){case"MultiPoint":for(var f=0;f<n.coordinates.length;f++)for(var p=0;p<r.coordinates.length;p++){var y=n.coordinates[f],x=r.coordinates[p];if(y[0]===x[0]&&y[1]===x[1])return!0}return!1;case"LineString":case"MultiLineString":Rh(e,function(w){Rh(t,function(S){QN(w,S).features.length&&o++})});break;case"Polygon":case"MultiPolygon":Rh(e,function(w){Rh(t,function(S){sf(w,S).features.length&&o++})});break}return o>0}function iX(e,t){var n=Oi(e).type,r=Oi(t).type;if(n!==r)return!1;var i=new s4({precision:6});return i.compare(Bp(e),Bp(t))}function l4(e,t){var n=!1;return xa(e,function(r){xa(t,function(i){if(n===!0)return!0;n=!r4(r.geometry,i.geometry)})}),n}var u4={exports:{}},bT={exports:{}},CD;function oX(){return CD||(CD=1,function(e){function t(n,r,i,a){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(n,r,i,a)}t.prototype.run=function(n,r,i,a){this._init(n,r,i,a);for(var l=0;l<this._datasetLength;l++)if(this._visited[l]!==1){this._visited[l]=1;var o=this._regionQuery(l);if(o.length<this.minPts)this.noise.push(l);else{var f=this.clusters.length;this.clusters.push([]),this._addToCluster(l,f),this._expandCluster(f,o)}}return this.clusters},t.prototype._init=function(n,r,i,a){if(n){if(!(n instanceof Array))throw Error("Dataset must be of type array, "+typeof n+" given");this.dataset=n,this.clusters=[],this.noise=[],this._datasetLength=n.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}r&&(this.epsilon=r),i&&(this.minPts=i),a&&(this.distance=a)},t.prototype._expandCluster=function(n,r){for(var i=0;i<r.length;i++){var a=r[i];if(this._visited[a]!==1){this._visited[a]=1;var l=this._regionQuery(a);l.length>=this.minPts&&(r=this._mergeArrays(r,l))}this._assigned[a]!==1&&this._addToCluster(a,n)}},t.prototype._addToCluster=function(n,r){this.clusters[r].push(n),this._assigned[n]=1},t.prototype._regionQuery=function(n){for(var r=[],i=0;i<this._datasetLength;i++){var a=this.distance(this.dataset[n],this.dataset[i]);a<this.epsilon&&r.push(i)}return r},t.prototype._mergeArrays=function(n,r){for(var i=r.length,a=0;a<i;a++){var l=r[a];n.indexOf(l)<0&&n.push(l)}return n},t.prototype._euclideanDistance=function(n,r){for(var i=0,a=Math.min(n.length,r.length);a--;)i+=(n[a]-r[a])*(n[a]-r[a]);return Math.sqrt(i)},e.exports&&(e.exports=t)}(bT)),bT.exports}var wT={exports:{}},PD;function aX(){return PD||(PD=1,function(e){function t(n,r,i){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(n,r,i)}t.prototype.init=function(n,r,i){this.assignments=[],this.centroids=[],typeof n<"u"&&(this.dataset=n),typeof r<"u"&&(this.k=r),typeof i<"u"&&(this.distance=i)},t.prototype.run=function(n,r){this.init(n,r);for(var i=this.dataset.length,a=0;a<this.k;a++)this.centroids[a]=this.randomCentroid();for(var l=!0;l;){l=this.assign();for(var o=0;o<this.k;o++){for(var f=new Array(w),p=0,y=0;y<w;y++)f[y]=0;for(var x=0;x<i;x++){var w=this.dataset[x].length;if(o===this.assignments[x]){for(var y=0;y<w;y++)f[y]+=this.dataset[x][y];p++}}if(p>0){for(var y=0;y<w;y++)f[y]/=p;this.centroids[o]=f}else this.centroids[o]=this.randomCentroid(),l=!0}}return this.getClusters()},t.prototype.randomCentroid=function(){var n=this.dataset.length-1,r,i;do i=Math.round(Math.random()*n),r=this.dataset[i];while(this.centroids.indexOf(r)>=0);return r},t.prototype.assign=function(){for(var n=!1,r=this.dataset.length,i,a=0;a<r;a++)i=this.argmin(this.dataset[a],this.centroids,this.distance),i!=this.assignments[a]&&(this.assignments[a]=i,n=!0);return n},t.prototype.getClusters=function(){for(var n=new Array(this.k),r,i=0;i<this.assignments.length;i++)r=this.assignments[i],typeof n[r]>"u"&&(n[r]=[]),n[r].push(i);return n},t.prototype.argmin=function(n,r,i){for(var a=Number.MAX_VALUE,l=0,o=r.length,f,p=0;p<o;p++)f=i(n,r[p]),f<a&&(a=f,l=p);return l},t.prototype.distance=function(n,r){for(var i=0,a=Math.min(n.length,r.length);a--;){var l=n[a]-r[a];i+=l*l}return Math.sqrt(i)},e.exports&&(e.exports=t)}(wT)),wT.exports}var ET={exports:{}},ST={exports:{}},AD;function c4(){return AD||(AD=1,function(e){function t(n,r,i){this._queue=[],this._priorities=[],this._sorting="desc",this._init(n,r,i)}t.prototype.insert=function(n,r){for(var i=this._queue.length,a=i;a--;){var l=this._priorities[a];this._sorting==="desc"?r>l&&(i=a):r<l&&(i=a)}this._insertAt(n,r,i)},t.prototype.remove=function(n){for(var r=this._queue.length;r--;){var i=this._queue[r];if(n===i){this._queue.splice(r,1),this._priorities.splice(r,1);break}}},t.prototype.forEach=function(n){this._queue.forEach(n)},t.prototype.getElements=function(){return this._queue},t.prototype.getElementPriority=function(n){return this._priorities[n]},t.prototype.getPriorities=function(){return this._priorities},t.prototype.getElementsWithPriorities=function(){for(var n=[],r=0,i=this._queue.length;r<i;r++)n.push([this._queue[r],this._priorities[r]]);return n},t.prototype._init=function(n,r,i){if(n&&r){if(this._queue=[],this._priorities=[],n.length!==r.length)throw new Error("Arrays must have the same length");for(var a=0;a<n.length;a++)this.insert(n[a],r[a])}i&&(this._sorting=i)},t.prototype._insertAt=function(n,r,i){this._queue.length===i?(this._queue.push(n),this._priorities.push(r)):(this._queue.splice(i,0,n),this._priorities.splice(i,0,r))},e.exports&&(e.exports=t)}(ST)),ST.exports}var MD;function sX(){return MD||(MD=1,function(e){if(e.exports)var t=c4();function n(r,i,a,l){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(r,i,a,l)}n.prototype.run=function(r,i,a,l){this._init(r,i,a,l);for(var o=0,f=this.dataset.length;o<f;o++)if(this._processed[o]!==1){this._processed[o]=1,this.clusters.push([o]);var p=this.clusters.length-1;this._orderedList.push(o);var y=new t(null,null,"asc"),x=this._regionQuery(o);this._distanceToCore(o)!==void 0&&(this._updateQueue(o,x,y),this._expandCluster(p,y))}return this.clusters},n.prototype.getReachabilityPlot=function(){for(var r=[],i=0,a=this._orderedList.length;i<a;i++){var l=this._orderedList[i],o=this._reachability[l];r.push([l,o])}return r},n.prototype._init=function(r,i,a,l){if(r){if(!(r instanceof Array))throw Error("Dataset must be of type array, "+typeof r+" given");this.dataset=r,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}i&&(this.epsilon=i),a&&(this.minPts=a),l&&(this.distance=l)},n.prototype._updateQueue=function(r,i,a){var l=this;this._coreDistance=this._distanceToCore(r),i.forEach(function(o){if(l._processed[o]===void 0){var f=l.distance(l.dataset[r],l.dataset[o]),p=Math.max(l._coreDistance,f);l._reachability[o]===void 0?(l._reachability[o]=p,a.insert(o,p)):p<l._reachability[o]&&(l._reachability[o]=p,a.remove(o),a.insert(o,p))}})},n.prototype._expandCluster=function(r,i){for(var a=i.getElements(),l=0,o=a.length;l<o;l++){var f=a[l];if(this._processed[f]===void 0){var p=this._regionQuery(f);this._processed[f]=1,this.clusters[r].push(f),this._orderedList.push(f),this._distanceToCore(f)!==void 0&&(this._updateQueue(f,p,i),this._expandCluster(r,i))}}},n.prototype._distanceToCore=function(r){for(var i=this.epsilon,a=0;a<i;a++){var l=this._regionQuery(r,a);if(l.length>=this.minPts)return a}},n.prototype._regionQuery=function(r,i){i=i||this.epsilon;for(var a=[],l=0,o=this.dataset.length;l<o;l++)this.distance(this.dataset[r],this.dataset[l])<i&&a.push(l);return a},n.prototype._euclideanDistance=function(r,i){for(var a=0,l=Math.min(r.length,i.length);l--;)a+=(r[l]-i[l])*(r[l]-i[l]);return Math.sqrt(a)},e.exports&&(e.exports=n)}(ET)),ET.exports}(function(e){e.exports&&(e.exports={DBSCAN:oX(),KMEANS:aX(),OPTICS:sX(),PriorityQueue:c4()})})(u4);var lX=u4.exports;const uX=Vs(lX);function cX(e,t,n){n===void 0&&(n={}),n.mutate!==!0&&(e=Ua(e)),n.minPoints=n.minPoints||3;var r=new uX.DBSCAN,i=r.run(Wm(e),Fp(t,n.units),n.minPoints,ei),a=-1;return i.forEach(function(l){a++,l.forEach(function(o){var f=e.features[o];f.properties||(f.properties={}),f.properties.cluster=a,f.properties.dbscan="core"})}),r.noise.forEach(function(l){var o=e.features[l];o.properties||(o.properties={}),o.properties.cluster?o.properties.dbscan="edge":o.properties.dbscan="noise"}),e}var h4={eudist:function(t,n,r){for(var i=t.length,a=0,l=0;l<i;l++){var o=(t[l]||0)-(n[l]||0);a+=o*o}return r?Math.sqrt(a):a},mandist:function(t,n,r){for(var i=t.length,a=0,l=0;l<i;l++)a+=Math.abs((t[l]||0)-(n[l]||0));return r?Math.sqrt(a):a},dist:function(t,n,r){var i=Math.abs(t-n);return r?i:i*i}},f4=h4,hX=f4.eudist,fX=f4.dist,dX={kmrand:function(t,n){for(var r={},i=[],a=n<<2,l=t.length,o=t[0].length>0;i.length<n&&a-- >0;){var f=t[Math.floor(Math.random()*l)],p=o?f.join("_"):""+f;r[p]||(r[p]=!0,i.push(f))}if(i.length<n)throw new Error("Error initializating clusters");return i},kmpp:function(t,n){var r=t[0].length?hX:fX,i=[],a=t.length,l=t[0].length>0,o=t[Math.floor(Math.random()*a)];for(l?o.join("_"):""+o,i.push(o);i.length<n;){for(var f=[],p=i.length,y=0,x=[],w=0;w<a;w++){for(var S=1/0,L=0;L<p;L++){var D=r(t[w],i[L]);D<=S&&(S=D)}f[w]=S}for(var B=0;B<a;B++)y+=f[B];for(var z=0;z<a;z++)x[z]={i:z,v:t[z],pr:f[z]/y,cs:0};x.sort(function(q,Y){return q.pr-Y.pr}),x[0].cs=x[0].pr;for(var M=1;M<a;M++)x[M].cs=x[M-1].cs+x[M].pr;for(var k=Math.random(),V=0;V<a-1&&x[V++].cs<k;);i.push(x[V-1].v)}return i}},w2=h4,d4=dX,pX=w2.eudist;w2.mandist;w2.dist;var gX=d4.kmrand,mX=d4.kmpp,LD=1e4;function OD(e,t,n){n=n||[];for(var r=0;r<e;r++)n[r]=t;return n}function yX(e,t,n,r){var i=[],a=[],l=[],o=[],f=!1,p=r||LD,y=e.length,x=e[0].length,w=x>0,S=[];if(n)n=="kmrand"?i=gX(e,t):n=="kmpp"?i=mX(e,t):i=n;else for(var L={};i.length<t;){var D=Math.floor(Math.random()*y);L[D]||(L[D]=!0,i.push(e[D]))}do{OD(t,0,S);for(var B=0;B<y;B++){for(var z=1/0,M=0,k=0;k<t;k++){var o=w?pX(e[B],i[k]):Math.abs(e[B]-i[k]);o<=z&&(z=o,M=k)}l[B]=M,S[M]++}for(var V=[],a=[],q=0;q<t;q++)V[q]=w?OD(x,0,V[q]):0,a[q]=i[q];if(w){for(var Y=0;Y<t;Y++)i[Y]=[];for(var K=0;K<y;K++)for(var X=l[K],U=V[X],le=e[K],ue=0;ue<x;ue++)U[ue]+=le[ue];f=!0;for(var ae=0;ae<t;ae++){for(var ve=i[ae],Ee=V[ae],He=a[ae],Oe=S[ae],Ve=0;Ve<x;Ve++)ve[Ve]=Ee[Ve]/Oe||0;if(f){for(var Pe=0;Pe<x;Pe++)if(He[Pe]!=ve[Pe]){f=!1;break}}}}else{for(var Ke=0;Ke<y;Ke++){var Be=l[Ke];V[Be]+=e[Ke]}for(var Ue=0;Ue<t;Ue++)i[Ue]=V[Ue]/S[Ue]||0;f=!0;for(var lt=0;lt<t;lt++)if(a[lt]!=i[lt]){f=!1;break}}f=f||--p<=0}while(!f);return{it:LD-p,k:t,idxs:l,centroids:i}}var vX=yX;const _X=Vs(vX);function xX(e,t){t===void 0&&(t={});var n=e.features.length;t.numberOfClusters=t.numberOfClusters||Math.round(Math.sqrt(n/2)),t.numberOfClusters>n&&(t.numberOfClusters=n),t.mutate!==!0&&(e=Ua(e));var r=Wm(e),i=r.slice(0,t.numberOfClusters),a=_X(r,t.numberOfClusters,i),l={};return a.centroids.forEach(function(o,f){l[f]=o}),ti(e,function(o,f){var p=a.idxs[f];o.properties.cluster=p,o.properties.centroid=l[p]}),e}function bX(e,t){if(!e)throw new Error("line1 is required");if(!t)throw new Error("line2 is required");var n=DD(e,"line1");if(n!=="LineString")throw new Error("line1 must be a LineString");var r=DD(t,"line2");if(r!=="LineString")throw new Error("line2 must be a LineString");for(var i=Up(Bp(e)).features,a=Up(Bp(t)).features,l=0;l<i.length;l++){var o=i[l].geometry.coordinates;if(!a[l])break;var f=a[l].geometry.coordinates;if(!wX(o,f))return!1}return!0}function wX(e,t){var n=Np(Vp(e[0],e[1])),r=Np(Vp(t[0],t[1]));return n===r}function DD(e,t){if(e.geometry&&e.geometry.type)return e.geometry.type;if(e.type)return e.type;throw new Error("Invalid GeoJSON object for "+t)}function RD(e){for(var t=e,n=[];t.parent;)n.unshift(t),t=t.parent;return n}function EX(){return new p4(function(e){return e.f})}var Aw={search:function(e,t,n,r){e.cleanDirty(),r=r||{};var i=r.heuristic||Aw.heuristics.manhattan,a=r.closest||!1,l=EX(),o=t;for(t.h=i(t,n),l.push(t);l.size()>0;){var f=l.pop();if(f===n)return RD(f);f.closed=!0;for(var p=e.neighbors(f),y=0,x=p.length;y<x;++y){var w=p[y];if(!(w.closed||w.isWall())){var S=f.g+w.getCost(f),L=w.visited;(!L||S<w.g)&&(w.visited=!0,w.parent=f,w.h=w.h||i(w,n),w.g=S,w.f=w.g+w.h,e.markDirty(w),a&&(w.h<o.h||w.h===o.h&&w.g<o.g)&&(o=w),L?l.rescoreElement(w):l.push(w))}}}return a?RD(o):[]},heuristics:{manhattan:function(e,t){var n=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return n+r},diagonal:function(e,t){var n=1,r=Math.sqrt(2),i=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);return n*(i+a)+(r-2*n)*Math.min(i,a)}},cleanNode:function(e){e.f=0,e.g=0,e.h=0,e.visited=!1,e.closed=!1,e.parent=null}};function Ty(e,t){t=t||{},this.nodes=[],this.diagonal=!!t.diagonal,this.grid=[];for(var n=0;n<e.length;n++){this.grid[n]=[];for(var r=0,i=e[n];r<i.length;r++){var a=new Mw(n,r,i[r]);this.grid[n][r]=a,this.nodes.push(a)}}this.init()}Ty.prototype.init=function(){this.dirtyNodes=[];for(var e=0;e<this.nodes.length;e++)Aw.cleanNode(this.nodes[e])};Ty.prototype.cleanDirty=function(){for(var e=0;e<this.dirtyNodes.length;e++)Aw.cleanNode(this.dirtyNodes[e]);this.dirtyNodes=[]};Ty.prototype.markDirty=function(e){this.dirtyNodes.push(e)};Ty.prototype.neighbors=function(e){var t=[],n=e.x,r=e.y,i=this.grid;return i[n-1]&&i[n-1][r]&&t.push(i[n-1][r]),i[n+1]&&i[n+1][r]&&t.push(i[n+1][r]),i[n]&&i[n][r-1]&&t.push(i[n][r-1]),i[n]&&i[n][r+1]&&t.push(i[n][r+1]),this.diagonal&&(i[n-1]&&i[n-1][r-1]&&t.push(i[n-1][r-1]),i[n+1]&&i[n+1][r-1]&&t.push(i[n+1][r-1]),i[n-1]&&i[n-1][r+1]&&t.push(i[n-1][r+1]),i[n+1]&&i[n+1][r+1]&&t.push(i[n+1][r+1])),t};Ty.prototype.toString=function(){for(var e=[],t=this.grid,n,r,i,a,l=0,o=t.length;l<o;l++){for(n=[],r=t[l],i=0,a=r.length;i<a;i++)n.push(r[i].weight);e.push(n.join(" "))}return e.join(`
`)};function Mw(e,t,n){this.x=e,this.y=t,this.weight=n}Mw.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};Mw.prototype.getCost=function(e){return e&&e.x!==this.x&&e.y!==this.y?this.weight*1.41421:this.weight};Mw.prototype.isWall=function(){return this.weight===0};function p4(e){this.content=[],this.scoreFunction=e}p4.prototype={push:function(e){this.content.push(e),this.sinkDown(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e},remove:function(e){var t=this.content.indexOf(e),n=this.content.pop();t!==this.content.length-1&&(this.content[t]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))},size:function(){return this.content.length},rescoreElement:function(e){this.sinkDown(this.content.indexOf(e))},sinkDown:function(e){for(var t=this.content[e];e>0;){var n=(e+1>>1)-1,r=this.content[n];if(this.scoreFunction(t)<this.scoreFunction(r))this.content[n]=t,this.content[e]=r,e=n;else break}},bubbleUp:function(e){for(var t=this.content.length,n=this.content[e],r=this.scoreFunction(n);;){var i=e+1<<1,a=i-1,l=null,o;if(a<t){var f=this.content[a];o=this.scoreFunction(f),o<r&&(l=a)}if(i<t){var p=this.content[i],y=this.scoreFunction(p);y<(l===null?r:o)&&(l=i)}if(l!==null)this.content[e]=this.content[l],this.content[l]=n,e=l;else break}}};function SX(e,t,n){if(n=n||{},!li(n))throw new Error("options is invalid");var r=n.resolution,i=n.minDistance,a=n.obstacles||An([]);if(!e)throw new Error("start is required");if(!t)throw new Error("end is required");if(r&&!sa(r)||r<=0)throw new Error("options.resolution must be a number, greater than 0");if(i)throw new Error("options.minDistance is not yet implemented");var l=Ti(e),o=Ti(t);switch(e=sr(l),t=sr(o),Ds(a)){case"FeatureCollection":if(a.features.length===0)return oi([l,o]);break;case"Polygon":a=An([$o(Oi(a))]);break;default:throw new Error("invalid obstacles")}var f=a;f.features.push(e),f.features.push(t);var p=ao(t4(e2(ao(f)),1.15));if(!r){var y=ei([p[0],p[1]],[p[2],p[1]],n);r=y/100}f.features.pop(),f.features.pop();for(var x=p[0],w=p[1],S=p[2],L=p[3],D=r/ei([x,w],[S,w],n),B=D*(S-x),z=r/ei([x,w],[x,L],n),M=z*(L-w),k=S-x,V=L-w,q=Math.floor(k/B),Y=Math.floor(V/M),K=(k-q*B)/2,X=(V-Y*M)/2,U=[],le=[],ue=[],ae=[],ve=1/0,Ee=1/0,He=L-X,Oe=0;He>=w;){for(var Ve=[],Pe=[],Ke=x+K,Be=0;Ke<=S;){var Ue=sr([Ke,He]),lt=TX(Ue,a);Ve.push(lt?0:1),Pe.push(Ke+"|"+He);var xt=ei(Ue,e);!lt&&xt<ve&&(ve=xt,ue={x:Be,y:Oe});var Nt=ei(Ue,t);!lt&&Nt<Ee&&(Ee=Nt,ae={x:Be,y:Oe}),Ke+=B,Be++}le.push(Ve),U.push(Pe),He-=M,Oe++}var Wt=new Ty(le,{diagonal:!0}),Je=Wt.grid[ue.y][ue.x],Kt=Wt.grid[ae.y][ae.x],Vt=Aw.search(Wt,Je,Kt),dt=[l];return Vt.forEach(function(Jt){var Ut=U[Jt.x][Jt.y].split("|");dt.push([+Ut[0],+Ut[1]])}),dt.push(o),Bp(oi(dt))}function TX(e,t){for(var n=0;n<t.features.length;n++)if(Li(e,t.features[n]))return!0;return!1}function kD(e){return function(){return e}}function IX(e){return e[0]}function CX(e){return e[1]}function kb(){this._=null}function Lw(e){e.U=e.C=e.L=e.R=e.P=e.N=null}kb.prototype={constructor:kb,insert:function(e,t){var n,r,i;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=ND(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)r=n.U,n===r.L?(i=r.R,i&&i.C?(n.C=i.C=!1,r.C=!0,e=r):(e===n.R&&(T_(this,n),e=n,n=e.U),n.C=!1,r.C=!0,I_(this,r))):(i=r.L,i&&i.C?(n.C=i.C=!1,r.C=!0,e=r):(e===n.L&&(I_(this,n),e=n,n=e.U),n.C=!1,r.C=!0,T_(this,r))),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t=e.U,n,r=e.L,i=e.R,a,l;if(r?i?a=ND(i):a=r:a=i,t?t.L===e?t.L=a:t.R=a:this._=a,r&&i?(l=a.C,a.C=e.C,a.L=r,r.U=a,a!==i?(t=a.U,a.U=e.U,e=a.R,t.L=e,a.R=i,i.U=a):(a.U=t,t=a,e=a.R)):(l=e.C,e=a),e&&(e.U=t),!l){if(e&&e.C){e.C=!1;return}do{if(e===this._)break;if(e===t.L){if(n=t.R,n.C&&(n.C=!1,t.C=!0,T_(this,t),n=t.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,I_(this,n),n=t.R),n.C=t.C,t.C=n.R.C=!1,T_(this,t),e=this._;break}}else if(n=t.L,n.C&&(n.C=!1,t.C=!0,I_(this,t),n=t.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,T_(this,n),n=t.L),n.C=t.C,t.C=n.L.C=!1,I_(this,t),e=this._;break}n.C=!0,e=t,t=t.U}while(!e.C);e&&(e.C=!1)}}};function T_(e,t){var n=t,r=t.R,i=n.U;i?i.L===n?i.L=r:i.R=r:e._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function I_(e,t){var n=t,r=t.L,i=n.U;i?i.L===n?i.L=r:i.R=r:e._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function ND(e){for(;e.L;)e=e.L;return e}function V_(e,t,n,r){var i=[null,null],a=fs.push(i)-1;return i.left=e,i.right=t,n&&Nb(i,e,t,n),r&&Nb(i,t,e,r),wl[e.index].halfedges.push(a),wl[t.index].halfedges.push(a),i}function C_(e,t,n){var r=[t,n];return r.left=e,r}function Nb(e,t,n,r){!e[0]&&!e[1]?(e[0]=r,e.left=t,e.right=n):e.left===n?e[1]=r:e[0]=r}function PX(e,t,n,r,i){var a=e[0],l=e[1],o=a[0],f=a[1],p=l[0],y=l[1],x=0,w=1,S=p-o,L=y-f,D;if(D=t-o,!(!S&&D>0)){if(D/=S,S<0){if(D<x)return;D<w&&(w=D)}else if(S>0){if(D>w)return;D>x&&(x=D)}if(D=r-o,!(!S&&D<0)){if(D/=S,S<0){if(D>w)return;D>x&&(x=D)}else if(S>0){if(D<x)return;D<w&&(w=D)}if(D=n-f,!(!L&&D>0)){if(D/=L,L<0){if(D<x)return;D<w&&(w=D)}else if(L>0){if(D>w)return;D>x&&(x=D)}if(D=i-f,!(!L&&D<0)){if(D/=L,L<0){if(D>w)return;D>x&&(x=D)}else if(L>0){if(D<x)return;D<w&&(w=D)}return!(x>0)&&!(w<1)||(x>0&&(e[0]=[o+x*S,f+x*L]),w<1&&(e[1]=[o+w*S,f+w*L])),!0}}}}}function AX(e,t,n,r,i){var a=e[1];if(a)return!0;var l=e[0],o=e.left,f=e.right,p=o[0],y=o[1],x=f[0],w=f[1],S=(p+x)/2,L=(y+w)/2,D,B;if(w===y){if(S<t||S>=r)return;if(p>x){if(!l)l=[S,n];else if(l[1]>=i)return;a=[S,i]}else{if(!l)l=[S,i];else if(l[1]<n)return;a=[S,n]}}else if(D=(p-x)/(w-y),B=L-D*S,D<-1||D>1)if(p>x){if(!l)l=[(n-B)/D,n];else if(l[1]>=i)return;a=[(i-B)/D,i]}else{if(!l)l=[(i-B)/D,i];else if(l[1]<n)return;a=[(n-B)/D,n]}else if(y<w){if(!l)l=[t,D*t+B];else if(l[0]>=r)return;a=[r,D*r+B]}else{if(!l)l=[r,D*r+B];else if(l[0]<t)return;a=[t,D*t+B]}return e[0]=l,e[1]=a,!0}function MX(e,t,n,r){for(var i=fs.length,a;i--;)(!AX(a=fs[i],e,t,n,r)||!PX(a,e,t,n,r)||!(Math.abs(a[0][0]-a[1][0])>Bi||Math.abs(a[0][1]-a[1][1])>Bi))&&delete fs[i]}function LX(e){return wl[e.index]={site:e,halfedges:[]}}function OX(e,t){var n=e.site,r=t.left,i=t.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=t[1],i=t[0]):(r=t[0],i=t[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function g4(e,t){return t[+(t.left!==e.site)]}function DX(e,t){return t[+(t.left===e.site)]}function RX(){for(var e=0,t=wl.length,n,r,i,a;e<t;++e)if((n=wl[e])&&(a=(r=n.halfedges).length)){var l=new Array(a),o=new Array(a);for(i=0;i<a;++i)l[i]=i,o[i]=OX(n,fs[r[i]]);for(l.sort(function(f,p){return o[p]-o[f]}),i=0;i<a;++i)o[i]=r[l[i]];for(i=0;i<a;++i)r[i]=o[i]}}function kX(e,t,n,r){var i=wl.length,a,l,o,f,p,y,x,w,S,L,D,B,z=!0;for(a=0;a<i;++a)if(l=wl[a]){for(o=l.site,p=l.halfedges,f=p.length;f--;)fs[p[f]]||p.splice(f,1);for(f=0,y=p.length;f<y;)L=DX(l,fs[p[f]]),D=L[0],B=L[1],x=g4(l,fs[p[++f%y]]),w=x[0],S=x[1],(Math.abs(D-w)>Bi||Math.abs(B-S)>Bi)&&(p.splice(f,0,fs.push(C_(o,L,Math.abs(D-e)<Bi&&r-B>Bi?[e,Math.abs(w-e)<Bi?S:r]:Math.abs(B-r)<Bi&&n-D>Bi?[Math.abs(S-r)<Bi?w:n,r]:Math.abs(D-n)<Bi&&B-t>Bi?[n,Math.abs(w-n)<Bi?S:t]:Math.abs(B-t)<Bi&&D-e>Bi?[Math.abs(S-t)<Bi?w:e,t]:null))-1),++y);y&&(z=!1)}if(z){var M,k,V,q=1/0;for(a=0,z=null;a<i;++a)(l=wl[a])&&(o=l.site,M=o[0]-e,k=o[1]-t,V=M*M+k*k,V<q&&(q=V,z=l));if(z){var Y=[e,t],K=[e,r],X=[n,r],U=[n,t];z.halfedges.push(fs.push(C_(o=z.site,Y,K))-1,fs.push(C_(o,K,X))-1,fs.push(C_(o,X,U))-1,fs.push(C_(o,U,Y))-1)}}for(a=0;a<i;++a)(l=wl[a])&&(l.halfedges.length||delete wl[a])}var m4=[],E2;function NX(){Lw(this),this.x=this.y=this.arc=this.site=this.cy=null}function Rm(e){var t=e.P,n=e.N;if(!(!t||!n)){var r=t.site,i=e.site,a=n.site;if(r!==a){var l=i[0],o=i[1],f=r[0]-l,p=r[1]-o,y=a[0]-l,x=a[1]-o,w=2*(f*x-p*y);if(!(w>=-VX)){var S=f*f+p*p,L=y*y+x*x,D=(x*S-p*L)/w,B=(f*L-y*S)/w,z=m4.pop()||new NX;z.arc=e,z.site=i,z.x=D+l,z.y=(z.cy=B+o)+Math.sqrt(D*D+B*B),e.circle=z;for(var M=null,k=g0._;k;)if(z.y<k.y||z.y===k.y&&z.x<=k.x)if(k.L)k=k.L;else{M=k.P;break}else if(k.R)k=k.R;else{M=k;break}g0.insert(M,z),M||(E2=z)}}}}function Vm(e){var t=e.circle;t&&(t.P||(E2=t.N),g0.remove(t),m4.push(t),Lw(t),e.circle=null)}var y4=[];function FX(){Lw(this),this.edge=this.site=this.circle=null}function FD(e){var t=y4.pop()||new FX;return t.site=e,t}function TT(e){Vm(e),Gm.remove(e),y4.push(e),Lw(e)}function BX(e){var t=e.circle,n=t.x,r=t.cy,i=[n,r],a=e.P,l=e.N,o=[e];TT(e);for(var f=a;f.circle&&Math.abs(n-f.circle.x)<Bi&&Math.abs(r-f.circle.cy)<Bi;)a=f.P,o.unshift(f),TT(f),f=a;o.unshift(f),Vm(f);for(var p=l;p.circle&&Math.abs(n-p.circle.x)<Bi&&Math.abs(r-p.circle.cy)<Bi;)l=p.N,o.push(p),TT(p),p=l;o.push(p),Vm(p);var y=o.length,x;for(x=1;x<y;++x)p=o[x],f=o[x-1],Nb(p.edge,f.site,p.site,i);f=o[0],p=o[y-1],p.edge=V_(f.site,p.site,null,i),Rm(f),Rm(p)}function zX(e){for(var t=e[0],n=e[1],r,i,a,l,o=Gm._;o;)if(a=v4(o,n)-t,a>Bi)o=o.L;else if(l=t-UX(o,n),l>Bi){if(!o.R){r=o;break}o=o.R}else{a>-Bi?(r=o.P,i=o):l>-Bi?(r=o,i=o.N):r=i=o;break}LX(e);var f=FD(e);if(Gm.insert(r,f),!(!r&&!i)){if(r===i){Vm(r),i=FD(r.site),Gm.insert(f,i),f.edge=i.edge=V_(r.site,f.site),Rm(r),Rm(i);return}if(!i){f.edge=V_(r.site,f.site);return}Vm(r),Vm(i);var p=r.site,y=p[0],x=p[1],w=e[0]-y,S=e[1]-x,L=i.site,D=L[0]-y,B=L[1]-x,z=2*(w*B-S*D),M=w*w+S*S,k=D*D+B*B,V=[(B*M-S*k)/z+y,(w*k-D*M)/z+x];Nb(i.edge,p,L,V),f.edge=V_(p,e,null,V),i.edge=V_(e,L,null,V),Rm(r),Rm(i)}}function v4(e,t){var n=e.site,r=n[0],i=n[1],a=i-t;if(!a)return r;var l=e.P;if(!l)return-1/0;n=l.site;var o=n[0],f=n[1],p=f-t;if(!p)return o;var y=o-r,x=1/a-1/p,w=y/p;return x?(-w+Math.sqrt(w*w-2*x*(y*y/(-2*p)-f+p/2+i-a/2)))/x+r:(r+o)/2}function UX(e,t){var n=e.N;if(n)return v4(n,t);var r=e.site;return r[1]===t?r[0]:1/0}var Bi=1e-6,VX=1e-12,Gm,wl,g0,fs;function GX(e,t,n){return(e[0]-n[0])*(t[1]-e[1])-(e[0]-t[0])*(n[1]-e[1])}function $X(e,t){return t[1]-e[1]||t[0]-e[0]}function xI(e,t){var n=e.sort($X).pop(),r,i,a;for(fs=[],wl=new Array(e.length),Gm=new kb,g0=new kb;;)if(a=E2,n&&(!a||n[1]<a.y||n[1]===a.y&&n[0]<a.x))(n[0]!==r||n[1]!==i)&&(zX(n),r=n[0],i=n[1]),n=e.pop();else if(a)BX(a.arc);else break;if(RX(),t){var l=+t[0][0],o=+t[0][1],f=+t[1][0],p=+t[1][1];MX(l,o,f,p),kX(l,o,f,p)}this.edges=fs,this.cells=wl,Gm=g0=fs=wl=null}xI.prototype={constructor:xI,polygons:function(){var e=this.edges;return this.cells.map(function(t){var n=t.halfedges.map(function(r){return g4(t,e[r])});return n.data=t.site.data,n})},triangles:function(){var e=[],t=this.edges;return this.cells.forEach(function(n,r){if(o=(a=n.halfedges).length)for(var i=n.site,a,l=-1,o,f,p=t[a[o-1]],y=p.left===i?p.right:p.left;++l<o;)f=y,p=t[a[l]],y=p.left===i?p.right:p.left,f&&y&&r<f.index&&r<y.index&&GX(i,f,y)<0&&e.push([i.data,f.data,y.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,t,n){for(var r=this,i,a=r._found||0,l=r.cells.length,o;!(o=r.cells[a]);)if(++a>=l)return null;var f=e-o.site[0],p=t-o.site[1],y=f*f+p*p;do o=r.cells[i=a],a=null,o.halfedges.forEach(function(x){var w=r.edges[x],S=w.left;if(!((S===o.site||!S)&&!(S=w.right))){var L=e-S[0],D=t-S[1],B=L*L+D*D;B<y&&(y=B,a=S.index)}});while(a!==null);return r._found=i,n==null||y<=n*n?o.site:null}};function jX(){var e=IX,t=CX,n=null;function r(i){return new xI(i.map(function(a,l){var o=[Math.round(e(a,l,i)/Bi)*Bi,Math.round(t(a,l,i)/Bi)*Bi];return o.index=l,o.data=a,o}),n)}return r.polygons=function(i){return r(i).polygons()},r.links=function(i){return r(i).links()},r.triangles=function(i){return r(i).triangles()},r.x=function(i){return arguments.length?(e=typeof i=="function"?i:kD(+i),r):e},r.y=function(i){return arguments.length?(t=typeof i=="function"?i:kD(+i),r):t},r.extent=function(i){return arguments.length?(n=i==null?null:[[+i[0][0],+i[0][1]],[+i[1][0],+i[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(i){return arguments.length?(n=i==null?null:[[0,0],[+i[0],+i[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r}function qX(e){return e=e.slice(),e.push(e[0]),fr([e])}function ZX(e,t){if(t=t||{},!li(t))throw new Error("options is invalid");var n=t.bbox||[-180,-85,180,85];if(!e)throw new Error("points is required");if(!Array.isArray(n))throw new Error("bbox is invalid");return af(e,"Point","points"),An(jX().x(function(r){return r.geometry.coordinates[0]}).y(function(r){return r.geometry.coordinates[1]}).extent([[n[0],n[1]],[n[2],n[3]]]).polygons(e.features).map(qX))}function _4(e,t,n,r){r=r||{};var i=r.steps||64,a=r.units||"kilometers",l=r.angle||0,o=r.pivot||e,f=r.properties||e.properties||{};if(!e)throw new Error("center is required");if(!t)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!li(r))throw new Error("options must be an object");if(!sa(i))throw new Error("steps must be a number");if(!sa(l))throw new Error("angle must be a number");var p=Ti(e);if(a==="degrees")var y=oa(l);else t=Ym(e,t,90,{units:a}),n=Ym(e,n,0,{units:a}),t=Ti(t)[0]-p[0],n=Ti(n)[1]-p[1];for(var x=[],w=0;w<i;w+=1){var S=w*-360/i,L=t*n/Math.sqrt(Math.pow(n,2)+Math.pow(t,2)*Math.pow(BD(S),2)),D=t*n/Math.sqrt(Math.pow(t,2)+Math.pow(n,2)/Math.pow(BD(S),2));if(S<-90&&S>=-270&&(L=-L),S<-180&&S>=-360&&(D=-D),a==="degrees"){var B=L*Math.cos(y)+D*Math.sin(y),z=D*Math.cos(y)-L*Math.sin(y);L=B,D=z}x.push([L+p[0],D+p[1]])}return x.push(x[0]),a==="degrees"?fr([x],f):e4(fr([x],f),l,{pivot:o})}function BD(e){var t=e*Math.PI/180;return Math.tan(t)}function S2(e,t){t===void 0&&(t={});var n=0,r=0,i=0;return sl(e,function(a,l,o){var f=t.weight?o==null?void 0:o[t.weight]:void 0;if(f=f??1,!sa(f))throw new Error("weight value must be a number for feature index "+l);f=Number(f),f>0&&mo(a,function(p){n+=p[0]*f,r+=p[1]*f,i+=f})}),sr([n/i,r/i],t.properties,t)}function XX(e,t){if(t===void 0&&(t={}),t=t||{},!li(t))throw new Error("options is invalid");var n=t.counter||10;if(!sa(n))throw new Error("counter must be a number");var r=t.weight,i=S2(e,{weight:t.weight}),a=An([]);ti(e,function(o){var f;a.features.push(od(o,{properties:{weight:(f=o.properties)===null||f===void 0?void 0:f[r]}}))});var l={tolerance:t.tolerance,medianCandidates:[]};return x4(i.geometry.coordinates,[0,0],a,l,n)}function x4(e,t,n,r,i){var a=r.tolerance||.001,l=0,o=0,f=0,p=0;if(ti(n,function(w){var S,L=(S=w.properties)===null||S===void 0?void 0:S.weight,D=L??1;if(D=Number(D),!sa(D))throw new Error("weight value must be a number");if(D>0){p+=1;var B=D*ei(w,e);B===0&&(B=1);var z=D/B;l+=w.geometry.coordinates[0]*z,o+=w.geometry.coordinates[1]*z,f+=z}}),p<1)throw new Error("no features to measure");var y=l/f,x=o/f;return p===1||i===0||Math.abs(y-t[0])<a&&Math.abs(x-t[1])<a?sr([y,x],{medianCandidates:r.medianCandidates}):(r.medianCandidates.push([y,x]),x4([y,x],e,n,r,i-1))}function WX(e,t){if(t=t||{},!li(t))throw new Error("options is invalid");var n=t.steps||64,r=t.weight,i=t.properties||{};if(!sa(n))throw new Error("steps must be a number");if(!li(i))throw new Error("properties must be a number");var a=Wm(e).length,l=S2(e,{weight:r}),o=0,f=0,p=0;ti(e,function(K){var X=K.properties[r]||1,U=zD(kn(K),kn(l));o+=Math.pow(U.x,2)*X,f+=Math.pow(U.y,2)*X,p+=U.x*U.y*X});var y=o-f,x=Math.sqrt(Math.pow(y,2)+4*Math.pow(p,2)),w=2*p,S=Math.atan((y+x)/w),L=S*180/Math.PI,D=0,B=0,z=0;ti(e,function(K){var X=K.properties[r]||1,U=zD(kn(K),kn(l));D+=Math.pow(U.x*Math.cos(S)-U.y*Math.sin(S),2)*X,B+=Math.pow(U.x*Math.sin(S)+U.y*Math.cos(S),2)*X,z+=X});var M=Math.sqrt(2*D/z),k=Math.sqrt(2*B/z),V=_4(l,M,k,{units:"degrees",angle:L,steps:n,properties:i}),q=nI(e,An([V])),Y={meanCenterCoordinates:kn(l),semiMajorAxis:M,semiMinorAxis:k,numberOfFeatures:a,angle:L,percentageWithinEllipse:100*Wm(q).length/a};return V.properties.standardDeviationalEllipse=Y,V}function zD(e,t){return{x:e[0]-t[0],y:e[1]-t[1]}}function HX(e,t,n,r){if(r===void 0&&(r={}),!li(r))throw new Error("options is invalid");if(!e)throw new Error("startPoint is required");if(!t)throw new Error("midPoint is required");if(!n)throw new Error("endPoint is required");var i=e,a=t,l=n,o=Np(r.mercator!==!0?jh(i,a):Vp(i,a)),f=Np(r.mercator!==!0?jh(l,a):Vp(l,a)),p=Math.abs(o-f);return r.explementary===!0?360-p:p}function YX(e,t){var n=[],r=t.iterations||1;if(!e)throw new Error("inputPolys is required");return sl(e,function(i,a,l){var o,f,p;switch(i.type){case"Polygon":o=[[]];for(var y=0;y<r;y++)p=[[]],f=i,y>0&&(f=fr(o).geometry),KX(f,p),o=p.slice(0);n.push(fr(o,l));break;case"MultiPolygon":o=[[[]]];for(var x=0;x<r;x++)p=[[[]]],f=i,x>0&&(f=al(o).geometry),JX(f,p),o=p.slice(0);n.push(al(o,l));break;default:throw new Error("geometry is invalid, must be Polygon or MultiPolygon")}}),An(n)}function KX(e,t){var n=0,r=0;mo(e,function(i,a,l,o,f){f>n&&(n=f,r=a,t.push([]));var p=a-r,y=e.coordinates[f][p+1],x=i[0],w=i[1],S=y[0],L=y[1];t[f].push([.75*x+.25*S,.75*w+.25*L]),t[f].push([.25*x+.75*S,.25*w+.75*L])},!0),t.forEach(function(i){i.push(i[0])})}function JX(e,t){var n=0,r=0,i=0;mo(e,function(a,l,o,f,p){f>i&&(i=f,r=l,t.push([[]])),p>n&&(n=p,r=l,t[f].push([]));var y=l-r,x=e.coordinates[f][p][y+1],w=a[0],S=a[1],L=x[0],D=x[1];t[f][p].push([.75*w+.25*L,.75*S+.25*D]),t[f][p].push([.25*w+.75*L,.25*S+.75*D])},!0),t.forEach(function(a){a.forEach(function(l){l.push(l[0])})})}function QX(e,t,n){n===void 0&&(n=2);var r=Ti(e),i=Ti(t),a=r[0]-i[0],l=r[1]-i[1];return n===1?Math.abs(a)+Math.abs(l):Math.pow(Math.pow(a,n)+Math.pow(l,n),1/n)}function b4(e,t){t=t||{};var n=t.threshold||1e4,r=t.p||2,i=t.binary||!1,a=t.alpha||-1,l=t.standardization||!1,o=[];ti(e,function(S){o.push(od(S))});for(var f=[],p=0;p<o.length;p++)f[p]=[];for(var p=0;p<o.length;p++)for(var y=p;y<o.length;y++){p===y&&(f[p][y]=0);var x=QX(o[p],o[y],r);f[p][y]=x,f[y][p]=x}for(var p=0;p<o.length;p++)for(var y=0;y<o.length;y++){var x=f[p][y];x!==0&&(i?x<=n?f[p][y]=1:f[p][y]=0:x<=n?f[p][y]=Math.pow(x,a):f[p][y]=0)}if(l)for(var p=0;p<o.length;p++)for(var w=f[p].reduce(function(L,D){return L+D},0),y=0;y<o.length;y++)f[p][y]=f[p][y]/w;return f}function eW(e,t){var n=t.inputField,r=t.threshold||1e5,i=t.p||2,a=t.binary||!1,l=t.alpha||-1,o=t.standardization||!0,f=b4(e,{alpha:l,binary:a,p:i,standardization:o,threshold:r}),p=[];ti(e,function(ue){var ae=ue.properties||{};p.push(ae[n])});for(var y=w4(p),x=tW(p),w=0,S=0,L=0,D=0,B=f.length,z=0;z<B;z++){for(var M=0,k=0;k<B;k++)w+=f[z][k]*(p[z]-y)*(p[k]-y),S+=f[z][k],L+=Math.pow(f[z][k]+f[k][z],2),M+=f[z][k]+f[k][z];D+=Math.pow(M,2)}L=.5*L;var V=w/S/x,q=-1/(B-1),Y=B*B*L-B*D+3*(S*S),K=(B-1)*(B+1)*(S*S),X=Y/K-q*q,U=Math.sqrt(X),le=(V-q)/U;return{expectedMoranIndex:q,moranIndex:V,stdNorm:U,zNorm:le}}function w4(e){for(var t=0,n=0,r=e;n<r.length;n++){var i=r[n];t+=i}return t/e.length}function tW(e){for(var t=w4(e),n=0,r=0,i=e;r<i.length;r++){var a=i[r];n+=Math.pow(a-t,2)}return n/e.length}function E4(e,t){return t===void 0&&(t={}),T4(e,"mercator",t)}function S4(e,t){return t===void 0&&(t={}),T4(e,"wgs84",t)}function T4(e,t,n){n===void 0&&(n={}),n=n||{};var r=n.mutate;if(!e)throw new Error("geojson is required");return Array.isArray(e)&&sa(e[0])?e=t==="mercator"?UD(e):VD(e):(r!==!0&&(e=Ua(e)),mo(e,function(i){var a=t==="mercator"?UD(i):VD(i);i[0]=a[0],i[1]=a[1]})),e}function UD(e){var t=Math.PI/180,n=6378137,r=20037508342789244e-9,i=Math.abs(e[0])<=180?e[0]:e[0]-nW(e[0])*360,a=[n*i*t,n*Math.log(Math.tan(Math.PI*.25+.5*e[1]*t))];return a[0]>r&&(a[0]=r),a[0]<-r&&(a[0]=-r),a[1]>r&&(a[1]=r),a[1]<-r&&(a[1]=-r),a}function VD(e){var t=180/Math.PI,n=6378137;return[e[0]*t/n,(Math.PI*.5-2*Math.atan(Math.exp(-e[1]/n)))*t]}function nW(e){return e<0?-1:e>0?1:0}const rW=Object.freeze(Object.defineProperty({__proto__:null,toMercator:E4,toWgs84:S4},Symbol.toStringTag,{value:"Module"}));var iW=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var a=arguments[t],l=0,o=a.length;l<o;l++,i++)r[i]=a[l];return r};function Z0(e){return Array.isArray(e)?GD(e):e&&e.bbox?GD(e.bbox):[aW(),sW()]}function I4(e,t){t===void 0&&(t={}),e==null&&(e=1);for(var n=[],r=0;r<e;r++)n.push(sr(Z0(t.bbox)));return An(n)}function C4(e,t){t===void 0&&(t={}),e==null&&(e=1),(!sa(t.num_vertices)||t.num_vertices===void 0)&&(t.num_vertices=10),(!sa(t.max_radial_length)||t.max_radial_length===void 0)&&(t.max_radial_length=10);for(var n=[],r=function(a){var l=[],o=iW(Array(t.num_vertices+1)).map(Math.random);o.forEach(function(f,p,y){y[p]=p>0?f+y[p-1]:f}),o.forEach(function(f){f=f*2*Math.PI/o[o.length-1];var p=Math.random();l.push([p*(t.max_radial_length||10)*Math.sin(f),p*(t.max_radial_length||10)*Math.cos(f)])}),l[l.length-1]=l[0],l=l.map(oW(Z0(t.bbox))),n.push(fr([l]))},i=0;i<e;i++)r();return An(n)}function P4(e,t){if(t===void 0&&(t={}),t=t||{},!li(t))throw new Error("options is invalid");var n=t.bbox,r=t.num_vertices,i=t.max_length,a=t.max_rotation;e==null&&(e=1),(!sa(r)||r===void 0||r<2)&&(r=10),(!sa(i)||i===void 0)&&(i=1e-4),(!sa(a)||a===void 0)&&(a=Math.PI/8);for(var l=[],o=0;o<e;o++){for(var f=Z0(n),p=[f],y=0;y<r-1;y++){var x=y===0?Math.random()*2*Math.PI:Math.tan((p[y][1]-p[y-1][1])/(p[y][0]-p[y-1][0])),w=x+(Math.random()-.5)*a*2,S=Math.random()*i;p.push([p[y][0]+S*Math.cos(w),p[y][1]+S*Math.sin(w)])}l.push(oi(p))}return An(l)}function oW(e){return function(t){return[t[0]+e[0],t[1]+e[1]]}}function A4(){return Math.random()-.5}function aW(){return A4()*360}function sW(){return A4()*180}function GD(e){return[Math.random()*(e[2]-e[0])+e[0],Math.random()*(e[3]-e[1])+e[1]]}const lW=Object.freeze(Object.defineProperty({__proto__:null,randomLineString:P4,randomPoint:I4,randomPolygon:C4,randomPosition:Z0},Symbol.toStringTag,{value:"Module"}));function M4(e,t){if(!e)throw new Error("geojson is required");if(e.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(t==null)throw new Error("filter is required");var n=[];return ti(e,function(r){Ow(r.properties,t)&&n.push(r)}),An(n)}function T2(e,t,n){if(!e)throw new Error("geojson is required");if(e.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(t==null)throw new Error("property is required");for(var r=I2(e,t),i=Object.keys(r),a=0;a<i.length;a++){for(var l=i[a],o=r[l],f=[],p=0;p<o.length;p++)f.push(e.features[o[p]]);n(An(f),l,a)}}function L4(e,t,n,r){var i=r;return T2(e,t,function(a,l,o){o===0&&r===void 0?i=a:i=n(i,a,l,o)}),i}function I2(e,t){var n={};return ti(e,function(r,i){var a=r.properties||{};if(Object.prototype.hasOwnProperty.call(a,String(t))){var l=a[t];Object.prototype.hasOwnProperty.call(n,l)?n[l].push(i):n[l]=[i]}}),n}function Ow(e,t){if(e===void 0)return!1;var n=typeof t;if(n==="number"||n==="string")return Object.prototype.hasOwnProperty.call(e,t);if(Array.isArray(t)){for(var r=0;r<t.length;r++)if(!Ow(e,t[r]))return!1;return!0}else return C2(e,t)}function C2(e,t){for(var n=Object.keys(t),r=0;r<n.length;r++){var i=n[r];if(e[i]!==t[i])return!1}return!0}function O4(e,t){if(!t)return{};if(!t.length)return{};for(var n={},r=0;r<t.length;r++){var i=t[r];Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n}const uW=Object.freeze(Object.defineProperty({__proto__:null,applyFilter:Ow,clusterEach:T2,clusterReduce:L4,createBins:I2,filterProperties:O4,getCluster:M4,propertiesContainsFilter:C2},Symbol.toStringTag,{value:"Module"}));/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function cW(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,l;return l={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function o(p){return function(y){return f([p,y])}}function f(p){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(a=p[0]&2?i.return:p[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,p[1])).done)return a;switch(i=0,a&&(p=[p[0]&2,a.value]),p[0]){case 0:case 1:a=p;break;case 4:return n.label++,{value:p[1],done:!1};case 5:n.label++,i=p[1],p=[0];continue;case 7:p=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(p[0]===6||p[0]===2)){n=0;continue}if(p[0]===3&&(!a||p[1]>a[0]&&p[1]<a[3])){n.label=p[1];break}if(p[0]===6&&n.label<a[1]){n.label=a[1],a=p;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(p);break}a[2]&&n.ops.pop(),n.trys.pop();continue}p=t.call(e,n)}catch(y){p=[6,y],i=0}finally{r=a=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}var ad=function(){function e(t,n){this.next=null,this.key=t,this.data=n,this.left=null,this.right=null}return e}();function hW(e,t){return e>t?1:e<t?-1:0}function Yf(e,t,n){for(var r=new ad(null,null),i=r,a=r;;){var l=n(e,t.key);if(l<0){if(t.left===null)break;if(n(e,t.left.key)<0){var o=t.left;if(t.left=o.right,o.right=t,t=o,t.left===null)break}a.left=t,a=t,t=t.left}else if(l>0){if(t.right===null)break;if(n(e,t.right.key)>0){var o=t.right;if(t.right=o.left,o.left=t,t=o,t.right===null)break}i.right=t,i=t,t=t.right}else break}return i.right=t.left,a.left=t.right,t.left=r.right,t.right=r.left,t}function IT(e,t,n,r){var i=new ad(e,t);if(n===null)return i.left=i.right=null,i;n=Yf(e,n,r);var a=r(e,n.key);return a<0?(i.left=n.left,i.right=n,n.left=null):a>=0&&(i.right=n.right,i.left=n,n.right=null),i}function $D(e,t,n){var r=null,i=null;if(t){t=Yf(e,t,n);var a=n(t.key,e);a===0?(r=t.left,i=t.right):a<0?(i=t.right,t.right=null,r=t):(r=t.left,t.left=null,i=t)}return{left:r,right:i}}function fW(e,t,n){return t===null?e:(e===null||(t=Yf(e.key,t,n),t.left=e),t)}function bI(e,t,n,r,i){if(e){r(""+t+(n?" ":" ")+i(e)+`
`);var a=t+(n?"    ":"   ");e.left&&bI(e.left,a,!1,r,i),e.right&&bI(e.right,a,!0,r,i)}}var P2=function(){function e(t){t===void 0&&(t=hW),this._root=null,this._size=0,this._comparator=t}return e.prototype.insert=function(t,n){return this._size++,this._root=IT(t,n,this._root,this._comparator)},e.prototype.add=function(t,n){var r=new ad(t,n);this._root===null&&(r.left=r.right=null,this._size++,this._root=r);var i=this._comparator,a=Yf(t,this._root,i),l=i(t,a.key);return l===0?this._root=a:(l<0?(r.left=a.left,r.right=a,a.left=null):l>0&&(r.right=a.right,r.left=a,a.right=null),this._size++,this._root=r),this._root},e.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},e.prototype._remove=function(t,n,r){var i;if(n===null)return null;n=Yf(t,n,r);var a=r(t,n.key);return a===0?(n.left===null?i=n.right:(i=Yf(t,n.left,r),i.right=n.right),this._size--,i):n},e.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=Yf(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},e.prototype.findStatic=function(t){for(var n=this._root,r=this._comparator;n;){var i=r(t,n.key);if(i===0)return n;i<0?n=n.left:n=n.right}return null},e.prototype.find=function(t){return this._root&&(this._root=Yf(t,this._root,this._comparator),this._comparator(t,this._root.key)!==0)?null:this._root},e.prototype.contains=function(t){for(var n=this._root,r=this._comparator;n;){var i=r(t,n.key);if(i===0)return!0;i<0?n=n.left:n=n.right}return!1},e.prototype.forEach=function(t,n){for(var r=this._root,i=[],a=!1;!a;)r!==null?(i.push(r),r=r.left):i.length!==0?(r=i.pop(),t.call(n,r),r=r.right):a=!0;return this},e.prototype.range=function(t,n,r,i){for(var a=[],l=this._comparator,o=this._root,f;a.length!==0||o;)if(o)a.push(o),o=o.left;else{if(o=a.pop(),f=l(o.key,n),f>0)break;if(l(o.key,t)>=0&&r.call(i,o))return this;o=o.right}return this},e.prototype.keys=function(){var t=[];return this.forEach(function(n){var r=n.key;return t.push(r)}),t},e.prototype.values=function(){var t=[];return this.forEach(function(n){var r=n.data;return t.push(r)}),t},e.prototype.min=function(){return this._root?this.minNode(this._root).key:null},e.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},e.prototype.minNode=function(t){if(t===void 0&&(t=this._root),t)for(;t.left;)t=t.left;return t},e.prototype.maxNode=function(t){if(t===void 0&&(t=this._root),t)for(;t.right;)t=t.right;return t},e.prototype.at=function(t){for(var n=this._root,r=!1,i=0,a=[];!r;)if(n)a.push(n),n=n.left;else if(a.length>0){if(n=a.pop(),i===t)return n;i++,n=n.right}else r=!0;return null},e.prototype.next=function(t){var n=this._root,r=null;if(t.right){for(r=t.right;r.left;)r=r.left;return r}for(var i=this._comparator;n;){var a=i(t.key,n.key);if(a===0)break;a<0?(r=n,n=n.left):n=n.right}return r},e.prototype.prev=function(t){var n=this._root,r=null;if(t.left!==null){for(r=t.left;r.right;)r=r.right;return r}for(var i=this._comparator;n;){var a=i(t.key,n.key);if(a===0)break;a<0?n=n.left:(r=n,n=n.right)}return r},e.prototype.clear=function(){return this._root=null,this._size=0,this},e.prototype.toList=function(){return pW(this._root)},e.prototype.load=function(t,n,r){n===void 0&&(n=[]),r===void 0&&(r=!1);var i=t.length,a=this._comparator;if(r&&SI(t,n,0,i-1,a),this._root===null)this._root=wI(t,n,0,i),this._size=i;else{var l=gW(this.toList(),dW(t,n),a);i=this._size+i,this._root=EI({head:l},0,i)}return this},e.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){t===void 0&&(t=function(r){return String(r.key)});var n=[];return bI(this._root,"",!0,function(r){return n.push(r)},t),n.join("")},e.prototype.update=function(t,n,r){var i=this._comparator,a=$D(t,this._root,i),l=a.left,o=a.right;i(t,n)<0?o=IT(n,r,o,i):l=IT(n,r,l,i),this._root=fW(l,o,i)},e.prototype.split=function(t){return $D(t,this._root,this._comparator)},e.prototype[Symbol.iterator]=function(){var t,n,r;return cW(this,function(i){switch(i.label){case 0:t=this._root,n=[],r=!1,i.label=1;case 1:return r?[3,6]:t===null?[3,2]:(n.push(t),t=t.left,[3,5]);case 2:return n.length===0?[3,4]:(t=n.pop(),[4,t]);case 3:return i.sent(),t=t.right,[3,5];case 4:r=!0,i.label=5;case 5:return[3,1];case 6:return[2]}})},e}();function wI(e,t,n,r){var i=r-n;if(i>0){var a=n+Math.floor(i/2),l=e[a],o=t[a],f=new ad(l,o);return f.left=wI(e,t,n,a),f.right=wI(e,t,a+1,r),f}return null}function dW(e,t){for(var n=new ad(null,null),r=n,i=0;i<e.length;i++)r=r.next=new ad(e[i],t[i]);return r.next=null,n.next}function pW(e){for(var t=e,n=[],r=!1,i=new ad(null,null),a=i;!r;)t?(n.push(t),t=t.left):n.length>0?(t=a=a.next=n.pop(),t=t.right):r=!0;return a.next=null,i.next}function EI(e,t,n){var r=n-t;if(r>0){var i=t+Math.floor(r/2),a=EI(e,t,i),l=e.head;return l.left=a,e.head=e.head.next,l.right=EI(e,i+1,n),l}return null}function gW(e,t,n){for(var r=new ad(null,null),i=r,a=e,l=t;a!==null&&l!==null;)n(a.key,l.key)<0?(i.next=a,a=a.next):(i.next=l,l=l.next),i=i.next;return a!==null?i.next=a:l!==null&&(i.next=l),r.next}function SI(e,t,n,r,i){if(!(n>=r)){for(var a=e[n+r>>1],l=n-1,o=r+1;;){do l++;while(i(e[l],a)<0);do o--;while(i(e[o],a)>0);if(l>=o)break;var f=e[l];e[l]=e[o],e[o]=f,f=t[l],t[l]=t[o],t[o]=f}SI(e,t,n,o,i),SI(e,t,o+1,r,i)}}function Cu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rs(e,t,n){return t&&jD(e.prototype,t),n&&jD(e,n),e}var P_=function(t,n){return t.ll.x<=n.x&&n.x<=t.ur.x&&t.ll.y<=n.y&&n.y<=t.ur.y},TI=function(t,n){if(n.ur.x<t.ll.x||t.ur.x<n.ll.x||n.ur.y<t.ll.y||t.ur.y<n.ll.y)return null;var r=t.ll.x<n.ll.x?n.ll.x:t.ll.x,i=t.ur.x<n.ur.x?t.ur.x:n.ur.x,a=t.ll.y<n.ll.y?n.ll.y:t.ll.y,l=t.ur.y<n.ur.y?t.ur.y:n.ur.y;return{ll:{x:r,y:a},ur:{x:i,y:l}}},Jf=Number.EPSILON;Jf===void 0&&(Jf=Math.pow(2,-52));var mW=Jf*Jf,II=function(t,n){if(-Jf<t&&t<Jf&&-Jf<n&&n<Jf)return 0;var r=t-n;return r*r<mW*t*n?0:t<n?-1:1},yW=function(){function e(){Cu(this,e),this.reset()}return Rs(e,[{key:"reset",value:function(){this.xRounder=new qD,this.yRounder=new qD}},{key:"round",value:function(n,r){return{x:this.xRounder.round(n),y:this.yRounder.round(r)}}}]),e}(),qD=function(){function e(){Cu(this,e),this.tree=new P2,this.round(0)}return Rs(e,[{key:"round",value:function(n){var r=this.tree.add(n),i=this.tree.prev(r);if(i!==null&&II(r.key,i.key)===0)return this.tree.remove(n),i.key;var a=this.tree.next(r);return a!==null&&II(r.key,a.key)===0?(this.tree.remove(n),a.key):n}}]),e}(),m0=new yW,H_=function(t,n){return t.x*n.y-t.y*n.x},D4=function(t,n){return t.x*n.x+t.y*n.y},ZD=function(t,n,r){var i={x:n.x-t.x,y:n.y-t.y},a={x:r.x-t.x,y:r.y-t.y},l=H_(i,a);return II(l,0)},Fb=function(t){return Math.sqrt(D4(t,t))},vW=function(t,n,r){var i={x:n.x-t.x,y:n.y-t.y},a={x:r.x-t.x,y:r.y-t.y};return H_(a,i)/Fb(a)/Fb(i)},_W=function(t,n,r){var i={x:n.x-t.x,y:n.y-t.y},a={x:r.x-t.x,y:r.y-t.y};return D4(a,i)/Fb(a)/Fb(i)},XD=function(t,n,r){return n.y===0?null:{x:t.x+n.x/n.y*(r-t.y),y:r}},WD=function(t,n,r){return n.x===0?null:{x:r,y:t.y+n.y/n.x*(r-t.x)}},xW=function(t,n,r,i){if(n.x===0)return WD(r,i,t.x);if(i.x===0)return WD(t,n,r.x);if(n.y===0)return XD(r,i,t.y);if(i.y===0)return XD(t,n,r.y);var a=H_(n,i);if(a==0)return null;var l={x:r.x-t.x,y:r.y-t.y},o=H_(l,n)/a,f=H_(l,i)/a,p=t.x+f*n.x,y=r.x+o*i.x,x=t.y+f*n.y,w=r.y+o*i.y,S=(p+y)/2,L=(x+w)/2;return{x:S,y:L}},jc=function(){Rs(e,null,[{key:"compare",value:function(n,r){var i=e.comparePoints(n.point,r.point);return i!==0?i:(n.point!==r.point&&n.link(r),n.isLeft!==r.isLeft?n.isLeft?1:-1:Bb.compare(n.segment,r.segment))}},{key:"comparePoints",value:function(n,r){return n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0}}]);function e(t,n){Cu(this,e),t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=n}return Rs(e,[{key:"link",value:function(n){if(n.point===this.point)throw new Error("Tried to link already linked events");for(var r=n.point.events,i=0,a=r.length;i<a;i++){var l=r[i];this.point.events.push(l),l.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var n=this.point.events.length,r=0;r<n;r++){var i=this.point.events[r];if(i.segment.consumedBy===void 0)for(var a=r+1;a<n;a++){var l=this.point.events[a];l.consumedBy===void 0&&i.otherSE.point.events===l.otherSE.point.events&&i.segment.consume(l.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var n=[],r=0,i=this.point.events.length;r<i;r++){var a=this.point.events[r];a!==this&&!a.segment.ringOut&&a.segment.isInResult()&&n.push(a)}return n}},{key:"getLeftmostComparator",value:function(n){var r=this,i=new Map,a=function(o){var f=o.otherSE;i.set(o,{sine:vW(r.point,n.point,f.point),cosine:_W(r.point,n.point,f.point)})};return function(l,o){i.has(l)||a(l),i.has(o)||a(o);var f=i.get(l),p=f.sine,y=f.cosine,x=i.get(o),w=x.sine,S=x.cosine;return p>=0&&w>=0?y<S?1:y>S?-1:0:p<0&&w<0?y<S?-1:y>S?1:0:w<p?-1:w>p?1:0}}}]),e}(),bW=0,Bb=function(){Rs(e,null,[{key:"compare",value:function(n,r){var i=n.leftSE.point.x,a=r.leftSE.point.x,l=n.rightSE.point.x,o=r.rightSE.point.x;if(o<i)return 1;if(l<a)return-1;var f=n.leftSE.point.y,p=r.leftSE.point.y,y=n.rightSE.point.y,x=r.rightSE.point.y;if(i<a){if(p<f&&p<y)return 1;if(p>f&&p>y)return-1;var w=n.comparePoint(r.leftSE.point);if(w<0)return 1;if(w>0)return-1;var S=r.comparePoint(n.rightSE.point);return S!==0?S:-1}if(i>a){if(f<p&&f<x)return-1;if(f>p&&f>x)return 1;var L=r.comparePoint(n.leftSE.point);if(L!==0)return L;var D=n.comparePoint(r.rightSE.point);return D<0?1:D>0?-1:1}if(f<p)return-1;if(f>p)return 1;if(l<o){var B=r.comparePoint(n.rightSE.point);if(B!==0)return B}if(l>o){var z=n.comparePoint(r.rightSE.point);if(z<0)return 1;if(z>0)return-1}if(l!==o){var M=y-f,k=l-i,V=x-p,q=o-a;if(M>k&&V<q)return 1;if(M<k&&V>q)return-1}return l>o?1:l<o||y<x?-1:y>x?1:n.id<r.id?-1:n.id>r.id?1:0}}]);function e(t,n,r,i){Cu(this,e),this.id=++bW,this.leftSE=t,t.segment=this,t.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=t,this.rings=r,this.windings=i}return Rs(e,[{key:"replaceRightSE",value:function(n){this.rightSE=n,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var n=this.leftSE.point.y,r=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:n<r?n:r},ur:{x:this.rightSE.point.x,y:n>r?n:r}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(n){return n.x===this.leftSE.point.x&&n.y===this.leftSE.point.y||n.x===this.rightSE.point.x&&n.y===this.rightSE.point.y}},{key:"comparePoint",value:function(n){if(this.isAnEndpoint(n))return 0;var r=this.leftSE.point,i=this.rightSE.point,a=this.vector();if(r.x===i.x)return n.x===r.x?0:n.x<r.x?1:-1;var l=(n.y-r.y)/a.y,o=r.x+l*a.x;if(n.x===o)return 0;var f=(n.x-r.x)/a.x,p=r.y+f*a.y;return n.y===p?0:n.y<p?-1:1}},{key:"getIntersection",value:function(n){var r=this.bbox(),i=n.bbox(),a=TI(r,i);if(a===null)return null;var l=this.leftSE.point,o=this.rightSE.point,f=n.leftSE.point,p=n.rightSE.point,y=P_(r,f)&&this.comparePoint(f)===0,x=P_(i,l)&&n.comparePoint(l)===0,w=P_(r,p)&&this.comparePoint(p)===0,S=P_(i,o)&&n.comparePoint(o)===0;if(x&&y)return S&&!w?o:!S&&w?p:null;if(x)return w&&l.x===p.x&&l.y===p.y?null:l;if(y)return S&&o.x===f.x&&o.y===f.y?null:f;if(S&&w)return null;if(S)return o;if(w)return p;var L=xW(l,this.vector(),f,n.vector());return L===null||!P_(a,L)?null:m0.round(L.x,L.y)}},{key:"split",value:function(n){var r=[],i=n.events!==void 0,a=new jc(n,!0),l=new jc(n,!1),o=this.rightSE;this.replaceRightSE(l),r.push(l),r.push(a);var f=new e(a,o,this.rings.slice(),this.windings.slice());return jc.comparePoints(f.leftSE.point,f.rightSE.point)>0&&f.swapEvents(),jc.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(a.checkForConsuming(),l.checkForConsuming()),r}},{key:"swapEvents",value:function(){var n=this.rightSE;this.rightSE=this.leftSE,this.leftSE=n,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var r=0,i=this.windings.length;r<i;r++)this.windings[r]*=-1}},{key:"consume",value:function(n){for(var r=this,i=n;r.consumedBy;)r=r.consumedBy;for(;i.consumedBy;)i=i.consumedBy;var a=e.compare(r,i);if(a!==0){if(a>0){var l=r;r=i,i=l}if(r.prev===i){var o=r;r=i,i=o}for(var f=0,p=i.rings.length;f<p;f++){var y=i.rings[f],x=i.windings[f],w=r.rings.indexOf(y);w===-1?(r.rings.push(y),r.windings.push(x)):r.windings[w]+=x}i.rings=null,i.windings=null,i.consumedBy=r,i.leftSE.consumedBy=r.leftSE,i.rightSE.consumedBy=r.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var n=this.prev.consumedBy||this.prev;this._beforeState=n.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var n=this.beforeState();this._afterState={rings:n.rings.slice(0),windings:n.windings.slice(0),multiPolys:[]};for(var r=this._afterState.rings,i=this._afterState.windings,a=this._afterState.multiPolys,l=0,o=this.rings.length;l<o;l++){var f=this.rings[l],p=this.windings[l],y=r.indexOf(f);y===-1?(r.push(f),i.push(p)):i[y]+=p}for(var x=[],w=[],S=0,L=r.length;S<L;S++)if(i[S]!==0){var D=r[S],B=D.poly;if(w.indexOf(B)===-1)if(D.isExterior)x.push(B);else{w.indexOf(B)===-1&&w.push(B);var z=x.indexOf(D.poly);z!==-1&&x.splice(z,1)}}for(var M=0,k=x.length;M<k;M++){var V=x[M].multiPoly;a.indexOf(V)===-1&&a.push(V)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var n=this.beforeState().multiPolys,r=this.afterState().multiPolys;switch(lc.type){case"union":{var i=n.length===0,a=r.length===0;this._isInResult=i!==a;break}case"intersection":{var l,o;n.length<r.length?(l=n.length,o=r.length):(l=r.length,o=n.length),this._isInResult=o===lc.numMultiPolys&&l<o;break}case"xor":{var f=Math.abs(n.length-r.length);this._isInResult=f%2===1;break}case"difference":{var p=function(x){return x.length===1&&x[0].isSubject};this._isInResult=p(n)!==p(r);break}default:throw new Error("Unrecognized operation type found ".concat(lc.type))}return this._isInResult}}],[{key:"fromRing",value:function(n,r,i){var a,l,o,f=jc.comparePoints(n,r);if(f<0)a=n,l=r,o=1;else if(f>0)a=r,l=n,o=-1;else throw new Error("Tried to create degenerate segment at [".concat(n.x,", ").concat(n.y,"]"));var p=new jc(a,!0),y=new jc(l,!1);return new e(p,y,[i],[o])}}]),e}(),HD=function(){function e(t,n,r){if(Cu(this,e),!Array.isArray(t)||t.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=r,this.segments=[],typeof t[0][0]!="number"||typeof t[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var i=m0.round(t[0][0],t[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};for(var a=i,l=1,o=t.length;l<o;l++){if(typeof t[l][0]!="number"||typeof t[l][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var f=m0.round(t[l][0],t[l][1]);f.x===a.x&&f.y===a.y||(this.segments.push(Bb.fromRing(a,f,this)),f.x<this.bbox.ll.x&&(this.bbox.ll.x=f.x),f.y<this.bbox.ll.y&&(this.bbox.ll.y=f.y),f.x>this.bbox.ur.x&&(this.bbox.ur.x=f.x),f.y>this.bbox.ur.y&&(this.bbox.ur.y=f.y),a=f)}(i.x!==a.x||i.y!==a.y)&&this.segments.push(Bb.fromRing(a,i,this))}return Rs(e,[{key:"getSweepEvents",value:function(){for(var n=[],r=0,i=this.segments.length;r<i;r++){var a=this.segments[r];n.push(a.leftSE),n.push(a.rightSE)}return n}}]),e}(),wW=function(){function e(t,n){if(Cu(this,e),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new HD(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var r=1,i=t.length;r<i;r++){var a=new HD(t[r],this,!1);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.interiorRings.push(a)}this.multiPoly=n}return Rs(e,[{key:"getSweepEvents",value:function(){for(var n=this.exteriorRing.getSweepEvents(),r=0,i=this.interiorRings.length;r<i;r++)for(var a=this.interiorRings[r].getSweepEvents(),l=0,o=a.length;l<o;l++)n.push(a[l]);return n}}]),e}(),YD=function(){function e(t,n){if(Cu(this,e),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof t[0][0][0]=="number"&&(t=[t])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var r=0,i=t.length;r<i;r++){var a=new wW(t[r],this);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.polys.push(a)}this.isSubject=n}return Rs(e,[{key:"getSweepEvents",value:function(){for(var n=[],r=0,i=this.polys.length;r<i;r++)for(var a=this.polys[r].getSweepEvents(),l=0,o=a.length;l<o;l++)n.push(a[l]);return n}}]),e}(),EW=function(){Rs(e,null,[{key:"factory",value:function(n){for(var r=[],i=0,a=n.length;i<a;i++){var l=n[i];if(!(!l.isInResult()||l.ringOut)){for(var o=null,f=l.leftSE,p=l.rightSE,y=[f],x=f.point,w=[];o=f,f=p,y.push(f),f.point!==x;)for(;;){var S=f.getAvailableLinkedEvents();if(S.length===0){var L=y[0].point,D=y[y.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(L.x,",")+" ".concat(L.y,"]. Last matching segment found ends at")+" [".concat(D.x,", ").concat(D.y,"]."))}if(S.length===1){p=S[0].otherSE;break}for(var B=null,z=0,M=w.length;z<M;z++)if(w[z].point===f.point){B=z;break}if(B!==null){var k=w.splice(B)[0],V=y.splice(k.index);V.unshift(V[0].otherSE),r.push(new e(V.reverse()));continue}w.push({index:y.length,point:f.point});var q=f.getLeftmostComparator(o);p=S.sort(q)[0].otherSE;break}r.push(new e(y))}}return r}}]);function e(t){Cu(this,e),this.events=t;for(var n=0,r=t.length;n<r;n++)t[n].segment.ringOut=this;this.poly=null}return Rs(e,[{key:"getGeom",value:function(){for(var n=this.events[0].point,r=[n],i=1,a=this.events.length-1;i<a;i++){var l=this.events[i].point,o=this.events[i+1].point;ZD(l,n,o)!==0&&(r.push(l),n=l)}if(r.length===1)return null;var f=r[0],p=r[1];ZD(f,n,p)===0&&r.shift(),r.push(r[0]);for(var y=this.isExteriorRing()?1:-1,x=this.isExteriorRing()?0:r.length-1,w=this.isExteriorRing()?r.length:-1,S=[],L=x;L!=w;L+=y)S.push([r[L].x,r[L].y]);return S}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var n=this.enclosingRing();this._isExteriorRing=n?!n.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var n=this.events[0],r=1,i=this.events.length;r<i;r++){var a=this.events[r];jc.compare(n,a)>0&&(n=a)}for(var l=n.segment.prevInResult(),o=l?l.prevInResult():null;;){if(!l)return null;if(!o)return l.ringOut;if(o.ringOut!==l.ringOut)return o.ringOut.enclosingRing()!==l.ringOut?l.ringOut:l.ringOut.enclosingRing();l=o.prevInResult(),o=l?l.prevInResult():null}}}]),e}(),KD=function(){function e(t){Cu(this,e),this.exteriorRing=t,t.poly=this,this.interiorRings=[]}return Rs(e,[{key:"addInterior",value:function(n){this.interiorRings.push(n),n.poly=this}},{key:"getGeom",value:function(){var n=[this.exteriorRing.getGeom()];if(n[0]===null)return null;for(var r=0,i=this.interiorRings.length;r<i;r++){var a=this.interiorRings[r].getGeom();a!==null&&n.push(a)}return n}}]),e}(),SW=function(){function e(t){Cu(this,e),this.rings=t,this.polys=this._composePolys(t)}return Rs(e,[{key:"getGeom",value:function(){for(var n=[],r=0,i=this.polys.length;r<i;r++){var a=this.polys[r].getGeom();a!==null&&n.push(a)}return n}},{key:"_composePolys",value:function(n){for(var r=[],i=0,a=n.length;i<a;i++){var l=n[i];if(!l.poly)if(l.isExteriorRing())r.push(new KD(l));else{var o=l.enclosingRing();o.poly||r.push(new KD(o)),o.poly.addInterior(l)}}return r}}]),e}(),TW=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bb.compare;Cu(this,e),this.queue=t,this.tree=new P2(n),this.segments=[]}return Rs(e,[{key:"process",value:function(n){var r=n.segment,i=[];if(n.consumedBy)return n.isLeft?this.queue.remove(n.otherSE):this.tree.remove(r),i;var a=n.isLeft?this.tree.insert(r):this.tree.find(r);if(!a)throw new Error("Unable to find segment #".concat(r.id," ")+"[".concat(r.leftSE.point.x,", ").concat(r.leftSE.point.y,"] -> ")+"[".concat(r.rightSE.point.x,", ").concat(r.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var l=a,o=a,f=void 0,p=void 0;f===void 0;)l=this.tree.prev(l),l===null?f=null:l.key.consumedBy===void 0&&(f=l.key);for(;p===void 0;)o=this.tree.next(o),o===null?p=null:o.key.consumedBy===void 0&&(p=o.key);if(n.isLeft){var y=null;if(f){var x=f.getIntersection(r);if(x!==null&&(r.isAnEndpoint(x)||(y=x),!f.isAnEndpoint(x)))for(var w=this._splitSafely(f,x),S=0,L=w.length;S<L;S++)i.push(w[S])}var D=null;if(p){var B=p.getIntersection(r);if(B!==null&&(r.isAnEndpoint(B)||(D=B),!p.isAnEndpoint(B)))for(var z=this._splitSafely(p,B),M=0,k=z.length;M<k;M++)i.push(z[M])}if(y!==null||D!==null){var V=null;if(y===null)V=D;else if(D===null)V=y;else{var q=jc.comparePoints(y,D);V=q<=0?y:D}this.queue.remove(r.rightSE),i.push(r.rightSE);for(var Y=r.split(V),K=0,X=Y.length;K<X;K++)i.push(Y[K])}i.length>0?(this.tree.remove(r),i.push(n)):(this.segments.push(r),r.prev=f)}else{if(f&&p){var U=f.getIntersection(p);if(U!==null){if(!f.isAnEndpoint(U))for(var le=this._splitSafely(f,U),ue=0,ae=le.length;ue<ae;ue++)i.push(le[ue]);if(!p.isAnEndpoint(U))for(var ve=this._splitSafely(p,U),Ee=0,He=ve.length;Ee<He;Ee++)i.push(ve[Ee])}}this.tree.remove(r)}return i}},{key:"_splitSafely",value:function(n,r){this.tree.remove(n);var i=n.rightSE;this.queue.remove(i);var a=n.split(r);return a.push(i),n.consumedBy===void 0&&this.tree.insert(n),a}}]),e}(),JD=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,IW=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,CW=function(){function e(){Cu(this,e)}return Rs(e,[{key:"run",value:function(n,r,i){lc.type=n,m0.reset();for(var a=[new YD(r,!0)],l=0,o=i.length;l<o;l++)a.push(new YD(i[l],!1));if(lc.numMultiPolys=a.length,lc.type==="difference")for(var f=a[0],p=1;p<a.length;)TI(a[p].bbox,f.bbox)!==null?p++:a.splice(p,1);if(lc.type==="intersection"){for(var y=0,x=a.length;y<x;y++)for(var w=a[y],S=y+1,L=a.length;S<L;S++)if(TI(w.bbox,a[S].bbox)===null)return[]}for(var D=new P2(jc.compare),B=0,z=a.length;B<z;B++)for(var M=a[B].getSweepEvents(),k=0,V=M.length;k<V;k++)if(D.insert(M[k]),D.size>JD)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var q=new TW(D),Y=D.size,K=D.pop();K;){var X=K.key;if(D.size===Y){var U=X.segment;throw new Error("Unable to pop() ".concat(X.isLeft?"left":"right"," SweepEvent ")+"[".concat(X.point.x,", ").concat(X.point.y,"] from segment #").concat(U.id," ")+"[".concat(U.leftSE.point.x,", ").concat(U.leftSE.point.y,"] -> ")+"[".concat(U.rightSE.point.x,", ").concat(U.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(D.size>JD)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(q.segments.length>IW)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var le=q.process(X),ue=0,ae=le.length;ue<ae;ue++){var ve=le[ue];ve.consumedBy===void 0&&D.insert(ve)}Y=D.size,K=D.pop()}m0.reset();var Ee=EW.factory(q.segments),He=new SW(Ee);return He.getGeom()}}]),e}(),lc=new CW,PW=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return lc.run("union",t,r)},AW=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return lc.run("intersection",t,r)},MW=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return lc.run("xor",t,r)},LW=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return lc.run("difference",t,r)},OW={union:PW,intersection:AW,xor:MW,difference:LW};const Bh=OW;function DW(e,t){var n=Oi(e),r=Oi(t),i=e.properties||{},a=Bh.difference(n.coordinates,r.coordinates);return a.length===0?null:a.length===1?fr(a[0],i):al(a,i)}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var n=Object(this),r=Math.max(Math.min(n.length,9007199254740991),0)||0,i=1 in arguments&&parseInt(Number(arguments[1]),10)||0;i=i<0?Math.max(r+i,0):Math.min(i,r);var a=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:r;for(a=a<0?Math.max(r+arguments[2],0):Math.min(a,r);i<a;)n[i]=t,++i;return n},writable:!0});Number.isFinite=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)};Number.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};Number.parseFloat=Number.parseFloat||parseFloat;Number.isNaN=Number.isNaN||function(e){return e!==e};Math.trunc=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};var Gp=function(){};Gp.prototype.interfaces_=function(){return[]};Gp.prototype.getClass=function(){return Gp};Gp.prototype.equalsWithTolerance=function(t,n,r){return Math.abs(t-n)<=r};var Ui=function(e){function t(n){e.call(this,n),this.name="IllegalArgumentException",this.message=n,this.stack=new e().stack}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),Nn=function(){},R4={MAX_VALUE:{configurable:!0}};Nn.isNaN=function(t){return Number.isNaN(t)};Nn.doubleToLongBits=function(t){return t};Nn.longBitsToDouble=function(t){return t};Nn.isInfinite=function(t){return!Number.isFinite(t)};R4.MAX_VALUE.get=function(){return Number.MAX_VALUE};Object.defineProperties(Nn,R4);var fl=function(){},Dw=function(){},Km=function(){};function dl(){}var $e=function e(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=e.NULL_ORDINATE;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.z=t.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=e.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},sg={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};$e.prototype.setOrdinate=function(t,n){switch(t){case $e.X:this.x=n;break;case $e.Y:this.y=n;break;case $e.Z:this.z=n;break;default:throw new Ui("Invalid ordinate index: "+t)}};$e.prototype.equals2D=function(){if(arguments.length===1){var t=arguments[0];return!(this.x!==t.x||this.y!==t.y)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return!(!Gp.equalsWithTolerance(this.x,n.x,r)||!Gp.equalsWithTolerance(this.y,n.y,r))}};$e.prototype.getOrdinate=function(t){switch(t){case $e.X:return this.x;case $e.Y:return this.y;case $e.Z:return this.z}throw new Ui("Invalid ordinate index: "+t)};$e.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||Nn.isNaN(this.z))&&Nn.isNaN(t.z)};$e.prototype.equals=function(t){return t instanceof $e?this.equals2D(t):!1};$e.prototype.equalInZ=function(t,n){return Gp.equalsWithTolerance(this.z,t.z,n)};$e.prototype.compareTo=function(t){var n=t;return this.x<n.x?-1:this.x>n.x?1:this.y<n.y?-1:this.y>n.y?1:0};$e.prototype.clone=function(){};$e.prototype.copy=function(){return new $e(this)};$e.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};$e.prototype.distance3D=function(t){var n=this.x-t.x,r=this.y-t.y,i=this.z-t.z;return Math.sqrt(n*n+r*r+i*i)};$e.prototype.distance=function(t){var n=this.x-t.x,r=this.y-t.y;return Math.sqrt(n*n+r*r)};$e.prototype.hashCode=function(){var t=17;return t=37*t+$e.hashCode(this.x),t=37*t+$e.hashCode(this.y),t};$e.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z};$e.prototype.interfaces_=function(){return[fl,Dw,dl]};$e.prototype.getClass=function(){return $e};$e.hashCode=function(){if(arguments.length===1){var t=arguments[0],n=Nn.doubleToLongBits(t);return Math.trunc((n^n)>>>32)}};sg.DimensionalComparator.get=function(){return Nh};sg.serialVersionUID.get=function(){return 6683108902428367e3};sg.NULL_ORDINATE.get=function(){return Nn.NaN};sg.X.get=function(){return 0};sg.Y.get=function(){return 1};sg.Z.get=function(){return 2};Object.defineProperties($e,sg);var Nh=function(t){if(this._dimensionsToTest=2,arguments.length!==0){if(arguments.length===1){var n=arguments[0];if(n!==2&&n!==3)throw new Ui("only 2 or 3 dimensions may be specified");this._dimensionsToTest=n}}};Nh.prototype.compare=function(t,n){var r=t,i=n,a=Nh.compare(r.x,i.x);if(a!==0)return a;var l=Nh.compare(r.y,i.y);if(l!==0)return l;if(this._dimensionsToTest<=2)return 0;var o=Nh.compare(r.z,i.z);return o};Nh.prototype.interfaces_=function(){return[Km]};Nh.prototype.getClass=function(){return Nh};Nh.compare=function(t,n){return t<n?-1:t>n?1:Nn.isNaN(t)?Nn.isNaN(n)?0:-1:Nn.isNaN(n)?1:0};var Jm=function(){};Jm.prototype.create=function(){};Jm.prototype.interfaces_=function(){return[]};Jm.prototype.getClass=function(){return Jm};var tt=function(){},X0={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};tt.prototype.interfaces_=function(){return[]};tt.prototype.getClass=function(){return tt};tt.toLocationSymbol=function(t){switch(t){case tt.EXTERIOR:return"e";case tt.BOUNDARY:return"b";case tt.INTERIOR:return"i";case tt.NONE:return"-"}throw new Ui("Unknown location value: "+t)};X0.INTERIOR.get=function(){return 0};X0.BOUNDARY.get=function(){return 1};X0.EXTERIOR.get=function(){return 2};X0.NONE.get=function(){return-1};Object.defineProperties(tt,X0);var Pn=function(e,t){return e.interfaces_&&e.interfaces_().indexOf(t)>-1},ks=function(){},k4={LOG_10:{configurable:!0}};ks.prototype.interfaces_=function(){return[]};ks.prototype.getClass=function(){return ks};ks.log10=function(t){var n=Math.log(t);return Nn.isInfinite(n)||Nn.isNaN(n)?n:n/ks.LOG_10};ks.min=function(t,n,r,i){var a=t;return n<a&&(a=n),r<a&&(a=r),i<a&&(a=i),a};ks.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1],r=arguments[2];return t<n?n:t>r?r:t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],a=arguments[1],l=arguments[2];return i<a?a:i>l?l:i}};ks.wrap=function(t,n){return t<0?n- -t%n:t%n};ks.max=function(){if(arguments.length===3){var t=arguments[0],n=arguments[1],r=arguments[2],i=t;return n>i&&(i=n),r>i&&(i=r),i}else if(arguments.length===4){var a=arguments[0],l=arguments[1],o=arguments[2],f=arguments[3],p=a;return l>p&&(p=l),o>p&&(p=o),f>p&&(p=f),p}};ks.average=function(t,n){return(t+n)/2};k4.LOG_10.get=function(){return Math.log(10)};Object.defineProperties(ks,k4);var Pu=function(t){this.str=t};Pu.prototype.append=function(t){this.str+=t};Pu.prototype.setCharAt=function(t,n){this.str=this.str.substr(0,t)+n+this.str.substr(t+1)};Pu.prototype.toString=function(t){return this.str};var mu=function(t){this.value=t};mu.prototype.intValue=function(){return this.value};mu.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0};mu.isNaN=function(t){return Number.isNaN(t)};var y0=function(){};y0.isWhitespace=function(t){return t<=32&&t>=0||t===127};y0.toUpperCase=function(t){return t.toUpperCase()};var at=function e(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof e){var n=arguments[0];this.init(n)}else if(typeof arguments[0]=="string"){var r=arguments[0];e.call(this,e.parse(r))}}else if(arguments.length===2){var i=arguments[0],a=arguments[1];this.init(i,a)}},Bl={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};at.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo};at.prototype.extractSignificantDigits=function(t,n){var r=this.abs(),i=at.magnitude(r._hi),a=at.TEN.pow(i);r=r.divide(a),r.gt(at.TEN)?(r=r.divide(at.TEN),i+=1):r.lt(at.ONE)&&(r=r.multiply(at.TEN),i-=1);for(var l=i+1,o=new Pu,f=at.MAX_PRINT_DIGITS-1,p=0;p<=f;p++){t&&p===l&&o.append(".");var y=Math.trunc(r._hi);if(y<0)break;var x=!1,w=0;y>9?(x=!0,w="9"):w="0"+y,o.append(w),r=r.subtract(at.valueOf(y)).multiply(at.TEN),x&&r.selfAdd(at.TEN);var S=!0,L=at.magnitude(r._hi);if(L<0&&Math.abs(L)>=f-p&&(S=!1),!S)break}return n[0]=i,o.toString()};at.prototype.sqr=function(){return this.multiply(this)};at.prototype.doubleValue=function(){return this._hi+this._lo};at.prototype.subtract=function(){if(arguments[0]instanceof at){var t=arguments[0];return this.add(t.negate())}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.add(-n)}};at.prototype.equals=function(){if(arguments.length===1){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}};at.prototype.isZero=function(){return this._hi===0&&this._lo===0};at.prototype.selfSubtract=function(){if(arguments[0]instanceof at){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.isNaN()?this:this.selfAdd(-n,0)}};at.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null};at.prototype.min=function(t){return this.le(t)?this:t};at.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof at){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfDivide(n,0)}}else if(arguments.length===2){var r=arguments[0],i=arguments[1],a=null,l=null,o=null,f=null,p=null,y=null,x=null,w=null;return p=this._hi/r,y=at.SPLIT*p,a=y-p,w=at.SPLIT*r,a=y-a,l=p-a,o=w-r,x=p*r,o=w-o,f=r-o,w=a*o-x+a*f+l*o+l*f,y=(this._hi-x-w+this._lo-p*i)/r,w=p+y,this._hi=w,this._lo=p-w+y,this}};at.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"};at.prototype.divide=function(){if(arguments[0]instanceof at){var t=arguments[0],n=null,r=null,i=null,a=null,l=null,o=null,f=null,p=null;l=this._hi/t._hi,o=at.SPLIT*l,n=o-l,p=at.SPLIT*t._hi,n=o-n,r=l-n,i=p-t._hi,f=l*t._hi,i=p-i,a=t._hi-i,p=n*i-f+n*a+r*i+r*a,o=(this._hi-f-p+this._lo-l*t._lo)/t._hi,p=l+o;var y=p,x=l-p+o;return new at(y,x)}else if(typeof arguments[0]=="number"){var w=arguments[0];return Nn.isNaN(w)?at.createNaN():at.copy(this).selfDivide(w,0)}};at.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo};at.prototype.pow=function(t){if(t===0)return at.valueOf(1);var n=new at(this),r=at.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2===1&&r.selfMultiply(n),i/=2,i>0&&(n=n.sqr());else r=n;return t<0?r.reciprocal():r};at.prototype.ceil=function(){if(this.isNaN())return at.NaN;var t=Math.ceil(this._hi),n=0;return t===this._hi&&(n=Math.ceil(this._lo)),new at(t,n)};at.prototype.compareTo=function(t){var n=t;return this._hi<n._hi?-1:this._hi>n._hi?1:this._lo<n._lo?-1:this._lo>n._lo?1:0};at.prototype.rint=function(){if(this.isNaN())return this;var t=this.add(.5);return t.floor()};at.prototype.setValue=function(){if(arguments[0]instanceof at){var t=arguments[0];return this.init(t),this}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.init(n),this}};at.prototype.max=function(t){return this.ge(t)?this:t};at.prototype.sqrt=function(){if(this.isZero())return at.valueOf(0);if(this.isNegative())return at.NaN;var t=1/Math.sqrt(this._hi),n=this._hi*t,r=at.valueOf(n),i=this.subtract(r.sqr()),a=i._hi*(t*.5);return r.add(a)};at.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof at){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0],r=null,i=null,a=null,l=null,o=null,f=null;return a=this._hi+n,o=a-this._hi,l=a-o,l=n-o+(this._hi-l),f=l+this._lo,r=a+f,i=f+(a-r),this._hi=r+i,this._lo=i+(r-this._hi),this}}else if(arguments.length===2){var p=arguments[0],y=arguments[1],x=null,w=null,S=null,L=null,D=null,B=null,z=null,M=null;D=this._hi+p,S=this._lo+y,z=D-this._hi,M=S-this._lo,B=D-z,L=S-M,B=p-z+(this._hi-B),L=y-M+(this._lo-L),z=B+S,x=D+z,w=z+(D-x),z=L+w;var k=x+z,V=z+(x-k);return this._hi=k,this._lo=V,this}};at.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof at){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfMultiply(n,0)}}else if(arguments.length===2){var r=arguments[0],i=arguments[1],a=null,l=null,o=null,f=null,p=null,y=null;p=at.SPLIT*this._hi,a=p-this._hi,y=at.SPLIT*r,a=p-a,l=this._hi-a,o=y-r,p=this._hi*r,o=y-o,f=r-o,y=a*o-p+a*f+l*o+l*f+(this._hi*i+this._lo*r);var x=p+y;a=p-x;var w=y+a;return this._hi=x,this._lo=w,this}};at.prototype.selfSqr=function(){return this.selfMultiply(this)};at.prototype.floor=function(){if(this.isNaN())return at.NaN;var t=Math.floor(this._hi),n=0;return t===this._hi&&(n=Math.floor(this._lo)),new at(t,n)};at.prototype.negate=function(){return this.isNaN()?this:new at(-this._hi,-this._lo)};at.prototype.clone=function(){};at.prototype.multiply=function(){if(arguments[0]instanceof at){var t=arguments[0];return t.isNaN()?at.createNaN():at.copy(this).selfMultiply(t)}else if(typeof arguments[0]=="number"){var n=arguments[0];return Nn.isNaN(n)?at.createNaN():at.copy(this).selfMultiply(n,0)}};at.prototype.isNaN=function(){return Nn.isNaN(this._hi)};at.prototype.intValue=function(){return Math.trunc(this._hi)};at.prototype.toString=function(){var t=at.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()};at.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(t!==null)return t;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!0,n),i=n[0]+1,a=r;if(r.charAt(0)===".")a="0"+r;else if(i<0)a="0."+at.stringOfChar("0",-i)+r;else if(r.indexOf(".")===-1){var l=i-r.length,o=at.stringOfChar("0",l);a=r+o+".0"}return this.isNegative()?"-"+a:a};at.prototype.reciprocal=function(){var t=null,n=null,r=null,i=null,a=null,l=null,o=null,f=null;a=1/this._hi,l=at.SPLIT*a,t=l-a,f=at.SPLIT*this._hi,t=l-t,n=a-t,r=f-this._hi,o=a*this._hi,r=f-r,i=this._hi-r,f=t*r-o+t*i+n*r+n*i,l=(1-o-f-a*this._lo)/this._hi;var p=a+l,y=a-p+l;return new at(p,y)};at.prototype.toSciNotation=function(){if(this.isZero())return at.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(t!==null)return t;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!1,n),i=at.SCI_NOT_EXPONENT_CHAR+n[0];if(r.charAt(0)==="0")throw new Error("Found leading zero: "+r);var a="";r.length>1&&(a=r.substring(1));var l=r.charAt(0)+"."+a;return this.isNegative()?"-"+l+i:l+i};at.prototype.abs=function(){return this.isNaN()?at.NaN:this.isNegative()?this.negate():new at(this)};at.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0};at.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo};at.prototype.add=function(){if(arguments[0]instanceof at){var t=arguments[0];return at.copy(this).selfAdd(t)}else if(typeof arguments[0]=="number"){var n=arguments[0];return at.copy(this).selfAdd(n)}};at.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof at){var n=arguments[0];this._hi=n._hi,this._lo=n._lo}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];this._hi=r,this._lo=i}};at.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo};at.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0};at.prototype.trunc=function(){return this.isNaN()?at.NaN:this.isPositive()?this.floor():this.ceil()};at.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0};at.prototype.interfaces_=function(){return[dl,fl,Dw]};at.prototype.getClass=function(){return at};at.sqr=function(t){return at.valueOf(t).selfMultiply(t)};at.valueOf=function(){if(typeof arguments[0]=="string"){var t=arguments[0];return at.parse(t)}else if(typeof arguments[0]=="number"){var n=arguments[0];return new at(n)}};at.sqrt=function(t){return at.valueOf(t).sqrt()};at.parse=function(t){for(var n=0,r=t.length;y0.isWhitespace(t.charAt(n));)n++;var i=!1;if(n<r){var a=t.charAt(n);(a==="-"||a==="+")&&(n++,a==="-"&&(i=!0))}for(var l=new at,o=0,f=0,p=0;!(n>=r);){var y=t.charAt(n);if(n++,y0.isDigit(y)){var x=y-"0";l.selfMultiply(at.TEN),l.selfAdd(x),o++;continue}if(y==="."){f=o;continue}if(y==="e"||y==="E"){var w=t.substring(n);try{p=mu.parseInt(w)}catch(z){throw z instanceof Error?new Error("Invalid exponent "+w+" in string "+t):z}finally{}break}throw new Error("Unexpected character '"+y+"' at position "+n+" in string "+t)}var S=l,L=o-f-p;if(L===0)S=l;else if(L>0){var D=at.TEN.pow(L);S=l.divide(D)}else if(L<0){var B=at.TEN.pow(-L);S=l.multiply(B)}return i?S.negate():S};at.createNaN=function(){return new at(Nn.NaN,Nn.NaN)};at.copy=function(t){return new at(t)};at.magnitude=function(t){var n=Math.abs(t),r=Math.log(n)/Math.log(10),i=Math.trunc(Math.floor(r)),a=Math.pow(10,i);return a*10<=n&&(i+=1),i};at.stringOfChar=function(t,n){for(var r=new Pu,i=0;i<n;i++)r.append(t);return r.toString()};Bl.PI.get=function(){return new at(3.141592653589793,12246467991473532e-32)};Bl.TWO_PI.get=function(){return new at(6.283185307179586,24492935982947064e-32)};Bl.PI_2.get=function(){return new at(1.5707963267948966,6123233995736766e-32)};Bl.E.get=function(){return new at(2.718281828459045,14456468917292502e-32)};Bl.NaN.get=function(){return new at(Nn.NaN,Nn.NaN)};Bl.EPS.get=function(){return 123259516440783e-46};Bl.SPLIT.get=function(){return 134217729};Bl.MAX_PRINT_DIGITS.get=function(){return 32};Bl.TEN.get=function(){return at.valueOf(10)};Bl.ONE.get=function(){return at.valueOf(1)};Bl.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"};Bl.SCI_NOT_ZERO.get=function(){return"0.0E0"};Object.defineProperties(at,Bl);var Ka=function(){},N4={DP_SAFE_EPSILON:{configurable:!0}};Ka.prototype.interfaces_=function(){return[]};Ka.prototype.getClass=function(){return Ka};Ka.orientationIndex=function(t,n,r){var i=Ka.orientationIndexFilter(t,n,r);if(i<=1)return i;var a=at.valueOf(n.x).selfAdd(-t.x),l=at.valueOf(n.y).selfAdd(-t.y),o=at.valueOf(r.x).selfAdd(-n.x),f=at.valueOf(r.y).selfAdd(-n.y);return a.selfMultiply(f).selfSubtract(l.selfMultiply(o)).signum()};Ka.signOfDet2x2=function(t,n,r,i){var a=t.multiply(i).selfSubtract(n.multiply(r));return a.signum()};Ka.intersection=function(t,n,r,i){var a=at.valueOf(i.y).selfSubtract(r.y).selfMultiply(at.valueOf(n.x).selfSubtract(t.x)),l=at.valueOf(i.x).selfSubtract(r.x).selfMultiply(at.valueOf(n.y).selfSubtract(t.y)),o=a.subtract(l),f=at.valueOf(i.x).selfSubtract(r.x).selfMultiply(at.valueOf(t.y).selfSubtract(r.y)),p=at.valueOf(i.y).selfSubtract(r.y).selfMultiply(at.valueOf(t.x).selfSubtract(r.x)),y=f.subtract(p),x=y.selfDivide(o).doubleValue(),w=at.valueOf(t.x).selfAdd(at.valueOf(n.x).selfSubtract(t.x).selfMultiply(x)).doubleValue(),S=at.valueOf(n.x).selfSubtract(t.x).selfMultiply(at.valueOf(t.y).selfSubtract(r.y)),L=at.valueOf(n.y).selfSubtract(t.y).selfMultiply(at.valueOf(t.x).selfSubtract(r.x)),D=S.subtract(L),B=D.selfDivide(o).doubleValue(),z=at.valueOf(r.y).selfAdd(at.valueOf(i.y).selfSubtract(r.y).selfMultiply(B)).doubleValue();return new $e(w,z)};Ka.orientationIndexFilter=function(t,n,r){var i=null,a=(t.x-r.x)*(n.y-r.y),l=(t.y-r.y)*(n.x-r.x),o=a-l;if(a>0){if(l<=0)return Ka.signum(o);i=a+l}else if(a<0){if(l>=0)return Ka.signum(o);i=-a-l}else return Ka.signum(o);var f=Ka.DP_SAFE_EPSILON*i;return o>=f||-o>=f?Ka.signum(o):2};Ka.signum=function(t){return t>0?1:t<0?-1:0};N4.DP_SAFE_EPSILON.get=function(){return 1e-15};Object.defineProperties(Ka,N4);var pr=function(){},W0={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};W0.X.get=function(){return 0};W0.Y.get=function(){return 1};W0.Z.get=function(){return 2};W0.M.get=function(){return 3};pr.prototype.setOrdinate=function(t,n,r){};pr.prototype.size=function(){};pr.prototype.getOrdinate=function(t,n){};pr.prototype.getCoordinate=function(){};pr.prototype.getCoordinateCopy=function(t){};pr.prototype.getDimension=function(){};pr.prototype.getX=function(t){};pr.prototype.clone=function(){};pr.prototype.expandEnvelope=function(t){};pr.prototype.copy=function(){};pr.prototype.getY=function(t){};pr.prototype.toCoordinateArray=function(){};pr.prototype.interfaces_=function(){return[Dw]};pr.prototype.getClass=function(){return pr};Object.defineProperties(pr,W0);var F4=function(){},Iy=function(e){function t(){e.call(this,"Projective point not representable on the Cartesian plane.")}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(F4),la=function(){};la.arraycopy=function(t,n,r,i,a){for(var l=0,o=n;o<n+a;o++)r[i+l]=t[o],l++};la.getProperty=function(t){return{"line.separator":`
`}[t]};var Il=function e(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var n=arguments[0],r=arguments[1];this.x=n,this.y=r,this.w=1}else if(arguments[0]instanceof e&&arguments[1]instanceof e){var i=arguments[0],a=arguments[1];this.x=i.y*a.w-a.y*i.w,this.y=a.x*i.w-i.x*a.w,this.w=i.x*a.y-a.x*i.y}else if(arguments[0]instanceof $e&&arguments[1]instanceof $e){var l=arguments[0],o=arguments[1];this.x=l.y-o.y,this.y=o.x-l.x,this.w=l.x*o.y-o.x*l.y}}else if(arguments.length===3){var f=arguments[0],p=arguments[1],y=arguments[2];this.x=f,this.y=p,this.w=y}else if(arguments.length===4){var x=arguments[0],w=arguments[1],S=arguments[2],L=arguments[3],D=x.y-w.y,B=w.x-x.x,z=x.x*w.y-w.x*x.y,M=S.y-L.y,k=L.x-S.x,V=S.x*L.y-L.x*S.y;this.x=B*V-k*z,this.y=M*z-D*V,this.w=D*k-M*B}};Il.prototype.getY=function(){var t=this.y/this.w;if(Nn.isNaN(t)||Nn.isInfinite(t))throw new Iy;return t};Il.prototype.getX=function(){var t=this.x/this.w;if(Nn.isNaN(t)||Nn.isInfinite(t))throw new Iy;return t};Il.prototype.getCoordinate=function(){var t=new $e;return t.x=this.getX(),t.y=this.getY(),t};Il.prototype.interfaces_=function(){return[]};Il.prototype.getClass=function(){return Il};Il.intersection=function(t,n,r,i){var a=t.y-n.y,l=n.x-t.x,o=t.x*n.y-n.x*t.y,f=r.y-i.y,p=i.x-r.x,y=r.x*i.y-i.x*r.y,x=l*y-p*o,w=f*o-a*y,S=a*p-f*l,L=x/S,D=w/S;if(Nn.isNaN(L)||Nn.isInfinite(L)||Nn.isNaN(D)||Nn.isInfinite(D))throw new Iy;return new $e(L,D)};var _n=function e(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof $e){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof e){var n=arguments[0];this.init(n)}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];this.init(r.x,i.x,r.y,i.y)}else if(arguments.length===4){var a=arguments[0],l=arguments[1],o=arguments[2],f=arguments[3];this.init(a,l,o,f)}},B4={serialVersionUID:{configurable:!0}};_n.prototype.getArea=function(){return this.getWidth()*this.getHeight()};_n.prototype.equals=function(t){if(!(t instanceof _n))return!1;var n=t;return this.isNull()?n.isNull():this._maxx===n.getMaxX()&&this._maxy===n.getMaxY()&&this._minx===n.getMinX()&&this._miny===n.getMinY()};_n.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new _n;var n=this._minx>t._minx?this._minx:t._minx,r=this._miny>t._miny?this._miny:t._miny,i=this._maxx<t._maxx?this._maxx:t._maxx,a=this._maxy<t._maxy?this._maxy:t._maxy;return new _n(n,i,r,a)};_n.prototype.isNull=function(){return this._maxx<this._minx};_n.prototype.getMaxX=function(){return this._maxx};_n.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof $e){var t=arguments[0];return this.covers(t.x,t.y)}else if(arguments[0]instanceof _n){var n=arguments[0];return this.isNull()||n.isNull()?!1:n.getMinX()>=this._minx&&n.getMaxX()<=this._maxx&&n.getMinY()>=this._miny&&n.getMaxY()<=this._maxy}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];return this.isNull()?!1:r>=this._minx&&r<=this._maxx&&i>=this._miny&&i<=this._maxy}};_n.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof _n){var t=arguments[0];return this.isNull()||t.isNull()?!1:!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}else if(arguments[0]instanceof $e){var n=arguments[0];return this.intersects(n.x,n.y)}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];return this.isNull()?!1:!(r>this._maxx||r<this._minx||i>this._maxy||i<this._miny)}};_n.prototype.getMinY=function(){return this._miny};_n.prototype.getMinX=function(){return this._minx};_n.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof $e){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof _n){var n=arguments[0];if(n.isNull())return null;this.isNull()?(this._minx=n.getMinX(),this._maxx=n.getMaxX(),this._miny=n.getMinY(),this._maxy=n.getMaxY()):(n._minx<this._minx&&(this._minx=n._minx),n._maxx>this._maxx&&(this._maxx=n._maxx),n._miny<this._miny&&(this._miny=n._miny),n._maxy>this._maxy&&(this._maxy=n._maxy))}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];this.isNull()?(this._minx=r,this._maxx=r,this._miny=i,this._maxy=i):(r<this._minx&&(this._minx=r),r>this._maxx&&(this._maxx=r),i<this._miny&&(this._miny=i),i>this._maxy&&(this._maxy=i))}};_n.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),n=this.getHeight();return t<n?t:n};_n.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx};_n.prototype.compareTo=function(t){var n=t;return this.isNull()?n.isNull()?0:-1:n.isNull()?1:this._minx<n._minx?-1:this._minx>n._minx?1:this._miny<n._miny?-1:this._miny>n._miny?1:this._maxx<n._maxx?-1:this._maxx>n._maxx?1:this._maxy<n._maxy?-1:this._maxy>n._maxy?1:0};_n.prototype.translate=function(t,n){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+n,this.getMaxY()+n)};_n.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"};_n.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1};_n.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny};_n.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),n=this.getHeight();return t>n?t:n};_n.prototype.expandBy=function(){if(arguments.length===1){var t=arguments[0];this.expandBy(t,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this.isNull())return null;this._minx-=n,this._maxx+=n,this._miny-=r,this._maxy+=r,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}};_n.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof _n){var t=arguments[0];return this.covers(t)}else if(arguments[0]instanceof $e){var n=arguments[0];return this.covers(n)}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];return this.covers(r,i)}};_n.prototype.centre=function(){return this.isNull()?null:new $e((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)};_n.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof $e){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof _n){var n=arguments[0];this._minx=n._minx,this._maxx=n._maxx,this._miny=n._miny,this._maxy=n._maxy}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];this.init(r.x,i.x,r.y,i.y)}else if(arguments.length===4){var a=arguments[0],l=arguments[1],o=arguments[2],f=arguments[3];a<l?(this._minx=a,this._maxx=l):(this._minx=l,this._maxx=a),o<f?(this._miny=o,this._maxy=f):(this._miny=f,this._maxy=o)}};_n.prototype.getMaxY=function(){return this._maxy};_n.prototype.distance=function(t){if(this.intersects(t))return 0;var n=0;this._maxx<t._minx?n=t._minx-this._maxx:this._minx>t._maxx&&(n=this._minx-t._maxx);var r=0;return this._maxy<t._miny?r=t._miny-this._maxy:this._miny>t._maxy&&(r=this._miny-t._maxy),n===0?r:r===0?n:Math.sqrt(n*n+r*r)};_n.prototype.hashCode=function(){var t=17;return t=37*t+$e.hashCode(this._minx),t=37*t+$e.hashCode(this._maxx),t=37*t+$e.hashCode(this._miny),t=37*t+$e.hashCode(this._maxy),t};_n.prototype.interfaces_=function(){return[fl,dl]};_n.prototype.getClass=function(){return _n};_n.intersects=function(){if(arguments.length===3){var t=arguments[0],n=arguments[1],r=arguments[2];return r.x>=(t.x<n.x?t.x:n.x)&&r.x<=(t.x>n.x?t.x:n.x)&&r.y>=(t.y<n.y?t.y:n.y)&&r.y<=(t.y>n.y?t.y:n.y)}else if(arguments.length===4){var i=arguments[0],a=arguments[1],l=arguments[2],o=arguments[3],f=Math.min(l.x,o.x),p=Math.max(l.x,o.x),y=Math.min(i.x,a.x),x=Math.max(i.x,a.x);return!(y>p||x<f||(f=Math.min(l.y,o.y),p=Math.max(l.y,o.y),y=Math.min(i.y,a.y),x=Math.max(i.y,a.y),y>p)||x<f)}};B4.serialVersionUID.get=function(){return 5873921885273102e3};Object.defineProperties(_n,B4);var ru={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Rw=function(t){this.geometryFactory=t||new rr};Rw.prototype.read=function(t){var n,r,i;t=t.replace(/[\n\r]/g," ");var a=ru.typeStr.exec(t);if(t.search("EMPTY")!==-1&&(a=ru.emptyTypeStr.exec(t),a[2]=void 0),a&&(r=a[1].toLowerCase(),i=a[2],km[r]&&(n=km[r].apply(this,[i]))),n===void 0)throw new Error("Could not parse WKT "+t);return n};Rw.prototype.write=function(t){return this.extractGeometry(t)};Rw.prototype.extractGeometry=function(t){var n=t.getGeometryType().toLowerCase();if(!Gc[n])return null;var r=n.toUpperCase(),i;return t.isEmpty()?i=r+" EMPTY":i=r+"("+Gc[n].apply(this,[t])+")",i};var Gc={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Gc.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var n=this,r=[],i=0,a=t._geometries.length;i<a;++i)r.push("("+Gc.point.apply(n,[t._geometries[i]])+")");return r.join(",")},linestring:function(t){for(var n=this,r=[],i=0,a=t._points._coordinates.length;i<a;++i)r.push(Gc.coordinate.apply(n,[t._points._coordinates[i]]));return r.join(",")},linearring:function(t){for(var n=this,r=[],i=0,a=t._points._coordinates.length;i<a;++i)r.push(Gc.coordinate.apply(n,[t._points._coordinates[i]]));return r.join(",")},multilinestring:function(t){for(var n=this,r=[],i=0,a=t._geometries.length;i<a;++i)r.push("("+Gc.linestring.apply(n,[t._geometries[i]])+")");return r.join(",")},polygon:function(t){var n=this,r=[];r.push("("+Gc.linestring.apply(this,[t._shell])+")");for(var i=0,a=t._holes.length;i<a;++i)r.push("("+Gc.linestring.apply(n,[t._holes[i]])+")");return r.join(",")},multipolygon:function(t){for(var n=this,r=[],i=0,a=t._geometries.length;i<a;++i)r.push("("+Gc.polygon.apply(n,[t._geometries[i]])+")");return r.join(",")},geometrycollection:function(t){for(var n=this,r=[],i=0,a=t._geometries.length;i<a;++i)r.push(n.extractGeometry(t._geometries[i]));return r.join(",")}},km={point:function(t){if(t===void 0)return this.geometryFactory.createPoint();var n=t.trim().split(ru.spaces);return this.geometryFactory.createPoint(new $e(Number.parseFloat(n[0]),Number.parseFloat(n[1])))},multipoint:function(t){var n=this;if(t===void 0)return this.geometryFactory.createMultiPoint();for(var r,i=t.trim().split(","),a=[],l=0,o=i.length;l<o;++l)r=i[l].replace(ru.trimParens,"$1"),a.push(km.point.apply(n,[r]));return this.geometryFactory.createMultiPoint(a)},linestring:function(t){if(t===void 0)return this.geometryFactory.createLineString();for(var n=t.trim().split(","),r=[],i,a=0,l=n.length;a<l;++a)i=n[a].trim().split(ru.spaces),r.push(new $e(Number.parseFloat(i[0]),Number.parseFloat(i[1])));return this.geometryFactory.createLineString(r)},linearring:function(t){if(t===void 0)return this.geometryFactory.createLinearRing();for(var n=t.trim().split(","),r=[],i,a=0,l=n.length;a<l;++a)i=n[a].trim().split(ru.spaces),r.push(new $e(Number.parseFloat(i[0]),Number.parseFloat(i[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(t){var n=this;if(t===void 0)return this.geometryFactory.createMultiLineString();for(var r,i=t.trim().split(ru.parenComma),a=[],l=0,o=i.length;l<o;++l)r=i[l].replace(ru.trimParens,"$1"),a.push(km.linestring.apply(n,[r]));return this.geometryFactory.createMultiLineString(a)},polygon:function(t){var n=this;if(t===void 0)return this.geometryFactory.createPolygon();for(var r,i,a,l=t.trim().split(ru.parenComma),o,f=[],p=0,y=l.length;p<y;++p)r=l[p].replace(ru.trimParens,"$1"),i=km.linestring.apply(n,[r]),a=n.geometryFactory.createLinearRing(i._points),p===0?o=a:f.push(a);return this.geometryFactory.createPolygon(o,f)},multipolygon:function(t){var n=this;if(t===void 0)return this.geometryFactory.createMultiPolygon();for(var r,i=t.trim().split(ru.doubleParenComma),a=[],l=0,o=i.length;l<o;++l)r=i[l].replace(ru.trimParens,"$1"),a.push(km.polygon.apply(n,[r]));return this.geometryFactory.createMultiPolygon(a)},geometrycollection:function(t){var n=this;if(t===void 0)return this.geometryFactory.createGeometryCollection();t=t.replace(/,\s*([A-Za-z])/g,"|$1");for(var r=t.trim().split("|"),i=[],a=0,l=r.length;a<l;++a)i.push(n.read(r[a]));return this.geometryFactory.createGeometryCollection(i)}},Al=function(t){this.parser=new Rw(t)};Al.prototype.write=function(t){return this.parser.write(t)};Al.toLineString=function(t,n){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+n.x+" "+n.y+" )"};var th=function(e){function t(n){e.call(this,n),this.name="RuntimeException",this.message=n,this.stack=new e().stack}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),zb=function(e){function t(){if(e.call(this),arguments.length===0)e.call(this);else if(arguments.length===1){var n=arguments[0];e.call(this,n)}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(th),Xn=function(){};Xn.prototype.interfaces_=function(){return[]};Xn.prototype.getClass=function(){return Xn};Xn.shouldNeverReachHere=function(){if(arguments.length===0)Xn.shouldNeverReachHere(null);else if(arguments.length===1){var t=arguments[0];throw new zb("Should never reach here"+(t!==null?": "+t:""))}};Xn.isTrue=function(){var t,n;if(arguments.length===1)t=arguments[0],Xn.isTrue(t,null);else if(arguments.length===2&&(t=arguments[0],n=arguments[1],!t))throw n===null?new zb:new zb(n)};Xn.equals=function(){var t,n,r;if(arguments.length===2)t=arguments[0],n=arguments[1],Xn.equals(t,n,null);else if(arguments.length===3&&(t=arguments[0],n=arguments[1],r=arguments[2],!n.equals(t)))throw new zb("Expected "+t+" but encountered "+n+(r!==null?": "+r:""))};var Zi=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new $e,this._intPt[1]=new $e,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},lg={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};Zi.prototype.getIndexAlongSegment=function(t,n){return this.computeIntLineIndex(),this._intLineIndex[t][n]};Zi.prototype.getTopologySummary=function(){var t=new Pu;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()};Zi.prototype.computeIntersection=function(t,n,r,i){this._inputLines[0][0]=t,this._inputLines[0][1]=n,this._inputLines[1][0]=r,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,n,r,i)};Zi.prototype.getIntersectionNum=function(){return this._result};Zi.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var t=arguments[0],n=this.getEdgeDistance(t,0),r=this.getEdgeDistance(t,1);n>r?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}};Zi.prototype.isProper=function(){return this.hasIntersection()&&this._isProper};Zi.prototype.setPrecisionModel=function(t){this._precisionModel=t};Zi.prototype.isInteriorIntersection=function(){var t=this;if(arguments.length===0)return!!(this.isInteriorIntersection(0)||this.isInteriorIntersection(1));if(arguments.length===1){for(var n=arguments[0],r=0;r<this._result;r++)if(!(t._intPt[r].equals2D(t._inputLines[n][0])||t._intPt[r].equals2D(t._inputLines[n][1])))return!0;return!1}};Zi.prototype.getIntersection=function(t){return this._intPt[t]};Zi.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper};Zi.prototype.hasIntersection=function(){return this._result!==Zi.NO_INTERSECTION};Zi.prototype.getEdgeDistance=function(t,n){var r=Zi.computeEdgeDistance(this._intPt[n],this._inputLines[t][0],this._inputLines[t][1]);return r};Zi.prototype.isCollinear=function(){return this._result===Zi.COLLINEAR_INTERSECTION};Zi.prototype.toString=function(){return Al.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Al.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()};Zi.prototype.getEndpoint=function(t,n){return this._inputLines[t][n]};Zi.prototype.isIntersection=function(t){for(var n=this,r=0;r<this._result;r++)if(n._intPt[r].equals2D(t))return!0;return!1};Zi.prototype.getIntersectionAlongSegment=function(t,n){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][n]]};Zi.prototype.interfaces_=function(){return[]};Zi.prototype.getClass=function(){return Zi};Zi.computeEdgeDistance=function(t,n,r){var i=Math.abs(r.x-n.x),a=Math.abs(r.y-n.y),l=-1;if(t.equals(n))l=0;else if(t.equals(r))i>a?l=i:l=a;else{var o=Math.abs(t.x-n.x),f=Math.abs(t.y-n.y);i>a?l=o:l=f,l===0&&!t.equals(n)&&(l=Math.max(o,f))}return Xn.isTrue(!(l===0&&!t.equals(n)),"Bad distance calculation"),l};Zi.nonRobustComputeEdgeDistance=function(t,n,r){var i=t.x-n.x,a=t.y-n.y,l=Math.sqrt(i*i+a*a);return Xn.isTrue(!(l===0&&!t.equals(n)),"Invalid distance calculation"),l};lg.DONT_INTERSECT.get=function(){return 0};lg.DO_INTERSECT.get=function(){return 1};lg.COLLINEAR.get=function(){return 2};lg.NO_INTERSECTION.get=function(){return 0};lg.POINT_INTERSECTION.get=function(){return 1};lg.COLLINEAR_INTERSECTION.get=function(){return 2};Object.defineProperties(Zi,lg);var xd=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isInSegmentEnvelopes=function(r){var i=new _n(this._inputLines[0][0],this._inputLines[0][1]),a=new _n(this._inputLines[1][0],this._inputLines[1][1]);return i.contains(r)&&a.contains(r)},t.prototype.computeIntersection=function(){if(arguments.length===3){var r=arguments[0],i=arguments[1],a=arguments[2];if(this._isProper=!1,_n.intersects(i,a,r)&&en.orientationIndex(i,a,r)===0&&en.orientationIndex(a,i,r)===0)return this._isProper=!0,(r.equals(i)||r.equals(a))&&(this._isProper=!1),this._result=e.POINT_INTERSECTION,null;this._result=e.NO_INTERSECTION}else return e.prototype.computeIntersection.apply(this,arguments)},t.prototype.normalizeToMinimum=function(r,i,a,l,o){o.x=this.smallestInAbsValue(r.x,i.x,a.x,l.x),o.y=this.smallestInAbsValue(r.y,i.y,a.y,l.y),r.x-=o.x,r.y-=o.y,i.x-=o.x,i.y-=o.y,a.x-=o.x,a.y-=o.y,l.x-=o.x,l.y-=o.y},t.prototype.safeHCoordinateIntersection=function(r,i,a,l){var o=null;try{o=Il.intersection(r,i,a,l)}catch(f){if(f instanceof Iy)o=t.nearestEndpoint(r,i,a,l);else throw f}finally{}return o},t.prototype.intersection=function(r,i,a,l){var o=this.intersectionWithNormalization(r,i,a,l);return this.isInSegmentEnvelopes(o)||(o=new $e(t.nearestEndpoint(r,i,a,l))),this._precisionModel!==null&&this._precisionModel.makePrecise(o),o},t.prototype.smallestInAbsValue=function(r,i,a,l){var o=r,f=Math.abs(o);return Math.abs(i)<f&&(o=i,f=Math.abs(i)),Math.abs(a)<f&&(o=a,f=Math.abs(a)),Math.abs(l)<f&&(o=l),o},t.prototype.checkDD=function(r,i,a,l,o){var f=Ka.intersection(r,i,a,l),p=this.isInSegmentEnvelopes(f);la.out.println("DD in env = "+p+"  --------------------- "+f),o.distance(f)>1e-4&&la.out.println("Distance = "+o.distance(f))},t.prototype.intersectionWithNormalization=function(r,i,a,l){var o=new $e(r),f=new $e(i),p=new $e(a),y=new $e(l),x=new $e;this.normalizeToEnvCentre(o,f,p,y,x);var w=this.safeHCoordinateIntersection(o,f,p,y);return w.x+=x.x,w.y+=x.y,w},t.prototype.computeCollinearIntersection=function(r,i,a,l){var o=_n.intersects(r,i,a),f=_n.intersects(r,i,l),p=_n.intersects(a,l,r),y=_n.intersects(a,l,i);return o&&f?(this._intPt[0]=a,this._intPt[1]=l,e.COLLINEAR_INTERSECTION):p&&y?(this._intPt[0]=r,this._intPt[1]=i,e.COLLINEAR_INTERSECTION):o&&p?(this._intPt[0]=a,this._intPt[1]=r,a.equals(r)&&!f&&!y?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):o&&y?(this._intPt[0]=a,this._intPt[1]=i,a.equals(i)&&!f&&!p?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):f&&p?(this._intPt[0]=l,this._intPt[1]=r,l.equals(r)&&!o&&!y?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):f&&y?(this._intPt[0]=l,this._intPt[1]=i,l.equals(i)&&!o&&!p?e.POINT_INTERSECTION:e.COLLINEAR_INTERSECTION):e.NO_INTERSECTION},t.prototype.normalizeToEnvCentre=function(r,i,a,l,o){var f=r.x<i.x?r.x:i.x,p=r.y<i.y?r.y:i.y,y=r.x>i.x?r.x:i.x,x=r.y>i.y?r.y:i.y,w=a.x<l.x?a.x:l.x,S=a.y<l.y?a.y:l.y,L=a.x>l.x?a.x:l.x,D=a.y>l.y?a.y:l.y,B=f>w?f:w,z=y<L?y:L,M=p>S?p:S,k=x<D?x:D,V=(B+z)/2,q=(M+k)/2;o.x=V,o.y=q,r.x-=o.x,r.y-=o.y,i.x-=o.x,i.y-=o.y,a.x-=o.x,a.y-=o.y,l.x-=o.x,l.y-=o.y},t.prototype.computeIntersect=function(r,i,a,l){if(this._isProper=!1,!_n.intersects(r,i,a,l))return e.NO_INTERSECTION;var o=en.orientationIndex(r,i,a),f=en.orientationIndex(r,i,l);if(o>0&&f>0||o<0&&f<0)return e.NO_INTERSECTION;var p=en.orientationIndex(a,l,r),y=en.orientationIndex(a,l,i);if(p>0&&y>0||p<0&&y<0)return e.NO_INTERSECTION;var x=o===0&&f===0&&p===0&&y===0;return x?this.computeCollinearIntersection(r,i,a,l):(o===0||f===0||p===0||y===0?(this._isProper=!1,r.equals2D(a)||r.equals2D(l)?this._intPt[0]=r:i.equals2D(a)||i.equals2D(l)?this._intPt[0]=i:o===0?this._intPt[0]=new $e(a):f===0?this._intPt[0]=new $e(l):p===0?this._intPt[0]=new $e(r):y===0&&(this._intPt[0]=new $e(i))):(this._isProper=!0,this._intPt[0]=this.intersection(r,i,a,l)),e.POINT_INTERSECTION)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.nearestEndpoint=function(r,i,a,l){var o=r,f=en.distancePointLine(r,a,l),p=en.distancePointLine(i,a,l);return p<f&&(f=p,o=i),p=en.distancePointLine(a,r,i),p<f&&(f=p,o=a),p=en.distancePointLine(l,r,i),p<f&&(f=p,o=l),o},t}(Zi),$p=function(){};$p.prototype.interfaces_=function(){return[]};$p.prototype.getClass=function(){return $p};$p.orientationIndex=function(t,n,r){var i=n.x-t.x,a=n.y-t.y,l=r.x-n.x,o=r.y-n.y;return $p.signOfDet2x2(i,a,l,o)};$p.signOfDet2x2=function(t,n,r,i){var a=null,l=null,o=null;if(a=1,t===0||i===0)return n===0||r===0?0:n>0?r>0?-a:a:r>0?a:-a;if(n===0||r===0)return i>0?t>0?a:-a:t>0?-a:a;if(n>0?i>0?n<=i||(a=-a,l=t,t=r,r=l,l=n,n=i,i=l):n<=-i?(a=-a,r=-r,i=-i):(l=t,t=-r,r=l,l=n,n=-i,i=l):i>0?-n<=i?(a=-a,t=-t,n=-n):(l=-t,t=r,r=l,l=-n,n=i,i=l):n>=i?(t=-t,n=-n,r=-r,i=-i):(a=-a,l=-t,t=-r,r=l,l=-n,n=-i,i=l),t>0)if(r>0){if(!(t<=r))return a}else return a;else{if(r>0)return-a;if(t>=r)a=-a,t=-t,r=-r;else return-a}for(;;){if(o=Math.floor(r/t),r=r-o*t,i=i-o*n,i<0)return-a;if(i>n)return a;if(t>r+r){if(n<i+i)return a}else{if(n>i+i)return-a;r=t-r,i=n-i,a=-a}if(i===0)return r===0?0:-a;if(r===0||(o=Math.floor(t/r),t=t-o*r,n=n-o*i,n<0))return a;if(n>i)return-a;if(r>t+t){if(i<n+n)return-a}else{if(i>n+n)return a;t=r-t,n=i-n,a=-a}if(n===0)return t===0?0:a;if(t===0)return-a}};var fu=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};fu.prototype.countSegment=function(t,n){if(t.x<this._p.x&&n.x<this._p.x)return null;if(this._p.x===n.x&&this._p.y===n.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&n.y===this._p.y){var r=t.x,i=n.x;return r>i&&(r=n.x,i=t.x),this._p.x>=r&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&n.y<=this._p.y||n.y>this._p.y&&t.y<=this._p.y){var a=t.x-this._p.x,l=t.y-this._p.y,o=n.x-this._p.x,f=n.y-this._p.y,p=$p.signOfDet2x2(a,l,o,f);if(p===0)return this._isPointOnSegment=!0,null;f<l&&(p=-p),p>0&&this._crossingCount++}};fu.prototype.isPointInPolygon=function(){return this.getLocation()!==tt.EXTERIOR};fu.prototype.getLocation=function(){return this._isPointOnSegment?tt.BOUNDARY:this._crossingCount%2===1?tt.INTERIOR:tt.EXTERIOR};fu.prototype.isOnSegment=function(){return this._isPointOnSegment};fu.prototype.interfaces_=function(){return[]};fu.prototype.getClass=function(){return fu};fu.locatePointInRing=function(){if(arguments[0]instanceof $e&&Pn(arguments[1],pr)){for(var t=arguments[0],n=arguments[1],r=new fu(t),i=new $e,a=new $e,l=1;l<n.size();l++)if(n.getCoordinate(l,i),n.getCoordinate(l-1,a),r.countSegment(i,a),r.isOnSegment())return r.getLocation();return r.getLocation()}else if(arguments[0]instanceof $e&&arguments[1]instanceof Array){for(var o=arguments[0],f=arguments[1],p=new fu(o),y=1;y<f.length;y++){var x=f[y],w=f[y-1];if(p.countSegment(x,w),p.isOnSegment())return p.getLocation()}return p.getLocation()}};var en=function(){},ug={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};en.prototype.interfaces_=function(){return[]};en.prototype.getClass=function(){return en};en.orientationIndex=function(t,n,r){return Ka.orientationIndex(t,n,r)};en.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var n=0,r=t[0].x,i=1;i<t.length-1;i++){var a=t[i].x-r,l=t[i+1].y,o=t[i-1].y;n+=a*(o-l)}return n/2}else if(Pn(arguments[0],pr)){var f=arguments[0],p=f.size();if(p<3)return 0;var y=new $e,x=new $e,w=new $e;f.getCoordinate(0,x),f.getCoordinate(1,w);var S=x.x;w.x-=S;for(var L=0,D=1;D<p-1;D++)y.y=x.y,x.x=w.x,x.y=w.y,f.getCoordinate(D+1,w),w.x-=S,L+=x.x*(y.y-w.y);return L/2}};en.distanceLineLine=function(t,n,r,i){if(t.equals(n))return en.distancePointLine(t,r,i);if(r.equals(i))return en.distancePointLine(i,t,n);var a=!1;if(!_n.intersects(t,n,r,i))a=!0;else{var l=(n.x-t.x)*(i.y-r.y)-(n.y-t.y)*(i.x-r.x);if(l===0)a=!0;else{var o=(t.y-r.y)*(i.x-r.x)-(t.x-r.x)*(i.y-r.y),f=(t.y-r.y)*(n.x-t.x)-(t.x-r.x)*(n.y-t.y),p=f/l,y=o/l;(y<0||y>1||p<0||p>1)&&(a=!0)}}return a?ks.min(en.distancePointLine(t,r,i),en.distancePointLine(n,r,i),en.distancePointLine(r,t,n),en.distancePointLine(i,t,n)):0};en.isPointInRing=function(t,n){return en.locatePointInRing(t,n)!==tt.EXTERIOR};en.computeLength=function(t){var n=t.size();if(n<=1)return 0;var r=0,i=new $e;t.getCoordinate(0,i);for(var a=i.x,l=i.y,o=1;o<n;o++){t.getCoordinate(o,i);var f=i.x,p=i.y,y=f-a,x=p-l;r+=Math.sqrt(y*y+x*x),a=f,l=p}return r};en.isCCW=function(t){var n=t.length-1;if(n<3)throw new Ui("Ring has fewer than 4 points, so orientation cannot be determined");for(var r=t[0],i=0,a=1;a<=n;a++){var l=t[a];l.y>r.y&&(r=l,i=a)}var o=i;do o=o-1,o<0&&(o=n);while(t[o].equals2D(r)&&o!==i);var f=i;do f=(f+1)%n;while(t[f].equals2D(r)&&f!==i);var p=t[o],y=t[f];if(p.equals2D(r)||y.equals2D(r)||p.equals2D(y))return!1;var x=en.computeOrientation(p,r,y),w=!1;return x===0?w=p.x>y.x:w=x>0,w};en.locatePointInRing=function(t,n){return fu.locatePointInRing(t,n)};en.distancePointLinePerpendicular=function(t,n,r){var i=(r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y),a=((n.y-t.y)*(r.x-n.x)-(n.x-t.x)*(r.y-n.y))/i;return Math.abs(a)*Math.sqrt(i)};en.computeOrientation=function(t,n,r){return en.orientationIndex(t,n,r)};en.distancePointLine=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(n.length===0)throw new Ui("Line array must contain at least one vertex");for(var r=t.distance(n[0]),i=0;i<n.length-1;i++){var a=en.distancePointLine(t,n[i],n[i+1]);a<r&&(r=a)}return r}else if(arguments.length===3){var l=arguments[0],o=arguments[1],f=arguments[2];if(o.x===f.x&&o.y===f.y)return l.distance(o);var p=(f.x-o.x)*(f.x-o.x)+(f.y-o.y)*(f.y-o.y),y=((l.x-o.x)*(f.x-o.x)+(l.y-o.y)*(f.y-o.y))/p;if(y<=0)return l.distance(o);if(y>=1)return l.distance(f);var x=((o.y-l.y)*(f.x-o.x)-(o.x-l.x)*(f.y-o.y))/p;return Math.abs(x)*Math.sqrt(p)}};en.isOnLine=function(t,n){for(var r=new xd,i=1;i<n.length;i++){var a=n[i-1],l=n[i];if(r.computeIntersection(t,a,l),r.hasIntersection())return!0}return!1};ug.CLOCKWISE.get=function(){return-1};ug.RIGHT.get=function(){return en.CLOCKWISE};ug.COUNTERCLOCKWISE.get=function(){return 1};ug.LEFT.get=function(){return en.COUNTERCLOCKWISE};ug.COLLINEAR.get=function(){return 0};ug.STRAIGHT.get=function(){return en.COLLINEAR};Object.defineProperties(en,ug);var nh=function(){};nh.prototype.filter=function(t){};nh.prototype.interfaces_=function(){return[]};nh.prototype.getClass=function(){return nh};var Cn=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},Sc={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Cn.prototype.isGeometryCollection=function(){return this.getSortIndex()===Cn.SORTINDEX_GEOMETRYCOLLECTION};Cn.prototype.getFactory=function(){return this._factory};Cn.prototype.getGeometryN=function(t){return this};Cn.prototype.getArea=function(){return 0};Cn.prototype.isRectangle=function(){return!1};Cn.prototype.equals=function(){if(arguments[0]instanceof Cn){var t=arguments[0];return t===null?!1:this.equalsTopo(t)}else if(arguments[0]instanceof Object){var n=arguments[0];if(!(n instanceof Cn))return!1;var r=n;return this.equalsExact(r)}};Cn.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)};Cn.prototype.geometryChanged=function(){this.apply(Cn.geometryChangedFilter)};Cn.prototype.geometryChangedAction=function(){this._envelope=null};Cn.prototype.equalsNorm=function(t){return t===null?!1:this.norm().equalsExact(t.norm())};Cn.prototype.getLength=function(){return 0};Cn.prototype.getNumGeometries=function(){return 1};Cn.prototype.compareTo=function(){if(arguments.length===1){var t=arguments[0],n=t;return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(t)}else if(arguments.length===2){var r=arguments[0],i=arguments[1];return this.getSortIndex()!==r.getSortIndex()?this.getSortIndex()-r.getSortIndex():this.isEmpty()&&r.isEmpty()?0:this.isEmpty()?-1:r.isEmpty()?1:this.compareToSameClass(r,i)}};Cn.prototype.getUserData=function(){return this._userData};Cn.prototype.getSRID=function(){return this._SRID};Cn.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())};Cn.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===Cn.SORTINDEX_GEOMETRYCOLLECTION)throw new Ui("This method does not support GeometryCollection arguments")};Cn.prototype.equal=function(t,n,r){return r===0?t.equals(n):t.distance(n)<=r};Cn.prototype.norm=function(){var t=this.copy();return t.normalize(),t};Cn.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()};Cn.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new _n(this._envelope)};Cn.prototype.setSRID=function(t){this._SRID=t};Cn.prototype.setUserData=function(t){this._userData=t};Cn.prototype.compare=function(t,n){for(var r=t.iterator(),i=n.iterator();r.hasNext()&&i.hasNext();){var a=r.next(),l=i.next(),o=a.compareTo(l);if(o!==0)return o}return r.hasNext()?1:i.hasNext()?-1:0};Cn.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()};Cn.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===Cn.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Cn.SORTINDEX_MULTIPOINT||this.getSortIndex()===Cn.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Cn.SORTINDEX_MULTIPOLYGON};Cn.prototype.interfaces_=function(){return[Dw,fl,dl]};Cn.prototype.getClass=function(){return Cn};Cn.hasNonEmptyElements=function(t){for(var n=0;n<t.length;n++)if(!t[n].isEmpty())return!0;return!1};Cn.hasNullElements=function(t){for(var n=0;n<t.length;n++)if(t[n]===null)return!0;return!1};Sc.serialVersionUID.get=function(){return 8763622679187377e3};Sc.SORTINDEX_POINT.get=function(){return 0};Sc.SORTINDEX_MULTIPOINT.get=function(){return 1};Sc.SORTINDEX_LINESTRING.get=function(){return 2};Sc.SORTINDEX_LINEARRING.get=function(){return 3};Sc.SORTINDEX_MULTILINESTRING.get=function(){return 4};Sc.SORTINDEX_POLYGON.get=function(){return 5};Sc.SORTINDEX_MULTIPOLYGON.get=function(){return 6};Sc.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7};Sc.geometryChangedFilter.get=function(){return A2};Object.defineProperties(Cn,Sc);var A2=function(){};A2.interfaces_=function(){return[nh]};A2.filter=function(t){t.geometryChangedAction()};var pc=function(){};pc.prototype.filter=function(t){};pc.prototype.interfaces_=function(){return[]};pc.prototype.getClass=function(){return pc};var ll=function(){},ch={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};ll.prototype.isInBoundary=function(t){};ll.prototype.interfaces_=function(){return[]};ll.prototype.getClass=function(){return ll};ch.Mod2BoundaryNodeRule.get=function(){return Qm};ch.EndPointBoundaryNodeRule.get=function(){return ey};ch.MultiValentEndPointBoundaryNodeRule.get=function(){return ty};ch.MonoValentEndPointBoundaryNodeRule.get=function(){return ny};ch.MOD2_BOUNDARY_RULE.get=function(){return new Qm};ch.ENDPOINT_BOUNDARY_RULE.get=function(){return new ey};ch.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new ty};ch.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new ny};ch.OGC_SFS_BOUNDARY_RULE.get=function(){return ll.MOD2_BOUNDARY_RULE};Object.defineProperties(ll,ch);var Qm=function(){};Qm.prototype.isInBoundary=function(t){return t%2===1};Qm.prototype.interfaces_=function(){return[ll]};Qm.prototype.getClass=function(){return Qm};var ey=function(){};ey.prototype.isInBoundary=function(t){return t>0};ey.prototype.interfaces_=function(){return[ll]};ey.prototype.getClass=function(){return ey};var ty=function(){};ty.prototype.isInBoundary=function(t){return t>1};ty.prototype.interfaces_=function(){return[ll]};ty.prototype.getClass=function(){return ty};var ny=function(){};ny.prototype.isInBoundary=function(t){return t===1};ny.prototype.interfaces_=function(){return[ll]};ny.prototype.getClass=function(){return ny};var Po=function(){};Po.prototype.add=function(){};Po.prototype.addAll=function(){};Po.prototype.isEmpty=function(){};Po.prototype.iterator=function(){};Po.prototype.size=function(){};Po.prototype.toArray=function(){};Po.prototype.remove=function(){};function M2(e){this.message=e||""}M2.prototype=new Error;M2.prototype.name="IndexOutOfBoundsException";var Cy=function(){};Cy.prototype.hasNext=function(){};Cy.prototype.next=function(){};Cy.prototype.remove=function(){};var Cl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(){},t.prototype.set=function(){},t.prototype.isEmpty=function(){},t}(Po);function Py(e){this.message=e||""}Py.prototype=new Error;Py.prototype.name="NoSuchElementException";var jt=function(e){function t(){e.call(this),this.array_=[],arguments[0]instanceof Po&&this.addAll(arguments[0])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.ensureCapacity=function(){},t.prototype.interfaces_=function(){return[e,Po]},t.prototype.add=function(r){return arguments.length===1?this.array_.push(r):this.array_.splice(arguments[0],arguments[1]),!0},t.prototype.clear=function(){this.array_=[]},t.prototype.addAll=function(r){for(var i=this,a=r.iterator();a.hasNext();)i.add(a.next());return!0},t.prototype.set=function(r,i){var a=this.array_[r];return this.array_[r]=i,a},t.prototype.iterator=function(){return new RW(this)},t.prototype.get=function(r){if(r<0||r>=this.size())throw new M2;return this.array_[r]},t.prototype.isEmpty=function(){return this.array_.length===0},t.prototype.size=function(){return this.array_.length},t.prototype.toArray=function(){for(var r=this,i=[],a=0,l=this.array_.length;a<l;a++)i.push(r.array_[a]);return i},t.prototype.remove=function(r){for(var i=this,a=!1,l=0,o=this.array_.length;l<o;l++)if(i.array_[l]===r){i.array_.splice(l,1),a=!0;break}return a},t}(Cl),RW=function(e){function t(n){e.call(this),this.arrayList_=n,this.position_=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new Py;return this.arrayList_.get(this.position_++)},t.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},t.prototype.set=function(r){return this.arrayList_.set(this.position_-1,r)},t.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},t}(Cy),H0=function(e){function t(){if(e.call(this),arguments.length!==0){if(arguments.length===1){var r=arguments[0];this.ensureCapacity(r.length),this.add(r,!0)}else if(arguments.length===2){var i=arguments[0],a=arguments[1];this.ensureCapacity(i.length),this.add(i,a)}}}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},t.prototype.getCoordinate=function(i){return this.get(i)},t.prototype.addAll=function(){var i=this;if(arguments.length===2){for(var a=arguments[0],l=arguments[1],o=!1,f=a.iterator();f.hasNext();)i.add(f.next(),l),o=!0;return o}else return e.prototype.addAll.apply(this,arguments)},t.prototype.clone=function(){for(var i=this,a=e.prototype.clone.call(this),l=0;l<this.size();l++)a.add(l,i.get(l).copy());return a},t.prototype.toCoordinateArray=function(){return this.toArray(t.coordArrayType)},t.prototype.add=function(){var i=this;if(arguments.length===1){var a=arguments[0];e.prototype.add.call(this,a)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var l=arguments[0],o=arguments[1];return this.add(l,o,!0),!0}else if(arguments[0]instanceof $e&&typeof arguments[1]=="boolean"){var f=arguments[0],p=arguments[1];if(!p&&this.size()>=1){var y=this.get(this.size()-1);if(y.equals2D(f))return null}e.prototype.add.call(this,f)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var x=arguments[0],w=arguments[1];return this.add(x,w),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var S=arguments[0],L=arguments[1],D=arguments[2];if(D)for(var B=0;B<S.length;B++)i.add(S[B],L);else for(var z=S.length-1;z>=0;z--)i.add(S[z],L);return!0}else if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof $e){var M=arguments[0],k=arguments[1],V=arguments[2];if(!V){var q=this.size();if(q>0){if(M>0){var Y=this.get(M-1);if(Y.equals2D(k))return null}if(M<q){var K=this.get(M);if(K.equals2D(k))return null}}}e.prototype.add.call(this,M,k)}}else if(arguments.length===4){var X=arguments[0],U=arguments[1],le=arguments[2],ue=arguments[3],ae=1;le>ue&&(ae=-1);for(var ve=le;ve!==ue;ve+=ae)i.add(X[ve],U);return!0}},t.prototype.closeRing=function(){this.size()>0&&this.add(new $e(this.get(0)),!1)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},Object.defineProperties(t,n),t}(jt),ir=function(){},kw={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};kw.ForwardComparator.get=function(){return v0};kw.BidirectionalComparator.get=function(){return ry};kw.coordArrayType.get=function(){return new Array(0).fill(null)};ir.prototype.interfaces_=function(){return[]};ir.prototype.getClass=function(){return ir};ir.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))};ir.ptNotInList=function(t,n){for(var r=0;r<t.length;r++){var i=t[r];if(ir.indexOf(i,n)<0)return i}return null};ir.scroll=function(t,n){var r=ir.indexOf(n,t);if(r<0)return null;var i=new Array(t.length).fill(null);la.arraycopy(t,r,i,0,t.length-r),la.arraycopy(t,0,i,t.length-r,r),la.arraycopy(i,0,t,0,t.length)};ir.equals=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(t===n)return!0;if(t===null||n===null||t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!t[r].equals(n[r]))return!1;return!0}else if(arguments.length===3){var i=arguments[0],a=arguments[1],l=arguments[2];if(i===a)return!0;if(i===null||a===null||i.length!==a.length)return!1;for(var o=0;o<i.length;o++)if(l.compare(i[o],a[o])!==0)return!1;return!0}};ir.intersection=function(t,n){for(var r=new H0,i=0;i<t.length;i++)n.intersects(t[i])&&r.add(t[i],!0);return r.toCoordinateArray()};ir.hasRepeatedPoints=function(t){for(var n=1;n<t.length;n++)if(t[n-1].equals(t[n]))return!0;return!1};ir.removeRepeatedPoints=function(t){if(!ir.hasRepeatedPoints(t))return t;var n=new H0(t,!1);return n.toCoordinateArray()};ir.reverse=function(t){for(var n=t.length-1,r=Math.trunc(n/2),i=0;i<=r;i++){var a=t[i];t[i]=t[n-i],t[n-i]=a}};ir.removeNull=function(t){for(var n=0,r=0;r<t.length;r++)t[r]!==null&&n++;var i=new Array(n).fill(null);if(n===0)return i;for(var a=0,l=0;l<t.length;l++)t[l]!==null&&(i[a++]=t[l]);return i};ir.copyDeep=function(){if(arguments.length===1){for(var t=arguments[0],n=new Array(t.length).fill(null),r=0;r<t.length;r++)n[r]=new $e(t[r]);return n}else if(arguments.length===5)for(var i=arguments[0],a=arguments[1],l=arguments[2],o=arguments[3],f=arguments[4],p=0;p<f;p++)l[o+p]=new $e(i[a+p])};ir.isEqualReversed=function(t,n){for(var r=0;r<t.length;r++){var i=t[r],a=n[t.length-r-1];if(i.compareTo(a)!==0)return!1}return!0};ir.envelope=function(t){for(var n=new _n,r=0;r<t.length;r++)n.expandToInclude(t[r]);return n};ir.toCoordinateArray=function(t){return t.toArray(ir.coordArrayType)};ir.atLeastNCoordinatesOrNothing=function(t,n){return n.length>=t?n:[]};ir.indexOf=function(t,n){for(var r=0;r<n.length;r++)if(t.equals(n[r]))return r;return-1};ir.increasingDirection=function(t){for(var n=0;n<Math.trunc(t.length/2);n++){var r=t.length-1-n,i=t[n].compareTo(t[r]);if(i!==0)return i}return 1};ir.compare=function(t,n){for(var r=0;r<t.length&&r<n.length;){var i=t[r].compareTo(n[r]);if(i!==0)return i;r++}return r<n.length?-1:r<t.length?1:0};ir.minCoordinate=function(t){for(var n=null,r=0;r<t.length;r++)(n===null||n.compareTo(t[r])>0)&&(n=t[r]);return n};ir.extract=function(t,n,r){n=ks.clamp(n,0,t.length),r=ks.clamp(r,-1,t.length);var i=r-n+1;r<0&&(i=0),n>=t.length&&(i=0),r<n&&(i=0);var a=new Array(i).fill(null);if(i===0)return a;for(var l=0,o=n;o<=r;o++)a[l++]=t[o];return a};Object.defineProperties(ir,kw);var v0=function(){};v0.prototype.compare=function(t,n){var r=t,i=n;return ir.compare(r,i)};v0.prototype.interfaces_=function(){return[Km]};v0.prototype.getClass=function(){return v0};var ry=function(){};ry.prototype.compare=function(t,n){var r=t,i=n;if(r.length<i.length)return-1;if(r.length>i.length)return 1;if(r.length===0)return 0;var a=ir.compare(r,i),l=ir.isEqualReversed(r,i);return l?0:a};ry.prototype.OLDcompare=function(t,n){var r=t,i=n;if(r.length<i.length)return-1;if(r.length>i.length)return 1;if(r.length===0)return 0;for(var a=ir.increasingDirection(r),l=ir.increasingDirection(i),o=a>0?0:r.length-1,f=l>0?0:r.length-1,p=0;p<r.length;p++){var y=r[o].compareTo(i[f]);if(y!==0)return y;o+=a,f+=l}return 0};ry.prototype.interfaces_=function(){return[Km]};ry.prototype.getClass=function(){return ry};var cg=function(){};cg.prototype.get=function(){};cg.prototype.put=function(){};cg.prototype.size=function(){};cg.prototype.values=function(){};cg.prototype.entrySet=function(){};var kW=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(cg);function Y0(e){this.message=e||""}Y0.prototype=new Error;Y0.prototype.name="OperationNotSupported";function Nw(){}Nw.prototype=new Po;Nw.prototype.contains=function(){};var L2=function(e){function t(){e.call(this),this.array_=[],arguments[0]instanceof Po&&this.addAll(arguments[0])}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.contains=function(r){for(var i=this,a=0,l=this.array_.length;a<l;a++){var o=i.array_[a];if(o===r)return!0}return!1},t.prototype.add=function(r){return this.contains(r)?!1:(this.array_.push(r),!0)},t.prototype.addAll=function(r){for(var i=this,a=r.iterator();a.hasNext();)i.add(a.next());return!0},t.prototype.remove=function(r){throw new Error},t.prototype.size=function(){return this.array_.length},t.prototype.isEmpty=function(){return this.array_.length===0},t.prototype.toArray=function(){for(var r=this,i=[],a=0,l=this.array_.length;a<l;a++)i.push(r.array_[a]);return i},t.prototype.iterator=function(){return new NW(this)},t}(Nw),NW=function(e){function t(n){e.call(this),this.hashSet_=n,this.position_=0}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new Py;return this.hashSet_.array_[this.position_++]},t.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},t.prototype.remove=function(){throw new Y0},t}(Cy),qc=0,qf=1;function QD(e){return e===null?qc:e.color}function Ei(e){return e===null?null:e.parent}function Vc(e,t){e!==null&&(e.color=t)}function CT(e){return e===null?null:e.left}function e3(e){return e===null?null:e.right}function ba(){this.root_=null,this.size_=0}ba.prototype=new kW;ba.prototype.get=function(e){for(var t=this.root_;t!==null;){var n=e.compareTo(t.key);if(n<0)t=t.left;else if(n>0)t=t.right;else return t.value}return null};ba.prototype.put=function(e,t){if(this.root_===null)return this.root_={key:e,value:t,left:null,right:null,parent:null,color:qc,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n=this.root_,r,i;do if(r=n,i=e.compareTo(n.key),i<0)n=n.left;else if(i>0)n=n.right;else{var a=n.value;return n.value=t,a}while(n!==null);var l={key:e,left:null,right:null,value:t,parent:r,color:qc,getValue:function(){return this.value},getKey:function(){return this.key}};return i<0?r.left=l:r.right=l,this.fixAfterInsertion(l),this.size_++,null};ba.prototype.fixAfterInsertion=function(e){var t=this;for(e.color=qf;e!=null&&e!==this.root_&&e.parent.color===qf;)if(Ei(e)===CT(Ei(Ei(e)))){var n=e3(Ei(Ei(e)));QD(n)===qf?(Vc(Ei(e),qc),Vc(n,qc),Vc(Ei(Ei(e)),qf),e=Ei(Ei(e))):(e===e3(Ei(e))&&(e=Ei(e),t.rotateLeft(e)),Vc(Ei(e),qc),Vc(Ei(Ei(e)),qf),t.rotateRight(Ei(Ei(e))))}else{var r=CT(Ei(Ei(e)));QD(r)===qf?(Vc(Ei(e),qc),Vc(r,qc),Vc(Ei(Ei(e)),qf),e=Ei(Ei(e))):(e===CT(Ei(e))&&(e=Ei(e),t.rotateRight(e)),Vc(Ei(e),qc),Vc(Ei(Ei(e)),qf),t.rotateLeft(Ei(Ei(e))))}this.root_.color=qc};ba.prototype.values=function(){var e=new jt,t=this.getFirstEntry();if(t!==null)for(e.add(t.value);(t=ba.successor(t))!==null;)e.add(t.value);return e};ba.prototype.entrySet=function(){var e=new L2,t=this.getFirstEntry();if(t!==null)for(e.add(t);(t=ba.successor(t))!==null;)e.add(t);return e};ba.prototype.rotateLeft=function(e){if(e!=null){var t=e.right;e.right=t.left,t.left!=null&&(t.left.parent=e),t.parent=e.parent,e.parent===null?this.root_=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}};ba.prototype.rotateRight=function(e){if(e!=null){var t=e.left;e.left=t.right,t.right!=null&&(t.right.parent=e),t.parent=e.parent,e.parent===null?this.root_=t:e.parent.right===e?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}};ba.prototype.getFirstEntry=function(){var e=this.root_;if(e!=null)for(;e.left!=null;)e=e.left;return e};ba.successor=function(e){if(e===null)return null;if(e.right!==null){for(var t=e.right;t.left!==null;)t=t.left;return t}else{for(var n=e.parent,r=e;n!==null&&r===n.right;)r=n,n=n.parent;return n}};ba.prototype.size=function(){return this.size_};var _0=function(){};_0.prototype.interfaces_=function(){return[]};_0.prototype.getClass=function(){return _0};function z4(){}z4.prototype=new Nw;function yu(){this.array_=[],arguments[0]instanceof Po&&this.addAll(arguments[0])}yu.prototype=new z4;yu.prototype.contains=function(e){for(var t=this,n=0,r=this.array_.length;n<r;n++){var i=t.array_[n];if(i.compareTo(e)===0)return!0}return!1};yu.prototype.add=function(e){var t=this;if(this.contains(e))return!1;for(var n=0,r=this.array_.length;n<r;n++){var i=t.array_[n];if(i.compareTo(e)===1)return t.array_.splice(n,0,e),!0}return this.array_.push(e),!0};yu.prototype.addAll=function(e){for(var t=this,n=e.iterator();n.hasNext();)t.add(n.next());return!0};yu.prototype.remove=function(e){throw new Y0};yu.prototype.size=function(){return this.array_.length};yu.prototype.isEmpty=function(){return this.array_.length===0};yu.prototype.toArray=function(){for(var e=this,t=[],n=0,r=this.array_.length;n<r;n++)t.push(e.array_[n]);return t};yu.prototype.iterator=function(){return new Fw(this)};var Fw=function(e){this.treeSet_=e,this.position_=0};Fw.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new Py;return this.treeSet_.array_[this.position_++]};Fw.prototype.hasNext=function(){return this.position_<this.treeSet_.size()};Fw.prototype.remove=function(){throw new Y0};var td=function(){};td.sort=function(){var t=arguments[0],n,r,i,a;if(arguments.length===1)a=function(o,f){return o.compareTo(f)},t.sort(a);else if(arguments.length===2)i=arguments[1],a=function(o,f){return i.compare(o,f)},t.sort(a);else if(arguments.length===3){r=t.slice(arguments[1],arguments[2]),r.sort();var l=t.slice(0,arguments[1]).concat(r,t.slice(arguments[2],t.length));for(t.splice(0,t.length),n=0;n<l.length;n++)t.push(l[n])}else if(arguments.length===4)for(r=t.slice(arguments[1],arguments[2]),i=arguments[3],a=function(o,f){return i.compare(o,f)},r.sort(a),l=t.slice(0,arguments[1]).concat(r,t.slice(arguments[2],t.length)),t.splice(0,t.length),n=0;n<l.length;n++)t.push(l[n])};td.asList=function(t){for(var n=new jt,r=0,i=t.length;r<i;r++)n.add(t[r]);return n};var Xr=function(){},zl={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};zl.P.get=function(){return 0};zl.L.get=function(){return 1};zl.A.get=function(){return 2};zl.FALSE.get=function(){return-1};zl.TRUE.get=function(){return-2};zl.DONTCARE.get=function(){return-3};zl.SYM_FALSE.get=function(){return"F"};zl.SYM_TRUE.get=function(){return"T"};zl.SYM_DONTCARE.get=function(){return"*"};zl.SYM_P.get=function(){return"0"};zl.SYM_L.get=function(){return"1"};zl.SYM_A.get=function(){return"2"};Xr.prototype.interfaces_=function(){return[]};Xr.prototype.getClass=function(){return Xr};Xr.toDimensionSymbol=function(t){switch(t){case Xr.FALSE:return Xr.SYM_FALSE;case Xr.TRUE:return Xr.SYM_TRUE;case Xr.DONTCARE:return Xr.SYM_DONTCARE;case Xr.P:return Xr.SYM_P;case Xr.L:return Xr.SYM_L;case Xr.A:return Xr.SYM_A}throw new Ui("Unknown dimension value: "+t)};Xr.toDimensionValue=function(t){switch(y0.toUpperCase(t)){case Xr.SYM_FALSE:return Xr.FALSE;case Xr.SYM_TRUE:return Xr.TRUE;case Xr.SYM_DONTCARE:return Xr.DONTCARE;case Xr.SYM_P:return Xr.P;case Xr.SYM_L:return Xr.L;case Xr.SYM_A:return Xr.A}throw new Ui("Unknown dimension symbol: "+t)};Object.defineProperties(Xr,zl);var vu=function(){};vu.prototype.filter=function(t){};vu.prototype.interfaces_=function(){return[]};vu.prototype.getClass=function(){return vu};var Ml=function(){};Ml.prototype.filter=function(t,n){};Ml.prototype.isDone=function(){};Ml.prototype.isGeometryChanged=function(){};Ml.prototype.interfaces_=function(){return[]};Ml.prototype.getClass=function(){return Ml};var Va=function(e){function t(r,i){if(e.call(this,i),this._geometries=r||[],e.hasNullElements(this._geometries))throw new Ui("geometries must not contain null elements")}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){for(var i=this,a=new _n,l=0;l<this._geometries.length;l++)a.expandToInclude(i._geometries[l].getEnvelopeInternal());return a},t.prototype.getGeometryN=function(i){return this._geometries[i]},t.prototype.getSortIndex=function(){return e.SORTINDEX_GEOMETRYCOLLECTION},t.prototype.getCoordinates=function(){for(var i=this,a=new Array(this.getNumPoints()).fill(null),l=-1,o=0;o<this._geometries.length;o++)for(var f=i._geometries[o].getCoordinates(),p=0;p<f.length;p++)l++,a[l]=f[p];return a},t.prototype.getArea=function(){for(var i=this,a=0,l=0;l<this._geometries.length;l++)a+=i._geometries[l].getArea();return a},t.prototype.equalsExact=function(){var i=this;if(arguments.length===2){var a=arguments[0],l=arguments[1];if(!this.isEquivalentClass(a))return!1;var o=a;if(this._geometries.length!==o._geometries.length)return!1;for(var f=0;f<this._geometries.length;f++)if(!i._geometries[f].equalsExact(o._geometries[f],l))return!1;return!0}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var i=this,a=0;a<this._geometries.length;a++)i._geometries[a].normalize();td.sort(this._geometries)},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},t.prototype.getBoundaryDimension=function(){for(var i=this,a=Xr.FALSE,l=0;l<this._geometries.length;l++)a=Math.max(a,i._geometries[l].getBoundaryDimension());return a},t.prototype.getDimension=function(){for(var i=this,a=Xr.FALSE,l=0;l<this._geometries.length;l++)a=Math.max(a,i._geometries[l].getDimension());return a},t.prototype.getLength=function(){for(var i=this,a=0,l=0;l<this._geometries.length;l++)a+=i._geometries[l].getLength();return a},t.prototype.getNumPoints=function(){for(var i=this,a=0,l=0;l<this._geometries.length;l++)a+=i._geometries[l].getNumPoints();return a},t.prototype.getNumGeometries=function(){return this._geometries.length},t.prototype.reverse=function(){for(var i=this,a=this._geometries.length,l=new Array(a).fill(null),o=0;o<this._geometries.length;o++)l[o]=i._geometries[o].reverse();return this.getFactory().createGeometryCollection(l)},t.prototype.compareToSameClass=function(){var i=this;if(arguments.length===1){var a=arguments[0],l=new yu(td.asList(this._geometries)),o=new yu(td.asList(a._geometries));return this.compare(l,o)}else if(arguments.length===2){for(var f=arguments[0],p=arguments[1],y=f,x=this.getNumGeometries(),w=y.getNumGeometries(),S=0;S<x&&S<w;){var L=i.getGeometryN(S),D=y.getGeometryN(S),B=L.compareToSameClass(D,p);if(B!==0)return B;S++}return S<x?1:S<w?-1:0}},t.prototype.apply=function(){var i=this;if(Pn(arguments[0],pc))for(var a=arguments[0],l=0;l<this._geometries.length;l++)i._geometries[l].apply(a);else if(Pn(arguments[0],Ml)){var o=arguments[0];if(this._geometries.length===0)return null;for(var f=0;f<this._geometries.length&&(i._geometries[f].apply(o),!o.isDone());f++);o.isGeometryChanged()&&this.geometryChanged()}else if(Pn(arguments[0],vu)){var p=arguments[0];p.filter(this);for(var y=0;y<this._geometries.length;y++)i._geometries[y].apply(p)}else if(Pn(arguments[0],nh)){var x=arguments[0];x.filter(this);for(var w=0;w<this._geometries.length;w++)i._geometries[w].apply(x)}},t.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),Xn.shouldNeverReachHere(),null},t.prototype.clone=function(){var i=this,a=e.prototype.clone.call(this);a._geometries=new Array(this._geometries.length).fill(null);for(var l=0;l<this._geometries.length;l++)a._geometries[l]=i._geometries[l].clone();return a},t.prototype.getGeometryType=function(){return"GeometryCollection"},t.prototype.copy=function(){for(var i=this,a=new Array(this._geometries.length).fill(null),l=0;l<a.length;l++)a[l]=i._geometries[l].copy();return new t(a,this._factory)},t.prototype.isEmpty=function(){for(var i=this,a=0;a<this._geometries.length;a++)if(!i._geometries[a].isEmpty())return!1;return!0},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(t,n),t}(Cn),sd=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Cn.SORTINDEX_MULTILINESTRING},t.prototype.equalsExact=function(){if(arguments.length===2){var i=arguments[0],a=arguments[1];return this.isEquivalentClass(i)?e.prototype.equalsExact.call(this,i,a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?Xr.FALSE:0},t.prototype.isClosed=function(){var i=this;if(this.isEmpty())return!1;for(var a=0;a<this._geometries.length;a++)if(!i._geometries[a].isClosed())return!1;return!0},t.prototype.getDimension=function(){return 1},t.prototype.reverse=function(){for(var i=this,a=this._geometries.length,l=new Array(a).fill(null),o=0;o<this._geometries.length;o++)l[a-1-o]=i._geometries[o].reverse();return this.getFactory().createMultiLineString(l)},t.prototype.getBoundary=function(){return new tl(this).getBoundary()},t.prototype.getGeometryType=function(){return"MultiLineString"},t.prototype.copy=function(){for(var i=this,a=new Array(this._geometries.length).fill(null),l=0;l<a.length;l++)a[l]=i._geometries[l].copy();return new t(a,this._factory)},t.prototype.interfaces_=function(){return[_0]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(t,n),t}(Va),tl=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var t=arguments[0],n=ll.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=n}else if(arguments.length===2){var r=arguments[0],i=arguments[1];this._geom=r,this._geomFact=r.getFactory(),this._bnRule=i}};tl.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var n=this.computeBoundaryCoordinates(t);return n.length===1?this._geomFact.createPoint(n[0]):this._geomFact.createMultiPointFromCoords(n)};tl.prototype.getBoundary=function(){return this._geom instanceof Ki?this.boundaryLineString(this._geom):this._geom instanceof sd?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()};tl.prototype.boundaryLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();if(t.isClosed()){var n=this._bnRule.isInBoundary(2);return n?t.getStartPoint():this._geomFact.createMultiPoint()}return this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])};tl.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()};tl.prototype.computeBoundaryCoordinates=function(t){var n=this,r=new jt;this._endpointMap=new ba;for(var i=0;i<t.getNumGeometries();i++){var a=t.getGeometryN(i);a.getNumPoints()!==0&&(n.addEndpoint(a.getCoordinateN(0)),n.addEndpoint(a.getCoordinateN(a.getNumPoints()-1)))}for(var l=this._endpointMap.entrySet().iterator();l.hasNext();){var o=l.next(),f=o.getValue(),p=f.count;n._bnRule.isInBoundary(p)&&r.add(o.getKey())}return ir.toCoordinateArray(r)};tl.prototype.addEndpoint=function(t){var n=this._endpointMap.get(t);n===null&&(n=new Ub,this._endpointMap.put(t,n)),n.count++};tl.prototype.interfaces_=function(){return[]};tl.prototype.getClass=function(){return tl};tl.getBoundary=function(){if(arguments.length===1){var t=arguments[0],n=new tl(t);return n.getBoundary()}else if(arguments.length===2){var r=arguments[0],i=arguments[1],a=new tl(r,i);return a.getBoundary()}};var Ub=function(){this.count=null};Ub.prototype.interfaces_=function(){return[]};Ub.prototype.getClass=function(){return Ub};function FW(){}function BW(){}var zW=function(){};function UW(){}function VW(){}function GW(){}var nl=function(){},O2={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};nl.prototype.interfaces_=function(){return[]};nl.prototype.getClass=function(){return nl};nl.chars=function(t,n){for(var r=new Array(n).fill(null),i=0;i<n;i++)r[i]=t;return String(r)};nl.getStackTrace=function(){if(arguments.length===1){var t=arguments[0],n=new UW,r=new FW;return t.printStackTrace(r),n.toString()}else if(arguments.length===2){var i=arguments[0],a=arguments[1],l="";new BW(nl.getStackTrace(i));for(var o=new GW,f=0;f<a;f++)try{l+=o.readLine()+nl.NEWLINE}catch(p){if(p instanceof VW)Xn.shouldNeverReachHere();else throw p}finally{}return l}};nl.split=function(t,n){for(var r=n.length,i=new jt,a=""+t,l=a.indexOf(n);l>=0;){var o=a.substring(0,l);i.add(o),a=a.substring(l+r),l=a.indexOf(n)}a.length>0&&i.add(a);for(var f=new Array(i.size()).fill(null),p=0;p<f.length;p++)f[p]=i.get(p);return f};nl.toString=function(){if(arguments.length===1){var t=arguments[0];return nl.SIMPLE_ORDINATE_FORMAT.format(t)}};nl.spaces=function(t){return nl.chars(" ",t)};O2.NEWLINE.get=function(){return la.getProperty("line.separator")};O2.SIMPLE_ORDINATE_FORMAT.get=function(){return new zW};Object.defineProperties(nl,O2);var oo=function(){};oo.prototype.interfaces_=function(){return[]};oo.prototype.getClass=function(){return oo};oo.copyCoord=function(t,n,r,i){for(var a=Math.min(t.getDimension(),r.getDimension()),l=0;l<a;l++)r.setOrdinate(i,l,t.getOrdinate(n,l))};oo.isRing=function(t){var n=t.size();return n===0?!0:n<=3?!1:t.getOrdinate(0,pr.X)===t.getOrdinate(n-1,pr.X)&&t.getOrdinate(0,pr.Y)===t.getOrdinate(n-1,pr.Y)};oo.isEqual=function(t,n){var r=t.size(),i=n.size();if(r!==i)return!1;for(var a=Math.min(t.getDimension(),n.getDimension()),l=0;l<r;l++)for(var o=0;o<a;o++){var f=t.getOrdinate(l,o),p=n.getOrdinate(l,o);if(t.getOrdinate(l,o)!==n.getOrdinate(l,o)&&!(Nn.isNaN(f)&&Nn.isNaN(p)))return!1}return!0};oo.extend=function(t,n,r){var i=t.create(r,n.getDimension()),a=n.size();if(oo.copy(n,0,i,0,a),a>0)for(var l=a;l<r;l++)oo.copy(n,a-1,i,l,1);return i};oo.reverse=function(t){for(var n=t.size()-1,r=Math.trunc(n/2),i=0;i<=r;i++)oo.swap(t,i,n-i)};oo.swap=function(t,n,r){if(n===r)return null;for(var i=0;i<t.getDimension();i++){var a=t.getOrdinate(n,i);t.setOrdinate(n,i,t.getOrdinate(r,i)),t.setOrdinate(r,i,a)}};oo.copy=function(t,n,r,i,a){for(var l=0;l<a;l++)oo.copyCoord(t,n+l,r,i+l)};oo.toString=function(){if(arguments.length===1){var t=arguments[0],n=t.size();if(n===0)return"()";var r=t.getDimension(),i=new Pu;i.append("(");for(var a=0;a<n;a++){a>0&&i.append(" ");for(var l=0;l<r;l++)l>0&&i.append(","),i.append(nl.toString(t.getOrdinate(a,l)))}return i.append(")"),i.toString()}};oo.ensureValidRing=function(t,n){var r=n.size();if(r===0)return n;if(r<=3)return oo.createClosedRing(t,n,4);var i=n.getOrdinate(0,pr.X)===n.getOrdinate(r-1,pr.X)&&n.getOrdinate(0,pr.Y)===n.getOrdinate(r-1,pr.Y);return i?n:oo.createClosedRing(t,n,r+1)};oo.createClosedRing=function(t,n,r){var i=t.create(r,n.getDimension()),a=n.size();oo.copy(n,0,i,0,a);for(var l=a;l<r;l++)oo.copy(n,0,i,l,1);return i};var Ki=function(e){function t(r,i){e.call(this,i),this._points=null,this.init(r)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new _n:this._points.expandEnvelope(new _n)},t.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},t.prototype.getSortIndex=function(){return e.SORTINDEX_LINESTRING},t.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},t.prototype.equalsExact=function(){var i=this;if(arguments.length===2){var a=arguments[0],l=arguments[1];if(!this.isEquivalentClass(a))return!1;var o=a;if(this._points.size()!==o._points.size())return!1;for(var f=0;f<this._points.size();f++)if(!i.equal(i._points.getCoordinate(f),o._points.getCoordinate(f),l))return!1;return!0}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){for(var i=this,a=0;a<Math.trunc(this._points.size()/2);a++){var l=i._points.size()-1-a;if(!i._points.getCoordinate(a).equals(i._points.getCoordinate(l)))return i._points.getCoordinate(a).compareTo(i._points.getCoordinate(l))>0&&oo.reverse(i._points),null}},t.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},t.prototype.getBoundaryDimension=function(){return this.isClosed()?Xr.FALSE:0},t.prototype.isClosed=function(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},t.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},t.prototype.getDimension=function(){return 1},t.prototype.getLength=function(){return en.computeLength(this._points)},t.prototype.getNumPoints=function(){return this._points.size()},t.prototype.reverse=function(){var i=this._points.copy();oo.reverse(i);var a=this.getFactory().createLineString(i);return a},t.prototype.compareToSameClass=function(){var i=this;if(arguments.length===1){for(var a=arguments[0],l=a,o=0,f=0;o<this._points.size()&&f<l._points.size();){var p=i._points.getCoordinate(o).compareTo(l._points.getCoordinate(f));if(p!==0)return p;o++,f++}return o<this._points.size()?1:f<l._points.size()?-1:0}else if(arguments.length===2){var y=arguments[0],x=arguments[1],w=y;return x.compare(this._points,w._points)}},t.prototype.apply=function(){var i=this;if(Pn(arguments[0],pc))for(var a=arguments[0],l=0;l<this._points.size();l++)a.filter(i._points.getCoordinate(l));else if(Pn(arguments[0],Ml)){var o=arguments[0];if(this._points.size()===0)return null;for(var f=0;f<this._points.size()&&(o.filter(i._points,f),!o.isDone());f++);o.isGeometryChanged()&&this.geometryChanged()}else if(Pn(arguments[0],vu)){var p=arguments[0];p.filter(this)}else if(Pn(arguments[0],nh)){var y=arguments[0];y.filter(this)}},t.prototype.getBoundary=function(){return new tl(this).getBoundary()},t.prototype.isEquivalentClass=function(i){return i instanceof t},t.prototype.clone=function(){var i=e.prototype.clone.call(this);return i._points=this._points.clone(),i},t.prototype.getCoordinateN=function(i){return this._points.getCoordinate(i)},t.prototype.getGeometryType=function(){return"LineString"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._points},t.prototype.isEmpty=function(){return this._points.size()===0},t.prototype.init=function(i){if(i===null&&(i=this.getFactory().getCoordinateSequenceFactory().create([])),i.size()===1)throw new Ui("Invalid number of points in LineString (found "+i.size()+" - must be 0 or >= 2)");this._points=i},t.prototype.isCoordinate=function(i){for(var a=this,l=0;l<this._points.size();l++)if(a._points.getCoordinate(l).equals(i))return!0;return!1},t.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},t.prototype.getPointN=function(i){return this.getFactory().createPoint(this._points.getCoordinate(i))},t.prototype.interfaces_=function(){return[_0]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(t,n),t}(Cn),x0=function(){};x0.prototype.interfaces_=function(){return[]};x0.prototype.getClass=function(){return x0};var ms=function(e){function t(r,i){e.call(this,i),this._coordinates=r||null,this.init(this._coordinates)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new _n;var i=new _n;return i.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),i},t.prototype.getSortIndex=function(){return e.SORTINDEX_POINT},t.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},t.prototype.equalsExact=function(){if(arguments.length===2){var i=arguments[0],a=arguments[1];return this.isEquivalentClass(i)?this.isEmpty()&&i.isEmpty()?!0:this.isEmpty()!==i.isEmpty()?!1:this.equal(i.getCoordinate(),this.getCoordinate(),a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){},t.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},t.prototype.getBoundaryDimension=function(){return Xr.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getNumPoints=function(){return this.isEmpty()?0:1},t.prototype.reverse=function(){return this.copy()},t.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},t.prototype.compareToSameClass=function(){if(arguments.length===1){var i=arguments[0],a=i;return this.getCoordinate().compareTo(a.getCoordinate())}else if(arguments.length===2){var l=arguments[0],o=arguments[1],f=l;return o.compare(this._coordinates,f._coordinates)}},t.prototype.apply=function(){if(Pn(arguments[0],pc)){var i=arguments[0];if(this.isEmpty())return null;i.filter(this.getCoordinate())}else if(Pn(arguments[0],Ml)){var a=arguments[0];if(this.isEmpty())return null;a.filter(this._coordinates,0),a.isGeometryChanged()&&this.geometryChanged()}else if(Pn(arguments[0],vu)){var l=arguments[0];l.filter(this)}else if(Pn(arguments[0],nh)){var o=arguments[0];o.filter(this)}},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.clone=function(){var i=e.prototype.clone.call(this);return i._coordinates=this._coordinates.clone(),i},t.prototype.getGeometryType=function(){return"Point"},t.prototype.copy=function(){return new t(this._coordinates.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._coordinates},t.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},t.prototype.isEmpty=function(){return this._coordinates.size()===0},t.prototype.init=function(i){i===null&&(i=this.getFactory().getCoordinateSequenceFactory().create([])),Xn.isTrue(i.size()<=1),this._coordinates=i},t.prototype.isSimple=function(){return!0},t.prototype.interfaces_=function(){return[x0]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(t,n),t}(Cn),qh=function(){};qh.prototype.interfaces_=function(){return[]};qh.prototype.getClass=function(){return qh};var Ro=function(e){function t(r,i,a){if(e.call(this,a),this._shell=null,this._holes=null,r===null&&(r=this.getFactory().createLinearRing()),i===null&&(i=[]),e.hasNullElements(i))throw new Ui("holes must not contain null elements");if(r.isEmpty()&&e.hasNonEmptyElements(i))throw new Ui("shell is empty but holes are not");this._shell=r,this._holes=i}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},t.prototype.getSortIndex=function(){return e.SORTINDEX_POLYGON},t.prototype.getCoordinates=function(){var i=this;if(this.isEmpty())return[];for(var a=new Array(this.getNumPoints()).fill(null),l=-1,o=this._shell.getCoordinates(),f=0;f<o.length;f++)l++,a[l]=o[f];for(var p=0;p<this._holes.length;p++)for(var y=i._holes[p].getCoordinates(),x=0;x<y.length;x++)l++,a[l]=y[x];return a},t.prototype.getArea=function(){var i=this,a=0;a+=Math.abs(en.signedArea(this._shell.getCoordinateSequence()));for(var l=0;l<this._holes.length;l++)a-=Math.abs(en.signedArea(i._holes[l].getCoordinateSequence()));return a},t.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var i=this._shell.getCoordinateSequence(),a=this.getEnvelopeInternal(),l=0;l<5;l++){var o=i.getX(l);if(!(o===a.getMinX()||o===a.getMaxX()))return!1;var f=i.getY(l);if(!(f===a.getMinY()||f===a.getMaxY()))return!1}for(var p=i.getX(0),y=i.getY(0),x=1;x<=4;x++){var w=i.getX(x),S=i.getY(x),L=w!==p,D=S!==y;if(L===D)return!1;p=w,y=S}return!0},t.prototype.equalsExact=function(){var i=this;if(arguments.length===2){var a=arguments[0],l=arguments[1];if(!this.isEquivalentClass(a))return!1;var o=a,f=this._shell,p=o._shell;if(!f.equalsExact(p,l)||this._holes.length!==o._holes.length)return!1;for(var y=0;y<this._holes.length;y++)if(!i._holes[y].equalsExact(o._holes[y],l))return!1;return!0}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.normalize=function(){var i=this;if(arguments.length===0){this.normalize(this._shell,!0);for(var a=0;a<this._holes.length;a++)i.normalize(i._holes[a],!1);td.sort(this._holes)}else if(arguments.length===2){var l=arguments[0],o=arguments[1];if(l.isEmpty())return null;var f=new Array(l.getCoordinates().length-1).fill(null);la.arraycopy(l.getCoordinates(),0,f,0,f.length);var p=ir.minCoordinate(l.getCoordinates());ir.scroll(f,p),la.arraycopy(f,0,l.getCoordinates(),0,f.length),l.getCoordinates()[f.length]=f[0],en.isCCW(l.getCoordinates())===o&&ir.reverse(l.getCoordinates())}},t.prototype.getCoordinate=function(){return this._shell.getCoordinate()},t.prototype.getNumInteriorRing=function(){return this._holes.length},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.getLength=function(){var i=this,a=0;a+=this._shell.getLength();for(var l=0;l<this._holes.length;l++)a+=i._holes[l].getLength();return a},t.prototype.getNumPoints=function(){for(var i=this,a=this._shell.getNumPoints(),l=0;l<this._holes.length;l++)a+=i._holes[l].getNumPoints();return a},t.prototype.reverse=function(){var i=this,a=this.copy();a._shell=this._shell.copy().reverse(),a._holes=new Array(this._holes.length).fill(null);for(var l=0;l<this._holes.length;l++)a._holes[l]=i._holes[l].copy().reverse();return a},t.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},t.prototype.compareToSameClass=function(){var i=this;if(arguments.length===1){var a=arguments[0],l=this._shell,o=a._shell;return l.compareToSameClass(o)}else if(arguments.length===2){var f=arguments[0],p=arguments[1],y=f,x=this._shell,w=y._shell,S=x.compareToSameClass(w,p);if(S!==0)return S;for(var L=this.getNumInteriorRing(),D=y.getNumInteriorRing(),B=0;B<L&&B<D;){var z=i.getInteriorRingN(B),M=y.getInteriorRingN(B),k=z.compareToSameClass(M,p);if(k!==0)return k;B++}return B<L?1:B<D?-1:0}},t.prototype.apply=function(i){var a=this;if(Pn(i,pc)){this._shell.apply(i);for(var l=0;l<this._holes.length;l++)a._holes[l].apply(i)}else if(Pn(i,Ml)){if(this._shell.apply(i),!i.isDone())for(var o=0;o<this._holes.length&&(a._holes[o].apply(i),!i.isDone());o++);i.isGeometryChanged()&&this.geometryChanged()}else if(Pn(i,vu))i.filter(this);else if(Pn(i,nh)){i.filter(this),this._shell.apply(i);for(var f=0;f<this._holes.length;f++)a._holes[f].apply(i)}},t.prototype.getBoundary=function(){var i=this;if(this.isEmpty())return this.getFactory().createMultiLineString();var a=new Array(this._holes.length+1).fill(null);a[0]=this._shell;for(var l=0;l<this._holes.length;l++)a[l+1]=i._holes[l];return a.length<=1?this.getFactory().createLinearRing(a[0].getCoordinateSequence()):this.getFactory().createMultiLineString(a)},t.prototype.clone=function(){var i=this,a=e.prototype.clone.call(this);a._shell=this._shell.clone(),a._holes=new Array(this._holes.length).fill(null);for(var l=0;l<this._holes.length;l++)a._holes[l]=i._holes[l].clone();return a},t.prototype.getGeometryType=function(){return"Polygon"},t.prototype.copy=function(){for(var i=this,a=this._shell.copy(),l=new Array(this._holes.length).fill(null),o=0;o<l.length;o++)l[o]=i._holes[o].copy();return new t(a,l,this._factory)},t.prototype.getExteriorRing=function(){return this._shell},t.prototype.isEmpty=function(){return this._shell.isEmpty()},t.prototype.getInteriorRingN=function(i){return this._holes[i]},t.prototype.interfaces_=function(){return[qh]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(t,n),t}(Cn),iy=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Cn.SORTINDEX_MULTIPOINT},t.prototype.isValid=function(){return!0},t.prototype.equalsExact=function(){if(arguments.length===2){var i=arguments[0],a=arguments[1];return this.isEquivalentClass(i)?e.prototype.equalsExact.call(this,i,a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getCoordinate=function(){if(arguments.length===1){var i=arguments[0];return this._geometries[i].getCoordinate()}else return e.prototype.getCoordinate.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return Xr.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.getGeometryType=function(){return"MultiPoint"},t.prototype.copy=function(){for(var i=this,a=new Array(this._geometries.length).fill(null),l=0;l<a.length;l++)a[l]=i._geometries[l].copy();return new t(a,this._factory)},t.prototype.interfaces_=function(){return[x0]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(t,n),t}(Va),gc=function(e){function t(r,i){r instanceof $e&&i instanceof rr&&(r=i.getCoordinateSequenceFactory().create(r)),e.call(this,r,i),this.validateConstruction()}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Cn.SORTINDEX_LINEARRING},t.prototype.getBoundaryDimension=function(){return Xr.FALSE},t.prototype.isClosed=function(){return this.isEmpty()?!0:e.prototype.isClosed.call(this)},t.prototype.reverse=function(){var i=this._points.copy();oo.reverse(i);var a=this.getFactory().createLinearRing(i);return a},t.prototype.validateConstruction=function(){if(!this.isEmpty()&&!e.prototype.isClosed.call(this))throw new Ui("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new Ui("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},t.prototype.getGeometryType=function(){return"LinearRing"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(t,n),t}(Ki),fc=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={serialVersionUID:{configurable:!0}};return t.prototype.getSortIndex=function(){return Cn.SORTINDEX_MULTIPOLYGON},t.prototype.equalsExact=function(){if(arguments.length===2){var i=arguments[0],a=arguments[1];return this.isEquivalentClass(i)?e.prototype.equalsExact.call(this,i,a):!1}else return e.prototype.equalsExact.apply(this,arguments)},t.prototype.getBoundaryDimension=function(){return 1},t.prototype.getDimension=function(){return 2},t.prototype.reverse=function(){for(var i=this,a=this._geometries.length,l=new Array(a).fill(null),o=0;o<this._geometries.length;o++)l[o]=i._geometries[o].reverse();return this.getFactory().createMultiPolygon(l)},t.prototype.getBoundary=function(){var i=this;if(this.isEmpty())return this.getFactory().createMultiLineString();for(var a=new jt,l=0;l<this._geometries.length;l++)for(var o=i._geometries[l],f=o.getBoundary(),p=0;p<f.getNumGeometries();p++)a.add(f.getGeometryN(p));var y=new Array(a.size()).fill(null);return this.getFactory().createMultiLineString(a.toArray(y))},t.prototype.getGeometryType=function(){return"MultiPolygon"},t.prototype.copy=function(){for(var i=this,a=new Array(this._geometries.length).fill(null),l=0;l<a.length;l++)a[l]=i._geometries[l].copy();return new t(a,this._factory)},t.prototype.interfaces_=function(){return[qh]},t.prototype.getClass=function(){return t},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(t,n),t}(Va),ul=function(t){this._factory=t||null,this._isUserDataCopied=!1},Bw={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};ul.prototype.setCopyUserData=function(t){this._isUserDataCopied=t};ul.prototype.edit=function(t,n){if(t===null)return null;var r=this.editInternal(t,n);return this._isUserDataCopied&&r.setUserData(t.getUserData()),r};ul.prototype.editInternal=function(t,n){return this._factory===null&&(this._factory=t.getFactory()),t instanceof Va?this.editGeometryCollection(t,n):t instanceof Ro?this.editPolygon(t,n):t instanceof ms?n.edit(t,this._factory):t instanceof Ki?n.edit(t,this._factory):(Xn.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)};ul.prototype.editGeometryCollection=function(t,n){for(var r=this,i=n.edit(t,this._factory),a=new jt,l=0;l<i.getNumGeometries();l++){var o=r.edit(i.getGeometryN(l),n);o===null||o.isEmpty()||a.add(o)}return i.getClass()===iy?this._factory.createMultiPoint(a.toArray([])):i.getClass()===sd?this._factory.createMultiLineString(a.toArray([])):i.getClass()===fc?this._factory.createMultiPolygon(a.toArray([])):this._factory.createGeometryCollection(a.toArray([]))};ul.prototype.editPolygon=function(t,n){var r=this,i=n.edit(t,this._factory);if(i===null&&(i=this._factory.createPolygon(null)),i.isEmpty())return i;var a=this.edit(i.getExteriorRing(),n);if(a===null||a.isEmpty())return this._factory.createPolygon();for(var l=new jt,o=0;o<i.getNumInteriorRing();o++){var f=r.edit(i.getInteriorRingN(o),n);f===null||f.isEmpty()||l.add(f)}return this._factory.createPolygon(a,l.toArray([]))};ul.prototype.interfaces_=function(){return[]};ul.prototype.getClass=function(){return ul};ul.GeometryEditorOperation=function(){};Bw.NoOpGeometryOperation.get=function(){return b0};Bw.CoordinateOperation.get=function(){return w0};Bw.CoordinateSequenceOperation.get=function(){return E0};Object.defineProperties(ul,Bw);var b0=function(){};b0.prototype.edit=function(t,n){return t};b0.prototype.interfaces_=function(){return[ul.GeometryEditorOperation]};b0.prototype.getClass=function(){return b0};var w0=function(){};w0.prototype.edit=function(t,n){var r=this.editCoordinates(t.getCoordinates(),t);return r===null?t:t instanceof gc?n.createLinearRing(r):t instanceof Ki?n.createLineString(r):t instanceof ms?r.length>0?n.createPoint(r[0]):n.createPoint():t};w0.prototype.interfaces_=function(){return[ul.GeometryEditorOperation]};w0.prototype.getClass=function(){return w0};var E0=function(){};E0.prototype.edit=function(t,n){return t instanceof gc?n.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Ki?n.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof ms?n.createPoint(this.edit(t.getCoordinateSequence(),t)):t};E0.prototype.interfaces_=function(){return[ul.GeometryEditorOperation]};E0.prototype.getClass=function(){return E0};var ro=function(){var t=this;if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var n=arguments[0];this._coordinates=new Array(n).fill(null);for(var r=0;r<n;r++)t._coordinates[r]=new $e}else if(Pn(arguments[0],pr)){var i=arguments[0];if(i===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=i.getDimension(),this._coordinates=new Array(i.size()).fill(null);for(var a=0;a<this._coordinates.length;a++)t._coordinates[a]=i.getCoordinateCopy(a)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var l=arguments[0],o=arguments[1];this._coordinates=l,this._dimension=o,l===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var f=arguments[0],p=arguments[1];this._coordinates=new Array(f).fill(null),this._dimension=p;for(var y=0;y<f;y++)t._coordinates[y]=new $e}}},U4={serialVersionUID:{configurable:!0}};ro.prototype.setOrdinate=function(t,n,r){switch(n){case pr.X:this._coordinates[t].x=r;break;case pr.Y:this._coordinates[t].y=r;break;case pr.Z:this._coordinates[t].z=r;break;default:throw new Ui("invalid ordinateIndex")}};ro.prototype.size=function(){return this._coordinates.length};ro.prototype.getOrdinate=function(t,n){switch(n){case pr.X:return this._coordinates[t].x;case pr.Y:return this._coordinates[t].y;case pr.Z:return this._coordinates[t].z}return Nn.NaN};ro.prototype.getCoordinate=function(){if(arguments.length===1){var t=arguments[0];return this._coordinates[t]}else if(arguments.length===2){var n=arguments[0],r=arguments[1];r.x=this._coordinates[n].x,r.y=this._coordinates[n].y,r.z=this._coordinates[n].z}};ro.prototype.getCoordinateCopy=function(t){return new $e(this._coordinates[t])};ro.prototype.getDimension=function(){return this._dimension};ro.prototype.getX=function(t){return this._coordinates[t].x};ro.prototype.clone=function(){for(var t=this,n=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)n[r]=t._coordinates[r].clone();return new ro(n,this._dimension)};ro.prototype.expandEnvelope=function(t){for(var n=this,r=0;r<this._coordinates.length;r++)t.expandToInclude(n._coordinates[r]);return t};ro.prototype.copy=function(){for(var t=this,n=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)n[r]=t._coordinates[r].copy();return new ro(n,this._dimension)};ro.prototype.toString=function(){var t=this;if(this._coordinates.length>0){var n=new Pu(17*this._coordinates.length);n.append("("),n.append(this._coordinates[0]);for(var r=1;r<this._coordinates.length;r++)n.append(", "),n.append(t._coordinates[r]);return n.append(")"),n.toString()}else return"()"};ro.prototype.getY=function(t){return this._coordinates[t].y};ro.prototype.toCoordinateArray=function(){return this._coordinates};ro.prototype.interfaces_=function(){return[pr,dl]};ro.prototype.getClass=function(){return ro};U4.serialVersionUID.get=function(){return-0xcb44a778db18e00};Object.defineProperties(ro,U4);var mc=function(){},D2={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};mc.prototype.readResolve=function(){return mc.instance()};mc.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return new ro(t)}else if(Pn(arguments[0],pr)){var n=arguments[0];return new ro(n)}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];return i>3&&(i=3),i<2?new ro(r):new ro(r,i)}};mc.prototype.interfaces_=function(){return[Jm,dl]};mc.prototype.getClass=function(){return mc};mc.instance=function(){return mc.instanceObject};D2.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00};D2.instanceObject.get=function(){return new mc};Object.defineProperties(mc,D2);var V4=function(e){function t(){e.call(this),this.map_=new Map}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(r){return this.map_.get(r)||null},t.prototype.put=function(r,i){return this.map_.set(r,i),i},t.prototype.values=function(){for(var r=new jt,i=this.map_.values(),a=i.next();!a.done;)r.add(a.value),a=i.next();return r},t.prototype.entrySet=function(){var r=new L2;return this.map_.entries().forEach(function(i){return r.add(i)}),r},t.prototype.size=function(){return this.map_.size()},t}(cg),Hr=function e(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=e.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof _u){var t=arguments[0];this._modelType=t,t===e.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var n=arguments[0];this._modelType=e.FIXED,this.setScale(n)}else if(arguments[0]instanceof e){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}}},R2={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Hr.prototype.equals=function(t){if(!(t instanceof Hr))return!1;var n=t;return this._modelType===n._modelType&&this._scale===n._scale};Hr.prototype.compareTo=function(t){var n=t,r=this.getMaximumSignificantDigits(),i=n.getMaximumSignificantDigits();return new mu(r).compareTo(new mu(i))};Hr.prototype.getScale=function(){return this._scale};Hr.prototype.isFloating=function(){return this._modelType===Hr.FLOATING||this._modelType===Hr.FLOATING_SINGLE};Hr.prototype.getType=function(){return this._modelType};Hr.prototype.toString=function(){var t="UNKNOWN";return this._modelType===Hr.FLOATING?t="Floating":this._modelType===Hr.FLOATING_SINGLE?t="Floating-Single":this._modelType===Hr.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t};Hr.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var t=arguments[0];if(Nn.isNaN(t))return t;if(this._modelType===Hr.FLOATING_SINGLE){var n=t;return n}return this._modelType===Hr.FIXED?Math.round(t*this._scale)/this._scale:t}else if(arguments[0]instanceof $e){var r=arguments[0];if(this._modelType===Hr.FLOATING)return null;r.x=this.makePrecise(r.x),r.y=this.makePrecise(r.y)}};Hr.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===Hr.FLOATING?t=16:this._modelType===Hr.FLOATING_SINGLE?t=6:this._modelType===Hr.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t};Hr.prototype.setScale=function(t){this._scale=Math.abs(t)};Hr.prototype.interfaces_=function(){return[dl,fl]};Hr.prototype.getClass=function(){return Hr};Hr.mostPrecise=function(t,n){return t.compareTo(n)>=0?t:n};R2.serialVersionUID.get=function(){return 7777263578777804e3};R2.maximumPreciseValue.get=function(){return 9007199254740992};Object.defineProperties(Hr,R2);var _u=function e(t){this._name=t||null,e.nameToTypeMap.put(t,this)},k2={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};_u.prototype.readResolve=function(){return _u.nameToTypeMap.get(this._name)};_u.prototype.toString=function(){return this._name};_u.prototype.interfaces_=function(){return[dl]};_u.prototype.getClass=function(){return _u};k2.serialVersionUID.get=function(){return-552860263173159e4};k2.nameToTypeMap.get=function(){return new V4};Object.defineProperties(_u,k2);Hr.Type=_u;Hr.FIXED=new _u("FIXED");Hr.FLOATING=new _u("FLOATING");Hr.FLOATING_SINGLE=new _u("FLOATING SINGLE");var rr=function e(){this._precisionModel=new Hr,this._SRID=0,this._coordinateSequenceFactory=e.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?Pn(arguments[0],Jm)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Hr&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},G4={serialVersionUID:{configurable:!0}};rr.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new $e(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new $e(t.getMinX(),t.getMinY()),new $e(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new $e(t.getMinX(),t.getMinY()),new $e(t.getMinX(),t.getMaxY()),new $e(t.getMaxX(),t.getMaxY()),new $e(t.getMaxX(),t.getMinY()),new $e(t.getMinX(),t.getMinY())]),null)};rr.prototype.createLineString=function(t){if(t){if(t instanceof Array)return new Ki(this.getCoordinateSequenceFactory().create(t),this);if(Pn(t,pr))return new Ki(t,this)}else return new Ki(this.getCoordinateSequenceFactory().create([]),this)};rr.prototype.createMultiLineString=function(){if(arguments.length===0)return new sd(null,this);if(arguments.length===1){var t=arguments[0];return new sd(t,this)}};rr.prototype.buildGeometry=function(t){for(var n=null,r=!1,i=!1,a=t.iterator();a.hasNext();){var l=a.next(),o=l.getClass();n===null&&(n=o),o!==n&&(r=!0),l.isGeometryCollectionOrDerived()&&(i=!0)}if(n===null)return this.createGeometryCollection();if(r||i)return this.createGeometryCollection(rr.toGeometryArray(t));var f=t.iterator().next(),p=t.size()>1;if(p){if(f instanceof Ro)return this.createMultiPolygon(rr.toPolygonArray(t));if(f instanceof Ki)return this.createMultiLineString(rr.toLineStringArray(t));if(f instanceof ms)return this.createMultiPoint(rr.toPointArray(t));Xn.shouldNeverReachHere("Unhandled class: "+f.getClass().getName())}return f};rr.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(t!==null?this.getCoordinateSequenceFactory().create(t):null)};rr.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof $e){var t=arguments[0];return this.createPoint(t!==null?this.getCoordinateSequenceFactory().create([t]):null)}else if(Pn(arguments[0],pr)){var n=arguments[0];return new ms(n,this)}}};rr.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory};rr.prototype.createPolygon=function(){if(arguments.length===0)return new Ro(null,null,this);if(arguments.length===1){if(Pn(arguments[0],pr)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}else if(arguments[0]instanceof Array){var n=arguments[0];return this.createPolygon(this.createLinearRing(n))}else if(arguments[0]instanceof gc){var r=arguments[0];return this.createPolygon(r,null)}}else if(arguments.length===2){var i=arguments[0],a=arguments[1];return new Ro(i,a,this)}};rr.prototype.getSRID=function(){return this._SRID};rr.prototype.createGeometryCollection=function(){if(arguments.length===0)return new Va(null,this);if(arguments.length===1){var t=arguments[0];return new Va(t,this)}};rr.prototype.createGeometry=function(t){var n=new ul(this);return n.edit(t,{edit:function(){if(arguments.length===2){var r=arguments[0];return this._coordinateSequenceFactory.create(r)}}})};rr.prototype.getPrecisionModel=function(){return this._precisionModel};rr.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(t!==null?this.getCoordinateSequenceFactory().create(t):null)}else if(Pn(arguments[0],pr)){var n=arguments[0];return new gc(n,this)}}};rr.prototype.createMultiPolygon=function(){if(arguments.length===0)return new fc(null,this);if(arguments.length===1){var t=arguments[0];return new fc(t,this)}};rr.prototype.createMultiPoint=function(){var t=this;if(arguments.length===0)return new iy(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var n=arguments[0];return new iy(n,this)}else if(arguments[0]instanceof Array){var r=arguments[0];return this.createMultiPoint(r!==null?this.getCoordinateSequenceFactory().create(r):null)}else if(Pn(arguments[0],pr)){var i=arguments[0];if(i===null)return this.createMultiPoint(new Array(0).fill(null));for(var a=new Array(i.size()).fill(null),l=0;l<i.size();l++){var o=t.getCoordinateSequenceFactory().create(1,i.getDimension());oo.copy(i,l,o,0,1),a[l]=t.createPoint(o)}return this.createMultiPoint(a)}}};rr.prototype.interfaces_=function(){return[dl]};rr.prototype.getClass=function(){return rr};rr.toMultiPolygonArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};rr.toGeometryArray=function(t){if(t===null)return null;var n=new Array(t.size()).fill(null);return t.toArray(n)};rr.getDefaultCoordinateSequenceFactory=function(){return mc.instance()};rr.toMultiLineStringArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};rr.toLineStringArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};rr.toMultiPointArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};rr.toLinearRingArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};rr.toPointArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};rr.toPolygonArray=function(t){var n=new Array(t.size()).fill(null);return t.toArray(n)};rr.createPointFromInternalCoord=function(t,n){return n.getPrecisionModel().makePrecise(t),n.getFactory().createPoint(t)};G4.serialVersionUID.get=function(){return-6820524753094096e3};Object.defineProperties(rr,G4);var $W=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],zw=function(t){this.geometryFactory=t||new rr};zw.prototype.read=function(t){var n;typeof t=="string"?n=JSON.parse(t):n=t;var r=n.type;if(!ou[r])throw new Error("Unknown GeoJSON type: "+n.type);return $W.indexOf(r)!==-1?ou[r].apply(this,[n.coordinates]):r==="GeometryCollection"?ou[r].apply(this,[n.geometries]):ou[r].apply(this,[n])};zw.prototype.write=function(t){var n=t.getGeometryType();if(!$c[n])throw new Error("Geometry is not supported");return $c[n].apply(this,[t])};var ou={Feature:function(e){var t={};for(var n in e)t[n]=e[n];if(e.geometry){var r=e.geometry.type;if(!ou[r])throw new Error("Unknown GeoJSON type: "+e.type);t.geometry=this.read(e.geometry)}return e.bbox&&(t.bbox=ou.bbox.apply(this,[e.bbox])),t},FeatureCollection:function(e){var t=this,n={};if(e.features){n.features=[];for(var r=0;r<e.features.length;++r)n.features.push(t.read(e.features[r]))}return e.bbox&&(n.bbox=this.parse.bbox.apply(this,[e.bbox])),n},coordinates:function(e){for(var t=[],n=0;n<e.length;++n){var r=e[n];t.push(new $e(r[0],r[1]))}return t},bbox:function(e){return this.geometryFactory.createLinearRing([new $e(e[0],e[1]),new $e(e[2],e[1]),new $e(e[2],e[3]),new $e(e[0],e[3]),new $e(e[0],e[1])])},Point:function(e){var t=new $e(e[0],e[1]);return this.geometryFactory.createPoint(t)},MultiPoint:function(e){for(var t=this,n=[],r=0;r<e.length;++r)n.push(ou.Point.apply(t,[e[r]]));return this.geometryFactory.createMultiPoint(n)},LineString:function(e){var t=ou.coordinates.apply(this,[e]);return this.geometryFactory.createLineString(t)},MultiLineString:function(e){for(var t=this,n=[],r=0;r<e.length;++r)n.push(ou.LineString.apply(t,[e[r]]));return this.geometryFactory.createMultiLineString(n)},Polygon:function(e){for(var t=this,n=ou.coordinates.apply(this,[e[0]]),r=this.geometryFactory.createLinearRing(n),i=[],a=1;a<e.length;++a){var l=e[a],o=ou.coordinates.apply(t,[l]),f=t.geometryFactory.createLinearRing(o);i.push(f)}return this.geometryFactory.createPolygon(r,i)},MultiPolygon:function(e){for(var t=this,n=[],r=0;r<e.length;++r){var i=e[r];n.push(ou.Polygon.apply(t,[i]))}return this.geometryFactory.createMultiPolygon(n)},GeometryCollection:function(e){for(var t=this,n=[],r=0;r<e.length;++r){var i=e[r];n.push(t.read(i))}return this.geometryFactory.createGeometryCollection(n)}},$c={coordinate:function(e){return[e.x,e.y]},Point:function(e){var t=$c.coordinate.apply(this,[e.getCoordinate()]);return{type:"Point",coordinates:t}},MultiPoint:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var i=e._geometries[r],a=$c.Point.apply(t,[i]);n.push(a.coordinates)}return{type:"MultiPoint",coordinates:n}},LineString:function(e){for(var t=this,n=[],r=e.getCoordinates(),i=0;i<r.length;++i){var a=r[i];n.push($c.coordinate.apply(t,[a]))}return{type:"LineString",coordinates:n}},MultiLineString:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var i=e._geometries[r],a=$c.LineString.apply(t,[i]);n.push(a.coordinates)}return{type:"MultiLineString",coordinates:n}},Polygon:function(e){var t=this,n=[],r=$c.LineString.apply(this,[e._shell]);n.push(r.coordinates);for(var i=0;i<e._holes.length;++i){var a=e._holes[i],l=$c.LineString.apply(t,[a]);n.push(l.coordinates)}return{type:"Polygon",coordinates:n}},MultiPolygon:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var i=e._geometries[r],a=$c.Polygon.apply(t,[i]);n.push(a.coordinates)}return{type:"MultiPolygon",coordinates:n}},GeometryCollection:function(e){for(var t=this,n=[],r=0;r<e._geometries.length;++r){var i=e._geometries[r],a=i.getGeometryType();n.push($c[a].apply(t,[i]))}return{type:"GeometryCollection",geometries:n}}},N2=function(t){this.geometryFactory=t||new rr,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new zw(this.geometryFactory)};N2.prototype.read=function(t){var n=this.parser.read(t);return this.precisionModel.getType()===Hr.FIXED&&this.reducePrecision(n),n};N2.prototype.reducePrecision=function(t){var n=this,r,i;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(r=0,i=t.points.length;r<i;r++)n.precisionModel.makePrecise(t.points[r]);else if(t.geometries)for(r=0,i=t.geometries.length;r<i;r++)n.reducePrecision(t.geometries[r])};var $4=function(){this.parser=new zw(this.geometryFactory)};$4.prototype.write=function(t){return this.parser.write(t)};var Ft=function(){},Uw={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Ft.prototype.interfaces_=function(){return[]};Ft.prototype.getClass=function(){return Ft};Ft.opposite=function(t){return t===Ft.LEFT?Ft.RIGHT:t===Ft.RIGHT?Ft.LEFT:t};Uw.ON.get=function(){return 0};Uw.LEFT.get=function(){return 1};Uw.RIGHT.get=function(){return 2};Object.defineProperties(Ft,Uw);function Vw(e){this.message=e||""}Vw.prototype=new Error;Vw.prototype.name="EmptyStackException";function Au(){this.array_=[]}Au.prototype=new Cl;Au.prototype.add=function(e){return this.array_.push(e),!0};Au.prototype.get=function(e){if(e<0||e>=this.size())throw new Error;return this.array_[e]};Au.prototype.push=function(e){return this.array_.push(e),e};Au.prototype.pop=function(e){if(this.array_.length===0)throw new Vw;return this.array_.pop()};Au.prototype.peek=function(){if(this.array_.length===0)throw new Vw;return this.array_[this.array_.length-1]};Au.prototype.empty=function(){return this.array_.length===0};Au.prototype.isEmpty=function(){return this.empty()};Au.prototype.search=function(e){return this.array_.indexOf(e)};Au.prototype.size=function(){return this.array_.length};Au.prototype.toArray=function(){for(var e=this,t=[],n=0,r=this.array_.length;n<r;n++)t.push(e.array_[n]);return t};var xu=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};xu.prototype.getCoordinate=function(){return this._minCoord};xu.prototype.getRightmostSide=function(t,n){var r=this.getRightmostSideOfSegment(t,n);return r<0&&(r=this.getRightmostSideOfSegment(t,n-1)),r<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),r};xu.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();Xn.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var n=t[this._minIndex-1],r=t[this._minIndex+1],i=en.computeOrientation(this._minCoord,r,n),a=!1;(n.y<this._minCoord.y&&r.y<this._minCoord.y&&i===en.COUNTERCLOCKWISE||n.y>this._minCoord.y&&r.y>this._minCoord.y&&i===en.CLOCKWISE)&&(a=!0),a&&(this._minIndex=this._minIndex-1)};xu.prototype.getRightmostSideOfSegment=function(t,n){var r=t.getEdge(),i=r.getCoordinates();if(n<0||n+1>=i.length||i[n].y===i[n+1].y)return-1;var a=Ft.LEFT;return i[n].y<i[n+1].y&&(a=Ft.RIGHT),a};xu.prototype.getEdge=function(){return this._orientedDe};xu.prototype.checkForRightmostCoordinate=function(t){for(var n=this,r=t.getEdge().getCoordinates(),i=0;i<r.length-1;i++)(n._minCoord===null||r[i].x>n._minCoord.x)&&(n._minDe=t,n._minIndex=i,n._minCoord=r[i])};xu.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode(),n=t.getEdges();this._minDe=n.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)};xu.prototype.findEdge=function(t){for(var n=this,r=t.iterator();r.hasNext();){var i=r.next();i.isForward()&&n.checkForRightmostCoordinate(i)}Xn.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe;var a=this.getRightmostSide(this._minDe,this._minIndex);a===Ft.LEFT&&(this._orientedDe=this._minDe.getSym())};xu.prototype.interfaces_=function(){return[]};xu.prototype.getClass=function(){return xu};var rh=function(e){function t(n,r){e.call(this,t.msgWithCoord(n,r)),this.pt=r?new $e(r):null,this.name="TopologyException"}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getCoordinate=function(){return this.pt},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.msgWithCoord=function(r,i){return i?r:r+" [ "+i+" ]"},t}(th),Gw=function(){this.array_=[]};Gw.prototype.addLast=function(t){this.array_.push(t)};Gw.prototype.removeFirst=function(){return this.array_.shift()};Gw.prototype.isEmpty=function(){return this.array_.length===0};var Ga=function(){this._finder=null,this._dirEdgeList=new jt,this._nodes=new jt,this._rightMostCoord=null,this._env=null,this._finder=new xu};Ga.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var n=t.next();n.setVisited(!1)}};Ga.prototype.getRightmostCoordinate=function(){return this._rightMostCoord};Ga.prototype.computeNodeDepth=function(t){for(var n=this,r=null,i=t.getEdges().iterator();i.hasNext();){var a=i.next();if(a.isVisited()||a.getSym().isVisited()){r=a;break}}if(r===null)throw new rh("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(r);for(var l=t.getEdges().iterator();l.hasNext();){var o=l.next();o.setVisited(!0),n.copySymDepths(o)}};Ga.prototype.computeDepth=function(t){this.clearVisitedEdges();var n=this._finder.getEdge();n.setEdgeDepths(Ft.RIGHT,t),this.copySymDepths(n),this.computeDepths(n)};Ga.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()};Ga.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var n=t.next();n.getDepth(Ft.RIGHT)>=1&&n.getDepth(Ft.LEFT)<=0&&!n.isInteriorAreaEdge()&&n.setInResult(!0)}};Ga.prototype.computeDepths=function(t){var n=this,r=new L2,i=new Gw,a=t.getNode();for(i.addLast(a),r.add(a),t.setVisited(!0);!i.isEmpty();){var l=i.removeFirst();r.add(l),n.computeNodeDepth(l);for(var o=l.getEdges().iterator();o.hasNext();){var f=o.next(),p=f.getSym();if(!p.isVisited()){var y=p.getNode();r.contains(y)||(i.addLast(y),r.add(y))}}}};Ga.prototype.compareTo=function(t){var n=t;return this._rightMostCoord.x<n._rightMostCoord.x?-1:this._rightMostCoord.x>n._rightMostCoord.x?1:0};Ga.prototype.getEnvelope=function(){if(this._env===null){for(var t=new _n,n=this._dirEdgeList.iterator();n.hasNext();)for(var r=n.next(),i=r.getEdge().getCoordinates(),a=0;a<i.length-1;a++)t.expandToInclude(i[a]);this._env=t}return this._env};Ga.prototype.addReachable=function(t){var n=this,r=new Au;for(r.add(t);!r.empty();){var i=r.pop();n.add(i,r)}};Ga.prototype.copySymDepths=function(t){var n=t.getSym();n.setDepth(Ft.LEFT,t.getDepth(Ft.RIGHT)),n.setDepth(Ft.RIGHT,t.getDepth(Ft.LEFT))};Ga.prototype.add=function(t,n){var r=this;t.setVisited(!0),this._nodes.add(t);for(var i=t.getEdges().iterator();i.hasNext();){var a=i.next();r._dirEdgeList.add(a);var l=a.getSym(),o=l.getNode();o.isVisited()||n.push(o)}};Ga.prototype.getNodes=function(){return this._nodes};Ga.prototype.getDirectedEdges=function(){return this._dirEdgeList};Ga.prototype.interfaces_=function(){return[fl]};Ga.prototype.getClass=function(){return Ga};var Si=function e(){var t=this;if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var n=arguments[0];this.init(n.length)}else if(Number.isInteger(arguments[0])){var r=arguments[0];this.init(1),this.location[Ft.ON]=r}else if(arguments[0]instanceof e){var i=arguments[0];if(this.init(i.location.length),i!==null)for(var a=0;a<this.location.length;a++)t.location[a]=i.location[a]}}else if(arguments.length===3){var l=arguments[0],o=arguments[1],f=arguments[2];this.init(3),this.location[Ft.ON]=l,this.location[Ft.LEFT]=o,this.location[Ft.RIGHT]=f}};Si.prototype.setAllLocations=function(t){for(var n=this,r=0;r<this.location.length;r++)n.location[r]=t};Si.prototype.isNull=function(){for(var t=this,n=0;n<this.location.length;n++)if(t.location[n]!==tt.NONE)return!1;return!0};Si.prototype.setAllLocationsIfNull=function(t){for(var n=this,r=0;r<this.location.length;r++)n.location[r]===tt.NONE&&(n.location[r]=t)};Si.prototype.isLine=function(){return this.location.length===1};Si.prototype.merge=function(t){var n=this;if(t.location.length>this.location.length){var r=new Array(3).fill(null);r[Ft.ON]=this.location[Ft.ON],r[Ft.LEFT]=tt.NONE,r[Ft.RIGHT]=tt.NONE,this.location=r}for(var i=0;i<this.location.length;i++)n.location[i]===tt.NONE&&i<t.location.length&&(n.location[i]=t.location[i])};Si.prototype.getLocations=function(){return this.location};Si.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Ft.LEFT];this.location[Ft.LEFT]=this.location[Ft.RIGHT],this.location[Ft.RIGHT]=t};Si.prototype.toString=function(){var t=new Pu;return this.location.length>1&&t.append(tt.toLocationSymbol(this.location[Ft.LEFT])),t.append(tt.toLocationSymbol(this.location[Ft.ON])),this.location.length>1&&t.append(tt.toLocationSymbol(this.location[Ft.RIGHT])),t.toString()};Si.prototype.setLocations=function(t,n,r){this.location[Ft.ON]=t,this.location[Ft.LEFT]=n,this.location[Ft.RIGHT]=r};Si.prototype.get=function(t){return t<this.location.length?this.location[t]:tt.NONE};Si.prototype.isArea=function(){return this.location.length>1};Si.prototype.isAnyNull=function(){for(var t=this,n=0;n<this.location.length;n++)if(t.location[n]===tt.NONE)return!0;return!1};Si.prototype.setLocation=function(){if(arguments.length===1){var t=arguments[0];this.setLocation(Ft.ON,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.location[n]=r}};Si.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(tt.NONE)};Si.prototype.isEqualOnSide=function(t,n){return this.location[n]===t.location[n]};Si.prototype.allPositionsEqual=function(t){for(var n=this,r=0;r<this.location.length;r++)if(n.location[r]!==t)return!1;return!0};Si.prototype.interfaces_=function(){return[]};Si.prototype.getClass=function(){return Si};var ri=function e(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new Si(t),this.elt[1]=new Si(t)}else if(arguments[0]instanceof e){var n=arguments[0];this.elt[0]=new Si(n.elt[0]),this.elt[1]=new Si(n.elt[1])}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];this.elt[0]=new Si(tt.NONE),this.elt[1]=new Si(tt.NONE),this.elt[r].setLocation(i)}else if(arguments.length===3){var a=arguments[0],l=arguments[1],o=arguments[2];this.elt[0]=new Si(a,l,o),this.elt[1]=new Si(a,l,o)}else if(arguments.length===4){var f=arguments[0],p=arguments[1],y=arguments[2],x=arguments[3];this.elt[0]=new Si(tt.NONE,tt.NONE,tt.NONE),this.elt[1]=new Si(tt.NONE,tt.NONE,tt.NONE),this.elt[f].setLocations(p,y,x)}};ri.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t};ri.prototype.setAllLocations=function(t,n){this.elt[t].setAllLocations(n)};ri.prototype.isNull=function(t){return this.elt[t].isNull()};ri.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.elt[n].setAllLocationsIfNull(r)}};ri.prototype.isLine=function(t){return this.elt[t].isLine()};ri.prototype.merge=function(t){for(var n=this,r=0;r<2;r++)n.elt[r]===null&&t.elt[r]!==null?n.elt[r]=new Si(t.elt[r]):n.elt[r].merge(t.elt[r])};ri.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()};ri.prototype.getLocation=function(){if(arguments.length===1){var t=arguments[0];return this.elt[t].get(Ft.ON)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.elt[n].get(r)}};ri.prototype.toString=function(){var t=new Pu;return this.elt[0]!==null&&(t.append("A:"),t.append(this.elt[0].toString())),this.elt[1]!==null&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()};ri.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var t=arguments[0];return this.elt[t].isArea()}};ri.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()};ri.prototype.setLocation=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];this.elt[t].setLocation(Ft.ON,n)}else if(arguments.length===3){var r=arguments[0],i=arguments[1],a=arguments[2];this.elt[r].setLocation(i,a)}};ri.prototype.isEqualOnSide=function(t,n){return this.elt[0].isEqualOnSide(t.elt[0],n)&&this.elt[1].isEqualOnSide(t.elt[1],n)};ri.prototype.allPositionsEqual=function(t,n){return this.elt[t].allPositionsEqual(n)};ri.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Si(this.elt[t].location[0]))};ri.prototype.interfaces_=function(){return[]};ri.prototype.getClass=function(){return ri};ri.toLineLabel=function(t){for(var n=new ri(tt.NONE),r=0;r<2;r++)n.setLocation(r,t.getLocation(r));return n};var yo=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new jt,this._pts=new jt,this._label=new ri(tt.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new jt,this._geometryFactory=null;var t=arguments[0],n=arguments[1];this._geometryFactory=n,this.computePoints(t),this.computeRing()};yo.prototype.computeRing=function(){var t=this;if(this._ring!==null)return null;for(var n=new Array(this._pts.size()).fill(null),r=0;r<this._pts.size();r++)n[r]=t._pts.get(r);this._ring=this._geometryFactory.createLinearRing(n),this._isHole=en.isCCW(this._ring.getCoordinates())};yo.prototype.isIsolated=function(){return this._label.getGeometryCount()===1};yo.prototype.computePoints=function(t){var n=this;this._startDe=t;var r=t,i=!0;do{if(r===null)throw new rh("Found null DirectedEdge");if(r.getEdgeRing()===n)throw new rh("Directed Edge visited twice during ring-building at "+r.getCoordinate());n._edges.add(r);var a=r.getLabel();Xn.isTrue(a.isArea()),n.mergeLabel(a),n.addPoints(r.getEdge(),r.isForward(),i),i=!1,n.setEdgeRing(r,n),r=n.getNext(r)}while(r!==this._startDe)};yo.prototype.getLinearRing=function(){return this._ring};yo.prototype.getCoordinate=function(t){return this._pts.get(t)};yo.prototype.computeMaxNodeDegree=function(){var t=this;this._maxNodeDegree=0;var n=this._startDe;do{var r=n.getNode(),i=r.getEdges().getOutgoingDegree(t);i>t._maxNodeDegree&&(t._maxNodeDegree=i),n=t.getNext(n)}while(n!==this._startDe);this._maxNodeDegree*=2};yo.prototype.addPoints=function(t,n,r){var i=this,a=t.getCoordinates();if(n){var l=1;r&&(l=0);for(var o=l;o<a.length;o++)i._pts.add(a[o])}else{var f=a.length-2;r&&(f=a.length-1);for(var p=f;p>=0;p--)i._pts.add(a[p])}};yo.prototype.isHole=function(){return this._isHole};yo.prototype.setInResult=function(){var t=this._startDe;do t.getEdge().setInResult(!0),t=t.getNext();while(t!==this._startDe)};yo.prototype.containsPoint=function(t){var n=this.getLinearRing(),r=n.getEnvelopeInternal();if(!r.contains(t)||!en.isPointInRing(t,n.getCoordinates()))return!1;for(var i=this._holes.iterator();i.hasNext();){var a=i.next();if(a.containsPoint(t))return!1}return!0};yo.prototype.addHole=function(t){this._holes.add(t)};yo.prototype.isShell=function(){return this._shell===null};yo.prototype.getLabel=function(){return this._label};yo.prototype.getEdges=function(){return this._edges};yo.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree};yo.prototype.getShell=function(){return this._shell};yo.prototype.mergeLabel=function(){if(arguments.length===1){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],i=n.getLocation(r,Ft.RIGHT);if(i===tt.NONE)return null;if(this._label.getLocation(r)===tt.NONE)return this._label.setLocation(r,i),null}};yo.prototype.setShell=function(t){this._shell=t,t!==null&&t.addHole(this)};yo.prototype.toPolygon=function(t){for(var n=this,r=new Array(this._holes.size()).fill(null),i=0;i<this._holes.size();i++)r[i]=n._holes.get(i).getLinearRing();var a=t.createPolygon(this.getLinearRing(),r);return a};yo.prototype.interfaces_=function(){return[]};yo.prototype.getClass=function(){return yo};var jW=function(e){function t(){var n=arguments[0],r=arguments[1];e.call(this,n,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setEdgeRing=function(r,i){r.setMinEdgeRing(i)},t.prototype.getNext=function(r){return r.getNextMin()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(yo),qW=function(e){function t(){var n=arguments[0],r=arguments[1];e.call(this,n,r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.buildMinimalRings=function(){var r=this,i=new jt,a=this._startDe;do{if(a.getMinEdgeRing()===null){var l=new jW(a,r._geometryFactory);i.add(l)}a=a.getNext()}while(a!==this._startDe);return i},t.prototype.setEdgeRing=function(r,i){r.setEdgeRing(i)},t.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var r=this,i=this._startDe;do{var a=i.getNode();a.getEdges().linkMinimalDirectedEdges(r),i=i.getNext()}while(i!==this._startDe)},t.prototype.getNext=function(r){return r.getNext()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(yo),Ns=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this._label=t}}};Ns.prototype.setVisited=function(t){this._isVisited=t};Ns.prototype.setInResult=function(t){this._isInResult=t};Ns.prototype.isCovered=function(){return this._isCovered};Ns.prototype.isCoveredSet=function(){return this._isCoveredSet};Ns.prototype.setLabel=function(t){this._label=t};Ns.prototype.getLabel=function(){return this._label};Ns.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0};Ns.prototype.updateIM=function(t){Xn.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)};Ns.prototype.isInResult=function(){return this._isInResult};Ns.prototype.isVisited=function(){return this._isVisited};Ns.prototype.interfaces_=function(){return[]};Ns.prototype.getClass=function(){return Ns};var $w=function(e){function t(){e.call(this),this._coord=null,this._edges=null;var n=arguments[0],r=arguments[1];this._coord=n,this._edges=r,this._label=new ri(0,tt.NONE)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isIncidentEdgeInResult=function(){for(var r=this.getEdges().getEdges().iterator();r.hasNext();){var i=r.next();if(i.getEdge().isInResult())return!0}return!1},t.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},t.prototype.getCoordinate=function(){return this._coord},t.prototype.print=function(r){r.println("node "+this._coord+" lbl: "+this._label)},t.prototype.computeIM=function(r){},t.prototype.computeMergedLocation=function(r,i){var a=tt.NONE;if(a=this._label.getLocation(i),!r.isNull(i)){var l=r.getLocation(i);a!==tt.BOUNDARY&&(a=l)}return a},t.prototype.setLabel=function(){if(arguments.length===2){var r=arguments[0],i=arguments[1];this._label===null?this._label=new ri(r,i):this._label.setLocation(r,i)}else return e.prototype.setLabel.apply(this,arguments)},t.prototype.getEdges=function(){return this._edges},t.prototype.mergeLabel=function(){var r=this;if(arguments[0]instanceof t){var i=arguments[0];this.mergeLabel(i._label)}else if(arguments[0]instanceof ri)for(var a=arguments[0],l=0;l<2;l++){var o=r.computeMergedLocation(a,l),f=r._label.getLocation(l);f===tt.NONE&&r._label.setLocation(l,o)}},t.prototype.add=function(r){this._edges.insert(r),r.setNode(this)},t.prototype.setLabelBoundary=function(r){if(this._label===null)return null;var i=tt.NONE;this._label!==null&&(i=this._label.getLocation(r));var a=null;switch(i){case tt.BOUNDARY:a=tt.INTERIOR;break;case tt.INTERIOR:a=tt.BOUNDARY;break;default:a=tt.BOUNDARY;break}this._label.setLocation(r,a)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ns),bu=function(){this.nodeMap=new ba,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};bu.prototype.find=function(t){return this.nodeMap.get(t)};bu.prototype.addNode=function(){if(arguments[0]instanceof $e){var t=arguments[0],n=this.nodeMap.get(t);return n===null&&(n=this.nodeFact.createNode(t),this.nodeMap.put(t,n)),n}else if(arguments[0]instanceof $w){var r=arguments[0],i=this.nodeMap.get(r.getCoordinate());return i===null?(this.nodeMap.put(r.getCoordinate(),r),r):(i.mergeLabel(r),i)}};bu.prototype.print=function(t){for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};bu.prototype.iterator=function(){return this.nodeMap.values().iterator()};bu.prototype.values=function(){return this.nodeMap.values()};bu.prototype.getBoundaryNodes=function(t){for(var n=new jt,r=this.iterator();r.hasNext();){var i=r.next();i.getLabel().getLocation(t)===tt.BOUNDARY&&n.add(i)}return n};bu.prototype.add=function(t){var n=t.getCoordinate(),r=this.addNode(n);r.add(t)};bu.prototype.interfaces_=function(){return[]};bu.prototype.getClass=function(){return bu};var si=function(){},K0={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};si.prototype.interfaces_=function(){return[]};si.prototype.getClass=function(){return si};si.isNorthern=function(t){return t===si.NE||t===si.NW};si.isOpposite=function(t,n){if(t===n)return!1;var r=(t-n+4)%4;return r===2};si.commonHalfPlane=function(t,n){if(t===n)return t;var r=(t-n+4)%4;if(r===2)return-1;var i=t<n?t:n,a=t>n?t:n;return i===0&&a===3?3:i};si.isInHalfPlane=function(t,n){return n===si.SE?t===si.SE||t===si.SW:t===n||t===n+1};si.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];if(t===0&&n===0)throw new Ui("Cannot compute the quadrant for point ( "+t+", "+n+" )");return t>=0?n>=0?si.NE:si.SE:n>=0?si.NW:si.SW}else if(arguments[0]instanceof $e&&arguments[1]instanceof $e){var r=arguments[0],i=arguments[1];if(i.x===r.x&&i.y===r.y)throw new Ui("Cannot compute the quadrant for two identical points "+r);return i.x>=r.x?i.y>=r.y?si.NE:si.SE:i.y>=r.y?si.NW:si.SW}};K0.NE.get=function(){return 0};K0.NW.get=function(){return 1};K0.SW.get=function(){return 2};K0.SE.get=function(){return 3};Object.defineProperties(si,K0);var wa=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var t=arguments[0];this._edge=t}else if(arguments.length===3){var n=arguments[0],r=arguments[1],i=arguments[2],a=null;this._edge=n,this.init(r,i),this._label=a}else if(arguments.length===4){var l=arguments[0],o=arguments[1],f=arguments[2],p=arguments[3];this._edge=l,this.init(o,f),this._label=p}};wa.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:en.computeOrientation(t._p0,t._p1,this._p1)};wa.prototype.getDy=function(){return this._dy};wa.prototype.getCoordinate=function(){return this._p0};wa.prototype.setNode=function(t){this._node=t};wa.prototype.print=function(t){var n=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),i=r.lastIndexOf("."),a=r.substring(i+1);t.print("  "+a+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+n+"   "+this._label)};wa.prototype.compareTo=function(t){var n=t;return this.compareDirection(n)};wa.prototype.getDirectedCoordinate=function(){return this._p1};wa.prototype.getDx=function(){return this._dx};wa.prototype.getLabel=function(){return this._label};wa.prototype.getEdge=function(){return this._edge};wa.prototype.getQuadrant=function(){return this._quadrant};wa.prototype.getNode=function(){return this._node};wa.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),i=n.substring(r+1);return"  "+i+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label};wa.prototype.computeLabel=function(t){};wa.prototype.init=function(t,n){this._p0=t,this._p1=n,this._dx=n.x-t.x,this._dy=n.y-t.y,this._quadrant=si.quadrant(this._dx,this._dy),Xn.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")};wa.prototype.interfaces_=function(){return[fl]};wa.prototype.getClass=function(){return wa};var CI=function(e){function t(){var n=arguments[0],r=arguments[1];if(e.call(this,n),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=r,r)this.init(n.getCoordinate(0),n.getCoordinate(1));else{var i=n.getNumPoints()-1;this.init(n.getCoordinate(i),n.getCoordinate(i-1))}this.computeDirectedLabel()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getNextMin=function(){return this._nextMin},t.prototype.getDepth=function(r){return this._depth[r]},t.prototype.setVisited=function(r){this._isVisited=r},t.prototype.computeDirectedLabel=function(){this._label=new ri(this._edge.getLabel()),this._isForward||this._label.flip()},t.prototype.getNext=function(){return this._next},t.prototype.setDepth=function(r,i){if(this._depth[r]!==-999&&this._depth[r]!==i)throw new rh("assigned depths do not match",this.getCoordinate());this._depth[r]=i},t.prototype.isInteriorAreaEdge=function(){for(var r=this,i=!0,a=0;a<2;a++)r._label.isArea(a)&&r._label.getLocation(a,Ft.LEFT)===tt.INTERIOR&&r._label.getLocation(a,Ft.RIGHT)===tt.INTERIOR||(i=!1);return i},t.prototype.setNextMin=function(r){this._nextMin=r},t.prototype.print=function(r){e.prototype.print.call(this,r),r.print(" "+this._depth[Ft.LEFT]+"/"+this._depth[Ft.RIGHT]),r.print(" ("+this.getDepthDelta()+")"),this._isInResult&&r.print(" inResult")},t.prototype.setMinEdgeRing=function(r){this._minEdgeRing=r},t.prototype.isLineEdge=function(){var r=this._label.isLine(0)||this._label.isLine(1),i=!this._label.isArea(0)||this._label.allPositionsEqual(0,tt.EXTERIOR),a=!this._label.isArea(1)||this._label.allPositionsEqual(1,tt.EXTERIOR);return r&&i&&a},t.prototype.setEdgeRing=function(r){this._edgeRing=r},t.prototype.getMinEdgeRing=function(){return this._minEdgeRing},t.prototype.getDepthDelta=function(){var r=this._edge.getDepthDelta();return this._isForward||(r=-r),r},t.prototype.setInResult=function(r){this._isInResult=r},t.prototype.getSym=function(){return this._sym},t.prototype.isForward=function(){return this._isForward},t.prototype.getEdge=function(){return this._edge},t.prototype.printEdge=function(r){this.print(r),r.print(" "),this._isForward?this._edge.print(r):this._edge.printReverse(r)},t.prototype.setSym=function(r){this._sym=r},t.prototype.setVisitedEdge=function(r){this.setVisited(r),this._sym.setVisited(r)},t.prototype.setEdgeDepths=function(r,i){var a=this.getEdge().getDepthDelta();this._isForward||(a=-a);var l=1;r===Ft.LEFT&&(l=-1);var o=Ft.opposite(r),f=a*l,p=i+f;this.setDepth(r,i),this.setDepth(o,p)},t.prototype.getEdgeRing=function(){return this._edgeRing},t.prototype.isInResult=function(){return this._isInResult},t.prototype.setNext=function(r){this._next=r},t.prototype.isVisited=function(){return this._isVisited},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.depthFactor=function(r,i){return r===tt.EXTERIOR&&i===tt.INTERIOR?1:r===tt.INTERIOR&&i===tt.EXTERIOR?-1:0},t}(wa),oy=function(){};oy.prototype.createNode=function(t){return new $w(t,null)};oy.prototype.interfaces_=function(){return[]};oy.prototype.getClass=function(){return oy};var Xi=function(){if(this._edges=new jt,this._nodes=null,this._edgeEndList=new jt,arguments.length===0)this._nodes=new bu(new oy);else if(arguments.length===1){var t=arguments[0];this._nodes=new bu(t)}};Xi.prototype.printEdges=function(t){var n=this;t.println("Edges:");for(var r=0;r<this._edges.size();r++){t.println("edge "+r+":");var i=n._edges.get(r);i.print(t),i.eiList.print(t)}};Xi.prototype.find=function(t){return this._nodes.find(t)};Xi.prototype.addNode=function(){if(arguments[0]instanceof $w){var t=arguments[0];return this._nodes.addNode(t)}else if(arguments[0]instanceof $e){var n=arguments[0];return this._nodes.addNode(n)}};Xi.prototype.getNodeIterator=function(){return this._nodes.iterator()};Xi.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var n=t.next();n.getEdges().linkResultDirectedEdges()}};Xi.prototype.debugPrintln=function(t){la.out.println(t)};Xi.prototype.isBoundaryNode=function(t,n){var r=this._nodes.find(n);if(r===null)return!1;var i=r.getLabel();return i!==null&&i.getLocation(t)===tt.BOUNDARY};Xi.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){var n=t.next();n.getEdges().linkAllDirectedEdges()}};Xi.prototype.matchInSameDirection=function(t,n,r,i){return t.equals(r)?en.computeOrientation(t,n,i)===en.COLLINEAR&&si.quadrant(t,n)===si.quadrant(r,i):!1};Xi.prototype.getEdgeEnds=function(){return this._edgeEndList};Xi.prototype.debugPrint=function(t){la.out.print(t)};Xi.prototype.getEdgeIterator=function(){return this._edges.iterator()};Xi.prototype.findEdgeInSameDirection=function(t,n){for(var r=this,i=0;i<this._edges.size();i++){var a=r._edges.get(i),l=a.getCoordinates();if(r.matchInSameDirection(t,n,l[0],l[1])||r.matchInSameDirection(t,n,l[l.length-1],l[l.length-2]))return a}return null};Xi.prototype.insertEdge=function(t){this._edges.add(t)};Xi.prototype.findEdgeEnd=function(t){for(var n=this.getEdgeEnds().iterator();n.hasNext();){var r=n.next();if(r.getEdge()===t)return r}return null};Xi.prototype.addEdges=function(t){for(var n=this,r=t.iterator();r.hasNext();){var i=r.next();n._edges.add(i);var a=new CI(i,!0),l=new CI(i,!1);a.setSym(l),l.setSym(a),n.add(a),n.add(l)}};Xi.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)};Xi.prototype.getNodes=function(){return this._nodes.values()};Xi.prototype.findEdge=function(t,n){for(var r=this,i=0;i<this._edges.size();i++){var a=r._edges.get(i),l=a.getCoordinates();if(t.equals(l[0])&&n.equals(l[1]))return a}return null};Xi.prototype.interfaces_=function(){return[]};Xi.prototype.getClass=function(){return Xi};Xi.linkResultDirectedEdges=function(t){for(var n=t.iterator();n.hasNext();){var r=n.next();r.getEdges().linkResultDirectedEdges()}};var ys=function(){this._geometryFactory=null,this._shellList=new jt;var t=arguments[0];this._geometryFactory=t};ys.prototype.sortShellsAndHoles=function(t,n,r){for(var i=t.iterator();i.hasNext();){var a=i.next();a.isHole()?r.add(a):n.add(a)}};ys.prototype.computePolygons=function(t){for(var n=this,r=new jt,i=t.iterator();i.hasNext();){var a=i.next(),l=a.toPolygon(n._geometryFactory);r.add(l)}return r};ys.prototype.placeFreeHoles=function(t,n){for(var r=this,i=n.iterator();i.hasNext();){var a=i.next();if(a.getShell()===null){var l=r.findEdgeRingContaining(a,t);if(l===null)throw new rh("unable to assign hole to a shell",a.getCoordinate(0));a.setShell(l)}}};ys.prototype.buildMinimalEdgeRings=function(t,n,r){for(var i=this,a=new jt,l=t.iterator();l.hasNext();){var o=l.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var f=o.buildMinimalRings(),p=i.findShell(f);p!==null?(i.placePolygonHoles(p,f),n.add(p)):r.addAll(f)}else a.add(o)}return a};ys.prototype.containsPoint=function(t){for(var n=this._shellList.iterator();n.hasNext();){var r=n.next();if(r.containsPoint(t))return!0}return!1};ys.prototype.buildMaximalEdgeRings=function(t){for(var n=this,r=new jt,i=t.iterator();i.hasNext();){var a=i.next();if(a.isInResult()&&a.getLabel().isArea()&&a.getEdgeRing()===null){var l=new qW(a,n._geometryFactory);r.add(l),l.setInResult()}}return r};ys.prototype.placePolygonHoles=function(t,n){for(var r=n.iterator();r.hasNext();){var i=r.next();i.isHole()&&i.setShell(t)}};ys.prototype.getPolygons=function(){var t=this.computePolygons(this._shellList);return t};ys.prototype.findEdgeRingContaining=function(t,n){for(var r=t.getLinearRing(),i=r.getEnvelopeInternal(),a=r.getCoordinateN(0),l=null,o=null,f=n.iterator();f.hasNext();){var p=f.next(),y=p.getLinearRing(),x=y.getEnvelopeInternal();l!==null&&(o=l.getLinearRing().getEnvelopeInternal());var w=!1;x.contains(i)&&en.isPointInRing(a,y.getCoordinates())&&(w=!0),w&&(l===null||o.contains(x))&&(l=p)}return l};ys.prototype.findShell=function(t){for(var n=0,r=null,i=t.iterator();i.hasNext();){var a=i.next();a.isHole()||(r=a,n++)}return Xn.isTrue(n<=1,"found two shells in MinimalEdgeRing list"),r};ys.prototype.add=function(){if(arguments.length===1){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(arguments.length===2){var n=arguments[0],r=arguments[1];Xi.linkResultDirectedEdges(r);var i=this.buildMaximalEdgeRings(n),a=new jt,l=this.buildMinimalEdgeRings(i,this._shellList,a);this.sortShellsAndHoles(l,this._shellList,a),this.placeFreeHoles(this._shellList,a)}};ys.prototype.interfaces_=function(){return[]};ys.prototype.getClass=function(){return ys};var ay=function(){};ay.prototype.getBounds=function(){};ay.prototype.interfaces_=function(){return[]};ay.prototype.getClass=function(){return ay};var Ll=function(){this._bounds=null,this._item=null;var t=arguments[0],n=arguments[1];this._bounds=t,this._item=n};Ll.prototype.getItem=function(){return this._item};Ll.prototype.getBounds=function(){return this._bounds};Ll.prototype.interfaces_=function(){return[ay,dl]};Ll.prototype.getClass=function(){return Ll};var ih=function(){this._size=null,this._items=null,this._size=0,this._items=new jt,this._items.add(null)};ih.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t};ih.prototype.size=function(){return this._size};ih.prototype.reorder=function(t){for(var n=this,r=null,i=this._items.get(t);t*2<=this._size&&(r=t*2,r!==n._size&&n._items.get(r+1).compareTo(n._items.get(r))<0&&r++,n._items.get(r).compareTo(i)<0);t=r)n._items.set(t,n._items.get(r));this._items.set(t,i)};ih.prototype.clear=function(){this._size=0,this._items.clear()};ih.prototype.isEmpty=function(){return this._size===0};ih.prototype.add=function(t){var n=this;this._items.add(null),this._size+=1;var r=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(r/2)))<0;r/=2)n._items.set(r,n._items.get(Math.trunc(r/2)));this._items.set(r,t)};ih.prototype.interfaces_=function(){return[]};ih.prototype.getClass=function(){return ih};var Zh=function(){};Zh.prototype.visitItem=function(t){};Zh.prototype.interfaces_=function(){return[]};Zh.prototype.getClass=function(){return Zh};var jp=function(){};jp.prototype.insert=function(t,n){};jp.prototype.remove=function(t,n){};jp.prototype.query=function(){};jp.prototype.interfaces_=function(){return[]};jp.prototype.getClass=function(){return jp};var Do=function(){if(this._childBoundables=new jt,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this._level=t}}},j4={serialVersionUID:{configurable:!0}};Do.prototype.getLevel=function(){return this._level};Do.prototype.size=function(){return this._childBoundables.size()};Do.prototype.getChildBoundables=function(){return this._childBoundables};Do.prototype.addChildBoundable=function(t){Xn.isTrue(this._bounds===null),this._childBoundables.add(t)};Do.prototype.isEmpty=function(){return this._childBoundables.isEmpty()};Do.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds};Do.prototype.interfaces_=function(){return[ay,dl]};Do.prototype.getClass=function(){return Do};j4.serialVersionUID.get=function(){return 6493722185909574e3};Object.defineProperties(Do,j4);var Ol=function(){};Ol.reverseOrder=function(){return{compare:function(n,r){return r.compareTo(n)}}};Ol.min=function(t){return Ol.sort(t),t.get(0)};Ol.sort=function(t,n){var r=t.toArray();n?td.sort(r,n):td.sort(r);for(var i=t.iterator(),a=0,l=r.length;a<l;a++)i.next(),i.set(r[a])};Ol.singletonList=function(t){var n=new jt;return n.add(t),n};var fo=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],n=arguments[1],r=arguments[2];this._boundable1=t,this._boundable2=n,this._itemDistance=r,this._distance=this.distance()};fo.prototype.expandToQueue=function(t,n){var r=fo.isComposite(this._boundable1),i=fo.isComposite(this._boundable2);if(r&&i)return fo.area(this._boundable1)>fo.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,n),null):(this.expand(this._boundable2,this._boundable1,t,n),null);if(r)return this.expand(this._boundable1,this._boundable2,t,n),null;if(i)return this.expand(this._boundable2,this._boundable1,t,n),null;throw new Ui("neither boundable is composite")};fo.prototype.isLeaves=function(){return!(fo.isComposite(this._boundable1)||fo.isComposite(this._boundable2))};fo.prototype.compareTo=function(t){var n=t;return this._distance<n._distance?-1:this._distance>n._distance?1:0};fo.prototype.expand=function(t,n,r,i){for(var a=this,l=t.getChildBoundables(),o=l.iterator();o.hasNext();){var f=o.next(),p=new fo(f,n,a._itemDistance);p.getDistance()<i&&r.add(p)}};fo.prototype.getBoundable=function(t){return t===0?this._boundable1:this._boundable2};fo.prototype.getDistance=function(){return this._distance};fo.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())};fo.prototype.interfaces_=function(){return[fl]};fo.prototype.getClass=function(){return fo};fo.area=function(t){return t.getBounds().getArea()};fo.isComposite=function(t){return t instanceof Do};var jo=function e(){if(this._root=null,this._built=!1,this._itemBoundables=new jt,this._nodeCapacity=null,arguments.length===0){var t=e.DEFAULT_NODE_CAPACITY;this._nodeCapacity=t}else if(arguments.length===1){var n=arguments[0];Xn.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},jw={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};jo.prototype.getNodeCapacity=function(){return this._nodeCapacity};jo.prototype.lastNode=function(t){return t.get(t.size()-1)};jo.prototype.size=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var n=arguments[0],r=0,i=n.getChildBoundables().iterator();i.hasNext();){var a=i.next();a instanceof Do?r+=t.size(a):a instanceof Ll&&(r+=1)}return r}};jo.prototype.removeItem=function(t,n){for(var r=null,i=t.getChildBoundables().iterator();i.hasNext();){var a=i.next();a instanceof Ll&&a.getItem()===n&&(r=a)}return r!==null?(t.getChildBoundables().remove(r),!0):!1};jo.prototype.itemsTree=function(){var t=this;if(arguments.length===0){this.build();var n=this.itemsTree(this._root);return n===null?new jt:n}else if(arguments.length===1){for(var r=arguments[0],i=new jt,a=r.getChildBoundables().iterator();a.hasNext();){var l=a.next();if(l instanceof Do){var o=t.itemsTree(l);o!==null&&i.add(o)}else l instanceof Ll?i.add(l.getItem()):Xn.shouldNeverReachHere()}return i.size()<=0?null:i}};jo.prototype.insert=function(t,n){Xn.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Ll(t,n))};jo.prototype.boundablesAtLevel=function(){var t=this;if(arguments.length===1){var n=arguments[0],r=new jt;return this.boundablesAtLevel(n,this._root,r),r}else if(arguments.length===3){var i=arguments[0],a=arguments[1],l=arguments[2];if(Xn.isTrue(i>-2),a.getLevel()===i)return l.add(a),null;for(var o=a.getChildBoundables().iterator();o.hasNext();){var f=o.next();f instanceof Do?t.boundablesAtLevel(i,f,l):(Xn.isTrue(f instanceof Ll),i===-1&&l.add(f))}return null}};jo.prototype.query=function(){var t=this;if(arguments.length===1){var n=arguments[0];this.build();var r=new jt;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,r),r}else if(arguments.length===2){var i=arguments[0],a=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),i)&&this.query(i,this._root,a)}else if(arguments.length===3){if(Pn(arguments[2],Zh)&&arguments[0]instanceof Object&&arguments[1]instanceof Do)for(var l=arguments[0],o=arguments[1],f=arguments[2],p=o.getChildBoundables(),y=0;y<p.size();y++){var x=p.get(y);t.getIntersectsOp().intersects(x.getBounds(),l)&&(x instanceof Do?t.query(l,x,f):x instanceof Ll?f.visitItem(x.getItem()):Xn.shouldNeverReachHere())}else if(Pn(arguments[2],Cl)&&arguments[0]instanceof Object&&arguments[1]instanceof Do)for(var w=arguments[0],S=arguments[1],L=arguments[2],D=S.getChildBoundables(),B=0;B<D.size();B++){var z=D.get(B);t.getIntersectsOp().intersects(z.getBounds(),w)&&(z instanceof Do?t.query(w,z,L):z instanceof Ll?L.add(z.getItem()):Xn.shouldNeverReachHere())}}};jo.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0};jo.prototype.getRoot=function(){return this.build(),this._root};jo.prototype.remove=function(){var t=this;if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.build(),this.getIntersectsOp().intersects(this._root.getBounds(),n)?this.remove(n,this._root,r):!1}else if(arguments.length===3){var i=arguments[0],a=arguments[1],l=arguments[2],o=this.removeItem(a,l);if(o)return!0;for(var f=null,p=a.getChildBoundables().iterator();p.hasNext();){var y=p.next();if(t.getIntersectsOp().intersects(y.getBounds(),i)&&y instanceof Do&&(o=t.remove(i,y,l),o)){f=y;break}}return f!==null&&f.getChildBoundables().isEmpty()&&a.getChildBoundables().remove(f),o}};jo.prototype.createHigherLevels=function(t,n){Xn.isTrue(!t.isEmpty());var r=this.createParentBoundables(t,n+1);return r.size()===1?r.get(0):this.createHigherLevels(r,n+1)};jo.prototype.depth=function(){var t=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var n=arguments[0],r=0,i=n.getChildBoundables().iterator();i.hasNext();){var a=i.next();if(a instanceof Do){var l=t.depth(a);l>r&&(r=l)}}return r+1}};jo.prototype.createParentBoundables=function(t,n){var r=this;Xn.isTrue(!t.isEmpty());var i=new jt;i.add(this.createNode(n));var a=new jt(t);Ol.sort(a,this.getComparator());for(var l=a.iterator();l.hasNext();){var o=l.next();r.lastNode(i).getChildBoundables().size()===r.getNodeCapacity()&&i.add(r.createNode(n)),r.lastNode(i).addChildBoundable(o)}return i};jo.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()};jo.prototype.interfaces_=function(){return[dl]};jo.prototype.getClass=function(){return jo};jo.compareDoubles=function(t,n){return t>n?1:t<n?-1:0};jw.IntersectsOp.get=function(){return ZW};jw.serialVersionUID.get=function(){return-3886435814360241e3};jw.DEFAULT_NODE_CAPACITY.get=function(){return 10};Object.defineProperties(jo,jw);var ZW=function(){},sy=function(){};sy.prototype.distance=function(t,n){};sy.prototype.interfaces_=function(){return[]};sy.prototype.getClass=function(){return sy};var q4=function(e){function t(r){r=r||t.DEFAULT_NODE_CAPACITY,e.call(this,r)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return t.prototype.createParentBoundablesFromVerticalSlices=function(i,a){var l=this;Xn.isTrue(i.length>0);for(var o=new jt,f=0;f<i.length;f++)o.addAll(l.createParentBoundablesFromVerticalSlice(i[f],a));return o},t.prototype.createNode=function(i){return new t3(i)},t.prototype.size=function(){return arguments.length===0?e.prototype.size.call(this):e.prototype.size.apply(this,arguments)},t.prototype.insert=function(){if(arguments.length===2){var i=arguments[0],a=arguments[1];if(i.isNull())return null;e.prototype.insert.call(this,i,a)}else return e.prototype.insert.apply(this,arguments)},t.prototype.getIntersectsOp=function(){return t.intersectsOp},t.prototype.verticalSlices=function(i,a){for(var l=Math.trunc(Math.ceil(i.size()/a)),o=new Array(a).fill(null),f=i.iterator(),p=0;p<a;p++){o[p]=new jt;for(var y=0;f.hasNext()&&y<l;){var x=f.next();o[p].add(x),y++}}return o},t.prototype.query=function(){if(arguments.length===1){var i=arguments[0];return e.prototype.query.call(this,i)}else if(arguments.length===2){var a=arguments[0],l=arguments[1];e.prototype.query.call(this,a,l)}else if(arguments.length===3){if(Pn(arguments[2],Zh)&&arguments[0]instanceof Object&&arguments[1]instanceof Do){var o=arguments[0],f=arguments[1],p=arguments[2];e.prototype.query.call(this,o,f,p)}else if(Pn(arguments[2],Cl)&&arguments[0]instanceof Object&&arguments[1]instanceof Do){var y=arguments[0],x=arguments[1],w=arguments[2];e.prototype.query.call(this,y,x,w)}}},t.prototype.getComparator=function(){return t.yComparator},t.prototype.createParentBoundablesFromVerticalSlice=function(i,a){return e.prototype.createParentBoundables.call(this,i,a)},t.prototype.remove=function(){if(arguments.length===2){var i=arguments[0],a=arguments[1];return e.prototype.remove.call(this,i,a)}else return e.prototype.remove.apply(this,arguments)},t.prototype.depth=function(){return arguments.length===0?e.prototype.depth.call(this):e.prototype.depth.apply(this,arguments)},t.prototype.createParentBoundables=function(i,a){Xn.isTrue(!i.isEmpty());var l=Math.trunc(Math.ceil(i.size()/this.getNodeCapacity())),o=new jt(i);Ol.sort(o,t.xComparator);var f=this.verticalSlices(o,Math.trunc(Math.ceil(Math.sqrt(l))));return this.createParentBoundablesFromVerticalSlices(f,a)},t.prototype.nearestNeighbour=function(){if(arguments.length===1){if(Pn(arguments[0],sy)){var i=arguments[0],a=new fo(this.getRoot(),this.getRoot(),i);return this.nearestNeighbour(a)}else if(arguments[0]instanceof fo){var l=arguments[0];return this.nearestNeighbour(l,Nn.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof t&&Pn(arguments[1],sy)){var o=arguments[0],f=arguments[1],p=new fo(this.getRoot(),o.getRoot(),f);return this.nearestNeighbour(p)}else if(arguments[0]instanceof fo&&typeof arguments[1]=="number"){var y=arguments[0],x=arguments[1],w=x,S=null,L=new ih;for(L.add(y);!L.isEmpty()&&w>0;){var D=L.poll(),B=D.getDistance();if(B>=w)break;D.isLeaves()?(w=B,S=D):D.expandToQueue(L,w)}return[S.getBoundable(0).getItem(),S.getBoundable(1).getItem()]}}else if(arguments.length===3){var z=arguments[0],M=arguments[1],k=arguments[2],V=new Ll(z,M),q=new fo(this.getRoot(),V,k);return this.nearestNeighbour(q)[0]}},t.prototype.interfaces_=function(){return[jp,dl]},t.prototype.getClass=function(){return t},t.centreX=function(i){return t.avg(i.getMinX(),i.getMaxX())},t.avg=function(i,a){return(i+a)/2},t.centreY=function(i){return t.avg(i.getMinY(),i.getMaxY())},n.STRtreeNode.get=function(){return t3},n.serialVersionUID.get=function(){return 0x39920f7d5f261e0},n.xComparator.get=function(){return{interfaces_:function(){return[Km]},compare:function(r,i){return e.compareDoubles(t.centreX(r.getBounds()),t.centreX(i.getBounds()))}}},n.yComparator.get=function(){return{interfaces_:function(){return[Km]},compare:function(r,i){return e.compareDoubles(t.centreY(r.getBounds()),t.centreY(i.getBounds()))}}},n.intersectsOp.get=function(){return{interfaces_:function(){return[e.IntersectsOp]},intersects:function(r,i){return r.intersects(i)}}},n.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(t,n),t}(jo),t3=function(e){function t(){var n=arguments[0];e.call(this,n)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.computeBounds=function(){for(var r=null,i=this.getChildBoundables().iterator();i.hasNext();){var a=i.next();r===null?r=new _n(a.getBounds()):r.expandToInclude(a.getBounds())}return r},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Do),Ha=function(){};Ha.prototype.interfaces_=function(){return[]};Ha.prototype.getClass=function(){return Ha};Ha.relativeSign=function(t,n){return t<n?-1:t>n?1:0};Ha.compare=function(t,n,r){if(n.equals2D(r))return 0;var i=Ha.relativeSign(n.x,r.x),a=Ha.relativeSign(n.y,r.y);switch(t){case 0:return Ha.compareValue(i,a);case 1:return Ha.compareValue(a,i);case 2:return Ha.compareValue(a,-i);case 3:return Ha.compareValue(-i,a);case 4:return Ha.compareValue(-i,-a);case 5:return Ha.compareValue(-a,-i);case 6:return Ha.compareValue(-a,i);case 7:return Ha.compareValue(i,-a)}return Xn.shouldNeverReachHere("invalid octant value"),0};Ha.compareValue=function(t,n){return t<0?-1:t>0?1:n<0?-1:n>0?1:0};var Xh=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3];this._segString=t,this.coord=new $e(n),this.segmentIndex=r,this._segmentOctant=i,this._isInterior=!n.equals2D(t.getCoordinate(r))};Xh.prototype.getCoordinate=function(){return this.coord};Xh.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)};Xh.prototype.compareTo=function(t){var n=t;return this.segmentIndex<n.segmentIndex?-1:this.segmentIndex>n.segmentIndex?1:this.coord.equals2D(n.coord)?0:Ha.compare(this._segmentOctant,this.coord,n.coord)};Xh.prototype.isEndPoint=function(t){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===t};Xh.prototype.isInterior=function(){return this._isInterior};Xh.prototype.interfaces_=function(){return[fl]};Xh.prototype.getClass=function(){return Xh};var $a=function(){this._nodeMap=new ba,this._edge=null;var t=arguments[0];this._edge=t};$a.prototype.getSplitCoordinates=function(){var t=this,n=new H0;this.addEndpoints();for(var r=this.iterator(),i=r.next();r.hasNext();){var a=r.next();t.addEdgeCoordinates(i,a,n),i=a}return n.toCoordinateArray()};$a.prototype.addCollapsedNodes=function(){var t=this,n=new jt;this.findCollapsesFromInsertedNodes(n),this.findCollapsesFromExistingVertices(n);for(var r=n.iterator();r.hasNext();){var i=r.next().intValue();t.add(t._edge.getCoordinate(i),i)}};$a.prototype.print=function(t){t.println("Intersections:");for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};$a.prototype.findCollapsesFromExistingVertices=function(t){for(var n=this,r=0;r<this._edge.size()-2;r++){var i=n._edge.getCoordinate(r),a=n._edge.getCoordinate(r+2);i.equals2D(a)&&t.add(new mu(r+1))}};$a.prototype.addEdgeCoordinates=function(t,n,r){var i=this,a=this._edge.getCoordinate(n.segmentIndex),l=n.isInterior()||!n.coord.equals2D(a);r.add(new $e(t.coord),!1);for(var o=t.segmentIndex+1;o<=n.segmentIndex;o++)r.add(i._edge.getCoordinate(o));l&&r.add(new $e(n.coord))};$a.prototype.iterator=function(){return this._nodeMap.values().iterator()};$a.prototype.addSplitEdges=function(t){var n=this;this.addEndpoints(),this.addCollapsedNodes();for(var r=this.iterator(),i=r.next();r.hasNext();){var a=r.next(),l=n.createSplitEdge(i,a);t.add(l),i=a}};$a.prototype.findCollapseIndex=function(t,n,r){if(!t.coord.equals2D(n.coord))return!1;var i=n.segmentIndex-t.segmentIndex;return n.isInterior()||i--,i===1?(r[0]=t.segmentIndex+1,!0):!1};$a.prototype.findCollapsesFromInsertedNodes=function(t){for(var n=this,r=new Array(1).fill(null),i=this.iterator(),a=i.next();i.hasNext();){var l=i.next(),o=n.findCollapseIndex(a,l,r);o&&t.add(new mu(r[0])),a=l}};$a.prototype.getEdge=function(){return this._edge};$a.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)};$a.prototype.createSplitEdge=function(t,n){var r=this,i=n.segmentIndex-t.segmentIndex+2,a=this._edge.getCoordinate(n.segmentIndex),l=n.isInterior()||!n.coord.equals2D(a);l||i--;var o=new Array(i).fill(null),f=0;o[f++]=new $e(t.coord);for(var p=t.segmentIndex+1;p<=n.segmentIndex;p++)o[f++]=r._edge.getCoordinate(p);return l&&(o[f]=new $e(n.coord)),new so(o,this._edge.getData())};$a.prototype.add=function(t,n){var r=new Xh(this._edge,t,n,this._edge.getSegmentOctant(n)),i=this._nodeMap.get(r);return i!==null?(Xn.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(r,r),r)};$a.prototype.checkSplitEdgesCorrectness=function(t){var n=this._edge.getCoordinates(),r=t.get(0),i=r.getCoordinate(0);if(!i.equals2D(n[0]))throw new th("bad split edge start point at "+i);var a=t.get(t.size()-1),l=a.getCoordinates(),o=l[l.length-1];if(!o.equals2D(n[n.length-1]))throw new th("bad split edge end point at "+o)};$a.prototype.interfaces_=function(){return[]};$a.prototype.getClass=function(){return $a};var qp=function(){};qp.prototype.interfaces_=function(){return[]};qp.prototype.getClass=function(){return qp};qp.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];if(t===0&&n===0)throw new Ui("Cannot compute the octant for point ( "+t+", "+n+" )");var r=Math.abs(t),i=Math.abs(n);return t>=0?n>=0?r>=i?0:1:r>=i?7:6:n>=0?r>=i?3:2:r>=i?4:5}else if(arguments[0]instanceof $e&&arguments[1]instanceof $e){var a=arguments[0],l=arguments[1],o=l.x-a.x,f=l.y-a.y;if(o===0&&f===0)throw new Ui("Cannot compute the octant for two identical points "+a);return qp.octant(o,f)}};var yc=function(){};yc.prototype.getCoordinates=function(){};yc.prototype.size=function(){};yc.prototype.getCoordinate=function(t){};yc.prototype.isClosed=function(){};yc.prototype.setData=function(t){};yc.prototype.getData=function(){};yc.prototype.interfaces_=function(){return[]};yc.prototype.getClass=function(){return yc};var S0=function(){};S0.prototype.addIntersection=function(t,n){};S0.prototype.interfaces_=function(){return[yc]};S0.prototype.getClass=function(){return S0};var so=function(){this._nodeList=new $a(this),this._pts=null,this._data=null;var t=arguments[0],n=arguments[1];this._pts=t,this._data=n};so.prototype.getCoordinates=function(){return this._pts};so.prototype.size=function(){return this._pts.length};so.prototype.getCoordinate=function(t){return this._pts[t]};so.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};so.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))};so.prototype.setData=function(t){this._data=t};so.prototype.safeOctant=function(t,n){return t.equals2D(n)?0:qp.octant(t,n)};so.prototype.getData=function(){return this._data};so.prototype.addIntersection=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];this.addIntersectionNode(t,n)}else if(arguments.length===4){var r=arguments[0],i=arguments[1],a=arguments[3],l=new $e(r.getIntersection(a));this.addIntersection(l,i)}};so.prototype.toString=function(){return Al.toLineString(new ro(this._pts))};so.prototype.getNodeList=function(){return this._nodeList};so.prototype.addIntersectionNode=function(t,n){var r=n,i=r+1;if(i<this._pts.length){var a=this._pts[i];t.equals2D(a)&&(r=i)}var l=this._nodeList.add(t,r);return l};so.prototype.addIntersections=function(t,n,r){for(var i=this,a=0;a<t.getIntersectionNum();a++)i.addIntersection(t,n,r,a)};so.prototype.interfaces_=function(){return[S0]};so.prototype.getClass=function(){return so};so.getNodedSubstrings=function(){if(arguments.length===1){var t=arguments[0],n=new jt;return so.getNodedSubstrings(t,n),n}else if(arguments.length===2)for(var r=arguments[0],i=arguments[1],a=r.iterator();a.hasNext();){var l=a.next();l.getNodeList().addSplitEdges(i)}};var wn=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new $e,this.p1=new $e;else if(arguments.length===1){var t=arguments[0];this.p0=new $e(t.p0),this.p1=new $e(t.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var n=arguments[0],r=arguments[1],i=arguments[2],a=arguments[3];this.p0=new $e(n,r),this.p1=new $e(i,a)}},Z4={serialVersionUID:{configurable:!0}};wn.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)};wn.prototype.orientationIndex=function(){if(arguments[0]instanceof wn){var t=arguments[0],n=en.orientationIndex(this.p0,this.p1,t.p0),r=en.orientationIndex(this.p0,this.p1,t.p1);return n>=0&&r>=0||n<=0&&r<=0?Math.max(n,r):0}else if(arguments[0]instanceof $e){var i=arguments[0];return en.orientationIndex(this.p0,this.p1,i)}};wn.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])};wn.prototype.isVertical=function(){return this.p0.x===this.p1.x};wn.prototype.equals=function(t){if(!(t instanceof wn))return!1;var n=t;return this.p0.equals(n.p0)&&this.p1.equals(n.p1)};wn.prototype.intersection=function(t){var n=new xd;return n.computeIntersection(this.p0,this.p1,t.p0,t.p1),n.hasIntersection()?n.getIntersection(0):null};wn.prototype.project=function(){if(arguments[0]instanceof $e){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new $e(t);var n=this.projectionFactor(t),r=new $e;return r.x=this.p0.x+n*(this.p1.x-this.p0.x),r.y=this.p0.y+n*(this.p1.y-this.p0.y),r}else if(arguments[0]instanceof wn){var i=arguments[0],a=this.projectionFactor(i.p0),l=this.projectionFactor(i.p1);if(a>=1&&l>=1||a<=0&&l<=0)return null;var o=this.project(i.p0);a<0&&(o=this.p0),a>1&&(o=this.p1);var f=this.project(i.p1);return l<0&&(f=this.p0),l>1&&(f=this.p1),new wn(o,f)}};wn.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()};wn.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)};wn.prototype.getCoordinate=function(t){return t===0?this.p0:this.p1};wn.prototype.distancePerpendicular=function(t){return en.distancePointLinePerpendicular(t,this.p0,this.p1)};wn.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)};wn.prototype.midPoint=function(){return wn.midPoint(this.p0,this.p1)};wn.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var n=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y,i=n*n+r*r;if(i<=0)return Nn.NaN;var a=((t.x-this.p0.x)*n+(t.y-this.p0.y)*r)/i;return a};wn.prototype.closestPoints=function(t){var n=this.intersection(t);if(n!==null)return[n,n];var r=new Array(2).fill(null),i=Nn.MAX_VALUE,a=null,l=this.closestPoint(t.p0);i=l.distance(t.p0),r[0]=l,r[1]=t.p0;var o=this.closestPoint(t.p1);a=o.distance(t.p1),a<i&&(i=a,r[0]=o,r[1]=t.p1);var f=t.closestPoint(this.p0);a=f.distance(this.p0),a<i&&(i=a,r[0]=this.p0,r[1]=f);var p=t.closestPoint(this.p1);return a=p.distance(this.p1),a<i&&(i=a,r[0]=this.p1,r[1]=p),r};wn.prototype.closestPoint=function(t){var n=this.projectionFactor(t);if(n>0&&n<1)return this.project(t);var r=this.p0.distance(t),i=this.p1.distance(t);return r<i?this.p0:this.p1};wn.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)};wn.prototype.getLength=function(){return this.p0.distance(this.p1)};wn.prototype.compareTo=function(t){var n=t,r=this.p0.compareTo(n.p0);return r!==0?r:this.p1.compareTo(n.p1)};wn.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t};wn.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)};wn.prototype.lineIntersection=function(t){try{var n=Il.intersection(this.p0,this.p1,t.p0,t.p1);return n}catch(r){if(!(r instanceof Iy))throw r}finally{}return null};wn.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)};wn.prototype.pointAlongOffset=function(t,n){var r=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),a=this.p1.x-this.p0.x,l=this.p1.y-this.p0.y,o=Math.sqrt(a*a+l*l),f=0,p=0;if(n!==0){if(o<=0)throw new Error("Cannot compute offset from zero-length line segment");f=n*a/o,p=n*l/o}var y=r-p,x=i+f,w=new $e(y,x);return w};wn.prototype.setCoordinates=function(){if(arguments.length===1){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.p0.x=n.x,this.p0.y=n.y,this.p1.x=r.x,this.p1.y=r.y}};wn.prototype.segmentFraction=function(t){var n=this.projectionFactor(t);return n<0?n=0:(n>1||Nn.isNaN(n))&&(n=1),n};wn.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"};wn.prototype.isHorizontal=function(){return this.p0.y===this.p1.y};wn.prototype.distance=function(){if(arguments[0]instanceof wn){var t=arguments[0];return en.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}else if(arguments[0]instanceof $e){var n=arguments[0];return en.distancePointLine(n,this.p0,this.p1)}};wn.prototype.pointAlong=function(t){var n=new $e;return n.x=this.p0.x+t*(this.p1.x-this.p0.x),n.y=this.p0.y+t*(this.p1.y-this.p0.y),n};wn.prototype.hashCode=function(){var t=Nn.doubleToLongBits(this.p0.x);t^=Nn.doubleToLongBits(this.p0.y)*31;var n=Math.trunc(t)^Math.trunc(t>>32),r=Nn.doubleToLongBits(this.p1.x);r^=Nn.doubleToLongBits(this.p1.y)*31;var i=Math.trunc(r)^Math.trunc(r>>32);return n^i};wn.prototype.interfaces_=function(){return[fl,dl]};wn.prototype.getClass=function(){return wn};wn.midPoint=function(t,n){return new $e((t.x+n.x)/2,(t.y+n.y)/2)};Z4.serialVersionUID.get=function(){return 0x2d2172135f411c00};Object.defineProperties(wn,Z4);var T0=function(){this.tempEnv1=new _n,this.tempEnv2=new _n,this._overlapSeg1=new wn,this._overlapSeg2=new wn};T0.prototype.overlap=function(){if(arguments.length!==2){if(arguments.length===4){var t=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3];t.getLineSegment(n,this._overlapSeg1),r.getLineSegment(i,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}};T0.prototype.interfaces_=function(){return[]};T0.prototype.getClass=function(){return T0};var vs=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3];this._pts=t,this._start=n,this._end=r,this._context=i};vs.prototype.getLineSegment=function(t,n){n.p0=this._pts[t],n.p1=this._pts[t+1]};vs.prototype.computeSelect=function(t,n,r,i){var a=this._pts[n],l=this._pts[r];if(i.tempEnv1.init(a,l),r-n===1)return i.select(this,n),null;if(!t.intersects(i.tempEnv1))return null;var o=Math.trunc((n+r)/2);n<o&&this.computeSelect(t,n,o,i),o<r&&this.computeSelect(t,o,r,i)};vs.prototype.getCoordinates=function(){for(var t=this,n=new Array(this._end-this._start+1).fill(null),r=0,i=this._start;i<=this._end;i++)n[r++]=t._pts[i];return n};vs.prototype.computeOverlaps=function(t,n){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,n)};vs.prototype.setId=function(t){this._id=t};vs.prototype.select=function(t,n){this.computeSelect(t,this._start,this._end,n)};vs.prototype.getEnvelope=function(){if(this._env===null){var t=this._pts[this._start],n=this._pts[this._end];this._env=new _n(t,n)}return this._env};vs.prototype.getEndIndex=function(){return this._end};vs.prototype.getStartIndex=function(){return this._start};vs.prototype.getContext=function(){return this._context};vs.prototype.getId=function(){return this._id};vs.prototype.computeOverlapsInternal=function(t,n,r,i,a,l){var o=this._pts[t],f=this._pts[n],p=r._pts[i],y=r._pts[a];if(n-t===1&&a-i===1)return l.overlap(this,t,r,i),null;if(l.tempEnv1.init(o,f),l.tempEnv2.init(p,y),!l.tempEnv1.intersects(l.tempEnv2))return null;var x=Math.trunc((t+n)/2),w=Math.trunc((i+a)/2);t<x&&(i<w&&this.computeOverlapsInternal(t,x,r,i,w,l),w<a&&this.computeOverlapsInternal(t,x,r,w,a,l)),x<n&&(i<w&&this.computeOverlapsInternal(x,n,r,i,w,l),w<a&&this.computeOverlapsInternal(x,n,r,w,a,l))};vs.prototype.interfaces_=function(){return[]};vs.prototype.getClass=function(){return vs};var du=function(){};du.prototype.interfaces_=function(){return[]};du.prototype.getClass=function(){return du};du.getChainStartIndices=function(t){var n=0,r=new jt;r.add(new mu(n));do{var i=du.findChainEnd(t,n);r.add(new mu(i)),n=i}while(n<t.length-1);var a=du.toIntArray(r);return a};du.findChainEnd=function(t,n){for(var r=n;r<t.length-1&&t[r].equals2D(t[r+1]);)r++;if(r>=t.length-1)return t.length-1;for(var i=si.quadrant(t[r],t[r+1]),a=n+1;a<t.length;){if(!t[a-1].equals2D(t[a])){var l=si.quadrant(t[a-1],t[a]);if(l!==i)break}a++}return a-1};du.getChains=function(){if(arguments.length===1){var t=arguments[0];return du.getChains(t,null)}else if(arguments.length===2){for(var n=arguments[0],r=arguments[1],i=new jt,a=du.getChainStartIndices(n),l=0;l<a.length-1;l++){var o=new vs(n,a[l],a[l+1],r);i.add(o)}return i}};du.toIntArray=function(t){for(var n=new Array(t.size()).fill(null),r=0;r<n.length;r++)n[r]=t.get(r).intValue();return n};var ld=function(){};ld.prototype.computeNodes=function(t){};ld.prototype.getNodedSubstrings=function(){};ld.prototype.interfaces_=function(){return[]};ld.prototype.getClass=function(){return ld};var I0=function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setSegmentIntersector(t)}}};I0.prototype.setSegmentIntersector=function(t){this._segInt=t};I0.prototype.interfaces_=function(){return[ld]};I0.prototype.getClass=function(){return I0};var F2=function(e){function t(r){r?e.call(this,r):e.call(this),this._monoChains=new jt,this._index=new q4,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={SegmentOverlapAction:{configurable:!0}};return t.prototype.getMonotoneChains=function(){return this._monoChains},t.prototype.getNodedSubstrings=function(){return so.getNodedSubstrings(this._nodedSegStrings)},t.prototype.getIndex=function(){return this._index},t.prototype.add=function(i){for(var a=this,l=du.getChains(i.getCoordinates(),i),o=l.iterator();o.hasNext();){var f=o.next();f.setId(a._idCounter++),a._index.insert(f.getEnvelope(),f),a._monoChains.add(f)}},t.prototype.computeNodes=function(i){var a=this;this._nodedSegStrings=i;for(var l=i.iterator();l.hasNext();)a.add(l.next());this.intersectChains()},t.prototype.intersectChains=function(){for(var i=this,a=new n3(this._segInt),l=this._monoChains.iterator();l.hasNext();)for(var o=l.next(),f=i._index.query(o.getEnvelope()),p=f.iterator();p.hasNext();){var y=p.next();if(y.getId()>o.getId()&&(o.computeOverlaps(y,a),i._nOverlaps++),i._segInt.isDone())return null}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.SegmentOverlapAction.get=function(){return n3},Object.defineProperties(t,n),t}(I0),n3=function(e){function t(){e.call(this),this._si=null;var n=arguments[0];this._si=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.overlap=function(){if(arguments.length===4){var r=arguments[0],i=arguments[1],a=arguments[2],l=arguments[3],o=r.getContext(),f=a.getContext();this._si.processIntersections(o,i,f,l)}else return e.prototype.overlap.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(T0),Wr=function e(){if(this._quadrantSegments=e.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=e.CAP_ROUND,this._joinStyle=e.JOIN_ROUND,this._mitreLimit=e.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=e.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setQuadrantSegments(t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(r)}else if(arguments.length===4){var i=arguments[0],a=arguments[1],l=arguments[2],o=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(a),this.setJoinStyle(l),this.setMitreLimit(o)}}},hh={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Wr.prototype.getEndCapStyle=function(){return this._endCapStyle};Wr.prototype.isSingleSided=function(){return this._isSingleSided};Wr.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,this._quadrantSegments===0&&(this._joinStyle=Wr.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Wr.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==Wr.JOIN_ROUND&&(this._quadrantSegments=Wr.DEFAULT_QUADRANT_SEGMENTS)};Wr.prototype.getJoinStyle=function(){return this._joinStyle};Wr.prototype.setJoinStyle=function(t){this._joinStyle=t};Wr.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t};Wr.prototype.getSimplifyFactor=function(){return this._simplifyFactor};Wr.prototype.getQuadrantSegments=function(){return this._quadrantSegments};Wr.prototype.setEndCapStyle=function(t){this._endCapStyle=t};Wr.prototype.getMitreLimit=function(){return this._mitreLimit};Wr.prototype.setMitreLimit=function(t){this._mitreLimit=t};Wr.prototype.setSingleSided=function(t){this._isSingleSided=t};Wr.prototype.interfaces_=function(){return[]};Wr.prototype.getClass=function(){return Wr};Wr.bufferDistanceError=function(t){var n=Math.PI/2/t;return 1-Math.cos(n/2)};hh.CAP_ROUND.get=function(){return 1};hh.CAP_FLAT.get=function(){return 2};hh.CAP_SQUARE.get=function(){return 3};hh.JOIN_ROUND.get=function(){return 1};hh.JOIN_MITRE.get=function(){return 2};hh.JOIN_BEVEL.get=function(){return 3};hh.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8};hh.DEFAULT_MITRE_LIMIT.get=function(){return 5};hh.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01};Object.defineProperties(Wr,hh);var Qi=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=en.COUNTERCLOCKWISE,this._inputLine=t||null},J0={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Qi.prototype.isDeletable=function(t,n,r,i){var a=this._inputLine[t],l=this._inputLine[n],o=this._inputLine[r];return!this.isConcave(a,l,o)||!this.isShallow(a,l,o,i)?!1:this.isShallowSampled(a,l,t,r,i)};Qi.prototype.deleteShallowConcavities=function(){for(var t=this,n=1,r=this.findNextNonDeletedIndex(n),i=this.findNextNonDeletedIndex(r),a=!1;i<this._inputLine.length;){var l=!1;t.isDeletable(n,r,i,t._distanceTol)&&(t._isDeleted[r]=Qi.DELETE,l=!0,a=!0),l?n=i:n=r,r=t.findNextNonDeletedIndex(n),i=t.findNextNonDeletedIndex(r)}return a};Qi.prototype.isShallowConcavity=function(t,n,r,i){var a=en.computeOrientation(t,n,r),l=a===this._angleOrientation;if(!l)return!1;var o=en.distancePointLine(n,t,r);return o<i};Qi.prototype.isShallowSampled=function(t,n,r,i,a){var l=this,o=Math.trunc((i-r)/Qi.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var f=r;f<i;f+=o)if(!l.isShallow(t,n,l._inputLine[f],a))return!1;return!0};Qi.prototype.isConcave=function(t,n,r){var i=en.computeOrientation(t,n,r),a=i===this._angleOrientation;return a};Qi.prototype.simplify=function(t){var n=this;this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=en.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var r=!1;do r=n.deleteShallowConcavities();while(r);return this.collapseLine()};Qi.prototype.findNextNonDeletedIndex=function(t){for(var n=t+1;n<this._inputLine.length&&this._isDeleted[n]===Qi.DELETE;)n++;return n};Qi.prototype.isShallow=function(t,n,r,i){var a=en.distancePointLine(n,t,r);return a<i};Qi.prototype.collapseLine=function(){for(var t=this,n=new H0,r=0;r<this._inputLine.length;r++)t._isDeleted[r]!==Qi.DELETE&&n.add(t._inputLine[r]);return n.toCoordinateArray()};Qi.prototype.interfaces_=function(){return[]};Qi.prototype.getClass=function(){return Qi};Qi.simplify=function(t,n){var r=new Qi(t);return r.simplify(n)};J0.INIT.get=function(){return 0};J0.DELETE.get=function(){return 1};J0.KEEP.get=function(){return 1};J0.NUM_PTS_TO_CHECK.get=function(){return 10};Object.defineProperties(Qi,J0);var Fs=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new jt},X4={COORDINATE_ARRAY_TYPE:{configurable:!0}};Fs.prototype.getCoordinates=function(){var t=this._ptList.toArray(Fs.COORDINATE_ARRAY_TYPE);return t};Fs.prototype.setPrecisionModel=function(t){this._precisionModel=t};Fs.prototype.addPt=function(t){var n=new $e(t);if(this._precisionModel.makePrecise(n),this.isRedundant(n))return null;this._ptList.add(n)};Fs.prototype.revere=function(){};Fs.prototype.addPts=function(t,n){var r=this;if(n)for(var i=0;i<t.length;i++)r.addPt(t[i]);else for(var a=t.length-1;a>=0;a--)r.addPt(t[a])};Fs.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var n=this._ptList.get(this._ptList.size()-1),r=t.distance(n);return r<this._minimimVertexDistance};Fs.prototype.toString=function(){var t=new rr,n=t.createLineString(this.getCoordinates());return n.toString()};Fs.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new $e(this._ptList.get(0)),n=this._ptList.get(this._ptList.size()-1);if(t.equals(n))return null;this._ptList.add(t)};Fs.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t};Fs.prototype.interfaces_=function(){return[]};Fs.prototype.getClass=function(){return Fs};X4.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)};Object.defineProperties(Fs,X4);var dr=function(){},hg={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};dr.prototype.interfaces_=function(){return[]};dr.prototype.getClass=function(){return dr};dr.toDegrees=function(t){return t*180/Math.PI};dr.normalize=function(t){for(;t>Math.PI;)t-=dr.PI_TIMES_2;for(;t<=-Math.PI;)t+=dr.PI_TIMES_2;return t};dr.angle=function(){if(arguments.length===1){var t=arguments[0];return Math.atan2(t.y,t.x)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],i=r.x-n.x,a=r.y-n.y;return Math.atan2(a,i)}};dr.isAcute=function(t,n,r){var i=t.x-n.x,a=t.y-n.y,l=r.x-n.x,o=r.y-n.y,f=i*l+a*o;return f>0};dr.isObtuse=function(t,n,r){var i=t.x-n.x,a=t.y-n.y,l=r.x-n.x,o=r.y-n.y,f=i*l+a*o;return f<0};dr.interiorAngle=function(t,n,r){var i=dr.angle(n,t),a=dr.angle(n,r);return Math.abs(a-i)};dr.normalizePositive=function(t){if(t<0){for(;t<0;)t+=dr.PI_TIMES_2;t>=dr.PI_TIMES_2&&(t=0)}else{for(;t>=dr.PI_TIMES_2;)t-=dr.PI_TIMES_2;t<0&&(t=0)}return t};dr.angleBetween=function(t,n,r){var i=dr.angle(n,t),a=dr.angle(n,r);return dr.diff(i,a)};dr.diff=function(t,n){var r=null;return t<n?r=n-t:r=t-n,r>Math.PI&&(r=2*Math.PI-r),r};dr.toRadians=function(t){return t*Math.PI/180};dr.getTurn=function(t,n){var r=Math.sin(n-t);return r>0?dr.COUNTERCLOCKWISE:r<0?dr.CLOCKWISE:dr.NONE};dr.angleBetweenOriented=function(t,n,r){var i=dr.angle(n,t),a=dr.angle(n,r),l=a-i;return l<=-Math.PI?l+dr.PI_TIMES_2:l>Math.PI?l-dr.PI_TIMES_2:l};hg.PI_TIMES_2.get=function(){return 2*Math.PI};hg.PI_OVER_2.get=function(){return Math.PI/2};hg.PI_OVER_4.get=function(){return Math.PI/4};hg.COUNTERCLOCKWISE.get=function(){return en.COUNTERCLOCKWISE};hg.CLOCKWISE.get=function(){return en.CLOCKWISE};hg.NONE.get=function(){return en.COLLINEAR};Object.defineProperties(dr,hg);var Di=function e(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new wn,this._seg1=new wn,this._offset0=new wn,this._offset1=new wn,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],n=arguments[1],r=arguments[2];this._precisionModel=t,this._bufParams=n,this._li=new xd,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===Wr.JOIN_ROUND&&(this._closingSegLengthFactor=e.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)},Q0={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Di.prototype.addNextSegment=function(t,n){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var r=en.computeOrientation(this._s0,this._s1,this._s2),i=r===en.CLOCKWISE&&this._side===Ft.LEFT||r===en.COUNTERCLOCKWISE&&this._side===Ft.RIGHT;r===0?this.addCollinear(n):i?this.addOutsideTurn(r,n):this.addInsideTurn(r,n)};Di.prototype.addLineEndCap=function(t,n){var r=new wn(t,n),i=new wn;this.computeOffsetSegment(r,Ft.LEFT,this._distance,i);var a=new wn;this.computeOffsetSegment(r,Ft.RIGHT,this._distance,a);var l=n.x-t.x,o=n.y-t.y,f=Math.atan2(o,l);switch(this._bufParams.getEndCapStyle()){case Wr.CAP_ROUND:this._segList.addPt(i.p1),this.addFilletArc(n,f+Math.PI/2,f-Math.PI/2,en.CLOCKWISE,this._distance),this._segList.addPt(a.p1);break;case Wr.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(a.p1);break;case Wr.CAP_SQUARE:var p=new $e;p.x=Math.abs(this._distance)*Math.cos(f),p.y=Math.abs(this._distance)*Math.sin(f);var y=new $e(i.p1.x+p.x,i.p1.y+p.y),x=new $e(a.p1.x+p.x,a.p1.y+p.y);this._segList.addPt(y),this._segList.addPt(x);break}};Di.prototype.getCoordinates=function(){var t=this._segList.getCoordinates();return t};Di.prototype.addMitreJoin=function(t,n,r,i){var a=!0,l=null;try{l=Il.intersection(n.p0,n.p1,r.p0,r.p1);var o=i<=0?1:l.distance(t)/Math.abs(i);o>this._bufParams.getMitreLimit()&&(a=!1)}catch(f){if(f instanceof Iy)l=new $e(0,0),a=!1;else throw f}finally{}a?this._segList.addPt(l):this.addLimitedMitreJoin(n,r,i,this._bufParams.getMitreLimit())};Di.prototype.addFilletCorner=function(t,n,r,i,a){var l=n.x-t.x,o=n.y-t.y,f=Math.atan2(o,l),p=r.x-t.x,y=r.y-t.y,x=Math.atan2(y,p);i===en.CLOCKWISE?f<=x&&(f+=2*Math.PI):f>=x&&(f-=2*Math.PI),this._segList.addPt(n),this.addFilletArc(t,f,x,i,a),this._segList.addPt(r)};Di.prototype.addOutsideTurn=function(t,n){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Di.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Wr.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Wr.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(n&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))};Di.prototype.createSquare=function(t){this._segList.addPt(new $e(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new $e(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new $e(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new $e(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()};Di.prototype.addSegments=function(t,n){this._segList.addPts(t,n)};Di.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)};Di.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)};Di.prototype.initSideSegments=function(t,n,r){this._s1=t,this._s2=n,this._side=r,this._seg1.setCoordinates(t,n),this.computeOffsetSegment(this._seg1,r,this._distance,this._offset1)};Di.prototype.addLimitedMitreJoin=function(t,n,r,i){var a=this._seg0.p1,l=dr.angle(a,this._seg0.p0),o=dr.angleBetweenOriented(this._seg0.p0,a,this._seg1.p1),f=o/2,p=dr.normalize(l+f),y=dr.normalize(p+Math.PI),x=i*r,w=x*Math.abs(Math.sin(f)),S=r-w,L=a.x+x*Math.cos(y),D=a.y+x*Math.sin(y),B=new $e(L,D),z=new wn(a,B),M=z.pointAlongOffset(1,S),k=z.pointAlongOffset(1,-S);this._side===Ft.LEFT?(this._segList.addPt(M),this._segList.addPt(k)):(this._segList.addPt(k),this._segList.addPt(M))};Di.prototype.computeOffsetSegment=function(t,n,r,i){var a=n===Ft.LEFT?1:-1,l=t.p1.x-t.p0.x,o=t.p1.y-t.p0.y,f=Math.sqrt(l*l+o*o),p=a*r*l/f,y=a*r*o/f;i.p0.x=t.p0.x-y,i.p0.y=t.p0.y+p,i.p1.x=t.p1.x-y,i.p1.y=t.p1.y+p};Di.prototype.addFilletArc=function(t,n,r,i,a){var l=this,o=i===en.CLOCKWISE?-1:1,f=Math.abs(n-r),p=Math.trunc(f/this._filletAngleQuantum+.5);if(p<1)return null;for(var y=0,x=f/p,w=y,S=new $e;w<f;){var L=n+o*w;S.x=t.x+a*Math.cos(L),S.y=t.y+a*Math.sin(L),l._segList.addPt(S),w+=x}};Di.prototype.addInsideTurn=function(t,n){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Di.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var r=new $e((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r);var i=new $e((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}};Di.prototype.createCircle=function(t){var n=new $e(t.x+this._distance,t.y);this._segList.addPt(n),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()};Di.prototype.addBevelJoin=function(t,n){this._segList.addPt(t.p1),this._segList.addPt(n.p0)};Di.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Fs,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Di.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)};Di.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);var n=this._li.getIntersectionNum();n>=2&&(this._bufParams.getJoinStyle()===Wr.JOIN_BEVEL||this._bufParams.getJoinStyle()===Wr.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,en.CLOCKWISE,this._distance))};Di.prototype.closeRing=function(){this._segList.closeRing()};Di.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle};Di.prototype.interfaces_=function(){return[]};Di.prototype.getClass=function(){return Di};Q0.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001};Q0.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001};Q0.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6};Q0.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80};Object.defineProperties(Di,Q0);var Qa=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],n=arguments[1];this._precisionModel=t,this._bufParams=n};Qa.prototype.getOffsetCurve=function(t,n){if(this._distance=n,n===0)return null;var r=n<0,i=Math.abs(n),a=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],a):this.computeOffsetCurve(t,r,a);var l=a.getCoordinates();return r&&ir.reverse(l),l};Qa.prototype.computeSingleSidedBufferCurve=function(t,n,r){var i=this.simplifyTolerance(this._distance);if(n){r.addSegments(t,!0);var a=Qi.simplify(t,-i),l=a.length-1;r.initSideSegments(a[l],a[l-1],Ft.LEFT),r.addFirstSegment();for(var o=l-2;o>=0;o--)r.addNextSegment(a[o],!0)}else{r.addSegments(t,!1);var f=Qi.simplify(t,i),p=f.length-1;r.initSideSegments(f[0],f[1],Ft.LEFT),r.addFirstSegment();for(var y=2;y<=p;y++)r.addNextSegment(f[y],!0)}r.addLastSegment(),r.closeRing()};Qa.prototype.computeRingBufferCurve=function(t,n,r){var i=this.simplifyTolerance(this._distance);n===Ft.RIGHT&&(i=-i);var a=Qi.simplify(t,i),l=a.length-1;r.initSideSegments(a[l-1],a[0],n);for(var o=1;o<=l;o++){var f=o!==1;r.addNextSegment(a[o],f)}r.closeRing()};Qa.prototype.computeLineBufferCurve=function(t,n){var r=this.simplifyTolerance(this._distance),i=Qi.simplify(t,r),a=i.length-1;n.initSideSegments(i[0],i[1],Ft.LEFT);for(var l=2;l<=a;l++)n.addNextSegment(i[l],!0);n.addLastSegment(),n.addLineEndCap(i[a-1],i[a]);var o=Qi.simplify(t,-r),f=o.length-1;n.initSideSegments(o[f],o[f-1],Ft.LEFT);for(var p=f-2;p>=0;p--)n.addNextSegment(o[p],!0);n.addLastSegment(),n.addLineEndCap(o[1],o[0]),n.closeRing()};Qa.prototype.computePointCurve=function(t,n){switch(this._bufParams.getEndCapStyle()){case Wr.CAP_ROUND:n.createCircle(t);break;case Wr.CAP_SQUARE:n.createSquare(t);break}};Qa.prototype.getLineCurve=function(t,n){if(this._distance=n,n<0&&!this._bufParams.isSingleSided()||n===0)return null;var r=Math.abs(n),i=this.getSegGen(r);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){var a=n<0;this.computeSingleSidedBufferCurve(t,a,i)}else this.computeLineBufferCurve(t,i);var l=i.getCoordinates();return l};Qa.prototype.getBufferParameters=function(){return this._bufParams};Qa.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()};Qa.prototype.getRingCurve=function(t,n,r){if(this._distance=r,t.length<=2)return this.getLineCurve(t,r);if(r===0)return Qa.copyCoordinates(t);var i=this.getSegGen(r);return this.computeRingBufferCurve(t,n,i),i.getCoordinates()};Qa.prototype.computeOffsetCurve=function(t,n,r){var i=this.simplifyTolerance(this._distance);if(n){var a=Qi.simplify(t,-i),l=a.length-1;r.initSideSegments(a[l],a[l-1],Ft.LEFT),r.addFirstSegment();for(var o=l-2;o>=0;o--)r.addNextSegment(a[o],!0)}else{var f=Qi.simplify(t,i),p=f.length-1;r.initSideSegments(f[0],f[1],Ft.LEFT),r.addFirstSegment();for(var y=2;y<=p;y++)r.addNextSegment(f[y],!0)}r.addLastSegment()};Qa.prototype.getSegGen=function(t){return new Di(this._precisionModel,this._bufParams,t)};Qa.prototype.interfaces_=function(){return[]};Qa.prototype.getClass=function(){return Qa};Qa.copyCoordinates=function(t){for(var n=new Array(t.length).fill(null),r=0;r<n.length;r++)n[r]=new $e(t[r]);return n};var Zp=function(){this._subgraphs=null,this._seg=new wn,this._cga=new en;var t=arguments[0];this._subgraphs=t},W4={DepthSegment:{configurable:!0}};Zp.prototype.findStabbedSegments=function(){var t=this;if(arguments.length===1){for(var n=arguments[0],r=new jt,i=this._subgraphs.iterator();i.hasNext();){var a=i.next(),l=a.getEnvelope();n.y<l.getMinY()||n.y>l.getMaxY()||t.findStabbedSegments(n,a.getDirectedEdges(),r)}return r}else if(arguments.length===3){if(Pn(arguments[2],Cl)&&arguments[0]instanceof $e&&arguments[1]instanceof CI)for(var o=arguments[0],f=arguments[1],p=arguments[2],y=f.getEdge().getCoordinates(),x=0;x<y.length-1;x++){t._seg.p0=y[x],t._seg.p1=y[x+1],t._seg.p0.y>t._seg.p1.y&&t._seg.reverse();var w=Math.max(t._seg.p0.x,t._seg.p1.x);if(!(w<o.x)&&!t._seg.isHorizontal()&&!(o.y<t._seg.p0.y||o.y>t._seg.p1.y)&&en.computeOrientation(t._seg.p0,t._seg.p1,o)!==en.RIGHT){var S=f.getDepth(Ft.LEFT);t._seg.p0.equals(y[x])||(S=f.getDepth(Ft.RIGHT));var L=new ud(t._seg,S);p.add(L)}}else if(Pn(arguments[2],Cl)&&arguments[0]instanceof $e&&Pn(arguments[1],Cl))for(var D=arguments[0],B=arguments[1],z=arguments[2],M=B.iterator();M.hasNext();){var k=M.next();k.isForward()&&t.findStabbedSegments(D,k,z)}}};Zp.prototype.getDepth=function(t){var n=this.findStabbedSegments(t);if(n.size()===0)return 0;var r=Ol.min(n);return r._leftDepth};Zp.prototype.interfaces_=function(){return[]};Zp.prototype.getClass=function(){return Zp};W4.DepthSegment.get=function(){return ud};Object.defineProperties(Zp,W4);var ud=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],n=arguments[1];this._upwardSeg=new wn(t),this._leftDepth=n};ud.prototype.compareTo=function(t){var n=t;if(this._upwardSeg.minX()>=n._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=n._upwardSeg.minX())return-1;var r=this._upwardSeg.orientationIndex(n._upwardSeg);return r!==0||(r=-1*n._upwardSeg.orientationIndex(this._upwardSeg),r!==0)?r:this._upwardSeg.compareTo(n._upwardSeg)};ud.prototype.compareX=function(t,n){var r=t.p0.compareTo(n.p0);return r!==0?r:t.p1.compareTo(n.p1)};ud.prototype.toString=function(){return this._upwardSeg.toString()};ud.prototype.interfaces_=function(){return[fl]};ud.prototype.getClass=function(){return ud};var Yr=function(t,n,r){this.p0=t||null,this.p1=n||null,this.p2=r||null};Yr.prototype.area=function(){return Yr.area(this.p0,this.p1,this.p2)};Yr.prototype.signedArea=function(){return Yr.signedArea(this.p0,this.p1,this.p2)};Yr.prototype.interpolateZ=function(t){if(t===null)throw new Ui("Supplied point is null.");return Yr.interpolateZ(t,this.p0,this.p1,this.p2)};Yr.prototype.longestSideLength=function(){return Yr.longestSideLength(this.p0,this.p1,this.p2)};Yr.prototype.isAcute=function(){return Yr.isAcute(this.p0,this.p1,this.p2)};Yr.prototype.circumcentre=function(){return Yr.circumcentre(this.p0,this.p1,this.p2)};Yr.prototype.area3D=function(){return Yr.area3D(this.p0,this.p1,this.p2)};Yr.prototype.centroid=function(){return Yr.centroid(this.p0,this.p1,this.p2)};Yr.prototype.inCentre=function(){return Yr.inCentre(this.p0,this.p1,this.p2)};Yr.prototype.interfaces_=function(){return[]};Yr.prototype.getClass=function(){return Yr};Yr.area=function(t,n,r){return Math.abs(((r.x-t.x)*(n.y-t.y)-(n.x-t.x)*(r.y-t.y))/2)};Yr.signedArea=function(t,n,r){return((r.x-t.x)*(n.y-t.y)-(n.x-t.x)*(r.y-t.y))/2};Yr.det=function(t,n,r,i){return t*i-n*r};Yr.interpolateZ=function(t,n,r,i){var a=n.x,l=n.y,o=r.x-a,f=i.x-a,p=r.y-l,y=i.y-l,x=o*y-f*p,w=t.x-a,S=t.y-l,L=(y*w-f*S)/x,D=(-p*w+o*S)/x,B=n.z+L*(r.z-n.z)+D*(i.z-n.z);return B};Yr.longestSideLength=function(t,n,r){var i=t.distance(n),a=n.distance(r),l=r.distance(t),o=i;return a>o&&(o=a),l>o&&(o=l),o};Yr.isAcute=function(t,n,r){return!(!dr.isAcute(t,n,r)||!dr.isAcute(n,r,t)||!dr.isAcute(r,t,n))};Yr.circumcentre=function(t,n,r){var i=r.x,a=r.y,l=t.x-i,o=t.y-a,f=n.x-i,p=n.y-a,y=2*Yr.det(l,o,f,p),x=Yr.det(o,l*l+o*o,p,f*f+p*p),w=Yr.det(l,l*l+o*o,f,f*f+p*p),S=i-x/y,L=a+w/y;return new $e(S,L)};Yr.perpendicularBisector=function(t,n){var r=n.x-t.x,i=n.y-t.y,a=new Il(t.x+r/2,t.y+i/2,1),l=new Il(t.x-i+r/2,t.y+r+i/2,1);return new Il(a,l)};Yr.angleBisector=function(t,n,r){var i=n.distance(t),a=n.distance(r),l=i/(i+a),o=r.x-t.x,f=r.y-t.y,p=new $e(t.x+l*o,t.y+l*f);return p};Yr.area3D=function(t,n,r){var i=n.x-t.x,a=n.y-t.y,l=n.z-t.z,o=r.x-t.x,f=r.y-t.y,p=r.z-t.z,y=a*p-l*f,x=l*o-i*p,w=i*f-a*o,S=y*y+x*x+w*w,L=Math.sqrt(S)/2;return L};Yr.centroid=function(t,n,r){var i=(t.x+n.x+r.x)/3,a=(t.y+n.y+r.y)/3;return new $e(i,a)};Yr.inCentre=function(t,n,r){var i=n.distance(r),a=t.distance(r),l=t.distance(n),o=i+a+l,f=(i*t.x+a*n.x+l*r.x)/o,p=(i*t.y+a*n.y+l*r.y)/o;return new $e(f,p)};var cl=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new jt;var t=arguments[0],n=arguments[1],r=arguments[2];this._inputGeom=t,this._distance=n,this._curveBuilder=r};cl.prototype.addPoint=function(t){if(this._distance<=0)return null;var n=t.getCoordinates(),r=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(r,tt.EXTERIOR,tt.INTERIOR)};cl.prototype.addPolygon=function(t){var n=this,r=this._distance,i=Ft.LEFT;this._distance<0&&(r=-this._distance,i=Ft.RIGHT);var a=t.getExteriorRing(),l=ir.removeRepeatedPoints(a.getCoordinates());if(this._distance<0&&this.isErodedCompletely(a,this._distance)||this._distance<=0&&l.length<3)return null;this.addPolygonRing(l,r,i,tt.EXTERIOR,tt.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var f=t.getInteriorRingN(o),p=ir.removeRepeatedPoints(f.getCoordinates());n._distance>0&&n.isErodedCompletely(f,-n._distance)||n.addPolygonRing(p,r,Ft.opposite(i),tt.INTERIOR,tt.EXTERIOR)}};cl.prototype.isTriangleErodedCompletely=function(t,n){var r=new Yr(t[0],t[1],t[2]),i=r.inCentre(),a=en.distancePointLine(i,r.p0,r.p1);return a<Math.abs(n)};cl.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var n=ir.removeRepeatedPoints(t.getCoordinates()),r=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(r,tt.EXTERIOR,tt.INTERIOR)};cl.prototype.addCurve=function(t,n,r){if(t===null||t.length<2)return null;var i=new so(t,new ri(0,tt.BOUNDARY,n,r));this._curveList.add(i)};cl.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList};cl.prototype.addPolygonRing=function(t,n,r,i,a){if(n===0&&t.length<gc.MINIMUM_VALID_SIZE)return null;var l=i,o=a;t.length>=gc.MINIMUM_VALID_SIZE&&en.isCCW(t)&&(l=a,o=i,r=Ft.opposite(r));var f=this._curveBuilder.getRingCurve(t,r,n);this.addCurve(f,l,o)};cl.prototype.add=function(t){if(t.isEmpty())return null;t instanceof Ro?this.addPolygon(t):t instanceof Ki?this.addLineString(t):t instanceof ms?this.addPoint(t):t instanceof iy?this.addCollection(t):t instanceof sd?this.addCollection(t):t instanceof fc?this.addCollection(t):t instanceof Va&&this.addCollection(t)};cl.prototype.isErodedCompletely=function(t,n){var r=t.getCoordinates();if(r.length<4)return n<0;if(r.length===4)return this.isTriangleErodedCompletely(r,n);var i=t.getEnvelopeInternal(),a=Math.min(i.getHeight(),i.getWidth());return n<0&&2*Math.abs(n)>a};cl.prototype.addCollection=function(t){for(var n=this,r=0;r<t.getNumGeometries();r++){var i=t.getGeometryN(r);n.add(i)}};cl.prototype.interfaces_=function(){return[]};cl.prototype.getClass=function(){return cl};var ly=function(){};ly.prototype.locate=function(t){};ly.prototype.interfaces_=function(){return[]};ly.prototype.getClass=function(){return ly};var dc=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};dc.prototype.next=function(){if(this._atStart)return this._atStart=!1,dc.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Py;var t=this._parent.getGeometryN(this._index++);return t instanceof Va?(this._subcollectionIterator=new dc(t),this._subcollectionIterator.next()):t};dc.prototype.remove=function(){throw new Error(this.getClass().getName())};dc.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)};dc.prototype.interfaces_=function(){return[Cy]};dc.prototype.getClass=function(){return dc};dc.isAtomic=function(t){return!(t instanceof Va)};var Os=function(){this._geom=null;var t=arguments[0];this._geom=t};Os.prototype.locate=function(t){return Os.locate(t,this._geom)};Os.prototype.interfaces_=function(){return[ly]};Os.prototype.getClass=function(){return Os};Os.isPointInRing=function(t,n){return n.getEnvelopeInternal().intersects(t)?en.isPointInRing(t,n.getCoordinates()):!1};Os.containsPointInPolygon=function(t,n){if(n.isEmpty())return!1;var r=n.getExteriorRing();if(!Os.isPointInRing(t,r))return!1;for(var i=0;i<n.getNumInteriorRing();i++){var a=n.getInteriorRingN(i);if(Os.isPointInRing(t,a))return!1}return!0};Os.containsPoint=function(t,n){if(n instanceof Ro)return Os.containsPointInPolygon(t,n);if(n instanceof Va)for(var r=new dc(n);r.hasNext();){var i=r.next();if(i!==n&&Os.containsPoint(t,i))return!0}return!1};Os.locate=function(t,n){return n.isEmpty()?tt.EXTERIOR:Os.containsPoint(t,n)?tt.INTERIOR:tt.EXTERIOR};var Ea=function(){this._edgeMap=new ba,this._edgeList=null,this._ptInAreaLocation=[tt.NONE,tt.NONE]};Ea.prototype.getNextCW=function(t){this.getEdges();var n=this._edgeList.indexOf(t),r=n-1;return n===0&&(r=this._edgeList.size()-1),this._edgeList.get(r)};Ea.prototype.propagateSideLabels=function(t){for(var n=tt.NONE,r=this.iterator();r.hasNext();){var i=r.next(),a=i.getLabel();a.isArea(t)&&a.getLocation(t,Ft.LEFT)!==tt.NONE&&(n=a.getLocation(t,Ft.LEFT))}if(n===tt.NONE)return null;for(var l=n,o=this.iterator();o.hasNext();){var f=o.next(),p=f.getLabel();if(p.getLocation(t,Ft.ON)===tt.NONE&&p.setLocation(t,Ft.ON,l),p.isArea(t)){var y=p.getLocation(t,Ft.LEFT),x=p.getLocation(t,Ft.RIGHT);if(x!==tt.NONE){if(x!==l)throw new rh("side location conflict",f.getCoordinate());y===tt.NONE&&Xn.shouldNeverReachHere("found single null side (at "+f.getCoordinate()+")"),l=y}else Xn.isTrue(p.getLocation(t,Ft.LEFT)===tt.NONE,"found single null side"),p.setLocation(t,Ft.RIGHT,l),p.setLocation(t,Ft.LEFT,l)}}};Ea.prototype.getCoordinate=function(){var t=this.iterator();if(!t.hasNext())return null;var n=t.next();return n.getCoordinate()};Ea.prototype.print=function(t){la.out.println("EdgeEndStar:   "+this.getCoordinate());for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};Ea.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)};Ea.prototype.checkAreaLabelsConsistent=function(t){var n=this.getEdges();if(n.size()<=0)return!0;var r=n.size()-1,i=n.get(r).getLabel(),a=i.getLocation(t,Ft.LEFT);Xn.isTrue(a!==tt.NONE,"Found unlabelled area edge");for(var l=a,o=this.iterator();o.hasNext();){var f=o.next(),p=f.getLabel();Xn.isTrue(p.isArea(t),"Found non-area edge");var y=p.getLocation(t,Ft.LEFT),x=p.getLocation(t,Ft.RIGHT);if(y===x||x!==l)return!1;l=y}return!0};Ea.prototype.findIndex=function(t){var n=this;this.iterator();for(var r=0;r<this._edgeList.size();r++){var i=n._edgeList.get(r);if(i===t)return r}return-1};Ea.prototype.iterator=function(){return this.getEdges().iterator()};Ea.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new jt(this._edgeMap.values())),this._edgeList};Ea.prototype.getLocation=function(t,n,r){return this._ptInAreaLocation[t]===tt.NONE&&(this._ptInAreaLocation[t]=Os.locate(n,r[t].getGeometry())),this._ptInAreaLocation[t]};Ea.prototype.toString=function(){var t=new Pu;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append(`
`);for(var n=this.iterator();n.hasNext();){var r=n.next();t.append(r),t.append(`
`)}return t.toString()};Ea.prototype.computeEdgeEndLabels=function(t){for(var n=this.iterator();n.hasNext();){var r=n.next();r.computeLabel(t)}};Ea.prototype.computeLabelling=function(t){var n=this;this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var r=[!1,!1],i=this.iterator();i.hasNext();)for(var a=i.next(),l=a.getLabel(),o=0;o<2;o++)l.isLine(o)&&l.getLocation(o)===tt.BOUNDARY&&(r[o]=!0);for(var f=this.iterator();f.hasNext();)for(var p=f.next(),y=p.getLabel(),x=0;x<2;x++)if(y.isAnyNull(x)){var w=tt.NONE;if(r[x])w=tt.EXTERIOR;else{var S=p.getCoordinate();w=n.getLocation(x,S,t)}y.setAllLocationsIfNull(x,w)}};Ea.prototype.getDegree=function(){return this._edgeMap.size()};Ea.prototype.insertEdgeEnd=function(t,n){this._edgeMap.put(t,n),this._edgeList=null};Ea.prototype.interfaces_=function(){return[]};Ea.prototype.getClass=function(){return Ea};var XW=function(e){function t(){e.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.linkResultDirectedEdges=function(){var r=this;this.getResultAreaEdges();for(var i=null,a=null,l=this._SCANNING_FOR_INCOMING,o=0;o<this._resultAreaEdgeList.size();o++){var f=r._resultAreaEdgeList.get(o),p=f.getSym();if(f.getLabel().isArea())switch(i===null&&f.isInResult()&&(i=f),l){case r._SCANNING_FOR_INCOMING:if(!p.isInResult())continue;a=p,l=r._LINKING_TO_OUTGOING;break;case r._LINKING_TO_OUTGOING:if(!f.isInResult())continue;a.setNext(f),l=r._SCANNING_FOR_INCOMING;break}}if(l===this._LINKING_TO_OUTGOING){if(i===null)throw new rh("no outgoing dirEdge found",this.getCoordinate());Xn.isTrue(i.isInResult(),"unable to link last incoming dirEdge"),a.setNext(i)}},t.prototype.insert=function(r){var i=r;this.insertEdgeEnd(i,i)},t.prototype.getRightmostEdge=function(){var r=this.getEdges(),i=r.size();if(i<1)return null;var a=r.get(0);if(i===1)return a;var l=r.get(i-1),o=a.getQuadrant(),f=l.getQuadrant();return si.isNorthern(o)&&si.isNorthern(f)?a:!si.isNorthern(o)&&!si.isNorthern(f)?l:a.getDy()!==0?a:l.getDy()!==0?l:(Xn.shouldNeverReachHere("found two horizontal edges incident on node"),null)},t.prototype.print=function(r){la.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var i=this.iterator();i.hasNext();){var a=i.next();r.print("out "),a.print(r),r.println(),r.print("in "),a.getSym().print(r),r.println()}},t.prototype.getResultAreaEdges=function(){var r=this;if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new jt;for(var i=this.iterator();i.hasNext();){var a=i.next();(a.isInResult()||a.getSym().isInResult())&&r._resultAreaEdgeList.add(a)}return this._resultAreaEdgeList},t.prototype.updateLabelling=function(r){for(var i=this.iterator();i.hasNext();){var a=i.next(),l=a.getLabel();l.setAllLocationsIfNull(0,r.getLocation(0)),l.setAllLocationsIfNull(1,r.getLocation(1))}},t.prototype.linkAllDirectedEdges=function(){var r=this;this.getEdges();for(var i=null,a=null,l=this._edgeList.size()-1;l>=0;l--){var o=r._edgeList.get(l),f=o.getSym();a===null&&(a=f),i!==null&&f.setNext(i),i=o}a.setNext(i)},t.prototype.computeDepths=function(){var r=this;if(arguments.length===1){var i=arguments[0],a=this.findIndex(i),l=i.getDepth(Ft.LEFT),o=i.getDepth(Ft.RIGHT),f=this.computeDepths(a+1,this._edgeList.size(),l),p=this.computeDepths(0,a,f);if(p!==o)throw new rh("depth mismatch at "+i.getCoordinate())}else if(arguments.length===3){for(var y=arguments[0],x=arguments[1],w=arguments[2],S=w,L=y;L<x;L++){var D=r._edgeList.get(L);D.setEdgeDepths(Ft.RIGHT,S),S=D.getDepth(Ft.LEFT)}return S}},t.prototype.mergeSymLabels=function(){for(var r=this.iterator();r.hasNext();){var i=r.next(),a=i.getLabel();a.merge(i.getSym().getLabel())}},t.prototype.linkMinimalDirectedEdges=function(r){for(var i=this,a=null,l=null,o=this._SCANNING_FOR_INCOMING,f=this._resultAreaEdgeList.size()-1;f>=0;f--){var p=i._resultAreaEdgeList.get(f),y=p.getSym();switch(a===null&&p.getEdgeRing()===r&&(a=p),o){case i._SCANNING_FOR_INCOMING:if(y.getEdgeRing()!==r)continue;l=y,o=i._LINKING_TO_OUTGOING;break;case i._LINKING_TO_OUTGOING:if(p.getEdgeRing()!==r)continue;l.setNextMin(p),o=i._SCANNING_FOR_INCOMING;break}}o===this._LINKING_TO_OUTGOING&&(Xn.isTrue(a!==null,"found null for first outgoing dirEdge"),Xn.isTrue(a.getEdgeRing()===r,"unable to link last incoming dirEdge"),l.setNextMin(a))},t.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var r=0,i=this.iterator();i.hasNext();){var a=i.next();a.isInResult()&&r++}return r}else if(arguments.length===1){for(var l=arguments[0],o=0,f=this.iterator();f.hasNext();){var p=f.next();p.getEdgeRing()===l&&o++}return o}},t.prototype.getLabel=function(){return this._label},t.prototype.findCoveredLineEdges=function(){for(var r=tt.NONE,i=this.iterator();i.hasNext();){var a=i.next(),l=a.getSym();if(!a.isLineEdge()){if(a.isInResult()){r=tt.INTERIOR;break}if(l.isInResult()){r=tt.EXTERIOR;break}}}if(r===tt.NONE)return null;for(var o=r,f=this.iterator();f.hasNext();){var p=f.next(),y=p.getSym();p.isLineEdge()?p.getEdge().setCovered(o===tt.INTERIOR):(p.isInResult()&&(o=tt.EXTERIOR),y.isInResult()&&(o=tt.INTERIOR))}},t.prototype.computeLabelling=function(r){var i=this;e.prototype.computeLabelling.call(this,r),this._label=new ri(tt.NONE);for(var a=this.iterator();a.hasNext();)for(var l=a.next(),o=l.getEdge(),f=o.getLabel(),p=0;p<2;p++){var y=f.getLocation(p);(y===tt.INTERIOR||y===tt.BOUNDARY)&&i._label.setLocation(p,tt.INTERIOR)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ea),H4=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.createNode=function(r){return new $w(r,new XW)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(oy),Wh=function e(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=e.orientation(t)};Wh.prototype.compareTo=function(t){var n=t,r=Wh.compareOriented(this._pts,this._orientation,n._pts,n._orientation);return r};Wh.prototype.interfaces_=function(){return[fl]};Wh.prototype.getClass=function(){return Wh};Wh.orientation=function(t){return ir.increasingDirection(t)===1};Wh.compareOriented=function(t,n,r,i){for(var a=n?1:-1,l=i?1:-1,o=n?t.length:-1,f=i?r.length:-1,p=n?0:t.length-1,y=i?0:r.length-1;;){var x=t[p].compareTo(r[y]);if(x!==0)return x;p+=a,y+=l;var w=p===o,S=y===f;if(w&&!S)return-1;if(!w&&S)return 1;if(w&&S)return 0}};var Dl=function(){this._edges=new jt,this._ocaMap=new ba};Dl.prototype.print=function(t){var n=this;t.print("MULTILINESTRING ( ");for(var r=0;r<this._edges.size();r++){var i=n._edges.get(r);r>0&&t.print(","),t.print("(");for(var a=i.getCoordinates(),l=0;l<a.length;l++)l>0&&t.print(","),t.print(a[l].x+" "+a[l].y);t.println(")")}t.print(")  ")};Dl.prototype.addAll=function(t){for(var n=this,r=t.iterator();r.hasNext();)n.add(r.next())};Dl.prototype.findEdgeIndex=function(t){for(var n=this,r=0;r<this._edges.size();r++)if(n._edges.get(r).equals(t))return r;return-1};Dl.prototype.iterator=function(){return this._edges.iterator()};Dl.prototype.getEdges=function(){return this._edges};Dl.prototype.get=function(t){return this._edges.get(t)};Dl.prototype.findEqualEdge=function(t){var n=new Wh(t.getCoordinates()),r=this._ocaMap.get(n);return r};Dl.prototype.add=function(t){this._edges.add(t);var n=new Wh(t.getCoordinates());this._ocaMap.put(n,t)};Dl.prototype.interfaces_=function(){return[]};Dl.prototype.getClass=function(){return Dl};var cd=function(){};cd.prototype.processIntersections=function(t,n,r,i){};cd.prototype.isDone=function(){};cd.prototype.interfaces_=function(){return[]};cd.prototype.getClass=function(){return cd};var Bs=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};Bs.prototype.isTrivialIntersection=function(t,n,r,i){if(t===r&&this._li.getIntersectionNum()===1){if(Bs.isAdjacentSegments(n,i))return!0;if(t.isClosed()){var a=t.size()-1;if(n===0&&i===a||i===0&&n===a)return!0}}return!1};Bs.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};Bs.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};Bs.prototype.getLineIntersector=function(){return this._li};Bs.prototype.hasProperIntersection=function(){return this._hasProper};Bs.prototype.processIntersections=function(t,n,r,i){if(t===r&&n===i)return null;this.numTests++;var a=t.getCoordinates()[n],l=t.getCoordinates()[n+1],o=r.getCoordinates()[i],f=r.getCoordinates()[i+1];this._li.computeIntersection(a,l,o,f),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,n,r,i)||(this._hasIntersection=!0,t.addIntersections(this._li,n,0),r.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))};Bs.prototype.hasIntersection=function(){return this._hasIntersection};Bs.prototype.isDone=function(){return!1};Bs.prototype.hasInteriorIntersection=function(){return this._hasInterior};Bs.prototype.interfaces_=function(){return[cd]};Bs.prototype.getClass=function(){return Bs};Bs.isAdjacentSegments=function(t,n){return Math.abs(t-n)===1};var wu=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],n=arguments[1],r=arguments[2];this.coord=new $e(t),this.segmentIndex=n,this.dist=r};wu.prototype.getSegmentIndex=function(){return this.segmentIndex};wu.prototype.getCoordinate=function(){return this.coord};wu.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)};wu.prototype.compareTo=function(t){var n=t;return this.compare(n.segmentIndex,n.dist)};wu.prototype.isEndPoint=function(t){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===t};wu.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist};wu.prototype.getDistance=function(){return this.dist};wu.prototype.compare=function(t,n){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<n?-1:this.dist>n?1:0};wu.prototype.interfaces_=function(){return[fl]};wu.prototype.getClass=function(){return wu};var vc=function(){this._nodeMap=new ba,this.edge=null;var t=arguments[0];this.edge=t};vc.prototype.print=function(t){t.println("Intersections:");for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(t)}};vc.prototype.iterator=function(){return this._nodeMap.values().iterator()};vc.prototype.addSplitEdges=function(t){var n=this;this.addEndpoints();for(var r=this.iterator(),i=r.next();r.hasNext();){var a=r.next(),l=n.createSplitEdge(i,a);t.add(l),i=a}};vc.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)};vc.prototype.createSplitEdge=function(t,n){var r=this,i=n.segmentIndex-t.segmentIndex+2,a=this.edge.pts[n.segmentIndex],l=n.dist>0||!n.coord.equals2D(a);l||i--;var o=new Array(i).fill(null),f=0;o[f++]=new $e(t.coord);for(var p=t.segmentIndex+1;p<=n.segmentIndex;p++)o[f++]=r.edge.pts[p];return l&&(o[f]=n.coord),new Vb(o,new ri(this.edge._label))};vc.prototype.add=function(t,n,r){var i=new wu(t,n,r),a=this._nodeMap.get(i);return a!==null?a:(this._nodeMap.put(i,i),i)};vc.prototype.isIntersection=function(t){for(var n=this.iterator();n.hasNext();){var r=n.next();if(r.coord.equals(t))return!0}return!1};vc.prototype.interfaces_=function(){return[]};vc.prototype.getClass=function(){return vc};var hd=function(){};hd.prototype.getChainStartIndices=function(t){var n=this,r=0,i=new jt;i.add(new mu(r));do{var a=n.findChainEnd(t,r);i.add(new mu(a)),r=a}while(r<t.length-1);var l=hd.toIntArray(i);return l};hd.prototype.findChainEnd=function(t,n){for(var r=si.quadrant(t[n],t[n+1]),i=n+1;i<t.length;){var a=si.quadrant(t[i-1],t[i]);if(a!==r)break;i++}return i-1};hd.prototype.interfaces_=function(){return[]};hd.prototype.getClass=function(){return hd};hd.toIntArray=function(t){for(var n=new Array(t.size()).fill(null),r=0;r<n.length;r++)n[r]=t.get(r).intValue();return n};var oh=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new _n,this.env2=new _n;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var n=new hd;this.startIndex=n.getChainStartIndices(this.pts)};oh.prototype.getCoordinates=function(){return this.pts};oh.prototype.getMaxX=function(t){var n=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return n>r?n:r};oh.prototype.getMinX=function(t){var n=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return n<r?n:r};oh.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var t=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],n,n.startIndex[r],n.startIndex[r+1],i)}else if(arguments.length===6){var a=arguments[0],l=arguments[1],o=arguments[2],f=arguments[3],p=arguments[4],y=arguments[5],x=this.pts[a],w=this.pts[l],S=o.pts[f],L=o.pts[p];if(l-a===1&&p-f===1)return y.addIntersections(this.e,a,o.e,f),null;if(this.env1.init(x,w),this.env2.init(S,L),!this.env1.intersects(this.env2))return null;var D=Math.trunc((a+l)/2),B=Math.trunc((f+p)/2);a<D&&(f<B&&this.computeIntersectsForChain(a,D,o,f,B,y),B<p&&this.computeIntersectsForChain(a,D,o,B,p,y)),D<l&&(f<B&&this.computeIntersectsForChain(D,l,o,f,B,y),B<p&&this.computeIntersectsForChain(D,l,o,B,p,y))}};oh.prototype.getStartIndexes=function(){return this.startIndex};oh.prototype.computeIntersects=function(t,n){for(var r=this,i=0;i<this.startIndex.length-1;i++)for(var a=0;a<t.startIndex.length-1;a++)r.computeIntersectsForChain(i,t,a,n)};oh.prototype.interfaces_=function(){return[]};oh.prototype.getClass=function(){return oh};var aa=function e(){var t=this;this._depth=Array(2).fill().map(function(){return Array(3)});for(var n=0;n<2;n++)for(var r=0;r<3;r++)t._depth[n][r]=e.NULL_VALUE},Y4={NULL_VALUE:{configurable:!0}};aa.prototype.getDepth=function(t,n){return this._depth[t][n]};aa.prototype.setDepth=function(t,n,r){this._depth[t][n]=r};aa.prototype.isNull=function(){var t=this;if(arguments.length===0){for(var n=0;n<2;n++)for(var r=0;r<3;r++)if(t._depth[n][r]!==aa.NULL_VALUE)return!1;return!0}else if(arguments.length===1){var i=arguments[0];return this._depth[i][1]===aa.NULL_VALUE}else if(arguments.length===2){var a=arguments[0],l=arguments[1];return this._depth[a][l]===aa.NULL_VALUE}};aa.prototype.normalize=function(){for(var t=this,n=0;n<2;n++)if(!t.isNull(n)){var r=t._depth[n][1];t._depth[n][2]<r&&(r=t._depth[n][2]),r<0&&(r=0);for(var i=1;i<3;i++){var a=0;t._depth[n][i]>r&&(a=1),t._depth[n][i]=a}}};aa.prototype.getDelta=function(t){return this._depth[t][Ft.RIGHT]-this._depth[t][Ft.LEFT]};aa.prototype.getLocation=function(t,n){return this._depth[t][n]<=0?tt.EXTERIOR:tt.INTERIOR};aa.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]};aa.prototype.add=function(){var t=this;if(arguments.length===1)for(var n=arguments[0],r=0;r<2;r++)for(var i=1;i<3;i++){var a=n.getLocation(r,i);(a===tt.EXTERIOR||a===tt.INTERIOR)&&(t.isNull(r,i)?t._depth[r][i]=aa.depthAtLocation(a):t._depth[r][i]+=aa.depthAtLocation(a))}else if(arguments.length===3){var l=arguments[0],o=arguments[1],f=arguments[2];f===tt.INTERIOR&&this._depth[l][o]++}};aa.prototype.interfaces_=function(){return[]};aa.prototype.getClass=function(){return aa};aa.depthAtLocation=function(t){return t===tt.EXTERIOR?0:t===tt.INTERIOR?1:aa.NULL_VALUE};Y4.NULL_VALUE.get=function(){return-1};Object.defineProperties(aa,Y4);var Vb=function(e){function t(){if(e.call(this),this.pts=null,this._env=null,this.eiList=new vc(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new aa,this._depthDelta=0,arguments.length===1){var n=arguments[0];t.call(this,n,null)}else if(arguments.length===2){var r=arguments[0],i=arguments[1];this.pts=r,this._label=i}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getDepth=function(){return this._depth},t.prototype.getCollapsedEdge=function(){var r=new Array(2).fill(null);r[0]=this.pts[0],r[1]=this.pts[1];var i=new t(r,ri.toLineLabel(this._label));return i},t.prototype.isIsolated=function(){return this._isIsolated},t.prototype.getCoordinates=function(){return this.pts},t.prototype.setIsolated=function(r){this._isIsolated=r},t.prototype.setName=function(r){this._name=r},t.prototype.equals=function(r){var i=this;if(!(r instanceof t))return!1;var a=r;if(this.pts.length!==a.pts.length)return!1;for(var l=!0,o=!0,f=this.pts.length,p=0;p<this.pts.length;p++)if(i.pts[p].equals2D(a.pts[p])||(l=!1),i.pts[p].equals2D(a.pts[--f])||(o=!1),!l&&!o)return!1;return!0},t.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var r=arguments[0];return this.pts[r]}},t.prototype.print=function(r){var i=this;r.print("edge "+this._name+": "),r.print("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&r.print(","),r.print(i.pts[a].x+" "+i.pts[a].y);r.print(")  "+this._label+" "+this._depthDelta)},t.prototype.computeIM=function(r){t.updateIM(this._label,r)},t.prototype.isCollapsed=function(){return!this._label.isArea()||this.pts.length!==3?!1:!!this.pts[0].equals(this.pts[2])},t.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},t.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},t.prototype.getDepthDelta=function(){return this._depthDelta},t.prototype.getNumPoints=function(){return this.pts.length},t.prototype.printReverse=function(r){var i=this;r.print("edge "+this._name+": ");for(var a=this.pts.length-1;a>=0;a--)r.print(i.pts[a]+" ");r.println("")},t.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new oh(this)),this._mce},t.prototype.getEnvelope=function(){var r=this;if(this._env===null){this._env=new _n;for(var i=0;i<this.pts.length;i++)r._env.expandToInclude(r.pts[i])}return this._env},t.prototype.addIntersection=function(r,i,a,l){var o=new $e(r.getIntersection(l)),f=i,p=r.getEdgeDistance(a,l),y=f+1;if(y<this.pts.length){var x=this.pts[y];o.equals2D(x)&&(f=y,p=0)}this.eiList.add(o,f,p)},t.prototype.toString=function(){var r=this,i=new Pu;i.append("edge "+this._name+": "),i.append("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&i.append(","),i.append(r.pts[a].x+" "+r.pts[a].y);return i.append(")  "+this._label+" "+this._depthDelta),i.toString()},t.prototype.isPointwiseEqual=function(r){var i=this;if(this.pts.length!==r.pts.length)return!1;for(var a=0;a<this.pts.length;a++)if(!i.pts[a].equals2D(r.pts[a]))return!1;return!0},t.prototype.setDepthDelta=function(r){this._depthDelta=r},t.prototype.getEdgeIntersectionList=function(){return this.eiList},t.prototype.addIntersections=function(r,i,a){for(var l=this,o=0;o<r.getIntersectionNum();o++)l.addIntersection(r,i,a,o)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.updateIM=function(){if(arguments.length===2){var r=arguments[0],i=arguments[1];i.setAtLeastIfValid(r.getLocation(0,Ft.ON),r.getLocation(1,Ft.ON),1),r.isArea()&&(i.setAtLeastIfValid(r.getLocation(0,Ft.LEFT),r.getLocation(1,Ft.LEFT),2),i.setAtLeastIfValid(r.getLocation(0,Ft.RIGHT),r.getLocation(1,Ft.RIGHT),2))}else return e.prototype.updateIM.apply(this,arguments)},t}(Ns),za=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Dl,this._bufParams=t||null};za.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t};za.prototype.insertUniqueEdge=function(t){var n=this._edgeList.findEqualEdge(t);if(n!==null){var r=n.getLabel(),i=t.getLabel();n.isPointwiseEqual(t)||(i=new ri(t.getLabel()),i.flip()),r.merge(i);var a=za.depthDelta(i),l=n.getDepthDelta(),o=l+a;n.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(za.depthDelta(t.getLabel()))};za.prototype.buildSubgraphs=function(t,n){for(var r=new jt,i=t.iterator();i.hasNext();){var a=i.next(),l=a.getRightmostCoordinate(),o=new Zp(r),f=o.getDepth(l);a.computeDepth(f),a.findResultEdges(),r.add(a),n.add(a.getDirectedEdges(),a.getNodes())}};za.prototype.createSubgraphs=function(t){for(var n=new jt,r=t.getNodes().iterator();r.hasNext();){var i=r.next();if(!i.isVisited()){var a=new Ga;a.create(i),n.add(a)}}return Ol.sort(n,Ol.reverseOrder()),n};za.prototype.createEmptyResultGeometry=function(){var t=this._geomFact.createPolygon();return t};za.prototype.getNoder=function(t){if(this._workingNoder!==null)return this._workingNoder;var n=new F2,r=new xd;return r.setPrecisionModel(t),n.setSegmentIntersector(new Bs(r)),n};za.prototype.buffer=function(t,n){var r=this._workingPrecisionModel;r===null&&(r=t.getPrecisionModel()),this._geomFact=t.getFactory();var i=new Qa(r,this._bufParams),a=new cl(t,n,i),l=a.getCurves();if(l.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(l,r),this._graph=new Xi(new H4),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),f=new ys(this._geomFact);this.buildSubgraphs(o,f);var p=f.getPolygons();if(p.size()<=0)return this.createEmptyResultGeometry();var y=this._geomFact.buildGeometry(p);return y};za.prototype.computeNodedEdges=function(t,n){var r=this,i=this.getNoder(n);i.computeNodes(t);for(var a=i.getNodedSubstrings(),l=a.iterator();l.hasNext();){var o=l.next(),f=o.getCoordinates();if(!(f.length===2&&f[0].equals2D(f[1]))){var p=o.getData(),y=new Vb(o.getCoordinates(),new ri(p));r.insertUniqueEdge(y)}}};za.prototype.setNoder=function(t){this._workingNoder=t};za.prototype.interfaces_=function(){return[]};za.prototype.getClass=function(){return za};za.depthDelta=function(t){var n=t.getLocation(0,Ft.LEFT),r=t.getLocation(0,Ft.RIGHT);return n===tt.INTERIOR&&r===tt.EXTERIOR?1:n===tt.EXTERIOR&&r===tt.INTERIOR?-1:0};za.convertSegStrings=function(t){for(var n=new rr,r=new jt;t.hasNext();){var i=t.next(),a=n.createLineString(i.getCoordinates());r.add(a)}return n.buildGeometry(r)};var Hh=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var t=arguments[0],n=arguments[1];this._noder=t,this._scaleFactor=n,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var r=arguments[0],i=arguments[1],a=arguments[2],l=arguments[3];this._noder=r,this._scaleFactor=i,this._offsetX=a,this._offsetY=l,this._isScaled=!this.isIntegerPrecision()}};Hh.prototype.rescale=function(){var t=this;if(Pn(arguments[0],Po))for(var n=arguments[0],r=n.iterator();r.hasNext();){var i=r.next();t.rescale(i.getCoordinates())}else if(arguments[0]instanceof Array){for(var a=arguments[0],l=0;l<a.length;l++)a[l].x=a[l].x/t._scaleFactor+t._offsetX,a[l].y=a[l].y/t._scaleFactor+t._offsetY;a.length===2&&a[0].equals2D(a[1])&&la.out.println(a)}};Hh.prototype.scale=function(){var t=this;if(Pn(arguments[0],Po)){for(var n=arguments[0],r=new jt,i=n.iterator();i.hasNext();){var a=i.next();r.add(new so(t.scale(a.getCoordinates()),a.getData()))}return r}else if(arguments[0]instanceof Array){for(var l=arguments[0],o=new Array(l.length).fill(null),f=0;f<l.length;f++)o[f]=new $e(Math.round((l[f].x-t._offsetX)*t._scaleFactor),Math.round((l[f].y-t._offsetY)*t._scaleFactor),l[f].z);var p=ir.removeRepeatedPoints(o);return p}};Hh.prototype.isIntegerPrecision=function(){return this._scaleFactor===1};Hh.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t};Hh.prototype.computeNodes=function(t){var n=t;this._isScaled&&(n=this.scale(t)),this._noder.computeNodes(n)};Hh.prototype.interfaces_=function(){return[ld]};Hh.prototype.getClass=function(){return Hh};var Eu=function(){this._li=new xd,this._segStrings=null;var t=arguments[0];this._segStrings=t},K4={fact:{configurable:!0}};Eu.prototype.checkEndPtVertexIntersections=function(){var t=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();){var r=n.next(),i=r.getCoordinates();t.checkEndPtVertexIntersections(i[0],t._segStrings),t.checkEndPtVertexIntersections(i[i.length-1],t._segStrings)}else if(arguments.length===2){for(var a=arguments[0],l=arguments[1],o=l.iterator();o.hasNext();)for(var f=o.next(),p=f.getCoordinates(),y=1;y<p.length-1;y++)if(p[y].equals(a))throw new th("found endpt/interior pt intersection at index "+y+" :pt "+a)}};Eu.prototype.checkInteriorIntersections=function(){var t=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();)for(var r=n.next(),i=this._segStrings.iterator();i.hasNext();){var a=i.next();t.checkInteriorIntersections(r,a)}else if(arguments.length===2)for(var l=arguments[0],o=arguments[1],f=l.getCoordinates(),p=o.getCoordinates(),y=0;y<f.length-1;y++)for(var x=0;x<p.length-1;x++)t.checkInteriorIntersections(l,y,o,x);else if(arguments.length===4){var w=arguments[0],S=arguments[1],L=arguments[2],D=arguments[3];if(w===L&&S===D)return null;var B=w.getCoordinates()[S],z=w.getCoordinates()[S+1],M=L.getCoordinates()[D],k=L.getCoordinates()[D+1];if(this._li.computeIntersection(B,z,M,k),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,B,z)||this.hasInteriorIntersection(this._li,M,k)))throw new th("found non-noded intersection at "+B+"-"+z+" and "+M+"-"+k)}};Eu.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()};Eu.prototype.checkCollapses=function(){var t=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();){var r=n.next();t.checkCollapses(r)}else if(arguments.length===1)for(var i=arguments[0],a=i.getCoordinates(),l=0;l<a.length-2;l++)t.checkCollapse(a[l],a[l+1],a[l+2])};Eu.prototype.hasInteriorIntersection=function(t,n,r){for(var i=0;i<t.getIntersectionNum();i++){var a=t.getIntersection(i);if(!(a.equals(n)||a.equals(r)))return!0}return!1};Eu.prototype.checkCollapse=function(t,n,r){if(t.equals(r))throw new th("found non-noded collapse at "+Eu.fact.createLineString([t,n,r]))};Eu.prototype.interfaces_=function(){return[]};Eu.prototype.getClass=function(){return Eu};K4.fact.get=function(){return new rr};Object.defineProperties(Eu,K4);var es=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],n=arguments[1],r=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=n,this._li=r,n<=0)throw new Ui("Scale factor must be non-zero");n!==1&&(this._pt=new $e(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new $e,this._p1Scaled=new $e),this.initCorners(this._pt)},J4={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};es.prototype.intersectsScaled=function(t,n){var r=Math.min(t.x,n.x),i=Math.max(t.x,n.x),a=Math.min(t.y,n.y),l=Math.max(t.y,n.y),o=this._maxx<r||this._minx>i||this._maxy<a||this._miny>l;if(o)return!1;var f=this.intersectsToleranceSquare(t,n);return Xn.isTrue(!(o&&f),"Found bad envelope test"),f};es.prototype.initCorners=function(t){var n=.5;this._minx=t.x-n,this._maxx=t.x+n,this._miny=t.y-n,this._maxy=t.y+n,this._corner[0]=new $e(this._maxx,this._maxy),this._corner[1]=new $e(this._minx,this._maxy),this._corner[2]=new $e(this._minx,this._miny),this._corner[3]=new $e(this._maxx,this._miny)};es.prototype.intersects=function(t,n){return this._scaleFactor===1?this.intersectsScaled(t,n):(this.copyScaled(t,this._p0Scaled),this.copyScaled(n,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))};es.prototype.scale=function(t){return Math.round(t*this._scaleFactor)};es.prototype.getCoordinate=function(){return this._originalPt};es.prototype.copyScaled=function(t,n){n.x=this.scale(t.x),n.y=this.scale(t.y)};es.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var t=es.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new _n(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv};es.prototype.intersectsPixelClosure=function(t,n){return this._li.computeIntersection(t,n,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,n,this._corner[1],this._corner[2]),this._li.hasIntersection())||(this._li.computeIntersection(t,n,this._corner[2],this._corner[3]),this._li.hasIntersection())||(this._li.computeIntersection(t,n,this._corner[3],this._corner[0]),this._li.hasIntersection()))};es.prototype.intersectsToleranceSquare=function(t,n){var r=!1,i=!1;return this._li.computeIntersection(t,n,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,n,this._corner[1],this._corner[2]),this._li.isProper())||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,n,this._corner[2],this._corner[3]),this._li.isProper())||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,n,this._corner[3],this._corner[0]),this._li.isProper())||r&&i||t.equals(this._pt)||n.equals(this._pt))};es.prototype.addSnappedNode=function(t,n){var r=t.getCoordinate(n),i=t.getCoordinate(n+1);return this.intersects(r,i)?(t.addIntersection(this.getCoordinate(),n),!0):!1};es.prototype.interfaces_=function(){return[]};es.prototype.getClass=function(){return es};J4.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75};Object.defineProperties(es,J4);var C0=function(){this.tempEnv1=new _n,this.selectedSegment=new wn};C0.prototype.select=function(){if(arguments.length!==1){if(arguments.length===2){var t=arguments[0],n=arguments[1];t.getLineSegment(n,this.selectedSegment),this.select(this.selectedSegment)}}};C0.prototype.interfaces_=function(){return[]};C0.prototype.getClass=function(){return C0};var uy=function(){this._index=null;var t=arguments[0];this._index=t},Q4={HotPixelSnapAction:{configurable:!0}};uy.prototype.snap=function(){if(arguments.length===1){var t=arguments[0];return this.snap(t,null,-1)}else if(arguments.length===3){var n=arguments[0],r=arguments[1],i=arguments[2],a=n.getSafeEnvelope(),l=new e5(n,r,i);return this._index.query(a,{interfaces_:function(){return[Zh]},visitItem:function(o){var f=o;f.select(a,l)}}),l.isNodeAdded()}};uy.prototype.interfaces_=function(){return[]};uy.prototype.getClass=function(){return uy};Q4.HotPixelSnapAction.get=function(){return e5};Object.defineProperties(uy,Q4);var e5=function(e){function t(){e.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var n=arguments[0],r=arguments[1],i=arguments[2];this._hotPixel=n,this._parentEdge=r,this._hotPixelVertexIndex=i}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.isNodeAdded=function(){return this._isNodeAdded},t.prototype.select=function(){if(arguments.length===2){var r=arguments[0],i=arguments[1],a=r.getContext();if(this._parentEdge!==null&&a===this._parentEdge&&i===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(a,i)}else return e.prototype.select.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(C0),Xp=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new jt};Xp.prototype.processIntersections=function(t,n,r,i){var a=this;if(t===r&&n===i)return null;var l=t.getCoordinates()[n],o=t.getCoordinates()[n+1],f=r.getCoordinates()[i],p=r.getCoordinates()[i+1];if(this._li.computeIntersection(l,o,f,p),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var y=0;y<this._li.getIntersectionNum();y++)a._interiorIntersections.add(a._li.getIntersection(y));t.addIntersections(this._li,n,0),r.addIntersections(this._li,i,1)}};Xp.prototype.isDone=function(){return!1};Xp.prototype.getInteriorIntersections=function(){return this._interiorIntersections};Xp.prototype.interfaces_=function(){return[cd]};Xp.prototype.getClass=function(){return Xp};var _c=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new xd,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};_c.prototype.checkCorrectness=function(t){var n=so.getNodedSubstrings(t),r=new Eu(n);try{r.checkValid()}catch(i){if(i instanceof F4)i.printStackTrace();else throw i}finally{}};_c.prototype.getNodedSubstrings=function(){return so.getNodedSubstrings(this._nodedSegStrings)};_c.prototype.snapRound=function(t,n){var r=this.findInteriorIntersections(t,n);this.computeIntersectionSnaps(r),this.computeVertexSnaps(t)};_c.prototype.findInteriorIntersections=function(t,n){var r=new Xp(n);return this._noder.setSegmentIntersector(r),this._noder.computeNodes(t),r.getInteriorIntersections()};_c.prototype.computeVertexSnaps=function(){var t=this;if(Pn(arguments[0],Po))for(var n=arguments[0],r=n.iterator();r.hasNext();){var i=r.next();t.computeVertexSnaps(i)}else if(arguments[0]instanceof so)for(var a=arguments[0],l=a.getCoordinates(),o=0;o<l.length;o++){var f=new es(l[o],t._scaleFactor,t._li),p=t._pointSnapper.snap(f,a,o);p&&a.addIntersection(l[o],o)}};_c.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new F2,this._pointSnapper=new uy(this._noder.getIndex()),this.snapRound(t,this._li)};_c.prototype.computeIntersectionSnaps=function(t){for(var n=this,r=t.iterator();r.hasNext();){var i=r.next(),a=new es(i,n._scaleFactor,n._li);n._pointSnapper.snap(a)}};_c.prototype.interfaces_=function(){return[ld]};_c.prototype.getClass=function(){return _c};var ia=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Wr,this._resultGeometry=null,this._saveException=null,arguments.length===1){var t=arguments[0];this._argGeom=t}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._argGeom=n,this._bufParams=r}},Ay={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};ia.prototype.bufferFixedPrecision=function(t){var n=new Hh(new _c(new Hr(1)),t.getScale()),r=new za(this._bufParams);r.setWorkingPrecisionModel(t),r.setNoder(n),this._resultGeometry=r.buffer(this._argGeom,this._distance)};ia.prototype.bufferReducedPrecision=function(){var t=this;if(arguments.length===0){for(var n=ia.MAX_PRECISION_DIGITS;n>=0;n--){try{t.bufferReducedPrecision(n)}catch(l){if(l instanceof rh)t._saveException=l;else throw l}finally{}if(t._resultGeometry!==null)return null}throw this._saveException}else if(arguments.length===1){var r=arguments[0],i=ia.precisionScaleFactor(this._argGeom,this._distance,r),a=new Hr(i);this.bufferFixedPrecision(a)}};ia.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===Hr.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()};ia.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)};ia.prototype.bufferOriginalPrecision=function(){try{var t=new za(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(n){if(n instanceof th)this._saveException=n;else throw n}finally{}};ia.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry};ia.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)};ia.prototype.interfaces_=function(){return[]};ia.prototype.getClass=function(){return ia};ia.bufferOp=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new ia(t),i=r.getResultGeometry(n);return i}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Cn&&typeof arguments[1]=="number"){var a=arguments[0],l=arguments[1],o=arguments[2],f=new ia(a);f.setQuadrantSegments(o);var p=f.getResultGeometry(l);return p}else if(arguments[2]instanceof Wr&&arguments[0]instanceof Cn&&typeof arguments[1]=="number"){var y=arguments[0],x=arguments[1],w=arguments[2],S=new ia(y,w),L=S.getResultGeometry(x);return L}}else if(arguments.length===4){var D=arguments[0],B=arguments[1],z=arguments[2],M=arguments[3],k=new ia(D);k.setQuadrantSegments(z),k.setEndCapStyle(M);var V=k.getResultGeometry(B);return V}};ia.precisionScaleFactor=function(t,n,r){var i=t.getEnvelopeInternal(),a=ks.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY())),l=n>0?n:0,o=a+2*l,f=Math.trunc(Math.log(o)/Math.log(10)+1),p=r-f,y=Math.pow(10,p);return y};Ay.CAP_ROUND.get=function(){return Wr.CAP_ROUND};Ay.CAP_BUTT.get=function(){return Wr.CAP_FLAT};Ay.CAP_FLAT.get=function(){return Wr.CAP_FLAT};Ay.CAP_SQUARE.get=function(){return Wr.CAP_SQUARE};Ay.MAX_PRECISION_DIGITS.get=function(){return 12};Object.defineProperties(ia,Ay);var Na=function(){this._pt=[new $e,new $e],this._distance=Nn.NaN,this._isNull=!0};Na.prototype.getCoordinates=function(){return this._pt};Na.prototype.getCoordinate=function(t){return this._pt[t]};Na.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var i=n.distance(r);i<this._distance&&this.initialize(n,r,i)}};Na.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],n=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(n),this._distance=t.distance(n),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],i=arguments[1],a=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(i),this._distance=a,this._isNull=!1}};Na.prototype.getDistance=function(){return this._distance};Na.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var i=n.distance(r);i>this._distance&&this.initialize(n,r,i)}};Na.prototype.interfaces_=function(){return[]};Na.prototype.getClass=function(){return Na};var oc=function(){};oc.prototype.interfaces_=function(){return[]};oc.prototype.getClass=function(){return oc};oc.computeDistance=function(){if(arguments[2]instanceof Na&&arguments[0]instanceof Ki&&arguments[1]instanceof $e)for(var t=arguments[0],n=arguments[1],r=arguments[2],i=t.getCoordinates(),a=new wn,l=0;l<i.length-1;l++){a.setCoordinates(i[l],i[l+1]);var o=a.closestPoint(n);r.setMinimum(o,n)}else if(arguments[2]instanceof Na&&arguments[0]instanceof Ro&&arguments[1]instanceof $e){var f=arguments[0],p=arguments[1],y=arguments[2];oc.computeDistance(f.getExteriorRing(),p,y);for(var x=0;x<f.getNumInteriorRing();x++)oc.computeDistance(f.getInteriorRingN(x),p,y)}else if(arguments[2]instanceof Na&&arguments[0]instanceof Cn&&arguments[1]instanceof $e){var w=arguments[0],S=arguments[1],L=arguments[2];if(w instanceof Ki)oc.computeDistance(w,S,L);else if(w instanceof Ro)oc.computeDistance(w,S,L);else if(w instanceof Va)for(var D=w,B=0;B<D.getNumGeometries();B++){var z=D.getGeometryN(B);oc.computeDistance(z,S,L)}else L.setMinimum(w.getCoordinate(),S)}else if(arguments[2]instanceof Na&&arguments[0]instanceof wn&&arguments[1]instanceof $e){var M=arguments[0],k=arguments[1],V=arguments[2],q=M.closestPoint(k);V.setMinimum(q,k)}};var fd=function(t){this._maxPtDist=new Na,this._inputGeom=t||null},B2={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};fd.prototype.computeMaxMidpointDistance=function(t){var n=new Yh(this._inputGeom);t.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())};fd.prototype.computeMaxVertexDistance=function(t){var n=new Wp(this._inputGeom);t.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())};fd.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()};fd.prototype.getDistancePoints=function(){return this._maxPtDist};fd.prototype.interfaces_=function(){return[]};fd.prototype.getClass=function(){return fd};B2.MaxPointDistanceFilter.get=function(){return Wp};B2.MaxMidpointDistanceFilter.get=function(){return Yh};Object.defineProperties(fd,B2);var Wp=function(t){this._maxPtDist=new Na,this._minPtDist=new Na,this._geom=t||null};Wp.prototype.filter=function(t){this._minPtDist.initialize(),oc.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Wp.prototype.getMaxPointDistance=function(){return this._maxPtDist};Wp.prototype.interfaces_=function(){return[pc]};Wp.prototype.getClass=function(){return Wp};var Yh=function(t){this._maxPtDist=new Na,this._minPtDist=new Na,this._geom=t||null};Yh.prototype.filter=function(t,n){if(n===0)return null;var r=t.getCoordinate(n-1),i=t.getCoordinate(n),a=new $e((r.x+i.x)/2,(r.y+i.y)/2);this._minPtDist.initialize(),oc.computeDistance(this._geom,a,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Yh.prototype.isDone=function(){return!1};Yh.prototype.isGeometryChanged=function(){return!1};Yh.prototype.getMaxPointDistance=function(){return this._maxPtDist};Yh.prototype.interfaces_=function(){return[Ml]};Yh.prototype.getClass=function(){return Yh};var Yc=function(t){this._comps=t||null};Yc.prototype.filter=function(t){t instanceof Ro&&this._comps.add(t)};Yc.prototype.interfaces_=function(){return[vu]};Yc.prototype.getClass=function(){return Yc};Yc.getPolygons=function(){if(arguments.length===1){var t=arguments[0];return Yc.getPolygons(t,new jt)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n instanceof Ro?r.add(n):n instanceof Va&&n.apply(new Yc(r)),r}};var ra=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var t=arguments[0];this._lines=t}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._lines=n,this._isForcedToLineString=r}};ra.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof gc){var n=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(n),null}t instanceof Ki&&this._lines.add(t)};ra.prototype.setForceToLineString=function(t){this._isForcedToLineString=t};ra.prototype.interfaces_=function(){return[nh]};ra.prototype.getClass=function(){return ra};ra.getGeometry=function(){if(arguments.length===1){var t=arguments[0];return t.getFactory().buildGeometry(ra.getLines(t))}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n.getFactory().buildGeometry(ra.getLines(n,r))}};ra.getLines=function(){if(arguments.length===1){var t=arguments[0];return ra.getLines(t,!1)}else if(arguments.length===2){if(Pn(arguments[0],Po)&&Pn(arguments[1],Po)){for(var n=arguments[0],r=arguments[1],i=n.iterator();i.hasNext();){var a=i.next();ra.getLines(a,r)}return r}else if(arguments[0]instanceof Cn&&typeof arguments[1]=="boolean"){var l=arguments[0],o=arguments[1],f=new jt;return l.apply(new ra(f,o)),f}else if(arguments[0]instanceof Cn&&Pn(arguments[1],Po)){var p=arguments[0],y=arguments[1];return p instanceof Ki?y.add(p):p.apply(new ra(y)),y}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&Pn(arguments[0],Po)&&Pn(arguments[1],Po)){for(var x=arguments[0],w=arguments[1],S=arguments[2],L=x.iterator();L.hasNext();){var D=L.next();ra.getLines(D,w,S)}return w}else if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Cn&&Pn(arguments[1],Po)){var B=arguments[0],z=arguments[1],M=arguments[2];return B.apply(new ra(z,M)),z}}};var Rl=function(){if(this._boundaryRule=ll.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){var t=arguments[0];if(t===null)throw new Ui("Rule must be non-null");this._boundaryRule=t}}};Rl.prototype.locateInternal=function(){var t=this;if(arguments[0]instanceof $e&&arguments[1]instanceof Ro){var n=arguments[0],r=arguments[1];if(r.isEmpty())return tt.EXTERIOR;var i=r.getExteriorRing(),a=this.locateInPolygonRing(n,i);if(a===tt.EXTERIOR)return tt.EXTERIOR;if(a===tt.BOUNDARY)return tt.BOUNDARY;for(var l=0;l<r.getNumInteriorRing();l++){var o=r.getInteriorRingN(l),f=t.locateInPolygonRing(n,o);if(f===tt.INTERIOR)return tt.EXTERIOR;if(f===tt.BOUNDARY)return tt.BOUNDARY}return tt.INTERIOR}else if(arguments[0]instanceof $e&&arguments[1]instanceof Ki){var p=arguments[0],y=arguments[1];if(!y.getEnvelopeInternal().intersects(p))return tt.EXTERIOR;var x=y.getCoordinates();return!y.isClosed()&&(p.equals(x[0])||p.equals(x[x.length-1]))?tt.BOUNDARY:en.isOnLine(p,x)?tt.INTERIOR:tt.EXTERIOR}else if(arguments[0]instanceof $e&&arguments[1]instanceof ms){var w=arguments[0],S=arguments[1],L=S.getCoordinate();return L.equals2D(w)?tt.INTERIOR:tt.EXTERIOR}};Rl.prototype.locateInPolygonRing=function(t,n){return n.getEnvelopeInternal().intersects(t)?en.locatePointInRing(t,n.getCoordinates()):tt.EXTERIOR};Rl.prototype.intersects=function(t,n){return this.locate(t,n)!==tt.EXTERIOR};Rl.prototype.updateLocationInfo=function(t){t===tt.INTERIOR&&(this._isIn=!0),t===tt.BOUNDARY&&this._numBoundaries++};Rl.prototype.computeLocation=function(t,n){var r=this;if(n instanceof ms&&this.updateLocationInfo(this.locateInternal(t,n)),n instanceof Ki)this.updateLocationInfo(this.locateInternal(t,n));else if(n instanceof Ro)this.updateLocationInfo(this.locateInternal(t,n));else if(n instanceof sd)for(var i=n,a=0;a<i.getNumGeometries();a++){var l=i.getGeometryN(a);r.updateLocationInfo(r.locateInternal(t,l))}else if(n instanceof fc)for(var o=n,f=0;f<o.getNumGeometries();f++){var p=o.getGeometryN(f);r.updateLocationInfo(r.locateInternal(t,p))}else if(n instanceof Va)for(var y=new dc(n);y.hasNext();){var x=y.next();x!==n&&r.computeLocation(t,x)}};Rl.prototype.locate=function(t,n){return n.isEmpty()?tt.EXTERIOR:n instanceof Ki?this.locateInternal(t,n):n instanceof Ro?this.locateInternal(t,n):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,n),this._boundaryRule.isInBoundary(this._numBoundaries)?tt.BOUNDARY:this._numBoundaries>0||this._isIn?tt.INTERIOR:tt.EXTERIOR)};Rl.prototype.interfaces_=function(){return[]};Rl.prototype.getClass=function(){return Rl};var Fa=function e(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var t=arguments[0],n=arguments[1];e.call(this,t,e.INSIDE_AREA,n)}else if(arguments.length===3){var r=arguments[0],i=arguments[1],a=arguments[2];this._component=r,this._segIndex=i,this._pt=a}},t5={INSIDE_AREA:{configurable:!0}};Fa.prototype.isInsideArea=function(){return this._segIndex===Fa.INSIDE_AREA};Fa.prototype.getCoordinate=function(){return this._pt};Fa.prototype.getGeometryComponent=function(){return this._component};Fa.prototype.getSegmentIndex=function(){return this._segIndex};Fa.prototype.interfaces_=function(){return[]};Fa.prototype.getClass=function(){return Fa};t5.INSIDE_AREA.get=function(){return-1};Object.defineProperties(Fa,t5);var zh=function(t){this._pts=t||null};zh.prototype.filter=function(t){t instanceof ms&&this._pts.add(t)};zh.prototype.interfaces_=function(){return[vu]};zh.prototype.getClass=function(){return zh};zh.getPoints=function(){if(arguments.length===1){var t=arguments[0];return t instanceof ms?Ol.singletonList(t):zh.getPoints(t,new jt)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n instanceof ms?r.add(n):n instanceof Va&&n.apply(new zh(r)),r}};var Hp=function(){this._locations=null;var t=arguments[0];this._locations=t};Hp.prototype.filter=function(t){(t instanceof ms||t instanceof Ki||t instanceof Ro)&&this._locations.add(new Fa(t,0,t.getCoordinate()))};Hp.prototype.interfaces_=function(){return[vu]};Hp.prototype.getClass=function(){return Hp};Hp.getLocations=function(t){var n=new jt;return t.apply(new Hp(n)),n};var ua=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Rl,this._minDistanceLocation=null,this._minDistance=Nn.MAX_VALUE,arguments.length===2){var t=arguments[0],n=arguments[1];this._geom=[t,n],this._terminateDistance=0}else if(arguments.length===3){var r=arguments[0],i=arguments[1],a=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=r,this._geom[1]=i,this._terminateDistance=a}};ua.prototype.computeContainmentDistance=function(){var t=this;if(arguments.length===0){var n=new Array(2).fill(null);if(this.computeContainmentDistance(0,n),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,n)}else if(arguments.length===2){var r=arguments[0],i=arguments[1],a=1-r,l=Yc.getPolygons(this._geom[r]);if(l.size()>0){var o=Hp.getLocations(this._geom[a]);if(this.computeContainmentDistance(o,l,i),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[a]=i[0],this._minDistanceLocation[r]=i[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&Pn(arguments[0],Cl)&&Pn(arguments[1],Cl)){for(var f=arguments[0],p=arguments[1],y=arguments[2],x=0;x<f.size();x++)for(var w=f.get(x),S=0;S<p.size();S++)if(t.computeContainmentDistance(w,p.get(S),y),t._minDistance<=t._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Fa&&arguments[1]instanceof Ro){var L=arguments[0],D=arguments[1],B=arguments[2],z=L.getCoordinate();if(tt.EXTERIOR!==this._ptLocator.locate(z,D))return this._minDistance=0,B[0]=L,B[1]=new Fa(D,z),null}}};ua.prototype.computeMinDistanceLinesPoints=function(t,n,r){for(var i=this,a=0;a<t.size();a++)for(var l=t.get(a),o=0;o<n.size();o++){var f=n.get(o);if(i.computeMinDistance(l,f,r),i._minDistance<=i._terminateDistance)return null}};ua.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),n=ra.getLines(this._geom[0]),r=ra.getLines(this._geom[1]),i=zh.getPoints(this._geom[0]),a=zh.getPoints(this._geom[1]);if(this.computeMinDistanceLines(n,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,a,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance)||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(r,i,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance))return null;t[0]=null,t[1]=null,this.computeMinDistancePoints(i,a,t),this.updateMinDistance(t,!1)};ua.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation};ua.prototype.updateMinDistance=function(t,n){if(t[0]===null)return null;n?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])};ua.prototype.nearestPoints=function(){this.computeMinDistance();var t=[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()];return t};ua.prototype.computeMinDistance=function(){var t=this;if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof Ki&&arguments[1]instanceof ms){var n=arguments[0],r=arguments[1],i=arguments[2];if(n.getEnvelopeInternal().distance(r.getEnvelopeInternal())>this._minDistance)return null;for(var a=n.getCoordinates(),l=r.getCoordinate(),o=0;o<a.length-1;o++){var f=en.distancePointLine(l,a[o],a[o+1]);if(f<t._minDistance){t._minDistance=f;var p=new wn(a[o],a[o+1]),y=p.closestPoint(l);i[0]=new Fa(n,o,y),i[1]=new Fa(r,0,l)}if(t._minDistance<=t._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Ki&&arguments[1]instanceof Ki){var x=arguments[0],w=arguments[1],S=arguments[2];if(x.getEnvelopeInternal().distance(w.getEnvelopeInternal())>this._minDistance)return null;for(var L=x.getCoordinates(),D=w.getCoordinates(),B=0;B<L.length-1;B++)for(var z=0;z<D.length-1;z++){var M=en.distanceLineLine(L[B],L[B+1],D[z],D[z+1]);if(M<t._minDistance){t._minDistance=M;var k=new wn(L[B],L[B+1]),V=new wn(D[z],D[z+1]),q=k.closestPoints(V);S[0]=new Fa(x,B,q[0]),S[1]=new Fa(w,z,q[1])}if(t._minDistance<=t._terminateDistance)return null}}}};ua.prototype.computeMinDistancePoints=function(t,n,r){for(var i=this,a=0;a<t.size();a++)for(var l=t.get(a),o=0;o<n.size();o++){var f=n.get(o),p=l.getCoordinate().distance(f.getCoordinate());if(p<i._minDistance&&(i._minDistance=p,r[0]=new Fa(l,0,l.getCoordinate()),r[1]=new Fa(f,0,f.getCoordinate())),i._minDistance<=i._terminateDistance)return null}};ua.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new Ui("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)};ua.prototype.computeMinDistanceLines=function(t,n,r){for(var i=this,a=0;a<t.size();a++)for(var l=t.get(a),o=0;o<n.size();o++){var f=n.get(o);if(i.computeMinDistance(l,f,r),i._minDistance<=i._terminateDistance)return null}};ua.prototype.interfaces_=function(){return[]};ua.prototype.getClass=function(){return ua};ua.distance=function(t,n){var r=new ua(t,n);return r.distance()};ua.isWithinDistance=function(t,n,r){var i=new ua(t,n,r);return i.distance()<=r};ua.nearestPoints=function(t,n){var r=new ua(t,n);return r.nearestPoints()};var _a=function(){this._pt=[new $e,new $e],this._distance=Nn.NaN,this._isNull=!0};_a.prototype.getCoordinates=function(){return this._pt};_a.prototype.getCoordinate=function(t){return this._pt[t]};_a.prototype.setMinimum=function(){if(arguments.length===1){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var i=n.distance(r);i<this._distance&&this.initialize(n,r,i)}};_a.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var t=arguments[0],n=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(n),this._distance=t.distance(n),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],i=arguments[1],a=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(i),this._distance=a,this._isNull=!1}};_a.prototype.toString=function(){return Al.toLineString(this._pt[0],this._pt[1])};_a.prototype.getDistance=function(){return this._distance};_a.prototype.setMaximum=function(){if(arguments.length===1){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var i=n.distance(r);i>this._distance&&this.initialize(n,r,i)}};_a.prototype.interfaces_=function(){return[]};_a.prototype.getClass=function(){return _a};var su=function(){};su.prototype.interfaces_=function(){return[]};su.prototype.getClass=function(){return su};su.computeDistance=function(){if(arguments[2]instanceof _a&&arguments[0]instanceof Ki&&arguments[1]instanceof $e)for(var t=arguments[0],n=arguments[1],r=arguments[2],i=new wn,a=t.getCoordinates(),l=0;l<a.length-1;l++){i.setCoordinates(a[l],a[l+1]);var o=i.closestPoint(n);r.setMinimum(o,n)}else if(arguments[2]instanceof _a&&arguments[0]instanceof Ro&&arguments[1]instanceof $e){var f=arguments[0],p=arguments[1],y=arguments[2];su.computeDistance(f.getExteriorRing(),p,y);for(var x=0;x<f.getNumInteriorRing();x++)su.computeDistance(f.getInteriorRingN(x),p,y)}else if(arguments[2]instanceof _a&&arguments[0]instanceof Cn&&arguments[1]instanceof $e){var w=arguments[0],S=arguments[1],L=arguments[2];if(w instanceof Ki)su.computeDistance(w,S,L);else if(w instanceof Ro)su.computeDistance(w,S,L);else if(w instanceof Va)for(var D=w,B=0;B<D.getNumGeometries();B++){var z=D.getGeometryN(B);su.computeDistance(z,S,L)}else L.setMinimum(w.getCoordinate(),S)}else if(arguments[2]instanceof _a&&arguments[0]instanceof wn&&arguments[1]instanceof $e){var M=arguments[0],k=arguments[1],V=arguments[2],q=M.closestPoint(k);V.setMinimum(q,k)}};var rl=function(){this._g0=null,this._g1=null,this._ptDist=new _a,this._densifyFrac=0;var t=arguments[0],n=arguments[1];this._g0=t,this._g1=n},z2={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};rl.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()};rl.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new Ui("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t};rl.prototype.compute=function(t,n){this.computeOrientedDistance(t,n,this._ptDist),this.computeOrientedDistance(n,t,this._ptDist)};rl.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()};rl.prototype.computeOrientedDistance=function(t,n,r){var i=new Yp(n);if(t.apply(i),r.setMaximum(i.getMaxPointDistance()),this._densifyFrac>0){var a=new Kh(n,this._densifyFrac);t.apply(a),r.setMaximum(a.getMaxPointDistance())}};rl.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()};rl.prototype.interfaces_=function(){return[]};rl.prototype.getClass=function(){return rl};rl.distance=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new rl(t,n);return r.distance()}else if(arguments.length===3){var i=arguments[0],a=arguments[1],l=arguments[2],o=new rl(i,a);return o.setDensifyFraction(l),o.distance()}};z2.MaxPointDistanceFilter.get=function(){return Yp};z2.MaxDensifiedByFractionDistanceFilter.get=function(){return Kh};Object.defineProperties(rl,z2);var Yp=function(){this._maxPtDist=new _a,this._minPtDist=new _a,this._euclideanDist=new su,this._geom=null;var t=arguments[0];this._geom=t};Yp.prototype.filter=function(t){this._minPtDist.initialize(),su.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Yp.prototype.getMaxPointDistance=function(){return this._maxPtDist};Yp.prototype.interfaces_=function(){return[pc]};Yp.prototype.getClass=function(){return Yp};var Kh=function(){this._maxPtDist=new _a,this._minPtDist=new _a,this._geom=null,this._numSubSegs=0;var t=arguments[0],n=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/n))};Kh.prototype.filter=function(t,n){var r=this;if(n===0)return null;for(var i=t.getCoordinate(n-1),a=t.getCoordinate(n),l=(a.x-i.x)/this._numSubSegs,o=(a.y-i.y)/this._numSubSegs,f=0;f<this._numSubSegs;f++){var p=i.x+f*l,y=i.y+f*o,x=new $e(p,y);r._minPtDist.initialize(),su.computeDistance(r._geom,x,r._minPtDist),r._maxPtDist.setMaximum(r._minPtDist)}};Kh.prototype.isDone=function(){return!1};Kh.prototype.isGeometryChanged=function(){return!1};Kh.prototype.getMaxPointDistance=function(){return this._maxPtDist};Kh.prototype.interfaces_=function(){return[Ml]};Kh.prototype.getClass=function(){return Kh};var gs=function(t,n,r){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=n||null,this._result=r||null},U2={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};gs.prototype.checkMaximumDistance=function(t,n,r){var i=new rl(n,t);if(i.setDensifyFraction(.25),this._maxDistanceFound=i.orientedDistance(),this._maxDistanceFound>r){this._isValid=!1;var a=i.getCoordinates();this._errorLocation=a[1],this._errorIndicator=t.getFactory().createLineString(a),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Al.toLineString(a[0],a[1])+")"}};gs.prototype.isValid=function(){var t=Math.abs(this._bufDistance),n=gs.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-n,this._maxValidDistance=t+n,this._input.isEmpty()||this._result.isEmpty()?!0:(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),gs.VERBOSE&&la.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)};gs.prototype.checkNegativeValid=function(){if(!(this._input instanceof Ro||this._input instanceof fc||this._input instanceof Va))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)};gs.prototype.getErrorIndicator=function(){return this._errorIndicator};gs.prototype.checkMinimumDistance=function(t,n,r){var i=new ua(t,n,r);if(this._minDistanceFound=i.distance(),this._minDistanceFound<r){this._isValid=!1;var a=i.nearestPoints();this._errorLocation=i.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(a),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Al.toLineString(a[0],a[1])+" )"}};gs.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)};gs.prototype.getErrorLocation=function(){return this._errorLocation};gs.prototype.getPolygonLines=function(t){for(var n=new jt,r=new ra(n),i=Yc.getPolygons(t),a=i.iterator();a.hasNext();){var l=a.next();l.apply(r)}return t.getFactory().buildGeometry(n)};gs.prototype.getErrorMessage=function(){return this._errMsg};gs.prototype.interfaces_=function(){return[]};gs.prototype.getClass=function(){return gs};U2.VERBOSE.get=function(){return!1};U2.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012};Object.defineProperties(gs,U2);var ca=function(t,n,r){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=n||null,this._result=r||null},V2={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};ca.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid};ca.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*ca.MAX_ENV_DIFF_FRAC;t===0&&(t=.001);var n=new _n(this._input.getEnvelopeInternal());n.expandBy(this._distance);var r=new _n(this._result.getEnvelopeInternal());r.expandBy(t),r.contains(n)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(r)),this.report("Envelope")};ca.prototype.checkDistance=function(){var t=new gs(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")};ca.prototype.checkArea=function(){var t=this._input.getArea(),n=this._result.getArea();this._distance>0&&t>n&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<n&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")};ca.prototype.checkPolygonal=function(){this._result instanceof Ro||this._result instanceof fc||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")};ca.prototype.getErrorIndicator=function(){return this._errorIndicator};ca.prototype.getErrorLocation=function(){return this._errorLocation};ca.prototype.checkExpectedEmpty=function(){if(this._input.getDimension()>=2||this._distance>0)return null;this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),this.report("ExpectedEmpty")};ca.prototype.report=function(t){if(!ca.VERBOSE)return null;la.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))};ca.prototype.getErrorMessage=function(){return this._errorMsg};ca.prototype.interfaces_=function(){return[]};ca.prototype.getClass=function(){return ca};ca.isValidMsg=function(t,n,r){var i=new ca(t,n,r);return i.isValid()?null:i.getErrorMessage()};ca.isValid=function(t,n,r){var i=new ca(t,n,r);return!!i.isValid()};V2.VERBOSE.get=function(){return!1};V2.MAX_ENV_DIFF_FRAC.get=function(){return .012};Object.defineProperties(ca,V2);var Su=function(){this._pts=null,this._data=null;var t=arguments[0],n=arguments[1];this._pts=t,this._data=n};Su.prototype.getCoordinates=function(){return this._pts};Su.prototype.size=function(){return this._pts.length};Su.prototype.getCoordinate=function(t){return this._pts[t]};Su.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};Su.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:qp.octant(this.getCoordinate(t),this.getCoordinate(t+1))};Su.prototype.setData=function(t){this._data=t};Su.prototype.getData=function(){return this._data};Su.prototype.toString=function(){return Al.toLineString(new ro(this._pts))};Su.prototype.interfaces_=function(){return[yc]};Su.prototype.getClass=function(){return Su};var qo=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new jt,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};qo.prototype.getInteriorIntersection=function(){return this._interiorIntersection};qo.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t};qo.prototype.getIntersectionSegments=function(){return this._intSegments};qo.prototype.count=function(){return this._intersectionCount};qo.prototype.getIntersections=function(){return this._intersections};qo.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};qo.prototype.setKeepIntersections=function(t){this._keepIntersections=t};qo.prototype.processIntersections=function(t,n,r,i){if(!this._findAllIntersections&&this.hasIntersection()||t===r&&n===i)return null;if(this._isCheckEndSegmentsOnly){var a=this.isEndSegment(t,n)||this.isEndSegment(r,i);if(!a)return null}var l=t.getCoordinates()[n],o=t.getCoordinates()[n+1],f=r.getCoordinates()[i],p=r.getCoordinates()[i+1];this._li.computeIntersection(l,o,f,p),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=l,this._intSegments[1]=o,this._intSegments[2]=f,this._intSegments[3]=p,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)};qo.prototype.isEndSegment=function(t,n){return n===0||n>=t.size()-2};qo.prototype.hasIntersection=function(){return this._interiorIntersection!==null};qo.prototype.isDone=function(){return this._findAllIntersections?!1:this._interiorIntersection!==null};qo.prototype.interfaces_=function(){return[cd]};qo.prototype.getClass=function(){return qo};qo.createAllIntersectionsFinder=function(t){var n=new qo(t);return n.setFindAllIntersections(!0),n};qo.createAnyIntersectionFinder=function(t){return new qo(t)};qo.createIntersectionCounter=function(t){var n=new qo(t);return n.setFindAllIntersections(!0),n.setKeepIntersections(!1),n};var kl=function(){this._li=new xd,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};kl.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()};kl.prototype.getIntersections=function(){return this._segInt.getIntersections()};kl.prototype.isValid=function(){return this.execute(),this._isValid};kl.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t};kl.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new qo(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new F2;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null};kl.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new rh(this.getErrorMessage(),this._segInt.getInteriorIntersection())};kl.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Al.toLineString(t[0],t[1])+" and "+Al.toLineString(t[2],t[3])};kl.prototype.interfaces_=function(){return[]};kl.prototype.getClass=function(){return kl};kl.computeIntersections=function(t){var n=new kl(t);return n.setFindAllIntersections(!0),n.isValid(),n.getIntersections()};var dd=function e(){this._nv=null;var t=arguments[0];this._nv=new kl(e.toSegmentStrings(t))};dd.prototype.checkValid=function(){this._nv.checkValid()};dd.prototype.interfaces_=function(){return[]};dd.prototype.getClass=function(){return dd};dd.toSegmentStrings=function(t){for(var n=new jt,r=t.iterator();r.hasNext();){var i=r.next();n.add(new Su(i.getCoordinates(),i))}return n};dd.checkValid=function(t){var n=new dd(t);n.checkValid()};var Kp=function(t){this._mapOp=t};Kp.prototype.map=function(t){for(var n=this,r=new jt,i=0;i<t.getNumGeometries();i++){var a=n._mapOp.map(t.getGeometryN(i));a.isEmpty()||r.add(a)}return t.getFactory().createGeometryCollection(rr.toGeometryArray(r))};Kp.prototype.interfaces_=function(){return[]};Kp.prototype.getClass=function(){return Kp};Kp.map=function(t,n){var r=new Kp(n);return r.map(t)};var Tu=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new jt,this._resultLineList=new jt;var t=arguments[0],n=arguments[1],r=arguments[2];this._op=t,this._geometryFactory=n,this._ptLocator=r};Tu.prototype.collectLines=function(t){for(var n=this,r=this._op.getGraph().getEdgeEnds().iterator();r.hasNext();){var i=r.next();n.collectLineEdge(i,t,n._lineEdgesList),n.collectBoundaryTouchEdge(i,t,n._lineEdgesList)}};Tu.prototype.labelIsolatedLine=function(t,n){var r=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(n));t.getLabel().setLocation(n,r)};Tu.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList};Tu.prototype.collectLineEdge=function(t,n,r){var i=t.getLabel(),a=t.getEdge();t.isLineEdge()&&!t.isVisited()&&qn.isResultOfOp(i,n)&&!a.isCovered()&&(r.add(a),t.setVisitedEdge(!0))};Tu.prototype.findCoveredLineEdges=function(){for(var t=this,n=this._op.getGraph().getNodes().iterator();n.hasNext();){var r=n.next();r.getEdges().findCoveredLineEdges()}for(var i=this._op.getGraph().getEdgeEnds().iterator();i.hasNext();){var a=i.next(),l=a.getEdge();if(a.isLineEdge()&&!l.isCoveredSet()){var o=t._op.isCoveredByA(a.getCoordinate());l.setCovered(o)}}};Tu.prototype.labelIsolatedLines=function(t){for(var n=this,r=t.iterator();r.hasNext();){var i=r.next(),a=i.getLabel();i.isIsolated()&&(a.isNull(0)?n.labelIsolatedLine(i,0):n.labelIsolatedLine(i,1))}};Tu.prototype.buildLines=function(t){for(var n=this,r=this._lineEdgesList.iterator();r.hasNext();){var i=r.next(),a=n._geometryFactory.createLineString(i.getCoordinates());n._resultLineList.add(a),i.setInResult(!0)}};Tu.prototype.collectBoundaryTouchEdge=function(t,n,r){var i=t.getLabel();if(t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult())return null;Xn.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),qn.isResultOfOp(i,n)&&n===qn.INTERSECTION&&(r.add(t.getEdge()),t.setVisitedEdge(!0))};Tu.prototype.interfaces_=function(){return[]};Tu.prototype.getClass=function(){return Tu};var Jp=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new jt;var t=arguments[0],n=arguments[1];this._op=t,this._geometryFactory=n};Jp.prototype.filterCoveredNodeToPoint=function(t){var n=t.getCoordinate();if(!this._op.isCoveredByLA(n)){var r=this._geometryFactory.createPoint(n);this._resultPointList.add(r)}};Jp.prototype.extractNonCoveredResultNodes=function(t){for(var n=this,r=this._op.getGraph().getNodes().iterator();r.hasNext();){var i=r.next();if(!i.isInResult()&&!i.isIncidentEdgeInResult()&&(i.getEdges().getDegree()===0||t===qn.INTERSECTION)){var a=i.getLabel();qn.isResultOfOp(a,t)&&n.filterCoveredNodeToPoint(i)}}};Jp.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList};Jp.prototype.interfaces_=function(){return[]};Jp.prototype.getClass=function(){return Jp};var ts=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};ts.prototype.transformPoint=function(t,n){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))};ts.prototype.transformPolygon=function(t,n){var r=this,i=!0,a=this.transformLinearRing(t.getExteriorRing(),t);(a===null||!(a instanceof gc)||a.isEmpty())&&(i=!1);for(var l=new jt,o=0;o<t.getNumInteriorRing();o++){var f=r.transformLinearRing(t.getInteriorRingN(o),t);f===null||f.isEmpty()||(f instanceof gc||(i=!1),l.add(f))}if(i)return this._factory.createPolygon(a,l.toArray([]));var p=new jt;return a!==null&&p.add(a),p.addAll(l),this._factory.buildGeometry(p)};ts.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)};ts.prototype.getInputGeometry=function(){return this._inputGeom};ts.prototype.transformMultiLineString=function(t,n){for(var r=this,i=new jt,a=0;a<t.getNumGeometries();a++){var l=r.transformLineString(t.getGeometryN(a),t);l!==null&&(l.isEmpty()||i.add(l))}return this._factory.buildGeometry(i)};ts.prototype.transformCoordinates=function(t,n){return this.copy(t)};ts.prototype.transformLineString=function(t,n){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))};ts.prototype.transformMultiPoint=function(t,n){for(var r=this,i=new jt,a=0;a<t.getNumGeometries();a++){var l=r.transformPoint(t.getGeometryN(a),t);l!==null&&(l.isEmpty()||i.add(l))}return this._factory.buildGeometry(i)};ts.prototype.transformMultiPolygon=function(t,n){for(var r=this,i=new jt,a=0;a<t.getNumGeometries();a++){var l=r.transformPolygon(t.getGeometryN(a),t);l!==null&&(l.isEmpty()||i.add(l))}return this._factory.buildGeometry(i)};ts.prototype.copy=function(t){return t.copy()};ts.prototype.transformGeometryCollection=function(t,n){for(var r=this,i=new jt,a=0;a<t.getNumGeometries();a++){var l=r.transform(t.getGeometryN(a));l!==null&&(r._pruneEmptyGeometry&&l.isEmpty()||i.add(l))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(rr.toGeometryArray(i)):this._factory.buildGeometry(i)};ts.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof ms)return this.transformPoint(t,null);if(t instanceof iy)return this.transformMultiPoint(t,null);if(t instanceof gc)return this.transformLinearRing(t,null);if(t instanceof Ki)return this.transformLineString(t,null);if(t instanceof sd)return this.transformMultiLineString(t,null);if(t instanceof Ro)return this.transformPolygon(t,null);if(t instanceof fc)return this.transformMultiPolygon(t,null);if(t instanceof Va)return this.transformGeometryCollection(t,null);throw new Ui("Unknown Geometry subtype: "+t.getClass().getName())};ts.prototype.transformLinearRing=function(t,n){var r=this.transformCoordinates(t.getCoordinateSequence(),t);if(r===null)return this._factory.createLinearRing(null);var i=r.size();return i>0&&i<4&&!this._preserveType?this._factory.createLineString(r):this._factory.createLinearRing(r)};ts.prototype.interfaces_=function(){return[]};ts.prototype.getClass=function(){return ts};var xc=function e(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new wn,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Ki&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];e.call(this,t.getCoordinates(),n)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var r=arguments[0],i=arguments[1];this._srcPts=r,this._isClosed=e.isClosed(r),this._snapTolerance=i}};xc.prototype.snapVertices=function(t,n){for(var r=this,i=this._isClosed?t.size()-1:t.size(),a=0;a<i;a++){var l=t.get(a),o=r.findSnapForVertex(l,n);o!==null&&(t.set(a,new $e(o)),a===0&&r._isClosed&&t.set(t.size()-1,new $e(o)))}};xc.prototype.findSnapForVertex=function(t,n){for(var r=this,i=0;i<n.length;i++){if(t.equals2D(n[i]))return null;if(t.distance(n[i])<r._snapTolerance)return n[i]}return null};xc.prototype.snapTo=function(t){var n=new H0(this._srcPts);this.snapVertices(n,t),this.snapSegments(n,t);var r=n.toCoordinateArray();return r};xc.prototype.snapSegments=function(t,n){var r=this;if(n.length===0)return null;var i=n.length;n[0].equals2D(n[n.length-1])&&(i=n.length-1);for(var a=0;a<i;a++){var l=n[a],o=r.findSegmentIndexToSnap(l,t);o>=0&&t.add(o+1,new $e(l),!1)}};xc.prototype.findSegmentIndexToSnap=function(t,n){for(var r=this,i=Nn.MAX_VALUE,a=-1,l=0;l<n.size()-1;l++){if(r._seg.p0=n.get(l),r._seg.p1=n.get(l+1),r._seg.p0.equals2D(t)||r._seg.p1.equals2D(t)){if(r._allowSnappingToSourceVertices)continue;return-1}var o=r._seg.distance(t);o<r._snapTolerance&&o<i&&(i=o,a=l)}return a};xc.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t};xc.prototype.interfaces_=function(){return[]};xc.prototype.getClass=function(){return xc};xc.isClosed=function(t){return t.length<=1?!1:t[0].equals2D(t[t.length-1])};var io=function(t){this._srcGeom=t||null},n5={SNAP_PRECISION_FACTOR:{configurable:!0}};io.prototype.snapTo=function(t,n){var r=this.extractTargetCoordinates(t),i=new r5(n,r);return i.transform(this._srcGeom)};io.prototype.snapToSelf=function(t,n){var r=this.extractTargetCoordinates(this._srcGeom),i=new r5(t,r,!0),a=i.transform(this._srcGeom),l=a;return n&&Pn(l,qh)&&(l=a.buffer(0)),l};io.prototype.computeSnapTolerance=function(t){var n=this.computeMinimumSegmentLength(t),r=n/10;return r};io.prototype.extractTargetCoordinates=function(t){for(var n=new yu,r=t.getCoordinates(),i=0;i<r.length;i++)n.add(r[i]);return n.toArray(new Array(0).fill(null))};io.prototype.computeMinimumSegmentLength=function(t){for(var n=Nn.MAX_VALUE,r=0;r<t.length-1;r++){var i=t[r].distance(t[r+1]);i<n&&(n=i)}return n};io.prototype.interfaces_=function(){return[]};io.prototype.getClass=function(){return io};io.snap=function(t,n,r){var i=new Array(2).fill(null),a=new io(t);i[0]=a.snapTo(n,r);var l=new io(n);return i[1]=l.snapTo(i[0],r),i};io.computeOverlaySnapTolerance=function(){if(arguments.length===1){var t=arguments[0],n=io.computeSizeBasedSnapTolerance(t),r=t.getPrecisionModel();if(r.getType()===Hr.FIXED){var i=1/r.getScale()*2/1.415;i>n&&(n=i)}return n}else if(arguments.length===2){var a=arguments[0],l=arguments[1];return Math.min(io.computeOverlaySnapTolerance(a),io.computeOverlaySnapTolerance(l))}};io.computeSizeBasedSnapTolerance=function(t){var n=t.getEnvelopeInternal(),r=Math.min(n.getHeight(),n.getWidth()),i=r*io.SNAP_PRECISION_FACTOR;return i};io.snapToSelf=function(t,n,r){var i=new io(t);return i.snapToSelf(n,r)};n5.SNAP_PRECISION_FACTOR.get=function(){return 1e-9};Object.defineProperties(io,n5);var r5=function(e){function t(n,r,i){e.call(this),this._snapTolerance=n||null,this._snapPts=r||null,this._isSelfSnap=i!==void 0?i:!1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.snapLine=function(r,i){var a=new xc(r,this._snapTolerance);return a.setAllowSnappingToSourceVertices(this._isSelfSnap),a.snapTo(i)},t.prototype.transformCoordinates=function(r,i){var a=r.toCoordinateArray(),l=this.snapLine(a,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(l)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ts),ka=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};ka.prototype.getCommon=function(){return Nn.longBitsToDouble(this._commonBits)};ka.prototype.add=function(t){var n=Nn.doubleToLongBits(t);if(this._isFirst)return this._commonBits=n,this._commonSignExp=ka.signExpBits(this._commonBits),this._isFirst=!1,null;var r=ka.signExpBits(n);if(r!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=ka.numCommonMostSigMantissaBits(this._commonBits,n),this._commonBits=ka.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))};ka.prototype.toString=function(){if(arguments.length===1){var t=arguments[0],n=Nn.longBitsToDouble(t),r=Nn.toBinaryString(t),i="0000000000000000000000000000000000000000000000000000000000000000"+r,a=i.substring(i.length-64),l=a.substring(0,1)+"  "+a.substring(1,12)+"(exp) "+a.substring(12)+" [ "+n+" ]";return l}};ka.prototype.interfaces_=function(){return[]};ka.prototype.getClass=function(){return ka};ka.getBit=function(t,n){var r=1<<n;return t&r?1:0};ka.signExpBits=function(t){return t>>52};ka.zeroLowerBits=function(t,n){var r=(1<<n)-1,i=~r,a=t&i;return a};ka.numCommonMostSigMantissaBits=function(t,n){for(var r=0,i=52;i>=0;i--){if(ka.getBit(t,i)!==ka.getBit(n,i))return r;r++}return 52};var Jh=function(){this._commonCoord=null,this._ccFilter=new Qp},G2={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Jh.prototype.addCommonBits=function(t){var n=new Qh(this._commonCoord);t.apply(n),t.geometryChanged()};Jh.prototype.removeCommonBits=function(t){if(this._commonCoord.x===0&&this._commonCoord.y===0)return t;var n=new $e(this._commonCoord);n.x=-n.x,n.y=-n.y;var r=new Qh(n);return t.apply(r),t.geometryChanged(),t};Jh.prototype.getCommonCoordinate=function(){return this._commonCoord};Jh.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()};Jh.prototype.interfaces_=function(){return[]};Jh.prototype.getClass=function(){return Jh};G2.CommonCoordinateFilter.get=function(){return Qp};G2.Translater.get=function(){return Qh};Object.defineProperties(Jh,G2);var Qp=function(){this._commonBitsX=new ka,this._commonBitsY=new ka};Qp.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)};Qp.prototype.getCommonCoordinate=function(){return new $e(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())};Qp.prototype.interfaces_=function(){return[pc]};Qp.prototype.getClass=function(){return Qp};var Qh=function(){this.trans=null;var t=arguments[0];this.trans=t};Qh.prototype.filter=function(t,n){var r=t.getOrdinate(n,0)+this.trans.x,i=t.getOrdinate(n,1)+this.trans.y;t.setOrdinate(n,0,r),t.setOrdinate(n,1,i)};Qh.prototype.isDone=function(){return!1};Qh.prototype.isGeometryChanged=function(){return!0};Qh.prototype.interfaces_=function(){return[Ml]};Qh.prototype.getClass=function(){return Qh};var Zo=function(t,n){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=n,this.computeSnapTolerance()};Zo.prototype.selfSnap=function(t){var n=new io(t),r=n.snapTo(t,this._snapTolerance);return r};Zo.prototype.removeCommonBits=function(t){this._cbr=new Jh,this._cbr.add(t[0]),this._cbr.add(t[1]);var n=new Array(2).fill(null);return n[0]=this._cbr.removeCommonBits(t[0].copy()),n[1]=this._cbr.removeCommonBits(t[1].copy()),n};Zo.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t};Zo.prototype.getResultGeometry=function(t){var n=this.snap(this._geom),r=qn.overlayOp(n[0],n[1],t);return this.prepareResult(r)};Zo.prototype.checkValid=function(t){t.isValid()||la.out.println("Snapped geometry is invalid")};Zo.prototype.computeSnapTolerance=function(){this._snapTolerance=io.computeOverlaySnapTolerance(this._geom[0],this._geom[1])};Zo.prototype.snap=function(t){var n=this.removeCommonBits(t),r=io.snap(n[0],n[1],this._snapTolerance);return r};Zo.prototype.interfaces_=function(){return[]};Zo.prototype.getClass=function(){return Zo};Zo.overlayOp=function(t,n,r){var i=new Zo(t,n);return i.getResultGeometry(r)};Zo.union=function(t,n){return Zo.overlayOp(t,n,qn.UNION)};Zo.intersection=function(t,n){return Zo.overlayOp(t,n,qn.INTERSECTION)};Zo.symDifference=function(t,n){return Zo.overlayOp(t,n,qn.SYMDIFFERENCE)};Zo.difference=function(t,n){return Zo.overlayOp(t,n,qn.DIFFERENCE)};var ja=function(t,n){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=n};ja.prototype.getResultGeometry=function(t){var n=null,r=!1,i=null;try{n=qn.overlayOp(this._geom[0],this._geom[1],t);var a=!0;a&&(r=!0)}catch(l){if(l instanceof th)i=l;else throw l}finally{}if(!r)try{n=Zo.overlayOp(this._geom[0],this._geom[1],t)}catch(l){throw l instanceof th?i:l}finally{}return n};ja.prototype.interfaces_=function(){return[]};ja.prototype.getClass=function(){return ja};ja.overlayOp=function(t,n,r){var i=new ja(t,n);return i.getResultGeometry(r)};ja.union=function(t,n){return ja.overlayOp(t,n,qn.UNION)};ja.intersection=function(t,n){return ja.overlayOp(t,n,qn.INTERSECTION)};ja.symDifference=function(t,n){return ja.overlayOp(t,n,qn.SYMDIFFERENCE)};ja.difference=function(t,n){return ja.overlayOp(t,n,qn.DIFFERENCE)};var P0=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],n=arguments[1];this.mce=t,this.chainIndex=n};P0.prototype.computeIntersections=function(t,n){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,n)};P0.prototype.interfaces_=function(){return[]};P0.prototype.getClass=function(){return P0};var _s=function e(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var t=arguments[0],n=arguments[1];this._eventType=e.DELETE,this._xValue=t,this._insertEvent=n}else if(arguments.length===3){var r=arguments[0],i=arguments[1],a=arguments[2];this._eventType=e.INSERT,this._label=r,this._xValue=i,this._obj=a}},$2={INSERT:{configurable:!0},DELETE:{configurable:!0}};_s.prototype.isDelete=function(){return this._eventType===_s.DELETE};_s.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t};_s.prototype.getObject=function(){return this._obj};_s.prototype.compareTo=function(t){var n=t;return this._xValue<n._xValue?-1:this._xValue>n._xValue?1:this._eventType<n._eventType?-1:this._eventType>n._eventType?1:0};_s.prototype.getInsertEvent=function(){return this._insertEvent};_s.prototype.isInsert=function(){return this._eventType===_s.INSERT};_s.prototype.isSameLabel=function(t){return this._label===null?!1:this._label===t._label};_s.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex};_s.prototype.interfaces_=function(){return[fl]};_s.prototype.getClass=function(){return _s};$2.INSERT.get=function(){return 1};$2.DELETE.get=function(){return 2};Object.defineProperties(_s,$2);var Gb=function(){};Gb.prototype.interfaces_=function(){return[]};Gb.prototype.getClass=function(){return Gb};var ha=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],n=arguments[1],r=arguments[2];this._li=t,this._includeProper=n,this._recordIsolated=r};ha.prototype.isTrivialIntersection=function(t,n,r,i){if(t===r&&this._li.getIntersectionNum()===1){if(ha.isAdjacentSegments(n,i))return!0;if(t.isClosed()){var a=t.getNumPoints()-1;if(n===0&&i===a||i===0&&n===a)return!0}}return!1};ha.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};ha.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t};ha.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};ha.prototype.isBoundaryPointInternal=function(t,n){for(var r=n.iterator();r.hasNext();){var i=r.next(),a=i.getCoordinate();if(t.isIntersection(a))return!0}return!1};ha.prototype.hasProperIntersection=function(){return this._hasProper};ha.prototype.hasIntersection=function(){return this._hasIntersection};ha.prototype.isDone=function(){return this._isDone};ha.prototype.isBoundaryPoint=function(t,n){return n===null?!1:!!(this.isBoundaryPointInternal(t,n[0])||this.isBoundaryPointInternal(t,n[1]))};ha.prototype.setBoundaryNodes=function(t,n){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=n};ha.prototype.addIntersections=function(t,n,r,i){if(t===r&&n===i)return null;this.numTests++;var a=t.getCoordinates()[n],l=t.getCoordinates()[n+1],o=r.getCoordinates()[i],f=r.getCoordinates()[i+1];this._li.computeIntersection(a,l,o,f),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),r.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,n,r,i)||(this._hasIntersection=!0,(this._includeProper||!this._li.isProper())&&(t.addIntersections(this._li,n,0),r.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))};ha.prototype.interfaces_=function(){return[]};ha.prototype.getClass=function(){return ha};ha.isAdjacentSegments=function(t,n){return Math.abs(t-n)===1};var WW=function(e){function t(){e.call(this),this.events=new jt,this.nOverlaps=null}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.prepareEvents=function(){var r=this;Ol.sort(this.events);for(var i=0;i<this.events.size();i++){var a=r.events.get(i);a.isDelete()&&a.getInsertEvent().setDeleteEventIndex(i)}},t.prototype.computeIntersections=function(){var r=this;if(arguments.length===1){var i=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var a=0;a<this.events.size();a++){var l=r.events.get(a);if(l.isInsert()&&r.processOverlaps(a,l.getDeleteEventIndex(),l,i),i.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof ha&&Pn(arguments[0],Cl)&&Pn(arguments[1],Cl)){var o=arguments[0],f=arguments[1],p=arguments[2];this.addEdges(o,o),this.addEdges(f,f),this.computeIntersections(p)}else if(typeof arguments[2]=="boolean"&&Pn(arguments[0],Cl)&&arguments[1]instanceof ha){var y=arguments[0],x=arguments[1],w=arguments[2];w?this.addEdges(y,null):this.addEdges(y),this.computeIntersections(x)}}},t.prototype.addEdge=function(r,i){for(var a=this,l=r.getMonotoneChainEdge(),o=l.getStartIndexes(),f=0;f<o.length-1;f++){var p=new P0(l,f),y=new _s(i,l.getMinX(f),p);a.events.add(y),a.events.add(new _s(l.getMaxX(f),y))}},t.prototype.processOverlaps=function(r,i,a,l){for(var o=this,f=a.getObject(),p=r;p<i;p++){var y=o.events.get(p);if(y.isInsert()){var x=y.getObject();a.isSameLabel(y)||(f.computeIntersections(x,l),o.nOverlaps++)}}},t.prototype.addEdges=function(){var r=this;if(arguments.length===1)for(var i=arguments[0],a=i.iterator();a.hasNext();){var l=a.next();r.addEdge(l,l)}else if(arguments.length===2)for(var o=arguments[0],f=arguments[1],p=o.iterator();p.hasNext();){var y=p.next();r.addEdge(y,f)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Gb),bc=function(){this._min=Nn.POSITIVE_INFINITY,this._max=Nn.NEGATIVE_INFINITY},i5={NodeComparator:{configurable:!0}};bc.prototype.getMin=function(){return this._min};bc.prototype.intersects=function(t,n){return!(this._min>n||this._max<t)};bc.prototype.getMax=function(){return this._max};bc.prototype.toString=function(){return Al.toLineString(new $e(this._min,0),new $e(this._max,0))};bc.prototype.interfaces_=function(){return[]};bc.prototype.getClass=function(){return bc};i5.NodeComparator.get=function(){return A0};Object.defineProperties(bc,i5);var A0=function(){};A0.prototype.compare=function(t,n){var r=t,i=n,a=(r._min+r._max)/2,l=(i._min+i._max)/2;return a<l?-1:a>l?1:0};A0.prototype.interfaces_=function(){return[Km]};A0.prototype.getClass=function(){return A0};var HW=function(e){function t(){e.call(this),this._item=null;var n=arguments[0],r=arguments[1],i=arguments[2];this._min=n,this._max=r,this._item=i}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.query=function(r,i,a){if(!this.intersects(r,i))return null;a.visitItem(this._item)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(bc),YW=function(e){function t(){e.call(this),this._node1=null,this._node2=null;var n=arguments[0],r=arguments[1];this._node1=n,this._node2=r,this.buildExtent(this._node1,this._node2)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.buildExtent=function(r,i){this._min=Math.min(r._min,i._min),this._max=Math.max(r._max,i._max)},t.prototype.query=function(r,i,a){if(!this.intersects(r,i))return null;this._node1!==null&&this._node1.query(r,i,a),this._node2!==null&&this._node2.query(r,i,a)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(bc),wc=function(){this._leaves=new jt,this._root=null,this._level=0};wc.prototype.buildTree=function(){var t=this;Ol.sort(this._leaves,new bc.NodeComparator);for(var n=this._leaves,r=null,i=new jt;;){if(t.buildLevel(n,i),i.size()===1)return i.get(0);r=n,n=i,i=r}};wc.prototype.insert=function(t,n,r){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new HW(t,n,r))};wc.prototype.query=function(t,n,r){this.init(),this._root.query(t,n,r)};wc.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()};wc.prototype.printNode=function(t){la.out.println(Al.toLineString(new $e(t._min,this._level),new $e(t._max,this._level)))};wc.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()};wc.prototype.buildLevel=function(t,n){this._level++,n.clear();for(var r=0;r<t.size();r+=2){var i=t.get(r),a=r+1<t.size()?t.get(r):null;if(a===null)n.add(i);else{var l=new YW(t.get(r),t.get(r+1));n.add(l)}}};wc.prototype.interfaces_=function(){return[]};wc.prototype.getClass=function(){return wc};var cy=function(){this._items=new jt};cy.prototype.visitItem=function(t){this._items.add(t)};cy.prototype.getItems=function(){return this._items};cy.prototype.interfaces_=function(){return[Zh]};cy.prototype.getClass=function(){return cy};var hy=function(){this._index=null;var t=arguments[0];if(!Pn(t,qh))throw new Ui("Argument must be Polygonal");this._index=new pd(t)},j2={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};hy.prototype.locate=function(t){var n=new fu(t),r=new fy(n);return this._index.query(t.y,t.y,r),n.getLocation()};hy.prototype.interfaces_=function(){return[ly]};hy.prototype.getClass=function(){return hy};j2.SegmentVisitor.get=function(){return fy};j2.IntervalIndexedGeometry.get=function(){return pd};Object.defineProperties(hy,j2);var fy=function(){this._counter=null;var t=arguments[0];this._counter=t};fy.prototype.visitItem=function(t){var n=t;this._counter.countSegment(n.getCoordinate(0),n.getCoordinate(1))};fy.prototype.interfaces_=function(){return[Zh]};fy.prototype.getClass=function(){return fy};var pd=function(){this._index=new wc;var t=arguments[0];this.init(t)};pd.prototype.init=function(t){for(var n=this,r=ra.getLines(t),i=r.iterator();i.hasNext();){var a=i.next(),l=a.getCoordinates();n.addLine(l)}};pd.prototype.addLine=function(t){for(var n=this,r=1;r<t.length;r++){var i=new wn(t[r-1],t[r]),a=Math.min(i.p0.y,i.p1.y),l=Math.max(i.p0.y,i.p1.y);n._index.insert(a,l,i)}};pd.prototype.query=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new cy;return this._index.query(t,n,r),r.getItems()}else if(arguments.length===3){var i=arguments[0],a=arguments[1],l=arguments[2];this._index.query(i,a,l)}};pd.prototype.interfaces_=function(){return[]};pd.prototype.getClass=function(){return pd};var A_=function(e){function t(){if(e.call(this),this._parentGeom=null,this._lineEdgeMap=new V4,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Rl,arguments.length===2){var n=arguments[0],r=arguments[1],i=ll.OGC_SFS_BOUNDARY_RULE;this._argIndex=n,this._parentGeom=r,this._boundaryNodeRule=i,r!==null&&this.add(r)}else if(arguments.length===3){var a=arguments[0],l=arguments[1],o=arguments[2];this._argIndex=a,this._parentGeom=l,this._boundaryNodeRule=o,l!==null&&this.add(l)}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.insertBoundaryPoint=function(r,i){var a=this._nodes.addNode(i),l=a.getLabel(),o=1,f=tt.NONE;f=l.getLocation(r,Ft.ON),f===tt.BOUNDARY&&o++;var p=t.determineBoundary(this._boundaryNodeRule,o);l.setLocation(r,p)},t.prototype.computeSelfNodes=function(){if(arguments.length===2){var r=arguments[0],i=arguments[1];return this.computeSelfNodes(r,i,!1)}else if(arguments.length===3){var a=arguments[0],l=arguments[1],o=arguments[2],f=new ha(a,!0,!1);f.setIsDoneIfProperInt(o);var p=this.createEdgeSetIntersector(),y=this._parentGeom instanceof gc||this._parentGeom instanceof Ro||this._parentGeom instanceof fc,x=l||!y;return p.computeIntersections(this._edges,f,x),this.addSelfIntersectionNodes(this._argIndex),f}},t.prototype.computeSplitEdges=function(r){for(var i=this._edges.iterator();i.hasNext();){var a=i.next();a.eiList.addSplitEdges(r)}},t.prototype.computeEdgeIntersections=function(r,i,a){var l=new ha(i,a,!0);l.setBoundaryNodes(this.getBoundaryNodes(),r.getBoundaryNodes());var o=this.createEdgeSetIntersector();return o.computeIntersections(this._edges,r._edges,l),l},t.prototype.getGeometry=function(){return this._parentGeom},t.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},t.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},t.prototype.addPoint=function(){if(arguments[0]instanceof ms){var r=arguments[0],i=r.getCoordinate();this.insertPoint(this._argIndex,i,tt.INTERIOR)}else if(arguments[0]instanceof $e){var a=arguments[0];this.insertPoint(this._argIndex,a,tt.INTERIOR)}},t.prototype.addPolygon=function(r){var i=this;this.addPolygonRing(r.getExteriorRing(),tt.EXTERIOR,tt.INTERIOR);for(var a=0;a<r.getNumInteriorRing();a++){var l=r.getInteriorRingN(a);i.addPolygonRing(l,tt.INTERIOR,tt.EXTERIOR)}},t.prototype.addEdge=function(r){this.insertEdge(r);var i=r.getCoordinates();this.insertPoint(this._argIndex,i[0],tt.BOUNDARY),this.insertPoint(this._argIndex,i[i.length-1],tt.BOUNDARY)},t.prototype.addLineString=function(r){var i=ir.removeRepeatedPoints(r.getCoordinates());if(i.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;var a=new Vb(i,new ri(this._argIndex,tt.INTERIOR));this._lineEdgeMap.put(r,a),this.insertEdge(a),Xn.isTrue(i.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,i[0]),this.insertBoundaryPoint(this._argIndex,i[i.length-1])},t.prototype.getInvalidPoint=function(){return this._invalidPoint},t.prototype.getBoundaryPoints=function(){for(var r=this.getBoundaryNodes(),i=new Array(r.size()).fill(null),a=0,l=r.iterator();l.hasNext();){var o=l.next();i[a++]=o.getCoordinate().copy()}return i},t.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},t.prototype.addSelfIntersectionNode=function(r,i,a){if(this.isBoundaryNode(r,i))return null;a===tt.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(r,i):this.insertPoint(r,i,a)},t.prototype.addPolygonRing=function(r,i,a){if(r.isEmpty())return null;var l=ir.removeRepeatedPoints(r.getCoordinates());if(l.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=l[0],null;var o=i,f=a;en.isCCW(l)&&(o=a,f=i);var p=new Vb(l,new ri(this._argIndex,tt.BOUNDARY,o,f));this._lineEdgeMap.put(r,p),this.insertEdge(p),this.insertPoint(this._argIndex,l[0],tt.BOUNDARY)},t.prototype.insertPoint=function(r,i,a){var l=this._nodes.addNode(i),o=l.getLabel();o===null?l._label=new ri(r,a):o.setLocation(r,a)},t.prototype.createEdgeSetIntersector=function(){return new WW},t.prototype.addSelfIntersectionNodes=function(r){for(var i=this,a=this._edges.iterator();a.hasNext();)for(var l=a.next(),o=l.getLabel().getLocation(r),f=l.eiList.iterator();f.hasNext();){var p=f.next();i.addSelfIntersectionNode(r,p.coord,o)}},t.prototype.add=function(){if(arguments.length===1){var r=arguments[0];if(r.isEmpty())return null;if(r instanceof fc&&(this._useBoundaryDeterminationRule=!1),r instanceof Ro)this.addPolygon(r);else if(r instanceof Ki)this.addLineString(r);else if(r instanceof ms)this.addPoint(r);else if(r instanceof iy)this.addCollection(r);else if(r instanceof sd)this.addCollection(r);else if(r instanceof fc)this.addCollection(r);else if(r instanceof Va)this.addCollection(r);else throw new Error(r.getClass().getName())}else return e.prototype.add.apply(this,arguments)},t.prototype.addCollection=function(r){for(var i=this,a=0;a<r.getNumGeometries();a++){var l=r.getGeometryN(a);i.add(l)}},t.prototype.locate=function(r){return Pn(this._parentGeom,qh)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new hy(this._parentGeom)),this._areaPtLocator.locate(r)):this._ptLocator.locate(r,this._parentGeom)},t.prototype.findEdge=function(){if(arguments.length===1){var r=arguments[0];return this._lineEdgeMap.get(r)}else return e.prototype.findEdge.apply(this,arguments)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.determineBoundary=function(r,i){return r.isInBoundary(i)?tt.BOUNDARY:tt.INTERIOR},t}(Xi),dy=function(){if(this._li=new xd,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new A_(0,t)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],i=ll.OGC_SFS_BOUNDARY_RULE;n.getPrecisionModel().compareTo(r.getPrecisionModel())>=0?this.setComputationPrecision(n.getPrecisionModel()):this.setComputationPrecision(r.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new A_(0,n,i),this._arg[1]=new A_(1,r,i)}else if(arguments.length===3){var a=arguments[0],l=arguments[1],o=arguments[2];a.getPrecisionModel().compareTo(l.getPrecisionModel())>=0?this.setComputationPrecision(a.getPrecisionModel()):this.setComputationPrecision(l.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new A_(0,a,o),this._arg[1]=new A_(1,l,o)}};dy.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()};dy.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)};dy.prototype.interfaces_=function(){return[]};dy.prototype.getClass=function(){return dy};var nd=function(){};nd.prototype.interfaces_=function(){return[]};nd.prototype.getClass=function(){return nd};nd.map=function(){if(arguments[0]instanceof Cn&&Pn(arguments[1],nd.MapOp)){for(var t=arguments[0],n=arguments[1],r=new jt,i=0;i<t.getNumGeometries();i++){var a=n.map(t.getGeometryN(i));a!==null&&r.add(a)}return t.getFactory().buildGeometry(r)}else if(Pn(arguments[0],Po)&&Pn(arguments[1],nd.MapOp)){for(var l=arguments[0],o=arguments[1],f=new jt,p=l.iterator();p.hasNext();){var y=p.next(),x=o.map(y);x!==null&&f.add(x)}return f}};nd.MapOp=function(){};var qn=function(e){function t(){var n=arguments[0],r=arguments[1];e.call(this,n,r),this._ptLocator=new Rl,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Dl,this._resultPolyList=new jt,this._resultLineList=new jt,this._resultPointList=new jt,this._graph=new Xi(new H4),this._geomFact=n.getFactory()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.insertUniqueEdge=function(r){var i=this._edgeList.findEqualEdge(r);if(i!==null){var a=i.getLabel(),l=r.getLabel();i.isPointwiseEqual(r)||(l=new ri(r.getLabel()),l.flip());var o=i.getDepth();o.isNull()&&o.add(a),o.add(l),a.merge(l)}else this._edgeList.add(r)},t.prototype.getGraph=function(){return this._graph},t.prototype.cancelDuplicateResultEdges=function(){for(var r=this._graph.getEdgeEnds().iterator();r.hasNext();){var i=r.next(),a=i.getSym();i.isInResult()&&a.isInResult()&&(i.setInResult(!1),a.setInResult(!1))}},t.prototype.isCoveredByLA=function(r){return!!(this.isCovered(r,this._resultLineList)||this.isCovered(r,this._resultPolyList))},t.prototype.computeGeometry=function(r,i,a,l){var o=new jt;return o.addAll(r),o.addAll(i),o.addAll(a),o.isEmpty()?t.createEmptyResult(l,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(o)},t.prototype.mergeSymLabels=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var i=r.next();i.getEdges().mergeSymLabels()}},t.prototype.isCovered=function(r,i){for(var a=this,l=i.iterator();l.hasNext();){var o=l.next(),f=a._ptLocator.locate(r,o);if(f!==tt.EXTERIOR)return!0}return!1},t.prototype.replaceCollapsedEdges=function(){for(var r=new jt,i=this._edgeList.iterator();i.hasNext();){var a=i.next();a.isCollapsed()&&(i.remove(),r.add(a.getCollapsedEdge()))}this._edgeList.addAll(r)},t.prototype.updateNodeLabelling=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var i=r.next(),a=i.getEdges().getLabel();i.getLabel().merge(a)}},t.prototype.getResultGeometry=function(r){return this.computeOverlay(r),this._resultGeom},t.prototype.insertUniqueEdges=function(r){for(var i=this,a=r.iterator();a.hasNext();){var l=a.next();i.insertUniqueEdge(l)}},t.prototype.computeOverlay=function(r){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var i=new jt;this._arg[0].computeSplitEdges(i),this._arg[1].computeSplitEdges(i),this.insertUniqueEdges(i),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),dd.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(r),this.cancelDuplicateResultEdges();var a=new ys(this._geomFact);a.add(this._graph),this._resultPolyList=a.getPolygons();var l=new Tu(this,this._geomFact,this._ptLocator);this._resultLineList=l.build(r);var o=new Jp(this,this._geomFact,this._ptLocator);this._resultPointList=o.build(r),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,r)},t.prototype.labelIncompleteNode=function(r,i){var a=this._ptLocator.locate(r.getCoordinate(),this._arg[i].getGeometry());r.getLabel().setLocation(i,a)},t.prototype.copyPoints=function(r){for(var i=this,a=this._arg[r].getNodeIterator();a.hasNext();){var l=a.next(),o=i._graph.addNode(l.getCoordinate());o.setLabel(r,l.getLabel().getLocation(r))}},t.prototype.findResultAreaEdges=function(r){for(var i=this._graph.getEdgeEnds().iterator();i.hasNext();){var a=i.next(),l=a.getLabel();l.isArea()&&!a.isInteriorAreaEdge()&&t.isResultOfOp(l.getLocation(0,Ft.RIGHT),l.getLocation(1,Ft.RIGHT),r)&&a.setInResult(!0)}},t.prototype.computeLabelsFromDepths=function(){for(var r=this._edgeList.iterator();r.hasNext();){var i=r.next(),a=i.getLabel(),l=i.getDepth();if(!l.isNull()){l.normalize();for(var o=0;o<2;o++)!a.isNull(o)&&a.isArea()&&!l.isNull(o)&&(l.getDelta(o)===0?a.toLine(o):(Xn.isTrue(!l.isNull(o,Ft.LEFT),"depth of LEFT side has not been initialized"),a.setLocation(o,Ft.LEFT,l.getLocation(o,Ft.LEFT)),Xn.isTrue(!l.isNull(o,Ft.RIGHT),"depth of RIGHT side has not been initialized"),a.setLocation(o,Ft.RIGHT,l.getLocation(o,Ft.RIGHT))))}}},t.prototype.computeLabelling=function(){for(var r=this,i=this._graph.getNodes().iterator();i.hasNext();){var a=i.next();a.getEdges().computeLabelling(r._arg)}this.mergeSymLabels(),this.updateNodeLabelling()},t.prototype.labelIncompleteNodes=function(){for(var r=this,i=this._graph.getNodes().iterator();i.hasNext();){var a=i.next(),l=a.getLabel();a.isIsolated()&&(l.isNull(0)?r.labelIncompleteNode(a,0):r.labelIncompleteNode(a,1)),a.getEdges().updateLabelling(l)}},t.prototype.isCoveredByA=function(r){return!!this.isCovered(r,this._resultPolyList)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(dy);qn.overlayOp=function(e,t,n){var r=new qn(e,t),i=r.getResultGeometry(n);return i};qn.intersection=function(e,t){if(e.isEmpty()||t.isEmpty())return qn.createEmptyResult(qn.INTERSECTION,e,t,e.getFactory());if(e.isGeometryCollection()){var n=t;return Kp.map(e,{interfaces_:function(){return[nd.MapOp]},map:function(r){return r.intersection(n)}})}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),ja.overlayOp(e,t,qn.INTERSECTION)};qn.symDifference=function(e,t){if(e.isEmpty()||t.isEmpty()){if(e.isEmpty()&&t.isEmpty())return qn.createEmptyResult(qn.SYMDIFFERENCE,e,t,e.getFactory());if(e.isEmpty())return t.copy();if(t.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),ja.overlayOp(e,t,qn.SYMDIFFERENCE)};qn.resultDimension=function(e,t,n){var r=t.getDimension(),i=n.getDimension(),a=-1;switch(e){case qn.INTERSECTION:a=Math.min(r,i);break;case qn.UNION:a=Math.max(r,i);break;case qn.DIFFERENCE:a=r;break;case qn.SYMDIFFERENCE:a=Math.max(r,i);break}return a};qn.createEmptyResult=function(e,t,n,r){var i=null;switch(qn.resultDimension(e,t,n)){case-1:i=r.createGeometryCollection(new Array(0).fill(null));break;case 0:i=r.createPoint();break;case 1:i=r.createLineString();break;case 2:i=r.createPolygon();break}return i};qn.difference=function(e,t){return e.isEmpty()?qn.createEmptyResult(qn.DIFFERENCE,e,t,e.getFactory()):t.isEmpty()?e.copy():(e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),ja.overlayOp(e,t,qn.DIFFERENCE))};qn.isResultOfOp=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1],n=e.getLocation(0),r=e.getLocation(1);return qn.isResultOfOp(n,r,t)}else if(arguments.length===3){var i=arguments[0],a=arguments[1],l=arguments[2];switch(i===tt.BOUNDARY&&(i=tt.INTERIOR),a===tt.BOUNDARY&&(a=tt.INTERIOR),l){case qn.INTERSECTION:return i===tt.INTERIOR&&a===tt.INTERIOR;case qn.UNION:return i===tt.INTERIOR||a===tt.INTERIOR;case qn.DIFFERENCE:return i===tt.INTERIOR&&a!==tt.INTERIOR;case qn.SYMDIFFERENCE:return i===tt.INTERIOR&&a!==tt.INTERIOR||i!==tt.INTERIOR&&a===tt.INTERIOR}return!1}};qn.INTERSECTION=1;qn.UNION=2;qn.DIFFERENCE=3;qn.SYMDIFFERENCE=4;var Uh=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Rl,this._seg=new wn;var t=arguments[0],n=arguments[1];this._g=t,this._boundaryDistanceTolerance=n,this._linework=this.extractLinework(t)};Uh.prototype.isWithinToleranceOfBoundary=function(t){for(var n=this,r=0;r<this._linework.getNumGeometries();r++)for(var i=n._linework.getGeometryN(r),a=i.getCoordinateSequence(),l=0;l<a.size()-1;l++){a.getCoordinate(l,n._seg.p0),a.getCoordinate(l+1,n._seg.p1);var o=n._seg.distance(t);if(o<=n._boundaryDistanceTolerance)return!0}return!1};Uh.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?tt.BOUNDARY:this._ptLocator.locate(t,this._g)};Uh.prototype.extractLinework=function(t){var n=new py;t.apply(n);var r=n.getLinework(),i=rr.toLineStringArray(r);return t.getFactory().createMultiLineString(i)};Uh.prototype.interfaces_=function(){return[]};Uh.prototype.getClass=function(){return Uh};var py=function(){this._linework=null,this._linework=new jt};py.prototype.getLinework=function(){return this._linework};py.prototype.filter=function(t){var n=this;if(t instanceof Ro){var r=t;this._linework.add(r.getExteriorRing());for(var i=0;i<r.getNumInteriorRing();i++)n._linework.add(r.getInteriorRingN(i))}};py.prototype.interfaces_=function(){return[vu]};py.prototype.getClass=function(){return py};var gd=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};gd.prototype.extractPoints=function(t,n,r){for(var i=this,a=t.getCoordinates(),l=0;l<a.length-1;l++)i.computeOffsetPoints(a[l],a[l+1],n,r)};gd.prototype.setSidesToGenerate=function(t,n){this._doLeft=t,this._doRight=n};gd.prototype.getPoints=function(t){for(var n=this,r=new jt,i=ra.getLines(this._g),a=i.iterator();a.hasNext();){var l=a.next();n.extractPoints(l,t,r)}return r};gd.prototype.computeOffsetPoints=function(t,n,r,i){var a=n.x-t.x,l=n.y-t.y,o=Math.sqrt(a*a+l*l),f=r*a/o,p=r*l/o,y=(n.x+t.x)/2,x=(n.y+t.y)/2;if(this._doLeft){var w=new $e(y-p,x+f);i.add(w)}if(this._doRight){var S=new $e(y+p,x-f);i.add(S)}};gd.prototype.interfaces_=function(){return[]};gd.prototype.getClass=function(){return gd};var zs=function e(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=e.TOLERANCE,this._testCoords=new jt;var t=arguments[0],n=arguments[1],r=arguments[2];this._boundaryDistanceTolerance=e.computeBoundaryDistanceTolerance(t,n),this._geom=[t,n,r],this._locFinder=[new Uh(this._geom[0],this._boundaryDistanceTolerance),new Uh(this._geom[1],this._boundaryDistanceTolerance),new Uh(this._geom[2],this._boundaryDistanceTolerance)]},o5={TOLERANCE:{configurable:!0}};zs.prototype.reportResult=function(t,n,r){la.out.println("Overlay result invalid - A:"+tt.toLocationSymbol(n[0])+" B:"+tt.toLocationSymbol(n[1])+" expected:"+(r?"i":"e")+" actual:"+tt.toLocationSymbol(n[2]))};zs.prototype.isValid=function(t){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var n=this.checkValid(t);return n};zs.prototype.checkValid=function(){var t=this;if(arguments.length===1){for(var n=arguments[0],r=0;r<this._testCoords.size();r++){var i=t._testCoords.get(r);if(!t.checkValid(n,i))return t._invalidLocation=i,!1}return!0}else if(arguments.length===2){var a=arguments[0],l=arguments[1];return this._location[0]=this._locFinder[0].getLocation(l),this._location[1]=this._locFinder[1].getLocation(l),this._location[2]=this._locFinder[2].getLocation(l),zs.hasLocation(this._location,tt.BOUNDARY)?!0:this.isValidResult(a,this._location)}};zs.prototype.addTestPts=function(t){var n=new gd(t);this._testCoords.addAll(n.getPoints(5*this._boundaryDistanceTolerance))};zs.prototype.isValidResult=function(t,n){var r=qn.isResultOfOp(n[0],n[1],t),i=n[2]===tt.INTERIOR,a=!(r^i);return a||this.reportResult(t,n,r),a};zs.prototype.getInvalidLocation=function(){return this._invalidLocation};zs.prototype.interfaces_=function(){return[]};zs.prototype.getClass=function(){return zs};zs.hasLocation=function(t,n){for(var r=0;r<3;r++)if(t[r]===n)return!0;return!1};zs.computeBoundaryDistanceTolerance=function(t,n){return Math.min(io.computeSizeBasedSnapTolerance(t),io.computeSizeBasedSnapTolerance(n))};zs.isValid=function(t,n,r,i){var a=new zs(t,n,i);return a.isValid(r)};o5.TOLERANCE.get=function(){return 1e-6};Object.defineProperties(zs,o5);var Ms=function e(t){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=e.extractFactory(t),this._inputGeoms=t};Ms.prototype.extractElements=function(t,n){var r=this;if(t===null)return null;for(var i=0;i<t.getNumGeometries();i++){var a=t.getGeometryN(i);r._skipEmpty&&a.isEmpty()||n.add(a)}};Ms.prototype.combine=function(){for(var t=this,n=new jt,r=this._inputGeoms.iterator();r.hasNext();){var i=r.next();t.extractElements(i,n)}return n.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(n)};Ms.prototype.interfaces_=function(){return[]};Ms.prototype.getClass=function(){return Ms};Ms.combine=function(){if(arguments.length===1){var t=arguments[0],n=new Ms(t);return n.combine()}else if(arguments.length===2){var r=arguments[0],i=arguments[1],a=new Ms(Ms.createList(r,i));return a.combine()}else if(arguments.length===3){var l=arguments[0],o=arguments[1],f=arguments[2],p=new Ms(Ms.createList(l,o,f));return p.combine()}};Ms.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()};Ms.createList=function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new jt;return r.add(t),r.add(n),r}else if(arguments.length===3){var i=arguments[0],a=arguments[1],l=arguments[2],o=new jt;return o.add(i),o.add(a),o.add(l),o}};var po=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,this._inputPolys===null&&(this._inputPolys=new jt)},a5={STRTREE_NODE_CAPACITY:{configurable:!0}};po.prototype.reduceToGeometries=function(t){for(var n=this,r=new jt,i=t.iterator();i.hasNext();){var a=i.next(),l=null;Pn(a,Cl)?l=n.unionTree(a):a instanceof Cn&&(l=a),r.add(l)}return r};po.prototype.extractByEnvelope=function(t,n,r){for(var i=new jt,a=0;a<n.getNumGeometries();a++){var l=n.getGeometryN(a);l.getEnvelopeInternal().intersects(t)?i.add(l):r.add(l)}return this._geomFactory.buildGeometry(i)};po.prototype.unionOptimized=function(t,n){var r=t.getEnvelopeInternal(),i=n.getEnvelopeInternal();if(!r.intersects(i)){var a=Ms.combine(t,n);return a}if(t.getNumGeometries()<=1&&n.getNumGeometries()<=1)return this.unionActual(t,n);var l=r.intersection(i);return this.unionUsingEnvelopeIntersection(t,n,l)};po.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new q4(po.STRTREE_NODE_CAPACITY),n=this._inputPolys.iterator();n.hasNext();){var r=n.next();t.insert(r.getEnvelopeInternal(),r)}this._inputPolys=null;var i=t.itemsTree(),a=this.unionTree(i);return a};po.prototype.binaryUnion=function(){if(arguments.length===1){var t=arguments[0];return this.binaryUnion(t,0,t.size())}else if(arguments.length===3){var n=arguments[0],r=arguments[1],i=arguments[2];if(i-r<=1){var a=po.getGeometry(n,r);return this.unionSafe(a,null)}else{if(i-r===2)return this.unionSafe(po.getGeometry(n,r),po.getGeometry(n,r+1));var l=Math.trunc((i+r)/2),o=this.binaryUnion(n,r,l),f=this.binaryUnion(n,l,i);return this.unionSafe(o,f)}}};po.prototype.repeatedUnion=function(t){for(var n=null,r=t.iterator();r.hasNext();){var i=r.next();n===null?n=i.copy():n=n.union(i)}return n};po.prototype.unionSafe=function(t,n){return t===null&&n===null?null:t===null?n.copy():n===null?t.copy():this.unionOptimized(t,n)};po.prototype.unionActual=function(t,n){return po.restrictToPolygons(t.union(n))};po.prototype.unionTree=function(t){var n=this.reduceToGeometries(t),r=this.binaryUnion(n);return r};po.prototype.unionUsingEnvelopeIntersection=function(t,n,r){var i=new jt,a=this.extractByEnvelope(r,t,i),l=this.extractByEnvelope(r,n,i),o=this.unionActual(a,l);i.add(o);var f=Ms.combine(i);return f};po.prototype.bufferUnion=function(){if(arguments.length===1){var t=arguments[0],n=t.get(0).getFactory(),r=n.buildGeometry(t),i=r.buffer(0);return i}else if(arguments.length===2){var a=arguments[0],l=arguments[1],o=a.getFactory(),f=o.createGeometryCollection([a,l]),p=f.buffer(0);return p}};po.prototype.interfaces_=function(){return[]};po.prototype.getClass=function(){return po};po.restrictToPolygons=function(t){if(Pn(t,qh))return t;var n=Yc.getPolygons(t);return n.size()===1?n.get(0):t.getFactory().createMultiPolygon(rr.toPolygonArray(n))};po.getGeometry=function(t,n){return n>=t.size()?null:t.get(n)};po.union=function(t){var n=new po(t);return n.union()};a5.STRTREE_NODE_CAPACITY.get=function(){return 4};Object.defineProperties(po,a5);var $b=function(){};$b.prototype.interfaces_=function(){return[]};$b.prototype.getClass=function(){return $b};$b.union=function(t,n){if(t.isEmpty()||n.isEmpty()){if(t.isEmpty()&&n.isEmpty())return qn.createEmptyResult(qn.UNION,t,n,t.getFactory());if(t.isEmpty())return n.copy();if(n.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(n),ja.overlayOp(t,n,qn.UNION)};function bd(){return new jb}function jb(){this.reset()}jb.prototype={constructor:jb,reset:function(){this.s=this.t=0},add:function(e){r3(Yx,e,this.t),r3(this,Yx.s,this.s),this.s?this.t+=Yx.t:this.s=Yx.t},valueOf:function(){return this.s}};var Yx=new jb;function r3(e,t,n){var r=e.s=t+n,i=r-t,a=r-i;e.t=t-a+(n-i)}var Hi=1e-6,vi=Math.PI,Hc=vi/2,i3=vi/4,ah=vi*2,Zf=180/vi,iu=vi/180,Ba=Math.abs,KW=Math.atan,gy=Math.atan2,Ao=Math.cos,Mo=Math.sin,My=Math.sqrt;function s5(e){return e>1?0:e<-1?vi:Math.acos(e)}function eg(e){return e>1?Hc:e<-1?-Hc:Math.asin(e)}function G_(){}function qb(e,t){e&&a3.hasOwnProperty(e.type)&&a3[e.type](e,t)}var o3={Feature:function(e,t){qb(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)qb(n[r].geometry,t)}},a3={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){PI(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)PI(n[r],t,0)},Polygon:function(e,t){s3(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)s3(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)qb(n[r],t)}};function PI(e,t,n){var r=-1,i=e.length-n,a;for(t.lineStart();++r<i;)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function s3(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)PI(e[n],t,1);t.polygonEnd()}function JW(e,t){e&&o3.hasOwnProperty(e.type)?o3[e.type](e,t):qb(e,t)}bd();bd();function AI(e){return[gy(e[1],e[0]),eg(e[2])]}function my(e){var t=e[0],n=e[1],r=Ao(n);return[r*Ao(t),r*Mo(t),Mo(n)]}function Kx(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Zb(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function PT(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Jx(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function MI(e){var t=My(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}bd();function l5(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function LI(e,t){return[e>vi?e-ah:e<-vi?e+ah:e,t]}LI.invert=LI;function QW(e,t,n){return(e%=ah)?t||n?l5(u3(e),c3(t,n)):u3(e):t||n?c3(t,n):LI}function l3(e){return function(t,n){return t+=e,[t>vi?t-ah:t<-vi?t+ah:t,n]}}function u3(e){var t=l3(e);return t.invert=l3(-e),t}function c3(e,t){var n=Ao(e),r=Mo(e),i=Ao(t),a=Mo(t);function l(o,f){var p=Ao(f),y=Ao(o)*p,x=Mo(o)*p,w=Mo(f),S=w*n+y*r;return[gy(x*i-S*a,y*n-w*r),eg(S*i+x*a)]}return l.invert=function(o,f){var p=Ao(f),y=Ao(o)*p,x=Mo(o)*p,w=Mo(f),S=w*i-x*a;return[gy(x*i+w*a,y*n+S*r),eg(S*n-y*r)]},l}function eH(e,t,n,r,i,a){if(n){var l=Ao(t),o=Mo(t),f=r*n;i==null?(i=t+r*ah,a=t-f/2):(i=h3(l,i),a=h3(l,a),(r>0?i<a:i>a)&&(i+=r*ah));for(var p,y=i;r>0?y>a:y<a;y-=f)p=AI([l,-o*Ao(y),-o*Mo(y)]),e.point(p[0],p[1])}}function h3(e,t){t=my(t),t[0]-=e,MI(t);var n=s5(-t[1]);return((-t[2]<0?-n:n)+ah-Hi)%ah}function u5(){var e=[],t;return{point:function(n,r){t.push([n,r])},lineStart:function(){e.push(t=[])},lineEnd:G_,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function tH(e,t,n,r,i,a){var l=e[0],o=e[1],f=t[0],p=t[1],y=0,x=1,w=f-l,S=p-o,L;if(L=n-l,!(!w&&L>0)){if(L/=w,w<0){if(L<y)return;L<x&&(x=L)}else if(w>0){if(L>x)return;L>y&&(y=L)}if(L=i-l,!(!w&&L<0)){if(L/=w,w<0){if(L>x)return;L>y&&(y=L)}else if(w>0){if(L<y)return;L<x&&(x=L)}if(L=r-o,!(!S&&L>0)){if(L/=S,S<0){if(L<y)return;L<x&&(x=L)}else if(S>0){if(L>x)return;L>y&&(y=L)}if(L=a-o,!(!S&&L<0)){if(L/=S,S<0){if(L>x)return;L>y&&(y=L)}else if(S>0){if(L<y)return;L<x&&(x=L)}return y>0&&(e[0]=l+y*w,e[1]=o+y*S),x<1&&(t[0]=l+x*w,t[1]=o+x*S),!0}}}}}function pb(e,t){return Ba(e[0]-t[0])<Hi&&Ba(e[1]-t[1])<Hi}function Qx(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function c5(e,t,n,r,i){var a=[],l=[],o,f;if(e.forEach(function(L){if(!((D=L.length-1)<=0)){var D,B=L[0],z=L[D],M;if(pb(B,z)){for(i.lineStart(),o=0;o<D;++o)i.point((B=L[o])[0],B[1]);i.lineEnd();return}a.push(M=new Qx(B,L,null,!0)),l.push(M.o=new Qx(B,null,M,!1)),a.push(M=new Qx(z,L,null,!1)),l.push(M.o=new Qx(z,null,M,!0))}}),!!a.length){for(l.sort(t),f3(a),f3(l),o=0,f=l.length;o<f;++o)l[o].e=n=!n;for(var p=a[0],y,x;;){for(var w=p,S=!0;w.v;)if((w=w.n)===p)return;y=w.z,i.lineStart();do{if(w.v=w.o.v=!0,w.e){if(S)for(o=0,f=y.length;o<f;++o)i.point((x=y[o])[0],x[1]);else r(w.x,w.n.x,1,i);w=w.n}else{if(S)for(y=w.p.z,o=y.length-1;o>=0;--o)i.point((x=y[o])[0],x[1]);else r(w.x,w.p.x,-1,i);w=w.p}w=w.o,y=w.z,S=!S}while(!w.v);i.lineEnd()}}}function f3(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function h5(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function nH(e){return e.length===1&&(e=rH(e)),{left:function(t,n,r,i){for(r==null&&(r=0),i==null&&(i=t.length);r<i;){var a=r+i>>>1;e(t[a],n)<0?r=a+1:i=a}return r},right:function(t,n,r,i){for(r==null&&(r=0),i==null&&(i=t.length);r<i;){var a=r+i>>>1;e(t[a],n)>0?i=a:r=a+1}return r}}}function rH(e){return function(t,n){return h5(e(t),n)}}nH(h5);function f5(e){for(var t=e.length,n,r=-1,i=0,a,l;++r<t;)i+=e[r].length;for(a=new Array(i);--t>=0;)for(l=e[t],n=l.length;--n>=0;)a[--i]=l[n];return a}var $_=1e9,eb=-$_;function iH(e,t,n,r){function i(p,y){return e<=p&&p<=n&&t<=y&&y<=r}function a(p,y,x,w){var S=0,L=0;if(p==null||(S=l(p,x))!==(L=l(y,x))||f(p,y)<0^x>0)do w.point(S===0||S===3?e:n,S>1?r:t);while((S=(S+x+4)%4)!==L);else w.point(y[0],y[1])}function l(p,y){return Ba(p[0]-e)<Hi?y>0?0:3:Ba(p[0]-n)<Hi?y>0?2:1:Ba(p[1]-t)<Hi?y>0?1:0:y>0?3:2}function o(p,y){return f(p.x,y.x)}function f(p,y){var x=l(p,1),w=l(y,1);return x!==w?x-w:x===0?y[1]-p[1]:x===1?p[0]-y[0]:x===2?p[1]-y[1]:y[0]-p[0]}return function(p){var y=p,x=u5(),w,S,L,D,B,z,M,k,V,q,Y,K={point:X,lineStart:ae,lineEnd:ve,polygonStart:le,polygonEnd:ue};function X(He,Oe){i(He,Oe)&&y.point(He,Oe)}function U(){for(var He=0,Oe=0,Ve=S.length;Oe<Ve;++Oe)for(var Pe=S[Oe],Ke=1,Be=Pe.length,Ue=Pe[0],lt,xt,Nt=Ue[0],Wt=Ue[1];Ke<Be;++Ke)lt=Nt,xt=Wt,Ue=Pe[Ke],Nt=Ue[0],Wt=Ue[1],xt<=r?Wt>r&&(Nt-lt)*(r-xt)>(Wt-xt)*(e-lt)&&++He:Wt<=r&&(Nt-lt)*(r-xt)<(Wt-xt)*(e-lt)&&--He;return He}function le(){y=x,w=[],S=[],Y=!0}function ue(){var He=U(),Oe=Y&&He,Ve=(w=f5(w)).length;(Oe||Ve)&&(p.polygonStart(),Oe&&(p.lineStart(),a(null,null,1,p),p.lineEnd()),Ve&&c5(w,o,He,a,p),p.polygonEnd()),y=p,w=S=L=null}function ae(){K.point=Ee,S&&S.push(L=[]),q=!0,V=!1,M=k=NaN}function ve(){w&&(Ee(D,B),z&&V&&x.rejoin(),w.push(x.result())),K.point=X,V&&y.lineEnd()}function Ee(He,Oe){var Ve=i(He,Oe);if(S&&L.push([He,Oe]),q)D=He,B=Oe,z=Ve,q=!1,Ve&&(y.lineStart(),y.point(He,Oe));else if(Ve&&V)y.point(He,Oe);else{var Pe=[M=Math.max(eb,Math.min($_,M)),k=Math.max(eb,Math.min($_,k))],Ke=[He=Math.max(eb,Math.min($_,He)),Oe=Math.max(eb,Math.min($_,Oe))];tH(Pe,Ke,e,t,n,r)?(V||(y.lineStart(),y.point(Pe[0],Pe[1])),y.point(Ke[0],Ke[1]),Ve||y.lineEnd(),Y=!1):Ve&&(y.lineStart(),y.point(He,Oe),Y=!1)}M=He,k=Oe,V=Ve}return K}}var AT=bd();function oH(e,t){var n=t[0],r=t[1],i=[Mo(n),-Ao(n),0],a=0,l=0;AT.reset();for(var o=0,f=e.length;o<f;++o)if(y=(p=e[o]).length)for(var p,y,x=p[y-1],w=x[0],S=x[1]/2+i3,L=Mo(S),D=Ao(S),B=0;B<y;++B,w=M,L=V,D=q,x=z){var z=p[B],M=z[0],k=z[1]/2+i3,V=Mo(k),q=Ao(k),Y=M-w,K=Y>=0?1:-1,X=K*Y,U=X>vi,le=L*V;if(AT.add(gy(le*K*Mo(X),D*q+le*Ao(X))),a+=U?Y+K*ah:Y,U^w>=n^M>=n){var ue=Zb(my(x),my(z));MI(ue);var ae=Zb(i,ue);MI(ae);var ve=(U^Y>=0?-1:1)*eg(ae[2]);(r>ve||r===ve&&(ue[0]||ue[1]))&&(l+=U^Y>=0?1:-1)}}return(a<-Hi||a<Hi&&AT<-Hi)^l&1}bd();function d3(e){return e}bd();bd();var yy=1/0,Xb=yy,M0=-yy,Wb=M0,p3={point:aH,lineStart:G_,lineEnd:G_,polygonStart:G_,polygonEnd:G_,result:function(){var e=[[yy,Xb],[M0,Wb]];return M0=Wb=-(Xb=yy=1/0),e}};function aH(e,t){e<yy&&(yy=e),e>M0&&(M0=e),t<Xb&&(Xb=t),t>Wb&&(Wb=t)}bd();function d5(e,t,n,r){return function(i,a){var l=t(a),o=i.invert(r[0],r[1]),f=u5(),p=t(f),y=!1,x,w,S,L={point:D,lineStart:z,lineEnd:M,polygonStart:function(){L.point=k,L.lineStart=V,L.lineEnd=q,w=[],x=[]},polygonEnd:function(){L.point=D,L.lineStart=z,L.lineEnd=M,w=f5(w);var Y=oH(x,o);w.length?(y||(a.polygonStart(),y=!0),c5(w,lH,Y,n,a)):Y&&(y||(a.polygonStart(),y=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),y&&(a.polygonEnd(),y=!1),w=x=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function D(Y,K){var X=i(Y,K);e(Y=X[0],K=X[1])&&a.point(Y,K)}function B(Y,K){var X=i(Y,K);l.point(X[0],X[1])}function z(){L.point=B,l.lineStart()}function M(){L.point=D,l.lineEnd()}function k(Y,K){S.push([Y,K]);var X=i(Y,K);p.point(X[0],X[1])}function V(){p.lineStart(),S=[]}function q(){k(S[0][0],S[0][1]),p.lineEnd();var Y=p.clean(),K=f.result(),X,U=K.length,le,ue,ae;if(S.pop(),x.push(S),S=null,!!U){if(Y&1){if(ue=K[0],(le=ue.length-1)>0){for(y||(a.polygonStart(),y=!0),a.lineStart(),X=0;X<le;++X)a.point((ae=ue[X])[0],ae[1]);a.lineEnd()}return}U>1&&Y&2&&K.push(K.pop().concat(K.shift())),w.push(K.filter(sH))}}return L}}function sH(e){return e.length>1}function lH(e,t){return((e=e.x)[0]<0?e[1]-Hc-Hi:Hc-e[1])-((t=t.x)[0]<0?t[1]-Hc-Hi:Hc-t[1])}const g3=d5(function(){return!0},uH,hH,[-vi,-Hc]);function uH(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(a,l){var o=a>0?vi:-vi,f=Ba(a-t);Ba(f-vi)<Hi?(e.point(t,n=(n+l)/2>0?Hc:-Hc),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),e.point(a,n),i=0):r!==o&&f>=vi&&(Ba(t-r)<Hi&&(t-=r*Hi),Ba(a-o)<Hi&&(a-=o*Hi),n=cH(t,n,a,l),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),i=0),e.point(t=a,n=l),r=o},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function cH(e,t,n,r){var i,a,l=Mo(e-n);return Ba(l)>Hi?KW((Mo(t)*(a=Ao(r))*Mo(n)-Mo(r)*(i=Ao(t))*Mo(e))/(i*a*l)):(t+r)/2}function hH(e,t,n,r){var i;if(e==null)i=n*Hc,r.point(-vi,i),r.point(0,i),r.point(vi,i),r.point(vi,0),r.point(vi,-i),r.point(0,-i),r.point(-vi,-i),r.point(-vi,0),r.point(-vi,i);else if(Ba(e[0]-t[0])>Hi){var a=e[0]<t[0]?vi:-vi;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(t[0],t[1])}function fH(e,t){var n=Ao(e),r=n>0,i=Ba(n)>Hi;function a(y,x,w,S){eH(S,e,t,w,y,x)}function l(y,x){return Ao(y)*Ao(x)>n}function o(y){var x,w,S,L,D;return{lineStart:function(){L=S=!1,D=1},point:function(B,z){var M=[B,z],k,V=l(B,z),q=r?V?0:p(B,z):V?p(B+(B<0?vi:-vi),z):0;if(!x&&(L=S=V)&&y.lineStart(),V!==S&&(k=f(x,M),(!k||pb(x,k)||pb(M,k))&&(M[0]+=Hi,M[1]+=Hi,V=l(M[0],M[1]))),V!==S)D=0,V?(y.lineStart(),k=f(M,x),y.point(k[0],k[1])):(k=f(x,M),y.point(k[0],k[1]),y.lineEnd()),x=k;else if(i&&x&&r^V){var Y;!(q&w)&&(Y=f(M,x,!0))&&(D=0,r?(y.lineStart(),y.point(Y[0][0],Y[0][1]),y.point(Y[1][0],Y[1][1]),y.lineEnd()):(y.point(Y[1][0],Y[1][1]),y.lineEnd(),y.lineStart(),y.point(Y[0][0],Y[0][1])))}V&&(!x||!pb(x,M))&&y.point(M[0],M[1]),x=M,S=V,w=q},lineEnd:function(){S&&y.lineEnd(),x=null},clean:function(){return D|(L&&S)<<1}}}function f(y,x,w){var S=my(y),L=my(x),D=[1,0,0],B=Zb(S,L),z=Kx(B,B),M=B[0],k=z-M*M;if(!k)return!w&&y;var V=n*z/k,q=-n*M/k,Y=Zb(D,B),K=Jx(D,V),X=Jx(B,q);PT(K,X);var U=Y,le=Kx(K,U),ue=Kx(U,U),ae=le*le-ue*(Kx(K,K)-1);if(!(ae<0)){var ve=My(ae),Ee=Jx(U,(-le-ve)/ue);if(PT(Ee,K),Ee=AI(Ee),!w)return Ee;var He=y[0],Oe=x[0],Ve=y[1],Pe=x[1],Ke;Oe<He&&(Ke=He,He=Oe,Oe=Ke);var Be=Oe-He,Ue=Ba(Be-vi)<Hi,lt=Ue||Be<Hi;if(!Ue&&Pe<Ve&&(Ke=Ve,Ve=Pe,Pe=Ke),lt?Ue?Ve+Pe>0^Ee[1]<(Ba(Ee[0]-He)<Hi?Ve:Pe):Ve<=Ee[1]&&Ee[1]<=Pe:Be>vi^(He<=Ee[0]&&Ee[0]<=Oe)){var xt=Jx(U,(-le+ve)/ue);return PT(xt,K),[Ee,AI(xt)]}}}function p(y,x){var w=r?e:vi-e,S=0;return y<-w?S|=1:y>w&&(S|=2),x<-w?S|=4:x>w&&(S|=8),S}return d5(l,o,a,r?[0,-e]:[-vi,e-vi])}function p5(e){return function(t){var n=new OI;for(var r in e)n[r]=e[r];return n.stream=t,n}}function OI(){}OI.prototype={constructor:OI,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function g5(e,t,n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],a=e.clipExtent&&e.clipExtent();e.scale(150).translate([0,0]),a!=null&&e.clipExtent(null),JW(n,e.stream(p3));var l=p3.result(),o=Math.min(r/(l[1][0]-l[0][0]),i/(l[1][1]-l[0][1])),f=+t[0][0]+(r-o*(l[1][0]+l[0][0]))/2,p=+t[0][1]+(i-o*(l[1][1]+l[0][1]))/2;return a!=null&&e.clipExtent(a),e.scale(o*150).translate([f,p])}function dH(e,t,n){return g5(e,[[0,0],t],n)}var m3=16,pH=Ao(30*iu);function y3(e,t){return+t?mH(e,t):gH(e)}function gH(e){return p5({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function mH(e,t){function n(r,i,a,l,o,f,p,y,x,w,S,L,D,B){var z=p-r,M=y-i,k=z*z+M*M;if(k>4*t&&D--){var V=l+w,q=o+S,Y=f+L,K=My(V*V+q*q+Y*Y),X=eg(Y/=K),U=Ba(Ba(Y)-1)<Hi||Ba(a-x)<Hi?(a+x)/2:gy(q,V),le=e(U,X),ue=le[0],ae=le[1],ve=ue-r,Ee=ae-i,He=M*ve-z*Ee;(He*He/k>t||Ba((z*ve+M*Ee)/k-.5)>.3||l*w+o*S+f*L<pH)&&(n(r,i,a,l,o,f,ue,ae,U,V/=K,q/=K,Y,D,B),B.point(ue,ae),n(ue,ae,U,V,q,Y,p,y,x,w,S,L,D,B))}}return function(r){var i,a,l,o,f,p,y,x,w,S,L,D,B={point:z,lineStart:M,lineEnd:V,polygonStart:function(){r.polygonStart(),B.lineStart=q},polygonEnd:function(){r.polygonEnd(),B.lineStart=M}};function z(X,U){X=e(X,U),r.point(X[0],X[1])}function M(){x=NaN,B.point=k,r.lineStart()}function k(X,U){var le=my([X,U]),ue=e(X,U);n(x,w,y,S,L,D,x=ue[0],w=ue[1],y=X,S=le[0],L=le[1],D=le[2],m3,r),r.point(x,w)}function V(){B.point=z,r.lineEnd()}function q(){M(),B.point=Y,B.lineEnd=K}function Y(X,U){k(i=X,U),a=x,l=w,o=S,f=L,p=D,B.point=k}function K(){n(x,w,y,S,L,D,a,l,i,o,f,p,m3,r),B.lineEnd=V,V()}return B}}var yH=p5({point:function(e,t){this.stream.point(e*iu,t*iu)}});function vH(e){return _H(function(){return e})()}function _H(e){var t,n=150,r=480,i=250,a,l,o=0,f=0,p=0,y=0,x=0,w,S,L=null,D=g3,B=null,z,M,k,V=d3,q=.5,Y=y3(ue,q),K,X;function U(Ee){return Ee=S(Ee[0]*iu,Ee[1]*iu),[Ee[0]*n+a,l-Ee[1]*n]}function le(Ee){return Ee=S.invert((Ee[0]-a)/n,(l-Ee[1])/n),Ee&&[Ee[0]*Zf,Ee[1]*Zf]}function ue(Ee,He){return Ee=t(Ee,He),[Ee[0]*n+a,l-Ee[1]*n]}U.stream=function(Ee){return K&&X===Ee?K:K=yH(D(w,Y(V(X=Ee))))},U.clipAngle=function(Ee){return arguments.length?(D=+Ee?fH(L=Ee*iu,6*iu):(L=null,g3),ve()):L*Zf},U.clipExtent=function(Ee){return arguments.length?(V=Ee==null?(B=z=M=k=null,d3):iH(B=+Ee[0][0],z=+Ee[0][1],M=+Ee[1][0],k=+Ee[1][1]),ve()):B==null?null:[[B,z],[M,k]]},U.scale=function(Ee){return arguments.length?(n=+Ee,ae()):n},U.translate=function(Ee){return arguments.length?(r=+Ee[0],i=+Ee[1],ae()):[r,i]},U.center=function(Ee){return arguments.length?(o=Ee[0]%360*iu,f=Ee[1]%360*iu,ae()):[o*Zf,f*Zf]},U.rotate=function(Ee){return arguments.length?(p=Ee[0]%360*iu,y=Ee[1]%360*iu,x=Ee.length>2?Ee[2]%360*iu:0,ae()):[p*Zf,y*Zf,x*Zf]},U.precision=function(Ee){return arguments.length?(Y=y3(ue,q=Ee*Ee),ve()):My(q)},U.fitExtent=function(Ee,He){return g5(U,Ee,He)},U.fitSize=function(Ee,He){return dH(U,Ee,He)};function ae(){S=l5(w=QW(p,y,x),t);var Ee=t(o,f);return a=r-Ee[0]*n,l=i+Ee[1]*n,ve()}function ve(){return K=X=null,U}return function(){return t=e.apply(this,arguments),U.invert=t.invert&&le,ae()}}function m5(e){return function(t,n){var r=Ao(t),i=Ao(n),a=e(r*i);return[a*i*Mo(t),a*Mo(n)]}}function y5(e){return function(t,n){var r=My(t*t+n*n),i=e(r),a=Mo(i),l=Ao(i);return[gy(t*a,r*l),eg(r&&n*a/r)]}}var xH=m5(function(e){return My(2/(1+e))});xH.invert=y5(function(e){return 2*eg(e/2)});var v5=m5(function(e){return(e=s5(e))&&e/Mo(e)});v5.invert=y5(function(e){return e});function bH(){return vH(v5).scale(79.4188).clipAngle(180-.001)}function v3(e,t){return[e,t]}v3.invert=v3;function wH(e,t,n){n=n||{};var r=n.units||"kilometers",i=n.steps||8;if(!e)throw new Error("geojson is required");if(typeof n!="object")throw new Error("options must be an object");if(typeof i!="number")throw new Error("steps must be an number");if(t===void 0)throw new Error("radius is required");if(i<=0)throw new Error("steps must be greater than 0");var a=[];switch(e.type){case"GeometryCollection":return sl(e,function(l){var o=gb(l,t,r,i);o&&a.push(o)}),An(a);case"FeatureCollection":return ti(e,function(l){var o=gb(l,t,r,i);o&&ti(o,function(f){f&&a.push(f)})}),An(a)}return gb(e,t,r,i)}function gb(e,t,n,r){var i=e.properties||{},a=e.type==="Feature"?e.geometry:e;if(a.type==="GeometryCollection"){var l=[];return sl(e,function(D){var B=gb(D,t,n,r);B&&l.push(B)}),An(l)}var o=EH(a),f={type:a.type,coordinates:x5(a.coordinates,o)},p=new N2,y=p.read(f),x=Xm(kp(t,n),"meters"),w=ia.bufferOp(y,x,r),S=new $4;if(w=S.write(w),!_5(w.coordinates)){var L={type:w.type,coordinates:b5(w.coordinates,o)};return $o(L,i)}}function _5(e){return Array.isArray(e[0])?_5(e[0]):isNaN(e[0])}function x5(e,t){return typeof e[0]!="object"?t(e):e.map(function(n){return x5(n,t)})}function b5(e,t){return typeof e[0]!="object"?t.invert(e):e.map(function(n){return b5(n,t)})}function EH(e){var t=ww(e).geometry.coordinates,n=[-t[0],-t[1]];return bH().rotate(n).scale(na)}function SH(e,t,n){n===void 0&&(n={});var r=Oi(e),i=Oi(t),a=Bh.union(r.coordinates,i.coordinates);return a.length===0?null:a.length===1?fr(a[0],n.properties):al(a,n.properties)}function L0(e,t,n){n===void 0&&(n={});var r=Oi(e),i=Oi(t),a=Bh.intersection(r.coordinates,i.coordinates);return a.length===0?null:a.length===1?fr(a[0],n.properties):al(a,n.properties)}function TH(e,t){if(t=t||{},!li(t))throw new Error("options is invalid");var n=t.propertyName;af(e,"Polygon","dissolve");var r=[];if(t.propertyName){var i={};ti(e,function(f){Object.prototype.hasOwnProperty.call(i,f.properties[n])||(i[f.properties[n]]=[]),i[f.properties[n]].push(f)});for(var a=Object.keys(i),l=0;l<a.length;l++){var o=al(Bh.union.apply(null,i[a[l]].map(function(f){return f.geometry.coordinates})));o.properties[n]=a[l],r.push(o)}}else return cI(al(Bh.union.apply(null,e.features.map(function(f){return f.geometry.coordinates}))));return cI(An(r))}function w5(e,t,n){n===void 0&&(n={});var r=JSON.stringify(n.properties||{}),i=e[0],a=e[1],l=e[2],o=e[3],f=(a+o)/2,p=(i+l)/2,y=t*2/ei([i,f],[l,f],n),x=y*(l-i),w=t*2/ei([p,a],[p,o],n),S=w*(o-a),L=x/2,D=L*2,B=Math.sqrt(3)/2*S,z=l-i,M=o-a,k=3/4*D,V=B,q=(z-D)/(D-L/2),Y=Math.floor(q),K=(Y*k-L/2-z)/2-L/2+k/2,X=Math.floor((M-B)/B),U=(M-X*B)/2,le=X*B-M>B/2;le&&(U-=B/4);for(var ue=[],ae=[],ve=0;ve<6;ve++){var Ee=2*Math.PI/6*ve;ue.push(Math.cos(Ee)),ae.push(Math.sin(Ee))}for(var He=[],Oe=0;Oe<=Y;Oe++)for(var Ve=0;Ve<=X;Ve++){var Pe=Oe%2===1;if(!(Ve===0&&Pe)&&!(Ve===0&&le)){var Ke=Oe*k+i-K,Be=Ve*V+a+U;if(Pe&&(Be-=B/2),n.triangles===!0)CH([Ke,Be],x/2,S/2,JSON.parse(r),ue,ae).forEach(function(lt){n.mask?L0(n.mask,lt)&&He.push(lt):He.push(lt)});else{var Ue=IH([Ke,Be],x/2,S/2,JSON.parse(r),ue,ae);n.mask?L0(n.mask,Ue)&&He.push(Ue):He.push(Ue)}}}return An(He)}function IH(e,t,n,r,i,a){for(var l=[],o=0;o<6;o++){var f=e[0]+t*i[o],p=e[1]+n*a[o];l.push([f,p])}return l.push(l[0].slice()),fr([l],r)}function CH(e,t,n,r,i,a){for(var l=[],o=0;o<6;o++){var f=[];f.push(e),f.push([e[0]+t*i[o],e[1]+n*a[o]]),f.push([e[0]+t*i[(o+1)%6],e[1]+n*a[(o+1)%6]]),f.push(e),l.push(fr([f],r))}return l}function PH(e,t){var n=MH(t),r=null;return e.type==="FeatureCollection"?r=AH(e):r=E5(Bh.union(e.geometry.coordinates)),r.geometry.coordinates.forEach(function(i){n.geometry.coordinates.push(i[0])}),n}function AH(e){var t=e.features.length===2?Bh.union(e.features[0].geometry.coordinates,e.features[1].geometry.coordinates):Bh.union.apply(Bh,e.features.map(function(n){return n.geometry.coordinates}));return E5(t)}function E5(e){return al(e)}function MH(e){var t=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]],n=e&&e.geometry.coordinates||t;return fr(n)}function LH(e,t,n,r){r===void 0&&(r={});for(var i=[],a=e[0],l=e[1],o=e[2],f=e[3],p=t/ei([a,l],[o,l],r),y=p*(o-a),x=n/ei([a,l],[a,f],r),w=x*(f-l),S=o-a,L=f-l,D=Math.floor(S/y),B=Math.floor(L/w),z=(S-D*y)/2,M=(L-B*w)/2,k=a+z,V=0;V<D;V++){for(var q=l+M,Y=0;Y<B;Y++){var K=fr([[[k,q],[k,q+w],[k+y,q+w],[k+y,q],[k,q]]],r.properties);r.mask?l4(r.mask,K)&&i.push(K):i.push(K),q+=w}k+=y}return An(i)}function S5(e,t,n){return n===void 0&&(n={}),LH(e,t,t,n)}function T5(e,t,n){n===void 0&&(n={});for(var r=[],i=t/ei([e[0],e[1]],[e[2],e[1]],n),a=i*(e[2]-e[0]),l=t/ei([e[0],e[1]],[e[0],e[3]],n),o=l*(e[3]-e[1]),f=0,p=e[0];p<=e[2];){for(var y=0,x=e[1];x<=e[3];){var w=null,S=null;f%2===0&&y%2===0?(w=fr([[[p,x],[p,x+o],[p+a,x],[p,x]]],n.properties),S=fr([[[p,x+o],[p+a,x+o],[p+a,x],[p,x+o]]],n.properties)):f%2===0&&y%2===1?(w=fr([[[p,x],[p+a,x+o],[p+a,x],[p,x]]],n.properties),S=fr([[[p,x],[p,x+o],[p+a,x+o],[p,x]]],n.properties)):y%2===0&&f%2===1?(w=fr([[[p,x],[p,x+o],[p+a,x+o],[p,x]]],n.properties),S=fr([[[p,x],[p+a,x+o],[p+a,x],[p,x]]],n.properties)):y%2===1&&f%2===1&&(w=fr([[[p,x],[p,x+o],[p+a,x],[p,x]]],n.properties),S=fr([[[p,x+o],[p+a,x+o],[p+a,x],[p,x+o]]],n.properties)),n.mask?(L0(n.mask,w)&&r.push(w),L0(n.mask,S)&&r.push(S)):(r.push(w),r.push(S)),x+=o,y++}f++,p+=a}return An(r)}function OH(e,t,n){if(n=n||{},typeof n!="object")throw new Error("options is invalid");var r=n.gridType,i=n.property,a=n.weight;if(!e)throw new Error("points is required");if(af(e,"Point","input must contain Points"),!t)throw new Error("cellSize is required");if(a!==void 0&&typeof a!="number")throw new Error("weight must be a number");i=i||"elevation",r=r||"square",a=a||1;var l=ao(e),o;switch(r){case"point":case"points":o=bN(l,t,n);break;case"square":case"squares":o=S5(l,t,n);break;case"hex":case"hexes":o=w5(l,t,n);break;case"triangle":case"triangles":o=T5(l,t,n);break;default:throw new Error("invalid gridType")}var f=[];return ti(o,function(p){var y=0,x=0;ti(e,function(S){var L=r==="point"?p:od(p),D=ei(L,S,n),B;if(i!==void 0&&(B=S.properties[i]),B===void 0&&(B=S.geometry.coordinates[2]),B===void 0)throw new Error("zValue is missing");D===0&&(y=B);var z=1/Math.pow(D,a);x+=z,y+=z*B});var w=Ua(p);w.properties[i]=y/x,f.push(w)}),An(f)}const DH=Object.freeze(Object.defineProperty({__proto__:null,along:d$,angle:HX,applyFilter:Ow,area:i2,areaFactors:Pb,bbox:ao,bboxClip:z$,bboxPolygon:e2,bearing:jh,bearingToAngle:Np,bearingToAzimuth:Np,bezier:xO,bezierSpline:xO,booleanClockwise:Db,booleanContains:$Z,booleanCrosses:JZ,booleanDisjoint:r4,booleanEqual:iX,booleanIntersects:l4,booleanOverlap:rX,booleanParallel:bX,booleanPointInPolygon:Li,booleanPointOnLine:el,booleanWithin:vN,buffer:wH,center:ww,centerMean:S2,centerMedian:XX,centerOfMass:lN,centroid:od,circle:t2,cleanCoords:Bp,clone:Ua,clusterEach:T2,clusterReduce:L4,clusters:uW,clustersDbscan:cX,clustersKmeans:xX,collect:fG,collectionOf:af,combine:AG,concave:iG,containsNumber:ZC,convertArea:Nk,convertDistance:Fp,convertLength:Fp,convex:Kk,coordAll:Wm,coordEach:mo,coordReduce:zC,createBins:I2,degrees2radians:oa,degreesToRadians:oa,destination:eh,difference:DW,dissolve:TH,distance:ei,distanceToDegrees:Ab,distanceToRadians:kp,distanceWeight:b4,earthRadius:na,ellipse:_4,envelope:aN,explode:Ew,factors:_w,feature:$o,featureCollection:An,featureEach:ti,featureOf:a0,featureReduce:VC,filterProperties:O4,findPoint:$k,findSegment:Gk,flatten:cI,flattenEach:xa,flattenReduce:Vk,flip:dG,geojsonType:qk,geomEach:sl,geomReduce:GC,geometry:Lk,geometryCollection:BC,getCluster:M4,getCoord:Ti,getCoords:kn,getGeom:Oi,getType:Ds,greatCircle:D$,helpers:zk,hexGrid:w5,inside:Li,interpolate:OH,intersect:L0,invariant:jV,isNumber:sa,isObject:li,isobands:fZ,isolines:r7,kinks:u$,length:uI,lengthToDegrees:Ab,lengthToRadians:kp,lineArc:TN,lineChunk:T$,lineDistance:uI,lineEach:jC,lineIntersect:sf,lineOffset:CZ,lineOverlap:QN,lineReduce:qC,lineSegment:Up,lineSlice:p$,lineSliceAlong:yN,lineSplit:R$,lineString:oi,lineStringToPolygon:FO,lineStrings:Rk,lineToPolygon:FO,mask:PH,meta:jk,midpoint:PG,moranIndex:eW,multiLineString:_d,multiPoint:G0,multiPolygon:al,nearest:Mb,nearestPoint:Mb,nearestPointOnLine:kh,nearestPointToLine:a$,planepoint:l$,point:sr,pointGrid:bN,pointOnFeature:IO,pointOnLine:kh,pointOnSurface:IO,pointToLineDistance:mN,points:Ok,pointsWithinPolygon:nI,polygon:fr,polygonSmooth:YX,polygonTangents:xq,polygonToLine:f0,polygonToLineString:f0,polygonize:FZ,polygons:Dk,projection:rW,propEach:UC,propReduce:Uk,propertiesContainsFilter:C2,radians2degrees:id,radiansToDegrees:id,radiansToDistance:Xm,radiansToLength:Xm,random:lW,randomLineString:P4,randomPoint:I4,randomPolygon:C4,randomPosition:Z0,rewind:Eq,rhumbBearing:Vp,rhumbDestination:Ym,rhumbDistance:Cw,round:kk,sample:TG,sector:vq,segmentEach:Rh,segmentReduce:$C,shortestPath:SX,simplify:vG,square:sN,squareGrid:S5,standardDeviationalEllipse:WX,tag:SG,tesselate:XG,tin:Jk,toMercator:E4,toWgs84:S4,transformRotate:e4,transformScale:t4,transformTranslate:xZ,triangleGrid:T5,truncate:wN,union:SH,unitsFactors:Mk,unkinkPolygon:O$,validateBBox:Fk,validateId:Bk,voronoi:ZX,within:nI},Symbol.toStringTag,{value:"Module"}));var q2={exports:{}},$m=typeof Reflect=="object"?Reflect:null,_3=$m&&typeof $m.apply=="function"?$m.apply:function(t,n,r){return Function.prototype.apply.call(t,n,r)},mb;$m&&typeof $m.ownKeys=="function"?mb=$m.ownKeys:Object.getOwnPropertySymbols?mb=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:mb=function(t){return Object.getOwnPropertyNames(t)};function RH(e){console&&console.warn&&console.warn(e)}var I5=Number.isNaN||function(t){return t!==t};function Vi(){Vi.init.call(this)}q2.exports=Vi;q2.exports.once=BH;Vi.EventEmitter=Vi;Vi.prototype._events=void 0;Vi.prototype._eventsCount=0;Vi.prototype._maxListeners=void 0;var x3=10;function qw(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Vi,"defaultMaxListeners",{enumerable:!0,get:function(){return x3},set:function(e){if(typeof e!="number"||e<0||I5(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");x3=e}});Vi.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Vi.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||I5(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function C5(e){return e._maxListeners===void 0?Vi.defaultMaxListeners:e._maxListeners}Vi.prototype.getMaxListeners=function(){return C5(this)};Vi.prototype.emit=function(t){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=t==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var l;if(n.length>0&&(l=n[0]),l instanceof Error)throw l;var o=new Error("Unhandled error."+(l?" ("+l.message+")":""));throw o.context=l,o}var f=a[t];if(f===void 0)return!1;if(typeof f=="function")_3(f,this,n);else for(var p=f.length,y=O5(f,p),r=0;r<p;++r)_3(y[r],this,n);return!0};function P5(e,t,n,r){var i,a,l;if(qw(n),a=e._events,a===void 0?(a=e._events=Object.create(null),e._eventsCount=0):(a.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),l=a[t]),l===void 0)l=a[t]=n,++e._eventsCount;else if(typeof l=="function"?l=a[t]=r?[n,l]:[l,n]:r?l.unshift(n):l.push(n),i=C5(e),i>0&&l.length>i&&!l.warned){l.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=l.length,RH(o)}return e}Vi.prototype.addListener=function(t,n){return P5(this,t,n,!1)};Vi.prototype.on=Vi.prototype.addListener;Vi.prototype.prependListener=function(t,n){return P5(this,t,n,!0)};function kH(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function A5(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=kH.bind(r);return i.listener=n,r.wrapFn=i,i}Vi.prototype.once=function(t,n){return qw(n),this.on(t,A5(this,t,n)),this};Vi.prototype.prependOnceListener=function(t,n){return qw(n),this.prependListener(t,A5(this,t,n)),this};Vi.prototype.removeListener=function(t,n){var r,i,a,l,o;if(qw(n),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||n));else if(typeof r!="function"){for(a=-1,l=r.length-1;l>=0;l--)if(r[l]===n||r[l].listener===n){o=r[l].listener,a=l;break}if(a<0)return this;a===0?r.shift():NH(r,a),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,o||n)}return this};Vi.prototype.off=Vi.prototype.removeListener;Vi.prototype.removeAllListeners=function(t){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var a=Object.keys(r),l;for(i=0;i<a.length;++i)l=a[i],l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(t,n[i]);return this};function M5(e,t,n){var r=e._events;if(r===void 0)return[];var i=r[t];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?FH(i):O5(i,i.length)}Vi.prototype.listeners=function(t){return M5(this,t,!0)};Vi.prototype.rawListeners=function(t){return M5(this,t,!1)};Vi.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):L5.call(e,t)};Vi.prototype.listenerCount=L5;function L5(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}Vi.prototype.eventNames=function(){return this._eventsCount>0?mb(this._events):[]};function O5(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function NH(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function FH(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function BH(e,t){return new Promise(function(n,r){function i(l){e.removeListener(t,a),r(l)}function a(){typeof e.removeListener=="function"&&e.removeListener("error",i),n([].slice.call(arguments))}D5(e,t,a,{once:!0}),t!=="error"&&zH(e,i,{once:!0})})}function zH(e,t,n){typeof e.on=="function"&&D5(e,"error",t,n)}function D5(e,t,n,r){if(typeof e.on=="function")r.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(a){r.once&&e.removeEventListener(t,i),n(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var UH=q2.exports;function sh(e){if(typeof e!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=e}typeof Symbol<"u"&&(sh.prototype[Symbol.iterator]=function(){return this});sh.of=function(){var e=arguments,t=e.length,n=0;return new sh(function(){return n>=t?{done:!0}:{done:!1,value:e[n++]}})};sh.empty=function(){var e=new sh(function(){return{done:!0}});return e};sh.fromSequence=function(e){var t=0,n=e.length;return new sh(function(){return t>=n?{done:!0}:{done:!1,value:e[t++]}})};sh.is=function(e){return e instanceof sh?!0:typeof e=="object"&&e!==null&&typeof e.next=="function"};var Zw=sh;const Iu=Vs(Zw);var Xw={};Xw.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u";Xw.SYMBOL_SUPPORT=typeof Symbol<"u";var VH=Zw,R5=Xw,GH=R5.ARRAY_BUFFER_SUPPORT,$H=R5.SYMBOL_SUPPORT;function jH(e){return typeof e=="string"||Array.isArray(e)||GH&&ArrayBuffer.isView(e)?VH.fromSequence(e):typeof e!="object"||e===null?null:$H&&typeof e[Symbol.iterator]=="function"?e[Symbol.iterator]():typeof e.next=="function"?e:null}var k5=function(t){var n=jH(t);if(!n)throw new Error("obliterator: target is not iterable nor a valid iterator.");return n},qH=k5,ZH=function(t,n){for(var r=arguments.length>1?n:1/0,i=r!==1/0?new Array(r):[],a,l=0,o=qH(t);;){if(l===r)return i;if(a=o.next(),a.done)return l!==n&&(i.length=l),i;i[l++]=a.value}};const N5=Vs(ZH);var XH=Zw,WH=k5,HH=function(){var t=arguments,n=null,r=-1;return new XH(function(){var a=null;do{if(n===null){if(r++,r>=t.length)return{done:!0};n=WH(t[r])}if(a=n.next(),a.done===!0){n=null;continue}break}while(!0);return a})};const Vh=Vs(HH);function YH(){const e=arguments[0];for(let t=1,n=arguments.length;t<n;t++)if(arguments[t])for(const r in arguments[t])e[r]=arguments[t][r];return e}let va=YH;typeof Object.assign=="function"&&(va=Object.assign);function pu(e,t,n,r){const i=e._nodes.get(t);let a=null;return i&&(r==="mixed"?a=i.out&&i.out[n]||i.undirected&&i.undirected[n]:r==="directed"?a=i.out&&i.out[n]:a=i.undirected&&i.undirected[n]),a}function Ja(e){return typeof e=="object"&&e!==null}function F5(e){let t;for(t in e)return!1;return!0}function tu(e,t,n){Object.defineProperty(e,t,{enumerable:!1,configurable:!1,writable:!0,value:n})}function ic(e,t,n){const r={enumerable:!0,configurable:!0};typeof n=="function"?r.get=n:(r.value=n,r.writable=!1),Object.defineProperty(e,t,r)}function b3(e){return!(!Ja(e)||e.attributes&&!Array.isArray(e.attributes))}function KH(){let e=Math.floor(Math.random()*256)&255;return()=>e++}class Z2 extends Error{constructor(t){super(),this.name="GraphError",this.message=t}}class mn extends Z2{constructor(t){super(t),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,mn.prototype.constructor)}}class Qt extends Z2{constructor(t){super(t),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Qt.prototype.constructor)}}class Un extends Z2{constructor(t){super(t),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Un.prototype.constructor)}}function B5(e,t){this.key=e,this.attributes=t,this.clear()}B5.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function z5(e,t){this.key=e,this.attributes=t,this.clear()}z5.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function U5(e,t){this.key=e,this.attributes=t,this.clear()}U5.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function Ly(e,t,n,r,i){this.key=t,this.attributes=i,this.undirected=e,this.source=n,this.target=r}Ly.prototype.attach=function(){let e="out",t="in";this.undirected&&(e=t="undirected");const n=this.source.key,r=this.target.key;this.source[e][r]=this,!(this.undirected&&n===r)&&(this.target[t][n]=this)};Ly.prototype.attachMulti=function(){let e="out",t="in";const n=this.source.key,r=this.target.key;this.undirected&&(e=t="undirected");const i=this.source[e],a=i[r];if(typeof a>"u"){i[r]=this,this.undirected&&n===r||(this.target[t][n]=this);return}a.previous=this,this.next=a,i[r]=this,this.target[t][n]=this};Ly.prototype.detach=function(){const e=this.source.key,t=this.target.key;let n="out",r="in";this.undirected&&(n=r="undirected"),delete this.source[n][t],delete this.target[r][e]};Ly.prototype.detachMulti=function(){const e=this.source.key,t=this.target.key;let n="out",r="in";this.undirected&&(n=r="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[n][t],delete this.target[r][e]):(this.next.previous=void 0,this.source[n][t]=this.next,this.target[r][e]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const V5=0,G5=1,JH=2,$5=3;function lf(e,t,n,r,i,a,l){let o,f,p,y;if(r=""+r,n===V5){if(o=e._nodes.get(r),!o)throw new Qt(`Graph.${t}: could not find the "${r}" node in the graph.`);p=i,y=a}else if(n===$5){if(i=""+i,f=e._edges.get(i),!f)throw new Qt(`Graph.${t}: could not find the "${i}" edge in the graph.`);const x=f.source.key,w=f.target.key;if(r===x)o=f.target;else if(r===w)o=f.source;else throw new Qt(`Graph.${t}: the "${r}" node is not attached to the "${i}" edge (${x}, ${w}).`);p=a,y=l}else{if(f=e._edges.get(r),!f)throw new Qt(`Graph.${t}: could not find the "${r}" edge in the graph.`);n===G5?o=f.source:o=f.target,p=i,y=a}return[o,p,y]}function QH(e,t,n){e.prototype[t]=function(r,i,a){const[l,o]=lf(this,t,n,r,i,a);return l.attributes[o]}}function eY(e,t,n){e.prototype[t]=function(r,i){const[a]=lf(this,t,n,r,i);return a.attributes}}function tY(e,t,n){e.prototype[t]=function(r,i,a){const[l,o]=lf(this,t,n,r,i,a);return l.attributes.hasOwnProperty(o)}}function nY(e,t,n){e.prototype[t]=function(r,i,a,l){const[o,f,p]=lf(this,t,n,r,i,a,l);return o.attributes[f]=p,this.emit("nodeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:f}),this}}function rY(e,t,n){e.prototype[t]=function(r,i,a,l){const[o,f,p]=lf(this,t,n,r,i,a,l);if(typeof p!="function")throw new mn(`Graph.${t}: updater should be a function.`);const y=o.attributes,x=p(y[f]);return y[f]=x,this.emit("nodeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:f}),this}}function iY(e,t,n){e.prototype[t]=function(r,i,a){const[l,o]=lf(this,t,n,r,i,a);return delete l.attributes[o],this.emit("nodeAttributesUpdated",{key:l.key,type:"remove",attributes:l.attributes,name:o}),this}}function oY(e,t,n){e.prototype[t]=function(r,i,a){const[l,o]=lf(this,t,n,r,i,a);if(!Ja(o))throw new mn(`Graph.${t}: provided attributes are not a plain object.`);return l.attributes=o,this.emit("nodeAttributesUpdated",{key:l.key,type:"replace",attributes:l.attributes}),this}}function aY(e,t,n){e.prototype[t]=function(r,i,a){const[l,o]=lf(this,t,n,r,i,a);if(!Ja(o))throw new mn(`Graph.${t}: provided attributes are not a plain object.`);return va(l.attributes,o),this.emit("nodeAttributesUpdated",{key:l.key,type:"merge",attributes:l.attributes,data:o}),this}}function sY(e,t,n){e.prototype[t]=function(r,i,a){const[l,o]=lf(this,t,n,r,i,a);if(typeof o!="function")throw new mn(`Graph.${t}: provided updater is not a function.`);return l.attributes=o(l.attributes),this.emit("nodeAttributesUpdated",{key:l.key,type:"update",attributes:l.attributes}),this}}const lY=[{name:e=>`get${e}Attribute`,attacher:QH},{name:e=>`get${e}Attributes`,attacher:eY},{name:e=>`has${e}Attribute`,attacher:tY},{name:e=>`set${e}Attribute`,attacher:nY},{name:e=>`update${e}Attribute`,attacher:rY},{name:e=>`remove${e}Attribute`,attacher:iY},{name:e=>`replace${e}Attributes`,attacher:oY},{name:e=>`merge${e}Attributes`,attacher:aY},{name:e=>`update${e}Attributes`,attacher:sY}];function uY(e){lY.forEach(function({name:t,attacher:n}){n(e,t("Node"),V5),n(e,t("Source"),G5),n(e,t("Target"),JH),n(e,t("Opposite"),$5)})}function cY(e,t,n){e.prototype[t]=function(r,i){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Un(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Un(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const l=""+r,o=""+i;if(i=arguments[2],a=pu(this,l,o,n),!a)throw new Qt(`Graph.${t}: could not find an edge for the given path ("${l}" - "${o}").`)}else{if(n!=="mixed")throw new Un(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new Qt(`Graph.${t}: could not find the "${r}" edge in the graph.`)}return a.attributes[i]}}function hY(e,t,n){e.prototype[t]=function(r){let i;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Un(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new Un(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,l=""+arguments[1];if(i=pu(this,a,l,n),!i)throw new Qt(`Graph.${t}: could not find an edge for the given path ("${a}" - "${l}").`)}else{if(n!=="mixed")throw new Un(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,i=this._edges.get(r),!i)throw new Qt(`Graph.${t}: could not find the "${r}" edge in the graph.`)}return i.attributes}}function fY(e,t,n){e.prototype[t]=function(r,i){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Un(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Un(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const l=""+r,o=""+i;if(i=arguments[2],a=pu(this,l,o,n),!a)throw new Qt(`Graph.${t}: could not find an edge for the given path ("${l}" - "${o}").`)}else{if(n!=="mixed")throw new Un(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new Qt(`Graph.${t}: could not find the "${r}" edge in the graph.`)}return a.attributes.hasOwnProperty(i)}}function dY(e,t,n){e.prototype[t]=function(r,i,a){let l;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Un(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Un(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,f=""+i;if(i=arguments[2],a=arguments[3],l=pu(this,o,f,n),!l)throw new Qt(`Graph.${t}: could not find an edge for the given path ("${o}" - "${f}").`)}else{if(n!=="mixed")throw new Un(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,l=this._edges.get(r),!l)throw new Qt(`Graph.${t}: could not find the "${r}" edge in the graph.`)}return l.attributes[i]=a,this.emit("edgeAttributesUpdated",{key:l.key,type:"set",attributes:l.attributes,name:i}),this}}function pY(e,t,n){e.prototype[t]=function(r,i,a){let l;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Un(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Un(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,f=""+i;if(i=arguments[2],a=arguments[3],l=pu(this,o,f,n),!l)throw new Qt(`Graph.${t}: could not find an edge for the given path ("${o}" - "${f}").`)}else{if(n!=="mixed")throw new Un(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,l=this._edges.get(r),!l)throw new Qt(`Graph.${t}: could not find the "${r}" edge in the graph.`)}if(typeof a!="function")throw new mn(`Graph.${t}: updater should be a function.`);return l.attributes[i]=a(l.attributes[i]),this.emit("edgeAttributesUpdated",{key:l.key,type:"set",attributes:l.attributes,name:i}),this}}function gY(e,t,n){e.prototype[t]=function(r,i){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Un(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Un(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const l=""+r,o=""+i;if(i=arguments[2],a=pu(this,l,o,n),!a)throw new Qt(`Graph.${t}: could not find an edge for the given path ("${l}" - "${o}").`)}else{if(n!=="mixed")throw new Un(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new Qt(`Graph.${t}: could not find the "${r}" edge in the graph.`)}return delete a.attributes[i],this.emit("edgeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:i}),this}}function mY(e,t,n){e.prototype[t]=function(r,i){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Un(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Un(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const l=""+r,o=""+i;if(i=arguments[2],a=pu(this,l,o,n),!a)throw new Qt(`Graph.${t}: could not find an edge for the given path ("${l}" - "${o}").`)}else{if(n!=="mixed")throw new Un(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new Qt(`Graph.${t}: could not find the "${r}" edge in the graph.`)}if(!Ja(i))throw new mn(`Graph.${t}: provided attributes are not a plain object.`);return a.attributes=i,this.emit("edgeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function yY(e,t,n){e.prototype[t]=function(r,i){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Un(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Un(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const l=""+r,o=""+i;if(i=arguments[2],a=pu(this,l,o,n),!a)throw new Qt(`Graph.${t}: could not find an edge for the given path ("${l}" - "${o}").`)}else{if(n!=="mixed")throw new Un(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new Qt(`Graph.${t}: could not find the "${r}" edge in the graph.`)}if(!Ja(i))throw new mn(`Graph.${t}: provided attributes are not a plain object.`);return va(a.attributes,i),this.emit("edgeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:i}),this}}function vY(e,t,n){e.prototype[t]=function(r,i){let a;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Un(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Un(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const l=""+r,o=""+i;if(i=arguments[2],a=pu(this,l,o,n),!a)throw new Qt(`Graph.${t}: could not find an edge for the given path ("${l}" - "${o}").`)}else{if(n!=="mixed")throw new Un(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new Qt(`Graph.${t}: could not find the "${r}" edge in the graph.`)}if(typeof i!="function")throw new mn(`Graph.${t}: provided updater is not a function.`);return a.attributes=i(a.attributes),this.emit("edgeAttributesUpdated",{key:a.key,type:"update",attributes:a.attributes}),this}}const _Y=[{name:e=>`get${e}Attribute`,attacher:cY},{name:e=>`get${e}Attributes`,attacher:hY},{name:e=>`has${e}Attribute`,attacher:fY},{name:e=>`set${e}Attribute`,attacher:dY},{name:e=>`update${e}Attribute`,attacher:pY},{name:e=>`remove${e}Attribute`,attacher:gY},{name:e=>`replace${e}Attributes`,attacher:mY},{name:e=>`merge${e}Attributes`,attacher:yY},{name:e=>`update${e}Attributes`,attacher:vY}];function xY(e){_Y.forEach(function({name:t,attacher:n}){n(e,t("Edge"),"mixed"),n(e,t("DirectedEdge"),"directed"),n(e,t("UndirectedEdge"),"undirected")})}const bY=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function wY(e,t,n,r){let i=!1;for(const a in t){if(a===r)continue;const l=t[a];if(i=n(l.key,l.attributes,l.source.key,l.target.key,l.source.attributes,l.target.attributes,l.undirected),e&&i)return l.key}}function EY(e,t,n,r){let i,a,l,o=!1;for(const f in t)if(f!==r){i=t[f];do{if(a=i.source,l=i.target,o=n(i.key,i.attributes,a.key,l.key,a.attributes,l.attributes,i.undirected),e&&o)return i.key;i=i.next}while(i!==void 0)}}function MT(e,t){const n=Object.keys(e),r=n.length;let i,a=0;return new Iu(function(){do if(i)i=i.next;else{if(a>=r)return{done:!0};const o=n[a++];if(o===t){i=void 0;continue}i=e[o]}while(!i);return{done:!1,value:{edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.attributes,undirected:i.undirected}}})}function SY(e,t,n,r){const i=t[n];if(!i)return;const a=i.source,l=i.target;if(r(i.key,i.attributes,a.key,l.key,a.attributes,l.attributes,i.undirected)&&e)return i.key}function TY(e,t,n,r){let i=t[n];if(!i)return;let a=!1;do{if(a=r(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected),e&&a)return i.key;i=i.next}while(i!==void 0)}function LT(e,t){let n=e[t];return n.next!==void 0?new Iu(function(){if(!n)return{done:!0};const r={edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected};return n=n.next,{done:!1,value:r}}):Iu.of({edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected})}function IY(e,t){if(e.size===0)return[];if(t==="mixed"||t===e.type)return typeof Array.from=="function"?Array.from(e._edges.keys()):N5(e._edges.keys(),e._edges.size);const n=t==="undirected"?e.undirectedSize:e.directedSize,r=new Array(n),i=t==="undirected",a=e._edges.values();let l=0,o,f;for(;o=a.next(),o.done!==!0;)f=o.value,f.undirected===i&&(r[l++]=f.key);return r}function j5(e,t,n,r){if(t.size===0)return;const i=n!=="mixed"&&n!==t.type,a=n==="undirected";let l,o,f=!1;const p=t._edges.values();for(;l=p.next(),l.done!==!0;){if(o=l.value,i&&o.undirected!==a)continue;const{key:y,attributes:x,source:w,target:S}=o;if(f=r(y,x,w.key,S.key,w.attributes,S.attributes,o.undirected),e&&f)return y}}function CY(e,t){if(e.size===0)return Iu.empty();const n=t!=="mixed"&&t!==e.type,r=t==="undirected",i=e._edges.values();return new Iu(function(){let l,o;for(;;){if(l=i.next(),l.done)return l;if(o=l.value,!(n&&o.undirected!==r))break}return{value:{edge:o.key,attributes:o.attributes,source:o.source.key,target:o.target.key,sourceAttributes:o.source.attributes,targetAttributes:o.target.attributes,undirected:o.undirected},done:!1}})}function X2(e,t,n,r,i,a){const l=t?EY:wY;let o;if(n!=="undirected"&&(r!=="out"&&(o=l(e,i.in,a),e&&o)||r!=="in"&&(o=l(e,i.out,a,r?void 0:i.key),e&&o))||n!=="directed"&&(o=l(e,i.undirected,a),e&&o))return o}function PY(e,t,n,r){const i=[];return X2(!1,e,t,n,r,function(a){i.push(a)}),i}function AY(e,t,n){let r=Iu.empty();return e!=="undirected"&&(t!=="out"&&typeof n.in<"u"&&(r=Vh(r,MT(n.in))),t!=="in"&&typeof n.out<"u"&&(r=Vh(r,MT(n.out,t?void 0:n.key)))),e!=="directed"&&typeof n.undirected<"u"&&(r=Vh(r,MT(n.undirected))),r}function W2(e,t,n,r,i,a,l){const o=n?TY:SY;let f;if(t!=="undirected"&&(typeof i.in<"u"&&r!=="out"&&(f=o(e,i.in,a,l),e&&f)||typeof i.out<"u"&&r!=="in"&&(r||i.key!==a)&&(f=o(e,i.out,a,l),e&&f))||t!=="directed"&&typeof i.undirected<"u"&&(f=o(e,i.undirected,a,l),e&&f))return f}function MY(e,t,n,r,i){const a=[];return W2(!1,e,t,n,r,i,function(l){a.push(l)}),a}function LY(e,t,n,r){let i=Iu.empty();return e!=="undirected"&&(typeof n.in<"u"&&t!=="out"&&r in n.in&&(i=Vh(i,LT(n.in,r))),typeof n.out<"u"&&t!=="in"&&r in n.out&&(t||n.key!==r)&&(i=Vh(i,LT(n.out,r)))),e!=="directed"&&typeof n.undirected<"u"&&r in n.undirected&&(i=Vh(i,LT(n.undirected,r))),i}function OY(e,t){const{name:n,type:r,direction:i}=t;e.prototype[n]=function(a,l){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];if(!arguments.length)return IY(this,r);if(arguments.length===1){a=""+a;const o=this._nodes.get(a);if(typeof o>"u")throw new Qt(`Graph.${n}: could not find the "${a}" node in the graph.`);return PY(this.multi,r==="mixed"?this.type:r,i,o)}if(arguments.length===2){a=""+a,l=""+l;const o=this._nodes.get(a);if(!o)throw new Qt(`Graph.${n}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(l))throw new Qt(`Graph.${n}:  could not find the "${l}" target node in the graph.`);return MY(r,this.multi,i,o,l)}throw new mn(`Graph.${n}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function DY(e,t){const{name:n,type:r,direction:i}=t,a="forEach"+n[0].toUpperCase()+n.slice(1,-1);e.prototype[a]=function(p,y,x){if(!(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)){if(arguments.length===1)return x=p,j5(!1,this,r,x);if(arguments.length===2){p=""+p,x=y;const w=this._nodes.get(p);if(typeof w>"u")throw new Qt(`Graph.${a}: could not find the "${p}" node in the graph.`);return X2(!1,this.multi,r==="mixed"?this.type:r,i,w,x)}if(arguments.length===3){p=""+p,y=""+y;const w=this._nodes.get(p);if(!w)throw new Qt(`Graph.${a}:  could not find the "${p}" source node in the graph.`);if(!this._nodes.has(y))throw new Qt(`Graph.${a}:  could not find the "${y}" target node in the graph.`);return W2(!1,r,this.multi,i,w,y,x)}throw new mn(`Graph.${a}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const l="map"+n[0].toUpperCase()+n.slice(1);e.prototype[l]=function(){const p=Array.prototype.slice.call(arguments),y=p.pop();let x;if(p.length===0){let w=0;r!=="directed"&&(w+=this.undirectedSize),r!=="undirected"&&(w+=this.directedSize),x=new Array(w);let S=0;p.push((L,D,B,z,M,k,V)=>{x[S++]=y(L,D,B,z,M,k,V)})}else x=[],p.push((w,S,L,D,B,z,M)=>{x.push(y(w,S,L,D,B,z,M))});return this[a].apply(this,p),x};const o="filter"+n[0].toUpperCase()+n.slice(1);e.prototype[o]=function(){const p=Array.prototype.slice.call(arguments),y=p.pop(),x=[];return p.push((w,S,L,D,B,z,M)=>{y(w,S,L,D,B,z,M)&&x.push(w)}),this[a].apply(this,p),x};const f="reduce"+n[0].toUpperCase()+n.slice(1);e.prototype[f]=function(){let p=Array.prototype.slice.call(arguments);if(p.length<2||p.length>4)throw new mn(`Graph.${f}: invalid number of arguments (expecting 2, 3 or 4 and got ${p.length}).`);if(typeof p[p.length-1]=="function"&&typeof p[p.length-2]!="function")throw new mn(`Graph.${f}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let y,x;p.length===2?(y=p[0],x=p[1],p=[]):p.length===3?(y=p[1],x=p[2],p=[p[0]]):p.length===4&&(y=p[2],x=p[3],p=[p[0],p[1]]);let w=x;return p.push((S,L,D,B,z,M,k)=>{w=y(w,S,L,D,B,z,M,k)}),this[a].apply(this,p),w}}function RY(e,t){const{name:n,type:r,direction:i}=t,a="find"+n[0].toUpperCase()+n.slice(1,-1);e.prototype[a]=function(f,p,y){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return!1;if(arguments.length===1)return y=f,j5(!0,this,r,y);if(arguments.length===2){f=""+f,y=p;const x=this._nodes.get(f);if(typeof x>"u")throw new Qt(`Graph.${a}: could not find the "${f}" node in the graph.`);return X2(!0,this.multi,r==="mixed"?this.type:r,i,x,y)}if(arguments.length===3){f=""+f,p=""+p;const x=this._nodes.get(f);if(!x)throw new Qt(`Graph.${a}:  could not find the "${f}" source node in the graph.`);if(!this._nodes.has(p))throw new Qt(`Graph.${a}:  could not find the "${p}" target node in the graph.`);return W2(!0,r,this.multi,i,x,p,y)}throw new mn(`Graph.${a}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const l="some"+n[0].toUpperCase()+n.slice(1,-1);e.prototype[l]=function(){const f=Array.prototype.slice.call(arguments),p=f.pop();return f.push((x,w,S,L,D,B,z)=>p(x,w,S,L,D,B,z)),!!this[a].apply(this,f)};const o="every"+n[0].toUpperCase()+n.slice(1,-1);e.prototype[o]=function(){const f=Array.prototype.slice.call(arguments),p=f.pop();return f.push((x,w,S,L,D,B,z)=>!p(x,w,S,L,D,B,z)),!this[a].apply(this,f)}}function kY(e,t){const{name:n,type:r,direction:i}=t,a=n.slice(0,-1)+"Entries";e.prototype[a]=function(l,o){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return Iu.empty();if(!arguments.length)return CY(this,r);if(arguments.length===1){l=""+l;const f=this._nodes.get(l);if(!f)throw new Qt(`Graph.${a}: could not find the "${l}" node in the graph.`);return AY(r,i,f)}if(arguments.length===2){l=""+l,o=""+o;const f=this._nodes.get(l);if(!f)throw new Qt(`Graph.${a}:  could not find the "${l}" source node in the graph.`);if(!this._nodes.has(o))throw new Qt(`Graph.${a}:  could not find the "${o}" target node in the graph.`);return LY(r,i,f,o)}throw new mn(`Graph.${a}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function NY(e){bY.forEach(t=>{OY(e,t),DY(e,t),RY(e,t),kY(e,t)})}const FY=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function Ww(){this.A=null,this.B=null}Ww.prototype.wrap=function(e){this.A===null?this.A=e:this.B===null&&(this.B=e)};Ww.prototype.has=function(e){return this.A!==null&&e in this.A||this.B!==null&&e in this.B};function M_(e,t,n,r,i){for(const a in r){const l=r[a],o=l.source,f=l.target,p=o===n?f:o;if(t&&t.has(p.key))continue;const y=i(p.key,p.attributes);if(e&&y)return p.key}}function H2(e,t,n,r,i){if(t!=="mixed"){if(t==="undirected")return M_(e,null,r,r.undirected,i);if(typeof n=="string")return M_(e,null,r,r[n],i)}const a=new Ww;let l;if(t!=="undirected"){if(n!=="out"){if(l=M_(e,null,r,r.in,i),e&&l)return l;a.wrap(r.in)}if(n!=="in"){if(l=M_(e,a,r,r.out,i),e&&l)return l;a.wrap(r.out)}}if(t!=="directed"&&(l=M_(e,a,r,r.undirected,i),e&&l))return l}function BY(e,t,n){if(e!=="mixed"){if(e==="undirected")return Object.keys(n.undirected);if(typeof t=="string")return Object.keys(n[t])}const r=[];return H2(!1,e,t,n,function(i){r.push(i)}),r}function L_(e,t,n){const r=Object.keys(n),i=r.length;let a=0;return new Iu(function(){let o=null;do{if(a>=i)return e&&e.wrap(n),{done:!0};const f=n[r[a++]],p=f.source,y=f.target;if(o=p===t?y:p,e&&e.has(o.key)){o=null;continue}}while(o===null);return{done:!1,value:{neighbor:o.key,attributes:o.attributes}}})}function zY(e,t,n){if(e!=="mixed"){if(e==="undirected")return L_(null,n,n.undirected);if(typeof t=="string")return L_(null,n,n[t])}let r=Iu.empty();const i=new Ww;return e!=="undirected"&&(t!=="out"&&(r=Vh(r,L_(i,n,n.in))),t!=="in"&&(r=Vh(r,L_(i,n,n.out)))),e!=="directed"&&(r=Vh(r,L_(i,n,n.undirected))),r}function UY(e,t){const{name:n,type:r,direction:i}=t;e.prototype[n]=function(a){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];a=""+a;const l=this._nodes.get(a);if(typeof l>"u")throw new Qt(`Graph.${n}: could not find the "${a}" node in the graph.`);return BY(r==="mixed"?this.type:r,i,l)}}function VY(e,t){const{name:n,type:r,direction:i}=t,a="forEach"+n[0].toUpperCase()+n.slice(1,-1);e.prototype[a]=function(p,y){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;p=""+p;const x=this._nodes.get(p);if(typeof x>"u")throw new Qt(`Graph.${a}: could not find the "${p}" node in the graph.`);H2(!1,r==="mixed"?this.type:r,i,x,y)};const l="map"+n[0].toUpperCase()+n.slice(1);e.prototype[l]=function(p,y){const x=[];return this[a](p,(w,S)=>{x.push(y(w,S))}),x};const o="filter"+n[0].toUpperCase()+n.slice(1);e.prototype[o]=function(p,y){const x=[];return this[a](p,(w,S)=>{y(w,S)&&x.push(w)}),x};const f="reduce"+n[0].toUpperCase()+n.slice(1);e.prototype[f]=function(p,y,x){if(arguments.length<3)throw new mn(`Graph.${f}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let w=x;return this[a](p,(S,L)=>{w=y(w,S,L)}),w}}function GY(e,t){const{name:n,type:r,direction:i}=t,a=n[0].toUpperCase()+n.slice(1,-1),l="find"+a;e.prototype[l]=function(p,y){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;p=""+p;const x=this._nodes.get(p);if(typeof x>"u")throw new Qt(`Graph.${l}: could not find the "${p}" node in the graph.`);return H2(!0,r==="mixed"?this.type:r,i,x,y)};const o="some"+a;e.prototype[o]=function(p,y){return!!this[l](p,y)};const f="every"+a;e.prototype[f]=function(p,y){return!this[l](p,(w,S)=>!y(w,S))}}function $Y(e,t){const{name:n,type:r,direction:i}=t,a=n.slice(0,-1)+"Entries";e.prototype[a]=function(l){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return Iu.empty();l=""+l;const o=this._nodes.get(l);if(typeof o>"u")throw new Qt(`Graph.${a}: could not find the "${l}" node in the graph.`);return zY(r==="mixed"?this.type:r,i,o)}}function jY(e){FY.forEach(t=>{UY(e,t),VY(e,t),GY(e,t),$Y(e,t)})}function tb(e,t,n,r,i){const a=r._nodes.values(),l=r.type;let o,f,p,y,x,w,S;for(;o=a.next(),o.done!==!0;){let L=!1;if(f=o.value,l!=="undirected"){y=f.out;for(p in y){x=y[p];do{if(w=x.target,L=!0,S=i(f.key,w.key,f.attributes,w.attributes,x.key,x.attributes,x.undirected),e&&S)return x;x=x.next}while(x)}}if(l!=="directed"){y=f.undirected;for(p in y)if(!(t&&f.key>p)){x=y[p];do{if(w=x.target,w.key!==p&&(w=x.source),L=!0,S=i(f.key,w.key,f.attributes,w.attributes,x.key,x.attributes,x.undirected),e&&S)return x;x=x.next}while(x)}}if(n&&!L&&(S=i(f.key,null,f.attributes,null,null,null,null),e&&S))return null}}function qY(e,t){const n={key:e};return F5(t.attributes)||(n.attributes=va({},t.attributes)),n}function ZY(e,t,n){const r={key:t,source:n.source.key,target:n.target.key};return F5(n.attributes)||(r.attributes=va({},n.attributes)),e==="mixed"&&n.undirected&&(r.undirected=!0),r}function XY(e){if(!Ja(e))throw new mn('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in e))throw new mn("Graph.import: serialized node is missing its key.");if("attributes"in e&&(!Ja(e.attributes)||e.attributes===null))throw new mn("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function WY(e){if(!Ja(e))throw new mn('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in e))throw new mn("Graph.import: serialized edge is missing its source.");if(!("target"in e))throw new mn("Graph.import: serialized edge is missing its target.");if("attributes"in e&&(!Ja(e.attributes)||e.attributes===null))throw new mn("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in e&&typeof e.undirected!="boolean")throw new mn("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const HY=KH(),YY=new Set(["directed","undirected","mixed"]),w3=new Set(["domain","_events","_eventsCount","_maxListeners"]),KY=[{name:e=>`${e}Edge`,generateKey:!0},{name:e=>`${e}DirectedEdge`,generateKey:!0,type:"directed"},{name:e=>`${e}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:e=>`${e}EdgeWithKey`},{name:e=>`${e}DirectedEdgeWithKey`,type:"directed"},{name:e=>`${e}UndirectedEdgeWithKey`,type:"undirected"}],JY={allowSelfLoops:!0,multi:!1,type:"mixed"};function QY(e,t,n){if(n&&!Ja(n))throw new mn(`Graph.addNode: invalid attributes. Expecting an object but got "${n}"`);if(t=""+t,n=n||{},e._nodes.has(t))throw new Un(`Graph.addNode: the "${t}" node already exist in the graph.`);const r=new e.NodeDataClass(t,n);return e._nodes.set(t,r),e.emit("nodeAdded",{key:t,attributes:n}),r}function E3(e,t,n){const r=new e.NodeDataClass(t,n);return e._nodes.set(t,r),e.emit("nodeAdded",{key:t,attributes:n}),r}function q5(e,t,n,r,i,a,l,o){if(!r&&e.type==="undirected")throw new Un(`Graph.${t}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(r&&e.type==="directed")throw new Un(`Graph.${t}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(o&&!Ja(o))throw new mn(`Graph.${t}: invalid attributes. Expecting an object but got "${o}"`);if(a=""+a,l=""+l,o=o||{},!e.allowSelfLoops&&a===l)throw new Un(`Graph.${t}: source & target are the same ("${a}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const f=e._nodes.get(a),p=e._nodes.get(l);if(!f)throw new Qt(`Graph.${t}: source node "${a}" not found.`);if(!p)throw new Qt(`Graph.${t}: target node "${l}" not found.`);const y={key:null,undirected:r,source:a,target:l,attributes:o};if(n)i=e._edgeKeyGenerator();else if(i=""+i,e._edges.has(i))throw new Un(`Graph.${t}: the "${i}" edge already exists in the graph.`);if(!e.multi&&(r?typeof f.undirected[l]<"u":typeof f.out[l]<"u"))throw new Un(`Graph.${t}: an edge linking "${a}" to "${l}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const x=new Ly(r,i,f,p,o);e._edges.set(i,x);const w=a===l;return r?(f.undirectedDegree++,p.undirectedDegree++,w&&(f.undirectedLoops++,e._undirectedSelfLoopCount++)):(f.outDegree++,p.inDegree++,w&&(f.directedLoops++,e._directedSelfLoopCount++)),e.multi?x.attachMulti():x.attach(),r?e._undirectedSize++:e._directedSize++,y.key=i,e.emit("edgeAdded",y),i}function eK(e,t,n,r,i,a,l,o,f){if(!r&&e.type==="undirected")throw new Un(`Graph.${t}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(r&&e.type==="directed")throw new Un(`Graph.${t}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(o){if(f){if(typeof o!="function")throw new mn(`Graph.${t}: invalid updater function. Expecting a function but got "${o}"`)}else if(!Ja(o))throw new mn(`Graph.${t}: invalid attributes. Expecting an object but got "${o}"`)}a=""+a,l=""+l;let p;if(f&&(p=o,o=void 0),!e.allowSelfLoops&&a===l)throw new Un(`Graph.${t}: source & target are the same ("${a}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let y=e._nodes.get(a),x=e._nodes.get(l),w,S;if(!n&&(w=e._edges.get(i),w)){if((w.source.key!==a||w.target.key!==l)&&(!r||w.source.key!==l||w.target.key!==a))throw new Un(`Graph.${t}: inconsistency detected when attempting to merge the "${i}" edge with "${a}" source & "${l}" target vs. ("${w.source.key}", "${w.target.key}").`);S=w}if(!S&&!e.multi&&y&&(S=r?y.undirected[l]:y.out[l]),S){const M=[S.key,!1,!1,!1];if(f?!p:!o)return M;if(f){const k=S.attributes;S.attributes=p(k),e.emit("edgeAttributesUpdated",{type:"replace",key:S.key,attributes:S.attributes})}else va(S.attributes,o),e.emit("edgeAttributesUpdated",{type:"merge",key:S.key,attributes:S.attributes,data:o});return M}o=o||{},f&&p&&(o=p(o));const L={key:null,undirected:r,source:a,target:l,attributes:o};if(n)i=e._edgeKeyGenerator();else if(i=""+i,e._edges.has(i))throw new Un(`Graph.${t}: the "${i}" edge already exists in the graph.`);let D=!1,B=!1;y||(y=E3(e,a,{}),D=!0,a===l&&(x=y,B=!0)),x||(x=E3(e,l,{}),B=!0),w=new Ly(r,i,y,x,o),e._edges.set(i,w);const z=a===l;return r?(y.undirectedDegree++,x.undirectedDegree++,z&&(y.undirectedLoops++,e._undirectedSelfLoopCount++)):(y.outDegree++,x.inDegree++,z&&(y.directedLoops++,e._directedSelfLoopCount++)),e.multi?w.attachMulti():w.attach(),r?e._undirectedSize++:e._directedSize++,L.key=i,e.emit("edgeAdded",L),[i,!0,D,B]}function bm(e,t){e._edges.delete(t.key);const{source:n,target:r,attributes:i}=t,a=t.undirected,l=n===r;a?(n.undirectedDegree--,r.undirectedDegree--,l&&(n.undirectedLoops--,e._undirectedSelfLoopCount--)):(n.outDegree--,r.inDegree--,l&&(n.directedLoops--,e._directedSelfLoopCount--)),e.multi?t.detachMulti():t.detach(),a?e._undirectedSize--:e._directedSize--,e.emit("edgeDropped",{key:t.key,attributes:i,source:n.key,target:r.key,undirected:a})}class Gi extends UH.EventEmitter{constructor(t){if(super(),t=va({},JY,t),typeof t.multi!="boolean")throw new mn(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${t.multi}".`);if(!YY.has(t.type))throw new mn(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${t.type}".`);if(typeof t.allowSelfLoops!="boolean")throw new mn(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${t.allowSelfLoops}".`);const n=t.type==="mixed"?B5:t.type==="directed"?z5:U5;tu(this,"NodeDataClass",n);const r="geid_"+HY()+"_";let i=0;const a=()=>{let l;do l=r+i++;while(this._edges.has(l));return l};tu(this,"_attributes",{}),tu(this,"_nodes",new Map),tu(this,"_edges",new Map),tu(this,"_directedSize",0),tu(this,"_undirectedSize",0),tu(this,"_directedSelfLoopCount",0),tu(this,"_undirectedSelfLoopCount",0),tu(this,"_edgeKeyGenerator",a),tu(this,"_options",t),w3.forEach(l=>tu(this,l,this[l])),ic(this,"order",()=>this._nodes.size),ic(this,"size",()=>this._edges.size),ic(this,"directedSize",()=>this._directedSize),ic(this,"undirectedSize",()=>this._undirectedSize),ic(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),ic(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),ic(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),ic(this,"multi",this._options.multi),ic(this,"type",this._options.type),ic(this,"allowSelfLoops",this._options.allowSelfLoops),ic(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(t){return this._nodes.has(""+t)}hasDirectedEdge(t,n){if(this.type==="undirected")return!1;if(arguments.length===1){const r=""+t,i=this._edges.get(r);return!!i&&!i.undirected}else if(arguments.length===2){t=""+t,n=""+n;const r=this._nodes.get(t);return r?r.out.hasOwnProperty(n):!1}throw new mn(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(t,n){if(this.type==="directed")return!1;if(arguments.length===1){const r=""+t,i=this._edges.get(r);return!!i&&i.undirected}else if(arguments.length===2){t=""+t,n=""+n;const r=this._nodes.get(t);return r?r.undirected.hasOwnProperty(n):!1}throw new mn(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(t,n){if(arguments.length===1){const r=""+t;return this._edges.has(r)}else if(arguments.length===2){t=""+t,n=""+n;const r=this._nodes.get(t);return r?typeof r.out<"u"&&r.out.hasOwnProperty(n)||typeof r.undirected<"u"&&r.undirected.hasOwnProperty(n):!1}throw new mn(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(t,n){if(this.type==="undirected")return;if(t=""+t,n=""+n,this.multi)throw new Un("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const r=this._nodes.get(t);if(!r)throw new Qt(`Graph.directedEdge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(n))throw new Qt(`Graph.directedEdge: could not find the "${n}" target node in the graph.`);const i=r.out&&r.out[n]||void 0;if(i)return i.key}undirectedEdge(t,n){if(this.type==="directed")return;if(t=""+t,n=""+n,this.multi)throw new Un("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const r=this._nodes.get(t);if(!r)throw new Qt(`Graph.undirectedEdge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(n))throw new Qt(`Graph.undirectedEdge: could not find the "${n}" target node in the graph.`);const i=r.undirected&&r.undirected[n]||void 0;if(i)return i.key}edge(t,n){if(this.multi)throw new Un("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");t=""+t,n=""+n;const r=this._nodes.get(t);if(!r)throw new Qt(`Graph.edge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(n))throw new Qt(`Graph.edge: could not find the "${n}" target node in the graph.`);const i=r.out&&r.out[n]||r.undirected&&r.undirected[n]||void 0;if(i)return i.key}areDirectedNeighbors(t,n){t=""+t,n=""+n;const r=this._nodes.get(t);if(!r)throw new Qt(`Graph.areDirectedNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:n in r.in||n in r.out}areOutNeighbors(t,n){t=""+t,n=""+n;const r=this._nodes.get(t);if(!r)throw new Qt(`Graph.areOutNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:n in r.out}areInNeighbors(t,n){t=""+t,n=""+n;const r=this._nodes.get(t);if(!r)throw new Qt(`Graph.areInNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:n in r.in}areUndirectedNeighbors(t,n){t=""+t,n=""+n;const r=this._nodes.get(t);if(!r)throw new Qt(`Graph.areUndirectedNeighbors: could not find the "${t}" node in the graph.`);return this.type==="directed"?!1:n in r.undirected}areNeighbors(t,n){t=""+t,n=""+n;const r=this._nodes.get(t);if(!r)throw new Qt(`Graph.areNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&(n in r.in||n in r.out)||this.type!=="directed"&&n in r.undirected}areInboundNeighbors(t,n){t=""+t,n=""+n;const r=this._nodes.get(t);if(!r)throw new Qt(`Graph.areInboundNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&n in r.in||this.type!=="directed"&&n in r.undirected}areOutboundNeighbors(t,n){t=""+t,n=""+n;const r=this._nodes.get(t);if(!r)throw new Qt(`Graph.areOutboundNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&n in r.out||this.type!=="directed"&&n in r.undirected}inDegree(t){t=""+t;const n=this._nodes.get(t);if(!n)throw new Qt(`Graph.inDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:n.inDegree}outDegree(t){t=""+t;const n=this._nodes.get(t);if(!n)throw new Qt(`Graph.outDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:n.outDegree}directedDegree(t){t=""+t;const n=this._nodes.get(t);if(!n)throw new Qt(`Graph.directedDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree}undirectedDegree(t){t=""+t;const n=this._nodes.get(t);if(!n)throw new Qt(`Graph.undirectedDegree: could not find the "${t}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree}inboundDegree(t){t=""+t;const n=this._nodes.get(t);if(!n)throw new Qt(`Graph.inboundDegree: could not find the "${t}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=n.undirectedDegree),this.type!=="undirected"&&(r+=n.inDegree),r}outboundDegree(t){t=""+t;const n=this._nodes.get(t);if(!n)throw new Qt(`Graph.outboundDegree: could not find the "${t}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=n.undirectedDegree),this.type!=="undirected"&&(r+=n.outDegree),r}degree(t){t=""+t;const n=this._nodes.get(t);if(!n)throw new Qt(`Graph.degree: could not find the "${t}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=n.undirectedDegree),this.type!=="undirected"&&(r+=n.inDegree+n.outDegree),r}inDegreeWithoutSelfLoops(t){t=""+t;const n=this._nodes.get(t);if(!n)throw new Qt(`Graph.inDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:n.inDegree-n.directedLoops}outDegreeWithoutSelfLoops(t){t=""+t;const n=this._nodes.get(t);if(!n)throw new Qt(`Graph.outDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:n.outDegree-n.directedLoops}directedDegreeWithoutSelfLoops(t){t=""+t;const n=this._nodes.get(t);if(!n)throw new Qt(`Graph.directedDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree-n.directedLoops*2}undirectedDegreeWithoutSelfLoops(t){t=""+t;const n=this._nodes.get(t);if(!n)throw new Qt(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree-n.undirectedLoops*2}inboundDegreeWithoutSelfLoops(t){t=""+t;const n=this._nodes.get(t);if(!n)throw new Qt(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=n.undirectedDegree,i+=n.undirectedLoops*2),this.type!=="undirected"&&(r+=n.inDegree,i+=n.directedLoops),r-i}outboundDegreeWithoutSelfLoops(t){t=""+t;const n=this._nodes.get(t);if(!n)throw new Qt(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=n.undirectedDegree,i+=n.undirectedLoops*2),this.type!=="undirected"&&(r+=n.outDegree,i+=n.directedLoops),r-i}degreeWithoutSelfLoops(t){t=""+t;const n=this._nodes.get(t);if(!n)throw new Qt(`Graph.degreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=n.undirectedDegree,i+=n.undirectedLoops*2),this.type!=="undirected"&&(r+=n.inDegree+n.outDegree,i+=n.directedLoops*2),r-i}source(t){t=""+t;const n=this._edges.get(t);if(!n)throw new Qt(`Graph.source: could not find the "${t}" edge in the graph.`);return n.source.key}target(t){t=""+t;const n=this._edges.get(t);if(!n)throw new Qt(`Graph.target: could not find the "${t}" edge in the graph.`);return n.target.key}extremities(t){t=""+t;const n=this._edges.get(t);if(!n)throw new Qt(`Graph.extremities: could not find the "${t}" edge in the graph.`);return[n.source.key,n.target.key]}opposite(t,n){t=""+t,n=""+n;const r=this._edges.get(n);if(!r)throw new Qt(`Graph.opposite: could not find the "${n}" edge in the graph.`);const i=r.source.key,a=r.target.key;if(t===i)return a;if(t===a)return i;throw new Qt(`Graph.opposite: the "${t}" node is not attached to the "${n}" edge (${i}, ${a}).`)}hasExtremity(t,n){t=""+t,n=""+n;const r=this._edges.get(t);if(!r)throw new Qt(`Graph.hasExtremity: could not find the "${t}" edge in the graph.`);return r.source.key===n||r.target.key===n}isUndirected(t){t=""+t;const n=this._edges.get(t);if(!n)throw new Qt(`Graph.isUndirected: could not find the "${t}" edge in the graph.`);return n.undirected}isDirected(t){t=""+t;const n=this._edges.get(t);if(!n)throw new Qt(`Graph.isDirected: could not find the "${t}" edge in the graph.`);return!n.undirected}isSelfLoop(t){t=""+t;const n=this._edges.get(t);if(!n)throw new Qt(`Graph.isSelfLoop: could not find the "${t}" edge in the graph.`);return n.source===n.target}addNode(t,n){return QY(this,t,n).key}mergeNode(t,n){if(n&&!Ja(n))throw new mn(`Graph.mergeNode: invalid attributes. Expecting an object but got "${n}"`);t=""+t,n=n||{};let r=this._nodes.get(t);return r?(n&&(va(r.attributes,n),this.emit("nodeAttributesUpdated",{type:"merge",key:t,attributes:r.attributes,data:n})),[t,!1]):(r=new this.NodeDataClass(t,n),this._nodes.set(t,r),this.emit("nodeAdded",{key:t,attributes:n}),[t,!0])}updateNode(t,n){if(n&&typeof n!="function")throw new mn(`Graph.updateNode: invalid updater function. Expecting a function but got "${n}"`);t=""+t;let r=this._nodes.get(t);if(r){if(n){const a=r.attributes;r.attributes=n(a),this.emit("nodeAttributesUpdated",{type:"replace",key:t,attributes:r.attributes})}return[t,!1]}const i=n?n({}):{};return r=new this.NodeDataClass(t,i),this._nodes.set(t,r),this.emit("nodeAdded",{key:t,attributes:i}),[t,!0]}dropNode(t){t=""+t;const n=this._nodes.get(t);if(!n)throw new Qt(`Graph.dropNode: could not find the "${t}" node in the graph.`);let r;if(this.type!=="undirected"){for(const i in n.out){r=n.out[i];do bm(this,r),r=r.next;while(r)}for(const i in n.in){r=n.in[i];do bm(this,r),r=r.next;while(r)}}if(this.type!=="directed")for(const i in n.undirected){r=n.undirected[i];do bm(this,r),r=r.next;while(r)}this._nodes.delete(t),this.emit("nodeDropped",{key:t,attributes:n.attributes})}dropEdge(t){let n;if(arguments.length>1){const r=""+arguments[0],i=""+arguments[1];if(n=pu(this,r,i,this.type),!n)throw new Qt(`Graph.dropEdge: could not find the "${r}" -> "${i}" edge in the graph.`)}else if(t=""+t,n=this._edges.get(t),!n)throw new Qt(`Graph.dropEdge: could not find the "${t}" edge in the graph.`);return bm(this,n),this}dropDirectedEdge(t,n){if(arguments.length<2)throw new Un("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Un("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");t=""+t,n=""+n;const r=pu(this,t,n,"directed");if(!r)throw new Qt(`Graph.dropDirectedEdge: could not find a "${t}" -> "${n}" edge in the graph.`);return bm(this,r),this}dropUndirectedEdge(t,n){if(arguments.length<2)throw new Un("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Un("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const r=pu(this,t,n,"undirected");if(!r)throw new Qt(`Graph.dropUndirectedEdge: could not find a "${t}" -> "${n}" edge in the graph.`);return bm(this,r),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const t=this._nodes.values();let n;for(;n=t.next(),n.done!==!0;)n.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(t){return this._attributes[t]}getAttributes(){return this._attributes}hasAttribute(t){return this._attributes.hasOwnProperty(t)}setAttribute(t,n){return this._attributes[t]=n,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this}updateAttribute(t,n){if(typeof n!="function")throw new mn("Graph.updateAttribute: updater should be a function.");const r=this._attributes[t];return this._attributes[t]=n(r),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this}removeAttribute(t){return delete this._attributes[t],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:t}),this}replaceAttributes(t){if(!Ja(t))throw new mn("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=t,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(t){if(!Ja(t))throw new mn("Graph.mergeAttributes: provided attributes are not a plain object.");return va(this._attributes,t),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:t}),this}updateAttributes(t){if(typeof t!="function")throw new mn("Graph.updateAttributes: provided updater is not a function.");return this._attributes=t(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(t,n){if(typeof t!="function")throw new mn("Graph.updateEachNodeAttributes: expecting an updater function.");if(n&&!b3(n))throw new mn("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._nodes.values();let i,a;for(;i=r.next(),i.done!==!0;)a=i.value,a.attributes=t(a.key,a.attributes);this.emit("eachNodeAttributesUpdated",{hints:n||null})}updateEachEdgeAttributes(t,n){if(typeof t!="function")throw new mn("Graph.updateEachEdgeAttributes: expecting an updater function.");if(n&&!b3(n))throw new mn("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._edges.values();let i,a,l,o;for(;i=r.next(),i.done!==!0;)a=i.value,l=a.source,o=a.target,a.attributes=t(a.key,a.attributes,l.key,o.key,l.attributes,o.attributes,a.undirected);this.emit("eachEdgeAttributesUpdated",{hints:n||null})}forEachAdjacencyEntry(t){if(typeof t!="function")throw new mn("Graph.forEachAdjacencyEntry: expecting a callback.");tb(!1,!1,!1,this,t)}forEachAdjacencyEntryWithOrphans(t){if(typeof t!="function")throw new mn("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");tb(!1,!1,!0,this,t)}forEachAssymetricAdjacencyEntry(t){if(typeof t!="function")throw new mn("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");tb(!1,!0,!1,this,t)}forEachAssymetricAdjacencyEntryWithOrphans(t){if(typeof t!="function")throw new mn("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");tb(!1,!0,!0,this,t)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):N5(this._nodes.keys(),this._nodes.size)}forEachNode(t){if(typeof t!="function")throw new mn("Graph.forEachNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)i=r.value,t(i.key,i.attributes)}findNode(t){if(typeof t!="function")throw new mn("Graph.findNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)if(i=r.value,t(i.key,i.attributes))return i.key}mapNodes(t){if(typeof t!="function")throw new mn("Graph.mapNode: expecting a callback.");const n=this._nodes.values();let r,i;const a=new Array(this.order);let l=0;for(;r=n.next(),r.done!==!0;)i=r.value,a[l++]=t(i.key,i.attributes);return a}someNode(t){if(typeof t!="function")throw new mn("Graph.someNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)if(i=r.value,t(i.key,i.attributes))return!0;return!1}everyNode(t){if(typeof t!="function")throw new mn("Graph.everyNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)if(i=r.value,!t(i.key,i.attributes))return!1;return!0}filterNodes(t){if(typeof t!="function")throw new mn("Graph.filterNodes: expecting a callback.");const n=this._nodes.values();let r,i;const a=[];for(;r=n.next(),r.done!==!0;)i=r.value,t(i.key,i.attributes)&&a.push(i.key);return a}reduceNodes(t,n){if(typeof t!="function")throw new mn("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new mn("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let r=n;const i=this._nodes.values();let a,l;for(;a=i.next(),a.done!==!0;)l=a.value,r=t(r,l.key,l.attributes);return r}nodeEntries(){const t=this._nodes.values();return new Iu(()=>{const n=t.next();if(n.done)return n;const r=n.value;return{value:{node:r.key,attributes:r.attributes},done:!1}})}export(){const t=new Array(this._nodes.size);let n=0;this._nodes.forEach((i,a)=>{t[n++]=qY(a,i)});const r=new Array(this._edges.size);return n=0,this._edges.forEach((i,a)=>{r[n++]=ZY(this.type,a,i)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:t,edges:r}}import(t,n=!1){if(t instanceof Gi)return t.forEachNode((f,p)=>{n?this.mergeNode(f,p):this.addNode(f,p)}),t.forEachEdge((f,p,y,x,w,S,L)=>{n?L?this.mergeUndirectedEdgeWithKey(f,y,x,p):this.mergeDirectedEdgeWithKey(f,y,x,p):L?this.addUndirectedEdgeWithKey(f,y,x,p):this.addDirectedEdgeWithKey(f,y,x,p)}),this;if(!Ja(t))throw new mn("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(t.attributes){if(!Ja(t.attributes))throw new mn("Graph.import: invalid attributes. Expecting a plain object.");n?this.mergeAttributes(t.attributes):this.replaceAttributes(t.attributes)}let r,i,a,l,o;if(t.nodes){if(a=t.nodes,!Array.isArray(a))throw new mn("Graph.import: invalid nodes. Expecting an array.");for(r=0,i=a.length;r<i;r++){l=a[r],XY(l);const{key:f,attributes:p}=l;n?this.mergeNode(f,p):this.addNode(f,p)}}if(t.edges){let f=!1;if(this.type==="undirected"&&(f=!0),a=t.edges,!Array.isArray(a))throw new mn("Graph.import: invalid edges. Expecting an array.");for(r=0,i=a.length;r<i;r++){o=a[r],WY(o);const{source:p,target:y,attributes:x,undirected:w=f}=o;let S;"key"in o?(S=n?w?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:w?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,S.call(this,o.key,p,y,x)):(S=n?w?this.mergeUndirectedEdge:this.mergeDirectedEdge:w?this.addUndirectedEdge:this.addDirectedEdge,S.call(this,p,y,x))}}return this}nullCopy(t){const n=new Gi(va({},this._options,t));return n.replaceAttributes(va({},this.getAttributes())),n}emptyCopy(t){const n=this.nullCopy(t);return this._nodes.forEach((r,i)=>{const a=va({},r.attributes);r=new n.NodeDataClass(i,a),n._nodes.set(i,r)}),n}copy(t){if(t=t||{},typeof t.type=="string"&&t.type!==this.type&&t.type!=="mixed")throw new Un(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${t.type}" because this would mean losing information about the current graph.`);if(typeof t.multi=="boolean"&&t.multi!==this.multi&&t.multi!==!0)throw new Un("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof t.allowSelfLoops=="boolean"&&t.allowSelfLoops!==this.allowSelfLoops&&t.allowSelfLoops!==!0)throw new Un("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const n=this.emptyCopy(t),r=this._edges.values();let i,a;for(;i=r.next(),i.done!==!0;)a=i.value,q5(n,"copy",!1,a.undirected,a.key,a.source.key,a.target.key,va({},a.attributes));return n}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const t={};this._nodes.forEach((a,l)=>{t[l]=a.attributes});const n={},r={};this._edges.forEach((a,l)=>{const o=a.undirected?"--":"->";let f="",p=a.source.key,y=a.target.key,x;a.undirected&&p>y&&(x=p,p=y,y=x);const w=`(${p})${o}(${y})`;l.startsWith("geid_")?this.multi&&(typeof r[w]>"u"?r[w]=0:r[w]++,f+=`${r[w]}. `):f+=`[${l}]: `,f+=w,n[f]=a.attributes});const i={};for(const a in this)this.hasOwnProperty(a)&&!w3.has(a)&&typeof this[a]!="function"&&typeof a!="symbol"&&(i[a]=this[a]);return i.attributes=this._attributes,i.nodes=t,i.edges=n,tu(i,"constructor",this.constructor),i}}typeof Symbol<"u"&&(Gi.prototype[Symbol.for("nodejs.util.inspect.custom")]=Gi.prototype.inspect);KY.forEach(e=>{["add","merge","update"].forEach(t=>{const n=e.name(t),r=t==="add"?q5:eK;e.generateKey?Gi.prototype[n]=function(i,a,l){return r(this,n,!0,(e.type||this.type)==="undirected",null,i,a,l,t==="update")}:Gi.prototype[n]=function(i,a,l,o){return r(this,n,!1,(e.type||this.type)==="undirected",i,a,l,o,t==="update")}})});uY(Gi);xY(Gi);NY(Gi);jY(Gi);class Z5 extends Gi{constructor(t){const n=va({type:"directed"},t);if("multi"in n&&n.multi!==!1)throw new mn("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="directed")throw new mn('DirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class X5 extends Gi{constructor(t){const n=va({type:"undirected"},t);if("multi"in n&&n.multi!==!1)throw new mn("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="undirected")throw new mn('UndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class W5 extends Gi{constructor(t){const n=va({multi:!0},t);if("multi"in n&&n.multi!==!0)throw new mn("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(n)}}class H5 extends Gi{constructor(t){const n=va({type:"directed",multi:!0},t);if("multi"in n&&n.multi!==!0)throw new mn("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="directed")throw new mn('MultiDirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class Y5 extends Gi{constructor(t){const n=va({type:"undirected",multi:!0},t);if("multi"in n&&n.multi!==!0)throw new mn("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="undirected")throw new mn('MultiUndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}function Oy(e){e.from=function(t,n){const r=va({},t.options,n),i=new e(r);return i.import(t),i}}Oy(Gi);Oy(Z5);Oy(X5);Oy(W5);Oy(H5);Oy(Y5);Gi.Graph=Gi;Gi.DirectedGraph=Z5;Gi.UndirectedGraph=X5;Gi.MultiGraph=W5;Gi.MultiDirectedGraph=H5;Gi.MultiUndirectedGraph=Y5;Gi.InvalidArgumentsGraphError=mn;Gi.NotFoundGraphError=Qt;Gi.UsageGraphError=Un;var Dy={},K5=function(t){return t!==null&&typeof t=="object"&&typeof t.addUndirectedEdgeWithKey=="function"&&typeof t.dropNode=="function"&&typeof t.multi=="boolean"},J5=Xw,tK=J5.ARRAY_BUFFER_SUPPORT,nK=J5.SYMBOL_SUPPORT,Y2=function(t,n){var r,i,a,l,o;if(!t)throw new Error("obliterator/forEach: invalid iterable.");if(typeof n!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(t)||tK&&ArrayBuffer.isView(t)||typeof t=="string"||t.toString()==="[object Arguments]"){for(a=0,l=t.length;a<l;a++)n(t[a],a);return}if(typeof t.forEach=="function"){t.forEach(n);return}if(nK&&Symbol.iterator in t&&typeof t.next!="function"&&(t=t[Symbol.iterator]()),typeof t.next=="function"){for(r=t,a=0;o=r.next(),o.done!==!0;)n(o.value,a),a++;return}for(i in t)t.hasOwnProperty(i)&&n(t[i],i)},Q5=Zw,rK=Y2;function Xo(){this.clear()}Xo.prototype.clear=function(){this.items=[],this.offset=0,this.size=0};Xo.prototype.enqueue=function(e){return this.items.push(e),++this.size};Xo.prototype.dequeue=function(){if(this.size){var e=this.items[this.offset];return++this.offset*2>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,e}};Xo.prototype.peek=function(){if(this.size)return this.items[this.offset]};Xo.prototype.forEach=function(e,t){t=arguments.length>1?t:this;for(var n=this.offset,r=0,i=this.items.length;n<i;n++,r++)e.call(t,this.items[n],r,this)};Xo.prototype.toArray=function(){return this.items.slice(this.offset)};Xo.prototype.values=function(){var e=this.items,t=this.offset;return new Q5(function(){if(t>=e.length)return{done:!0};var n=e[t];return t++,{value:n,done:!1}})};Xo.prototype.entries=function(){var e=this.items,t=this.offset,n=0;return new Q5(function(){if(t>=e.length)return{done:!0};var r=e[t];return t++,{value:[n++,r],done:!1}})};typeof Symbol<"u"&&(Xo.prototype[Symbol.iterator]=Xo.prototype.values);Xo.prototype.toString=function(){return this.toArray().join(",")};Xo.prototype.toJSON=function(){return this.toArray()};Xo.prototype.inspect=function(){var e=this.toArray();return Object.defineProperty(e,"constructor",{value:Xo,enumerable:!1}),e};typeof Symbol<"u"&&(Xo.prototype[Symbol.for("nodejs.util.inspect.custom")]=Xo.prototype.inspect);Xo.from=function(e){var t=new Xo;return rK(e,function(n){t.enqueue(n)}),t};Xo.of=function(){return Xo.from(arguments)};var iK=Xo,oK=function(t,n){var r=n.length;if(r!==0){var i=t.length;t.length+=r;for(var a=0;a<r;a++)t[i+a]=n[a]}},K2=K5,aK=iK,sK=oK;function lK(e,t,n){if(!K2(e))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!e.hasNode(t))throw new Error('graphology-shortest-path: the "'+t+'" source node does not exist in the given graph.');if(!e.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" target node does not exist in the given graph.');if(t=""+t,n=""+n,t===n)return[t];var r=e.inboundNeighbors.bind(e),i=e.outboundNeighbors.bind(e),a={},l={};a[t]=null,l[n]=null;var o=[t],f=[n],p,y,x,w,S,L,D,B,z=!1;e:for(;o.length&&f.length;)if(o.length<=f.length){for(p=o,o=[],S=0,D=p.length;S<D;S++)for(y=p[S],x=i(y),L=0,B=x.length;L<B;L++)if(w=x[L],w in a||(o.push(w),a[w]=y),w in l){z=!0;break e}}else for(p=f,f=[],S=0,D=p.length;S<D;S++)for(y=p[S],x=r(y),L=0,B=x.length;L<B;L++)if(w=x[L],w in l||(f.push(w),l[w]=y),w in a){z=!0;break e}if(!z)return null;for(var M=[];w;)M.unshift(w),w=a[w];for(w=l[M[M.length-1]];w;)M.push(w),w=l[w];return M.length?M:null}function uK(e,t){if(!K2(e))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!e.hasNode(t))throw new Error('graphology-shortest-path: the "'+t+'" source node does not exist in the given graph.');t=""+t;var n={},r={},i,a,l,o,f,p;for(n[t]=!0,r[t]=[t];Object.keys(n).length;){i=n,n={};for(l in i)for(a=e.outboundNeighbors(l),f=0,p=a.length;f<p;f++)o=a[f],r[o]||(r[o]=r[l].concat(o),n[o]=!0)}return r}function eF(e,t,n){if(!K2(t))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!t.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" source node does not exist in the given graph.');n=""+n;var r=new Set,i={},a=0;i[n]=0;for(var l=[n],o,f,p;l.length!==0;){var y=[];for(o=0,f=l.length;o<f;o++)p=l[o],!r.has(p)&&(r.add(p),sK(y,t[e](p)),i[p]=a);a++,l=y}return i}var cK=eF.bind(null,"outboundNeighbors"),hK=eF.bind(null,"neighbors");function fK(e,t){t=""+t;var n=[],r={},i={},a=e.nodes(),l,o,f,p,y,x,w,S,L;for(x=0,S=a.length;x<S;x++)p=a[x],r[p]=[],i[p]=0;var D={};i[t]=1,D[t]=0;for(var B=aK.of(t);B.size;)for(p=B.dequeue(),n.push(p),l=D[p],o=i[p],f=e.outboundNeighbors(p),w=0,L=f.length;w<L;w++)y=f[w],y in D||(B.enqueue(y),D[y]=l+1),D[y]===l+1&&(i[y]+=o,r[y].push(p));return[n,r,i]}Dy.bidirectional=lK;Dy.singleSource=uK;Dy.singleSourceLength=cK;Dy.undirectedSingleSourceLength=hK;Dy.brandes=fK;var J2={},Hw={};function dK(e){return typeof e!="number"||isNaN(e)?1:e}function pK(e,t){var n={},r=function(l){return typeof l>"u"?t:l};typeof t=="function"&&(r=t);var i=function(l){return r(l[e])},a=function(){return r(void 0)};return typeof e=="string"?(n.fromAttributes=i,n.fromGraph=function(l,o){return i(l.getNodeAttributes(o))},n.fromEntry=function(l,o){return i(o)}):typeof e=="function"?(n.fromAttributes=function(){throw new Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},n.fromGraph=function(l,o){return r(e(o,l.getNodeAttributes(o)))},n.fromEntry=function(l,o){return r(e(l,o))}):(n.fromAttributes=a,n.fromGraph=a,n.fromEntry=a),n}function tF(e,t){var n={},r=function(l){return typeof l>"u"?t:l};typeof t=="function"&&(r=t);var i=function(l){return r(l[e])},a=function(){return r(void 0)};return typeof e=="string"?(n.fromAttributes=i,n.fromGraph=function(l,o){return i(l.getEdgeAttributes(o))},n.fromEntry=function(l,o){return i(o)},n.fromPartialEntry=n.fromEntry,n.fromMinimalEntry=n.fromEntry):typeof e=="function"?(n.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},n.fromGraph=function(l,o){var f=l.extremities(o);return r(e(o,l.getEdgeAttributes(o),f[0],f[1],l.getNodeAttributes(f[0]),l.getNodeAttributes(f[1]),l.isUndirected(o)))},n.fromEntry=function(l,o,f,p,y,x,w){return r(e(l,o,f,p,y,x,w))},n.fromPartialEntry=function(l,o,f,p){return r(e(l,o,f,p))},n.fromMinimalEntry=function(l,o){return r(e(l,o))}):(n.fromAttributes=a,n.fromGraph=a,n.fromEntry=a,n.fromMinimalEntry=a),n}Hw.createNodeValueGetter=pK;Hw.createEdgeValueGetter=tF;Hw.createEdgeWeightGetter=function(e){return tF(e,dK)};var e1={},gK=function(e,t){return e<t?-1:e>t?1:0},mK=function(e,t){return e<t?1:e>t?-1:0};function yK(e){return function(t,n){return e(n,t)}}function vK(e){return e===2?function(t,n){return t[0]<n[0]?-1:t[0]>n[0]?1:t[1]<n[1]?-1:t[1]>n[1]?1:0}:function(t,n){for(var r=0;r<e;){if(t[r]<n[r])return-1;if(t[r]>n[r])return 1;r++}return 0}}e1.DEFAULT_COMPARATOR=gK;e1.DEFAULT_REVERSE_COMPARATOR=mK;e1.reverseComparator=yK;e1.createTupleComparator=vK;var t1={},nF={};(function(e){var t=Math.pow(2,8)-1,n=Math.pow(2,16)-1,r=Math.pow(2,32)-1,i=Math.pow(2,7)-1,a=Math.pow(2,15)-1,l=Math.pow(2,31)-1;e.getPointerArray=function(f){var p=f-1;if(p<=t)return Uint8Array;if(p<=n)return Uint16Array;if(p<=r)return Uint32Array;throw new Error("mnemonist: Pointer Array of size > 4294967295 is not supported.")},e.getSignedPointerArray=function(f){var p=f-1;return p<=i?Int8Array:p<=a?Int16Array:p<=l?Int32Array:Float64Array},e.getNumberType=function(f){return f===(f|0)?Math.sign(f)===-1?f<=127&&f>=-128?Int8Array:f<=32767&&f>=-32768?Int16Array:Int32Array:f<=255?Uint8Array:f<=65535?Uint16Array:Uint32Array:Float64Array};var o={Uint8Array:1,Int8Array:2,Uint16Array:3,Int16Array:4,Uint32Array:5,Int32Array:6,Float32Array:7,Float64Array:8};e.getMinimalRepresentation=function(f,p){var y=null,x=0,w,S,L,D,B;for(D=0,B=f.length;D<B;D++)L=p?p(f[D]):f[D],S=e.getNumberType(L),w=o[S.name],w>x&&(x=w,y=S);return y},e.isTypedArray=function(f){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView(f)},e.concat=function(){var f=0,p,y,x;for(p=0,x=arguments.length;p<x;p++)f+=arguments[p].length;var w=new arguments[0].constructor(f);for(p=0,y=0;p<x;p++)w.set(arguments[p],y),y+=arguments[p].length;return w},e.indices=function(f){for(var p=e.getPointerArray(f),y=new p(f),x=0;x<f;x++)y[x]=x;return y}})(nF);var rF=Y2,iF=nF;function _K(e){return Array.isArray(e)||iF.isTypedArray(e)}function Q2(e){if(typeof e.length=="number")return e.length;if(typeof e.size=="number")return e.size}function xK(e){var t=Q2(e),n=typeof t=="number"?new Array(t):[],r=0;return rF(e,function(i){n[r++]=i}),n}function bK(e){var t=Q2(e),n=typeof t=="number"?iF.getPointerArray(t):Array,r=typeof t=="number"?new Array(t):[],i=typeof t=="number"?new n(t):[],a=0;return rF(e,function(l){r[a]=l,i[a]=a++}),[r,i]}t1.isArrayLike=_K;t1.guessLength=Q2;t1.toArray=xK;t1.toArrayWithIndices=bK;var Hb=Y2,oF=e1,Kc=t1,Yw=oF.DEFAULT_COMPARATOR,eP=oF.reverseComparator;function tP(e,t,n,r){for(var i=t[r],a,l;r>n;){if(a=r-1>>1,l=t[a],e(i,l)<0){t[r]=l,r=a;continue}break}t[r]=i}function n1(e,t,n){for(var r=t.length,i=n,a=t[n],l=2*n+1,o;l<r;)o=l+1,o<r&&e(t[l],t[o])>=0&&(l=o),t[n]=t[l],n=l,l=2*n+1;t[n]=a,tP(e,t,i,n)}function aF(e,t,n){t.push(n),tP(e,t,0,t.length-1)}function nP(e,t){var n=t.pop();if(t.length!==0){var r=t[0];return t[0]=n,n1(e,t,0),r}return n}function vy(e,t,n){if(t.length===0)throw new Error("mnemonist/heap.replace: cannot pop an empty heap.");var r=t[0];return t[0]=n,n1(e,t,0),r}function sF(e,t,n){var r;return t.length!==0&&e(t[0],n)<0&&(r=t[0],t[0]=n,n=r,n1(e,t,0)),n}function tg(e,t){for(var n=t.length,r=n>>1,i=r;--i>=0;)n1(e,t,i)}function rP(e,t){for(var n=t.length,r=0,i=new Array(n);r<n;)i[r++]=nP(e,t);return i}function wK(e,t,n){arguments.length===2&&(n=t,t=e,e=Yw);var r=eP(e),i,a,l,o=1/0,f;if(t===1){if(Kc.isArrayLike(n)){for(i=0,a=n.length;i<a;i++)l=n[i],(o===1/0||e(l,o)<0)&&(o=l);return f=new n.constructor(1),f[0]=o,f}return Hb(n,function(y){(o===1/0||e(y,o)<0)&&(o=y)}),[o]}if(Kc.isArrayLike(n)){if(t>=n.length)return n.slice().sort(e);for(f=n.slice(0,t),tg(r,f),i=t,a=n.length;i<a;i++)r(n[i],f[0])>0&&vy(r,f,n[i]);return f.sort(e)}var p=Kc.guessLength(n);return p!==null&&p<t&&(t=p),f=new Array(t),i=0,Hb(n,function(y){i<t?f[i]=y:(i===t&&tg(r,f),r(y,f[0])>0&&vy(r,f,y)),i++}),f.length>i&&(f.length=i),f.sort(e)}function EK(e,t,n){arguments.length===2&&(n=t,t=e,e=Yw);var r=eP(e),i,a,l,o=-1/0,f;if(t===1){if(Kc.isArrayLike(n)){for(i=0,a=n.length;i<a;i++)l=n[i],(o===-1/0||e(l,o)>0)&&(o=l);return f=new n.constructor(1),f[0]=o,f}return Hb(n,function(y){(o===-1/0||e(y,o)>0)&&(o=y)}),[o]}if(Kc.isArrayLike(n)){if(t>=n.length)return n.slice().sort(r);for(f=n.slice(0,t),tg(e,f),i=t,a=n.length;i<a;i++)e(n[i],f[0])>0&&vy(e,f,n[i]);return f.sort(r)}var p=Kc.guessLength(n);return p!==null&&p<t&&(t=p),f=new Array(t),i=0,Hb(n,function(y){i<t?f[i]=y:(i===t&&tg(e,f),e(y,f[0])>0&&vy(e,f,y)),i++}),f.length>i&&(f.length=i),f.sort(r)}function Ri(e){if(this.clear(),this.comparator=e||Yw,typeof this.comparator!="function")throw new Error("mnemonist/Heap.constructor: given comparator should be a function.")}Ri.prototype.clear=function(){this.items=[],this.size=0};Ri.prototype.push=function(e){return aF(this.comparator,this.items,e),++this.size};Ri.prototype.peek=function(){return this.items[0]};Ri.prototype.pop=function(){return this.size!==0&&this.size--,nP(this.comparator,this.items)};Ri.prototype.replace=function(e){return vy(this.comparator,this.items,e)};Ri.prototype.pushpop=function(e){return sF(this.comparator,this.items,e)};Ri.prototype.consume=function(){return this.size=0,rP(this.comparator,this.items)};Ri.prototype.toArray=function(){return rP(this.comparator,this.items.slice())};Ri.prototype.inspect=function(){var e=this.toArray();return Object.defineProperty(e,"constructor",{value:Ri,enumerable:!1}),e};typeof Symbol<"u"&&(Ri.prototype[Symbol.for("nodejs.util.inspect.custom")]=Ri.prototype.inspect);function Yb(e){if(this.clear(),this.comparator=e||Yw,typeof this.comparator!="function")throw new Error("mnemonist/MaxHeap.constructor: given comparator should be a function.");this.comparator=eP(this.comparator)}Yb.prototype=Ri.prototype;Ri.from=function(e,t){var n=new Ri(t),r;return Kc.isArrayLike(e)?r=e.slice():r=Kc.toArray(e),tg(n.comparator,r),n.items=r,n.size=r.length,n};Yb.from=function(e,t){var n=new Yb(t),r;return Kc.isArrayLike(e)?r=e.slice():r=Kc.toArray(e),tg(n.comparator,r),n.items=r,n.size=r.length,n};Ri.siftUp=n1;Ri.siftDown=tP;Ri.push=aF;Ri.pop=nP;Ri.replace=vy;Ri.pushpop=sF;Ri.heapify=tg;Ri.consume=rP;Ri.nsmallest=wK;Ri.nlargest=EK;Ri.MinHeap=Ri;Ri.MaxHeap=Yb;var SK=Ri,lF=K5,iP=Hw.createEdgeWeightGetter,Kb=SK,oP="weight";function DI(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:e[1]>t[1]?1:e[1]<t[1]?-1:e[2]>t[2]?1:e[2]<t[2]?-1:0}function TK(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:e[1]>t[1]?1:e[1]<t[1]?-1:e[2]>t[2]?1:e[2]<t[2]?-1:e[3]>t[3]?1:e[3]<t[3]?-1:0}function IK(e,t,n,r){if(t=""+t,n=""+n,!lF(e))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");if(t&&!e.hasNode(t))throw new Error('graphology-shortest-path/dijkstra: the "'+t+'" source node does not exist in the given graph.');if(n&&!e.hasNode(n))throw new Error('graphology-shortest-path/dijkstra: the "'+n+'" target node does not exist in the given graph.');if(r=iP(r||oP).fromMinimalEntry,t===n)return[0,[t]];var i=[{},{}],a=[{},{}],l=[new Kb(DI),new Kb(DI)],o=[{},{}];a[0][t]=[t],a[1][n]=[n],o[0][t]=0,o[1][n]=0;var f=[],p=1/0,y=0,x=1,w,S,L,D,B,z,M,k,V;for(l[0].push([0,y++,t]),l[1].push([0,y++,n]);l[0].size&&l[1].size;)if(x=1-x,w=l[x].pop(),D=w[0],B=w[2],!(B in i[x])){if(i[x][B]=D,B in i[1-x])return[p,f];for(S=x===1?e.inboundEdges(B):e.outboundEdges(B),k=0,V=S.length;k<V;k++){if(M=S[k],z=e.opposite(B,M),L=i[x][B]+r(M,e.getEdgeAttributes(M)),z in i[x]&&L<i[x][z])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(z in o[x])||L<o[x][z])&&(o[x][z]=L,l[x].push([L,y++,z]),a[x][z]=a[x][B].concat(z),z in o[0]&&z in o[1]&&(D=o[0][z]+o[1][z],(f.length===0||p>D)&&(p=D,f=a[0][z].concat(a[1][z].slice(0,-1).reverse()))))}}return[1/0,null]}function CK(e,t,n,r,i,a){if(!lF(e))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");if(i&&!e.hasNode(i))throw new Error('graphology-shortest-path/dijkstra: the "'+i+'" target node does not exist in the given graph.');n=iP(n||oP).fromMinimalEntry;var l={},o={},f=new Kb(DI),p=0,y,x,w,S,L,D,B,z,M,k,V;for(z=0,k=t.length;z<k;z++)S=t[z],o[S]=0,f.push([0,p++,S]),a&&(a[S]=[S]);for(;f.size;)if(x=f.pop(),B=x[0],S=x[2],!(S in l)){if(l[S]=B,S===i)break;for(y=e.outboundEdges(S),M=0,V=y.length;M<V;M++)if(D=y[M],L=e.opposite(S,D),w=n(D,e.getEdgeAttributes(D))+l[S],!(r&&w>r)){if(L in l&&w<l[L])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(L in o)||w<o[L])&&(o[L]=w,f.push([w,p++,L]),a&&(a[L]=a[S].concat(L)))}}return l}function PK(e,t,n){var r={};return CK(e,[t],n,0,null,r),r}function AK(e,t,n,r){return IK(e,t,n,r)[1]}function MK(e,t,n){t=""+t,n=iP(n||oP).fromMinimalEntry;var r=[],i={},a={},l=e.nodes(),o,f,p,y,x,w,S,L,D,B;for(D=0,B=l.length;D<B;D++)w=l[D],i[w]=[],a[w]=0;var z={};a[t]=1;var M={};M[t]=0;var k=0,V=new Kb(TK);for(V.push([0,k++,t,t]);V.size;)if(f=V.pop(),y=f[0],p=f[2],w=f[3],!(w in z))for(a[w]+=a[p],r.push(w),z[w]=y,o=e.outboundEdges(w),D=0,B=o.length;D<B;D++)L=o[D],S=e.opposite(w,L),x=y+n(L,e.getEdgeAttributes(L)),!(S in z)&&(!(S in M)||x<M[S])?(M[S]=x,V.push([x,k++,w,S]),a[S]=0,i[S]=[w]):x===M[S]&&(a[S]+=a[w],i[S].push(w));return[r,i,a]}J2.bidirectional=AK;J2.singleSource=PK;J2.brandes=MK;var r1=Dy,LK=r1.bidirectional;r1.singleSource;r1.singleSourceLength;r1.undirectedSingleSourceLength;r1.brandes;const OK="FeatureCollection",DK="PTV_METRO_TRAIN_STATION",RK={type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}},kK=[{type:"Feature",properties:{STOP_ID:"19970",LATITUDE:-37.781193,STOP_NAME:"Royal Park Railway Station (Parkville)",LONGITUDE:144.952301,TICKETZONE:"1",ROUTEUSSP:"Upfield"},geometry:{type:"Point",coordinates:[144.95230120580877,-37.7811929725527]}},{type:"Feature",properties:{STOP_ID:"19971",LATITUDE:-37.78814,STOP_NAME:"Flemington Bridge Railway Station (North Melbourne)",LONGITUDE:144.939323,TICKETZONE:"1",ROUTEUSSP:"Upfield"},geometry:{type:"Point",coordinates:[144.93932321237276,-37.788139984393844]}},{type:"Feature",properties:{STOP_ID:"19972",LATITUDE:-37.794267,STOP_NAME:"Macaulay Railway Station (North Melbourne)",LONGITUDE:144.936166,TICKETZONE:"1",ROUTEUSSP:"Upfield"},geometry:{type:"Point",coordinates:[144.93616600406753,-37.79426700459872]}},{type:"Feature",properties:{STOP_ID:"19973",LATITUDE:-37.807419,STOP_NAME:"North Melbourne Railway Station (West Melbourne)",LONGITUDE:144.94257,TICKETZONE:"1",ROUTEUSSP:"Flemington Racecourse,Sunbury,Upfield,Werribee,Williamstown,Craigieburn"},geometry:{type:"Point",coordinates:[144.94257002890663,-37.80741897361899]}},{type:"Feature",properties:{STOP_ID:"19974",LATITUDE:-37.788657,STOP_NAME:"Clifton Hill Railway Station (Clifton Hill)",LONGITUDE:144.995417,TICKETZONE:"1",ROUTEUSSP:"Mernda,Hurstbridge"},geometry:{type:"Point",coordinates:[144.9954169601631,-37.78865703363607]}},{type:"Feature",properties:{STOP_ID:"19975",LATITUDE:-37.799158,STOP_NAME:"Victoria Park Railway Station (Abbotsford)",LONGITUDE:144.994451,TICKETZONE:"1",ROUTEUSSP:"Mernda,Hurstbridge"},geometry:{type:"Point",coordinates:[144.9944510689111,-37.79915796626723]}},{type:"Feature",properties:{STOP_ID:"19976",LATITUDE:-37.804526,STOP_NAME:"Collingwood Railway Station (Abbotsford)",LONGITUDE:144.99375,TICKETZONE:"1",ROUTEUSSP:"Mernda,Hurstbridge"},geometry:{type:"Point",coordinates:[144.99375014165992,-37.80452601640281]}},{type:"Feature",properties:{STOP_ID:"19977",LATITUDE:-37.810398,STOP_NAME:"North Richmond Railway Station (Richmond)",LONGITUDE:144.9925,TICKETZONE:"1",ROUTEUSSP:"Mernda,Hurstbridge"},geometry:{type:"Point",coordinates:[144.9924998535909,-37.8103979761548]}},{type:"Feature",properties:{STOP_ID:"19978",LATITUDE:-37.814949,STOP_NAME:"West Richmond Railway Station (Richmond)",LONGITUDE:144.991423,TICKETZONE:"1",ROUTEUSSP:"Mernda,Hurstbridge"},geometry:{type:"Point",coordinates:[144.991423087592,-37.81494900584843]}},{type:"Feature",properties:{STOP_ID:"19979",LATITUDE:-37.816527,STOP_NAME:"Jolimont-MCG Railway Station (East Melbourne)",LONGITUDE:144.984098,TICKETZONE:"1",ROUTEUSSP:"Mernda,Hurstbridge"},geometry:{type:"Point",coordinates:[144.9840981689869,-37.816526974237526]}},{type:"Feature",properties:{STOP_ID:"19983",LATITUDE:-37.726012,STOP_NAME:"Macleod Railway Station (Macleod)",LONGITUDE:145.069143,TICKETZONE:"2",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.06914313196347,-37.72601198852847]}},{type:"Feature",properties:{STOP_ID:"19984",LATITUDE:-37.710958,STOP_NAME:"Watsonia Railway Station (Watsonia)",LONGITUDE:145.083793,TICKETZONE:"2",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.08379299256393,-37.71095796058549]}},{type:"Feature",properties:{STOP_ID:"19985",LATITUDE:-37.703954,STOP_NAME:"Greensborough Railway Station (Greensborough)",LONGITUDE:145.108247,TICKETZONE:"2",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.10824705206068,-37.703953978517774]}},{type:"Feature",properties:{STOP_ID:"19986",LATITUDE:-37.715296,STOP_NAME:"Montmorency Railway Station (Montmorency)",LONGITUDE:145.121516,TICKETZONE:"2",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.121515927139,-37.715295960542775]}},{type:"Feature",properties:{STOP_ID:"19987",LATITUDE:-37.71355,STOP_NAME:"Eltham Railway Station (Eltham)",LONGITUDE:145.147822,TICKETZONE:"2",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.14782184864805,-37.71354996061303]}},{type:"Feature",properties:{STOP_ID:"19988",LATITUDE:-37.673297,STOP_NAME:"Diamond Creek Railway Station (Diamond Creek)",LONGITUDE:145.158506,TICKETZONE:"2",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.1585059320563,-37.67329701063555]}},{type:"Feature",properties:{STOP_ID:"19989",LATITUDE:-37.663968,STOP_NAME:"Wattle Glen Railway Station (Wattle Glen)",LONGITUDE:145.181615,TICKETZONE:"2",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.18161506467828,-37.66396797039701]}},{type:"Feature",properties:{STOP_ID:"19990",LATITUDE:-37.639398,STOP_NAME:"Hurstbridge Railway Station (Hurstbridge)",LONGITUDE:145.192017,TICKETZONE:"2",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.1920168942208,-37.639397969862365]}},{type:"Feature",properties:{STOP_ID:"19991",LATITUDE:-37.867753,STOP_NAME:"Williamstown Railway Station (Williamstown)",LONGITUDE:144.905323,TICKETZONE:"1",ROUTEUSSP:"Williamstown"},geometry:{type:"Point",coordinates:[144.90532295721854,-37.867752990404725]}},{type:"Feature",properties:{STOP_ID:"19992",LATITUDE:-37.863982,STOP_NAME:"Williamstown Beach Railway Station (Williamstown)",LONGITUDE:144.894484,TICKETZONE:"1",ROUTEUSSP:"Williamstown"},geometry:{type:"Point",coordinates:[144.89448409561462,-37.86398198938481]}},{type:"Feature",properties:{STOP_ID:"19993",LATITUDE:-37.857333,STOP_NAME:"North Williamstown Railway Station (Williamstown)",LONGITUDE:144.889069,TICKETZONE:"1",ROUTEUSSP:"Williamstown"},geometry:{type:"Point",coordinates:[144.88906897782545,-37.85733296977821]}},{type:"Feature",properties:{STOP_ID:"19994",LATITUDE:-37.842718,STOP_NAME:"Newport Railway Station (Newport)",LONGITUDE:144.8836,TICKETZONE:"1",ROUTEUSSP:"Williamstown,Werribee"},geometry:{type:"Point",coordinates:[144.88359986187862,-37.84271796018809]}},{type:"Feature",properties:{STOP_ID:"19995",LATITUDE:-37.830639,STOP_NAME:"Spotswood Railway Station (Spotswood)",LONGITUDE:144.885933,TICKETZONE:"1",ROUTEUSSP:"Williamstown,Werribee"},geometry:{type:"Point",coordinates:[144.8859330113764,-37.83063897072853]}},{type:"Feature",properties:{STOP_ID:"19996",LATITUDE:-37.81585,STOP_NAME:"Yarraville Railway Station (Yarraville)",LONGITUDE:144.889934,TICKETZONE:"1",ROUTEUSSP:"Williamstown,Werribee"},geometry:{type:"Point",coordinates:[144.8899340507632,-37.815849989791694]}},{type:"Feature",properties:{STOP_ID:"19997",LATITUDE:-37.809005,STOP_NAME:"Seddon Railway Station (Seddon)",LONGITUDE:144.895672,TICKETZONE:"1",ROUTEUSSP:"Williamstown,Werribee"},geometry:{type:"Point",coordinates:[144.89567208120746,-37.809005040754464]}},{type:"Feature",properties:{STOP_ID:"20000",LATITUDE:-37.701129,STOP_NAME:"Watergardens Railway Station (Sydenham)",LONGITUDE:144.77418,TICKETZONE:"2",ROUTEUSSP:"Sunbury"},geometry:{type:"Point",coordinates:[144.77418001840798,-37.70112896819069]}},{type:"Feature",properties:{STOP_ID:"20001",LATITUDE:-37.729279,STOP_NAME:"Keilor Plains Railway Station (St Albans)",LONGITUDE:144.793738,TICKETZONE:"2",ROUTEUSSP:"Sunbury"},geometry:{type:"Point",coordinates:[144.79373809136527,-37.72927898714574]}},{type:"Feature",properties:{STOP_ID:"20002",LATITUDE:-37.744861,STOP_NAME:"St Albans Railway Station (St Albans)",LONGITUDE:144.80005,TICKETZONE:"2",ROUTEUSSP:"Sunbury"},geometry:{type:"Point",coordinates:[144.8000499727449,-37.74486095681743]}},{type:"Feature",properties:{STOP_ID:"20003",LATITUDE:-37.760067,STOP_NAME:"Ginifer Railway Station (St Albans)",LONGITUDE:144.811348,TICKETZONE:"2",ROUTEUSSP:"Sunbury"},geometry:{type:"Point",coordinates:[144.81134785114367,-37.76006699999778]}},{type:"Feature",properties:{STOP_ID:"20004",LATITUDE:-37.777653,STOP_NAME:"Albion Railway Station (Sunshine North)",LONGITUDE:144.824704,TICKETZONE:"1,2",ROUTEUSSP:"Sunbury"},geometry:{type:"Point",coordinates:[144.82470386247024,-37.77765299958764]}},{type:"Feature",properties:{STOP_ID:"20005",LATITUDE:-37.652187,STOP_NAME:"Epping Railway Station (Epping)",LONGITUDE:145.031068,TICKETZONE:"2",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[145.03106807483192,-37.65218696812649]}},{type:"Feature",properties:{STOP_ID:"20006",LATITUDE:-37.665851,STOP_NAME:"Lalor Railway Station (Lalor)",LONGITUDE:145.017193,TICKETZONE:"2",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[145.01719296110826,-37.665851039818996]}},{type:"Feature",properties:{STOP_ID:"20007",LATITUDE:-37.680338,STOP_NAME:"Thomastown Railway Station (Thomastown)",LONGITUDE:145.014279,TICKETZONE:"2",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[145.01427914567134,-37.680337978698795]}},{type:"Feature",properties:{STOP_ID:"20008",LATITUDE:-37.69487,STOP_NAME:"Keon Park Railway Station (Thomastown)",LONGITUDE:145.011884,TICKETZONE:"2",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[145.01188405834273,-37.6948700083548]}},{type:"Feature",properties:{STOP_ID:"20009",LATITUDE:-37.707898,STOP_NAME:"Ruthven Railway Station (Reservoir)",LONGITUDE:145.009517,TICKETZONE:"2",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[145.00951704207858,-37.707897956372506]}},{type:"Feature",properties:{STOP_ID:"20010",LATITUDE:-37.716885,STOP_NAME:"Reservoir Railway Station (Reservoir)",LONGITUDE:145.006996,TICKETZONE:"1,2",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[145.00699596597707,-37.71688499694048]}},{type:"Feature",properties:{STOP_ID:"20011",LATITUDE:-37.728403,STOP_NAME:"Regent Railway Station (Reservoir)",LONGITUDE:145.002773,TICKETZONE:"1,2",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[145.00277316312736,-37.728403018220824]}},{type:"Feature",properties:{STOP_ID:"20012",LATITUDE:-37.738674,STOP_NAME:"Preston Railway Station (Preston)",LONGITUDE:145.000522,TICKETZONE:"1,2",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[145.00052208049493,-37.738673997291826]}},{type:"Feature",properties:{STOP_ID:"20013",LATITUDE:-37.745562,STOP_NAME:"Bell Railway Station (Preston)",LONGITUDE:145.000155,TICKETZONE:"1",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[145.00015487669162,-37.74556196740014]}},{type:"Feature",properties:{STOP_ID:"20014",LATITUDE:-37.755052,STOP_NAME:"Thornbury Railway Station (Thornbury)",LONGITUDE:144.998572,TICKETZONE:"1",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[144.99857195554867,-37.75505201755157]}},{type:"Feature",properties:{STOP_ID:"20015",LATITUDE:-37.764101,STOP_NAME:"Croxton Railway Station (Northcote)",LONGITUDE:144.997056,TICKETZONE:"1",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[144.99705601149938,-37.764100977920975]}},{type:"Feature",properties:{STOP_ID:"20016",LATITUDE:-37.769865,STOP_NAME:"Northcote Railway Station (Northcote)",LONGITUDE:144.995277,TICKETZONE:"1",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[144.99527690393882,-37.7698650286647]}},{type:"Feature",properties:{STOP_ID:"20017",LATITUDE:-37.777847,STOP_NAME:"Merri Railway Station (Northcote)",LONGITUDE:144.992972,TICKETZONE:"1",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[144.9929721934344,-37.77784704042674]}},{type:"Feature",properties:{STOP_ID:"20019",LATITUDE:-37.783217,STOP_NAME:"Rushall Railway Station (Fitzroy North)",LONGITUDE:144.992407,TICKETZONE:"1",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[144.99240699877623,-37.783216981751494]}},{type:"Feature",properties:{STOP_ID:"20021",LATITUDE:-37.788536,STOP_NAME:"Sunshine Railway Station (Sunshine)",LONGITUDE:144.832878,TICKETZONE:"1,2",ROUTEUSSP:"Sunbury"},geometry:{type:"Point",coordinates:[144.83287803702032,-37.78853598103241]}},{type:"Feature",properties:{STOP_ID:"20022",LATITUDE:-37.799251,STOP_NAME:"Tottenham Railway Station (West Footscray)",LONGITUDE:144.862945,TICKETZONE:"1",ROUTEUSSP:"Sunbury"},geometry:{type:"Point",coordinates:[144.86294482805647,-37.79925101953307]}},{type:"Feature",properties:{STOP_ID:"20023",LATITUDE:-37.801803,STOP_NAME:"West Footscray Railway Station (West Footscray)",LONGITUDE:144.883985,TICKETZONE:"1",ROUTEUSSP:"Sunbury"},geometry:{type:"Point",coordinates:[144.88398504854027,-37.80180296938542]}},{type:"Feature",properties:{STOP_ID:"20024",LATITUDE:-37.802505,STOP_NAME:"Middle Footscray Railway Station (Footscray)",LONGITUDE:144.891472,TICKETZONE:"1",ROUTEUSSP:"Sunbury"},geometry:{type:"Point",coordinates:[144.8914719665355,-37.802504970278676]}},{type:"Feature",properties:{STOP_ID:"20025",LATITUDE:-37.801083,STOP_NAME:"Footscray Railway Station (Footscray)",LONGITUDE:144.903199,TICKETZONE:"1",ROUTEUSSP:"Werribee,Williamstown,Sunbury"},geometry:{type:"Point",coordinates:[144.90319893797937,-37.80108297392747]}},{type:"Feature",properties:{STOP_ID:"20026",LATITUDE:-37.799531,STOP_NAME:"South Kensington Railway Station (Kensington)",LONGITUDE:144.925469,TICKETZONE:"1",ROUTEUSSP:"Williamstown,Werribee"},geometry:{type:"Point",coordinates:[144.92546896739066,-37.799531010135645]}},{type:"Feature",properties:{STOP_ID:"20027",LATITUDE:-37.787202,STOP_NAME:"Flemington Racecourse Railway Station (Flemington)",LONGITUDE:144.907589,TICKETZONE:"1",ROUTEUSSP:"Flemington Racecourse"},geometry:{type:"Point",coordinates:[144.907588697812,-37.787201923265]}},{type:"Feature",properties:{STOP_ID:"20028",LATITUDE:-37.783472,STOP_NAME:"Showgrounds Railway Station (Flemington)",LONGITUDE:144.914257,TICKETZONE:"1",ROUTEUSSP:"Flemington Racecourse"},geometry:{type:"Point",coordinates:[144.914256890322,-37.7834721968038]}},{type:"Feature",properties:{STOP_ID:"20030",LATITUDE:-37.683049,STOP_NAME:"Broadmeadows Railway Station (Broadmeadows)",LONGITUDE:144.919613,TICKETZONE:"2",ROUTEUSSP:"Craigieburn"},geometry:{type:"Point",coordinates:[144.91961320131395,-37.68304895729302]}},{type:"Feature",properties:{STOP_ID:"20031",LATITUDE:-37.695131,STOP_NAME:"Jacana Railway Station (Glenroy)",LONGITUDE:144.915851,TICKETZONE:"2",ROUTEUSSP:"Craigieburn"},geometry:{type:"Point",coordinates:[144.9158511944258,-37.695131010164516]}},{type:"Feature",properties:{STOP_ID:"20032",LATITUDE:-37.704536,STOP_NAME:"Glenroy Railway Station (Glenroy)",LONGITUDE:144.91722,TICKETZONE:"1,2",ROUTEUSSP:"Craigieburn"},geometry:{type:"Point",coordinates:[144.91721989592028,-37.70453600891375]}},{type:"Feature",properties:{STOP_ID:"20033",LATITUDE:-37.71795,STOP_NAME:"Oak Park Railway Station (Oak Park)",LONGITUDE:144.921519,TICKETZONE:"1,2",ROUTEUSSP:"Craigieburn"},geometry:{type:"Point",coordinates:[144.9215190050332,-37.71794996733691]}},{type:"Feature",properties:{STOP_ID:"20034",LATITUDE:-37.730756,STOP_NAME:"Pascoe Vale Railway Station (Pascoe Vale)",LONGITUDE:144.928196,TICKETZONE:"1,2",ROUTEUSSP:"Craigieburn"},geometry:{type:"Point",coordinates:[144.92819593517615,-37.73075597710179]}},{type:"Feature",properties:{STOP_ID:"20035",LATITUDE:-37.743591,STOP_NAME:"Strathmore Railway Station (Strathmore)",LONGITUDE:144.927316,TICKETZONE:"1",ROUTEUSSP:"Craigieburn"},geometry:{type:"Point",coordinates:[144.92731609110757,-37.74359096751782]}},{type:"Feature",properties:{STOP_ID:"20036",LATITUDE:-37.74721,STOP_NAME:"Glenbervie Railway Station (Essendon)",LONGITUDE:144.920939,TICKETZONE:"1",ROUTEUSSP:"Craigieburn"},geometry:{type:"Point",coordinates:[144.9209390576499,-37.74720995793417]}},{type:"Feature",properties:{STOP_ID:"20037",LATITUDE:-37.756012,STOP_NAME:"Essendon Railway Station (Essendon)",LONGITUDE:144.916198,TICKETZONE:"1",ROUTEUSSP:"Craigieburn"},geometry:{type:"Point",coordinates:[144.91619785779378,-37.75601195980886]}},{type:"Feature",properties:{STOP_ID:"20038",LATITUDE:-37.765707,STOP_NAME:"Moonee Ponds Railway Station (Moonee Ponds)",LONGITUDE:144.919161,TICKETZONE:"1",ROUTEUSSP:"Craigieburn"},geometry:{type:"Point",coordinates:[144.91916101804085,-37.765707029872225]}},{type:"Feature",properties:{STOP_ID:"20039",LATITUDE:-37.775306,STOP_NAME:"Ascot Vale Railway Station (Ascot Vale)",LONGITUDE:144.921821,TICKETZONE:"1",ROUTEUSSP:"Craigieburn"},geometry:{type:"Point",coordinates:[144.92182105511844,-37.775305978752286]}},{type:"Feature",properties:{STOP_ID:"20040",LATITUDE:-37.787328,STOP_NAME:"Newmarket Railway Station (Flemington)",LONGITUDE:144.928978,TICKETZONE:"1",ROUTEUSSP:"Craigieburn,Flemington Racecourse"},geometry:{type:"Point",coordinates:[144.9289778791842,-37.78732800123391]}},{type:"Feature",properties:{STOP_ID:"20041",LATITUDE:-37.79378,STOP_NAME:"Kensington Railway Station (Kensington)",LONGITUDE:144.930524,TICKETZONE:"1",ROUTEUSSP:"Craigieburn"},geometry:{type:"Point",coordinates:[144.93052408229383,-37.79378001234484]}},{type:"Feature",properties:{STOP_ID:"20042",LATITUDE:-37.819222,STOP_NAME:"Box Hill Railway Station (Box Hill)",LONGITUDE:145.121429,TICKETZONE:"2",ROUTEUSSP:"Lilydale,Belgrave"},geometry:{type:"Point",coordinates:[145.1214291542125,-37.819222033091656]}},{type:"Feature",properties:{STOP_ID:"22180",LATITUDE:-37.817936,STOP_NAME:"Southern Cross Railway Station (Melbourne City)",LONGITUDE:144.951411,TICKETZONE:"1",ROUTEUSSP:"Belgrave,Craigieburn,Cranbourne,Flemington Racecourse,Frankston,Glen Waverley,Hurstbridge,Lilydale,Mernda,Pakenham,Sandringham,Sunbury,Upfield,Werribee,Williamstown,Alamein"},geometry:{type:"Point",coordinates:[144.9514108850503,-37.81793601351573]}},{type:"Feature",properties:{STOP_ID:"40220",LATITUDE:-37.638231,STOP_NAME:"Roxburgh Park Railway Station (Roxburgh Park)",LONGITUDE:144.935404,TICKETZONE:"2",ROUTEUSSP:"Craigieburn"},geometry:{type:"Point",coordinates:[144.9354038580987,-37.63823102879973]}},{type:"Feature",properties:{STOP_ID:"40221",LATITUDE:-37.601817,STOP_NAME:"Craigieburn Railway Station (Craigieburn)",LONGITUDE:144.94332,TICKETZONE:"2",ROUTEUSSP:"Craigieburn"},geometry:{type:"Point",coordinates:[144.94331989483877,-37.6018170275946]}},{type:"Feature",properties:{STOP_ID:"44817",LATITUDE:-37.661003,STOP_NAME:"Coolaroo Railway Station (Coolaroo)",LONGITUDE:144.926056,TICKETZONE:"2",ROUTEUSSP:"Craigieburn"},geometry:{type:"Point",coordinates:[144.92605609416944,-37.6610030113571]}},{type:"Feature",properties:{STOP_ID:"45793",LATITUDE:-38.057341,STOP_NAME:"Lynbrook Railway Station (Lynbrook)",LONGITUDE:145.249275,TICKETZONE:"2",ROUTEUSSP:"Cranbourne"},geometry:{type:"Point",coordinates:[145.24927487781102,-38.057340961642154]}},{type:"Feature",properties:{STOP_ID:"45794",LATITUDE:-38.07129,STOP_NAME:"Cardinia Road Railway Station (Pakenham)",LONGITUDE:145.437791,TICKETZONE:"2",ROUTEUSSP:"Pakenham"},geometry:{type:"Point",coordinates:[145.43779105694023,-38.071289971320894]}},{type:"Feature",properties:{STOP_ID:"45795",LATITUDE:-37.649159,STOP_NAME:"South Morang Railway Station (South Morang)",LONGITUDE:145.067032,TICKETZONE:"2",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[145.0670320966615,-37.64915901306895]}},{type:"Feature",properties:{STOP_ID:"46468",LATITUDE:-37.869865,STOP_NAME:"Williams Landing Railway Station (Williams Landing)",LONGITUDE:144.747445,TICKETZONE:"2",ROUTEUSSP:"Werribee"},geometry:{type:"Point",coordinates:[144.74744497619167,-37.8698650235294]}},{type:"Feature",properties:{STOP_ID:"52095",LATITUDE:-37.958756,STOP_NAME:"Southland Railway Station (Cheltenham)",LONGITUDE:145.049121,TICKETZONE:"2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.0491210080803,-37.95875605115335]}},{type:"Feature",properties:{STOP_ID:"52159",LATITUDE:-37.644061,STOP_NAME:"Middle Gorge Railway Station (South Morang)",LONGITUDE:145.092144,TICKETZONE:"2",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[145.09214389829435,-37.644060959065094]}},{type:"Feature",properties:{STOP_ID:"52160",LATITUDE:-37.622995,STOP_NAME:"Hawkstowe Railway Station (South Morang)",LONGITUDE:145.097396,TICKETZONE:"2",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[145.0973959520007,-37.62299502042986]}},{type:"Feature",properties:{STOP_ID:"52161",LATITUDE:-37.602548,STOP_NAME:"Mernda Railway Station (Mernda)",LONGITUDE:145.100885,TICKETZONE:"2",ROUTEUSSP:"Mernda"},geometry:{type:"Point",coordinates:[145.1008850816138,-37.602548008693105]}},{type:"Feature",properties:{STOP_ID:"15351",LATITUDE:-37.579091,STOP_NAME:"Sunbury Railway Station (Sunbury)",LONGITUDE:144.727319,TICKETZONE:"2",ROUTEUSSP:"Sunbury"},geometry:{type:"Point",coordinates:[144.7273191965987,-37.579091041919106]}},{type:"Feature",properties:{STOP_ID:"15353",LATITUDE:-37.627017,STOP_NAME:"Diggers Rest Railway Station (Diggers Rest)",LONGITUDE:144.719922,TICKETZONE:"2",ROUTEUSSP:"Sunbury"},geometry:{type:"Point",coordinates:[144.719921894289,-37.62701703098356]}},{type:"Feature",properties:{STOP_ID:"19827",LATITUDE:-38.374235,STOP_NAME:"Stony Point Railway Station (Crib Point)",LONGITUDE:145.221837,TICKETZONE:"2",ROUTEUSSP:"Stony Point"},geometry:{type:"Point",coordinates:[145.2218371303087,-38.37423501463105]}},{type:"Feature",properties:{STOP_ID:"19828",LATITUDE:-38.366123,STOP_NAME:"Crib Point Railway Station (Crib Point)",LONGITUDE:145.204043,TICKETZONE:"2",ROUTEUSSP:"Stony Point"},geometry:{type:"Point",coordinates:[145.20404302458843,-38.366123042492156]}},{type:"Feature",properties:{STOP_ID:"19829",LATITUDE:-38.354033,STOP_NAME:"Morradoo Railway Station (Crib Point)",LONGITUDE:145.189602,TICKETZONE:"2",ROUTEUSSP:"Stony Point"},geometry:{type:"Point",coordinates:[145.18960200468328,-38.35403298231219]}},{type:"Feature",properties:{STOP_ID:"19830",LATITUDE:-38.33739,STOP_NAME:"Bittern Railway Station (Bittern)",LONGITUDE:145.178027,TICKETZONE:"2",ROUTEUSSP:"Stony Point"},geometry:{type:"Point",coordinates:[145.17802694776515,-38.33739000410354]}},{type:"Feature",properties:{STOP_ID:"19831",LATITUDE:-38.305659,STOP_NAME:"Hastings Railway Station (Hastings)",LONGITUDE:145.18598,TICKETZONE:"2",ROUTEUSSP:"Stony Point"},geometry:{type:"Point",coordinates:[145.18598004542605,-38.30565897380473]}},{type:"Feature",properties:{STOP_ID:"19832",LATITUDE:-38.259815,STOP_NAME:"Tyabb Railway Station (Tyabb)",LONGITUDE:145.186401,TICKETZONE:"2",ROUTEUSSP:"Stony Point"},geometry:{type:"Point",coordinates:[145.18640091121645,-38.25981504276969]}},{type:"Feature",properties:{STOP_ID:"19833",LATITUDE:-38.225342,STOP_NAME:"Somerville Railway Station (Somerville)",LONGITUDE:145.176245,TICKETZONE:"2",ROUTEUSSP:"Stony Point"},geometry:{type:"Point",coordinates:[145.17624495783332,-38.22534198465516]}},{type:"Feature",properties:{STOP_ID:"19834",LATITUDE:-38.194043,STOP_NAME:"Baxter Railway Station (Baxter)",LONGITUDE:145.160526,TICKETZONE:"2",ROUTEUSSP:"Stony Point"},geometry:{type:"Point",coordinates:[145.1605259068461,-38.194043042101164]}},{type:"Feature",properties:{STOP_ID:"19835",LATITUDE:-37.859308,STOP_NAME:"Glen Iris Railway Station (Glen Iris)",LONGITUDE:145.058225,TICKETZONE:"1",ROUTEUSSP:"Glen Waverley"},geometry:{type:"Point",coordinates:[145.0582250497741,-37.85930802724669]}},{type:"Feature",properties:{STOP_ID:"19836",LATITUDE:-38.152034,STOP_NAME:"Leawarra Railway Station (Frankston)",LONGITUDE:145.139534,TICKETZONE:"2",ROUTEUSSP:"Stony Point"},geometry:{type:"Point",coordinates:[145.1395339285365,-38.152034013128976]}},{type:"Feature",properties:{STOP_ID:"19837",LATITUDE:-37.868957,STOP_NAME:"Darling Railway Station (Malvern East)",LONGITUDE:145.062951,TICKETZONE:"1,2",ROUTEUSSP:"Glen Waverley"},geometry:{type:"Point",coordinates:[145.06295114201313,-37.86895701673703]}},{type:"Feature",properties:{STOP_ID:"19838",LATITUDE:-37.87693,STOP_NAME:"East Malvern Railway Station (Malvern East)",LONGITUDE:145.069393,TICKETZONE:"1,2",ROUTEUSSP:"Glen Waverley"},geometry:{type:"Point",coordinates:[145.06939298848198,-37.87693002547972]}},{type:"Feature",properties:{STOP_ID:"19839",LATITUDE:-37.874402,STOP_NAME:"Holmesglen Railway Station (Malvern East)",LONGITUDE:145.090662,TICKETZONE:"1,2",ROUTEUSSP:"Glen Waverley"},geometry:{type:"Point",coordinates:[145.09066211307118,-37.874402019247384]}},{type:"Feature",properties:{STOP_ID:"19840",LATITUDE:-37.873603,STOP_NAME:"Jordanville Railway Station (Mount Waverley)",LONGITUDE:145.11209,TICKETZONE:"2",ROUTEUSSP:"Glen Waverley"},geometry:{type:"Point",coordinates:[145.11209003619842,-37.87360300336732]}},{type:"Feature",properties:{STOP_ID:"19841",LATITUDE:-37.811981,STOP_NAME:"Flagstaff Railway Station (Melbourne City)",LONGITUDE:144.955654,TICKETZONE:"1",ROUTEUSSP:"Belgrave,Craigieburn,Cranbourne,Flemington Racecourse,Glen Waverley,Hurstbridge,Lilydale,Mernda,Pakenham,Sunbury,Upfield,Alamein"},geometry:{type:"Point",coordinates:[144.95565385897856,-37.811980983068906]}},{type:"Feature",properties:{STOP_ID:"19842",LATITUDE:-37.809939,STOP_NAME:"Melbourne Central Railway Station (Melbourne City)",LONGITUDE:144.962594,TICKETZONE:"1",ROUTEUSSP:"Belgrave,Craigieburn,Cranbourne,Flemington Racecourse,Glen Waverley,Hurstbridge,Lilydale,Mernda,Pakenham,Sunbury,Upfield,Alamein"},geometry:{type:"Point",coordinates:[144.9625939477722,-37.80993897219737]}},{type:"Feature",properties:{STOP_ID:"19843",LATITUDE:-37.811054,STOP_NAME:"Parliament Railway Station (Melbourne City)",LONGITUDE:144.972911,TICKETZONE:"1",ROUTEUSSP:"Belgrave,Craigieburn,Cranbourne,Flemington Racecourse,Glen Waverley,Hurstbridge,Lilydale,Mernda,Pakenham,Sunbury,Upfield,Alamein"},geometry:{type:"Point",coordinates:[144.9729111811868,-37.81105398311787]}},{type:"Feature",properties:{STOP_ID:"19844",LATITUDE:-37.909102,STOP_NAME:"Belgrave Railway Station (Belgrave)",LONGITUDE:145.355291,TICKETZONE:"2",ROUTEUSSP:"Belgrave"},geometry:{type:"Point",coordinates:[145.35529094228033,-37.90910196303172]}},{type:"Feature",properties:{STOP_ID:"19845",LATITUDE:-37.908118,STOP_NAME:"Tecoma Railway Station (Tecoma)",LONGITUDE:145.342995,TICKETZONE:"2",ROUTEUSSP:"Belgrave"},geometry:{type:"Point",coordinates:[145.3429951499282,-37.90811799418759]}},{type:"Feature",properties:{STOP_ID:"19846",LATITUDE:-37.903691,STOP_NAME:"Upwey Railway Station (Upwey)",LONGITUDE:145.331333,TICKETZONE:"2",ROUTEUSSP:"Belgrave"},geometry:{type:"Point",coordinates:[145.33133294736945,-37.903690983475485]}},{type:"Feature",properties:{STOP_ID:"19847",LATITUDE:-37.86832,STOP_NAME:"Alamein Railway Station (Ashburton)",LONGITUDE:145.079656,TICKETZONE:"1",ROUTEUSSP:"Alamein"},geometry:{type:"Point",coordinates:[145.0796558510017,-37.86831999881286]}},{type:"Feature",properties:{STOP_ID:"19848",LATITUDE:-37.861968,STOP_NAME:"Ashburton Railway Station (Ashburton)",LONGITUDE:145.081344,TICKETZONE:"1",ROUTEUSSP:"Alamein"},geometry:{type:"Point",coordinates:[145.08134389547052,-37.86196798070856]}},{type:"Feature",properties:{STOP_ID:"19849",LATITUDE:-37.851563,STOP_NAME:"Burwood Railway Station (Glen Iris)",LONGITUDE:145.080511,TICKETZONE:"1",ROUTEUSSP:"Alamein"},geometry:{type:"Point",coordinates:[145.08051084427572,-37.851562991336685]}},{type:"Feature",properties:{STOP_ID:"19850",LATITUDE:-37.843985,STOP_NAME:"Hartwell Railway Station (Camberwell)",LONGITUDE:145.07556,TICKETZONE:"1",ROUTEUSSP:"Alamein"},geometry:{type:"Point",coordinates:[145.0755601197322,-37.843984988466225]}},{type:"Feature",properties:{STOP_ID:"19851",LATITUDE:-37.835716,STOP_NAME:"Willison Railway Station (Camberwell)",LONGITUDE:145.070298,TICKETZONE:"1",ROUTEUSSP:"Alamein"},geometry:{type:"Point",coordinates:[145.07029800484113,-37.835715965394016]}},{type:"Feature",properties:{STOP_ID:"19852",LATITUDE:-37.831505,STOP_NAME:"Riversdale Railway Station (Camberwell)",LONGITUDE:145.069646,TICKETZONE:"1",ROUTEUSSP:"Alamein"},geometry:{type:"Point",coordinates:[145.0696460448304,-37.831505045420805]}},{type:"Feature",properties:{STOP_ID:"19853",LATITUDE:-37.826567,STOP_NAME:"Camberwell Railway Station (Camberwell)",LONGITUDE:145.058697,TICKETZONE:"1",ROUTEUSSP:"Belgrave,Lilydale,Alamein"},geometry:{type:"Point",coordinates:[145.05869701396765,-37.826567020894245]}},{type:"Feature",properties:{STOP_ID:"19854",LATITUDE:-37.818305,STOP_NAME:"Flinders Street Railway Station (Melbourne City)",LONGITUDE:144.966964,TICKETZONE:"1",ROUTEUSSP:"Belgrave,Craigieburn,Cranbourne,Flemington Racecourse,Frankston,Glen Waverley,Hurstbridge,Lilydale,Mernda,Pakenham,Sandringham,Sunbury,Upfield,Werribee,Williamstown,Alamein"},geometry:{type:"Point",coordinates:[144.96696399665555,-37.81830501305625]}},{type:"Feature",properties:{STOP_ID:"19855",LATITUDE:-38.14299,STOP_NAME:"Frankston Railway Station (Frankston)",LONGITUDE:145.126162,TICKETZONE:"2",ROUTEUSSP:"Stony Point,Frankston"},geometry:{type:"Point",coordinates:[145.12616208447614,-38.14299000537099]}},{type:"Feature",properties:{STOP_ID:"19856",LATITUDE:-38.121742,STOP_NAME:"Kananook Railway Station (Seaford)",LONGITUDE:145.135295,TICKETZONE:"2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.13529493934251,-38.12174199466812]}},{type:"Feature",properties:{STOP_ID:"19857",LATITUDE:-38.104021,STOP_NAME:"Seaford Railway Station (Seaford)",LONGITUDE:145.12823,TICKETZONE:"2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.12822994038072,-38.10402099378123]}},{type:"Feature",properties:{STOP_ID:"19858",LATITUDE:-38.076504,STOP_NAME:"Carrum Railway Station (Carrum)",LONGITUDE:145.122833,TICKETZONE:"2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.1228331806026,-38.076504033265415]}},{type:"Feature",properties:{STOP_ID:"19859",LATITUDE:-38.062945,STOP_NAME:"Bonbeach Railway Station (Bonbeach)",LONGITUDE:145.11968,TICKETZONE:"2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.11967993833284,-38.06294499455282]}},{type:"Feature",properties:{STOP_ID:"19860",LATITUDE:-38.051955,STOP_NAME:"Chelsea Railway Station (Chelsea)",LONGITUDE:145.116041,TICKETZONE:"2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.1160410561567,-38.05195500582945]}},{type:"Feature",properties:{STOP_ID:"19861",LATITUDE:-38.038056,STOP_NAME:"Edithvale Railway Station (Edithvale)",LONGITUDE:145.108536,TICKETZONE:"2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.10853614659555,-38.03805603411457]}},{type:"Feature",properties:{STOP_ID:"19862",LATITUDE:-38.02722,STOP_NAME:"Aspendale Railway Station (Aspendale)",LONGITUDE:145.10215,TICKETZONE:"2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.10215009763107,-38.02722003428127]}},{type:"Feature",properties:{STOP_ID:"19863",LATITUDE:-38.006583,STOP_NAME:"Mordialloc Railway Station (Mordialloc)",LONGITUDE:145.087659,TICKETZONE:"2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.08765900709295,-38.006583036530465]}},{type:"Feature",properties:{STOP_ID:"19864",LATITUDE:-37.993079,STOP_NAME:"Parkdale Railway Station (Parkdale)",LONGITUDE:145.076327,TICKETZONE:"2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.0763269243707,-37.993078985669186]}},{type:"Feature",properties:{STOP_ID:"19865",LATITUDE:-37.981865,STOP_NAME:"Mentone Railway Station (Mentone)",LONGITUDE:145.065166,TICKETZONE:"2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.06516585321697,-37.98186498543101]}},{type:"Feature",properties:{STOP_ID:"19866",LATITUDE:-37.96665,STOP_NAME:"Cheltenham Railway Station (Cheltenham)",LONGITUDE:145.054558,TICKETZONE:"2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.05455809320318,-37.96665004267008]}},{type:"Feature",properties:{STOP_ID:"19867",LATITUDE:-37.892672,STOP_NAME:"Upper Ferntree Gully Railway Station (Upper Ferntree Gully)",LONGITUDE:145.30753,TICKETZONE:"2",ROUTEUSSP:"Belgrave"},geometry:{type:"Point",coordinates:[145.30753010573622,-37.89267201519074]}},{type:"Feature",properties:{STOP_ID:"19868",LATITUDE:-37.881698,STOP_NAME:"Ferntree Gully Railway Station (Ferntree Gully)",LONGITUDE:145.295251,TICKETZONE:"2",ROUTEUSSP:"Belgrave"},geometry:{type:"Point",coordinates:[145.2952508595173,-37.88169804430563]}},{type:"Feature",properties:{STOP_ID:"19869",LATITUDE:-37.860452,STOP_NAME:"Boronia Railway Station (Boronia)",LONGITUDE:145.284385,TICKETZONE:"2",ROUTEUSSP:"Belgrave"},geometry:{type:"Point",coordinates:[145.28438498378276,-37.86045201284621]}},{type:"Feature",properties:{STOP_ID:"19870",LATITUDE:-37.84173,STOP_NAME:"Bayswater Railway Station (Bayswater)",LONGITUDE:145.268136,TICKETZONE:"2",ROUTEUSSP:"Belgrave"},geometry:{type:"Point",coordinates:[145.26813602050083,-37.84173003269863]}},{type:"Feature",properties:{STOP_ID:"19871",LATITUDE:-37.828322,STOP_NAME:"Heathmont Railway Station (Heathmont)",LONGITUDE:145.244555,TICKETZONE:"2",ROUTEUSSP:"Belgrave"},geometry:{type:"Point",coordinates:[145.24455493593294,-37.828322013500426]}},{type:"Feature",properties:{STOP_ID:"19872",LATITUDE:-37.948425,STOP_NAME:"Highett Railway Station (Highett)",LONGITUDE:145.041872,TICKETZONE:"2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.04187207003986,-37.948425037176236]}},{type:"Feature",properties:{STOP_ID:"19873",LATITUDE:-37.879504,STOP_NAME:"Glen Waverley Railway Station (Glen Waverley)",LONGITUDE:145.162058,TICKETZONE:"2",ROUTEUSSP:"Glen Waverley"},geometry:{type:"Point",coordinates:[145.16205804677077,-37.87950402884809]}},{type:"Feature",properties:{STOP_ID:"19874",LATITUDE:-37.87623,STOP_NAME:"Syndal Railway Station (Glen Waverley)",LONGITUDE:145.14978,TICKETZONE:"2",ROUTEUSSP:"Glen Waverley"},geometry:{type:"Point",coordinates:[145.14977988400065,-37.87623001198126]}},{type:"Feature",properties:{STOP_ID:"19875",LATITUDE:-37.875255,STOP_NAME:"Mount Waverley Railway Station (Mount Waverley)",LONGITUDE:145.128056,TICKETZONE:"2",ROUTEUSSP:"Glen Waverley"},geometry:{type:"Point",coordinates:[145.1280560390715,-37.87525504140691]}},{type:"Feature",properties:{STOP_ID:"19876",LATITUDE:-37.755518,STOP_NAME:"Lilydale Railway Station (Lilydale)",LONGITUDE:145.34771,TICKETZONE:"2",ROUTEUSSP:"Lilydale"},geometry:{type:"Point",coordinates:[145.34771006372208,-37.75551804148801]}},{type:"Feature",properties:{STOP_ID:"19877",LATITUDE:-37.784749,STOP_NAME:"Mooroolbark Railway Station (Mooroolbark)",LONGITUDE:145.312402,TICKETZONE:"2",ROUTEUSSP:"Lilydale"},geometry:{type:"Point",coordinates:[145.312401980717,-37.78474896242301]}},{type:"Feature",properties:{STOP_ID:"19878",LATITUDE:-37.795437,STOP_NAME:"Croydon Railway Station (Croydon)",LONGITUDE:145.280598,TICKETZONE:"2",ROUTEUSSP:"Lilydale"},geometry:{type:"Point",coordinates:[145.28059813649503,-37.795437003004096]}},{type:"Feature",properties:{STOP_ID:"19879",LATITUDE:-37.811968,STOP_NAME:"Ringwood East Railway Station (Ringwood East)",LONGITUDE:145.250191,TICKETZONE:"2",ROUTEUSSP:"Lilydale"},geometry:{type:"Point",coordinates:[145.25019111735213,-37.811968020901645]}},{type:"Feature",properties:{STOP_ID:"19880",LATITUDE:-38.080614,STOP_NAME:"Pakenham Railway Station (Pakenham)",LONGITUDE:145.486379,TICKETZONE:"2",ROUTEUSSP:"Pakenham"},geometry:{type:"Point",coordinates:[145.4863791670269,-38.080613971994666]}},{type:"Feature",properties:{STOP_ID:"19881",LATITUDE:-38.066146,STOP_NAME:"Officer Railway Station (Officer)",LONGITUDE:145.410987,TICKETZONE:"2",ROUTEUSSP:"Pakenham"},geometry:{type:"Point",coordinates:[145.41098691161596,-38.06614602358953]}},{type:"Feature",properties:{STOP_ID:"19882",LATITUDE:-38.050831,STOP_NAME:"Beaconsfield Railway Station (Beaconsfield)",LONGITUDE:145.366074,TICKETZONE:"2",ROUTEUSSP:"Pakenham"},geometry:{type:"Point",coordinates:[145.36607402041432,-38.05083099268969]}},{type:"Feature",properties:{STOP_ID:"19883",LATITUDE:-38.040408,STOP_NAME:"Berwick Railway Station (Berwick)",LONGITUDE:145.345726,TICKETZONE:"2",ROUTEUSSP:"Pakenham"},geometry:{type:"Point",coordinates:[145.345726106732,-38.04040800417337]}},{type:"Feature",properties:{STOP_ID:"19884",LATITUDE:-38.027809,STOP_NAME:"Narre Warren Railway Station (Narre Warren)",LONGITUDE:145.303969,TICKETZONE:"2",ROUTEUSSP:"Pakenham"},geometry:{type:"Point",coordinates:[145.30396899348813,-38.02780899067889]}},{type:"Feature",properties:{STOP_ID:"19885",LATITUDE:-38.01774,STOP_NAME:"Hallam Railway Station (Hallam)",LONGITUDE:145.269777,TICKETZONE:"2",ROUTEUSSP:"Pakenham"},geometry:{type:"Point",coordinates:[145.26977691372707,-38.0177399723026]}},{type:"Feature",properties:{STOP_ID:"19886",LATITUDE:-38.099537,STOP_NAME:"Cranbourne Railway Station (Cranbourne)",LONGITUDE:145.280599,TICKETZONE:"2",ROUTEUSSP:"Cranbourne"},geometry:{type:"Point",coordinates:[145.2805988876704,-38.099537015167755]}},{type:"Feature",properties:{STOP_ID:"19887",LATITUDE:-38.079,STOP_NAME:"Merinda Park Railway Station (Cranbourne North)",LONGITUDE:145.263511,TICKETZONE:"2",ROUTEUSSP:"Cranbourne"},geometry:{type:"Point",coordinates:[145.26351110606686,-38.07900000428343]}},{type:"Feature",properties:{STOP_ID:"19888",LATITUDE:-37.989968,STOP_NAME:"Dandenong Railway Station (Dandenong)",LONGITUDE:145.209725,TICKETZONE:"2",ROUTEUSSP:"Pakenham,Cranbourne"},geometry:{type:"Point",coordinates:[145.20972494168106,-37.98996804320864]}},{type:"Feature",properties:{STOP_ID:"19889",LATITUDE:-37.978255,STOP_NAME:"Yarraman Railway Station (Noble Park)",LONGITUDE:145.1916,TICKETZONE:"2",ROUTEUSSP:"Pakenham,Cranbourne"},geometry:{type:"Point",coordinates:[145.19160002133484,-37.97825499531765]}},{type:"Feature",properties:{STOP_ID:"19890",LATITUDE:-37.966628,STOP_NAME:"Noble Park Railway Station (Noble Park)",LONGITUDE:145.176325,TICKETZONE:"2",ROUTEUSSP:"Pakenham,Cranbourne"},geometry:{type:"Point",coordinates:[145.17632485727145,-37.96662798649904]}},{type:"Feature",properties:{STOP_ID:"19891",LATITUDE:-37.956505,STOP_NAME:"Sandown Park Railway Station (Springvale)",LONGITUDE:145.162826,TICKETZONE:"2",ROUTEUSSP:"Pakenham,Cranbourne"},geometry:{type:"Point",coordinates:[145.16282594045538,-37.9565049634813]}},{type:"Feature",properties:{STOP_ID:"19892",LATITUDE:-37.825894,STOP_NAME:"East Camberwell Railway Station (Camberwell)",LONGITUDE:145.06819,TICKETZONE:"1",ROUTEUSSP:"Lilydale,Belgrave"},geometry:{type:"Point",coordinates:[145.06818984612514,-37.82589399751228]}},{type:"Feature",properties:{STOP_ID:"19893",LATITUDE:-37.824485,STOP_NAME:"Canterbury Railway Station (Canterbury)",LONGITUDE:145.081224,TICKETZONE:"1,2",ROUTEUSSP:"Lilydale,Belgrave"},geometry:{type:"Point",coordinates:[145.08122400522683,-37.824485052015234]}},{type:"Feature",properties:{STOP_ID:"19894",LATITUDE:-37.8243,STOP_NAME:"Chatham Railway Station (Surrey Hills)",LONGITUDE:145.088648,TICKETZONE:"1,2",ROUTEUSSP:"Lilydale,Belgrave"},geometry:{type:"Point",coordinates:[145.08864792992347,-37.824300013259794]}},{type:"Feature",properties:{STOP_ID:"19895",LATITUDE:-37.824148,STOP_NAME:"Surrey Hills Railway Station (Surrey Hills)",LONGITUDE:145.098775,TICKETZONE:"1,2",ROUTEUSSP:"Lilydale,Belgrave"},geometry:{type:"Point",coordinates:[145.09877510312708,-37.82414800244947]}},{type:"Feature",properties:{STOP_ID:"19896",LATITUDE:-37.819427,STOP_NAME:"Mont Albert Railway Station (Mont Albert)",LONGITUDE:145.10553,TICKETZONE:"1,2",ROUTEUSSP:"Lilydale,Belgrave"},geometry:{type:"Point",coordinates:[145.1055301411415,-37.819427052222316]}},{type:"Feature",properties:{STOP_ID:"19897",LATITUDE:-37.82078,STOP_NAME:"Laburnum Railway Station (Blackburn)",LONGITUDE:145.140703,TICKETZONE:"2",ROUTEUSSP:"Lilydale,Belgrave"},geometry:{type:"Point",coordinates:[145.1407028348687,-37.82078002325073]}},{type:"Feature",properties:{STOP_ID:"19898",LATITUDE:-37.820071,STOP_NAME:"Blackburn Railway Station (Blackburn)",LONGITUDE:145.150014,TICKETZONE:"2",ROUTEUSSP:"Lilydale,Belgrave"},geometry:{type:"Point",coordinates:[145.1500138764687,-37.820071002378896]}},{type:"Feature",properties:{STOP_ID:"19899",LATITUDE:-37.820428,STOP_NAME:"Nunawading Railway Station (Nunawading)",LONGITUDE:145.175237,TICKETZONE:"2",ROUTEUSSP:"Lilydale,Belgrave"},geometry:{type:"Point",coordinates:[145.1752369288804,-37.82042802941446]}},{type:"Feature",properties:{STOP_ID:"19900",LATITUDE:-37.818087,STOP_NAME:"Mitcham Railway Station (Mitcham)",LONGITUDE:145.192892,TICKETZONE:"2",ROUTEUSSP:"Lilydale,Belgrave"},geometry:{type:"Point",coordinates:[145.1928920581536,-37.818087035153475]}},{type:"Feature",properties:{STOP_ID:"19901",LATITUDE:-37.818835,STOP_NAME:"Heatherdale Railway Station (Ringwood)",LONGITUDE:145.21355,TICKETZONE:"2",ROUTEUSSP:"Lilydale,Belgrave"},geometry:{type:"Point",coordinates:[145.21354994696432,-37.81883502338564]}},{type:"Feature",properties:{STOP_ID:"19902",LATITUDE:-37.81566,STOP_NAME:"Ringwood Railway Station (Ringwood)",LONGITUDE:145.229474,TICKETZONE:"2",ROUTEUSSP:"Lilydale,Belgrave"},geometry:{type:"Point",coordinates:[145.2294741698739,-37.81566000007894]}},{type:"Feature",properties:{STOP_ID:"19903",LATITUDE:-37.822398,STOP_NAME:"Auburn Railway Station (Hawthorn East)",LONGITUDE:145.045844,TICKETZONE:"1",ROUTEUSSP:"Belgrave,Lilydale,Alamein"},geometry:{type:"Point",coordinates:[145.04584392844583,-37.82239804230204]}},{type:"Feature",properties:{STOP_ID:"19904",LATITUDE:-37.821467,STOP_NAME:"Glenferrie Railway Station (Hawthorn)",LONGITUDE:145.036439,TICKETZONE:"1",ROUTEUSSP:"Belgrave,Lilydale,Alamein"},geometry:{type:"Point",coordinates:[145.03643891857303,-37.821466991314885]}},{type:"Feature",properties:{STOP_ID:"19905",LATITUDE:-37.821826,STOP_NAME:"Hawthorn Railway Station (Hawthorn)",LONGITUDE:145.022899,TICKETZONE:"1",ROUTEUSSP:"Belgrave,Lilydale,Alamein"},geometry:{type:"Point",coordinates:[145.02289894827368,-37.821825996611395]}},{type:"Feature",properties:{STOP_ID:"19906",LATITUDE:-37.82756,STOP_NAME:"Burnley Railway Station (Burnley)",LONGITUDE:145.007555,TICKETZONE:"1",ROUTEUSSP:"Belgrave,Glen Waverley,Lilydale,Alamein"},geometry:{type:"Point",coordinates:[145.0075550556105,-37.82755998022155]}},{type:"Feature",properties:{STOP_ID:"19907",LATITUDE:-37.8264,STOP_NAME:"East Richmond Railway Station (Richmond)",LONGITUDE:144.997066,TICKETZONE:"1",ROUTEUSSP:"Belgrave,Glen Waverley,Lilydale,Alamein"},geometry:{type:"Point",coordinates:[144.9970661029343,-37.82639997289394]}},{type:"Feature",properties:{STOP_ID:"19908",LATITUDE:-37.824074,STOP_NAME:"Richmond Railway Station (Richmond)",LONGITUDE:144.990164,TICKETZONE:"1",ROUTEUSSP:"Belgrave,Cranbourne,Frankston,Glen Waverley,Lilydale,Pakenham,Sandringham,Alamein"},geometry:{type:"Point",coordinates:[144.9901641806745,-37.82407401385715]}},{type:"Feature",properties:{STOP_ID:"19909",LATITUDE:-37.834672,STOP_NAME:"Heyington Railway Station (Toorak)",LONGITUDE:145.022635,TICKETZONE:"1",ROUTEUSSP:"Glen Waverley"},geometry:{type:"Point",coordinates:[145.02263508424622,-37.834671965373985]}},{type:"Feature",properties:{STOP_ID:"19910",LATITUDE:-37.839929,STOP_NAME:"Kooyong Railway Station (Kooyong)",LONGITUDE:145.033552,TICKETZONE:"1",ROUTEUSSP:"Glen Waverley"},geometry:{type:"Point",coordinates:[145.03355208421473,-37.839929048366116]}},{type:"Feature",properties:{STOP_ID:"19911",LATITUDE:-37.849366,STOP_NAME:"Tooronga Railway Station (Malvern)",LONGITUDE:145.041734,TICKETZONE:"1",ROUTEUSSP:"Glen Waverley"},geometry:{type:"Point",coordinates:[145.04173415478712,-37.84936599739654]}},{type:"Feature",properties:{STOP_ID:"19912",LATITUDE:-37.853279,STOP_NAME:"Gardiner Railway Station (Glen Iris)",LONGITUDE:145.051655,TICKETZONE:"1",ROUTEUSSP:"Glen Waverley"},geometry:{type:"Point",coordinates:[145.05165504987352,-37.85327901773509]}},{type:"Feature",properties:{STOP_ID:"19913",LATITUDE:-37.949509,STOP_NAME:"Springvale Railway Station (Springvale)",LONGITUDE:145.153452,TICKETZONE:"2",ROUTEUSSP:"Pakenham,Cranbourne"},geometry:{type:"Point",coordinates:[145.1534518921023,-37.94950899259216]}},{type:"Feature",properties:{STOP_ID:"19914",LATITUDE:-37.938491,STOP_NAME:"Westall Railway Station (Clayton South)",LONGITUDE:145.138833,TICKETZONE:"2",ROUTEUSSP:"Pakenham,Cranbourne"},geometry:{type:"Point",coordinates:[145.13883302874603,-37.938491011333234]}},{type:"Feature",properties:{STOP_ID:"19915",LATITUDE:-37.924683,STOP_NAME:"Clayton Railway Station (Clayton)",LONGITUDE:145.120534,TICKETZONE:"2",ROUTEUSSP:"Pakenham,Cranbourne"},geometry:{type:"Point",coordinates:[145.12053387025009,-37.92468303486988]}},{type:"Feature",properties:{STOP_ID:"19916",LATITUDE:-37.911017,STOP_NAME:"Huntingdale Railway Station (Oakleigh)",LONGITUDE:145.102364,TICKETZONE:"1,2",ROUTEUSSP:"Pakenham,Cranbourne"},geometry:{type:"Point",coordinates:[145.10236393324308,-37.911016990825836]}},{type:"Feature",properties:{STOP_ID:"19917",LATITUDE:-37.900372,STOP_NAME:"Oakleigh Railway Station (Oakleigh)",LONGITUDE:145.088308,TICKETZONE:"1,2",ROUTEUSSP:"Pakenham,Cranbourne"},geometry:{type:"Point",coordinates:[145.0883080921356,-37.90037196749365]}},{type:"Feature",properties:{STOP_ID:"19918",LATITUDE:-37.894881,STOP_NAME:"Hughesdale Railway Station (Hughesdale)",LONGITUDE:145.077635,TICKETZONE:"1,2",ROUTEUSSP:"Pakenham,Cranbourne"},geometry:{type:"Point",coordinates:[145.07763518406495,-37.89488097733909]}},{type:"Feature",properties:{STOP_ID:"19919",LATITUDE:-37.890198,STOP_NAME:"Murrumbeena Railway Station (Murrumbeena)",LONGITUDE:145.067375,TICKETZONE:"1",ROUTEUSSP:"Pakenham,Cranbourne"},geometry:{type:"Point",coordinates:[145.0673751866043,-37.89019800833117]}},{type:"Feature",properties:{STOP_ID:"19920",LATITUDE:-37.886241,STOP_NAME:"Carnegie Railway Station (Carnegie)",LONGITUDE:145.058575,TICKETZONE:"1",ROUTEUSSP:"Pakenham,Cranbourne"},geometry:{type:"Point",coordinates:[145.05857497723898,-37.886240976370786]}},{type:"Feature",properties:{STOP_ID:"19921",LATITUDE:-37.899378,STOP_NAME:"Werribee Railway Station (Werribee)",LONGITUDE:144.661118,TICKETZONE:"2",ROUTEUSSP:"Werribee"},geometry:{type:"Point",coordinates:[144.66111806209827,-37.89937800378759]}},{type:"Feature",properties:{STOP_ID:"19922",LATITUDE:-37.883276,STOP_NAME:"Hoppers Crossing Railway Station (Hoppers Crossing)",LONGITUDE:144.700955,TICKETZONE:"2",ROUTEUSSP:"Werribee"},geometry:{type:"Point",coordinates:[144.7009549451706,-37.88327601324334]}},{type:"Feature",properties:{STOP_ID:"19923",LATITUDE:-37.863694,STOP_NAME:"Laverton Railway Station (Laverton)",LONGITUDE:144.772617,TICKETZONE:"1,2",ROUTEUSSP:"Werribee"},geometry:{type:"Point",coordinates:[144.77261691069953,-37.863693995393945]}},{type:"Feature",properties:{STOP_ID:"19924",LATITUDE:-37.866606,STOP_NAME:"Aircraft Railway Station (Laverton)",LONGITUDE:144.760809,TICKETZONE:"2",ROUTEUSSP:"Werribee"},geometry:{type:"Point",coordinates:[144.7608088985207,-37.866606032750546]}},{type:"Feature",properties:{STOP_ID:"19925",LATITUDE:-37.865163,STOP_NAME:"Westona Railway Station (Altona)",LONGITUDE:144.813494,TICKETZONE:"1,2",ROUTEUSSP:"Werribee"},geometry:{type:"Point",coordinates:[144.81349417315855,-37.8651629765648]}},{type:"Feature",properties:{STOP_ID:"19926",LATITUDE:-37.867148,STOP_NAME:"Altona Railway Station (Altona)",LONGITUDE:144.829645,TICKETZONE:"1,2",ROUTEUSSP:"Werribee"},geometry:{type:"Point",coordinates:[144.82964484849458,-37.86714801409339]}},{type:"Feature",properties:{STOP_ID:"19927",LATITUDE:-37.867842,STOP_NAME:"Seaholme Railway Station (Seaholme)",LONGITUDE:144.840958,TICKETZONE:"1",ROUTEUSSP:"Werribee"},geometry:{type:"Point",coordinates:[144.84095784803088,-37.86784200270676]}},{type:"Feature",properties:{STOP_ID:"19928",LATITUDE:-37.780621,STOP_NAME:"Westgarth Railway Station (Northcote)",LONGITUDE:144.999233,TICKETZONE:"1",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[144.9992329526931,-37.780621021498604]}},{type:"Feature",properties:{STOP_ID:"19929",LATITUDE:-37.779187,STOP_NAME:"Dennis Railway Station (Northcote)",LONGITUDE:145.008242,TICKETZONE:"1",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.00824193502052,-37.779186960703825]}},{type:"Feature",properties:{STOP_ID:"19930",LATITUDE:-37.779171,STOP_NAME:"Fairfield Railway Station (Fairfield)",LONGITUDE:145.016905,TICKETZONE:"1",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.01690497413267,-37.77917103027729]}},{type:"Feature",properties:{STOP_ID:"19931",LATITUDE:-37.778394,STOP_NAME:"Alphington Railway Station (Alphington)",LONGITUDE:145.031255,TICKETZONE:"1",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.0312549420362,-37.778393970184325]}},{type:"Feature",properties:{STOP_ID:"19932",LATITUDE:-37.774963,STOP_NAME:"Darebin Railway Station (Ivanhoe)",LONGITUDE:145.038476,TICKETZONE:"1",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.0384761897359,-37.774962990239736]}},{type:"Feature",properties:{STOP_ID:"19933",LATITUDE:-37.768897,STOP_NAME:"Ivanhoe Railway Station (Ivanhoe)",LONGITUDE:145.045425,TICKETZONE:"1,2",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.0454249007254,-37.76889698950453]}},{type:"Feature",properties:{STOP_ID:"19934",LATITUDE:-37.763586,STOP_NAME:"Eaglemont Railway Station (Eaglemont)",LONGITUDE:145.053943,TICKETZONE:"1,2",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.0539428530202,-37.76358600115558]}},{type:"Feature",properties:{STOP_ID:"19935",LATITUDE:-37.757073,STOP_NAME:"Heidelberg Railway Station (Heidelberg)",LONGITUDE:145.060686,TICKETZONE:"1,2",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.06068602994233,-37.75707297186314]}},{type:"Feature",properties:{STOP_ID:"19936",LATITUDE:-37.742879,STOP_NAME:"Rosanna Railway Station (Rosanna)",LONGITUDE:145.06614,TICKETZONE:"2",ROUTEUSSP:"Hurstbridge"},geometry:{type:"Point",coordinates:[145.06614004306664,-37.74287898170107]}},{type:"Feature",properties:{STOP_ID:"19937",LATITUDE:-37.934353,STOP_NAME:"Moorabbin Railway Station (Moorabbin)",LONGITUDE:145.036738,TICKETZONE:"2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.0367381151247,-37.934352997334734]}},{type:"Feature",properties:{STOP_ID:"19938",LATITUDE:-37.925149,STOP_NAME:"Patterson Railway Station (Bentleigh)",LONGITUDE:145.03547,TICKETZONE:"2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.03547018698544,-37.9251489679829]}},{type:"Feature",properties:{STOP_ID:"19939",LATITUDE:-37.917425,STOP_NAME:"Bentleigh Railway Station (Bentleigh)",LONGITUDE:145.036995,TICKETZONE:"1,2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.0369951450514,-37.917424987593655]}},{type:"Feature",properties:{STOP_ID:"19940",LATITUDE:-37.910309,STOP_NAME:"McKinnon Railway Station (Mckinnon)",LONGITUDE:145.038299,TICKETZONE:"1,2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.03829905678242,-37.9103090471004]}},{type:"Feature",properties:{STOP_ID:"19941",LATITUDE:-37.903212,STOP_NAME:"Ormond Railway Station (Ormond)",LONGITUDE:145.039613,TICKETZONE:"1,2",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.0396130453646,-37.903212006932286]}},{type:"Feature",properties:{STOP_ID:"19942",LATITUDE:-37.889719,STOP_NAME:"Glenhuntly Railway Station (Glen Huntly)",LONGITUDE:145.042223,TICKETZONE:"1",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.04222302981012,-37.889719026839934]}},{type:"Feature",properties:{STOP_ID:"19943",LATITUDE:-37.877459,STOP_NAME:"Caulfield Railway Station (Caulfield East)",LONGITUDE:145.042525,TICKETZONE:"1",ROUTEUSSP:"Frankston,Pakenham,Cranbourne"},geometry:{type:"Point",coordinates:[145.04252511062438,-37.87745904950535]}},{type:"Feature",properties:{STOP_ID:"19944",LATITUDE:-37.866253,STOP_NAME:"Malvern Railway Station (Malvern)",LONGITUDE:145.029294,TICKETZONE:"1",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.02929401539313,-37.86625296743994]}},{type:"Feature",properties:{STOP_ID:"19945",LATITUDE:-37.856452,STOP_NAME:"Armadale Railway Station (Armadale)",LONGITUDE:145.019326,TICKETZONE:"1",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.0193259624038,-37.85645196640077]}},{type:"Feature",properties:{STOP_ID:"19946",LATITUDE:-37.850774,STOP_NAME:"Toorak Railway Station (Armadale)",LONGITUDE:145.013909,TICKETZONE:"1",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.01390904858653,-37.85077404613171]}},{type:"Feature",properties:{STOP_ID:"19947",LATITUDE:-37.844591,STOP_NAME:"Hawksburn Railway Station (South Yarra)",LONGITUDE:145.002142,TICKETZONE:"1",ROUTEUSSP:"Frankston"},geometry:{type:"Point",coordinates:[145.00214211386543,-37.84459104465304]}},{type:"Feature",properties:{STOP_ID:"19948",LATITUDE:-37.95033,STOP_NAME:"Sandringham Railway Station (Sandringham)",LONGITUDE:145.004561,TICKETZONE:"2",ROUTEUSSP:"Sandringham"},geometry:{type:"Point",coordinates:[145.00456092996131,-37.95032997678135]}},{type:"Feature",properties:{STOP_ID:"19949",LATITUDE:-37.937977,STOP_NAME:"Hampton Railway Station (Hampton)",LONGITUDE:145.001471,TICKETZONE:"2",ROUTEUSSP:"Sandringham"},geometry:{type:"Point",coordinates:[145.0014710475163,-37.93797702778554]}},{type:"Feature",properties:{STOP_ID:"19950",LATITUDE:-37.926484,STOP_NAME:"Brighton Beach Railway Station (Brighton)",LONGITUDE:144.989154,TICKETZONE:"1,2",ROUTEUSSP:"Sandringham"},geometry:{type:"Point",coordinates:[144.98915400748288,-37.92648402636408]}},{type:"Feature",properties:{STOP_ID:"19951",LATITUDE:-37.915134,STOP_NAME:"Middle Brighton Railway Station (Brighton)",LONGITUDE:144.996299,TICKETZONE:"1,2",ROUTEUSSP:"Sandringham"},geometry:{type:"Point",coordinates:[144.99629892106807,-37.91513403726259]}},{type:"Feature",properties:{STOP_ID:"19952",LATITUDE:-37.904887,STOP_NAME:"North Brighton Railway Station (Brighton)",LONGITUDE:145.002605,TICKETZONE:"1,2",ROUTEUSSP:"Sandringham"},geometry:{type:"Point",coordinates:[145.00260504023572,-37.904886999374064]}},{type:"Feature",properties:{STOP_ID:"19953",LATITUDE:-37.896695,STOP_NAME:"Gardenvale Railway Station (Brighton)",LONGITUDE:145.004168,TICKETZONE:"1",ROUTEUSSP:"Sandringham"},geometry:{type:"Point",coordinates:[145.0041681594568,-37.89669501891709]}},{type:"Feature",properties:{STOP_ID:"19954",LATITUDE:-37.884753,STOP_NAME:"Elsternwick Railway Station (Elsternwick)",LONGITUDE:145.000898,TICKETZONE:"1",ROUTEUSSP:"Sandringham"},geometry:{type:"Point",coordinates:[145.00089792626244,-37.88475300849933]}},{type:"Feature",properties:{STOP_ID:"19955",LATITUDE:-37.875906,STOP_NAME:"Ripponlea Railway Station (Ripponlea)",LONGITUDE:144.995237,TICKETZONE:"1",ROUTEUSSP:"Sandringham"},geometry:{type:"Point",coordinates:[144.99523695425376,-37.875906008374365]}},{type:"Feature",properties:{STOP_ID:"19956",LATITUDE:-37.869488,STOP_NAME:"Balaclava Railway Station (Balaclava)",LONGITUDE:144.993512,TICKETZONE:"1",ROUTEUSSP:"Sandringham"},geometry:{type:"Point",coordinates:[144.99351218235657,-37.869488016261954]}},{type:"Feature",properties:{STOP_ID:"19957",LATITUDE:-37.856053,STOP_NAME:"Windsor Railway Station (Windsor)",LONGITUDE:144.992035,TICKETZONE:"1",ROUTEUSSP:"Sandringham"},geometry:{type:"Point",coordinates:[144.99203509329004,-37.85605299340357]}},{type:"Feature",properties:{STOP_ID:"19958",LATITUDE:-37.849518,STOP_NAME:"Prahran Railway Station (Prahran)",LONGITUDE:144.98986,TICKETZONE:"1",ROUTEUSSP:"Sandringham"},geometry:{type:"Point",coordinates:[144.98985999271946,-37.849518003492406]}},{type:"Feature",properties:{STOP_ID:"19959",LATITUDE:-37.838449,STOP_NAME:"South Yarra Railway Station (South Yarra)",LONGITUDE:144.992342,TICKETZONE:"1",ROUTEUSSP:"Frankston,Pakenham,Sandringham,Cranbourne"},geometry:{type:"Point",coordinates:[144.99234219972408,-37.83844899324962]}},{type:"Feature",properties:{STOP_ID:"19960",LATITUDE:-37.666078,STOP_NAME:"Upfield Railway Station (Coolaroo)",LONGITUDE:144.94674,TICKETZONE:"2",ROUTEUSSP:"Upfield"},geometry:{type:"Point",coordinates:[144.94673986754253,-37.66607802131612]}},{type:"Feature",properties:{STOP_ID:"19961",LATITUDE:-37.700678,STOP_NAME:"Gowrie Railway Station (Glenroy)",LONGITUDE:144.958874,TICKETZONE:"2",ROUTEUSSP:"Upfield"},geometry:{type:"Point",coordinates:[144.95887403782967,-37.700677977421826]}},{type:"Feature",properties:{STOP_ID:"19962",LATITUDE:-37.714621,STOP_NAME:"Fawkner Railway Station (Fawkner)",LONGITUDE:144.960545,TICKETZONE:"1,2",ROUTEUSSP:"Upfield"},geometry:{type:"Point",coordinates:[144.96054517607726,-37.71462095840933]}},{type:"Feature",properties:{STOP_ID:"19963",LATITUDE:-37.720934,STOP_NAME:"Merlynston Railway Station (Coburg North)",LONGITUDE:144.961314,TICKETZONE:"1,2",ROUTEUSSP:"Upfield"},geometry:{type:"Point",coordinates:[144.96131413229386,-37.72093400681235]}},{type:"Feature",properties:{STOP_ID:"19964",LATITUDE:-37.733523,STOP_NAME:"Batman Railway Station (Coburg North)",LONGITUDE:144.962841,TICKETZONE:"1,2",ROUTEUSSP:"Upfield"},geometry:{type:"Point",coordinates:[144.96284088444295,-37.7335230271606]}},{type:"Feature",properties:{STOP_ID:"19965",LATITUDE:-37.742345,STOP_NAME:"Coburg Railway Station (Coburg)",LONGITUDE:144.963336,TICKETZONE:"1",ROUTEUSSP:"Upfield"},geometry:{type:"Point",coordinates:[144.96333587826746,-37.74234500853543]}},{type:"Feature",properties:{STOP_ID:"19966",LATITUDE:-37.754485,STOP_NAME:"Moreland Railway Station (Coburg)",LONGITUDE:144.961823,TICKETZONE:"1",ROUTEUSSP:"Upfield"},geometry:{type:"Point",coordinates:[144.96182315245065,-37.7544850178849]}},{type:"Feature",properties:{STOP_ID:"19967",LATITUDE:-37.761242,STOP_NAME:"Anstey Railway Station (Brunswick)",LONGITUDE:144.960684,TICKETZONE:"1",ROUTEUSSP:"Upfield"},geometry:{type:"Point",coordinates:[144.96068412503988,-37.761242037577134]}},{type:"Feature",properties:{STOP_ID:"19968",LATITUDE:-37.767721,STOP_NAME:"Brunswick Railway Station (Brunswick)",LONGITUDE:144.959587,TICKETZONE:"1",ROUTEUSSP:"Upfield"},geometry:{type:"Point",coordinates:[144.95958686111737,-37.767720957795504]}},{type:"Feature",properties:{STOP_ID:"19969",LATITUDE:-37.774987,STOP_NAME:"Jewell Railway Station (Brunswick)",LONGITUDE:144.958717,TICKETZONE:"1",ROUTEUSSP:"Upfield"},geometry:{type:"Point",coordinates:[144.95871710696892,-37.7749870197818]}}],NK={type:OK,name:DK,crs:RK,features:kK};let hl=NK.features;for(const e of hl)e.properties.nameUp=e.properties.STOP_NAME.replace(/ Railway Station.*$/,""),e.properties.nameUp==="Surrey Hills"?e.properties.nameUp="Union":e.properties.nameUp==="Glenhuntly"&&(e.properties.nameUp="Glen Huntly"),e.properties.lines=e.properties.ROUTEUSSP.toLowerCase().split(","),e.properties.name=e.properties.nameUp.toLowerCase();hl=hl.filter(e=>e.properties.name!=="mont albert");const Am=hl.map(e=>e.properties.name);window.s=hl;window.sn=Am;function FK(){const e=new Set;for(const t of hl)for(const n of t.properties.lines)e.add(n.toLowerCase());return[...e]}function uF(e,t){return ei(hl.find(n=>n.properties.name===e),hl.find(n=>n.properties.name===t))}window.sd=uF;function cF(e){const t=hl.filter(a=>a.properties.lines.includes(e));let n=t.find(a=>a.properties.name===e);if(!n)return[];let r=t.filter(a=>a.properties.name!==e);const i=[n];for(;r.length;)r.sort((a,l)=>ei(a,n)-ei(l,n)),n=r[0],i.push(n),r=r.filter(a=>a!==n);return i.map(a=>a.properties.name)}let Ep;function BK(){Ep=new Gi.Graph;function e(r,i){Ep.addEdge(r,i),Ep.addEdge(i,r)}window.gr=Ep;const t=FK();for(const r of hl)Ep.addNode(r.properties.name);const n=["Flinders Street","Southern Cross","Flagstaff","Melbourne Central","Parliament"].map(r=>r.toLowerCase());n.forEach((r,i)=>e(r,n[(i+1)%n.length]));try{e("flinders street","richmond"),e("flinders street","jolimont-mcg"),e("southern cross","north melbourne"),e("laverton","newport")}catch{}window.n=hl.map(r=>r.properties.name);for(const r of t){const i=cF(r);for(let a=0;a<i.length-1;a++)try{if(n.includes(i[a])&&n.includes(i[a+1]))continue;e(i[a],i[a+1])}catch{}}}function hF(e,t){return Ep||BK(),LK(Ep,e,t)}function yb(e){return hl.find(t=>t.properties.name===e)}function zK(e,t,n){const r=yb(e).properties.lines;let i=r.find(p=>yb(t).properties.lines.includes(p));i||(i=r[0]);const a=cF(i),l=a.indexOf(e);return a.slice(Math.max(l-2,0),l+3).map(p=>{const y=yb(p);if(e===y.properties.name)return y.properties.nameUp;if(n==3)return y.properties.nameUp.replace(/\b(\w)\w+/g,"$1").replace(/ /g,"");if(n===2)return y.properties.nameUp.split(" ").map(x=>x.replace(/\b(\w\w)(\w*)/g,(w,S,L)=>S+"_".repeat(L.length))).join(" ");if(n===1)return y.properties.nameUp.split(" ").map(x=>x.replace(/\b(\w\w)(\w*)(\w)\b/g,(w,S,L,D)=>S+"_".repeat(L.length)+D)).join(" ")}).join(", ")}const UK={class:"info-light3--bg",id:"map",style:{position:"absolute",width:"100%",height:"100%"}};function VK(e,t,n,r,i,a){return ta(),nu("div",UK)}const GK=(e,t)=>{const n=e.__vccOpts||e;for(const[r,i]of t)n[r]=i;return n};window.turf=DH;const $K={props:["guesses","target"],async mounted(){eT.accessToken="pk.eyJ1Ijoic3RldmFnZSIsImEiOiJjbG1vZGE4cXgwbjY4MmptcHN1d2M4YWYyIn0.AFsAhFFbMnuo9e3NgICpFw";const e=new eT.Map({container:"map",center:[144.96,-37.81],zoom:12,style:"mapbox://styles/mapbox/light-v9"});Tp.init(e,eT);const t=[...this.guesses,this.target].map(n=>hl.find(r=>r.properties.name===n));e.fitBounds(ao(An(t)),{padding:80}),window.map=e,window.mapping=this,e.U.onLoad(()=>{e.U.hide(/place-city/),e.U.addGeoJSON("trains","trainline.geojson"),e.U.addLine("trains-line","trains",{lineColor:"hsl(180,50%,70%)",lineWidth:5}),e.U.addLine("trains-line-inner","trains",{lineColor:"hsl(180,50%,85%)",lineWidth:3}),e.U.addSymbol("trains-label","trains",{symbolPlacement:"line",textField:["get","name"],textColor:"hsla(180,50%,50%, 50%)",textSize:28,textAllowOverlap:!0}),e.U.addGeoJSON("stations",An(hl)),e.U.addCircle("stations-circle","stations",{circleColor:["case",["==",["get","name"],this.target],"hsl(120,50%,70%)",["case",["in",["get","name"],["literal",this.guesses]],"hsl(0,70%,70%)","hsla(180,50%,80%,0.7)"]],circleRadius:["case",["==",["get","name"],this.target],6,["case",["in",["get","name"],["literal",this.guesses]],6,2]],circleStrokeWidth:2,circleStrokeColor:["case",["==",["get","name"],this.target],"hsl(120,100%,30%)",["case",["in",["get","name"],["literal",this.guesses]],"hsl(0,100%,30%)","hsla(180,50%,60%,0.5)"]]}),e.U.addSymbol("stations-label","stations",{textSize:16,textOffset:[.5,0],textField:["get","nameUp"],textHaloColor:"hsla(0,0%,100%,0.5)",textHaloWidth:1,textAnchor:"left",textAllowOverlap:!0,filter:["in",["get","name"],["literal",[...this.guesses,this.target]]]}),e.U.addSymbol("stations-label-small","stations",{textSize:12,textField:["get","nameUp"],textColor:"hsl(0,0%,50%)",textHaloColor:"hsla(0,0%,100%,0.5)",textHaloWidth:1,textAnchor:"left",textOffset:[.5,0],filter:["!",["in",["get","name"],["literal",[...this.guesses,this.target]]]],minzoom:11})})}},jK=GK($K,[["render",VK]]);var qK=function(e){var t=e%2147483647;t&&(t+=2147483646);function n(){return t=t*16807%2147483647}function r(){return(n()-1)/2147483646}return{seed:e,random:r,randomInt:n}};const ZK=Vs(qK);var XK=function(t,n){n=n||Math.random;const r=[];for(let i=0;i<t.length;++i){const a=Math.floor(n()*(i+1));a!==i&&(r[i]=r[a]),r[a]=t[i]}return r};const WK=Vs(XK),HK={style:{"flex-grow":"1"}},YK={class:"text-h4 text-lg-h2 text-center"},KK={key:0},JK={key:1},QK=ho("span",null,"",-1),eJ=ho("div",{class:"text-body-1"},"Each day there is a secret target station on Melbourne's metro train network.",-1),tJ=ho("div",{class:"text-body-1 mt-4"},"Guess a station to see how many stations to the target, and the distance as the crow flies.",-1),nJ={key:0,class:"text-body-1 mt-4"},rJ=ho("thead",null,[ho("tr",null,[ho("th",null,"Guess"),ho("th",null,"By train"),ho("th",null,"Crow flies")])],-1),iJ=ho("div",{id:"hint-box"},null,-1),oJ={style:{"font-family":"Lucida Console,courier new,monospace"}},aJ={key:1},sJ=["innerHTML"],lJ={key:2,class:"map-container",style:{width:"100%",height:"calc(max(50vh, 200px))",position:"relative"}},uJ=ho("div",{id:"game-over"},null,-1),cJ=ho("a",{href:"https://hire.stevebennett.me"},"Steve Bennett",-1),hJ={data:()=>({target:null,currentGuess:"",guesses:[],hints:[],alert:"",win:!1,fail:!1,gameNumber:0,hintsLeft:void 0,actions:[],hintsAllowed:3,hintBoxShowing:!1}),created(){window.app=this,this.restart()},methods:{titleCase(e){return e.split(" ").map(t=>t[0].toUpperCase()+t.slice(1)).join(" ")},actionSymbol(e){return e>20?"":e>5?"":""},normalizeRawGuess(e){let t=this.currentGuess.toLowerCase().trim();return t={jolimont:"jolimont-mcg"}[t]||t,t},makeGuess(){const e=this.normalizeRawGuess(this.currentGuess);if(this.guesses.map(r=>r.station).includes(e)){this.alert="You already guessed that station";return}if(!Am.includes(e)){this.alert="Invalid station name";return}this.alert="";const t=hF(this.target,e),n=Math.round(uF(this.target,e));this.guesses.push({station:e,stationUp:yb(e).properties.nameUp,result:t.length-1,distance:n}),this.actions.push(this.actionSymbol(t.length-1)),e===this.target&&(this.win=!0,this.actions.push(""),document.querySelector("#game-over").scrollIntoView({behaviour:"smooth"})),this.currentGuess="",this.updateCookie()},targetForGameNumber(e){const t=ZK(3411098),n=WK(Am,t.random);return n.slice(0,20),n[e%n.length]},getGameNumber(){return window.location.search.match(/game=\d\d\d\d/)?window.location.search.match(/game=(\d+)/)[1]:this.isUnlimited()?Math.floor(Math.random()*1e5+1e3):this.daysSinceStart},isUnlimited(){return window.location.search.match(/unlimited/)},testRandom(){const e={};for(let r=1;r<1e4;r++)e[app.targetForGameNumber(r)]=(e[app.targetForGameNumber(r)]||0)+1;const n=Object.values(e).sort();console.log(...n.slice(0,10),"...",...n.slice(-10)),console.log("expected",1e4/Am.length),console.log(`${Am.length-n.length} missing`)},restart(){this.win=!1,this.fail=!1,this.hintsLeft=this.hintsAllowed,this.guesses=[],this.hints=[],this.actions=[],this.gameNumber=this.getGameNumber(),this.target=this.targetForGameNumber(this.gameNumber),window.location.hostname!=="localhost"&&this.loadCookie()},giveup(){this.fail=!0,this.actions.push(""),this.updateCookie(),document.querySelector("#game-over").scrollIntoView({behaviour:"smooth"})},hint(){const e=zK(this.guesses.slice(-1)[0].station,this.target,this.hintsLeft);this.hintsLeft-=1,this.hints.push(e),this.actions.push(""),this.updateCookie()},copyWin(){navigator.clipboard.writeText(this.shareText)},updateCookie(){try{localStorage.setItem(this.gameNumber,JSON.stringify({guesses:this.guesses,hints:this.hints,actions:this.actions,hintsLeft:this.hintsLeft,win:this.win,fail:this.fail,gameNumber:this.gameNumber}))}catch(e){console.log(e)}},loadCookie(){try{const e=localStorage.getItem(this.gameNumber);if(e){const t=JSON.parse(e);if(this.gameNumber==3&&(t.win||t.fai)&&t.guesses.slice(-1)[0].station==="hurstbridge")return;this.guesses=t.guesses,this.hints=t.hints,this.actions=t.actions,this.hintsLeft=t.hintsLeft,this.win=t.win,this.fail=t.fail}}catch(e){console.log(e)}},validateStation(e){return!e||Am.includes(e.toLowerCase().trim())},needHint(){this.hintBoxShowing=!0,document.querySelector("#hint-box").scrollIntoView({behaviour:"smooth"})}},computed:{playing(){return!this.win&&!this.fail},daysSinceStart(){const e=new Date;e.setHours(0,0,0,0);const t=new Date("2023-09-19");t.setHours(0,0,0,0);const n=e.getTime()-t.getTime();return Math.floor(n/(1e3*60*60*24))+1},shareText(){return`I ${this.win?"solved":"gave up on"} Trainle #${this.gameNumber} ${this.win?"in":"after"} ${this.guesses.length} guesses${this.hintsLeft<this.hintsAllowed?" with "+(this.hintsAllowed-this.hintsLeft)+" hints":""}.
${this.actions.join("")}
 stevage.github.io/trainle${this.gameNumber!==this.daysSinceStart?`?game=${this.gameNumber}`:""}`}},watch:{}},fJ=Object.assign(hJ,{__name:"App",setup(e){return window.g=hF,(t,n)=>{const r=eu("v-sheet"),i=eu("v-btn"),a=eu("v-text-field"),l=eu("v-table"),o=eu("v-expand-transition"),f=eu("v-card-text"),p=eu("v-card-actions"),y=eu("v-card"),x=eu("v-footer"),w=eu("v-bottom-navigation"),S=eu("v-container"),L=eu("v-app");return ta(),Xf(L,null,{default:Vo(()=>[H(S,{class:"px-2 px-sm-4 px-md-6"},{default:Vo(()=>[ho("div",HK,[ho("h1",YK,[au(" Trainle"),t.isUnlimited()?(ta(),nu("span",KK," unlimited")):(ta(),nu("span",JK," #"+Mh(t.gameNumber),1)),QK]),H(r,{class:"my-5"},{default:Vo(()=>[eJ,tJ,t.isUnlimited()?(ta(),nu("div",nJ,"Refresh the page to get a new target station.")):Lh("",!0)]),_:1}),H(a,{label:"Guess a station",placeholder:"Flinders Street",modelValue:t.currentGuess,"onUpdate:modelValue":n[0]||(n[0]=D=>t.currentGuess=D),disabled:t.win||t.fail,onKeyup:[n[1]||(n[1]=D=>t.alert=""),LV(t.makeGuess,["enter"])],"error-messages":t.alert,autofocus:""},{append:Vo(()=>[H(i,{onClick:t.makeGuess,disabled:!t.currentGuess||t.win||t.fail},{default:Vo(()=>[au("Guess")]),_:1},8,["onClick","disabled"])]),_:1},8,["modelValue","disabled","onKeyup","error-messages"]),t.guesses.length?(ta(),nu("a",{key:0,class:"text-body-2 ml-4 mb-4",href:"#",style:{display:"block","margin-top":"-8px"},onClick:n[2]||(n[2]=AV((...D)=>t.needHint&&t.needHint(...D),["prevent"]))},"Need a hint?")):Lh("",!0),H(o,null,{default:Vo(()=>[t.guesses.length?(ta(),Xf(l,{key:0},{default:Vo(()=>[rJ,ho("tbody",null,[(ta(!0),nu(Dn,null,AL([...t.guesses].reverse(),(D,B)=>(ta(),nu("tr",null,[ho("th",null,Mh(D.stationUp),1),ho("td",null,Mh(t.actionSymbol(D.result))+""+Mh(D.result)+" "+Mh(D.result===1?"stop":"stops"),1),ho("td",null,Mh(D.distance)+" km",1)]))),256))])]),_:1})):Lh("",!0)]),_:1}),iJ,H(o,null,{default:Vo(()=>[go(H(y,{class:"mt-12 mb-12 bg-blue-lighten-6"},{default:Vo(()=>[H(f,null,{default:Vo(()=>[t.hints.length?(ta(),Xf(l,{key:0,class:"bg-blue-lighten-5",density:"compact"},{default:Vo(()=>[ho("tbody",null,[(ta(!0),nu(Dn,null,AL(t.hints,(D,B)=>(ta(),nu("tr",null,[ho("td",null,"Hint"+Mh(B+1),1),ho("td",null,[ho("span",oJ,Mh(D),1)])]))),256))])]),_:1})):(ta(),nu("p",aJ,"Each hint gives you clues about the names of stations near your last guess."))]),_:1}),t.playing?(ta(),Xf(p,{key:0},{default:Vo(()=>[t.hintsLeft>0&&t.guesses.length?(ta(),Xf(i,{key:0,variant:"tonal",onClick:t.hint},{default:Vo(()=>[au("Hint ("+Mh(t.hintsLeft)+" left)",1)]),_:1},8,["onClick"])):Lh("",!0),t.hintsLeft===0&&t.playing?(ta(),Xf(i,{key:1,class:"bg-blue-lighten-4",type:"submit",onClick:t.giveup},{default:Vo(()=>[au("Give up")]),_:1},8,["onClick"])):Lh("",!0)]),_:1})):Lh("",!0)]),_:1},512),[[Ec,t.guesses.length&&t.hintBoxShowing&&(t.hints.length||t.playing)]])]),_:1}),t.win||t.fail?(ta(),Xf(y,{key:1,class:uw(["elevation-8 my-2",{"bg-green-lighten-5":t.win,"bg-red-lighten-5":t.fail}]),style:{border:"1px solid hsl(180,0%,70%)"},title:`${t.win?"Yes! ":""}The station is ${t.titleCase(t.target)}.`},{default:Vo(()=>[H(f,null,{default:Vo(()=>[ho("div",{innerHTML:t.shareText.replace(/\n/g,"<br>")},null,8,sJ)]),_:1}),H(p,null,{default:Vo(()=>[H(i,{class:"my-4 bg-white",onClick:t.copyWin},{default:Vo(()=>[au("Copy text")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["title","class"])):Lh("",!0),t.fail||t.win?(ta(),nu("div",lJ,[H(jK,{guesses:t.guesses.map(D=>D.station),target:t.target},null,8,["guesses","target"])])):Lh("",!0),uJ,t.isUnlimited()&&(t.fail||t.win)?(ta(),nu("button",{key:3,id:"restart",type:"submit",onClick:n[3]||(n[3]=(...D)=>t.restart&&t.restart(...D))},"Play again")):Lh("",!0)]),H(w,null,{default:Vo(()=>[H(x,null,{default:Vo(()=>[au("Made by"),cJ,au(".")]),_:1})]),_:1})]),_:1})]),_:1})}}});const Yi=typeof window<"u",aP=Yi&&"IntersectionObserver"in window,dJ=Yi&&("ontouchstart"in window||window.navigator.maxTouchPoints>0);function S3(e,t,n){pJ(e,t),t.set(e,n)}function pJ(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gJ(e,t,n){var r=fF(e,t,"set");return mJ(e,r,n),n}function mJ(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function yp(e,t){var n=fF(e,t,"get");return yJ(e,n)}function fF(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function yJ(e,t){return t.get?t.get.call(e):t.value}function dF(e,t,n){const r=t.length-1;if(r<0)return e===void 0?n:e;for(let i=0;i<r;i++){if(e==null)return n;e=e[t[i]]}return e==null||e[t[r]]===void 0?n:e[t[r]]}function Ry(e,t){if(e===t)return!0;if(e instanceof Date&&t instanceof Date&&e.getTime()!==t.getTime()||e!==Object(e)||t!==Object(t))return!1;const n=Object.keys(e);return n.length!==Object.keys(t).length?!1:n.every(r=>Ry(e[r],t[r]))}function RI(e,t,n){return e==null||!t||typeof t!="string"?n:e[t]!==void 0?e[t]:(t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,""),dF(e,t.split("."),n))}function Wc(e,t,n){if(t==null)return e===void 0?n:e;if(e!==Object(e)){if(typeof t!="function")return n;const i=t(e,n);return typeof i>"u"?n:i}if(typeof t=="string")return RI(e,t,n);if(Array.isArray(t))return dF(e,t,n);if(typeof t!="function")return n;const r=t(e,n);return typeof r>"u"?n:r}function Fh(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Array.from({length:e},(n,r)=>t+r)}function dn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"px";if(!(e==null||e===""))return isNaN(+e)?String(e):isFinite(+e)?`${Number(e)}${t}`:void 0}function Jb(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function kI(e){return e&&"$el"in e?e.$el:e}const T3=Object.freeze({enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,end:35,home:36,del:46,backspace:8,insert:45,pageup:33,pagedown:34,shift:16}),NI=Object.freeze({enter:"Enter",tab:"Tab",delete:"Delete",esc:"Escape",space:"Space",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",end:"End",home:"Home",del:"Delete",backspace:"Backspace",insert:"Insert",pageup:"PageUp",pagedown:"PageDown",shift:"Shift"});function pF(e){return Object.keys(e)}function Ip(e,t){return t.every(n=>e.hasOwnProperty(n))}function ng(e,t,n){const r=Object.create(null),i=Object.create(null);for(const a in e)t.some(l=>l instanceof RegExp?l.test(a):l===a)&&!(n!=null&&n.some(l=>l===a))?r[a]=e[a]:i[a]=e[a];return[r,i]}function Mu(e,t){const n={...e};return t.forEach(r=>delete n[r]),n}const gF=/^on[^a-z]/,sP=e=>gF.test(e),vJ=["onAfterscriptexecute","onAnimationcancel","onAnimationend","onAnimationiteration","onAnimationstart","onAuxclick","onBeforeinput","onBeforescriptexecute","onChange","onClick","onCompositionend","onCompositionstart","onCompositionupdate","onContextmenu","onCopy","onCut","onDblclick","onFocusin","onFocusout","onFullscreenchange","onFullscreenerror","onGesturechange","onGestureend","onGesturestart","onGotpointercapture","onInput","onKeydown","onKeypress","onKeyup","onLostpointercapture","onMousedown","onMousemove","onMouseout","onMouseover","onMouseup","onMousewheel","onPaste","onPointercancel","onPointerdown","onPointerenter","onPointerleave","onPointermove","onPointerout","onPointerover","onPointerup","onReset","onSelect","onSubmit","onTouchcancel","onTouchend","onTouchmove","onTouchstart","onTransitioncancel","onTransitionend","onTransitionrun","onTransitionstart","onWheel"];function fg(e){const[t,n]=ng(e,[gF]),r=Mu(t,vJ),[i,a]=ng(n,["class","style","id",/^data-/]);return Object.assign(i,t),Object.assign(a,r),[i,a]}function Pl(e){return e==null?[]:Array.isArray(e)?e:[e]}function ps(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(t,Math.min(n,e))}function I3(e){const t=e.toString().trim();return t.includes(".")?t.length-t.indexOf(".")-1:0}function C3(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0";return e+n.repeat(Math.max(0,t-e.length))}function _J(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const n=[];let r=0;for(;r<e.length;)n.push(e.substr(r,t)),r+=t;return n}function P3(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;if(e<t)return`${e} B`;const n=t===1024?["Ki","Mi","Gi"]:["k","M","G"];let r=-1;for(;Math.abs(e)>=t&&r<n.length-1;)e/=t,++r;return`${e.toFixed(1)} ${n[r]}B`}function uu(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r={};for(const i in e)r[i]=e[i];for(const i in t){const a=e[i],l=t[i];if(Jb(a)&&Jb(l)){r[i]=uu(a,l,n);continue}if(Array.isArray(a)&&Array.isArray(l)&&n){r[i]=n(a,l);continue}r[i]=l}return r}function mF(e){return e.map(t=>t.type===Dn?mF(t.children):t).flat()}function Dp(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(Dp.cache.has(e))return Dp.cache.get(e);const t=e.replace(/[^a-z]/gi,"-").replace(/\B([A-Z])/g,"-$1").toLowerCase();return Dp.cache.set(e,t),t}Dp.cache=new Map;function Y_(e,t){if(!t||typeof t!="object")return[];if(Array.isArray(t))return t.map(n=>Y_(e,n)).flat(1);if(Array.isArray(t.children))return t.children.map(n=>Y_(e,n)).flat(1);if(t.component){if(Object.getOwnPropertySymbols(t.component.provides).includes(e))return[t.component];if(t.component.subTree)return Y_(e,t.component.subTree).flat(1)}return[]}var nb=new WeakMap,wm=new WeakMap;class xJ{constructor(t){S3(this,nb,{writable:!0,value:[]}),S3(this,wm,{writable:!0,value:0}),this.size=t}push(t){yp(this,nb)[yp(this,wm)]=t,gJ(this,wm,(yp(this,wm)+1)%this.size)}values(){return yp(this,nb).slice(yp(this,wm)).concat(yp(this,nb).slice(0,yp(this,wm)))}}function bJ(e){return"touches"in e?{clientX:e.touches[0].clientX,clientY:e.touches[0].clientY}:{clientX:e.clientX,clientY:e.clientY}}function lP(e){const t=Qs({}),n=fe(e);return Nl(()=>{for(const r in n.value)t[r]=n.value[r]},{flush:"sync"}),TC(t)}function Qb(e,t){return e.includes(t)}function yF(e){return e[2].toLowerCase()+e.slice(3)}const Jc=()=>[Function,Array];function A3(e,t){return t="on"+rf(t),!!(e[t]||e[`${t}Once`]||e[`${t}Capture`]||e[`${t}OnceCapture`]||e[`${t}CaptureOnce`])}function uP(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(Array.isArray(e))for(const i of e)i(...n);else typeof e=="function"&&e(...n)}function O0(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=["button","[href]",'input:not([type="hidden"])',"select","textarea","[tabindex]"].map(r=>`${r}${t?':not([tabindex="-1"])':""}:not([disabled])`).join(", ");return[...e.querySelectorAll(n)]}function vF(e,t,n){let r,i=e.indexOf(document.activeElement);const a=t==="next"?1:-1;do i+=a,r=e[i];while((!r||r.offsetParent==null||!((n==null?void 0:n(r))??!0))&&i<e.length&&i>=0);return r}function ew(e,t){var r,i,a,l;const n=O0(e);if(!t)(e===document.activeElement||!e.contains(document.activeElement))&&((r=n[0])==null||r.focus());else if(t==="first")(i=n[0])==null||i.focus();else if(t==="last")(a=n.at(-1))==null||a.focus();else if(typeof t=="number")(l=n[t])==null||l.focus();else{const o=vF(n,t);o?o.focus():ew(e,t==="next"?"first":"last")}}function _F(){}function _y(e,t){if(!(Yi&&typeof CSS<"u"&&typeof CSS.supports<"u"&&CSS.supports(`selector(${t})`)))return null;try{return!!e&&e.matches(t)}catch{return null}}const xF=["top","bottom"],wJ=["start","end","left","right"];function FI(e,t){let[n,r]=e.split(" ");return r||(r=Qb(xF,n)?"start":Qb(wJ,n)?"top":"center"),{side:BI(n,t),align:BI(r,t)}}function BI(e,t){return e==="start"?t?"right":"left":e==="end"?t?"left":"right":e}function OT(e){return{side:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.side],align:e.align}}function DT(e){return{side:e.side,align:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.align]}}function M3(e){return{side:e.align,align:e.side}}function L3(e){return Qb(xF,e.side)?"y":"x"}class jm{constructor(t){let{x:n,y:r,width:i,height:a}=t;this.x=n,this.y=r,this.width=i,this.height=a}get top(){return this.y}get bottom(){return this.y+this.height}get left(){return this.x}get right(){return this.x+this.width}}function O3(e,t){return{x:{before:Math.max(0,t.left-e.left),after:Math.max(0,e.right-t.right)},y:{before:Math.max(0,t.top-e.top),after:Math.max(0,e.bottom-t.bottom)}}}function cP(e){const t=e.getBoundingClientRect(),n=getComputedStyle(e),r=n.transform;if(r){let i,a,l,o,f;if(r.startsWith("matrix3d("))i=r.slice(9,-1).split(/, /),a=+i[0],l=+i[5],o=+i[12],f=+i[13];else if(r.startsWith("matrix("))i=r.slice(7,-1).split(/, /),a=+i[0],l=+i[3],o=+i[4],f=+i[5];else return new jm(t);const p=n.transformOrigin,y=t.x-o-(1-a)*parseFloat(p),x=t.y-f-(1-l)*parseFloat(p.slice(p.indexOf(" ")+1)),w=a?t.width/a:e.offsetWidth+1,S=l?t.height/l:e.offsetHeight+1;return new jm({x:y,y:x,width:w,height:S})}else return new jm(t)}function Cp(e,t,n){if(typeof e.animate>"u")return{finished:Promise.resolve()};let r;try{r=e.animate(t,n)}catch{return{finished:Promise.resolve()}}return typeof r.finished>"u"&&(r.finished=new Promise(i=>{r.onfinish=()=>{i(r)}})),r}const vb=new WeakMap;function EJ(e,t){Object.keys(t).forEach(n=>{if(sP(n)){const r=yF(n),i=vb.get(e);if(t[n]==null)i==null||i.forEach(a=>{const[l,o]=a;l===r&&(e.removeEventListener(r,o),i.delete(a))});else if(!i||![...i].some(a=>a[0]===r&&a[1]===t[n])){e.addEventListener(r,t[n]);const a=i||new Set;a.add([r,t[n]]),vb.has(e)||vb.set(e,a)}}else t[n]==null?e.removeAttribute(n):e.setAttribute(n,t[n])})}function SJ(e,t){Object.keys(t).forEach(n=>{if(sP(n)){const r=yF(n),i=vb.get(e);i==null||i.forEach(a=>{const[l,o]=a;l===r&&(e.removeEventListener(r,o),i.delete(a))})}else e.removeAttribute(n)})}const Em=2.4,D3=.2126729,R3=.7151522,k3=.072175,TJ=.55,IJ=.58,CJ=.57,PJ=.62,rb=.03,N3=1.45,AJ=5e-4,MJ=1.25,LJ=1.25,F3=.078,B3=12.82051282051282,ib=.06,z3=.001;function U3(e,t){const n=(e.r/255)**Em,r=(e.g/255)**Em,i=(e.b/255)**Em,a=(t.r/255)**Em,l=(t.g/255)**Em,o=(t.b/255)**Em;let f=n*D3+r*R3+i*k3,p=a*D3+l*R3+o*k3;if(f<=rb&&(f+=(rb-f)**N3),p<=rb&&(p+=(rb-p)**N3),Math.abs(p-f)<AJ)return 0;let y;if(p>f){const x=(p**TJ-f**IJ)*MJ;y=x<z3?0:x<F3?x-x*B3*ib:x-ib}else{const x=(p**PJ-f**CJ)*LJ;y=x>-z3?0:x>-F3?x-x*B3*ib:x+ib}return y*100}function OJ(e,t){t=Array.isArray(t)?t.slice(0,-1).map(n=>`'${n}'`).join(", ")+` or '${t.at(-1)}'`:`'${t}'`}const tw=.20689655172413793,DJ=e=>e>tw**3?Math.cbrt(e):e/(3*tw**2)+4/29,RJ=e=>e>tw?e**3:3*tw**2*(e-4/29);function bF(e){const t=DJ,n=t(e[1]);return[116*n-16,500*(t(e[0]/.95047)-n),200*(n-t(e[2]/1.08883))]}function wF(e){const t=RJ,n=(e[0]+16)/116;return[t(n+e[1]/500)*.95047,t(n),t(n-e[2]/200)*1.08883]}const kJ=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],NJ=e=>e<=.0031308?e*12.92:1.055*e**(1/2.4)-.055,FJ=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],BJ=e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4;function EF(e){const t=Array(3),n=NJ,r=kJ;for(let i=0;i<3;++i)t[i]=Math.round(ps(n(r[i][0]*e[0]+r[i][1]*e[1]+r[i][2]*e[2]))*255);return{r:t[0],g:t[1],b:t[2]}}function hP(e){let{r:t,g:n,b:r}=e;const i=[0,0,0],a=BJ,l=FJ;t=a(t/255),n=a(n/255),r=a(r/255);for(let o=0;o<3;++o)i[o]=l[o][0]*t+l[o][1]*n+l[o][2]*r;return i}function V3(e){return!!e&&/^(#|var\(--|(rgb|hsl)a?\()/.test(e)}const G3=/^(?<fn>(?:rgb|hsl)a?)\((?<values>.+)\)/,zJ={rgb:(e,t,n,r)=>({r:e,g:t,b:n,a:r}),rgba:(e,t,n,r)=>({r:e,g:t,b:n,a:r}),hsl:(e,t,n,r)=>$3({h:e,s:t,l:n,a:r}),hsla:(e,t,n,r)=>$3({h:e,s:t,l:n,a:r}),hsv:(e,t,n,r)=>ef({h:e,s:t,v:n,a:r}),hsva:(e,t,n,r)=>ef({h:e,s:t,v:n,a:r})};function cu(e){if(typeof e=="number")return{r:(e&16711680)>>16,g:(e&65280)>>8,b:e&255};if(typeof e=="string"&&G3.test(e)){const{groups:t}=e.match(G3),{fn:n,values:r}=t,i=r.split(/,\s*/).map(a=>a.endsWith("%")&&["hsl","hsla","hsv","hsva"].includes(n)?parseFloat(a)/100:parseFloat(a));return zJ[n](...i)}else if(typeof e=="string"){let t=e.startsWith("#")?e.slice(1):e;return[3,4].includes(t.length)?t=t.split("").map(n=>n+n).join(""):[6,8].includes(t.length),PF(t)}else if(typeof e=="object"){if(Ip(e,["r","g","b"]))return e;if(Ip(e,["h","s","l"]))return ef(fP(e));if(Ip(e,["h","s","v"]))return ef(e)}throw new TypeError(`Invalid color: ${e==null?e:String(e)||e.constructor.name}
Expected #hex, #hexa, rgb(), rgba(), hsl(), hsla(), object or number`)}function ef(e){const{h:t,s:n,v:r,a:i}=e,a=o=>{const f=(o+t/60)%6;return r-r*n*Math.max(Math.min(f,4-f,1),0)},l=[a(5),a(3),a(1)].map(o=>Math.round(o*255));return{r:l[0],g:l[1],b:l[2],a:i}}function $3(e){return ef(fP(e))}function Kw(e){if(!e)return{h:0,s:1,v:1,a:1};const t=e.r/255,n=e.g/255,r=e.b/255,i=Math.max(t,n,r),a=Math.min(t,n,r);let l=0;i!==a&&(i===t?l=60*(0+(n-r)/(i-a)):i===n?l=60*(2+(r-t)/(i-a)):i===r&&(l=60*(4+(t-n)/(i-a)))),l<0&&(l=l+360);const o=i===0?0:(i-a)/i,f=[l,o,i];return{h:f[0],s:f[1],v:f[2],a:e.a}}function SF(e){const{h:t,s:n,v:r,a:i}=e,a=r-r*n/2,l=a===1||a===0?0:(r-a)/Math.min(a,1-a);return{h:t,s:l,l:a,a:i}}function fP(e){const{h:t,s:n,l:r,a:i}=e,a=r+n*Math.min(r,1-r),l=a===0?0:2-2*r/a;return{h:t,s:l,v:a,a:i}}function TF(e){let{r:t,g:n,b:r,a:i}=e;return i===void 0?`rgb(${t}, ${n}, ${r})`:`rgba(${t}, ${n}, ${r}, ${i})`}function IF(e){return TF(ef(e))}function ob(e){const t=Math.round(e).toString(16);return("00".substr(0,2-t.length)+t).toUpperCase()}function CF(e){let{r:t,g:n,b:r,a:i}=e;return`#${[ob(t),ob(n),ob(r),i!==void 0?ob(Math.round(i*255)):""].join("")}`}function PF(e){e=VJ(e);let[t,n,r,i]=_J(e,2).map(a=>parseInt(a,16));return i=i===void 0?i:i/255,{r:t,g:n,b:r,a:i}}function UJ(e){const t=PF(e);return Kw(t)}function AF(e){return CF(ef(e))}function VJ(e){return e.startsWith("#")&&(e=e.slice(1)),e=e.replace(/([^0-9a-f])/gi,"F"),(e.length===3||e.length===4)&&(e=e.split("").map(t=>t+t).join("")),e.length!==6&&(e=C3(C3(e,6),8,"F")),e}function GJ(e,t){const n=bF(hP(e));return n[0]=n[0]+t*10,EF(wF(n))}function $J(e,t){const n=bF(hP(e));return n[0]=n[0]-t*10,EF(wF(n))}function zI(e){const t=cu(e);return hP(t)[1]}function jJ(e,t){const n=zI(e),r=zI(t),i=Math.max(n,r),a=Math.min(n,r);return(i+.05)/(a+.05)}function MF(e){const t=Math.abs(U3(cu(0),cu(e)));return Math.abs(U3(cu(16777215),cu(e)))>Math.min(t,50)?"#fff":"#000"}function ht(e,t){return n=>Object.keys(e).reduce((r,i)=>{const l=typeof e[i]=="object"&&e[i]!=null&&!Array.isArray(e[i])?e[i]:{type:e[i]};return n&&i in n?r[i]={...l,default:n[i]}:r[i]=l,t&&!r[i].source&&(r[i].source=t),r},{})}const ln=ht({class:[String,Array],style:{type:[String,Array,Object],default:null}},"component");function Lu(e){if(e._setup=e._setup??e.setup,!e.name)return e;if(e._setup){e.props=ht(e.props??{},e.name)();const t=Object.keys(e.props);e.filterProps=function(r){return ng(r,t,["class","style"])},e.props._as=String,e.setup=function(r,i){const a=gP();if(!a.value)return e._setup(r,i);const{props:l,provideSubDefaults:o}=JJ(r,r._as??e.name,a),f=e._setup(l,i);return o(),f}}return e}function Mt(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return t=>(e?Lu:h9)(t)}function Tc(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"div",n=arguments.length>2?arguments[2]:void 0;return Mt()({name:n??rf(gu(e.replace(/__/g,"-"))),props:{tag:{type:String,default:t},...ln()},setup(r,i){let{slots:a}=i;return()=>{var l;return vd(r.tag,{class:[e,r.class],style:r.style},(l=a.default)==null?void 0:l.call(a))}}})}function LF(e){if(typeof e.getRootNode!="function"){for(;e.parentNode;)e=e.parentNode;return e!==document?null:document}const t=e.getRootNode();return t!==document&&t.getRootNode({composed:!0})!==document?null:t}const D0="cubic-bezier(0.4, 0, 0.2, 1)",qJ="cubic-bezier(0.0, 0, 0.2, 1)",ZJ="cubic-bezier(0.4, 0, 1, 1)";function qa(e,t){const n=NC();if(!n)throw new Error(`[Vuetify] ${e} ${t||"must be called from inside a setup function"}`);return n}function uf(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"composables";const t=qa(e).type;return Dp((t==null?void 0:t.aliasName)||(t==null?void 0:t.name))}let OF=0,_b=new WeakMap;function ws(){const e=qa("getUid");if(_b.has(e))return _b.get(e);{const t=OF++;return _b.set(e,t),t}}ws.reset=()=>{OF=0,_b=new WeakMap};function dP(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(;e;){if(t?XJ(e):pP(e))return e;e=e.parentElement}return document.scrollingElement}function nw(e,t){const n=[];if(t&&e&&!t.contains(e))return n;for(;e&&(pP(e)&&n.push(e),e!==t);)e=e.parentElement;return n}function pP(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const t=window.getComputedStyle(e);return t.overflowY==="scroll"||t.overflowY==="auto"&&e.scrollHeight>e.clientHeight}function XJ(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const t=window.getComputedStyle(e);return["scroll","auto"].includes(t.overflowY)}function WJ(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qa("injectSelf");const{provides:n}=t;if(n&&e in n)return n[e]}function HJ(e){for(;e;){if(window.getComputedStyle(e).position==="fixed")return!0;e=e.offsetParent}return!1}function Bt(e){const t=qa("useRender");t.render=e}const xy=Symbol.for("vuetify:defaults");function YJ(e){return Xt(e)}function gP(){const e=Pi(xy);if(!e)throw new Error("[Vuetify] Could not find defaults instance");return e}function fa(e,t){const n=gP(),r=Xt(e),i=fe(()=>{if(Sl(t==null?void 0:t.disabled))return n.value;const l=Sl(t==null?void 0:t.scoped),o=Sl(t==null?void 0:t.reset),f=Sl(t==null?void 0:t.root);if(r.value==null&&!(l||o||f))return n.value;let p=uu(r.value,{prev:n.value});if(l)return p;if(o||f){const y=Number(o||1/0);for(let x=0;x<=y&&!(!p||!("prev"in p));x++)p=p.prev;return p&&typeof f=="string"&&f in p&&(p=uu(uu(p,{prev:p}),p[f])),p}return p.prev?uu(p.prev,p):p});return da(xy,i),i}function KJ(e,t){var n,r;return typeof((n=e.props)==null?void 0:n[t])<"u"||typeof((r=e.props)==null?void 0:r[Dp(t)])<"u"}function JJ(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:gP();const r=qa("useDefaults");if(t=t??r.type.name??r.type.__name,!t)throw new Error("[Vuetify] Could not determine component name");const i=fe(()=>{var f;return(f=n.value)==null?void 0:f[e._as??t]}),a=new Proxy(e,{get(f,p){var x,w,S,L;const y=Reflect.get(f,p);return p==="class"||p==="style"?[(x=i.value)==null?void 0:x[p],y].filter(D=>D!=null):typeof p=="string"&&!KJ(r.vnode,p)?((w=i.value)==null?void 0:w[p])??((L=(S=n.value)==null?void 0:S.global)==null?void 0:L[p])??y:y}}),l=on();Nl(()=>{if(i.value){const f=Object.entries(i.value).filter(p=>{let[y]=p;return y.startsWith(y[0].toUpperCase())});l.value=f.length?Object.fromEntries(f):void 0}else l.value=void 0});function o(){const f=WJ(xy,r);da(xy,fe(()=>l.value?uu((f==null?void 0:f.value)??{},l.value):f==null?void 0:f.value))}return{props:a,provideSubDefaults:o}}const Jw=["sm","md","lg","xl","xxl"],UI=Symbol.for("vuetify:display"),j3={mobileBreakpoint:"lg",thresholds:{xs:0,sm:600,md:960,lg:1280,xl:1920,xxl:2560}},QJ=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:j3;return uu(j3,e)};function q3(e){return Yi&&!e?window.innerWidth:typeof e=="object"&&e.clientWidth||0}function Z3(e){return Yi&&!e?window.innerHeight:typeof e=="object"&&e.clientHeight||0}function X3(e){const t=Yi&&!e?window.navigator.userAgent:"ssr";function n(L){return!!t.match(L)}const r=n(/android/i),i=n(/iphone|ipad|ipod/i),a=n(/cordova/i),l=n(/electron/i),o=n(/chrome/i),f=n(/edge/i),p=n(/firefox/i),y=n(/opera/i),x=n(/win/i),w=n(/mac/i),S=n(/linux/i);return{android:r,ios:i,cordova:a,electron:l,chrome:o,edge:f,firefox:p,opera:y,win:x,mac:w,linux:S,touch:dJ,ssr:t==="ssr"}}function eQ(e,t){const{thresholds:n,mobileBreakpoint:r}=QJ(e),i=on(Z3(t)),a=on(X3(t)),l=Qs({}),o=on(q3(t));function f(){i.value=Z3(),o.value=q3()}function p(){f(),a.value=X3()}return Nl(()=>{const y=o.value<n.sm,x=o.value<n.md&&!y,w=o.value<n.lg&&!(x||y),S=o.value<n.xl&&!(w||x||y),L=o.value<n.xxl&&!(S||w||x||y),D=o.value>=n.xxl,B=y?"xs":x?"sm":w?"md":S?"lg":L?"xl":"xxl",z=typeof r=="number"?r:n[r],M=o.value<z;l.xs=y,l.sm=x,l.md=w,l.lg=S,l.xl=L,l.xxl=D,l.smAndUp=!y,l.mdAndUp=!(y||x),l.lgAndUp=!(y||x||w),l.xlAndUp=!(y||x||w||S),l.smAndDown=!(w||S||L||D),l.mdAndDown=!(S||L||D),l.lgAndDown=!(L||D),l.xlAndDown=!D,l.name=B,l.height=i.value,l.width=o.value,l.mobile=M,l.mobileBreakpoint=r,l.platform=a.value,l.thresholds=n}),Yi&&window.addEventListener("resize",f,{passive:!0}),{...TC(l),update:p,ssr:!!t}}function dg(){const e=Pi(UI);if(!e)throw new Error("Could not find Vuetify display injection");return e}const tQ={collapse:"mdi-chevron-up",complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close-circle",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-alert-circle",error:"mdi-close-circle",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sortAsc:"mdi-arrow-up",sortDesc:"mdi-arrow-down",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus",calendar:"mdi-calendar"},nQ={component:e=>vd(yP,{...e,class:"mdi"})},Jn=[String,Function,Object,Array],VI=Symbol.for("vuetify:icons"),Qw=ht({icon:{type:Jn},tag:{type:String,required:!0}},"icon"),GI=Mt()({name:"VComponentIcon",props:Qw(),setup(e,t){let{slots:n}=t;return()=>{const r=e.icon;return H(e.tag,null,{default:()=>{var i;return[e.icon?H(r,null,null):(i=n.default)==null?void 0:i.call(n)]}})}}}),mP=Lu({name:"VSvgIcon",inheritAttrs:!1,props:Qw(),setup(e,t){let{attrs:n}=t;return()=>H(e.tag,tn(n,{style:null}),{default:()=>[H("svg",{class:"v-icon__svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":"true"},[Array.isArray(e.icon)?e.icon.map(r=>Array.isArray(r)?H("path",{d:r[0],"fill-opacity":r[1]},null):H("path",{d:r},null)):H("path",{d:e.icon},null)])]})}}),rQ=Lu({name:"VLigatureIcon",props:Qw(),setup(e){return()=>H(e.tag,null,{default:()=>[e.icon]})}}),yP=Lu({name:"VClassIcon",props:Qw(),setup(e){return()=>H(e.tag,{class:e.icon},null)}}),iQ={svg:{component:mP},class:{component:yP}};function oQ(e){return uu({defaultSet:"mdi",sets:{...iQ,mdi:nQ},aliases:{...tQ,vuetify:["M8.2241 14.2009L12 21L22 3H14.4459L8.2241 14.2009Z",["M7.26303 12.4733L7.00113 12L2 3H12.5261C12.5261 3 12.5261 3 12.5261 3L7.26303 12.4733Z",.6]],"vuetify-outline":"svg:M7.26 12.47 12.53 3H2L7.26 12.47ZM14.45 3 8.22 14.2 12 21 22 3H14.45ZM18.6 5 12 16.88 10.51 14.2 15.62 5ZM7.26 8.35 5.4 5H9.13L7.26 8.35Z"}},e)}const aQ=e=>{const t=Pi(VI);if(!t)throw new Error("Missing Vuetify Icons provide!");return{iconData:fe(()=>{var f;const r=Sl(e);if(!r)return{component:GI};let i=r;if(typeof i=="string"&&(i=i.trim(),i.startsWith("$")&&(i=(f=t.aliases)==null?void 0:f[i.slice(1)])),!i)throw new Error(`Could not find aliased icon "${r}"`);if(Array.isArray(i))return{component:mP,icon:i};if(typeof i!="string")return{component:GI,icon:i};const a=Object.keys(t.sets).find(p=>typeof i=="string"&&i.startsWith(`${p}:`)),l=a?i.slice(a.length+1):i;return{component:t.sets[a??t.defaultSet].component,icon:l}})}},sQ={badge:"Badge",open:"Open",close:"Close",dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},dateRangeInput:{divider:"to"},datePicker:{ok:"OK",cancel:"Cancel",range:{title:"Select dates",header:"Enter dates"},title:"Select date",header:"Enter date",input:{placeholder:"Enter date"}},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more"},input:{clear:"Clear {0}",prependAction:"{0} prepended action",appendAction:"{0} appended action",otp:"Please enter OTP character {0}"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},timePicker:{am:"AM",pm:"PM"},pagination:{ariaLabel:{root:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Go to page {0}",currentPage:"Page {0}, Current page",first:"First page",last:"Last page"}},stepper:{next:"Next",prev:"Previous"},rating:{ariaLabel:{item:"Rating {0} of {1}"}},loading:"Loading...",infiniteScroll:{loadMore:"Load more",empty:"No more"}},lQ={af:!1,ar:!0,bg:!1,ca:!1,ckb:!1,cs:!1,de:!1,el:!1,en:!1,es:!1,et:!1,fa:!0,fi:!1,fr:!1,hr:!1,hu:!1,he:!0,id:!1,it:!1,ja:!1,ko:!1,lv:!1,lt:!1,nl:!1,no:!1,pl:!1,pt:!1,ro:!1,ru:!1,sk:!1,sl:!1,srCyrl:!1,srLatn:!1,sv:!1,th:!1,tr:!1,az:!1,uk:!1,vi:!1,zhHans:!1,zhHant:!1};function md(e,t){let n;function r(){n=yC(),n.run(()=>t.length?t(()=>{n==null||n.stop(),r()}):t())}cn(e,i=>{i&&!n?r():i||(n==null||n.stop(),n=void 0)},{immediate:!0}),il(()=>{n==null||n.stop()})}function nr(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:x=>x,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:x=>x;const a=qa("useProxiedModel"),l=Xt(e[t]!==void 0?e[t]:n),o=Dp(t),p=fe(o!==t?()=>{var x,w,S,L;return e[t],!!(((x=a.vnode.props)!=null&&x.hasOwnProperty(t)||(w=a.vnode.props)!=null&&w.hasOwnProperty(o))&&((S=a.vnode.props)!=null&&S.hasOwnProperty(`onUpdate:${t}`)||(L=a.vnode.props)!=null&&L.hasOwnProperty(`onUpdate:${o}`)))}:()=>{var x,w;return e[t],!!((x=a.vnode.props)!=null&&x.hasOwnProperty(t)&&((w=a.vnode.props)!=null&&w.hasOwnProperty(`onUpdate:${t}`)))});md(()=>!p.value,()=>{cn(()=>e[t],x=>{l.value=x})});const y=fe({get(){const x=e[t];return r(p.value?x:l.value)},set(x){const w=i(x),S=cr(p.value?e[t]:l.value);S===w||r(S)===x||(l.value=w,a==null||a.emit(`update:${t}`,w))}});return Object.defineProperty(y,"externalValue",{get:()=>p.value?e[t]:l.value}),y}const W3="$vuetify.",H3=(e,t)=>e.replace(/\{(\d+)\}/g,(n,r)=>String(t[+r])),DF=(e,t,n)=>function(r){for(var i=arguments.length,a=new Array(i>1?i-1:0),l=1;l<i;l++)a[l-1]=arguments[l];if(!r.startsWith(W3))return H3(r,a);const o=r.replace(W3,""),f=e.value&&n.value[e.value],p=t.value&&n.value[t.value];let y=RI(f,o,null);return y||(`${r}${e.value}`,y=RI(p,o,null)),y||(y=r),typeof y!="string"&&(y=r),H3(y,a)};function RF(e,t){return(n,r)=>new Intl.NumberFormat([e.value,t.value],r).format(n)}function RT(e,t,n){const r=nr(e,t,e[t]??n.value);return r.value=e[t]??n.value,cn(n,i=>{e[t]==null&&(r.value=n.value)}),r}function kF(e){return t=>{const n=RT(t,"locale",e.current),r=RT(t,"fallback",e.fallback),i=RT(t,"messages",e.messages);return{name:"vuetify",current:n,fallback:r,messages:i,t:DF(n,r,i),n:RF(n,r),provide:kF({current:n,fallback:r,messages:i})}}}function uQ(e){const t=on((e==null?void 0:e.locale)??"en"),n=on((e==null?void 0:e.fallback)??"en"),r=Xt({en:sQ,...e==null?void 0:e.messages});return{name:"vuetify",current:t,fallback:n,messages:r,t:DF(t,n,r),n:RF(t,n),provide:kF({current:t,fallback:n,messages:r})}}const by=Symbol.for("vuetify:locale");function cQ(e){return e.name!=null}function hQ(e){const t=e!=null&&e.adapter&&cQ(e==null?void 0:e.adapter)?e==null?void 0:e.adapter:uQ(e),n=dQ(t,e);return{...t,...n}}function Ou(){const e=Pi(by);if(!e)throw new Error("[Vuetify] Could not find injected locale instance");return e}function fQ(e){const t=Pi(by);if(!t)throw new Error("[Vuetify] Could not find injected locale instance");const n=t.provide(e),r=pQ(n,t.rtl,e),i={...n,...r};return da(by,i),i}function dQ(e,t){const n=Xt((t==null?void 0:t.rtl)??lQ),r=fe(()=>n.value[e.current.value]??!1);return{isRtl:r,rtl:n,rtlClasses:fe(()=>`v-locale--is-${r.value?"rtl":"ltr"}`)}}function pQ(e,t,n){const r=fe(()=>n.rtl??t.value[e.current.value]??!1);return{isRtl:r,rtl:t,rtlClasses:fe(()=>`v-locale--is-${r.value?"rtl":"ltr"}`)}}function Za(){const e=Pi(by);if(!e)throw new Error("[Vuetify] Could not find injected rtl instance");return{isRtl:e.isRtl,rtlClasses:e.rtlClasses}}const R0=Symbol.for("vuetify:theme"),ii=ht({theme:String},"theme"),O_={defaultTheme:"light",variations:{colors:[],lighten:0,darken:0},themes:{light:{dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF","surface-bright":"#FFFFFF","surface-variant":"#424242","on-surface-variant":"#EEEEEE",primary:"#6200EE","primary-darken-1":"#3700B3",secondary:"#03DAC6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#000000","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.04,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.12,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#F5F5F5","theme-on-code":"#000000"}},dark:{dark:!0,colors:{background:"#121212",surface:"#212121","surface-bright":"#ccbfd6","surface-variant":"#a3a3a3","on-surface-variant":"#424242",primary:"#BB86FC","primary-darken-1":"#3700B3",secondary:"#03DAC5","secondary-darken-1":"#03DAC5",error:"#CF6679",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#FFFFFF","border-opacity":.12,"high-emphasis-opacity":1,"medium-emphasis-opacity":.7,"disabled-opacity":.5,"idle-opacity":.1,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.16,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#343434","theme-on-code":"#CCCCCC"}}}};function gQ(){var n,r;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:O_;if(!e)return{...O_,isDisabled:!0};const t={};for(const[i,a]of Object.entries(e.themes??{})){const l=a.dark||i==="dark"?(n=O_.themes)==null?void 0:n.dark:(r=O_.themes)==null?void 0:r.light;t[i]=uu(l,a)}return uu(O_,{...e,themes:t})}function mQ(e){const t=gQ(e),n=Xt(t.defaultTheme),r=Xt(t.themes),i=fe(()=>{const y={};for(const[x,w]of Object.entries(r.value)){const S=y[x]={...w,colors:{...w.colors}};if(t.variations)for(const L of t.variations.colors){const D=S.colors[L];if(D)for(const B of["lighten","darken"]){const z=B==="lighten"?GJ:$J;for(const M of Fh(t.variations[B],1))S.colors[`${L}-${B}-${M}`]=CF(z(cu(D),M))}}for(const L of Object.keys(S.colors)){if(/^on-[a-z]/.test(L)||S.colors[`on-${L}`])continue;const D=`on-${L}`,B=cu(S.colors[L]);S.colors[D]=MF(B)}}return y}),a=fe(()=>i.value[n.value]),l=fe(()=>{const y=[];a.value.dark&&vp(y,":root",["color-scheme: dark"]),vp(y,":root",Y3(a.value));for(const[L,D]of Object.entries(i.value))vp(y,`.v-theme--${L}`,[`color-scheme: ${D.dark?"dark":"normal"}`,...Y3(D)]);const x=[],w=[],S=new Set(Object.values(i.value).flatMap(L=>Object.keys(L.colors)));for(const L of S)/^on-[a-z]/.test(L)?vp(w,`.${L}`,[`color: rgb(var(--v-theme-${L})) !important`]):(vp(x,`.bg-${L}`,[`--v-theme-overlay-multiplier: var(--v-theme-${L}-overlay-multiplier)`,`background-color: rgb(var(--v-theme-${L})) !important`,`color: rgb(var(--v-theme-on-${L})) !important`]),vp(w,`.text-${L}`,[`color: rgb(var(--v-theme-${L})) !important`]),vp(w,`.border-${L}`,[`--v-border-color: var(--v-theme-${L})`]));return y.push(...x,...w),y.map((L,D)=>D===0?L:`    ${L}`).join("")});function o(){return{style:[{children:l.value,id:"vuetify-theme-stylesheet",nonce:t.cspNonce||!1}]}}function f(y){if(t.isDisabled)return;const x=y._context.provides.usehead;if(x)if(x.push){const S=x.push(o);Yi&&cn(l,()=>{S.patch(o)})}else Yi?(x.addHeadObjs(fe(o)),Nl(()=>x.updateDOM())):x.addHeadObjs(o());else{let L=function(){if(typeof document<"u"&&!S){const D=document.createElement("style");D.type="text/css",D.id="vuetify-theme-stylesheet",t.cspNonce&&D.setAttribute("nonce",t.cspNonce),S=D,document.head.appendChild(S)}S&&(S.innerHTML=l.value)};var w=L;let S=Yi?document.getElementById("vuetify-theme-stylesheet"):null;Yi?cn(l,L,{immediate:!0}):L()}}const p=fe(()=>t.isDisabled?void 0:`v-theme--${n.value}`);return{install:f,isDisabled:t.isDisabled,name:n,themes:r,current:a,computedThemes:i,themeClasses:p,styles:l,global:{name:n,current:a}}}function Ii(e){qa("provideTheme");const t=Pi(R0,null);if(!t)throw new Error("Could not find Vuetify theme injection");const n=fe(()=>e.theme??t.name.value),r=fe(()=>t.themes.value[n.value]),i=fe(()=>t.isDisabled?void 0:`v-theme--${n.value}`),a={...t,name:n,current:r,themeClasses:i};return da(R0,a),a}function NF(){qa("useTheme");const e=Pi(R0,null);if(!e)throw new Error("Could not find Vuetify theme injection");return e}function vp(e,t,n){e.push(`${t} {
`,...n.map(r=>`  ${r};
`),`}
`)}function Y3(e){const t=e.dark?2:1,n=e.dark?1:2,r=[];for(const[i,a]of Object.entries(e.colors)){const l=cu(a);r.push(`--v-theme-${i}: ${l.r},${l.g},${l.b}`),i.startsWith("on-")||r.push(`--v-theme-${i}-overlay-multiplier: ${zI(a)>.18?t:n}`)}for(const[i,a]of Object.entries(e.variables)){const l=typeof a=="string"&&a.startsWith("#")?cu(a):void 0,o=l?`${l.r}, ${l.g}, ${l.b}`:void 0;r.push(`--v-${i}: ${o??a}`)}return r}const $I={"001":1,AD:1,AE:6,AF:6,AG:0,AI:1,AL:1,AM:1,AN:1,AR:1,AS:0,AT:1,AU:1,AX:1,AZ:1,BA:1,BD:0,BE:1,BG:1,BH:6,BM:1,BN:1,BR:0,BS:0,BT:0,BW:0,BY:1,BZ:0,CA:0,CH:1,CL:1,CM:1,CN:1,CO:0,CR:1,CY:1,CZ:1,DE:1,DJ:6,DK:1,DM:0,DO:0,DZ:6,EC:1,EE:1,EG:6,ES:1,ET:0,FI:1,FJ:1,FO:1,FR:1,GB:1,"GB-alt-variant":0,GE:1,GF:1,GP:1,GR:1,GT:0,GU:0,HK:0,HN:0,HR:1,HU:1,ID:0,IE:1,IL:0,IN:0,IQ:6,IR:6,IS:1,IT:1,JM:0,JO:6,JP:0,KE:0,KG:1,KH:0,KR:0,KW:6,KZ:1,LA:0,LB:1,LI:1,LK:1,LT:1,LU:1,LV:1,LY:6,MC:1,MD:1,ME:1,MH:0,MK:1,MM:0,MN:1,MO:0,MQ:1,MT:0,MV:5,MX:0,MY:1,MZ:0,NI:0,NL:1,NO:1,NP:0,NZ:1,OM:6,PA:0,PE:0,PH:0,PK:0,PL:1,PR:0,PT:0,PY:0,QA:6,RE:1,RO:1,RS:1,RU:1,SA:0,SD:6,SE:1,SG:0,SI:1,SK:1,SM:1,SV:0,SY:6,TH:0,TJ:1,TM:1,TR:1,TT:0,TW:0,UA:1,UM:0,US:0,UY:1,UZ:1,VA:1,VE:0,VI:0,VN:1,WS:0,XK:1,YE:0,ZA:0,ZW:0};function yQ(e,t){const n=[];let r=[];const i=FF(e),a=BF(e),l=i.getDay()-$I[t.slice(-2).toUpperCase()],o=a.getDay()-$I[t.slice(-2).toUpperCase()];for(let f=0;f<l;f++){const p=new Date(i);p.setDate(p.getDate()-(l-f)),r.push(p)}for(let f=1;f<=a.getDate();f++){const p=new Date(e.getFullYear(),e.getMonth(),f);r.push(p),r.length===7&&(n.push(r),r=[])}for(let f=1;f<7-o;f++){const p=new Date(a);p.setDate(p.getDate()+f),r.push(p)}return n.push(r),n}function FF(e){return new Date(e.getFullYear(),e.getMonth(),1)}function BF(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}function vQ(e){const t=e.split("-").map(Number);return new Date(t[0],t[1]-1,t[2])}const _Q=/([12]\d{3}-([1-9]|0[1-9]|1[0-2])-([1-9]|0[1-9]|[12]\d|3[01]))/;function xQ(e){if(e==null)return new Date;if(e instanceof Date)return e;if(typeof e=="string"){let t;if(_Q.test(e))return vQ(e);if(t=Date.parse(e),!isNaN(t))return new Date(t)}return null}const K3=new Date(2e3,0,2);function bQ(e){const t=$I[e.slice(-2).toUpperCase()];return Fh(7).map(n=>{const r=new Date(K3);return r.setDate(K3.getDate()+t+n),new Intl.DateTimeFormat(e,{weekday:"narrow"}).format(r)})}function wQ(e,t,n){const r=new Date(e);let i={};switch(t){case"fullDateWithWeekday":i={weekday:"long",day:"numeric",month:"long",year:"numeric"};break;case"normalDateWithWeekday":i={weekday:"short",day:"numeric",month:"short"};break;case"keyboardDate":i={};break;case"monthAndDate":i={month:"long",day:"numeric"};break;case"monthAndYear":i={month:"long",year:"numeric"};break;case"dayOfMonth":i={day:"numeric"};break;case"shortDate":i={year:"numeric"};break;default:i={timeZone:"UTC",timeZoneName:"short"}}return new Intl.DateTimeFormat(n,i).format(r)}function EQ(e,t){const n=new Date(e);return n.setDate(n.getDate()+t),n}function SQ(e,t){const n=new Date(e);return n.setMonth(n.getMonth()+t),n}function TQ(e){return e.getFullYear()}function IQ(e){return e.getMonth()}function CQ(e){return new Date(e.getFullYear(),0,1)}function PQ(e){return new Date(e.getFullYear(),11,31)}function AQ(e,t){return jI(e,t[0])&&LQ(e,t[1])}function MQ(e){if(!e||e==null)return!1;const t=new Date(e);return t instanceof Date&&!isNaN(t.getTime())}function jI(e,t){return e.getTime()>t.getTime()}function LQ(e,t){return e.getTime()<t.getTime()}function J3(e,t){return e.getTime()===t.getTime()}function OQ(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function DQ(e,t){return e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function RQ(e,t,n){const r=new Date(e),i=new Date(t);return n==="month"?r.getMonth()-i.getMonth()+(r.getFullYear()-i.getFullYear())*12:Math.floor((r.getTime()-i.getTime())/(1e3*60*60*24))}function kQ(e,t){const n=new Date(e);return n.setFullYear(t),n}function NQ(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function FQ(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999)}class BQ{constructor(t){this.locale=t.locale}date(t){return xQ(t)}toJsDate(t){return t}addDays(t,n){return EQ(t,n)}addMonths(t,n){return SQ(t,n)}getWeekArray(t){return yQ(t,this.locale)}startOfMonth(t){return FF(t)}endOfMonth(t){return BF(t)}format(t,n){return wQ(t,n,this.locale)}isEqual(t,n){return J3(t,n)}isValid(t){return MQ(t)}isWithinRange(t,n){return AQ(t,n)}isAfter(t,n){return jI(t,n)}isBefore(t,n){return!jI(t,n)&&!J3(t,n)}isSameDay(t,n){return OQ(t,n)}isSameMonth(t,n){return DQ(t,n)}setYear(t,n){return kQ(t,n)}getDiff(t,n,r){return RQ(t,n,r)}getWeekdays(){return bQ(this.locale)}getYear(t){return TQ(t)}getMonth(t){return IQ(t)}startOfDay(t){return NQ(t)}endOfDay(t){return FQ(t)}startOfYear(t){return CQ(t)}endOfYear(t){return PQ(t)}}const Q3=Symbol.for("vuetify:date-adapter");function zQ(e){return uu({adapter:BQ,locale:{af:"af-ZA",bg:"bg-BG",ca:"ca-ES",ckb:"",cs:"",de:"de-DE",el:"el-GR",en:"en-US",et:"et-EE",fa:"fa-IR",fi:"fi-FI",hr:"hr-HR",hu:"hu-HU",he:"he-IL",id:"id-ID",it:"it-IT",ja:"ja-JP",ko:"ko-KR",lv:"lv-LV",lt:"lt-LT",nl:"nl-NL",no:"nn-NO",pl:"pl-PL",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",srCyrl:"sr-SP",srLatn:"sr-SP",sv:"sv-SE",th:"th-TH",tr:"tr-TR",az:"az-AZ",uk:"uk-UA",vi:"vi-VN",zhHans:"zh-CN",zhHant:"zh-TW"}},e)}function lh(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"content";const n=Xt(),r=Xt();if(Yi){const i=new ResizeObserver(a=>{e==null||e(a,i),a.length&&(t==="content"?r.value=a[0].contentRect:r.value=a[0].target.getBoundingClientRect())});Us(()=>{i.disconnect()}),cn(n,(a,l)=>{l&&(i.unobserve(kI(l)),r.value=void 0),a&&i.observe(kI(a))},{flush:"post"})}return{resizeRef:n,contentRect:z0(r)}}const rw=Symbol.for("vuetify:layout"),zF=Symbol.for("vuetify:layout-item"),eR=1e3,UF=ht({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),ky=ht({name:{type:String},order:{type:[Number,String],default:0},absolute:Boolean},"layout-item");function UQ(){const e=Pi(rw);if(!e)throw new Error("[Vuetify] Could not find injected layout");return{getLayoutItem:e.getLayoutItem,mainRect:e.mainRect,mainStyles:e.mainStyles}}function Ny(e){const t=Pi(rw);if(!t)throw new Error("[Vuetify] Could not find injected layout");const n=e.id??`layout-item-${ws()}`,r=qa("useLayoutItem");da(zF,{id:n});const i=on(!1);tk(()=>i.value=!0),ek(()=>i.value=!1);const{layoutItemStyles:a,layoutItemScrimStyles:l}=t.register(r,{...e,active:fe(()=>i.value?!1:e.active.value),id:n});return Us(()=>t.unregister(n)),{layoutItemStyles:a,layoutRect:t.layoutRect,layoutItemScrimStyles:l}}const VQ=(e,t,n,r)=>{let i={top:0,left:0,right:0,bottom:0};const a=[{id:"",layer:{...i}}];for(const l of e){const o=t.get(l),f=n.get(l),p=r.get(l);if(!o||!f||!p)continue;const y={...i,[o.value]:parseInt(i[o.value],10)+(p.value?parseInt(f.value,10):0)};a.push({id:l,layer:y}),i=y}return a};function VF(e){const t=Pi(rw,null),n=fe(()=>t?t.rootZIndex.value-100:eR),r=Xt([]),i=Qs(new Map),a=Qs(new Map),l=Qs(new Map),o=Qs(new Map),f=Qs(new Map),{resizeRef:p,contentRect:y}=lh(),x=fe(()=>{const Y=new Map,K=e.overlaps??[];for(const X of K.filter(U=>U.includes(":"))){const[U,le]=X.split(":");if(!r.value.includes(U)||!r.value.includes(le))continue;const ue=i.get(U),ae=i.get(le),ve=a.get(U),Ee=a.get(le);!ue||!ae||!ve||!Ee||(Y.set(le,{position:ue.value,amount:parseInt(ve.value,10)}),Y.set(U,{position:ae.value,amount:-parseInt(Ee.value,10)}))}return Y}),w=fe(()=>{const Y=[...new Set([...l.values()].map(X=>X.value))].sort((X,U)=>X-U),K=[];for(const X of Y){const U=r.value.filter(le=>{var ue;return((ue=l.get(le))==null?void 0:ue.value)===X});K.push(...U)}return VQ(K,i,a,o)}),S=fe(()=>!Array.from(f.values()).some(Y=>Y.value)),L=fe(()=>w.value[w.value.length-1].layer),D=fe(()=>({"--v-layout-left":dn(L.value.left),"--v-layout-right":dn(L.value.right),"--v-layout-top":dn(L.value.top),"--v-layout-bottom":dn(L.value.bottom),...S.value?void 0:{transition:"none"}})),B=fe(()=>w.value.slice(1).map((Y,K)=>{let{id:X}=Y;const{layer:U}=w.value[K],le=a.get(X),ue=i.get(X);return{id:X,...U,size:Number(le.value),position:ue.value}})),z=Y=>B.value.find(K=>K.id===Y),M=qa("createLayout"),k=on(!1);bs(()=>{k.value=!0}),da(rw,{register:(Y,K)=>{let{id:X,order:U,position:le,layoutSize:ue,elementSize:ae,active:ve,disableTransitions:Ee,absolute:He}=K;l.set(X,U),i.set(X,le),a.set(X,ue),o.set(X,ve),Ee&&f.set(X,Ee);const Ve=Y_(zF,M==null?void 0:M.vnode).indexOf(Y);Ve>-1?r.value.splice(Ve,0,X):r.value.push(X);const Pe=fe(()=>B.value.findIndex(lt=>lt.id===X)),Ke=fe(()=>n.value+w.value.length*2-Pe.value*2),Be=fe(()=>{const lt=le.value==="left"||le.value==="right",xt=le.value==="right",Nt=le.value==="bottom",Wt={[le.value]:0,zIndex:Ke.value,transform:`translate${lt?"X":"Y"}(${(ve.value?0:-110)*(xt||Nt?-1:1)}%)`,position:He.value||n.value!==eR?"absolute":"fixed",...S.value?void 0:{transition:"none"}};if(!k.value)return Wt;const Je=B.value[Pe.value];if(!Je)throw new Error(`[Vuetify] Could not find layout item "${X}"`);const Kt=x.value.get(X);return Kt&&(Je[Kt.position]+=Kt.amount),{...Wt,height:lt?`calc(100% - ${Je.top}px - ${Je.bottom}px)`:ae.value?`${ae.value}px`:void 0,left:xt?void 0:`${Je.left}px`,right:xt?`${Je.right}px`:void 0,top:le.value!=="bottom"?`${Je.top}px`:void 0,bottom:le.value!=="top"?`${Je.bottom}px`:void 0,width:lt?ae.value?`${ae.value}px`:void 0:`calc(100% - ${Je.left}px - ${Je.right}px)`}}),Ue=fe(()=>({zIndex:Ke.value-1}));return{layoutItemStyles:Be,layoutItemScrimStyles:Ue,zIndex:Ke}},unregister:Y=>{l.delete(Y),i.delete(Y),a.delete(Y),o.delete(Y),f.delete(Y),r.value=r.value.filter(K=>K!==Y)},mainRect:L,mainStyles:D,getLayoutItem:z,items:B,layoutRect:y,rootZIndex:n});const V=fe(()=>["v-layout",{"v-layout--full-height":e.fullHeight}]),q=fe(()=>({zIndex:t?n.value:void 0,position:t?"relative":void 0,overflow:t?"hidden":void 0}));return{layoutClasses:V,layoutStyles:q,getLayoutItem:z,items:B,layoutRect:y,layoutRef:p}}function GF(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:t,...n}=e,r=uu(t,n),{aliases:i={},components:a={},directives:l={}}=r,o=YJ(r.defaults),f=eQ(r.display,r.ssr),p=mQ(r.theme),y=oQ(r.icons),x=hQ(r.locale),w=zQ(r.date);return{install:L=>{for(const D in l)L.directive(D,l[D]);for(const D in a)L.component(D,a[D]);for(const D in i)L.component(D,Lu({...i[D],name:D,aliasName:i[D].name}));if(p.install(L),L.provide(xy,o),L.provide(UI,f),L.provide(R0,p),L.provide(VI,y),L.provide(by,x),L.provide(Q3,w),Yi&&r.ssr)if(L.$nuxt)L.$nuxt.hook("app:suspense:resolve",()=>{f.update()});else{const{mount:D}=L;L.mount=function(){const B=D(...arguments);return qi(()=>f.update()),L.mount=D,B}}ws.reset(),L.mixin({computed:{$vuetify(){return Qs({defaults:Sm.call(this,xy),display:Sm.call(this,UI),theme:Sm.call(this,R0),icons:Sm.call(this,VI),locale:Sm.call(this,by),date:Sm.call(this,Q3)})}}})},defaults:o,display:f,theme:p,icons:y,locale:x,date:w}}const GQ="3.3.17";GF.version=GQ;function Sm(e){var r,i;const t=this.$,n=((r=t.parent)==null?void 0:r.provides)??((i=t.vnode.appContext)==null?void 0:i.provides);if(n&&e in n)return n[e]}const $Q=ht({...ln(),...UF({fullHeight:!0}),...ii()},"VApp"),jQ=Mt()({name:"VApp",props:$Q(),setup(e,t){let{slots:n}=t;const r=Ii(e),{layoutClasses:i,getLayoutItem:a,items:l,layoutRef:o}=VF(e),{rtlClasses:f}=Za();return Bt(()=>{var p;return H("div",{ref:o,class:["v-application",r.themeClasses.value,i.value,f.value,e.class],style:[e.style]},[H("div",{class:"v-application__wrap"},[(p=n.default)==null?void 0:p.call(n)])])}),{getLayoutItem:a,items:l,theme:r}}});const or=ht({tag:{type:String,default:"div"}},"tag"),$F=ht({text:String,...ln(),...or()},"VToolbarTitle"),vP=Mt()({name:"VToolbarTitle",props:$F(),setup(e,t){let{slots:n}=t;return Bt(()=>{const r=!!(n.default||n.text||e.text);return H(e.tag,{class:["v-toolbar-title",e.class],style:e.style},{default:()=>{var i;return[r&&H("div",{class:"v-toolbar-title__placeholder"},[n.text?n.text():e.text,(i=n.default)==null?void 0:i.call(n)])]}})}),{}}}),qQ=ht({disabled:Boolean,group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:String,origin:String},"transition");function Ul(e,t,n){return Mt()({name:e,props:qQ({mode:n,origin:t}),setup(r,i){let{slots:a}=i;const l={onBeforeEnter(o){r.origin&&(o.style.transformOrigin=r.origin)},onLeave(o){if(r.leaveAbsolute){const{offsetTop:f,offsetLeft:p,offsetWidth:y,offsetHeight:x}=o;o._transitionInitialStyles={position:o.style.position,top:o.style.top,left:o.style.left,width:o.style.width,height:o.style.height},o.style.position="absolute",o.style.top=`${f}px`,o.style.left=`${p}px`,o.style.width=`${y}px`,o.style.height=`${x}px`}r.hideOnLeave&&o.style.setProperty("display","none","important")},onAfterLeave(o){if(r.leaveAbsolute&&(o!=null&&o._transitionInitialStyles)){const{position:f,top:p,left:y,width:x,height:w}=o._transitionInitialStyles;delete o._transitionInitialStyles,o.style.position=f||"",o.style.top=p||"",o.style.left=y||"",o.style.width=x||"",o.style.height=w||""}}};return()=>{const o=r.group?xV:Qc;return vd(o,{name:r.disabled?"":e,css:!r.disabled,...r.group?void 0:{mode:r.mode},...r.disabled?{}:l},a.default)}}})}function jF(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"in-out";return Mt()({name:e,props:{mode:{type:String,default:n},disabled:Boolean},setup(r,i){let{slots:a}=i;return()=>vd(Qc,{name:r.disabled?"":e,css:!r.disabled,...r.disabled?{}:t},a.default)}})}function qF(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const n=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?"width":"height",r=gu(`offset-${n}`);return{onBeforeEnter(l){l._parent=l.parentNode,l._initialStyle={transition:l.style.transition,overflow:l.style.overflow,[n]:l.style[n]}},onEnter(l){const o=l._initialStyle;l.style.setProperty("transition","none","important"),l.style.overflow="hidden";const f=`${l[r]}px`;l.style[n]="0",l.offsetHeight,l.style.transition=o.transition,e&&l._parent&&l._parent.classList.add(e),requestAnimationFrame(()=>{l.style[n]=f})},onAfterEnter:a,onEnterCancelled:a,onLeave(l){l._initialStyle={transition:"",overflow:l.style.overflow,[n]:l.style[n]},l.style.overflow="hidden",l.style[n]=`${l[r]}px`,l.offsetHeight,requestAnimationFrame(()=>l.style[n]="0")},onAfterLeave:i,onLeaveCancelled:i};function i(l){e&&l._parent&&l._parent.classList.remove(e),a(l)}function a(l){const o=l._initialStyle[n];l.style.overflow=l._initialStyle.overflow,o!=null&&(l.style[n]=o),delete l._initialStyle}}const ZQ=ht({target:Object},"v-dialog-transition"),eE=Mt()({name:"VDialogTransition",props:ZQ(),setup(e,t){let{slots:n}=t;const r={onBeforeEnter(i){i.style.pointerEvents="none",i.style.visibility="hidden"},async onEnter(i,a){var w;await new Promise(S=>requestAnimationFrame(S)),await new Promise(S=>requestAnimationFrame(S)),i.style.visibility="";const{x:l,y:o,sx:f,sy:p,speed:y}=nR(e.target,i),x=Cp(i,[{transform:`translate(${l}px, ${o}px) scale(${f}, ${p})`,opacity:0},{}],{duration:225*y,easing:qJ});(w=tR(i))==null||w.forEach(S=>{Cp(S,[{opacity:0},{opacity:0,offset:.33},{}],{duration:225*2*y,easing:D0})}),x.finished.then(()=>a())},onAfterEnter(i){i.style.removeProperty("pointer-events")},onBeforeLeave(i){i.style.pointerEvents="none"},async onLeave(i,a){var w;await new Promise(S=>requestAnimationFrame(S));const{x:l,y:o,sx:f,sy:p,speed:y}=nR(e.target,i);Cp(i,[{},{transform:`translate(${l}px, ${o}px) scale(${f}, ${p})`,opacity:0}],{duration:125*y,easing:ZJ}).finished.then(()=>a()),(w=tR(i))==null||w.forEach(S=>{Cp(S,[{},{opacity:0,offset:.2},{opacity:0}],{duration:125*2*y,easing:D0})})},onAfterLeave(i){i.style.removeProperty("pointer-events")}};return()=>e.target?H(Qc,tn({name:"dialog-transition"},r,{css:!1}),n):H(Qc,{name:"dialog-transition"},n)}});function tR(e){var n;const t=(n=e.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))==null?void 0:n.children;return t&&[...t]}function nR(e,t){const n=e.getBoundingClientRect(),r=cP(t),[i,a]=getComputedStyle(t).transformOrigin.split(" ").map(z=>parseFloat(z)),[l,o]=getComputedStyle(t).getPropertyValue("--v-overlay-anchor-origin").split(" ");let f=n.left+n.width/2;l==="left"||o==="left"?f-=n.width/2:(l==="right"||o==="right")&&(f+=n.width/2);let p=n.top+n.height/2;l==="top"||o==="top"?p-=n.height/2:(l==="bottom"||o==="bottom")&&(p+=n.height/2);const y=n.width/r.width,x=n.height/r.height,w=Math.max(1,y,x),S=y/w||0,L=x/w||0,D=r.width*r.height/(window.innerWidth*window.innerHeight),B=D>.12?Math.min(1.5,(D-.12)*10+1):1;return{x:f-(i+r.left),y:p-(a+r.top),sx:S,sy:L,speed:B}}const XQ=Ul("fab-transition","center center","out-in"),WQ=Ul("dialog-bottom-transition"),HQ=Ul("dialog-top-transition"),qI=Ul("fade-transition"),_P=Ul("scale-transition"),YQ=Ul("scroll-x-transition"),KQ=Ul("scroll-x-reverse-transition"),JQ=Ul("scroll-y-transition"),QQ=Ul("scroll-y-reverse-transition"),eee=Ul("slide-x-transition"),tee=Ul("slide-x-reverse-transition"),xP=Ul("slide-y-transition"),nee=Ul("slide-y-reverse-transition"),tE=jF("expand-transition",qF()),bP=jF("expand-x-transition",qF("",!0)),ree=ht({defaults:Object,disabled:Boolean,reset:[Number,String],root:[Boolean,String],scoped:Boolean},"VDefaultsProvider"),Mi=Mt(!1)({name:"VDefaultsProvider",props:ree(),setup(e,t){let{slots:n}=t;const{defaults:r,disabled:i,reset:a,root:l,scoped:o}=TC(e);return fa(r,{reset:a,root:l,scoped:o,disabled:i}),()=>{var f;return(f=n.default)==null?void 0:f.call(n)}}});const Du=ht({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function Ru(e){return{dimensionStyles:fe(()=>({height:dn(e.height),maxHeight:dn(e.maxHeight),maxWidth:dn(e.maxWidth),minHeight:dn(e.minHeight),minWidth:dn(e.minWidth),width:dn(e.width)}))}}function iee(e){return{aspectStyles:fe(()=>{const t=Number(e.aspectRatio);return t?{paddingBottom:String(1/t*100)+"%"}:void 0})}}const ZF=ht({aspectRatio:[String,Number],contentClass:String,inline:Boolean,...ln(),...Du()},"VResponsive"),ZI=Mt()({name:"VResponsive",props:ZF(),setup(e,t){let{slots:n}=t;const{aspectStyles:r}=iee(e),{dimensionStyles:i}=Ru(e);return Bt(()=>{var a;return H("div",{class:["v-responsive",{"v-responsive--inline":e.inline},e.class],style:[i.value,e.style]},[H("div",{class:"v-responsive__sizer",style:r.value},null),(a=n.additional)==null?void 0:a.call(n),n.default&&H("div",{class:["v-responsive__content",e.contentClass]},[n.default()])])}),{}}}),cf=ht({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:e=>e!==!0}},"transition"),uc=(e,t)=>{let{slots:n}=t;const{transition:r,disabled:i,...a}=e,{component:l=Qc,...o}=typeof r=="object"?r:{};return vd(l,tn(typeof r=="string"?{name:i?"":r}:o,a,{disabled:i}),n)};function oee(e,t){if(!aP)return;const n=t.modifiers||{},r=t.value,{handler:i,options:a}=typeof r=="object"?r:{handler:r,options:{}},l=new IntersectionObserver(function(){var x;let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],f=arguments.length>1?arguments[1]:void 0;const p=(x=e._observe)==null?void 0:x[t.instance.$.uid];if(!p)return;const y=o.some(w=>w.isIntersecting);i&&(!n.quiet||p.init)&&(!n.once||y||p.init)&&i(y,o,f),y&&n.once?XF(e,t):p.init=!0},a);e._observe=Object(e._observe),e._observe[t.instance.$.uid]={init:!1,observer:l},l.observe(e)}function XF(e,t){var r;const n=(r=e._observe)==null?void 0:r[t.instance.$.uid];n&&(n.observer.unobserve(e),delete e._observe[t.instance.$.uid])}const i1={mounted:oee,unmounted:XF},WF=ht({alt:String,cover:Boolean,eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},srcset:String,...ZF(),...ln(),...cf()},"VImg"),rg=Mt()({name:"VImg",directives:{intersect:i1},props:WF(),emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,t){let{emit:n,slots:r}=t;const i=on(""),a=Xt(),l=on(e.eager?"loading":"idle"),o=on(),f=on(),p=fe(()=>e.src&&typeof e.src=="object"?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect||0)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),y=fe(()=>p.value.aspect||o.value/f.value||0);cn(()=>e.src,()=>{x(l.value!=="idle")}),cn(y,(X,U)=>{!X&&U&&a.value&&B(a.value)}),gw(()=>x());function x(X){if(!(e.eager&&X)&&!(aP&&!X&&!e.eager)){if(l.value="loading",p.value.lazySrc){const U=new Image;U.src=p.value.lazySrc,B(U,null)}p.value.src&&qi(()=>{var U,le;if(n("loadstart",((U=a.value)==null?void 0:U.currentSrc)||p.value.src),(le=a.value)!=null&&le.complete){if(a.value.naturalWidth||S(),l.value==="error")return;y.value||B(a.value,null),w()}else y.value||B(a.value),L()})}}function w(){var X;L(),l.value="loaded",n("load",((X=a.value)==null?void 0:X.currentSrc)||p.value.src)}function S(){var X;l.value="error",n("error",((X=a.value)==null?void 0:X.currentSrc)||p.value.src)}function L(){const X=a.value;X&&(i.value=X.currentSrc||X.src)}let D=-1;function B(X){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const le=()=>{clearTimeout(D);const{naturalHeight:ue,naturalWidth:ae}=X;ue||ae?(o.value=ae,f.value=ue):!X.complete&&l.value==="loading"&&U!=null?D=window.setTimeout(le,U):(X.currentSrc.endsWith(".svg")||X.currentSrc.startsWith("data:image/svg+xml"))&&(o.value=1,f.value=1)};le()}const z=fe(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),M=()=>{var le;if(!p.value.src||l.value==="idle")return null;const X=H("img",{class:["v-img__img",z.value],src:p.value.src,srcset:p.value.srcset,alt:e.alt,sizes:e.sizes,ref:a,onLoad:w,onError:S},null),U=(le=r.sources)==null?void 0:le.call(r);return H(uc,{transition:e.transition,appear:!0},{default:()=>[go(U?H("picture",{class:"v-img__picture"},[U,X]):X,[[Ec,l.value==="loaded"]])]})},k=()=>H(uc,{transition:e.transition},{default:()=>[p.value.lazySrc&&l.value!=="loaded"&&H("img",{class:["v-img__img","v-img__img--preload",z.value],src:p.value.lazySrc,alt:e.alt},null)]}),V=()=>r.placeholder?H(uc,{transition:e.transition,appear:!0},{default:()=>[(l.value==="loading"||l.value==="error"&&!r.error)&&H("div",{class:"v-img__placeholder"},[r.placeholder()])]}):null,q=()=>r.error?H(uc,{transition:e.transition,appear:!0},{default:()=>[l.value==="error"&&H("div",{class:"v-img__error"},[r.error()])]}):null,Y=()=>e.gradient?H("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,K=on(!1);{const X=cn(y,U=>{U&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{K.value=!0})}),X())})}return Bt(()=>{const[X]=ZI.filterProps(e);return go(H(ZI,tn({class:["v-img",{"v-img--booting":!K.value},e.class],style:[{width:dn(e.width==="auto"?o.value:e.width)},e.style]},X,{aspectRatio:y.value,"aria-label":e.alt,role:e.alt?"img":void 0}),{additional:()=>H(Dn,null,[H(M,null,null),H(k,null,null),H(Y,null,null),H(V,null,null),H(q,null,null)]),default:r.default}),[[Fl("intersect"),{handler:x,options:e.options},null,{once:!0}]])}),{currentSrc:i,image:a,state:l,naturalWidth:o,naturalHeight:f}}}),Vl=ht({border:[Boolean,Number,String]},"border");function ku(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uf();return{borderClasses:fe(()=>{const r=Oo(e)?e.value:e.border,i=[];if(r===!0||r==="")i.push(`${t}--border`);else if(typeof r=="string"||r===0)for(const a of String(r).split(" "))i.push(`border-${a}`);return i})}}function wP(e){return lP(()=>{const t=[],n={};if(e.value.background)if(V3(e.value.background)){if(n.backgroundColor=e.value.background,!e.value.text){const r=cu(e.value.background);if(r.a==null||r.a===1){const i=MF(r);n.color=i,n.caretColor=i}}}else t.push(`bg-${e.value.background}`);return e.value.text&&(V3(e.value.text)?(n.color=e.value.text,n.caretColor=e.value.text):t.push(`text-${e.value.text}`)),{colorClasses:t,colorStyles:n}})}function xs(e,t){const n=fe(()=>({text:Oo(e)?e.value:t?e[t]:null})),{colorClasses:r,colorStyles:i}=wP(n);return{textColorClasses:r,textColorStyles:i}}function zo(e,t){const n=fe(()=>({background:Oo(e)?e.value:t?e[t]:null})),{colorClasses:r,colorStyles:i}=wP(n);return{backgroundColorClasses:r,backgroundColorStyles:i}}const Sa=ht({elevation:{type:[Number,String],validator(e){const t=parseInt(e);return!isNaN(t)&&t>=0&&t<=24}}},"elevation");function rs(e){return{elevationClasses:fe(()=>{const n=Oo(e)?e.value:e.elevation,r=[];return n==null||r.push(`elevation-${n}`),r})}}const lo=ht({rounded:{type:[Boolean,Number,String],default:void 0}},"rounded");function ko(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uf();return{roundedClasses:fe(()=>{const r=Oo(e)?e.value:e.rounded,i=[];if(r===!0||r==="")i.push(`${t}--rounded`);else if(typeof r=="string"||r===0)for(const a of String(r).split(" "))i.push(`rounded-${a}`);return i})}}const aee=[null,"prominent","default","comfortable","compact"],HF=ht({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:e=>aee.includes(e)},extended:Boolean,extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...Vl(),...ln(),...Sa(),...lo(),...or({tag:"header"}),...ii()},"VToolbar"),XI=Mt()({name:"VToolbar",props:HF(),setup(e,t){var S;let{slots:n}=t;const{backgroundColorClasses:r,backgroundColorStyles:i}=zo(kt(e,"color")),{borderClasses:a}=ku(e),{elevationClasses:l}=rs(e),{roundedClasses:o}=ko(e),{themeClasses:f}=Ii(e),{rtlClasses:p}=Za(),y=on(!!(e.extended||(S=n.extension)!=null&&S.call(n))),x=fe(()=>parseInt(Number(e.height)+(e.density==="prominent"?Number(e.height):0)-(e.density==="comfortable"?8:0)-(e.density==="compact"?16:0),10)),w=fe(()=>y.value?parseInt(Number(e.extensionHeight)+(e.density==="prominent"?Number(e.extensionHeight):0)-(e.density==="comfortable"?4:0)-(e.density==="compact"?8:0),10):0);return fa({VBtn:{variant:"text"}}),Bt(()=>{var z;const L=!!(e.title||n.title),D=!!(n.image||e.image),B=(z=n.extension)==null?void 0:z.call(n);return y.value=!!(e.extended||B),H(e.tag,{class:["v-toolbar",{"v-toolbar--absolute":e.absolute,"v-toolbar--collapse":e.collapse,"v-toolbar--flat":e.flat,"v-toolbar--floating":e.floating,[`v-toolbar--density-${e.density}`]:!0},r.value,a.value,l.value,o.value,f.value,p.value,e.class],style:[i.value,e.style]},{default:()=>[D&&H("div",{key:"image",class:"v-toolbar__image"},[n.image?H(Mi,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},n.image):H(rg,{key:"image-img",cover:!0,src:e.image},null)]),H(Mi,{defaults:{VTabs:{height:dn(x.value)}}},{default:()=>{var M,k,V;return[H("div",{class:"v-toolbar__content",style:{height:dn(x.value)}},[n.prepend&&H("div",{class:"v-toolbar__prepend"},[(M=n.prepend)==null?void 0:M.call(n)]),L&&H(vP,{key:"title",text:e.title},{text:n.title}),(k=n.default)==null?void 0:k.call(n),n.append&&H("div",{class:"v-toolbar__append"},[(V=n.append)==null?void 0:V.call(n)])])]}}),H(Mi,{defaults:{VTabs:{height:dn(w.value)}}},{default:()=>[H(tE,null,{default:()=>[y.value&&H("div",{class:"v-toolbar__extension",style:{height:dn(w.value)}},[B])]})]})]})}),{contentHeight:x,extensionHeight:w}}}),see=ht({scrollTarget:{type:String},scrollThreshold:{type:[String,Number],default:300}},"scroll");function lee(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{canScroll:n}=t;let r=0;const i=Xt(null),a=on(0),l=on(0),o=on(0),f=on(!1),p=on(!1),y=fe(()=>Number(e.scrollThreshold)),x=fe(()=>ps((y.value-a.value)/y.value||0)),w=()=>{const S=i.value;!S||n&&!n.value||(r=a.value,a.value="window"in S?S.pageYOffset:S.scrollTop,p.value=a.value<r,o.value=Math.abs(a.value-y.value))};return cn(p,()=>{l.value=l.value||a.value}),cn(f,()=>{l.value=0}),bs(()=>{cn(()=>e.scrollTarget,S=>{var D;const L=S?document.querySelector(S):window;L&&L!==i.value&&((D=i.value)==null||D.removeEventListener("scroll",w),i.value=L,i.value.addEventListener("scroll",w,{passive:!0}))},{immediate:!0})}),Us(()=>{var S;(S=i.value)==null||S.removeEventListener("scroll",w)}),n&&cn(n,w,{immediate:!0}),{scrollThreshold:y,currentScroll:a,currentThreshold:o,isScrollActive:f,scrollRatio:x,isScrollingUp:p,savedScroll:l}}function pg(){const e=on(!1);return bs(()=>{window.requestAnimationFrame(()=>{e.value=!0})}),{ssrBootStyles:fe(()=>e.value?void 0:{transition:"none !important"}),isBooted:z0(e)}}const uee=ht({scrollBehavior:String,modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},...HF(),...ky(),...see(),height:{type:[Number,String],default:64}},"VAppBar"),cee=Mt()({name:"VAppBar",props:uee(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const r=Xt(),i=nr(e,"modelValue"),a=fe(()=>{var M;const z=new Set(((M=e.scrollBehavior)==null?void 0:M.split(" "))??[]);return{hide:z.has("hide"),inverted:z.has("inverted"),collapse:z.has("collapse"),elevate:z.has("elevate"),fadeImage:z.has("fade-image")}}),l=fe(()=>{const z=a.value;return z.hide||z.inverted||z.collapse||z.elevate||z.fadeImage||!i.value}),{currentScroll:o,scrollThreshold:f,isScrollingUp:p,scrollRatio:y}=lee(e,{canScroll:l}),x=fe(()=>e.collapse||a.value.collapse&&(a.value.inverted?y.value>0:y.value===0)),w=fe(()=>e.flat||a.value.elevate&&(a.value.inverted?o.value>0:o.value===0)),S=fe(()=>a.value.fadeImage?a.value.inverted?1-y.value:y.value:void 0),L=fe(()=>{var k,V;if(a.value.hide&&a.value.inverted)return 0;const z=((k=r.value)==null?void 0:k.contentHeight)??0,M=((V=r.value)==null?void 0:V.extensionHeight)??0;return z+M});md(fe(()=>!!e.scrollBehavior),()=>{Nl(()=>{a.value.hide?a.value.inverted?i.value=o.value>f.value:i.value=p.value||o.value<f.value:i.value=!0})});const{ssrBootStyles:D}=pg(),{layoutItemStyles:B}=Ny({id:e.name,order:fe(()=>parseInt(e.order,10)),position:kt(e,"location"),layoutSize:L,elementSize:on(void 0),active:i,absolute:kt(e,"absolute")});return Bt(()=>{const[z]=XI.filterProps(e);return H(XI,tn({ref:r,class:["v-app-bar",{"v-app-bar--bottom":e.location==="bottom"},e.class],style:[{...B.value,"--v-toolbar-image-opacity":S.value,height:void 0,...D.value},e.style]},z,{collapse:x.value,flat:w.value}),n)}),{}}});const hee=[null,"default","comfortable","compact"],Ta=ht({density:{type:String,default:"default",validator:e=>hee.includes(e)}},"density");function Es(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uf();return{densityClasses:fe(()=>`${t}--density-${e.density}`)}}const fee=["elevated","flat","tonal","outlined","text","plain"];function gg(e,t){return H(Dn,null,[e&&H("span",{key:"overlay",class:`${t}__overlay`},null),H("span",{key:"underlay",class:`${t}__underlay`},null)])}const Nu=ht({color:String,variant:{type:String,default:"elevated",validator:e=>fee.includes(e)}},"variant");function mg(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uf();const n=fe(()=>{const{variant:a}=Sl(e);return`${t}--variant-${a}`}),{colorClasses:r,colorStyles:i}=wP(fe(()=>{const{variant:a,color:l}=Sl(e);return{[["elevated","flat"].includes(a)?"background":"text"]:l}}));return{colorClasses:r,colorStyles:i,variantClasses:n}}const YF=ht({divided:Boolean,...Vl(),...ln(),...Ta(),...Sa(),...lo(),...or(),...ii(),...Nu()},"VBtnGroup"),WI=Mt()({name:"VBtnGroup",props:YF(),setup(e,t){let{slots:n}=t;const{themeClasses:r}=Ii(e),{densityClasses:i}=Es(e),{borderClasses:a}=ku(e),{elevationClasses:l}=rs(e),{roundedClasses:o}=ko(e);fa({VBtn:{height:"auto",color:kt(e,"color"),density:kt(e,"density"),flat:!0,variant:kt(e,"variant")}}),Bt(()=>H(e.tag,{class:["v-btn-group",{"v-btn-group--divided":e.divided},r.value,a.value,i.value,l.value,o.value,e.class],style:e.style},n))}}),Fy=ht({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),By=ht({value:null,disabled:Boolean,selectedClass:String},"group-item");function zy(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=qa("useGroupItem");if(!r)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const i=ws();da(Symbol.for(`${t.description}:id`),i);const a=Pi(t,null);if(!a){if(!n)return a;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${t.description}`)}const l=kt(e,"value"),o=fe(()=>!!(a.disabled.value||e.disabled));a.register({id:i,value:l,disabled:o},r),Us(()=>{a.unregister(i)});const f=fe(()=>a.isSelected(i)),p=fe(()=>f.value&&[a.selectedClass.value,e.selectedClass]);return cn(f,y=>{r.emit("group:selected",{value:y})}),{id:i,isSelected:f,toggle:()=>a.select(i,!f.value),select:y=>a.select(i,y),selectedClass:p,value:l,disabled:o,group:a}}function yg(e,t){let n=!1;const r=Qs([]),i=nr(e,"modelValue",[],w=>w==null?[]:KF(r,Pl(w)),w=>{const S=pee(r,w);return e.multiple?S:S[0]}),a=qa("useGroup");function l(w,S){const L=w,D=Symbol.for(`${t.description}:id`),z=Y_(D,a==null?void 0:a.vnode).indexOf(S);z>-1?r.splice(z,0,L):r.push(L)}function o(w){if(n)return;f();const S=r.findIndex(L=>L.id===w);r.splice(S,1)}function f(){const w=r.find(S=>!S.disabled);w&&e.mandatory==="force"&&!i.value.length&&(i.value=[w.id])}bs(()=>{f()}),Us(()=>{n=!0});function p(w,S){const L=r.find(D=>D.id===w);if(!(S&&(L!=null&&L.disabled)))if(e.multiple){const D=i.value.slice(),B=D.findIndex(M=>M===w),z=~B;if(S=S??!z,z&&e.mandatory&&D.length<=1||!z&&e.max!=null&&D.length+1>e.max)return;B<0&&S?D.push(w):B>=0&&!S&&D.splice(B,1),i.value=D}else{const D=i.value.includes(w);if(e.mandatory&&D)return;i.value=S??!D?[w]:[]}}function y(w){if(e.multiple,i.value.length){const S=i.value[0],L=r.findIndex(z=>z.id===S);let D=(L+w)%r.length,B=r[D];for(;B.disabled&&D!==L;)D=(D+w)%r.length,B=r[D];if(B.disabled)return;i.value=[r[D].id]}else{const S=r.find(L=>!L.disabled);S&&(i.value=[S.id])}}const x={register:l,unregister:o,selected:i,select:p,disabled:kt(e,"disabled"),prev:()=>y(r.length-1),next:()=>y(1),isSelected:w=>i.value.includes(w),selectedClass:fe(()=>e.selectedClass),items:fe(()=>r),getItemIndex:w=>dee(r,w)};return da(t,x),x}function dee(e,t){const n=KF(e,[t]);return n.length?e.findIndex(r=>r.id===n[0]):-1}function KF(e,t){const n=[];return t.forEach(r=>{const i=e.find(l=>Ry(r,l.value)),a=e[r];(i==null?void 0:i.value)!=null?n.push(i.id):a!=null&&n.push(a.id)}),n}function pee(e,t){const n=[];return t.forEach(r=>{const i=e.findIndex(a=>a.id===r);if(~i){const a=e[i];n.push(a.value!=null?a.value:i)}}),n}const EP=Symbol.for("vuetify:v-btn-toggle"),gee=ht({...YF(),...Fy()},"VBtnToggle"),mee=Mt()({name:"VBtnToggle",props:gee(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{isSelected:r,next:i,prev:a,select:l,selected:o}=yg(e,EP);return Bt(()=>{const[f]=WI.filterProps(e);return H(WI,tn({class:["v-btn-toggle",e.class]},f,{style:e.style}),{default:()=>{var p;return[(p=n.default)==null?void 0:p.call(n,{isSelected:r,next:i,prev:a,select:l,selected:o})]}})}),{next:i,prev:a,select:l}}});const yee=["x-small","small","default","large","x-large"],hf=ht({size:{type:[String,Number],default:"default"}},"size");function Uy(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uf();return lP(()=>{let n,r;return Qb(yee,e.size)?n=`${t}--size-${e.size}`:e.size&&(r={width:dn(e.size),height:dn(e.size)}),{sizeClasses:n,sizeStyles:r}})}const vee=ht({color:String,start:Boolean,end:Boolean,icon:Jn,...ln(),...hf(),...or({tag:"i"}),...ii()},"VIcon"),zi=Mt()({name:"VIcon",props:vee(),setup(e,t){let{attrs:n,slots:r}=t;const i=Xt(),{themeClasses:a}=Ii(e),{iconData:l}=aQ(fe(()=>i.value||e.icon)),{sizeClasses:o}=Uy(e),{textColorClasses:f,textColorStyles:p}=xs(kt(e,"color"));return Bt(()=>{var x,w;const y=(x=r.default)==null?void 0:x.call(r);return y&&(i.value=(w=mF(y).filter(S=>S.type===U0&&S.children&&typeof S.children=="string")[0])==null?void 0:w.children),H(l.value.component,{tag:e.tag,icon:l.value.icon,class:["v-icon","notranslate",a.value,o.value,f.value,{"v-icon--clickable":!!n.onClick,"v-icon--start":e.start,"v-icon--end":e.end},e.class],style:[o.value?void 0:{fontSize:dn(e.size),height:dn(e.size),width:dn(e.size)},p.value,e.style],role:n.onClick?"button":void 0,"aria-hidden":!n.onClick},{default:()=>[y]})}),{}}});function SP(e,t){const n=Xt(),r=on(!1);if(aP){const i=new IntersectionObserver(a=>{e==null||e(a,i),r.value=!!a.find(l=>l.isIntersecting)},t);Us(()=>{i.disconnect()}),cn(n,(a,l)=>{l&&(i.unobserve(l),r.value=!1),a&&i.observe(a)},{flush:"post"})}return{intersectionRef:n,isIntersecting:r}}const _ee=ht({bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},...ln(),...hf(),...or({tag:"div"}),...ii()},"VProgressCircular"),TP=Mt()({name:"VProgressCircular",props:_ee(),setup(e,t){let{slots:n}=t;const r=20,i=2*Math.PI*r,a=Xt(),{themeClasses:l}=Ii(e),{sizeClasses:o,sizeStyles:f}=Uy(e),{textColorClasses:p,textColorStyles:y}=xs(kt(e,"color")),{textColorClasses:x,textColorStyles:w}=xs(kt(e,"bgColor")),{intersectionRef:S,isIntersecting:L}=SP(),{resizeRef:D,contentRect:B}=lh(),z=fe(()=>Math.max(0,Math.min(100,parseFloat(e.modelValue)))),M=fe(()=>Number(e.width)),k=fe(()=>f.value?Number(e.size):B.value?B.value.width:Math.max(M.value,32)),V=fe(()=>r/(1-M.value/k.value)*2),q=fe(()=>M.value/k.value*V.value),Y=fe(()=>dn((100-z.value)/100*i));return Nl(()=>{S.value=a.value,D.value=a.value}),Bt(()=>H(e.tag,{ref:a,class:["v-progress-circular",{"v-progress-circular--indeterminate":!!e.indeterminate,"v-progress-circular--visible":L.value,"v-progress-circular--disable-shrink":e.indeterminate==="disable-shrink"},l.value,o.value,p.value,e.class],style:[f.value,y.value,e.style],role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":e.indeterminate?void 0:z.value},{default:()=>[H("svg",{style:{transform:`rotate(calc(-90deg + ${Number(e.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${V.value} ${V.value}`},[H("circle",{class:["v-progress-circular__underlay",x.value],style:w.value,fill:"transparent",cx:"50%",cy:"50%",r,"stroke-width":q.value,"stroke-dasharray":i,"stroke-dashoffset":0},null),H("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r,"stroke-width":q.value,"stroke-dasharray":i,"stroke-dashoffset":Y.value},null)]),n.default&&H("div",{class:"v-progress-circular__content"},[n.default({value:z.value})])]})),{}}});const rR={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},wd=ht({location:String},"location");function Ed(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2?arguments[2]:void 0;const{isRtl:r}=Za();return{locationStyles:fe(()=>{if(!e.location)return{};const{side:a,align:l}=FI(e.location.split(" ").length>1?e.location:`${e.location} center`,r.value);function o(p){return n?n(p):0}const f={};return a!=="center"&&(t?f[rR[a]]=`calc(100% - ${o(a)}px)`:f[a]=0),l!=="center"?t?f[rR[l]]=`calc(100% - ${o(l)}px)`:f[l]=0:(a==="center"?f.top=f.left="50%":f[{top:"left",bottom:"left",left:"top",right:"top"}[a]]="50%",f.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[a]),f})}}const xee=ht({absolute:Boolean,active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean,...ln(),...wd({location:"top"}),...lo(),...or(),...ii()},"VProgressLinear"),IP=Mt()({name:"VProgressLinear",props:xee(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const r=nr(e,"modelValue"),{isRtl:i,rtlClasses:a}=Za(),{themeClasses:l}=Ii(e),{locationStyles:o}=Ed(e),{textColorClasses:f,textColorStyles:p}=xs(e,"color"),{backgroundColorClasses:y,backgroundColorStyles:x}=zo(fe(()=>e.bgColor||e.color)),{backgroundColorClasses:w,backgroundColorStyles:S}=zo(e,"color"),{roundedClasses:L}=ko(e),{intersectionRef:D,isIntersecting:B}=SP(),z=fe(()=>parseInt(e.max,10)),M=fe(()=>parseInt(e.height,10)),k=fe(()=>parseFloat(e.bufferValue)/z.value*100),V=fe(()=>parseFloat(r.value)/z.value*100),q=fe(()=>i.value!==e.reverse),Y=fe(()=>e.indeterminate?"fade-transition":"slide-x-transition"),K=fe(()=>e.bgOpacity==null?e.bgOpacity:parseFloat(e.bgOpacity));function X(U){if(!D.value)return;const{left:le,right:ue,width:ae}=D.value.getBoundingClientRect(),ve=q.value?ae-U.clientX+(ue-ae):U.clientX-le;r.value=Math.round(ve/ae*z.value)}return Bt(()=>H(e.tag,{ref:D,class:["v-progress-linear",{"v-progress-linear--absolute":e.absolute,"v-progress-linear--active":e.active&&B.value,"v-progress-linear--reverse":q.value,"v-progress-linear--rounded":e.rounded,"v-progress-linear--rounded-bar":e.roundedBar,"v-progress-linear--striped":e.striped},L.value,l.value,a.value,e.class],style:[{bottom:e.location==="bottom"?0:void 0,top:e.location==="top"?0:void 0,height:e.active?dn(M.value):0,"--v-progress-linear-height":dn(M.value),...o.value},e.style],role:"progressbar","aria-hidden":e.active?"false":"true","aria-valuemin":"0","aria-valuemax":e.max,"aria-valuenow":e.indeterminate?void 0:V.value,onClick:e.clickable&&X},{default:()=>[e.stream&&H("div",{key:"stream",class:["v-progress-linear__stream",f.value],style:{...p.value,[q.value?"left":"right"]:dn(-M.value),borderTop:`${dn(M.value/2)} dotted`,opacity:K.value,top:`calc(50% - ${dn(M.value/4)})`,width:dn(100-k.value,"%"),"--v-progress-linear-stream-to":dn(M.value*(q.value?1:-1))}},null),H("div",{class:["v-progress-linear__background",y.value],style:[x.value,{opacity:K.value,width:dn(e.stream?k.value:100,"%")}]},null),H(Qc,{name:Y.value},{default:()=>[e.indeterminate?H("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(U=>H("div",{key:U,class:["v-progress-linear__indeterminate",U,w.value],style:S.value},null))]):H("div",{class:["v-progress-linear__determinate",w.value],style:[S.value,{width:dn(V.value,"%")}]},null)]}),n.default&&H("div",{class:"v-progress-linear__content"},[n.default({value:V.value,buffer:k.value})])]})),{}}}),CP=ht({loading:[Boolean,String]},"loader");function nE(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uf();return{loaderClasses:fe(()=>({[`${t}--loading`]:e.loading}))}}function PP(e,t){var r;let{slots:n}=t;return H("div",{class:`${e.name}__loader`},[((r=n.default)==null?void 0:r.call(n,{color:e.color,isActive:e.active}))||H(IP,{active:e.active,color:e.color,height:"2",indeterminate:!0},null)])}const bee=["static","relative","fixed","absolute","sticky"],Vy=ht({position:{type:String,validator:e=>bee.includes(e)}},"position");function Gy(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uf();return{positionClasses:fe(()=>e.position?`${t}--${e.position}`:void 0)}}function JF(){var e,t;return(t=(e=qa("useRouter"))==null?void 0:e.proxy)==null?void 0:t.$router}function o1(e,t){const n=v9("RouterLink"),r=fe(()=>!!(e.href||e.to)),i=fe(()=>(r==null?void 0:r.value)||A3(t,"click")||A3(e,"click"));if(typeof n=="string")return{isLink:r,isClickable:i,href:kt(e,"href")};const a=e.to?n.useLink(e):void 0;return{isLink:r,isClickable:i,route:a==null?void 0:a.route,navigate:a==null?void 0:a.navigate,isActive:a&&fe(()=>{var l,o;return e.exact?(l=a.isExactActive)==null?void 0:l.value:(o=a.isActive)==null?void 0:o.value}),href:fe(()=>e.to?a==null?void 0:a.route.value.href:e.href)}}const a1=ht({href:String,replace:Boolean,to:[String,Object],exact:Boolean},"router");let kT=!1;function wee(e,t){let n=!1,r,i;Yi&&(qi(()=>{window.addEventListener("popstate",a),r=e==null?void 0:e.beforeEach((l,o,f)=>{kT?n?t(f):f():setTimeout(()=>n?t(f):f()),kT=!0}),i=e==null?void 0:e.afterEach(()=>{kT=!1})}),il(()=>{window.removeEventListener("popstate",a),r==null||r(),i==null||i()}));function a(l){var o;(o=l.state)!=null&&o.replaced||(n=!0,setTimeout(()=>n=!1))}}function Eee(e,t){cn(()=>{var n;return(n=e.isActive)==null?void 0:n.value},n=>{e.isLink.value&&n&&t&&qi(()=>{t(!0)})},{immediate:!0})}const HI=Symbol("rippleStop"),See=80;function iR(e,t){e.style.transform=t,e.style.webkitTransform=t}function YI(e){return e.constructor.name==="TouchEvent"}function QF(e){return e.constructor.name==="KeyboardEvent"}const Tee=function(e,t){var x;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=0,i=0;if(!QF(e)){const w=t.getBoundingClientRect(),S=YI(e)?e.touches[e.touches.length-1]:e;r=S.clientX-w.left,i=S.clientY-w.top}let a=0,l=.3;(x=t._ripple)!=null&&x.circle?(l=.15,a=t.clientWidth/2,a=n.center?a:a+Math.sqrt((r-a)**2+(i-a)**2)/4):a=Math.sqrt(t.clientWidth**2+t.clientHeight**2)/2;const o=`${(t.clientWidth-a*2)/2}px`,f=`${(t.clientHeight-a*2)/2}px`,p=n.center?o:`${r-a}px`,y=n.center?f:`${i-a}px`;return{radius:a,scale:l,x:p,y,centerX:o,centerY:f}},iw={show(e,t){var S;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!((S=t==null?void 0:t._ripple)!=null&&S.enabled))return;const r=document.createElement("span"),i=document.createElement("span");r.appendChild(i),r.className="v-ripple__container",n.class&&(r.className+=` ${n.class}`);const{radius:a,scale:l,x:o,y:f,centerX:p,centerY:y}=Tee(e,t,n),x=`${a*2}px`;i.className="v-ripple__animation",i.style.width=x,i.style.height=x,t.appendChild(r);const w=window.getComputedStyle(t);w&&w.position==="static"&&(t.style.position="relative",t.dataset.previousPosition="static"),i.classList.add("v-ripple__animation--enter"),i.classList.add("v-ripple__animation--visible"),iR(i,`translate(${o}, ${f}) scale3d(${l},${l},${l})`),i.dataset.activated=String(performance.now()),setTimeout(()=>{i.classList.remove("v-ripple__animation--enter"),i.classList.add("v-ripple__animation--in"),iR(i,`translate(${p}, ${y}) scale3d(1,1,1)`)},0)},hide(e){var a;if(!((a=e==null?void 0:e._ripple)!=null&&a.enabled))return;const t=e.getElementsByClassName("v-ripple__animation");if(t.length===0)return;const n=t[t.length-1];if(n.dataset.isHiding)return;n.dataset.isHiding="true";const r=performance.now()-Number(n.dataset.activated),i=Math.max(250-r,0);setTimeout(()=>{n.classList.remove("v-ripple__animation--in"),n.classList.add("v-ripple__animation--out"),setTimeout(()=>{var o;e.getElementsByClassName("v-ripple__animation").length===1&&e.dataset.previousPosition&&(e.style.position=e.dataset.previousPosition,delete e.dataset.previousPosition),((o=n.parentNode)==null?void 0:o.parentNode)===e&&e.removeChild(n.parentNode)},300)},i)}};function eB(e){return typeof e>"u"||!!e}function k0(e){const t={},n=e.currentTarget;if(!(!(n!=null&&n._ripple)||n._ripple.touched||e[HI])){if(e[HI]=!0,YI(e))n._ripple.touched=!0,n._ripple.isTouch=!0;else if(n._ripple.isTouch)return;if(t.center=n._ripple.centered||QF(e),n._ripple.class&&(t.class=n._ripple.class),YI(e)){if(n._ripple.showTimerCommit)return;n._ripple.showTimerCommit=()=>{iw.show(e,n,t)},n._ripple.showTimer=window.setTimeout(()=>{var r;(r=n==null?void 0:n._ripple)!=null&&r.showTimerCommit&&(n._ripple.showTimerCommit(),n._ripple.showTimerCommit=null)},See)}else iw.show(e,n,t)}}function oR(e){e[HI]=!0}function El(e){const t=e.currentTarget;if(t!=null&&t._ripple){if(window.clearTimeout(t._ripple.showTimer),e.type==="touchend"&&t._ripple.showTimerCommit){t._ripple.showTimerCommit(),t._ripple.showTimerCommit=null,t._ripple.showTimer=window.setTimeout(()=>{El(e)});return}window.setTimeout(()=>{t._ripple&&(t._ripple.touched=!1)}),iw.hide(t)}}function tB(e){const t=e.currentTarget;t!=null&&t._ripple&&(t._ripple.showTimerCommit&&(t._ripple.showTimerCommit=null),window.clearTimeout(t._ripple.showTimer))}let N0=!1;function nB(e){!N0&&(e.keyCode===T3.enter||e.keyCode===T3.space)&&(N0=!0,k0(e))}function rB(e){N0=!1,El(e)}function iB(e){N0&&(N0=!1,El(e))}function oB(e,t,n){const{value:r,modifiers:i}=t,a=eB(r);if(a||iw.hide(e),e._ripple=e._ripple??{},e._ripple.enabled=a,e._ripple.centered=i.center,e._ripple.circle=i.circle,Jb(r)&&r.class&&(e._ripple.class=r.class),a&&!n){if(i.stop){e.addEventListener("touchstart",oR,{passive:!0}),e.addEventListener("mousedown",oR);return}e.addEventListener("touchstart",k0,{passive:!0}),e.addEventListener("touchend",El,{passive:!0}),e.addEventListener("touchmove",tB,{passive:!0}),e.addEventListener("touchcancel",El),e.addEventListener("mousedown",k0),e.addEventListener("mouseup",El),e.addEventListener("mouseleave",El),e.addEventListener("keydown",nB),e.addEventListener("keyup",rB),e.addEventListener("blur",iB),e.addEventListener("dragstart",El,{passive:!0})}else!a&&n&&aB(e)}function aB(e){e.removeEventListener("mousedown",k0),e.removeEventListener("touchstart",k0),e.removeEventListener("touchend",El),e.removeEventListener("touchmove",tB),e.removeEventListener("touchcancel",El),e.removeEventListener("mouseup",El),e.removeEventListener("mouseleave",El),e.removeEventListener("keydown",nB),e.removeEventListener("keyup",rB),e.removeEventListener("dragstart",El),e.removeEventListener("blur",iB)}function Iee(e,t){oB(e,t,!1)}function Cee(e){delete e._ripple,aB(e)}function Pee(e,t){if(t.value===t.oldValue)return;const n=eB(t.oldValue);oB(e,t,n)}const Sd={mounted:Iee,unmounted:Cee,updated:Pee},AP=ht({active:{type:Boolean,default:void 0},symbol:{type:null,default:EP},flat:Boolean,icon:[Boolean,String,Function,Object],prependIcon:Jn,appendIcon:Jn,block:Boolean,stacked:Boolean,ripple:{type:[Boolean,Object],default:!0},text:String,...Vl(),...ln(),...Ta(),...Du(),...Sa(),...By(),...CP(),...wd(),...Vy(),...lo(),...a1(),...hf(),...or({tag:"button"}),...ii(),...Nu({variant:"elevated"})},"VBtn"),Ls=Mt()({name:"VBtn",directives:{Ripple:Sd},props:AP(),emits:{"group:selected":e=>!0},setup(e,t){let{attrs:n,slots:r}=t;const{themeClasses:i}=Ii(e),{borderClasses:a}=ku(e),{colorClasses:l,colorStyles:o,variantClasses:f}=mg(e),{densityClasses:p}=Es(e),{dimensionStyles:y}=Ru(e),{elevationClasses:x}=rs(e),{loaderClasses:w}=nE(e),{locationStyles:S}=Ed(e),{positionClasses:L}=Gy(e),{roundedClasses:D}=ko(e),{sizeClasses:B,sizeStyles:z}=Uy(e),M=zy(e,e.symbol,!1),k=o1(e,n),V=fe(()=>{var U;return e.active!==void 0?e.active:k.isLink.value?(U=k.isActive)==null?void 0:U.value:M==null?void 0:M.isSelected.value}),q=fe(()=>(M==null?void 0:M.disabled.value)||e.disabled),Y=fe(()=>e.variant==="elevated"&&!(e.disabled||e.flat||e.border)),K=fe(()=>{if(e.value!==void 0)return Object(e.value)===e.value?JSON.stringify(e.value,null,0):e.value});function X(U){var le;q.value||k.isLink.value&&(U.metaKey||U.ctrlKey||U.shiftKey||U.button!==0||n.target==="_blank")||((le=k.navigate)==null||le.call(k,U),M==null||M.toggle())}return Eee(k,M==null?void 0:M.select),Bt(()=>{var Ee,He;const U=k.isLink.value?"a":e.tag,le=!!(e.prependIcon||r.prepend),ue=!!(e.appendIcon||r.append),ae=!!(e.icon&&e.icon!==!0),ve=(M==null?void 0:M.isSelected.value)&&(!k.isLink.value||((Ee=k.isActive)==null?void 0:Ee.value))||!M||((He=k.isActive)==null?void 0:He.value);return go(H(U,{type:U==="a"?void 0:"button",class:["v-btn",M==null?void 0:M.selectedClass.value,{"v-btn--active":V.value,"v-btn--block":e.block,"v-btn--disabled":q.value,"v-btn--elevated":Y.value,"v-btn--flat":e.flat,"v-btn--icon":!!e.icon,"v-btn--loading":e.loading,"v-btn--stacked":e.stacked},i.value,a.value,ve?l.value:void 0,p.value,x.value,w.value,L.value,D.value,B.value,f.value,e.class],style:[ve?o.value:void 0,y.value,S.value,z.value,e.style],disabled:q.value||void 0,href:k.href.value,onClick:X,value:K.value},{default:()=>{var Oe;return[gg(!0,"v-btn"),!e.icon&&le&&H("span",{key:"prepend",class:"v-btn__prepend"},[r.prepend?H(Mi,{key:"prepend-defaults",disabled:!e.prependIcon,defaults:{VIcon:{icon:e.prependIcon}}},r.prepend):H(zi,{key:"prepend-icon",icon:e.prependIcon},null)]),H("span",{class:"v-btn__content","data-no-activator":""},[!r.default&&ae?H(zi,{key:"content-icon",icon:e.icon},null):H(Mi,{key:"content-defaults",disabled:!ae,defaults:{VIcon:{icon:e.icon}}},{default:()=>{var Ve;return[((Ve=r.default)==null?void 0:Ve.call(r))??e.text]}})]),!e.icon&&ue&&H("span",{key:"append",class:"v-btn__append"},[r.append?H(Mi,{key:"append-defaults",disabled:!e.appendIcon,defaults:{VIcon:{icon:e.appendIcon}}},r.append):H(zi,{key:"append-icon",icon:e.appendIcon},null)]),!!e.loading&&H("span",{key:"loader",class:"v-btn__loader"},[((Oe=r.loader)==null?void 0:Oe.call(r))??H(TP,{color:typeof e.loading=="boolean"?void 0:e.loading,indeterminate:!0,size:"23",width:"2"},null)])]}}),[[Fl("ripple"),!q.value&&e.ripple,null]])}),{}}}),Aee=ht({...AP({icon:"$menu",variant:"text"})},"VAppBarNavIcon"),Mee=Mt()({name:"VAppBarNavIcon",props:Aee(),setup(e,t){let{slots:n}=t;return Bt(()=>H(Ls,tn(e,{class:["v-app-bar-nav-icon"]}),n)),{}}}),Lee=Mt()({name:"VAppBarTitle",props:$F(),setup(e,t){let{slots:n}=t;return Bt(()=>H(vP,tn(e,{class:"v-app-bar-title"}),n)),{}}});const sB=Tc("v-alert-title"),Oee=["success","info","warning","error"],Dee=ht({border:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:Jn,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>Oee.includes(e)},...ln(),...Ta(),...Du(),...Sa(),...wd(),...Vy(),...lo(),...or(),...ii(),...Nu({variant:"flat"})},"VAlert"),Ree=Mt()({name:"VAlert",props:Dee(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{emit:n,slots:r}=t;const i=nr(e,"modelValue"),a=fe(()=>{if(e.icon!==!1)return e.type?e.icon??`$${e.type}`:e.icon}),l=fe(()=>({color:e.color??e.type,variant:e.variant})),{themeClasses:o}=Ii(e),{colorClasses:f,colorStyles:p,variantClasses:y}=mg(l),{densityClasses:x}=Es(e),{dimensionStyles:w}=Ru(e),{elevationClasses:S}=rs(e),{locationStyles:L}=Ed(e),{positionClasses:D}=Gy(e),{roundedClasses:B}=ko(e),{textColorClasses:z,textColorStyles:M}=xs(kt(e,"borderColor")),{t:k}=Ou(),V=fe(()=>({"aria-label":k(e.closeLabel),onClick(q){i.value=!1,n("click:close",q)}}));return()=>{const q=!!(r.prepend||a.value),Y=!!(r.title||e.title),K=!!(r.close||e.closable);return i.value&&H(e.tag,{class:["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${e.border===!0?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},o.value,f.value,x.value,S.value,D.value,B.value,y.value,e.class],style:[p.value,w.value,L.value,e.style],role:"alert"},{default:()=>{var X,U;return[gg(!1,"v-alert"),e.border&&H("div",{key:"border",class:["v-alert__border",z.value],style:M.value},null),q&&H("div",{key:"prepend",class:"v-alert__prepend"},[r.prepend?H(Mi,{key:"prepend-defaults",disabled:!a.value,defaults:{VIcon:{density:e.density,icon:a.value,size:e.prominent?44:28}}},r.prepend):H(zi,{key:"prepend-icon",density:e.density,icon:a.value,size:e.prominent?44:28},null)]),H("div",{class:"v-alert__content"},[Y&&H(sB,{key:"title"},{default:()=>{var le;return[((le=r.title)==null?void 0:le.call(r))??e.title]}}),((X=r.text)==null?void 0:X.call(r))??e.text,(U=r.default)==null?void 0:U.call(r)]),r.append&&H("div",{key:"append",class:"v-alert__append"},[r.append()]),K&&H("div",{key:"close",class:"v-alert__close"},[r.close?H(Mi,{key:"close-defaults",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var le;return[(le=r.close)==null?void 0:le.call(r,{props:V.value})]}}):H(Ls,tn({key:"close-btn",icon:e.closeIcon,size:"x-small",variant:"text"},V.value),null)])]}})}}});const kee=ht({text:String,clickable:Boolean,...ln(),...ii()},"VLabel"),$y=Mt()({name:"VLabel",props:kee(),setup(e,t){let{slots:n}=t;return Bt(()=>{var r;return H("label",{class:["v-label",{"v-label--clickable":e.clickable},e.class],style:e.style},[e.text,(r=n.default)==null?void 0:r.call(n)])}),{}}});const lB=Symbol.for("vuetify:selection-control-group"),MP=ht({color:String,disabled:{type:Boolean,default:null},defaultsTarget:String,error:Boolean,id:String,inline:Boolean,falseIcon:Jn,trueIcon:Jn,ripple:{type:Boolean,default:!0},multiple:{type:Boolean,default:null},name:String,readonly:Boolean,modelValue:null,type:String,valueComparator:{type:Function,default:Ry},...ln(),...Ta(),...ii()},"SelectionControlGroup"),Nee=ht({...MP({defaultsTarget:"VSelectionControl"})},"VSelectionControlGroup"),uB=Mt()({name:"VSelectionControlGroup",props:Nee(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const r=nr(e,"modelValue"),i=ws(),a=fe(()=>e.id||`v-selection-control-group-${i}`),l=fe(()=>e.name||a.value),o=new Set;return da(lB,{modelValue:r,forceUpdate:()=>{o.forEach(f=>f())},onForceUpdate:f=>{o.add(f),il(()=>{o.delete(f)})}}),fa({[e.defaultsTarget]:{color:kt(e,"color"),disabled:kt(e,"disabled"),density:kt(e,"density"),error:kt(e,"error"),inline:kt(e,"inline"),modelValue:r,multiple:fe(()=>!!e.multiple||e.multiple==null&&Array.isArray(r.value)),name:l,falseIcon:kt(e,"falseIcon"),trueIcon:kt(e,"trueIcon"),readonly:kt(e,"readonly"),ripple:kt(e,"ripple"),type:kt(e,"type"),valueComparator:kt(e,"valueComparator")}}),Bt(()=>{var f;return H("div",{class:["v-selection-control-group",{"v-selection-control-group--inline":e.inline},e.class],style:e.style,role:e.type==="radio"?"radiogroup":void 0},[(f=n.default)==null?void 0:f.call(n)])}),{}}}),rE=ht({label:String,trueValue:null,falseValue:null,value:null,...ln(),...MP()},"VSelectionControl");function Fee(e){const t=Pi(lB,void 0),{densityClasses:n}=Es(e),r=nr(e,"modelValue"),i=fe(()=>e.trueValue!==void 0?e.trueValue:e.value!==void 0?e.value:!0),a=fe(()=>e.falseValue!==void 0?e.falseValue:!1),l=fe(()=>!!e.multiple||e.multiple==null&&Array.isArray(r.value)),o=fe({get(){const S=t?t.modelValue.value:r.value;return l.value?S.some(L=>e.valueComparator(L,i.value)):e.valueComparator(S,i.value)},set(S){if(e.readonly)return;const L=S?i.value:a.value;let D=L;l.value&&(D=S?[...Pl(r.value),L]:Pl(r.value).filter(B=>!e.valueComparator(B,i.value))),t?t.modelValue.value=D:r.value=D}}),{textColorClasses:f,textColorStyles:p}=xs(fe(()=>o.value&&!e.error&&!e.disabled?e.color:void 0)),{backgroundColorClasses:y,backgroundColorStyles:x}=zo(fe(()=>o.value&&!e.error&&!e.disabled?e.color:void 0)),w=fe(()=>o.value?e.trueIcon:e.falseIcon);return{group:t,densityClasses:n,trueValue:i,falseValue:a,model:o,textColorClasses:f,textColorStyles:p,backgroundColorClasses:y,backgroundColorStyles:x,icon:w}}const ig=Mt()({name:"VSelectionControl",directives:{Ripple:Sd},inheritAttrs:!1,props:rE(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:n,slots:r}=t;const{group:i,densityClasses:a,icon:l,model:o,textColorClasses:f,textColorStyles:p,backgroundColorClasses:y,backgroundColorStyles:x,trueValue:w}=Fee(e),S=ws(),L=fe(()=>e.id||`input-${S}`),D=on(!1),B=on(!1),z=Xt();i==null||i.onForceUpdate(()=>{z.value&&(z.value.checked=o.value)});function M(q){D.value=!0,_y(q.target,":focus-visible")!==!1&&(B.value=!0)}function k(){D.value=!1,B.value=!1}function V(q){e.readonly&&i&&qi(()=>i.forceUpdate()),o.value=q.target.checked}return Bt(()=>{var U,le;const q=r.label?r.label({label:e.label,props:{for:L.value}}):e.label,[Y,K]=fg(n),X=H("input",tn({ref:z,checked:o.value,disabled:!!(e.readonly||e.disabled),id:L.value,onBlur:k,onFocus:M,onInput:V,"aria-disabled":!!(e.readonly||e.disabled),type:e.type,value:w.value,name:e.name,"aria-checked":e.type==="checkbox"?o.value:void 0},K),null);return H("div",tn({class:["v-selection-control",{"v-selection-control--dirty":o.value,"v-selection-control--disabled":e.disabled,"v-selection-control--error":e.error,"v-selection-control--focused":D.value,"v-selection-control--focus-visible":B.value,"v-selection-control--inline":e.inline},a.value,e.class]},Y,{style:e.style}),[H("div",{class:["v-selection-control__wrapper",f.value],style:p.value},[(U=r.default)==null?void 0:U.call(r,{backgroundColorClasses:y,backgroundColorStyles:x}),go(H("div",{class:["v-selection-control__input"]},[((le=r.input)==null?void 0:le.call(r,{model:o,textColorClasses:f,textColorStyles:p,backgroundColorClasses:y,backgroundColorStyles:x,inputNode:X,icon:l.value,props:{onFocus:M,onBlur:k,id:L.value}}))??H(Dn,null,[l.value&&H(zi,{key:"icon",icon:l.value},null),X])]),[[Fl("ripple"),e.ripple&&[!e.disabled&&!e.readonly,null,["center","circle"]]]])]),q&&H($y,{for:L.value,clickable:!0,onClick:ue=>ue.stopPropagation()},{default:()=>[q]})])}),{isFocused:D,input:z}}}),cB=ht({indeterminate:Boolean,indeterminateIcon:{type:Jn,default:"$checkboxIndeterminate"},...rE({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),wy=Mt()({name:"VCheckboxBtn",props:cB(),emits:{"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,t){let{slots:n}=t;const r=nr(e,"indeterminate"),i=nr(e,"modelValue");function a(f){r.value&&(r.value=!1)}const l=fe(()=>r.value?e.indeterminateIcon:e.falseIcon),o=fe(()=>r.value?e.indeterminateIcon:e.trueIcon);return Bt(()=>{const f=Mu(ig.filterProps(e)[0],["modelValue"]);return H(ig,tn(f,{modelValue:i.value,"onUpdate:modelValue":[p=>i.value=p,a],class:["v-checkbox-btn",e.class],style:e.style,type:"checkbox",falseIcon:l.value,trueIcon:o.value,"aria-checked":r.value?"mixed":void 0}),n)}),{}}});function hB(e){const{t}=Ou();function n(r){let{name:i}=r;const a={prepend:"prependAction",prependInner:"prependAction",append:"appendAction",appendInner:"appendAction",clear:"clear"}[i],l=e[`onClick:${i}`],o=l&&a?t(`$vuetify.input.${a}`,e.label??""):void 0;return H(zi,{icon:e[`${i}Icon`],"aria-label":o,onClick:l},null)}return{InputIcon:n}}const Bee=ht({active:Boolean,color:String,messages:{type:[Array,String],default:()=>[]},...ln(),...cf({transition:{component:xP,leaveAbsolute:!0,group:!0}})},"VMessages"),fB=Mt()({name:"VMessages",props:Bee(),setup(e,t){let{slots:n}=t;const r=fe(()=>Pl(e.messages)),{textColorClasses:i,textColorStyles:a}=xs(fe(()=>e.color));return Bt(()=>H(uc,{transition:e.transition,tag:"div",class:["v-messages",i.value,e.class],style:[a.value,e.style],role:"alert","aria-live":"polite"},{default:()=>[e.active&&r.value.map((l,o)=>H("div",{class:"v-messages__message",key:`${o}-${r.value}`},[n.message?n.message({message:l}):l]))]})),{}}}),iE=ht({focused:Boolean,"onUpdate:focused":Jc()},"focus");function Td(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uf();const n=nr(e,"focused"),r=fe(()=>({[`${t}--focused`]:n.value}));function i(){n.value=!0}function a(){n.value=!1}return{focusClasses:r,isFocused:n,focus:i,blur:a}}const dB=Symbol.for("vuetify:form"),zee=ht({disabled:Boolean,fastFail:Boolean,readonly:Boolean,modelValue:{type:Boolean,default:null},validateOn:{type:String,default:"input"}},"form");function Uee(e){const t=nr(e,"modelValue"),n=fe(()=>e.disabled),r=fe(()=>e.readonly),i=on(!1),a=Xt([]),l=Xt([]);async function o(){const y=[];let x=!0;l.value=[],i.value=!0;for(const w of a.value){const S=await w.validate();if(S.length>0&&(x=!1,y.push({id:w.id,errorMessages:S})),!x&&e.fastFail)break}return l.value=y,i.value=!1,{valid:x,errors:l.value}}function f(){a.value.forEach(y=>y.reset())}function p(){a.value.forEach(y=>y.resetValidation())}return cn(a,()=>{let y=0,x=0;const w=[];for(const S of a.value)S.isValid===!1?(x++,w.push({id:S.id,errorMessages:S.errorMessages})):S.isValid===!0&&y++;l.value=w,t.value=x>0?!1:y===a.value.length?!0:null},{deep:!0}),da(dB,{register:y=>{let{id:x,validate:w,reset:S,resetValidation:L}=y;a.value.some(D=>D.id===x),a.value.push({id:x,validate:w,reset:S,resetValidation:L,isValid:null,errorMessages:[]})},unregister:y=>{a.value=a.value.filter(x=>x.id!==y)},update:(y,x,w)=>{const S=a.value.find(L=>L.id===y);S&&(S.isValid=x,S.errorMessages=w)},isDisabled:n,isReadonly:r,isValidating:i,isValid:t,items:a,validateOn:kt(e,"validateOn")}),{errors:l,isDisabled:n,isReadonly:r,isValidating:i,isValid:t,items:a,validate:o,reset:f,resetValidation:p}}function oE(){return Pi(dB,null)}const pB=ht({disabled:{type:Boolean,default:null},error:Boolean,errorMessages:{type:[Array,String],default:()=>[]},maxErrors:{type:[Number,String],default:1},name:String,label:String,readonly:{type:Boolean,default:null},rules:{type:Array,default:()=>[]},modelValue:null,validateOn:String,validationValue:null,...iE()},"validation");function gB(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uf(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ws();const r=nr(e,"modelValue"),i=fe(()=>e.validationValue===void 0?r.value:e.validationValue),a=oE(),l=Xt([]),o=on(!0),f=fe(()=>!!(Pl(r.value===""?null:r.value).length||Pl(i.value===""?null:i.value).length)),p=fe(()=>!!(e.disabled??(a==null?void 0:a.isDisabled.value))),y=fe(()=>!!(e.readonly??(a==null?void 0:a.isReadonly.value))),x=fe(()=>e.errorMessages.length?Pl(e.errorMessages).slice(0,Math.max(0,+e.maxErrors)):l.value),w=fe(()=>{let V=(e.validateOn??(a==null?void 0:a.validateOn.value))||"input";V==="lazy"&&(V="input lazy");const q=new Set((V==null?void 0:V.split(" "))??[]);return{blur:q.has("blur")||q.has("input"),input:q.has("input"),submit:q.has("submit"),lazy:q.has("lazy")}}),S=fe(()=>e.error||e.errorMessages.length?!1:e.rules.length?o.value?l.value.length||w.value.lazy?null:!0:!l.value.length:!0),L=on(!1),D=fe(()=>({[`${t}--error`]:S.value===!1,[`${t}--dirty`]:f.value,[`${t}--disabled`]:p.value,[`${t}--readonly`]:y.value})),B=fe(()=>e.name??Sl(n));gw(()=>{a==null||a.register({id:B.value,validate:k,reset:z,resetValidation:M})}),Us(()=>{a==null||a.unregister(B.value)}),bs(async()=>{w.value.lazy||await k(!0),a==null||a.update(B.value,S.value,x.value)}),md(()=>w.value.input,()=>{cn(i,()=>{if(i.value!=null)k();else if(e.focused){const V=cn(()=>e.focused,q=>{q||k(),V()})}})}),md(()=>w.value.blur,()=>{cn(()=>e.focused,V=>{V||k()})}),cn(S,()=>{a==null||a.update(B.value,S.value,x.value)});function z(){r.value=null,qi(M)}function M(){o.value=!0,w.value.lazy?l.value=[]:k(!0)}async function k(){let V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const q=[];L.value=!0;for(const Y of e.rules){if(q.length>=+(e.maxErrors??1))break;const X=await(typeof Y=="function"?Y:()=>Y)(i.value);if(X!==!0){if(X!==!1&&typeof X!="string"){console.warn(`${X} is not a valid value. Rule functions must return boolean true or a string.`);continue}q.push(X||"")}}return l.value=q,L.value=!1,o.value=V,l.value}return{errorMessages:x,isDirty:f,isDisabled:p,isReadonly:y,isPristine:o,isValid:S,isValidating:L,reset:z,resetValidation:M,validate:k,validationClasses:D}}const ff=ht({id:String,appendIcon:Jn,centerAffix:{type:Boolean,default:!0},prependIcon:Jn,hideDetails:[Boolean,String],hint:String,persistentHint:Boolean,messages:{type:[Array,String],default:()=>[]},direction:{type:String,default:"horizontal",validator:e=>["horizontal","vertical"].includes(e)},"onClick:prepend":Jc(),"onClick:append":Jc(),...ln(),...Ta(),...pB()},"VInput"),ns=Mt()({name:"VInput",props:{...ff()},emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:n,slots:r,emit:i}=t;const{densityClasses:a}=Es(e),{rtlClasses:l}=Za(),{InputIcon:o}=hB(e),f=ws(),p=fe(()=>e.id||`input-${f}`),y=fe(()=>`${p.value}-messages`),{errorMessages:x,isDirty:w,isDisabled:S,isReadonly:L,isPristine:D,isValid:B,isValidating:z,reset:M,resetValidation:k,validate:V,validationClasses:q}=gB(e,"v-input",p),Y=fe(()=>({id:p,messagesId:y,isDirty:w,isDisabled:S,isReadonly:L,isPristine:D,isValid:B,isValidating:z,reset:M,resetValidation:k,validate:V})),K=fe(()=>{var X;return(X=e.errorMessages)!=null&&X.length||!D.value&&x.value.length?x.value:e.hint&&(e.persistentHint||e.focused)?e.hint:e.messages});return Bt(()=>{var ae,ve,Ee,He;const X=!!(r.prepend||e.prependIcon),U=!!(r.append||e.appendIcon),le=K.value.length>0,ue=!e.hideDetails||e.hideDetails==="auto"&&(le||!!r.details);return H("div",{class:["v-input",`v-input--${e.direction}`,{"v-input--center-affix":e.centerAffix},a.value,l.value,q.value,e.class],style:e.style},[X&&H("div",{key:"prepend",class:"v-input__prepend"},[(ae=r.prepend)==null?void 0:ae.call(r,Y.value),e.prependIcon&&H(o,{key:"prepend-icon",name:"prepend"},null)]),r.default&&H("div",{class:"v-input__control"},[(ve=r.default)==null?void 0:ve.call(r,Y.value)]),U&&H("div",{key:"append",class:"v-input__append"},[e.appendIcon&&H(o,{key:"append-icon",name:"append"},null),(Ee=r.append)==null?void 0:Ee.call(r,Y.value)]),ue&&H("div",{class:"v-input__details"},[H(fB,{id:y.value,active:le,messages:K.value},{message:r.message}),(He=r.details)==null?void 0:He.call(r,Y.value)])])}),{reset:M,resetValidation:k,validate:V}}}),Vee=ht({...ff(),...Mu(cB(),["inline"])},"VCheckbox"),Gee=Mt()({name:"VCheckbox",inheritAttrs:!1,props:Vee(),emits:{"update:modelValue":e=>!0,"update:focused":e=>!0},setup(e,t){let{attrs:n,slots:r}=t;const i=nr(e,"modelValue"),{isFocused:a,focus:l,blur:o}=Td(e),f=ws(),p=fe(()=>e.id||`checkbox-${f}`);return Bt(()=>{const[y,x]=fg(n),[w,S]=ns.filterProps(e),[L,D]=wy.filterProps(e);return H(ns,tn({class:["v-checkbox",e.class]},y,w,{modelValue:i.value,"onUpdate:modelValue":B=>i.value=B,id:p.value,focused:a.value,style:e.style}),{...r,default:B=>{let{id:z,messagesId:M,isDisabled:k,isReadonly:V}=B;return H(wy,tn(L,{id:z.value,"aria-describedby":M.value,disabled:k.value,readonly:V.value},x,{modelValue:i.value,"onUpdate:modelValue":q=>i.value=q,onFocus:l,onBlur:o}),r)}})}),{}}});const $ee=ht({start:Boolean,end:Boolean,icon:Jn,image:String,...ln(),...Ta(),...lo(),...hf(),...or(),...ii(),...Nu({variant:"flat"})},"VAvatar"),yd=Mt()({name:"VAvatar",props:$ee(),setup(e,t){let{slots:n}=t;const{themeClasses:r}=Ii(e),{colorClasses:i,colorStyles:a,variantClasses:l}=mg(e),{densityClasses:o}=Es(e),{roundedClasses:f}=ko(e),{sizeClasses:p,sizeStyles:y}=Uy(e);return Bt(()=>H(e.tag,{class:["v-avatar",{"v-avatar--start":e.start,"v-avatar--end":e.end},r.value,i.value,o.value,f.value,p.value,l.value,e.class],style:[a.value,y.value,e.style]},{default:()=>{var x;return[e.image?H(rg,{key:"image",src:e.image,alt:"",cover:!0},null):e.icon?H(zi,{key:"icon",icon:e.icon},null):(x=n.default)==null?void 0:x.call(n),gg(!1,"v-avatar")]}})),{}}});const mB=Symbol.for("vuetify:v-chip-group"),jee=ht({column:Boolean,filter:Boolean,valueComparator:{type:Function,default:Ry},...ln(),...Fy({selectedClass:"v-chip--selected"}),...or(),...ii(),...Nu({variant:"tonal"})},"VChipGroup"),qee=Mt()({name:"VChipGroup",props:jee(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{themeClasses:r}=Ii(e),{isSelected:i,select:a,next:l,prev:o,selected:f}=yg(e,mB);return fa({VChip:{color:kt(e,"color"),disabled:kt(e,"disabled"),filter:kt(e,"filter"),variant:kt(e,"variant")}}),Bt(()=>H(e.tag,{class:["v-chip-group",{"v-chip-group--column":e.column},r.value,e.class],style:e.style},{default:()=>{var p;return[(p=n.default)==null?void 0:p.call(n,{isSelected:i,select:a,next:l,prev:o,selected:f.value})]}})),{}}}),Zee=ht({activeClass:String,appendAvatar:String,appendIcon:Jn,closable:Boolean,closeIcon:{type:Jn,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:{type:Boolean,default:void 0},pill:Boolean,prependAvatar:String,prependIcon:Jn,ripple:{type:[Boolean,Object],default:!0},text:String,modelValue:{type:Boolean,default:!0},onClick:Jc(),onClickOnce:Jc(),...Vl(),...ln(),...Ta(),...Sa(),...By(),...lo(),...a1(),...hf(),...or({tag:"span"}),...ii(),...Nu({variant:"tonal"})},"VChip"),s1=Mt()({name:"VChip",directives:{Ripple:Sd},props:Zee(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0,click:e=>!0},setup(e,t){let{attrs:n,emit:r,slots:i}=t;const{t:a}=Ou(),{borderClasses:l}=ku(e),{colorClasses:o,colorStyles:f,variantClasses:p}=mg(e),{densityClasses:y}=Es(e),{elevationClasses:x}=rs(e),{roundedClasses:w}=ko(e),{sizeClasses:S}=Uy(e),{themeClasses:L}=Ii(e),D=nr(e,"modelValue"),B=zy(e,mB,!1),z=o1(e,n),M=fe(()=>e.link!==!1&&z.isLink.value),k=fe(()=>!e.disabled&&e.link!==!1&&(!!B||e.link||z.isClickable.value)),V=fe(()=>({"aria-label":a(e.closeLabel),onClick(K){K.stopPropagation(),D.value=!1,r("click:close",K)}}));function q(K){var X;r("click",K),k.value&&((X=z.navigate)==null||X.call(z,K),B==null||B.toggle())}function Y(K){(K.key==="Enter"||K.key===" ")&&(K.preventDefault(),q(K))}return()=>{const K=z.isLink.value?"a":e.tag,X=!!(e.appendIcon||e.appendAvatar),U=!!(X||i.append),le=!!(i.close||e.closable),ue=!!(i.filter||e.filter)&&B,ae=!!(e.prependIcon||e.prependAvatar),ve=!!(ae||i.prepend),Ee=!B||B.isSelected.value;return D.value&&go(H(K,{class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":k.value,"v-chip--filter":ue,"v-chip--pill":e.pill},L.value,l.value,Ee?o.value:void 0,y.value,x.value,w.value,S.value,p.value,B==null?void 0:B.selectedClass.value,e.class],style:[Ee?f.value:void 0,e.style],disabled:e.disabled||void 0,draggable:e.draggable,href:z.href.value,tabindex:k.value?0:void 0,onClick:q,onKeydown:k.value&&!M.value&&Y},{default:()=>{var He;return[gg(k.value,"v-chip"),ue&&H(bP,{key:"filter"},{default:()=>[go(H("div",{class:"v-chip__filter"},[i.filter?H(Mi,{key:"filter-defaults",disabled:!e.filterIcon,defaults:{VIcon:{icon:e.filterIcon}}},i.filter):H(zi,{key:"filter-icon",icon:e.filterIcon},null)]),[[Ec,B.isSelected.value]])]}),ve&&H("div",{key:"prepend",class:"v-chip__prepend"},[i.prepend?H(Mi,{key:"prepend-defaults",disabled:!ae,defaults:{VAvatar:{image:e.prependAvatar,start:!0},VIcon:{icon:e.prependIcon,start:!0}}},i.prepend):H(Dn,null,[e.prependIcon&&H(zi,{key:"prepend-icon",icon:e.prependIcon,start:!0},null),e.prependAvatar&&H(yd,{key:"prepend-avatar",image:e.prependAvatar,start:!0},null)])]),H("div",{class:"v-chip__content"},[((He=i.default)==null?void 0:He.call(i,{isSelected:B==null?void 0:B.isSelected.value,selectedClass:B==null?void 0:B.selectedClass.value,select:B==null?void 0:B.select,toggle:B==null?void 0:B.toggle,value:B==null?void 0:B.value.value,disabled:e.disabled}))??e.text]),U&&H("div",{key:"append",class:"v-chip__append"},[i.append?H(Mi,{key:"append-defaults",disabled:!X,defaults:{VAvatar:{end:!0,image:e.appendAvatar},VIcon:{end:!0,icon:e.appendIcon}}},i.append):H(Dn,null,[e.appendIcon&&H(zi,{key:"append-icon",end:!0,icon:e.appendIcon},null),e.appendAvatar&&H(yd,{key:"append-avatar",end:!0,image:e.appendAvatar},null)])]),le&&H("div",tn({key:"close",class:"v-chip__close"},V.value),[i.close?H(Mi,{key:"close-defaults",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},i.close):H(zi,{key:"close-icon",icon:e.closeIcon,size:"x-small"},null)])]}}),[[Fl("ripple"),k.value&&e.ripple,null]])}}});const KI=Symbol.for("vuetify:list");function yB(){const e=Pi(KI,{hasPrepend:on(!1),updateHasPrepend:()=>null}),t={hasPrepend:on(!1),updateHasPrepend:n=>{n&&(t.hasPrepend.value=n)}};return da(KI,t),e}function vB(){return Pi(KI,null)}const Xee={open:e=>{let{id:t,value:n,opened:r,parents:i}=e;if(n){const a=new Set;a.add(t);let l=i.get(t);for(;l!=null;)a.add(l),l=i.get(l);return a}else return r.delete(t),r},select:()=>null},_B={open:e=>{let{id:t,value:n,opened:r,parents:i}=e;if(n){let a=i.get(t);for(r.add(t);a!=null&&a!==t;)r.add(a),a=i.get(a);return r}else r.delete(t);return r},select:()=>null},Wee={open:_B.open,select:e=>{let{id:t,value:n,opened:r,parents:i}=e;if(!n)return r;const a=[];let l=i.get(t);for(;l!=null;)a.push(l),l=i.get(l);return new Set(a)}},LP=e=>{const t={select:n=>{let{id:r,value:i,selected:a}=n;if(r=cr(r),e&&!i){const l=Array.from(a.entries()).reduce((o,f)=>{let[p,y]=f;return y==="on"?[...o,p]:o},[]);if(l.length===1&&l[0]===r)return a}return a.set(r,i?"on":"off"),a},in:(n,r,i)=>{let a=new Map;for(const l of n||[])a=t.select({id:l,value:!0,selected:new Map(a),children:r,parents:i});return a},out:n=>{const r=[];for(const[i,a]of n.entries())a==="on"&&r.push(i);return r}};return t},xB=e=>{const t=LP(e);return{select:r=>{let{selected:i,id:a,...l}=r;a=cr(a);const o=i.has(a)?new Map([[a,i.get(a)]]):new Map;return t.select({...l,id:a,selected:o})},in:(r,i,a)=>{let l=new Map;return r!=null&&r.length&&(l=t.in(r.slice(0,1),i,a)),l},out:(r,i,a)=>t.out(r,i,a)}},Hee=e=>{const t=LP(e);return{select:r=>{let{id:i,selected:a,children:l,...o}=r;return i=cr(i),l.has(i)?a:t.select({id:i,selected:a,children:l,...o})},in:t.in,out:t.out}},Yee=e=>{const t=xB(e);return{select:r=>{let{id:i,selected:a,children:l,...o}=r;return i=cr(i),l.has(i)?a:t.select({id:i,selected:a,children:l,...o})},in:t.in,out:t.out}},Kee=e=>{const t={select:n=>{let{id:r,value:i,selected:a,children:l,parents:o}=n;r=cr(r);const f=new Map(a),p=[r];for(;p.length;){const x=p.shift();a.set(x,i?"on":"off"),l.has(x)&&p.push(...l.get(x))}let y=o.get(r);for(;y;){const x=l.get(y),w=x.every(L=>a.get(L)==="on"),S=x.every(L=>!a.has(L)||a.get(L)==="off");a.set(y,w?"on":S?"off":"indeterminate"),y=o.get(y)}return e&&!i&&Array.from(a.entries()).reduce((w,S)=>{let[L,D]=S;return D==="on"?[...w,L]:w},[]).length===0?f:a},in:(n,r,i)=>{let a=new Map;for(const l of n||[])a=t.select({id:l,value:!0,selected:new Map(a),children:r,parents:i});return a},out:(n,r)=>{const i=[];for(const[a,l]of n.entries())l==="on"&&!r.has(a)&&i.push(a);return i}};return t},F0=Symbol.for("vuetify:nested"),bB={id:on(),root:{register:()=>null,unregister:()=>null,parents:Xt(new Map),children:Xt(new Map),open:()=>null,openOnSelect:()=>null,select:()=>null,opened:Xt(new Set),selected:Xt(new Map),selectedValues:Xt([])}},Jee=ht({selectStrategy:[String,Function],openStrategy:[String,Object],opened:Array,selected:Array,mandatory:Boolean},"nested"),Qee=e=>{let t=!1;const n=Xt(new Map),r=Xt(new Map),i=nr(e,"opened",e.opened,x=>new Set(x),x=>[...x.values()]),a=fe(()=>{if(typeof e.selectStrategy=="object")return e.selectStrategy;switch(e.selectStrategy){case"single-leaf":return Yee(e.mandatory);case"leaf":return Hee(e.mandatory);case"independent":return LP(e.mandatory);case"single-independent":return xB(e.mandatory);case"classic":default:return Kee(e.mandatory)}}),l=fe(()=>{if(typeof e.openStrategy=="object")return e.openStrategy;switch(e.openStrategy){case"list":return Wee;case"single":return Xee;case"multiple":default:return _B}}),o=nr(e,"selected",e.selected,x=>a.value.in(x,n.value,r.value),x=>a.value.out(x,n.value,r.value));Us(()=>{t=!0});function f(x){const w=[];let S=x;for(;S!=null;)w.unshift(S),S=r.value.get(S);return w}const p=qa("nested"),y={id:on(),root:{opened:i,selected:o,selectedValues:fe(()=>{const x=[];for(const[w,S]of o.value.entries())S==="on"&&x.push(w);return x}),register:(x,w,S)=>{w&&x!==w&&r.value.set(x,w),S&&n.value.set(x,[]),w!=null&&n.value.set(w,[...n.value.get(w)||[],x])},unregister:x=>{if(t)return;n.value.delete(x);const w=r.value.get(x);if(w){const S=n.value.get(w)??[];n.value.set(w,S.filter(L=>L!==x))}r.value.delete(x),i.value.delete(x)},open:(x,w,S)=>{p.emit("click:open",{id:x,value:w,path:f(x),event:S});const L=l.value.open({id:x,value:w,opened:new Set(i.value),children:n.value,parents:r.value,event:S});L&&(i.value=L)},openOnSelect:(x,w,S)=>{const L=l.value.select({id:x,value:w,selected:new Map(o.value),opened:new Set(i.value),children:n.value,parents:r.value,event:S});L&&(i.value=L)},select:(x,w,S)=>{p.emit("click:select",{id:x,value:w,path:f(x),event:S});const L=a.value.select({id:x,value:w,selected:new Map(o.value),children:n.value,parents:r.value,event:S});L&&(o.value=L),y.root.openOnSelect(x,w,S)},children:n,parents:r}};return da(F0,y),y.root},wB=(e,t)=>{const n=Pi(F0,bB),r=Symbol(ws()),i=fe(()=>e.value!==void 0?e.value:r),a={...n,id:i,open:(l,o)=>n.root.open(i.value,l,o),openOnSelect:(l,o)=>n.root.openOnSelect(i.value,l,o),isOpen:fe(()=>n.root.opened.value.has(i.value)),parent:fe(()=>n.root.parents.value.get(i.value)),select:(l,o)=>n.root.select(i.value,l,o),isSelected:fe(()=>n.root.selected.value.get(cr(i.value))==="on"),isIndeterminate:fe(()=>n.root.selected.value.get(i.value)==="indeterminate"),isLeaf:fe(()=>!n.root.children.value.get(i.value)),isGroupActivator:n.isGroupActivator};return!n.isGroupActivator&&n.root.register(i.value,n.id.value,t),Us(()=>{!n.isGroupActivator&&n.root.unregister(i.value)}),t&&da(F0,a),a},ete=()=>{const e=Pi(F0,bB);da(F0,{...e,isGroupActivator:!0})},tte=Lu({name:"VListGroupActivator",setup(e,t){let{slots:n}=t;return ete(),()=>{var r;return(r=n.default)==null?void 0:r.call(n)}}}),nte=ht({activeColor:String,baseColor:String,color:String,collapseIcon:{type:Jn,default:"$collapse"},expandIcon:{type:Jn,default:"$expand"},prependIcon:Jn,appendIcon:Jn,fluid:Boolean,subgroup:Boolean,title:String,value:null,...ln(),...or()},"VListGroup"),JI=Mt()({name:"VListGroup",props:nte(),setup(e,t){let{slots:n}=t;const{isOpen:r,open:i,id:a}=wB(kt(e,"value"),!0),l=fe(()=>`v-list-group--id-${String(a.value)}`),o=vB(),{isBooted:f}=pg();function p(S){i(!r.value,S)}const y=fe(()=>({onClick:p,class:"v-list-group__header",id:l.value})),x=fe(()=>r.value?e.collapseIcon:e.expandIcon),w=fe(()=>({VListItem:{active:r.value,activeColor:e.activeColor,baseColor:e.baseColor,color:e.color,prependIcon:e.prependIcon||e.subgroup&&x.value,appendIcon:e.appendIcon||!e.subgroup&&x.value,title:e.title,value:e.value}}));return Bt(()=>H(e.tag,{class:["v-list-group",{"v-list-group--prepend":o==null?void 0:o.hasPrepend.value,"v-list-group--fluid":e.fluid,"v-list-group--subgroup":e.subgroup,"v-list-group--open":r.value},e.class],style:e.style},{default:()=>[n.activator&&H(Mi,{defaults:w.value},{default:()=>[H(tte,null,{default:()=>[n.activator({props:y.value,isOpen:r.value})]})]}),H(uc,{transition:{component:tE},disabled:!f.value},{default:()=>{var S;return[go(H("div",{class:"v-list-group__items",role:"group","aria-labelledby":l.value},[(S=n.default)==null?void 0:S.call(n)]),[[Ec,r.value]])]}})]})),{}}});const EB=Tc("v-list-item-subtitle"),SB=Tc("v-list-item-title"),rte=ht({active:{type:Boolean,default:void 0},activeClass:String,activeColor:String,appendAvatar:String,appendIcon:Jn,baseColor:String,disabled:Boolean,lines:String,link:{type:Boolean,default:void 0},nav:Boolean,prependAvatar:String,prependIcon:Jn,ripple:{type:[Boolean,Object],default:!0},subtitle:[String,Number,Boolean],title:[String,Number,Boolean],value:null,onClick:Jc(),onClickOnce:Jc(),...Vl(),...ln(),...Ta(),...Du(),...Sa(),...lo(),...a1(),...or(),...ii(),...Nu({variant:"text"})},"VListItem"),tf=Mt()({name:"VListItem",directives:{Ripple:Sd},props:rte(),emits:{click:e=>!0},setup(e,t){let{attrs:n,slots:r,emit:i}=t;const a=o1(e,n),l=fe(()=>e.value===void 0?a.href.value:e.value),{select:o,isSelected:f,isIndeterminate:p,isGroupActivator:y,root:x,parent:w,openOnSelect:S}=wB(l,!1),L=vB(),D=fe(()=>{var Pe;return e.active!==!1&&(e.active||((Pe=a.isActive)==null?void 0:Pe.value)||f.value)}),B=fe(()=>e.link!==!1&&a.isLink.value),z=fe(()=>!e.disabled&&e.link!==!1&&(e.link||a.isClickable.value||e.value!=null&&!!L)),M=fe(()=>e.rounded||e.nav),k=fe(()=>e.color??e.activeColor),V=fe(()=>({color:D.value?k.value??e.baseColor:e.baseColor,variant:e.variant}));cn(()=>{var Pe;return(Pe=a.isActive)==null?void 0:Pe.value},Pe=>{Pe&&w.value!=null&&x.open(w.value,!0),Pe&&S(Pe)},{immediate:!0});const{themeClasses:q}=Ii(e),{borderClasses:Y}=ku(e),{colorClasses:K,colorStyles:X,variantClasses:U}=mg(V),{densityClasses:le}=Es(e),{dimensionStyles:ue}=Ru(e),{elevationClasses:ae}=rs(e),{roundedClasses:ve}=ko(M),Ee=fe(()=>e.lines?`v-list-item--${e.lines}-line`:void 0),He=fe(()=>({isActive:D.value,select:o,isSelected:f.value,isIndeterminate:p.value}));function Oe(Pe){var Ke;i("click",Pe),!(y||!z.value)&&((Ke=a.navigate)==null||Ke.call(a,Pe),e.value!=null&&o(!f.value,Pe))}function Ve(Pe){(Pe.key==="Enter"||Pe.key===" ")&&(Pe.preventDefault(),Oe(Pe))}return Bt(()=>{const Pe=B.value?"a":e.tag,Ke=r.title||e.title,Be=r.subtitle||e.subtitle,Ue=!!(e.appendAvatar||e.appendIcon),lt=!!(Ue||r.append),xt=!!(e.prependAvatar||e.prependIcon),Nt=!!(xt||r.prepend);return L==null||L.updateHasPrepend(Nt),e.activeColor&&OJ("active-color",["color","base-color"]),go(H(Pe,{class:["v-list-item",{"v-list-item--active":D.value,"v-list-item--disabled":e.disabled,"v-list-item--link":z.value,"v-list-item--nav":e.nav,"v-list-item--prepend":!Nt&&(L==null?void 0:L.hasPrepend.value),[`${e.activeClass}`]:e.activeClass&&D.value},q.value,Y.value,K.value,le.value,ae.value,Ee.value,ve.value,U.value,e.class],style:[X.value,ue.value,e.style],href:a.href.value,tabindex:z.value?L?-2:0:void 0,onClick:Oe,onKeydown:z.value&&!B.value&&Ve},{default:()=>{var Wt;return[gg(z.value||D.value,"v-list-item"),Nt&&H("div",{key:"prepend",class:"v-list-item__prepend"},[r.prepend?H(Mi,{key:"prepend-defaults",disabled:!xt,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon},VListItemAction:{start:!0}}},{default:()=>{var Je;return[(Je=r.prepend)==null?void 0:Je.call(r,He.value)]}}):H(Dn,null,[e.prependAvatar&&H(yd,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&H(zi,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)]),H("div",{class:"v-list-item__spacer"},null)]),H("div",{class:"v-list-item__content","data-no-activator":""},[Ke&&H(SB,{key:"title"},{default:()=>{var Je;return[((Je=r.title)==null?void 0:Je.call(r,{title:e.title}))??e.title]}}),Be&&H(EB,{key:"subtitle"},{default:()=>{var Je;return[((Je=r.subtitle)==null?void 0:Je.call(r,{subtitle:e.subtitle}))??e.subtitle]}}),(Wt=r.default)==null?void 0:Wt.call(r,He.value)]),lt&&H("div",{key:"append",class:"v-list-item__append"},[r.append?H(Mi,{key:"append-defaults",disabled:!Ue,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon},VListItemAction:{end:!0}}},{default:()=>{var Je;return[(Je=r.append)==null?void 0:Je.call(r,He.value)]}}):H(Dn,null,[e.appendIcon&&H(zi,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&H(yd,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)]),H("div",{class:"v-list-item__spacer"},null)])]}}),[[Fl("ripple"),z.value&&e.ripple]])}),{}}}),ite=ht({color:String,inset:Boolean,sticky:Boolean,title:String,...ln(),...or()},"VListSubheader"),TB=Mt()({name:"VListSubheader",props:ite(),setup(e,t){let{slots:n}=t;const{textColorClasses:r,textColorStyles:i}=xs(kt(e,"color"));return Bt(()=>{const a=!!(n.default||e.title);return H(e.tag,{class:["v-list-subheader",{"v-list-subheader--inset":e.inset,"v-list-subheader--sticky":e.sticky},r.value,e.class],style:[{textColorStyles:i},e.style]},{default:()=>{var l;return[a&&H("div",{class:"v-list-subheader__text"},[((l=n.default)==null?void 0:l.call(n))??e.title])]}})}),{}}});const ote=ht({color:String,inset:Boolean,length:[Number,String],thickness:[Number,String],vertical:Boolean,...ln(),...ii()},"VDivider"),IB=Mt()({name:"VDivider",props:ote(),setup(e,t){let{attrs:n}=t;const{themeClasses:r}=Ii(e),{textColorClasses:i,textColorStyles:a}=xs(kt(e,"color")),l=fe(()=>{const o={};return e.length&&(o[e.vertical?"maxHeight":"maxWidth"]=dn(e.length)),e.thickness&&(o[e.vertical?"borderRightWidth":"borderTopWidth"]=dn(e.thickness)),o});return Bt(()=>H("hr",{class:[{"v-divider":!0,"v-divider--inset":e.inset,"v-divider--vertical":e.vertical},r.value,i.value,e.class],style:[l.value,a.value,e.style],"aria-orientation":!n.role||n.role==="separator"?e.vertical?"vertical":"horizontal":void 0,role:`${n.role||"separator"}`},null)),{}}}),ate=ht({items:Array},"VListChildren"),CB=Mt()({name:"VListChildren",props:ate(),setup(e,t){let{slots:n}=t;return yB(),()=>{var r,i;return((r=n.default)==null?void 0:r.call(n))??((i=e.items)==null?void 0:i.map(a=>{var S,L;let{children:l,props:o,type:f,raw:p}=a;if(f==="divider")return((S=n.divider)==null?void 0:S.call(n,{props:o}))??H(IB,o,null);if(f==="subheader")return((L=n.subheader)==null?void 0:L.call(n,{props:o}))??H(TB,o,null);const y={subtitle:n.subtitle?D=>{var B;return(B=n.subtitle)==null?void 0:B.call(n,{...D,item:p})}:void 0,prepend:n.prepend?D=>{var B;return(B=n.prepend)==null?void 0:B.call(n,{...D,item:p})}:void 0,append:n.append?D=>{var B;return(B=n.append)==null?void 0:B.call(n,{...D,item:p})}:void 0,title:n.title?D=>{var B;return(B=n.title)==null?void 0:B.call(n,{...D,item:p})}:void 0},[x,w]=JI.filterProps(o);return l?H(JI,tn({value:o==null?void 0:o.value},x),{activator:D=>{let{props:B}=D;return n.header?n.header({props:{...o,...B}}):H(tf,tn(o,B),y)},default:()=>H(CB,{items:l},n)}):n.item?n.item({props:o}):H(tf,o,y)}))}}}),PB=ht({items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemChildren:{type:[Boolean,String,Array,Function],default:"children"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},returnObject:Boolean,valueComparator:{type:Function,default:Ry}},"list-items");function Pp(e,t){const n=Wc(t,e.itemTitle,t),r=Wc(t,e.itemValue,n),i=Wc(t,e.itemChildren),a=e.itemProps===!0?typeof t=="object"&&t!=null&&!Array.isArray(t)?"children"in t?ng(t,["children"])[1]:t:void 0:Wc(t,e.itemProps),l={title:n,value:r,...a};return{title:String(l.title??""),value:l.value,props:l,children:Array.isArray(i)?AB(e,i):void 0,raw:t}}function AB(e,t){const n=[];for(const r of t)n.push(Pp(e,r));return n}function OP(e){const t=fe(()=>AB(e,e.items)),n=fe(()=>t.value.some(a=>a.value===null));function r(a){return n.value||(a=a.filter(l=>l!==null)),a.map(l=>e.returnObject&&typeof l=="string"?Pp(e,l):t.value.find(o=>e.valueComparator(l,o.value))||Pp(e,l))}function i(a){return e.returnObject?a.map(l=>{let{raw:o}=l;return o}):a.map(l=>{let{value:o}=l;return o})}return{items:t,transformIn:r,transformOut:i}}function ste(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function lte(e,t){const n=Wc(t,e.itemType,"item"),r=ste(t)?t:Wc(t,e.itemTitle),i=Wc(t,e.itemValue,void 0),a=Wc(t,e.itemChildren),l=e.itemProps===!0?ng(t,["children"])[1]:Wc(t,e.itemProps),o={title:r,value:i,...l};return{type:n,title:o.title,value:o.value,props:o,children:n==="item"&&a?MB(e,a):void 0,raw:t}}function MB(e,t){const n=[];for(const r of t)n.push(lte(e,r));return n}function ute(e){return{items:fe(()=>MB(e,e.items))}}const cte=ht({baseColor:String,activeColor:String,activeClass:String,bgColor:String,disabled:Boolean,lines:{type:[Boolean,String],default:"one"},nav:Boolean,...Jee({selectStrategy:"single-leaf",openStrategy:"list"}),...Vl(),...ln(),...Ta(),...Du(),...Sa(),itemType:{type:String,default:"type"},...PB(),...lo(),...or(),...ii(),...Nu({variant:"text"})},"VList"),aE=Mt()({name:"VList",props:cte(),emits:{"update:selected":e=>!0,"update:opened":e=>!0,"click:open":e=>!0,"click:select":e=>!0},setup(e,t){let{slots:n}=t;const{items:r}=ute(e),{themeClasses:i}=Ii(e),{backgroundColorClasses:a,backgroundColorStyles:l}=zo(kt(e,"bgColor")),{borderClasses:o}=ku(e),{densityClasses:f}=Es(e),{dimensionStyles:p}=Ru(e),{elevationClasses:y}=rs(e),{roundedClasses:x}=ko(e),{open:w,select:S}=Qee(e),L=fe(()=>e.lines?`v-list--${e.lines}-line`:void 0),D=kt(e,"activeColor"),B=kt(e,"baseColor"),z=kt(e,"color");yB(),fa({VListGroup:{activeColor:D,baseColor:B,color:z},VListItem:{activeClass:kt(e,"activeClass"),activeColor:D,baseColor:B,color:z,density:kt(e,"density"),disabled:kt(e,"disabled"),lines:kt(e,"lines"),nav:kt(e,"nav"),variant:kt(e,"variant")}});const M=on(!1),k=Xt();function V(U){M.value=!0}function q(U){M.value=!1}function Y(U){var le;!M.value&&!(U.relatedTarget&&((le=k.value)!=null&&le.contains(U.relatedTarget)))&&X()}function K(U){if(k.value){if(U.key==="ArrowDown")X("next");else if(U.key==="ArrowUp")X("prev");else if(U.key==="Home")X("first");else if(U.key==="End")X("last");else return;U.preventDefault()}}function X(U){if(k.value)return ew(k.value,U)}return Bt(()=>H(e.tag,{ref:k,class:["v-list",{"v-list--disabled":e.disabled,"v-list--nav":e.nav},i.value,a.value,o.value,f.value,y.value,L.value,x.value,e.class],style:[l.value,p.value,e.style],tabindex:e.disabled||M.value?-1:0,role:"listbox","aria-activedescendant":void 0,onFocusin:V,onFocusout:q,onFocus:Y,onKeydown:K},{default:()=>[H(CB,{items:r.value},n)]})),{open:w,select:S,focus:X}}}),hte=Tc("v-list-img"),fte=ht({start:Boolean,end:Boolean,...ln(),...or()},"VListItemAction"),dte=Mt()({name:"VListItemAction",props:fte(),setup(e,t){let{slots:n}=t;return Bt(()=>H(e.tag,{class:["v-list-item-action",{"v-list-item-action--start":e.start,"v-list-item-action--end":e.end},e.class],style:e.style},n)),{}}}),pte=ht({start:Boolean,end:Boolean,...ln(),...or()},"VListItemMedia"),gte=Mt()({name:"VListItemMedia",props:pte(),setup(e,t){let{slots:n}=t;return Bt(()=>H(e.tag,{class:["v-list-item-media",{"v-list-item-media--start":e.start,"v-list-item-media--end":e.end},e.class],style:e.style},n)),{}}});function NT(e,t){return{x:e.x+t.x,y:e.y+t.y}}function mte(e,t){return{x:e.x-t.x,y:e.y-t.y}}function aR(e,t){if(e.side==="top"||e.side==="bottom"){const{side:n,align:r}=e,i=r==="left"?0:r==="center"?t.width/2:r==="right"?t.width:r,a=n==="top"?0:n==="bottom"?t.height:n;return NT({x:i,y:a},t)}else if(e.side==="left"||e.side==="right"){const{side:n,align:r}=e,i=n==="left"?0:n==="right"?t.width:n,a=r==="top"?0:r==="center"?t.height/2:r==="bottom"?t.height:r;return NT({x:i,y:a},t)}return NT({x:t.width/2,y:t.height/2},t)}const LB={static:_te,connected:bte},yte=ht({locationStrategy:{type:[String,Function],default:"static",validator:e=>typeof e=="function"||e in LB},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay-location-strategies");function vte(e,t){const n=Xt({}),r=Xt();Yi&&(md(()=>!!(t.isActive.value&&e.locationStrategy),a=>{var l,o;cn(()=>e.locationStrategy,a),il(()=>{r.value=void 0}),typeof e.locationStrategy=="function"?r.value=(l=e.locationStrategy(t,e,n))==null?void 0:l.updateLocation:r.value=(o=LB[e.locationStrategy](t,e,n))==null?void 0:o.updateLocation}),window.addEventListener("resize",i,{passive:!0}),il(()=>{window.removeEventListener("resize",i),r.value=void 0}));function i(a){var l;(l=r.value)==null||l.call(r,a)}return{contentStyles:n,updateLocation:r}}function _te(){}function xte(e,t){t?e.style.removeProperty("left"):e.style.removeProperty("right");const n=cP(e);return t?n.x+=parseFloat(e.style.right||0):n.x-=parseFloat(e.style.left||0),n.y-=parseFloat(e.style.top||0),n}function bte(e,t,n){HJ(e.activatorEl.value)&&Object.assign(n.value,{position:"fixed",top:0,[e.isRtl.value?"right":"left"]:0});const{preferredAnchor:i,preferredOrigin:a}=lP(()=>{const L=FI(t.location,e.isRtl.value),D=t.origin==="overlap"?L:t.origin==="auto"?OT(L):FI(t.origin,e.isRtl.value);return L.side===D.side&&L.align===DT(D).align?{preferredAnchor:M3(L),preferredOrigin:M3(D)}:{preferredAnchor:L,preferredOrigin:D}}),[l,o,f,p]=["minWidth","minHeight","maxWidth","maxHeight"].map(L=>fe(()=>{const D=parseFloat(t[L]);return isNaN(D)?1/0:D})),y=fe(()=>{if(Array.isArray(t.offset))return t.offset;if(typeof t.offset=="string"){const L=t.offset.split(" ").map(parseFloat);return L.length<2&&L.push(0),L}return typeof t.offset=="number"?[t.offset,0]:[0,0]});let x=!1;const w=new ResizeObserver(()=>{x&&S()});cn([e.activatorEl,e.contentEl],(L,D)=>{let[B,z]=L,[M,k]=D;M&&w.unobserve(M),B&&w.observe(B),k&&w.unobserve(k),z&&w.observe(z)},{immediate:!0}),il(()=>{w.disconnect()});function S(){if(x=!1,requestAnimationFrame(()=>{requestAnimationFrame(()=>x=!0)}),!e.activatorEl.value||!e.contentEl.value)return;const L=e.activatorEl.value.getBoundingClientRect(),D=xte(e.contentEl.value,e.isRtl.value),B=nw(e.contentEl.value),z=12;B.length||(B.push(document.documentElement),e.contentEl.value.style.top&&e.contentEl.value.style.left||(D.x-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),D.y-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const M=B.reduce((ue,ae)=>{const ve=ae.getBoundingClientRect(),Ee=new jm({x:ae===document.documentElement?0:ve.x,y:ae===document.documentElement?0:ve.y,width:ae.clientWidth,height:ae.clientHeight});return ue?new jm({x:Math.max(ue.left,Ee.left),y:Math.max(ue.top,Ee.top),width:Math.min(ue.right,Ee.right)-Math.max(ue.left,Ee.left),height:Math.min(ue.bottom,Ee.bottom)-Math.max(ue.top,Ee.top)}):Ee},void 0);M.x+=z,M.y+=z,M.width-=z*2,M.height-=z*2;let k={anchor:i.value,origin:a.value};function V(ue){const ae=new jm(D),ve=aR(ue.anchor,L),Ee=aR(ue.origin,ae);let{x:He,y:Oe}=mte(ve,Ee);switch(ue.anchor.side){case"top":Oe-=y.value[0];break;case"bottom":Oe+=y.value[0];break;case"left":He-=y.value[0];break;case"right":He+=y.value[0];break}switch(ue.anchor.align){case"top":Oe-=y.value[1];break;case"bottom":Oe+=y.value[1];break;case"left":He-=y.value[1];break;case"right":He+=y.value[1];break}return ae.x+=He,ae.y+=Oe,ae.width=Math.min(ae.width,f.value),ae.height=Math.min(ae.height,p.value),{overflows:O3(ae,M),x:He,y:Oe}}let q=0,Y=0;const K={x:0,y:0},X={x:!1,y:!1};let U=-1;for(;!(U++>10);){const{x:ue,y:ae,overflows:ve}=V(k);q+=ue,Y+=ae,D.x+=ue,D.y+=ae;{const Ee=L3(k.anchor),He=ve.x.before||ve.x.after,Oe=ve.y.before||ve.y.after;let Ve=!1;if(["x","y"].forEach(Pe=>{if(Pe==="x"&&He&&!X.x||Pe==="y"&&Oe&&!X.y){const Ke={anchor:{...k.anchor},origin:{...k.origin}},Be=Pe==="x"?Ee==="y"?DT:OT:Ee==="y"?OT:DT;Ke.anchor=Be(Ke.anchor),Ke.origin=Be(Ke.origin);const{overflows:Ue}=V(Ke);(Ue[Pe].before<=ve[Pe].before&&Ue[Pe].after<=ve[Pe].after||Ue[Pe].before+Ue[Pe].after<(ve[Pe].before+ve[Pe].after)/2)&&(k=Ke,Ve=X[Pe]=!0)}}),Ve)continue}ve.x.before&&(q+=ve.x.before,D.x+=ve.x.before),ve.x.after&&(q-=ve.x.after,D.x-=ve.x.after),ve.y.before&&(Y+=ve.y.before,D.y+=ve.y.before),ve.y.after&&(Y-=ve.y.after,D.y-=ve.y.after);{const Ee=O3(D,M);K.x=M.width-Ee.x.before-Ee.x.after,K.y=M.height-Ee.y.before-Ee.y.after,q+=Ee.x.before,D.x+=Ee.x.before,Y+=Ee.y.before,D.y+=Ee.y.before}break}const le=L3(k.anchor);return Object.assign(n.value,{"--v-overlay-anchor-origin":`${k.anchor.side} ${k.anchor.align}`,transformOrigin:`${k.origin.side} ${k.origin.align}`,top:dn(FT(Y)),left:e.isRtl.value?void 0:dn(FT(q)),right:e.isRtl.value?dn(FT(-q)):void 0,minWidth:dn(le==="y"?Math.min(l.value,L.width):l.value),maxWidth:dn(sR(ps(K.x,l.value===1/0?0:l.value,f.value))),maxHeight:dn(sR(ps(K.y,o.value===1/0?0:o.value,p.value)))}),{available:K,contentBox:D}}return cn(()=>[i.value,a.value,t.offset,t.minWidth,t.minHeight,t.maxWidth,t.maxHeight],()=>S()),qi(()=>{const L=S();if(!L)return;const{available:D,contentBox:B}=L;B.height>D.y&&requestAnimationFrame(()=>{S(),requestAnimationFrame(()=>{S()})})}),{updateLocation:S}}function FT(e){return Math.round(e*devicePixelRatio)/devicePixelRatio}function sR(e){return Math.ceil(e*devicePixelRatio)/devicePixelRatio}let QI=!0;const ow=[];function wte(e){!QI||ow.length?(ow.push(e),eC()):(QI=!1,e(),eC())}let lR=-1;function eC(){cancelAnimationFrame(lR),lR=requestAnimationFrame(()=>{const e=ow.shift();e&&e(),ow.length?eC():QI=!0})}const xb={none:null,close:Tte,block:Ite,reposition:Cte},Ete=ht({scrollStrategy:{type:[String,Function],default:"block",validator:e=>typeof e=="function"||e in xb}},"VOverlay-scroll-strategies");function Ste(e,t){if(!Yi)return;let n;Nl(async()=>{n==null||n.stop(),t.isActive.value&&e.scrollStrategy&&(n=yC(),await qi(),n.active&&n.run(()=>{var r;typeof e.scrollStrategy=="function"?e.scrollStrategy(t,e,n):(r=xb[e.scrollStrategy])==null||r.call(xb,t,e,n)}))}),il(()=>{n==null||n.stop()})}function Tte(e){function t(n){e.isActive.value=!1}OB(e.activatorEl.value??e.contentEl.value,t)}function Ite(e,t){var l;const n=(l=e.root.value)==null?void 0:l.offsetParent,r=[...new Set([...nw(e.activatorEl.value,t.contained?n:void 0),...nw(e.contentEl.value,t.contained?n:void 0)])].filter(o=>!o.classList.contains("v-overlay-scroll-blocked")),i=window.innerWidth-document.documentElement.offsetWidth,a=(o=>pP(o)&&o)(n||document.documentElement);a&&e.root.value.classList.add("v-overlay--scroll-blocked"),r.forEach((o,f)=>{o.style.setProperty("--v-body-scroll-x",dn(-o.scrollLeft)),o.style.setProperty("--v-body-scroll-y",dn(-o.scrollTop)),o!==document.documentElement&&o.style.setProperty("--v-scrollbar-offset",dn(i)),o.classList.add("v-overlay-scroll-blocked")}),il(()=>{r.forEach((o,f)=>{const p=parseFloat(o.style.getPropertyValue("--v-body-scroll-x")),y=parseFloat(o.style.getPropertyValue("--v-body-scroll-y"));o.style.removeProperty("--v-body-scroll-x"),o.style.removeProperty("--v-body-scroll-y"),o.style.removeProperty("--v-scrollbar-offset"),o.classList.remove("v-overlay-scroll-blocked"),o.scrollLeft=-p,o.scrollTop=-y}),a&&e.root.value.classList.remove("v-overlay--scroll-blocked")})}function Cte(e,t,n){let r=!1,i=-1,a=-1;function l(o){wte(()=>{var y,x;const f=performance.now();(x=(y=e.updateLocation).value)==null||x.call(y,o),r=(performance.now()-f)/(1e3/60)>2})}a=(typeof requestIdleCallback>"u"?o=>o():requestIdleCallback)(()=>{n.run(()=>{OB(e.activatorEl.value??e.contentEl.value,o=>{r?(cancelAnimationFrame(i),i=requestAnimationFrame(()=>{i=requestAnimationFrame(()=>{l(o)})})):l(o)})})}),il(()=>{typeof cancelIdleCallback<"u"&&cancelIdleCallback(a),cancelAnimationFrame(i)})}function OB(e,t){const n=[document,...nw(e)];n.forEach(r=>{r.addEventListener("scroll",t,{passive:!0})}),il(()=>{n.forEach(r=>{r.removeEventListener("scroll",t)})})}const tC=Symbol.for("vuetify:v-menu"),DB=ht({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function RB(e,t){const n={},r=i=>()=>{if(!Yi)return Promise.resolve(!0);const a=i==="openDelay";return n.closeDelay&&window.clearTimeout(n.closeDelay),delete n.closeDelay,n.openDelay&&window.clearTimeout(n.openDelay),delete n.openDelay,new Promise(l=>{const o=parseInt(e[i]??0,10);n[i]=window.setTimeout(()=>{t==null||t(a),l(a)},o)})};return{runCloseDelay:r("closeDelay"),runOpenDelay:r("openDelay")}}const Pte=ht({activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...DB()},"VOverlay-activator");function Ate(e,t){let{isActive:n,isTop:r}=t;const i=Xt();let a=!1,l=!1,o=!0;const f=fe(()=>e.openOnFocus||e.openOnFocus==null&&e.openOnHover),p=fe(()=>e.openOnClick||e.openOnClick==null&&!e.openOnHover&&!f.value),{runOpenDelay:y,runCloseDelay:x}=RB(e,k=>{k===(e.openOnHover&&a||f.value&&l)&&!(e.openOnHover&&n.value&&!r.value)&&(n.value!==k&&(o=!0),n.value=k)}),w={onClick:k=>{k.stopPropagation(),i.value=k.currentTarget||k.target,n.value=!n.value},onMouseenter:k=>{var V;(V=k.sourceCapabilities)!=null&&V.firesTouchEvents||(a=!0,i.value=k.currentTarget||k.target,y())},onMouseleave:k=>{a=!1,x()},onFocus:k=>{_y(k.target,":focus-visible")!==!1&&(l=!0,k.stopPropagation(),i.value=k.currentTarget||k.target,y())},onBlur:k=>{l=!1,k.stopPropagation(),x()}},S=fe(()=>{const k={};return p.value&&(k.onClick=w.onClick),e.openOnHover&&(k.onMouseenter=w.onMouseenter,k.onMouseleave=w.onMouseleave),f.value&&(k.onFocus=w.onFocus,k.onBlur=w.onBlur),k}),L=fe(()=>{const k={};if(e.openOnHover&&(k.onMouseenter=()=>{a=!0,y()},k.onMouseleave=()=>{a=!1,x()}),f.value&&(k.onFocusin=()=>{l=!0,y()},k.onFocusout=()=>{l=!1,x()}),e.closeOnContentClick){const V=Pi(tC,null);k.onClick=()=>{n.value=!1,V==null||V.closeParents()}}return k}),D=fe(()=>{const k={};return e.openOnHover&&(k.onMouseenter=()=>{o&&(a=!0,o=!1,y())},k.onMouseleave=()=>{a=!1,x()}),k});cn(r,k=>{k&&(e.openOnHover&&!a&&(!f.value||!l)||f.value&&!l&&(!e.openOnHover||!a))&&(n.value=!1)});const B=Xt();Nl(()=>{B.value&&qi(()=>{i.value=kI(B.value)})});const z=qa("useActivator");let M;return cn(()=>!!e.activator,k=>{k&&Yi?(M=yC(),M.run(()=>{Mte(e,z,{activatorEl:i,activatorEvents:S})})):M&&M.stop()},{flush:"post",immediate:!0}),il(()=>{M==null||M.stop()}),{activatorEl:i,activatorRef:B,activatorEvents:S,contentEvents:L,scrimEvents:D}}function Mte(e,t,n){let{activatorEl:r,activatorEvents:i}=n;cn(()=>e.activator,(f,p)=>{if(p&&f!==p){const y=o(p);y&&l(y)}f&&qi(()=>a())},{immediate:!0}),cn(()=>e.activatorProps,()=>{a()}),il(()=>{l()});function a(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:o(),p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;f&&EJ(f,tn(i.value,p))}function l(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:o(),p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;f&&SJ(f,tn(i.value,p))}function o(){var y,x;let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.activator,p;if(f)if(f==="parent"){let w=(x=(y=t==null?void 0:t.proxy)==null?void 0:y.$el)==null?void 0:x.parentNode;for(;w!=null&&w.hasAttribute("data-no-activator");)w=w.parentNode;p=w}else typeof f=="string"?p=document.querySelector(f):"$el"in f?p=f.$el:p=f;return r.value=(p==null?void 0:p.nodeType)===Node.ELEMENT_NODE?p:null,r.value}}function kB(){if(!Yi)return on(!1);const{ssr:e}=dg();if(e){const t=on(!1);return bs(()=>{t.value=!0}),t}else return on(!0)}const sE=ht({eager:Boolean},"lazy");function DP(e,t){const n=on(!1),r=fe(()=>n.value||e.eager||t.value);cn(t,()=>n.value=!0);function i(){e.eager||(n.value=!1)}return{isBooted:n,hasContent:r,onAfterLeave:i}}function jy(){const t=qa("useScopeId").vnode.scopeId;return{scopeId:t?{[t]:""}:void 0}}const uR=Symbol.for("vuetify:stack"),D_=Qs([]);function Lte(e,t,n){const r=qa("useStack"),i=!n,a=Pi(uR,void 0),l=Qs({activeChildren:new Set});da(uR,l);const o=on(+t.value);md(e,()=>{var x;const y=(x=D_.at(-1))==null?void 0:x[1];o.value=y?y+10:+t.value,i&&D_.push([r.uid,o.value]),a==null||a.activeChildren.add(r.uid),il(()=>{if(i){const w=cr(D_).findIndex(S=>S[0]===r.uid);D_.splice(w,1)}a==null||a.activeChildren.delete(r.uid)})});const f=on(!0);i&&Nl(()=>{var x;const y=((x=D_.at(-1))==null?void 0:x[0])===r.uid;setTimeout(()=>f.value=y)});const p=fe(()=>!l.activeChildren.size);return{globalTop:z0(f),localTop:p,stackStyles:fe(()=>({zIndex:o.value}))}}function Ote(e){return{teleportTarget:fe(()=>{const n=e.value;if(n===!0||!Yi)return;const r=n===!1?document.body:typeof n=="string"?document.querySelector(n):n;if(r==null)return;let i=r.querySelector(":scope > .v-overlay-container");return i||(i=document.createElement("div"),i.className="v-overlay-container",r.appendChild(i)),i})}}function Dte(){return!0}function NB(e,t,n){if(!e||FB(e,n)===!1)return!1;const r=LF(t);if(typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&r.host===e.target)return!1;const i=(typeof n.value=="object"&&n.value.include||(()=>[]))();return i.push(t),!i.some(a=>a==null?void 0:a.contains(e.target))}function FB(e,t){return(typeof t.value=="object"&&t.value.closeConditional||Dte)(e)}function Rte(e,t,n){const r=typeof n.value=="function"?n.value:n.value.handler;t._clickOutside.lastMousedownWasOutside&&NB(e,t,n)&&setTimeout(()=>{FB(e,n)&&r&&r(e)},0)}function cR(e,t){const n=LF(e);t(document),typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&t(n)}const BB={mounted(e,t){const n=i=>Rte(i,e,t),r=i=>{e._clickOutside.lastMousedownWasOutside=NB(i,e,t)};cR(e,i=>{i.addEventListener("click",n,!0),i.addEventListener("mousedown",r,!0)}),e._clickOutside||(e._clickOutside={lastMousedownWasOutside:!1}),e._clickOutside[t.instance.$.uid]={onClick:n,onMousedown:r}},unmounted(e,t){e._clickOutside&&(cR(e,n=>{var a;if(!n||!((a=e._clickOutside)!=null&&a[t.instance.$.uid]))return;const{onClick:r,onMousedown:i}=e._clickOutside[t.instance.$.uid];n.removeEventListener("click",r,!0),n.removeEventListener("mousedown",i,!0)}),delete e._clickOutside[t.instance.$.uid])}};function kte(e){const{modelValue:t,color:n,...r}=e;return H(Qc,{name:"fade-transition",appear:!0},{default:()=>[e.modelValue&&H("div",tn({class:["v-overlay__scrim",e.color.backgroundColorClasses.value],style:e.color.backgroundColorStyles.value},r),null)]})}const l1=ht({absolute:Boolean,attach:[Boolean,String,Object],closeOnBack:{type:Boolean,default:!0},contained:Boolean,contentClass:null,contentProps:null,disabled:Boolean,noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[Boolean,String],default:!0},zIndex:{type:[Number,String],default:2e3},...Pte(),...ln(),...Du(),...sE(),...yte(),...Ete(),...ii(),...cf()},"VOverlay"),nf=Mt()({name:"VOverlay",directives:{ClickOutside:BB},inheritAttrs:!1,props:{_disableGlobalStack:Boolean,...l1()},emits:{"click:outside":e=>!0,"update:modelValue":e=>!0,afterLeave:()=>!0},setup(e,t){let{slots:n,attrs:r,emit:i}=t;const a=nr(e,"modelValue"),l=fe({get:()=>a.value,set:Ke=>{Ke&&e.disabled||(a.value=Ke)}}),{teleportTarget:o}=Ote(fe(()=>e.attach||e.contained)),{themeClasses:f}=Ii(e),{rtlClasses:p,isRtl:y}=Za(),{hasContent:x,onAfterLeave:w}=DP(e,l),S=zo(fe(()=>typeof e.scrim=="string"?e.scrim:null)),{globalTop:L,localTop:D,stackStyles:B}=Lte(l,kt(e,"zIndex"),e._disableGlobalStack),{activatorEl:z,activatorRef:M,activatorEvents:k,contentEvents:V,scrimEvents:q}=Ate(e,{isActive:l,isTop:D}),{dimensionStyles:Y}=Ru(e),K=kB(),{scopeId:X}=jy();cn(()=>e.disabled,Ke=>{Ke&&(l.value=!1)});const U=Xt(),le=Xt(),{contentStyles:ue,updateLocation:ae}=vte(e,{isRtl:y,contentEl:le,activatorEl:z,isActive:l});Ste(e,{root:U,contentEl:le,activatorEl:z,isActive:l,updateLocation:ae});function ve(Ke){i("click:outside",Ke),e.persistent?Pe():l.value=!1}function Ee(){return l.value&&L.value}Yi&&cn(l,Ke=>{Ke?window.addEventListener("keydown",He):window.removeEventListener("keydown",He)},{immediate:!0});function He(Ke){var Be,Ue;Ke.key==="Escape"&&L.value&&(e.persistent?Pe():(l.value=!1,(Be=le.value)!=null&&Be.contains(document.activeElement)&&((Ue=z.value)==null||Ue.focus())))}const Oe=JF();md(()=>e.closeOnBack,()=>{wee(Oe,Ke=>{L.value&&l.value?(Ke(!1),e.persistent?Pe():l.value=!1):Ke()})});const Ve=Xt();cn(()=>l.value&&(e.absolute||e.contained)&&o.value==null,Ke=>{if(Ke){const Be=dP(U.value);Be&&Be!==document.scrollingElement&&(Ve.value=Be.scrollTop)}});function Pe(){e.noClickAnimation||le.value&&Cp(le.value,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:D0})}return Bt(()=>{var Ke;return H(Dn,null,[(Ke=n.activator)==null?void 0:Ke.call(n,{isActive:l.value,props:tn({ref:M},k.value,e.activatorProps)}),K.value&&x.value&&H(B9,{disabled:!o.value,to:o.value},{default:()=>[H("div",tn({class:["v-overlay",{"v-overlay--absolute":e.absolute||e.contained,"v-overlay--active":l.value,"v-overlay--contained":e.contained},f.value,p.value,e.class],style:[B.value,{top:dn(Ve.value)},e.style],ref:U},X,r),[H(kte,tn({color:S,modelValue:l.value&&!!e.scrim},q.value),null),H(uc,{appear:!0,persisted:!0,transition:e.transition,target:z.value,onAfterLeave:()=>{w(),i("afterLeave")}},{default:()=>{var Be;return[go(H("div",tn({ref:le,class:["v-overlay__content",e.contentClass],style:[Y.value,ue.value]},V.value,e.contentProps),[(Be=n.default)==null?void 0:Be.call(n,{isActive:l})]),[[Ec,l.value],[Fl("click-outside"),{handler:ve,closeConditional:Ee,include:()=>[z.value]}]])]}})])]})])}),{activatorEl:z,animateClick:Pe,contentEl:le,globalTop:L,localTop:D,updateLocation:ae}}}),BT=Symbol("Forwarded refs");function zT(e,t){let n=e;for(;n;){const r=Reflect.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function Ic(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e[BT]=n,new Proxy(e,{get(i,a){if(Reflect.has(i,a))return Reflect.get(i,a);if(!(typeof a=="symbol"||a.startsWith("__"))){for(const l of n)if(l.value&&Reflect.has(l.value,a)){const o=Reflect.get(l.value,a);return typeof o=="function"?o.bind(l.value):o}}},has(i,a){if(Reflect.has(i,a))return!0;if(typeof a=="symbol"||a.startsWith("__"))return!1;for(const l of n)if(l.value&&Reflect.has(l.value,a))return!0;return!1},set(i,a,l){if(Reflect.has(i,a))return Reflect.set(i,a,l);if(typeof a=="symbol"||a.startsWith("__"))return!1;for(const o of n)if(o.value&&Reflect.has(o.value,a))return Reflect.set(o.value,a,l);return!1},getOwnPropertyDescriptor(i,a){var o;const l=Reflect.getOwnPropertyDescriptor(i,a);if(l)return l;if(!(typeof a=="symbol"||a.startsWith("__"))){for(const f of n){if(!f.value)continue;const p=zT(f.value,a)??("_"in f.value?zT((o=f.value._)==null?void 0:o.setupState,a):void 0);if(p)return p}for(const f of n){const p=f.value&&f.value[BT];if(!p)continue;const y=p.slice();for(;y.length;){const x=y.shift(),w=zT(x.value,a);if(w)return w;const S=x.value&&x.value[BT];S&&y.push(...S)}}}}})}const Nte=ht({id:String,...Mu(l1({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:eE}}),["absolute"])},"VMenu"),lE=Mt()({name:"VMenu",props:Nte(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const r=nr(e,"modelValue"),{scopeId:i}=jy(),a=ws(),l=fe(()=>e.id||`v-menu-${a}`),o=Xt(),f=Pi(tC,null),p=on(0);da(tC,{register(){++p.value},unregister(){--p.value},closeParents(){setTimeout(()=>{p.value||(r.value=!1,f==null||f.closeParents())},40)}});async function y(D){var M,k,V;const B=D.relatedTarget,z=D.target;await qi(),r.value&&B!==z&&((M=o.value)!=null&&M.contentEl)&&((k=o.value)!=null&&k.globalTop)&&![document,o.value.contentEl].includes(z)&&!o.value.contentEl.contains(z)&&((V=O0(o.value.contentEl)[0])==null||V.focus())}cn(r,D=>{D?(f==null||f.register(),document.addEventListener("focusin",y,{once:!0})):(f==null||f.unregister(),document.removeEventListener("focusin",y))});function x(){f==null||f.closeParents()}function w(D){var B,z,M;e.disabled||D.key==="Tab"&&(vF(O0((B=o.value)==null?void 0:B.contentEl,!1),D.shiftKey?"prev":"next",V=>V.tabIndex>=0)||(r.value=!1,(M=(z=o.value)==null?void 0:z.activatorEl)==null||M.focus()))}function S(D){var z;if(e.disabled)return;const B=(z=o.value)==null?void 0:z.contentEl;B&&r.value?D.key==="ArrowDown"?(D.preventDefault(),ew(B,"next")):D.key==="ArrowUp"&&(D.preventDefault(),ew(B,"prev")):["ArrowDown","ArrowUp"].includes(D.key)&&(r.value=!0,D.preventDefault(),setTimeout(()=>setTimeout(()=>S(D))))}const L=fe(()=>tn({"aria-haspopup":"menu","aria-expanded":String(r.value),"aria-owns":l.value,onKeydown:S},e.activatorProps));return Bt(()=>{const[D]=nf.filterProps(e);return H(nf,tn({ref:o,class:["v-menu",e.class],style:e.style},D,{modelValue:r.value,"onUpdate:modelValue":B=>r.value=B,absolute:!0,activatorProps:L.value,"onClick:outside":x,onKeydown:w},i),{activator:n.activator,default:function(){for(var B=arguments.length,z=new Array(B),M=0;M<B;M++)z[M]=arguments[M];return H(Mi,{root:"VMenu"},{default:()=>{var k;return[(k=n.default)==null?void 0:k.call(n,...z)]}})}})}),Ic({id:l,openChildren:p},o)}});const Fte=ht({active:Boolean,max:[Number,String],value:{type:[Number,String],default:0},...ln(),...cf({transition:{component:xP}})},"VCounter"),uE=Mt()({name:"VCounter",functional:!0,props:Fte(),setup(e,t){let{slots:n}=t;const r=fe(()=>e.max?`${e.value} / ${e.max}`:String(e.value));return Bt(()=>H(uc,{transition:e.transition},{default:()=>[go(H("div",{class:["v-counter",e.class],style:e.style},[n.default?n.default({counter:r.value,max:e.max,value:e.value}):r.value]),[[Ec,e.active]])]})),{}}});const Bte=ht({floating:Boolean,...ln()},"VFieldLabel"),j_=Mt()({name:"VFieldLabel",props:Bte(),setup(e,t){let{slots:n}=t;return Bt(()=>H($y,{class:["v-field-label",{"v-field-label--floating":e.floating},e.class],style:e.style,"aria-hidden":e.floating||void 0},n)),{}}}),zte=["underlined","outlined","filled","solo","solo-inverted","solo-filled","plain"],cE=ht({appendInnerIcon:Jn,bgColor:String,clearable:Boolean,clearIcon:{type:Jn,default:"$clear"},active:Boolean,centerAffix:{type:Boolean,default:void 0},color:String,baseColor:String,dirty:Boolean,disabled:{type:Boolean,default:null},error:Boolean,flat:Boolean,label:String,persistentClear:Boolean,prependInnerIcon:Jn,reverse:Boolean,singleLine:Boolean,variant:{type:String,default:"filled",validator:e=>zte.includes(e)},"onClick:clear":Jc(),"onClick:appendInner":Jc(),"onClick:prependInner":Jc(),...ln(),...CP(),...lo(),...ii()},"VField"),u1=Mt()({name:"VField",inheritAttrs:!1,props:{id:String,...iE(),...cE()},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{attrs:n,emit:r,slots:i}=t;const{themeClasses:a}=Ii(e),{loaderClasses:l}=nE(e),{focusClasses:o,isFocused:f,focus:p,blur:y}=Td(e),{InputIcon:x}=hB(e),{roundedClasses:w}=ko(e),{rtlClasses:S}=Za(),L=fe(()=>e.dirty||e.active),D=fe(()=>!e.singleLine&&!!(e.label||i.label)),B=ws(),z=fe(()=>e.id||`input-${B}`),M=fe(()=>`${z.value}-messages`),k=Xt(),V=Xt(),q=Xt(),Y=fe(()=>["plain","underlined"].includes(e.variant)),{backgroundColorClasses:K,backgroundColorStyles:X}=zo(kt(e,"bgColor")),{textColorClasses:U,textColorStyles:le}=xs(fe(()=>e.error||e.disabled?void 0:L.value&&f.value?e.color:e.baseColor));cn(L,ve=>{if(D.value){const Ee=k.value.$el,He=V.value.$el;requestAnimationFrame(()=>{const Oe=cP(Ee),Ve=He.getBoundingClientRect(),Pe=Ve.x-Oe.x,Ke=Ve.y-Oe.y-(Oe.height/2-Ve.height/2),Be=Ve.width/.75,Ue=Math.abs(Be-Oe.width)>1?{maxWidth:dn(Be)}:void 0,lt=getComputedStyle(Ee),xt=getComputedStyle(He),Nt=parseFloat(lt.transitionDuration)*1e3||150,Wt=parseFloat(xt.getPropertyValue("--v-field-label-scale")),Je=xt.getPropertyValue("color");Ee.style.visibility="visible",He.style.visibility="hidden",Cp(Ee,{transform:`translate(${Pe}px, ${Ke}px) scale(${Wt})`,color:Je,...Ue},{duration:Nt,easing:D0,direction:ve?"normal":"reverse"}).finished.then(()=>{Ee.style.removeProperty("visibility"),He.style.removeProperty("visibility")})})}},{flush:"post"});const ue=fe(()=>({isActive:L,isFocused:f,controlRef:q,blur:y,focus:p}));function ae(ve){ve.target!==document.activeElement&&ve.preventDefault()}return Bt(()=>{var Pe,Ke,Be;const ve=e.variant==="outlined",Ee=i["prepend-inner"]||e.prependInnerIcon,He=!!(e.clearable||i.clear),Oe=!!(i["append-inner"]||e.appendInnerIcon||He),Ve=i.label?i.label({...ue.value,label:e.label,props:{for:z.value}}):e.label;return H("div",tn({class:["v-field",{"v-field--active":L.value,"v-field--appended":Oe,"v-field--center-affix":e.centerAffix??!Y.value,"v-field--disabled":e.disabled,"v-field--dirty":e.dirty,"v-field--error":e.error,"v-field--flat":e.flat,"v-field--has-background":!!e.bgColor,"v-field--persistent-clear":e.persistentClear,"v-field--prepended":Ee,"v-field--reverse":e.reverse,"v-field--single-line":e.singleLine,"v-field--no-label":!Ve,[`v-field--variant-${e.variant}`]:!0},a.value,K.value,o.value,l.value,w.value,S.value,e.class],style:[X.value,e.style],onClick:ae},n),[H("div",{class:"v-field__overlay"},null),H(PP,{name:"v-field",active:!!e.loading,color:e.error?"error":typeof e.loading=="string"?e.loading:e.color},{default:i.loader}),Ee&&H("div",{key:"prepend",class:"v-field__prepend-inner"},[e.prependInnerIcon&&H(x,{key:"prepend-icon",name:"prependInner"},null),(Pe=i["prepend-inner"])==null?void 0:Pe.call(i,ue.value)]),H("div",{class:"v-field__field","data-no-activator":""},[["filled","solo","solo-inverted","solo-filled"].includes(e.variant)&&D.value&&H(j_,{key:"floating-label",ref:V,class:[U.value],floating:!0,for:z.value,style:le.value},{default:()=>[Ve]}),H(j_,{ref:k,for:z.value},{default:()=>[Ve]}),(Ke=i.default)==null?void 0:Ke.call(i,{...ue.value,props:{id:z.value,class:"v-field__input","aria-describedby":M.value},focus:p,blur:y})]),He&&H(bP,{key:"clear"},{default:()=>[go(H("div",{class:"v-field__clearable",onMousedown:Ue=>{Ue.preventDefault(),Ue.stopPropagation()}},[i.clear?i.clear():H(x,{name:"clear"},null)]),[[Ec,e.dirty]])]}),Oe&&H("div",{key:"append",class:"v-field__append-inner"},[(Be=i["append-inner"])==null?void 0:Be.call(i,ue.value),e.appendInnerIcon&&H(x,{key:"append-icon",name:"appendInner"},null)]),H("div",{class:["v-field__outline",U.value],style:le.value},[ve&&H(Dn,null,[H("div",{class:"v-field__outline__start"},null),D.value&&H("div",{class:"v-field__outline__notch"},[H(j_,{ref:V,floating:!0,for:z.value},{default:()=>[Ve]})]),H("div",{class:"v-field__outline__end"},null)]),Y.value&&D.value&&H(j_,{ref:V,floating:!0,for:z.value},{default:()=>[Ve]})])])}),{controlRef:q}}});function RP(e){const t=Object.keys(u1.props).filter(n=>!sP(n)&&n!=="class"&&n!=="style");return ng(e,t)}const Ute=["color","file","time","date","datetime-local","week","month"],hE=ht({autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,role:String,type:{type:String,default:"text"},modelModifiers:Object,...ff(),...cE()},"VTextField"),og=Mt()({name:"VTextField",directives:{Intersect:i1},inheritAttrs:!1,props:hE(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{attrs:n,emit:r,slots:i}=t;const a=nr(e,"modelValue"),{isFocused:l,focus:o,blur:f}=Td(e),p=fe(()=>typeof e.counterValue=="function"?e.counterValue(a.value):(a.value??"").toString().length),y=fe(()=>{if(n.maxlength)return n.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter}),x=fe(()=>["plain","underlined"].includes(e.variant));function w(Y,K){var X,U;!e.autofocus||!Y||(U=(X=K[0].target)==null?void 0:X.focus)==null||U.call(X)}const S=Xt(),L=Xt(),D=Xt(),B=fe(()=>Ute.includes(e.type)||e.persistentPlaceholder||l.value||e.active);function z(){var Y;D.value!==document.activeElement&&((Y=D.value)==null||Y.focus()),l.value||o()}function M(Y){r("mousedown:control",Y),Y.target!==D.value&&(z(),Y.preventDefault())}function k(Y){z(),r("click:control",Y)}function V(Y){Y.stopPropagation(),z(),qi(()=>{a.value=null,uP(e["onClick:clear"],Y)})}function q(Y){var X;const K=Y.target;if(a.value=K.value,(X=e.modelModifiers)!=null&&X.trim&&["text","search","password","tel","url"].includes(e.type)){const U=[K.selectionStart,K.selectionEnd];qi(()=>{K.selectionStart=U[0],K.selectionEnd=U[1]})}}return Bt(()=>{const Y=!!(i.counter||e.counter||e.counterValue),K=!!(Y||i.details),[X,U]=fg(n),[{modelValue:le,...ue}]=ns.filterProps(e),[ae]=RP(e);return H(ns,tn({ref:S,modelValue:a.value,"onUpdate:modelValue":ve=>a.value=ve,class:["v-text-field",{"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-text-field--plain-underlined":["plain","underlined"].includes(e.variant)},e.class],style:e.style},X,ue,{centerAffix:!x.value,focused:l.value}),{...i,default:ve=>{let{id:Ee,isDisabled:He,isDirty:Oe,isReadonly:Ve,isValid:Pe}=ve;return H(u1,tn({ref:L,onMousedown:M,onClick:k,"onClick:clear":V,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:e.role},ae,{id:Ee.value,active:B.value||Oe.value,dirty:Oe.value||e.dirty,disabled:He.value,focused:l.value,error:Pe.value===!1}),{...i,default:Ke=>{let{props:{class:Be,...Ue}}=Ke;const lt=go(H("input",tn({ref:D,value:a.value,onInput:q,autofocus:e.autofocus,readonly:Ve.value,disabled:He.value,name:e.name,placeholder:e.placeholder,size:1,type:e.type,onFocus:z,onBlur:f},Ue,U),null),[[Fl("intersect"),{handler:w},null,{once:!0}]]);return H(Dn,null,[e.prefix&&H("span",{class:"v-text-field__prefix"},[H("span",{class:"v-text-field__prefix__text"},[e.prefix])]),i.default?H("div",{class:Be,"data-no-activator":""},[i.default(),lt]):$h(lt,{class:Be}),e.suffix&&H("span",{class:"v-text-field__suffix"},[H("span",{class:"v-text-field__suffix__text"},[e.suffix])])])}})},details:K?ve=>{var Ee;return H(Dn,null,[(Ee=i.details)==null?void 0:Ee.call(i,ve),Y&&H(Dn,null,[H("span",null,null),H(uE,{active:e.persistentCounter||l.value,value:p.value,max:y.value},i.counter)])])}:void 0})}),Ic({},S,L,D)}});const Vte=ht({renderless:Boolean,...ln()},"VVirtualScrollItem"),Gte=Mt()({name:"VVirtualScrollItem",inheritAttrs:!1,props:Vte(),emits:{"update:height":e=>!0},setup(e,t){let{attrs:n,emit:r,slots:i}=t;const{resizeRef:a,contentRect:l}=lh(void 0,"border");cn(()=>{var o;return(o=l.value)==null?void 0:o.height},o=>{o!=null&&r("update:height",o)}),Bt(()=>{var o,f;return e.renderless?H(Dn,null,[(o=i.default)==null?void 0:o.call(i,{itemRef:a})]):H("div",tn({ref:a,class:["v-virtual-scroll__item",e.class],style:e.style},n),[(f=i.default)==null?void 0:f.call(i)])})}}),hR=-1,fR=1,$te=ht({itemHeight:{type:[Number,String],default:48}},"virtual");function jte(e,t,n){const r=on(0),i=on(e.itemHeight),a=fe({get:()=>parseInt(i.value??0,10),set(K){i.value=K}}),l=Xt(),{resizeRef:o,contentRect:f}=lh();Nl(()=>{o.value=l.value});const p=dg(),y=new Map;let x=Array.from({length:t.value.length});const w=fe(()=>{const K=(!f.value||l.value===document.documentElement?p.height.value:f.value.height)-((n==null?void 0:n.value)??0);return Math.ceil(K/a.value*1.7+1)});function S(K,X){a.value=Math.max(a.value,X),x[K]=X,y.set(t.value[K],X)}function L(K){return x.slice(0,K).reduce((X,U)=>X+(U||a.value),0)}function D(K){const X=t.value.length;let U=0,le=0;for(;le<K&&U<X;)le+=x[U++]||a.value;return U-1}let B=0;function z(){if(!l.value||!f.value)return;const K=f.value.height-56,X=l.value.scrollTop,U=X<B?hR:fR,le=D(X+K/2),ue=Math.round(w.value/3),ae=le-ue,ve=r.value+ue*2-1;U===hR&&le<=ve?r.value=ps(ae,0,t.value.length):U===fR&&le>=ve&&(r.value=ps(ae,0,t.value.length-w.value)),B=X}function M(K){if(!l.value)return;const X=L(K);l.value.scrollTop=X}const k=fe(()=>Math.min(t.value.length,r.value+w.value)),V=fe(()=>t.value.slice(r.value,k.value).map((K,X)=>({raw:K,index:X+r.value}))),q=fe(()=>L(r.value)),Y=fe(()=>L(t.value.length)-L(k.value));return cn(()=>t.value.length,()=>{x=Fh(t.value.length).map(()=>a.value),y.forEach((K,X)=>{const U=t.value.indexOf(X);U===-1?y.delete(X):x[U]=K})}),{containerRef:l,computedItems:V,itemHeight:a,paddingTop:q,paddingBottom:Y,scrollToIndex:M,handleScroll:z,handleItemResize:S}}const qte=ht({items:{type:Array,default:()=>[]},renderless:Boolean,...$te(),...ln(),...Du()},"VVirtualScroll"),fE=Mt()({name:"VVirtualScroll",props:qte(),setup(e,t){let{slots:n}=t;const r=qa("VVirtualScroll"),{dimensionStyles:i}=Ru(e),{containerRef:a,handleScroll:l,handleItemResize:o,scrollToIndex:f,paddingTop:p,paddingBottom:y,computedItems:x}=jte(e,kt(e,"items"));return md(()=>e.renderless,()=>{bs(()=>{var w;a.value=dP(r.vnode.el,!0),(w=a.value)==null||w.addEventListener("scroll",l)}),il(()=>{var w;(w=a.value)==null||w.removeEventListener("scroll",l)})}),Bt(()=>{const w=x.value.map(S=>H(Gte,{key:S.index,renderless:e.renderless,"onUpdate:height":L=>o(S.index,L)},{default:L=>{var D;return(D=n.default)==null?void 0:D.call(n,{item:S.raw,index:S.index,...L})}}));return e.renderless?H(Dn,null,[H("div",{class:"v-virtual-scroll__spacer",style:{paddingTop:dn(p.value)}},null),w,H("div",{class:"v-virtual-scroll__spacer",style:{paddingBottom:dn(y.value)}},null)]):H("div",{ref:a,class:["v-virtual-scroll",e.class],onScroll:l,style:[i.value,e.style]},[H("div",{class:"v-virtual-scroll__container",style:{paddingTop:dn(p.value),paddingBottom:dn(y.value)}},[w])])}),{scrollToIndex:f}}});function kP(e,t){const n=on(!1);let r;function i(o){cancelAnimationFrame(r),n.value=!0,r=requestAnimationFrame(()=>{r=requestAnimationFrame(()=>{n.value=!1})})}async function a(){await new Promise(o=>requestAnimationFrame(o)),await new Promise(o=>requestAnimationFrame(o)),await new Promise(o=>requestAnimationFrame(o)),await new Promise(o=>{if(n.value){const f=cn(n,()=>{f(),o()})}else o()})}async function l(o){var y,x;if(o.key==="Tab"&&((y=t.value)==null||y.focus()),!["PageDown","PageUp","Home","End"].includes(o.key))return;const f=(x=e.value)==null?void 0:x.$el;if(!f)return;(o.key==="Home"||o.key==="End")&&f.scrollTo({top:o.key==="Home"?0:f.scrollHeight,behavior:"smooth"}),await a();const p=f.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(o.key==="PageDown"||o.key==="Home"){const w=f.getBoundingClientRect().top;for(const S of p)if(S.getBoundingClientRect().top>=w){S.focus();break}}else{const w=f.getBoundingClientRect().bottom;for(const S of[...p].reverse())if(S.getBoundingClientRect().bottom<=w){S.focus();break}}}return{onListScroll:i,onListKeydown:l}}const NP=ht({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,menu:Boolean,menuIcon:{type:Jn,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,...PB({itemChildren:!1})},"Select"),Zte=ht({...NP(),...Mu(hE({modelValue:null,role:"button"}),["validationValue","dirty","appendInnerIcon"]),...cf({transition:{component:eE}})},"VSelect"),Xte=Mt()({name:"VSelect",props:Zte(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,t){let{slots:n}=t;const{t:r}=Ou(),i=Xt(),a=Xt(),l=Xt(),o=nr(e,"menu"),f=fe({get:()=>o.value,set:Oe=>{var Ve;o.value&&!Oe&&((Ve=a.value)!=null&&Ve.openChildren)||(o.value=Oe)}}),{items:p,transformIn:y,transformOut:x}=OP(e),w=nr(e,"modelValue",[],Oe=>y(Oe===null?[null]:Pl(Oe)),Oe=>{const Ve=x(Oe);return e.multiple?Ve:Ve[0]??null}),S=oE(),L=fe(()=>w.value.map(Oe=>Oe.value)),D=on(!1),B=fe(()=>f.value?e.closeText:e.openText);let z="",M;const k=fe(()=>e.hideSelected?p.value.filter(Oe=>!w.value.some(Ve=>Ve===Oe)):p.value),V=fe(()=>e.hideNoData&&!p.value.length||e.readonly||(S==null?void 0:S.isReadonly.value)),q=Xt(),{onListScroll:Y,onListKeydown:K}=kP(q,i);function X(Oe){e.openOnClear&&(f.value=!0)}function U(){V.value||(f.value=!f.value)}function le(Oe){var Ue,lt;if(!Oe.key||e.readonly||S!=null&&S.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(Oe.key)&&Oe.preventDefault(),["Enter","ArrowDown"," "].includes(Oe.key)&&(f.value=!0),["Escape","Tab"].includes(Oe.key)&&(f.value=!1),Oe.key==="Home"?(Ue=q.value)==null||Ue.focus("first"):Oe.key==="End"&&((lt=q.value)==null||lt.focus("last"));const Ve=1e3;function Pe(xt){const Nt=xt.key.length===1,Wt=!xt.ctrlKey&&!xt.metaKey&&!xt.altKey;return Nt&&Wt}if(e.multiple||!Pe(Oe))return;const Ke=performance.now();Ke-M>Ve&&(z=""),z+=Oe.key.toLowerCase(),M=Ke;const Be=p.value.find(xt=>xt.title.toLowerCase().startsWith(z));Be!==void 0&&(w.value=[Be])}function ue(Oe){if(e.multiple){const Ve=w.value.findIndex(Pe=>e.valueComparator(Pe.value,Oe.value));if(Ve===-1)w.value=[...w.value,Oe];else{const Pe=[...w.value];Pe.splice(Ve,1),w.value=Pe}}else w.value=[Oe],f.value=!1}function ae(Oe){var Ve;(Ve=q.value)!=null&&Ve.$el.contains(Oe.relatedTarget)||(f.value=!1)}function ve(){var Oe;D.value&&((Oe=i.value)==null||Oe.focus())}function Ee(Oe){D.value=!0}function He(Oe){if(Oe==null)w.value=[];else if(_y(i.value,":autofill")||_y(i.value,":-webkit-autofill")){const Ve=p.value.find(Pe=>Pe.title===Oe);Ve&&ue(Ve)}else i.value&&(i.value.value="")}return cn(f,()=>{if(!e.hideSelected&&f.value&&w.value.length){const Oe=k.value.findIndex(Ve=>w.value.some(Pe=>e.valueComparator(Pe.value,Ve.value)));Yi&&window.requestAnimationFrame(()=>{var Ve;Oe>=0&&((Ve=l.value)==null||Ve.scrollToIndex(Oe))})}}),Bt(()=>{const Oe=!!(e.chips||n.chip),Ve=!!(!e.hideNoData||k.value.length||n["prepend-item"]||n["append-item"]||n["no-data"]),Pe=w.value.length>0,[Ke]=og.filterProps(e),Be=Pe||!D.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return H(og,tn({ref:i},Ke,{modelValue:w.value.map(Ue=>Ue.props.value).join(", "),"onUpdate:modelValue":He,focused:D.value,"onUpdate:focused":Ue=>D.value=Ue,validationValue:w.externalValue,dirty:Pe,class:["v-select",{"v-select--active-menu":f.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":w.value.length,"v-select--selection-slot":!!n.selection},e.class],style:e.style,inputmode:"none",placeholder:Be,"onClick:clear":X,"onMousedown:control":U,onBlur:ae,onKeydown:le,"aria-label":r(B.value),title:r(B.value)}),{...n,default:()=>H(Dn,null,[H(lE,tn({ref:a,modelValue:f.value,"onUpdate:modelValue":Ue=>f.value=Ue,activator:"parent",contentClass:"v-select__content",disabled:V.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:ve},e.menuProps),{default:()=>[Ve&&H(aE,{ref:q,selected:L.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:Ue=>Ue.preventDefault(),onKeydown:K,onFocusin:Ee,onScrollPassive:Y,tabindex:"-1",color:e.itemColor??e.color},{default:()=>{var Ue,lt,xt;return[(Ue=n["prepend-item"])==null?void 0:Ue.call(n),!k.value.length&&!e.hideNoData&&(((lt=n["no-data"])==null?void 0:lt.call(n))??H(tf,{title:r(e.noDataText)},null)),H(fE,{ref:l,renderless:!0,items:k.value},{default:Nt=>{var dt;let{item:Wt,index:Je,itemRef:Kt}=Nt;const Vt=tn(Wt.props,{ref:Kt,key:Je,onClick:()=>ue(Wt)});return((dt=n.item)==null?void 0:dt.call(n,{item:Wt,index:Je,props:Vt}))??H(tf,Vt,{prepend:Jt=>{let{isSelected:Ut}=Jt;return H(Dn,null,[e.multiple&&!e.hideSelected?H(wy,{key:Wt.value,modelValue:Ut,ripple:!1,tabindex:"-1"},null):void 0,Wt.props.prependIcon&&H(zi,{icon:Wt.props.prependIcon},null)])}})}}),(xt=n["append-item"])==null?void 0:xt.call(n)]}})]}),w.value.map((Ue,lt)=>{var Wt;function xt(Je){Je.stopPropagation(),Je.preventDefault(),ue(Ue)}const Nt={"onClick:close":xt,onMousedown(Je){Je.preventDefault(),Je.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return H("div",{key:Ue.value,class:"v-select__selection"},[Oe?n.chip?H(Mi,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:Ue.title}}},{default:()=>{var Je;return[(Je=n.chip)==null?void 0:Je.call(n,{item:Ue,index:lt,props:Nt})]}}):H(s1,tn({key:"chip",closable:e.closableChips,size:"small",text:Ue.title},Nt),null):((Wt=n.selection)==null?void 0:Wt.call(n,{item:Ue,index:lt}))??H("span",{class:"v-select__selection-text"},[Ue.title,e.multiple&&lt<w.value.length-1&&H("span",{class:"v-select__selection-comma"},[au(",")])])])})]),"append-inner":function(){var Nt;for(var Ue=arguments.length,lt=new Array(Ue),xt=0;xt<Ue;xt++)lt[xt]=arguments[xt];return H(Dn,null,[(Nt=n["append-inner"])==null?void 0:Nt.call(n,...lt),e.menuIcon?H(zi,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),Ic({isFocused:D,menu:f,select:ue},i)}}),Wte=(e,t,n)=>e==null||t==null?-1:e.toString().toLocaleLowerCase().indexOf(t.toString().toLocaleLowerCase()),zB=ht({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function Hte(e,t,n){var o;const r=[],i=(n==null?void 0:n.default)??Wte,a=n!=null&&n.filterKeys?Pl(n.filterKeys):!1,l=Object.keys((n==null?void 0:n.customKeyFilter)??{}).length;if(!(e!=null&&e.length))return r;e:for(let f=0;f<e.length;f++){const[p,y=p]=Pl(e[f]),x={},w={};let S=-1;if(t&&!(n!=null&&n.noFilter)){if(typeof p=="object"){const B=a||Object.keys(y);for(const z of B){const M=Wc(y,z,y),k=(o=n==null?void 0:n.customKeyFilter)==null?void 0:o[z];if(S=k?k(M,t,p):i(M,t,p),S!==-1&&S!==!1)k?x[z]=S:w[z]=S;else if((n==null?void 0:n.filterMode)==="every")continue e}}else S=i(p,t,p),S!==-1&&S!==!1&&(w.title=S);const L=Object.keys(w).length,D=Object.keys(x).length;if(!L&&!D||(n==null?void 0:n.filterMode)==="union"&&D!==l&&!L||(n==null?void 0:n.filterMode)==="intersection"&&(D!==l||!L))continue}r.push({index:f,matches:{...w,...x}})}return r}function UB(e,t,n,r){const i=Xt([]),a=Xt(new Map),l=fe(()=>r!=null&&r.transform?Sl(t).map(f=>[f,r.transform(f)]):Sl(t));Nl(()=>{const f=typeof n=="function"?n():Sl(n),p=typeof f!="string"&&typeof f!="number"?"":String(f),y=Hte(l.value,p,{customKeyFilter:e.customKeyFilter,default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),x=Sl(t),w=[],S=new Map;y.forEach(L=>{let{index:D,matches:B}=L;const z=x[D];w.push(z),S.set(z.value,B)}),i.value=w,a.value=S});function o(f){return a.value.get(f.value)}return{filteredItems:i,filteredMatches:a,getMatches:o}}function Yte(e,t,n){if(t==null)return e;if(Array.isArray(t))throw new Error("Multiple matches is not implemented");return typeof t=="number"&&~t?H(Dn,null,[H("span",{class:"v-autocomplete__unmask"},[e.substr(0,t)]),H("span",{class:"v-autocomplete__mask"},[e.substr(t,n)]),H("span",{class:"v-autocomplete__unmask"},[e.substr(t+n)])]):e}const Kte=ht({autoSelectFirst:{type:[Boolean,String]},search:String,...zB({filterKeys:["title"]}),...NP(),...Mu(hE({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...cf({transition:!1})},"VAutocomplete"),Jte=Mt()({name:"VAutocomplete",props:Kte(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,t){let{slots:n}=t;const{t:r}=Ou(),i=Xt(),a=on(!1),l=on(!0),o=on(!1),f=Xt(),p=Xt(),y=nr(e,"menu"),x=fe({get:()=>y.value,set:Vt=>{var dt;y.value&&!Vt&&((dt=f.value)!=null&&dt.openChildren)||(y.value=Vt)}}),w=on(-1),S=fe(()=>{var Vt;return(Vt=i.value)==null?void 0:Vt.color}),L=fe(()=>x.value?e.closeText:e.openText),{items:D,transformIn:B,transformOut:z}=OP(e),{textColorClasses:M,textColorStyles:k}=xs(S),V=nr(e,"search",""),q=nr(e,"modelValue",[],Vt=>B(Vt===null?[null]:Pl(Vt)),Vt=>{const dt=z(Vt);return e.multiple?dt:dt[0]??null}),Y=oE(),{filteredItems:K,getMatches:X}=UB(e,D,()=>l.value?"":V.value),U=fe(()=>e.hideSelected?K.value.filter(Vt=>!q.value.some(dt=>dt.value===Vt.value)):K.value),le=fe(()=>q.value.map(Vt=>Vt.props.value)),ue=fe(()=>{var dt;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&V.value===((dt=U.value[0])==null?void 0:dt.title))&&U.value.length>0&&!l.value&&!o.value}),ae=fe(()=>e.hideNoData&&!D.value.length||e.readonly||(Y==null?void 0:Y.isReadonly.value)),ve=Xt(),{onListScroll:Ee,onListKeydown:He}=kP(ve,i);function Oe(Vt){e.openOnClear&&(x.value=!0),V.value=""}function Ve(){ae.value||(x.value=!0)}function Pe(Vt){ae.value||(a.value&&(Vt.preventDefault(),Vt.stopPropagation()),x.value=!x.value)}function Ke(Vt){var Ut,we,Ce;if(e.readonly||Y!=null&&Y.isReadonly.value)return;const dt=i.value.selectionStart,Jt=q.value.length;if((w.value>-1||["Enter","ArrowDown","ArrowUp"].includes(Vt.key))&&Vt.preventDefault(),["Enter","ArrowDown"].includes(Vt.key)&&(x.value=!0),["Escape"].includes(Vt.key)&&(x.value=!1),ue.value&&["Enter","Tab"].includes(Vt.key)&&Kt(U.value[0]),Vt.key==="ArrowDown"&&ue.value&&((Ut=ve.value)==null||Ut.focus("next")),!!e.multiple){if(["Backspace","Delete"].includes(Vt.key)){if(w.value<0){Vt.key==="Backspace"&&!V.value&&(w.value=Jt-1);return}const je=w.value,nt=q.value[w.value];nt&&Kt(nt),w.value=je>=Jt-1?Jt-2:je}if(Vt.key==="ArrowLeft"){if(w.value<0&&dt>0)return;const je=w.value>-1?w.value-1:Jt-1;q.value[je]?w.value=je:(w.value=-1,i.value.setSelectionRange((we=V.value)==null?void 0:we.length,(Ce=V.value)==null?void 0:Ce.length))}if(Vt.key==="ArrowRight"){if(w.value<0)return;const je=w.value+1;q.value[je]?w.value=je:(w.value=-1,i.value.setSelectionRange(0,0))}}}function Be(Vt){V.value=Vt.target.value}function Ue(Vt){if(_y(i.value,":autofill")||_y(i.value,":-webkit-autofill")){const dt=D.value.find(Jt=>Jt.title===Vt.target.value);dt&&Kt(dt)}}function lt(){var Vt;a.value&&(l.value=!0,(Vt=i.value)==null||Vt.focus())}function xt(Vt){a.value=!0,setTimeout(()=>{o.value=!0})}function Nt(Vt){o.value=!1}function Wt(Vt){(Vt==null||Vt===""&&!e.multiple)&&(q.value=[])}const Je=on(!1);function Kt(Vt){if(e.multiple){const dt=q.value.findIndex(Jt=>e.valueComparator(Jt.value,Vt.value));if(dt===-1)q.value=[...q.value,Vt];else{const Jt=[...q.value];Jt.splice(dt,1),q.value=Jt}}else q.value=[Vt],Je.value=!0,V.value=Vt.title,x.value=!1,l.value=!0,qi(()=>Je.value=!1)}return cn(a,(Vt,dt)=>{var Jt;Vt!==dt&&(Vt?(Je.value=!0,V.value=e.multiple?"":String(((Jt=q.value.at(-1))==null?void 0:Jt.props.title)??""),l.value=!0,qi(()=>Je.value=!1)):(!e.multiple&&!V.value?q.value=[]:ue.value&&!o.value&&!q.value.some(Ut=>{let{value:we}=Ut;return we===U.value[0].value})&&Kt(U.value[0]),x.value=!1,V.value="",w.value=-1))}),cn(V,Vt=>{!a.value||Je.value||(Vt&&(x.value=!0),l.value=!Vt)}),cn(x,()=>{if(!e.hideSelected&&x.value&&q.value.length){const Vt=U.value.findIndex(dt=>q.value.some(Jt=>dt.value===Jt.value));Yi&&window.requestAnimationFrame(()=>{var dt;Vt>=0&&((dt=p.value)==null||dt.scrollToIndex(Vt))})}}),Bt(()=>{const Vt=!!(e.chips||n.chip),dt=!!(!e.hideNoData||U.value.length||n["prepend-item"]||n["append-item"]||n["no-data"]),Jt=q.value.length>0,[Ut]=og.filterProps(e);return H(og,tn({ref:i},Ut,{modelValue:V.value,"onUpdate:modelValue":Wt,focused:a.value,"onUpdate:focused":we=>a.value=we,validationValue:q.externalValue,dirty:Jt,onInput:Be,onChange:Ue,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":x.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!n.selection,"v-autocomplete--selecting-index":w.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:Jt?void 0:e.placeholder,"onClick:clear":Oe,"onMousedown:control":Ve,onKeydown:Ke}),{...n,default:()=>H(Dn,null,[H(lE,tn({ref:f,modelValue:x.value,"onUpdate:modelValue":we=>x.value=we,activator:"parent",contentClass:"v-autocomplete__content",disabled:ae.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:lt},e.menuProps),{default:()=>[dt&&H(aE,{ref:ve,selected:le.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:we=>we.preventDefault(),onKeydown:He,onFocusin:xt,onFocusout:Nt,onScrollPassive:Ee,tabindex:"-1",color:e.itemColor??e.color},{default:()=>{var we,Ce,je;return[(we=n["prepend-item"])==null?void 0:we.call(n),!U.value.length&&!e.hideNoData&&(((Ce=n["no-data"])==null?void 0:Ce.call(n))??H(tf,{title:r(e.noDataText)},null)),H(fE,{ref:p,renderless:!0,items:U.value},{default:nt=>{var Gt;let{item:st,index:vt,itemRef:Dt}=nt;const Ct=tn(st.props,{ref:Dt,key:vt,active:ue.value&&vt===0?!0:void 0,onClick:()=>Kt(st)});return((Gt=n.item)==null?void 0:Gt.call(n,{item:st,index:vt,props:Ct}))??H(tf,Ct,{prepend:Tt=>{let{isSelected:fn}=Tt;return H(Dn,null,[e.multiple&&!e.hideSelected?H(wy,{key:st.value,modelValue:fn,ripple:!1,tabindex:"-1"},null):void 0,st.props.prependIcon&&H(zi,{icon:st.props.prependIcon},null)])},title:()=>{var Tt,fn;return l.value?st.title:Yte(st.title,(Tt=X(st))==null?void 0:Tt.title,((fn=V.value)==null?void 0:fn.length)??0)}})}}),(je=n["append-item"])==null?void 0:je.call(n)]}})]}),q.value.map((we,Ce)=>{var st;function je(vt){vt.stopPropagation(),vt.preventDefault(),Kt(we)}const nt={"onClick:close":je,onMousedown(vt){vt.preventDefault(),vt.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return H("div",{key:we.value,class:["v-autocomplete__selection",Ce===w.value&&["v-autocomplete__selection--selected",M.value]],style:Ce===w.value?k.value:{}},[Vt?n.chip?H(Mi,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:we.title}}},{default:()=>{var vt;return[(vt=n.chip)==null?void 0:vt.call(n,{item:we,index:Ce,props:nt})]}}):H(s1,tn({key:"chip",closable:e.closableChips,size:"small",text:we.title},nt),null):((st=n.selection)==null?void 0:st.call(n,{item:we,index:Ce}))??H("span",{class:"v-autocomplete__selection-text"},[we.title,e.multiple&&Ce<q.value.length-1&&H("span",{class:"v-autocomplete__selection-comma"},[au(",")])])])})]),"append-inner":function(){var nt;for(var we=arguments.length,Ce=new Array(we),je=0;je<we;je++)Ce[je]=arguments[je];return H(Dn,null,[(nt=n["append-inner"])==null?void 0:nt.call(n,...Ce),e.menuIcon?H(zi,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:Pe,onClick:_F,"aria-label":r(L.value),title:r(L.value)},null):void 0])}})}),Ic({isFocused:a,isPristine:l,menu:x,search:V,filteredItems:K,select:Kt},i)}});const Qte=ht({bordered:Boolean,color:String,content:[Number,String],dot:Boolean,floating:Boolean,icon:Jn,inline:Boolean,label:{type:String,default:"$vuetify.badge"},max:[Number,String],modelValue:{type:Boolean,default:!0},offsetX:[Number,String],offsetY:[Number,String],textColor:String,...ln(),...wd({location:"top end"}),...lo(),...or(),...ii(),...cf({transition:"scale-rotate-transition"})},"VBadge"),ene=Mt()({name:"VBadge",inheritAttrs:!1,props:Qte(),setup(e,t){const{backgroundColorClasses:n,backgroundColorStyles:r}=zo(kt(e,"color")),{roundedClasses:i}=ko(e),{t:a}=Ou(),{textColorClasses:l,textColorStyles:o}=xs(kt(e,"textColor")),{themeClasses:f}=NF(),{locationStyles:p}=Ed(e,!0,y=>(e.floating?e.dot?2:4:e.dot?8:12)+(["top","bottom"].includes(y)?+(e.offsetY??0):["left","right"].includes(y)?+(e.offsetX??0):0));return Bt(()=>{const y=Number(e.content),x=!e.max||isNaN(y)?e.content:y<=+e.max?y:`${e.max}+`,[w,S]=ng(t.attrs,["aria-atomic","aria-label","aria-live","role","title"]);return H(e.tag,tn({class:["v-badge",{"v-badge--bordered":e.bordered,"v-badge--dot":e.dot,"v-badge--floating":e.floating,"v-badge--inline":e.inline},e.class]},S,{style:e.style}),{default:()=>{var L,D;return[H("div",{class:"v-badge__wrapper"},[(D=(L=t.slots).default)==null?void 0:D.call(L),H(uc,{transition:e.transition},{default:()=>{var B,z;return[go(H("span",tn({class:["v-badge__badge",f.value,n.value,i.value,l.value],style:[r.value,o.value,e.inline?{}:p.value],"aria-atomic":"true","aria-label":a(e.label,y),"aria-live":"polite",role:"status"},w),[e.dot?void 0:t.slots.badge?(z=(B=t.slots).badge)==null?void 0:z.call(B):e.icon?H(zi,{icon:e.icon},null):x]),[[Ec,e.modelValue]])]}})])]}})}),{}}});const tne=ht({color:String,density:String,...ln()},"VBannerActions"),VB=Mt()({name:"VBannerActions",props:tne(),setup(e,t){let{slots:n}=t;return fa({VBtn:{color:e.color,density:e.density,variant:"text"}}),Bt(()=>{var r;return H("div",{class:["v-banner-actions",e.class],style:e.style},[(r=n.default)==null?void 0:r.call(n)])}),{}}}),GB=Tc("v-banner-text"),nne=ht({avatar:String,color:String,icon:Jn,lines:String,stacked:Boolean,sticky:Boolean,text:String,...Vl(),...ln(),...Ta(),...Du(),...Sa(),...wd(),...Vy(),...lo(),...or(),...ii()},"VBanner"),rne=Mt()({name:"VBanner",props:nne(),setup(e,t){let{slots:n}=t;const{borderClasses:r}=ku(e),{densityClasses:i}=Es(e),{mobile:a}=dg(),{dimensionStyles:l}=Ru(e),{elevationClasses:o}=rs(e),{locationStyles:f}=Ed(e),{positionClasses:p}=Gy(e),{roundedClasses:y}=ko(e),{themeClasses:x}=Ii(e),w=kt(e,"color"),S=kt(e,"density");fa({VBannerActions:{color:w,density:S}}),Bt(()=>{const L=!!(e.text||n.text),D=!!(e.avatar||e.icon),B=!!(D||n.prepend);return H(e.tag,{class:["v-banner",{"v-banner--stacked":e.stacked||a.value,"v-banner--sticky":e.sticky,[`v-banner--${e.lines}-line`]:!!e.lines},r.value,i.value,o.value,p.value,y.value,x.value,e.class],style:[l.value,f.value,e.style],role:"banner"},{default:()=>{var z;return[B&&H("div",{key:"prepend",class:"v-banner__prepend"},[n.prepend?H(Mi,{key:"prepend-defaults",disabled:!D,defaults:{VAvatar:{color:w.value,density:S.value,icon:e.icon,image:e.avatar}}},n.prepend):H(yd,{key:"prepend-avatar",color:w.value,density:S.value,icon:e.icon,image:e.avatar},null)]),H("div",{class:"v-banner__content"},[L&&H(GB,{key:"text"},{default:()=>{var M;return[((M=n.text)==null?void 0:M.call(n))??e.text]}}),(z=n.default)==null?void 0:z.call(n)]),n.actions&&H(VB,{key:"actions"},n.actions)]}})})}});const ine=ht({bgColor:String,color:String,grow:Boolean,mode:{type:String,validator:e=>!e||["horizontal","shift"].includes(e)},height:{type:[Number,String],default:56},active:{type:Boolean,default:!0},...Vl(),...ln(),...Ta(),...Sa(),...lo(),...ky({name:"bottom-navigation"}),...or({tag:"header"}),...Fy({modelValue:!0,selectedClass:"v-btn--selected"}),...ii()},"VBottomNavigation"),one=Mt()({name:"VBottomNavigation",props:ine(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{themeClasses:r}=NF(),{borderClasses:i}=ku(e),{backgroundColorClasses:a,backgroundColorStyles:l}=zo(kt(e,"bgColor")),{densityClasses:o}=Es(e),{elevationClasses:f}=rs(e),{roundedClasses:p}=ko(e),{ssrBootStyles:y}=pg(),x=fe(()=>Number(e.height)-(e.density==="comfortable"?8:0)-(e.density==="compact"?16:0)),w=kt(e,"active"),{layoutItemStyles:S}=Ny({id:e.name,order:fe(()=>parseInt(e.order,10)),position:fe(()=>"bottom"),layoutSize:fe(()=>w.value?x.value:0),elementSize:x,active:w,absolute:kt(e,"absolute")});return yg(e,EP),fa({VBtn:{color:kt(e,"color"),density:kt(e,"density"),stacked:fe(()=>e.mode!=="horizontal"),variant:"text"}},{scoped:!0}),Bt(()=>H(e.tag,{class:["v-bottom-navigation",{"v-bottom-navigation--active":w.value,"v-bottom-navigation--grow":e.grow,"v-bottom-navigation--shift":e.mode==="shift"},r.value,a.value,i.value,o.value,f.value,p.value,e.class],style:[l.value,S.value,{height:dn(x.value),transform:`translateY(${dn(w.value?0:100,"%")})`},y.value,e.style]},{default:()=>[n.default&&H("div",{class:"v-bottom-navigation__content"},[n.default()])]})),{}}});const ane=ht({divider:[Number,String],...ln()},"VBreadcrumbsDivider"),$B=Mt()({name:"VBreadcrumbsDivider",props:ane(),setup(e,t){let{slots:n}=t;return Bt(()=>{var r;return H("li",{class:["v-breadcrumbs-divider",e.class],style:e.style},[((r=n==null?void 0:n.default)==null?void 0:r.call(n))??e.divider])}),{}}}),sne=ht({active:Boolean,activeClass:String,activeColor:String,color:String,disabled:Boolean,title:String,...ln(),...a1(),...or({tag:"li"})},"VBreadcrumbsItem"),jB=Mt()({name:"VBreadcrumbsItem",props:sne(),setup(e,t){let{slots:n,attrs:r}=t;const i=o1(e,r),a=fe(()=>{var p;return e.active||((p=i.isActive)==null?void 0:p.value)}),l=fe(()=>a.value?e.activeColor:e.color),{textColorClasses:o,textColorStyles:f}=xs(l);return Bt(()=>H(e.tag,{class:["v-breadcrumbs-item",{"v-breadcrumbs-item--active":a.value,"v-breadcrumbs-item--disabled":e.disabled,[`${e.activeClass}`]:a.value&&e.activeClass},o.value,e.class],style:[f.value,e.style],"aria-current":a.value?"page":void 0},{default:()=>{var p,y;return[i.isLink.value?H("a",{class:"v-breadcrumbs-item--link",href:i.href.value,"aria-current":a.value?"page":void 0,onClick:i.navigate},[((y=n.default)==null?void 0:y.call(n))??e.title]):((p=n.default)==null?void 0:p.call(n))??e.title]}})),{}}}),lne=ht({activeClass:String,activeColor:String,bgColor:String,color:String,disabled:Boolean,divider:{type:String,default:"/"},icon:Jn,items:{type:Array,default:()=>[]},...ln(),...Ta(),...lo(),...or({tag:"ul"})},"VBreadcrumbs"),une=Mt()({name:"VBreadcrumbs",props:lne(),setup(e,t){let{slots:n}=t;const{backgroundColorClasses:r,backgroundColorStyles:i}=zo(kt(e,"bgColor")),{densityClasses:a}=Es(e),{roundedClasses:l}=ko(e);fa({VBreadcrumbsDivider:{divider:kt(e,"divider")},VBreadcrumbsItem:{activeClass:kt(e,"activeClass"),activeColor:kt(e,"activeColor"),color:kt(e,"color"),disabled:kt(e,"disabled")}});const o=fe(()=>e.items.map(f=>typeof f=="string"?{item:{title:f},raw:f}:{item:f,raw:f}));return Bt(()=>{const f=!!(n.prepend||e.icon);return H(e.tag,{class:["v-breadcrumbs",r.value,a.value,l.value,e.class],style:[i.value,e.style]},{default:()=>{var p;return[f&&H("li",{key:"prepend",class:"v-breadcrumbs__prepend"},[n.prepend?H(Mi,{key:"prepend-defaults",disabled:!e.icon,defaults:{VIcon:{icon:e.icon,start:!0}}},n.prepend):H(zi,{key:"prepend-icon",start:!0,icon:e.icon},null)]),o.value.map((y,x,w)=>{let{item:S,raw:L}=y;return H(Dn,null,[H(jB,tn({key:S.title,disabled:x>=w.length-1},S),{default:n.title?()=>{var D;return(D=n.title)==null?void 0:D.call(n,{item:L,index:x})}:void 0}),x<w.length-1&&H($B,null,{default:n.divider?()=>{var D;return(D=n.divider)==null?void 0:D.call(n,{item:L,index:x})}:void 0})])}),(p=n.default)==null?void 0:p.call(n)]}})}),{}}});const qB=Mt()({name:"VCardActions",props:ln(),setup(e,t){let{slots:n}=t;return fa({VBtn:{variant:"text"}}),Bt(()=>{var r;return H("div",{class:["v-card-actions",e.class],style:e.style},[(r=n.default)==null?void 0:r.call(n)])}),{}}}),ZB=Tc("v-card-subtitle"),XB=Tc("v-card-title"),cne=ht({appendAvatar:String,appendIcon:Jn,prependAvatar:String,prependIcon:Jn,subtitle:String,title:String,...ln(),...Ta()},"VCardItem"),WB=Mt()({name:"VCardItem",props:cne(),setup(e,t){let{slots:n}=t;return Bt(()=>{var p;const r=!!(e.prependAvatar||e.prependIcon),i=!!(r||n.prepend),a=!!(e.appendAvatar||e.appendIcon),l=!!(a||n.append),o=!!(e.title||n.title),f=!!(e.subtitle||n.subtitle);return H("div",{class:["v-card-item",e.class],style:e.style},[i&&H("div",{key:"prepend",class:"v-card-item__prepend"},[n.prepend?H(Mi,{key:"prepend-defaults",disabled:!r,defaults:{VAvatar:{density:e.density,icon:e.prependIcon,image:e.prependAvatar}}},n.prepend):r&&H(yd,{key:"prepend-avatar",density:e.density,icon:e.prependIcon,image:e.prependAvatar},null)]),H("div",{class:"v-card-item__content"},[o&&H(XB,{key:"title"},{default:()=>{var y;return[((y=n.title)==null?void 0:y.call(n))??e.title]}}),f&&H(ZB,{key:"subtitle"},{default:()=>{var y;return[((y=n.subtitle)==null?void 0:y.call(n))??e.subtitle]}}),(p=n.default)==null?void 0:p.call(n)]),l&&H("div",{key:"append",class:"v-card-item__append"},[n.append?H(Mi,{key:"append-defaults",disabled:!a,defaults:{VAvatar:{density:e.density,icon:e.appendIcon,image:e.appendAvatar}}},n.append):a&&H(yd,{key:"append-avatar",density:e.density,icon:e.appendIcon,image:e.appendAvatar},null)])])}),{}}}),HB=Tc("v-card-text"),hne=ht({appendAvatar:String,appendIcon:Jn,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:Jn,ripple:{type:[Boolean,Object],default:!0},subtitle:String,text:String,title:String,...Vl(),...ln(),...Ta(),...Du(),...Sa(),...CP(),...wd(),...Vy(),...lo(),...a1(),...or(),...ii(),...Nu({variant:"elevated"})},"VCard"),fne=Mt()({name:"VCard",directives:{Ripple:Sd},props:hne(),setup(e,t){let{attrs:n,slots:r}=t;const{themeClasses:i}=Ii(e),{borderClasses:a}=ku(e),{colorClasses:l,colorStyles:o,variantClasses:f}=mg(e),{densityClasses:p}=Es(e),{dimensionStyles:y}=Ru(e),{elevationClasses:x}=rs(e),{loaderClasses:w}=nE(e),{locationStyles:S}=Ed(e),{positionClasses:L}=Gy(e),{roundedClasses:D}=ko(e),B=o1(e,n),z=fe(()=>e.link!==!1&&B.isLink.value),M=fe(()=>!e.disabled&&e.link!==!1&&(e.link||B.isClickable.value));return Bt(()=>{const k=z.value?"a":e.tag,V=!!(r.title||e.title),q=!!(r.subtitle||e.subtitle),Y=V||q,K=!!(r.append||e.appendAvatar||e.appendIcon),X=!!(r.prepend||e.prependAvatar||e.prependIcon),U=!!(r.image||e.image),le=Y||X||K,ue=!!(r.text||e.text);return go(H(k,{class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":M.value},i.value,a.value,l.value,p.value,x.value,w.value,L.value,D.value,f.value,e.class],style:[o.value,y.value,S.value,e.style],href:B.href.value,onClick:M.value&&B.navigate,tabindex:e.disabled?-1:void 0},{default:()=>{var ae;return[U&&H("div",{key:"image",class:"v-card__image"},[r.image?H(Mi,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},r.image):H(rg,{key:"image-img",cover:!0,src:e.image},null)]),H(PP,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:r.loader}),le&&H(WB,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:r.item,prepend:r.prepend,title:r.title,subtitle:r.subtitle,append:r.append}),ue&&H(HB,{key:"text"},{default:()=>{var ve;return[((ve=r.text)==null?void 0:ve.call(r))??e.text]}}),(ae=r.default)==null?void 0:ae.call(r),r.actions&&H(qB,null,{default:r.actions}),gg(M.value,"v-card")]}}),[[Fl("ripple"),M.value&&e.ripple]])}),{}}});const dne=e=>{const{touchstartX:t,touchendX:n,touchstartY:r,touchendY:i}=e,a=.5,l=16;e.offsetX=n-t,e.offsetY=i-r,Math.abs(e.offsetY)<a*Math.abs(e.offsetX)&&(e.left&&n<t-l&&e.left(e),e.right&&n>t+l&&e.right(e)),Math.abs(e.offsetX)<a*Math.abs(e.offsetY)&&(e.up&&i<r-l&&e.up(e),e.down&&i>r+l&&e.down(e))};function pne(e,t){var r;const n=e.changedTouches[0];t.touchstartX=n.clientX,t.touchstartY=n.clientY,(r=t.start)==null||r.call(t,{originalEvent:e,...t})}function gne(e,t){var r;const n=e.changedTouches[0];t.touchendX=n.clientX,t.touchendY=n.clientY,(r=t.end)==null||r.call(t,{originalEvent:e,...t}),dne(t)}function mne(e,t){var r;const n=e.changedTouches[0];t.touchmoveX=n.clientX,t.touchmoveY=n.clientY,(r=t.move)==null||r.call(t,{originalEvent:e,...t})}function yne(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:n=>pne(n,t),touchend:n=>gne(n,t),touchmove:n=>mne(n,t)}}function vne(e,t){var o;const n=t.value,r=n!=null&&n.parent?e.parentElement:e,i=(n==null?void 0:n.options)??{passive:!0},a=(o=t.instance)==null?void 0:o.$.uid;if(!r||!a)return;const l=yne(t.value);r._touchHandlers=r._touchHandlers??Object.create(null),r._touchHandlers[a]=l,pF(l).forEach(f=>{r.addEventListener(f,l[f],i)})}function _ne(e,t){var a,l;const n=(a=t.value)!=null&&a.parent?e.parentElement:e,r=(l=t.instance)==null?void 0:l.$.uid;if(!(n!=null&&n._touchHandlers)||!r)return;const i=n._touchHandlers[r];pF(i).forEach(o=>{n.removeEventListener(o,i[o])}),delete n._touchHandlers[r]}const FP={mounted:vne,unmounted:_ne},YB=Symbol.for("vuetify:v-window"),KB=Symbol.for("vuetify:v-window-group"),JB=ht({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...ln(),...or(),...ii()},"VWindow"),nC=Mt()({name:"VWindow",directives:{Touch:FP},props:JB(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{themeClasses:r}=Ii(e),{isRtl:i}=Za(),{t:a}=Ou(),l=yg(e,KB),o=Xt(),f=fe(()=>i.value?!e.reverse:e.reverse),p=on(!1),y=fe(()=>{const V=e.direction==="vertical"?"y":"x",Y=(f.value?!p.value:p.value)?"-reverse":"";return`v-window-${V}${Y}-transition`}),x=on(0),w=Xt(void 0),S=fe(()=>l.items.value.findIndex(V=>l.selected.value.includes(V.id)));cn(S,(V,q)=>{const Y=l.items.value.length,K=Y-1;Y<=2?p.value=V<q:V===K&&q===0?p.value=!0:V===0&&q===K?p.value=!1:p.value=V<q}),da(YB,{transition:y,isReversed:p,transitionCount:x,transitionHeight:w,rootRef:o});const L=fe(()=>e.continuous||S.value!==0),D=fe(()=>e.continuous||S.value!==l.items.value.length-1);function B(){L.value&&l.prev()}function z(){D.value&&l.next()}const M=fe(()=>{const V=[],q={icon:i.value?e.nextIcon:e.prevIcon,class:`v-window__${f.value?"right":"left"}`,onClick:l.prev,ariaLabel:a("$vuetify.carousel.prev")};V.push(L.value?n.prev?n.prev({props:q}):H(Ls,q,null):H("div",null,null));const Y={icon:i.value?e.prevIcon:e.nextIcon,class:`v-window__${f.value?"left":"right"}`,onClick:l.next,ariaLabel:a("$vuetify.carousel.next")};return V.push(D.value?n.next?n.next({props:Y}):H(Ls,Y,null):H("div",null,null)),V}),k=fe(()=>e.touch===!1?e.touch:{...{left:()=>{f.value?B():z()},right:()=>{f.value?z():B()},start:q=>{let{originalEvent:Y}=q;Y.stopPropagation()}},...e.touch===!0?{}:e.touch});return Bt(()=>go(H(e.tag,{ref:o,class:["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover"},r.value,e.class],style:e.style},{default:()=>{var V,q;return[H("div",{class:"v-window__container",style:{height:w.value}},[(V=n.default)==null?void 0:V.call(n,{group:l}),e.showArrows!==!1&&H("div",{class:"v-window__controls"},[M.value])]),(q=n.additional)==null?void 0:q.call(n,{group:l})]}}),[[Fl("touch"),k.value]])),{group:l}}}),xne=ht({color:String,cycle:Boolean,delimiterIcon:{type:Jn,default:"$delimiter"},height:{type:[Number,String],default:500},hideDelimiters:Boolean,hideDelimiterBackground:Boolean,interval:{type:[Number,String],default:6e3,validator:e=>Number(e)>0},progress:[Boolean,String],verticalDelimiters:[Boolean,String],...JB({continuous:!0,mandatory:"force",showArrows:!0})},"VCarousel"),bne=Mt()({name:"VCarousel",props:xne(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const r=nr(e,"modelValue"),{t:i}=Ou(),a=Xt();let l=-1;cn(r,f),cn(()=>e.interval,f),cn(()=>e.cycle,p=>{p?f():window.clearTimeout(l)}),bs(o);function o(){!e.cycle||!a.value||(l=window.setTimeout(a.value.group.next,+e.interval>0?+e.interval:6e3))}function f(){window.clearTimeout(l),window.requestAnimationFrame(o)}return Bt(()=>{const[p]=nC.filterProps(e);return H(nC,tn({ref:a},p,{modelValue:r.value,"onUpdate:modelValue":y=>r.value=y,class:["v-carousel",{"v-carousel--hide-delimiter-background":e.hideDelimiterBackground,"v-carousel--vertical-delimiters":e.verticalDelimiters},e.class],style:[{height:dn(e.height)},e.style]}),{default:n.default,additional:y=>{let{group:x}=y;return H(Dn,null,[!e.hideDelimiters&&H("div",{class:"v-carousel__controls",style:{left:e.verticalDelimiters==="left"&&e.verticalDelimiters?0:"auto",right:e.verticalDelimiters==="right"?0:"auto"}},[x.items.value.length>0&&H(Mi,{defaults:{VBtn:{color:e.color,icon:e.delimiterIcon,size:"x-small",variant:"text"}},scoped:!0},{default:()=>[x.items.value.map((w,S)=>{const L={id:`carousel-item-${w.id}`,"aria-label":i("$vuetify.carousel.ariaLabel.delimiter",S+1,x.items.value.length),class:[x.isSelected(w.id)&&"v-btn--active"],onClick:()=>x.select(w.id,!0)};return n.item?n.item({props:L,item:w}):H(Ls,tn(w,L),null)})]})]),e.progress&&H(IP,{class:"v-carousel__progress",color:typeof e.progress=="string"?e.progress:void 0,modelValue:(x.getItemIndex(r.value)+1)/x.items.value.length*100},null)])},prev:n.prev,next:n.next})}),{}}}),QB=ht({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...ln(),...By(),...sE()},"VWindowItem"),rC=Mt()({name:"VWindowItem",directives:{Touch:FP},props:QB(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:n}=t;const r=Pi(YB),i=zy(e,KB),{isBooted:a}=pg();if(!r||!i)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const l=on(!1),o=fe(()=>a.value&&(r.isReversed.value?e.reverseTransition!==!1:e.transition!==!1));function f(){!l.value||!r||(l.value=!1,r.transitionCount.value>0&&(r.transitionCount.value-=1,r.transitionCount.value===0&&(r.transitionHeight.value=void 0)))}function p(){var L;l.value||!r||(l.value=!0,r.transitionCount.value===0&&(r.transitionHeight.value=dn((L=r.rootRef.value)==null?void 0:L.clientHeight)),r.transitionCount.value+=1)}function y(){f()}function x(L){l.value&&qi(()=>{!o.value||!l.value||!r||(r.transitionHeight.value=dn(L.clientHeight))})}const w=fe(()=>{const L=r.isReversed.value?e.reverseTransition:e.transition;return o.value?{name:typeof L!="string"?r.transition.value:L,onBeforeEnter:p,onAfterEnter:f,onEnterCancelled:y,onBeforeLeave:p,onAfterLeave:f,onLeaveCancelled:y,onEnter:x}:!1}),{hasContent:S}=DP(e,i.isSelected);return Bt(()=>H(uc,{transition:w.value,disabled:!a.value},{default:()=>{var L;return[go(H("div",{class:["v-window-item",i.selectedClass.value,e.class],style:e.style},[S.value&&((L=n.default)==null?void 0:L.call(n))]),[[Ec,i.isSelected.value]])]}})),{groupItem:i}}}),wne=ht({...WF(),...QB()},"VCarouselItem"),Ene=Mt()({name:"VCarouselItem",inheritAttrs:!1,props:wne(),setup(e,t){let{slots:n,attrs:r}=t;Bt(()=>{const[i]=rg.filterProps(e),[a]=rC.filterProps(e);return H(rC,tn({class:"v-carousel-item"},a),{default:()=>[H(rg,tn(r,i),n)]})})}});const Sne=Tc("v-code");const Tne=ht({color:{type:Object},disabled:Boolean,dotSize:{type:[Number,String],default:10},height:{type:[Number,String],default:150},width:{type:[Number,String],default:300},...ln()},"VColorPickerCanvas"),Ine=Lu({name:"VColorPickerCanvas",props:Tne(),emits:{"update:color":e=>!0,"update:position":e=>!0},setup(e,t){let{emit:n}=t;const r=on(!1),i=Xt(),a=on(parseFloat(e.width)),l=on(parseFloat(e.height)),o=Xt({x:0,y:0}),f=fe({get:()=>o.value,set(B){var k,V;if(!i.value)return;const{x:z,y:M}=B;n("update:color",{h:((k=e.color)==null?void 0:k.h)??0,s:ps(z,0,a.value)/a.value,v:1-ps(M,0,l.value)/l.value,a:((V=e.color)==null?void 0:V.a)??1})}}),p=fe(()=>{const{x:B,y:z}=f.value,M=parseInt(e.dotSize,10)/2;return{width:dn(e.dotSize),height:dn(e.dotSize),transform:`translate(${dn(B-M)}, ${dn(z-M)})`}}),{resizeRef:y}=lh(B=>{var k;if(!((k=y.value)!=null&&k.offsetParent))return;const{width:z,height:M}=B[0].contentRect;a.value=z,l.value=M});function x(B,z,M){const{left:k,top:V,width:q,height:Y}=M;f.value={x:ps(B-k,0,q),y:ps(z-V,0,Y)}}function w(B){B.type==="mousedown"&&B.preventDefault(),!e.disabled&&(S(B),window.addEventListener("mousemove",S),window.addEventListener("mouseup",L),window.addEventListener("touchmove",S),window.addEventListener("touchend",L))}function S(B){if(e.disabled||!i.value)return;r.value=!0;const z=bJ(B);x(z.clientX,z.clientY,i.value.getBoundingClientRect())}function L(){window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",L),window.removeEventListener("touchmove",S),window.removeEventListener("touchend",L)}function D(){var V;if(!i.value)return;const B=i.value,z=B.getContext("2d");if(!z)return;const M=z.createLinearGradient(0,0,B.width,0);M.addColorStop(0,"hsla(0, 0%, 100%, 1)"),M.addColorStop(1,`hsla(${((V=e.color)==null?void 0:V.h)??0}, 100%, 50%, 1)`),z.fillStyle=M,z.fillRect(0,0,B.width,B.height);const k=z.createLinearGradient(0,0,0,B.height);k.addColorStop(0,"hsla(0, 0%, 100%, 0)"),k.addColorStop(1,"hsla(0, 0%, 0%, 1)"),z.fillStyle=k,z.fillRect(0,0,B.width,B.height)}return cn(()=>{var B;return(B=e.color)==null?void 0:B.h},D,{immediate:!0}),cn(()=>[a.value,l.value],(B,z)=>{D(),o.value={x:f.value.x*B[0]/z[0],y:f.value.y*B[1]/z[1]}},{flush:"post"}),cn(()=>e.color,()=>{if(r.value){r.value=!1;return}o.value=e.color?{x:e.color.s*a.value,y:(1-e.color.v)*l.value}:{x:0,y:0}},{deep:!0,immediate:!0}),bs(()=>D()),Bt(()=>H("div",{ref:y,class:["v-color-picker-canvas",e.class],style:e.style,onMousedown:w,onTouchstartPassive:w},[H("canvas",{ref:i,width:a.value,height:l.value},null),e.color&&H("div",{class:["v-color-picker-canvas__dot",{"v-color-picker-canvas__dot--disabled":e.disabled}],style:p.value},null)])),{}}});function Cne(e,t){if(t){const{a:n,...r}=e;return r}return e}function Pne(e,t){if(t==null||typeof t=="string"){const n=AF(e);return e.a===1?n.slice(0,7):n}if(typeof t=="object"){let n;return Ip(t,["r","g","b"])?n=ef(e):Ip(t,["h","s","l"])?n=SF(e):Ip(t,["h","s","v"])&&(n=e),Cne(n,!Ip(t,["a"])&&e.a===1)}return e}const K_={h:0,s:0,v:1,a:1},iC={inputProps:{type:"number",min:0},inputs:[{label:"R",max:255,step:1,getValue:e=>Math.round(e.r),getColor:(e,t)=>({...e,r:Number(t)})},{label:"G",max:255,step:1,getValue:e=>Math.round(e.g),getColor:(e,t)=>({...e,g:Number(t)})},{label:"B",max:255,step:1,getValue:e=>Math.round(e.b),getColor:(e,t)=>({...e,b:Number(t)})},{label:"A",max:1,step:.01,getValue:e=>{let{a:t}=e;return t!=null?Math.round(t*100)/100:1},getColor:(e,t)=>({...e,a:Number(t)})}],to:ef,from:Kw};var _R;const Ane={...iC,inputs:(_R=iC.inputs)==null?void 0:_R.slice(0,3)},oC={inputProps:{type:"number",min:0},inputs:[{label:"H",max:360,step:1,getValue:e=>Math.round(e.h),getColor:(e,t)=>({...e,h:Number(t)})},{label:"S",max:1,step:.01,getValue:e=>Math.round(e.s*100)/100,getColor:(e,t)=>({...e,s:Number(t)})},{label:"L",max:1,step:.01,getValue:e=>Math.round(e.l*100)/100,getColor:(e,t)=>({...e,l:Number(t)})},{label:"A",max:1,step:.01,getValue:e=>{let{a:t}=e;return t!=null?Math.round(t*100)/100:1},getColor:(e,t)=>({...e,a:Number(t)})}],to:SF,from:fP},Mne={...oC,inputs:oC.inputs.slice(0,3)},ez={inputProps:{type:"text"},inputs:[{label:"HEXA",getValue:e=>e,getColor:(e,t)=>t}],to:AF,from:UJ},Lne={...ez,inputs:[{label:"HEX",getValue:e=>e.slice(0,7),getColor:(e,t)=>t}]},Rp={rgb:Ane,rgba:iC,hsl:Mne,hsla:oC,hex:Lne,hexa:ez},One=e=>{let{label:t,...n}=e;return H("div",{class:"v-color-picker-edit__input"},[H("input",n,null),H("span",null,[t])])},Dne=ht({color:Object,disabled:Boolean,mode:{type:String,default:"rgba",validator:e=>Object.keys(Rp).includes(e)},modes:{type:Array,default:()=>Object.keys(Rp),validator:e=>Array.isArray(e)&&e.every(t=>Object.keys(Rp).includes(t))},...ln()},"VColorPickerEdit"),Rne=Lu({name:"VColorPickerEdit",props:Dne(),emits:{"update:color":e=>!0,"update:mode":e=>!0},setup(e,t){let{emit:n}=t;const r=fe(()=>e.modes.map(a=>({...Rp[a],name:a}))),i=fe(()=>{var o;const a=r.value.find(f=>f.name===e.mode);if(!a)return[];const l=e.color?a.to(e.color):null;return(o=a.inputs)==null?void 0:o.map(f=>{let{getValue:p,getColor:y,...x}=f;return{...a.inputProps,...x,disabled:e.disabled,value:l&&p(l),onChange:w=>{const S=w.target;S&&n("update:color",a.from(y(l??K_,S.value)))}}})});return Bt(()=>{var a;return H("div",{class:["v-color-picker-edit",e.class],style:e.style},[(a=i.value)==null?void 0:a.map(l=>H(One,l,null)),r.value.length>1&&H(Ls,{icon:"$unfold",size:"x-small",variant:"plain",onClick:()=>{const l=r.value.findIndex(o=>o.name===e.mode);n("update:mode",r.value[(l+1)%r.value.length].name)}},null)])}),{}}});const BP=Symbol.for("vuetify:v-slider");function aC(e,t,n){const r=n==="vertical",i=t.getBoundingClientRect(),a="touches"in e?e.touches[0]:e;return r?a.clientY-(i.top+i.height/2):a.clientX-(i.left+i.width/2)}function kne(e,t){return"touches"in e&&e.touches.length?e.touches[0][t]:"changedTouches"in e&&e.changedTouches.length?e.changedTouches[0][t]:e[t]}const tz=ht({disabled:{type:Boolean,default:null},error:Boolean,readonly:{type:Boolean,default:null},max:{type:[Number,String],default:100},min:{type:[Number,String],default:0},step:{type:[Number,String],default:0},thumbColor:String,thumbLabel:{type:[Boolean,String],default:void 0,validator:e=>typeof e=="boolean"||e==="always"},thumbSize:{type:[Number,String],default:20},showTicks:{type:[Boolean,String],default:!1,validator:e=>typeof e=="boolean"||e==="always"},ticks:{type:[Array,Object]},tickSize:{type:[Number,String],default:2},color:String,trackColor:String,trackFillColor:String,trackSize:{type:[Number,String],default:4},direction:{type:String,default:"horizontal",validator:e=>["vertical","horizontal"].includes(e)},reverse:Boolean,...lo(),...Sa({elevation:2})},"Slider"),nz=e=>{const t=fe(()=>parseFloat(e.min)),n=fe(()=>parseFloat(e.max)),r=fe(()=>+e.step>0?parseFloat(e.step):0),i=fe(()=>Math.max(I3(r.value),I3(t.value)));function a(l){if(l=parseFloat(l),r.value<=0)return l;const o=ps(l,t.value,n.value),f=t.value%r.value,p=Math.round((o-f)/r.value)*r.value+f;return parseFloat(Math.min(p,n.value).toFixed(i.value))}return{min:t,max:n,step:r,decimals:i,roundValue:a}},rz=e=>{let{props:t,steps:n,onSliderStart:r,onSliderMove:i,onSliderEnd:a,getActiveThumb:l}=e;const{isRtl:o}=Za(),f=kt(t,"reverse"),p=fe(()=>{let Je=o.value?"rtl":"ltr";return t.reverse&&(Je=Je==="rtl"?"ltr":"rtl"),Je}),{min:y,max:x,step:w,decimals:S,roundValue:L}=n,D=fe(()=>parseInt(t.thumbSize,10)),B=fe(()=>parseInt(t.tickSize,10)),z=fe(()=>parseInt(t.trackSize,10)),M=fe(()=>(x.value-y.value)/w.value),k=kt(t,"disabled"),V=fe(()=>t.direction==="vertical"),q=fe(()=>t.error||t.disabled?void 0:t.thumbColor??t.color),Y=fe(()=>t.error||t.disabled?void 0:t.trackColor??t.color),K=fe(()=>t.error||t.disabled?void 0:t.trackFillColor??t.color),X=on(!1),U=on(0),le=Xt(),ue=Xt();function ae(Je){var nt;const Kt=t.direction==="vertical",Vt=Kt?"top":"left",dt=Kt?"height":"width",Jt=Kt?"clientY":"clientX",{[Vt]:Ut,[dt]:we}=(nt=le.value)==null?void 0:nt.$el.getBoundingClientRect(),Ce=kne(Je,Jt);let je=Math.min(Math.max((Ce-Ut-U.value)/we,0),1)||0;return(Kt||p.value==="rtl")&&(je=1-je),L(y.value+je*(x.value-y.value))}const ve=Je=>{a({value:ae(Je)}),X.value=!1,U.value=0},Ee=Je=>{ue.value=l(Je),ue.value&&(ue.value.focus(),X.value=!0,ue.value.contains(Je.target)?U.value=aC(Je,ue.value,t.direction):(U.value=0,i({value:ae(Je)})),r({value:ae(Je)}))},He={passive:!0,capture:!0};function Oe(Je){i({value:ae(Je)})}function Ve(Je){Je.stopPropagation(),Je.preventDefault(),ve(Je),window.removeEventListener("mousemove",Oe,He),window.removeEventListener("mouseup",Ve)}function Pe(Je){var Kt;ve(Je),window.removeEventListener("touchmove",Oe,He),(Kt=Je.target)==null||Kt.removeEventListener("touchend",Pe)}function Ke(Je){var Kt;Ee(Je),window.addEventListener("touchmove",Oe,He),(Kt=Je.target)==null||Kt.addEventListener("touchend",Pe,{passive:!1})}function Be(Je){Je.preventDefault(),Ee(Je),window.addEventListener("mousemove",Oe,He),window.addEventListener("mouseup",Ve,{passive:!1})}const Ue=Je=>{const Kt=(Je-y.value)/(x.value-y.value)*100;return ps(isNaN(Kt)?0:Kt,0,100)},lt=kt(t,"showTicks"),xt=fe(()=>lt.value?t.ticks?Array.isArray(t.ticks)?t.ticks.map(Je=>({value:Je,position:Ue(Je),label:Je.toString()})):Object.keys(t.ticks).map(Je=>({value:parseFloat(Je),position:Ue(parseFloat(Je)),label:t.ticks[Je]})):M.value!==1/0?Fh(M.value+1).map(Je=>{const Kt=y.value+Je*w.value;return{value:Kt,position:Ue(Kt)}}):[]:[]),Nt=fe(()=>xt.value.some(Je=>{let{label:Kt}=Je;return!!Kt})),Wt={activeThumbRef:ue,color:kt(t,"color"),decimals:S,disabled:k,direction:kt(t,"direction"),elevation:kt(t,"elevation"),hasLabels:Nt,horizontalDirection:p,isReversed:f,min:y,max:x,mousePressed:X,numTicks:M,onSliderMousedown:Be,onSliderTouchstart:Ke,parsedTicks:xt,parseMouseMove:ae,position:Ue,readonly:kt(t,"readonly"),rounded:kt(t,"rounded"),roundValue:L,showTicks:lt,startOffset:U,step:w,thumbSize:D,thumbColor:q,thumbLabel:kt(t,"thumbLabel"),ticks:kt(t,"ticks"),tickSize:B,trackColor:Y,trackContainerRef:le,trackFillColor:K,trackSize:z,vertical:V};return da(BP,Wt),Wt},Nne=ht({focused:Boolean,max:{type:Number,required:!0},min:{type:Number,required:!0},modelValue:{type:Number,required:!0},position:{type:Number,required:!0},ripple:{type:[Boolean,Object],default:!0},...ln()},"VSliderThumb"),sC=Mt()({name:"VSliderThumb",directives:{Ripple:Sd},props:Nne(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n,emit:r}=t;const i=Pi(BP),{rtlClasses:a}=Za();if(!i)throw new Error("[Vuetify] v-slider-thumb must be used inside v-slider or v-range-slider");const{thumbColor:l,step:o,vertical:f,disabled:p,thumbSize:y,thumbLabel:x,direction:w,readonly:S,elevation:L,isReversed:D,horizontalDirection:B,mousePressed:z,decimals:M}=i,{textColorClasses:k,textColorStyles:V}=xs(l),{pageup:q,pagedown:Y,end:K,home:X,left:U,right:le,down:ue,up:ae}=NI,ve=[q,Y,K,X,U,le,ue,ae],Ee=fe(()=>o.value?[1,2,3]:[1,5,10]);function He(Ve,Pe){if(!ve.includes(Ve.key))return;Ve.preventDefault();const Ke=o.value||.1,Be=(e.max-e.min)/Ke;if([U,le,ue,ae].includes(Ve.key)){const lt=(B.value==="rtl"?[U,ae]:[le,ae]).includes(Ve.key)?1:-1,xt=Ve.shiftKey?2:Ve.ctrlKey?1:0;Pe=Pe+lt*Ke*Ee.value[xt]}else if(Ve.key===X)Pe=e.min;else if(Ve.key===K)Pe=e.max;else{const Ue=Ve.key===Y?1:-1;Pe=Pe-Ue*Ke*(Be>100?Be/10:10)}return Math.max(e.min,Math.min(e.max,Pe))}function Oe(Ve){const Pe=He(Ve,e.modelValue);Pe!=null&&r("update:modelValue",Pe)}return Bt(()=>{const Ve=dn(f.value||D.value?100-e.position:e.position,"%"),{elevationClasses:Pe}=rs(fe(()=>p.value?void 0:L.value));return H("div",{class:["v-slider-thumb",{"v-slider-thumb--focused":e.focused,"v-slider-thumb--pressed":e.focused&&z.value},e.class,a.value],style:[{"--v-slider-thumb-position":Ve,"--v-slider-thumb-size":dn(y.value)},e.style],role:"slider",tabindex:p.value?-1:0,"aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.modelValue,"aria-readonly":!!S.value,"aria-orientation":w.value,onKeydown:S.value?void 0:Oe},[H("div",{class:["v-slider-thumb__surface",k.value,Pe.value],style:{...V.value}},null),go(H("div",{class:["v-slider-thumb__ripple",k.value],style:V.value},null),[[Fl("ripple"),e.ripple,null,{circle:!0,center:!0}]]),H(_P,{origin:"bottom center"},{default:()=>{var Ke;return[go(H("div",{class:"v-slider-thumb__label-container"},[H("div",{class:["v-slider-thumb__label"]},[H("div",null,[((Ke=n["thumb-label"])==null?void 0:Ke.call(n,{modelValue:e.modelValue}))??e.modelValue.toFixed(o.value?M.value:1)])])]),[[Ec,x.value&&e.focused||x.value==="always"]])]}})])}),{}}});const Fne=ht({start:{type:Number,required:!0},stop:{type:Number,required:!0},...ln()},"VSliderTrack"),iz=Mt()({name:"VSliderTrack",props:Fne(),emits:{},setup(e,t){let{slots:n}=t;const r=Pi(BP);if(!r)throw new Error("[Vuetify] v-slider-track must be inside v-slider or v-range-slider");const{color:i,horizontalDirection:a,parsedTicks:l,rounded:o,showTicks:f,tickSize:p,trackColor:y,trackFillColor:x,trackSize:w,vertical:S,min:L,max:D}=r,{roundedClasses:B}=ko(o),{backgroundColorClasses:z,backgroundColorStyles:M}=zo(x),{backgroundColorClasses:k,backgroundColorStyles:V}=zo(y),q=fe(()=>`inset-${S.value?"block-end":"inline-start"}`),Y=fe(()=>S.value?"height":"width"),K=fe(()=>({[q.value]:"0%",[Y.value]:"100%"})),X=fe(()=>e.stop-e.start),U=fe(()=>({[q.value]:dn(e.start,"%"),[Y.value]:dn(X.value,"%")})),le=fe(()=>f.value?(S.value?l.value.slice().reverse():l.value).map((ae,ve)=>{var Oe;const Ee=S.value?"bottom":"margin-inline-start",He=ae.value!==L.value&&ae.value!==D.value?dn(ae.position,"%"):void 0;return H("div",{key:ae.value,class:["v-slider-track__tick",{"v-slider-track__tick--filled":ae.position>=e.start&&ae.position<=e.stop,"v-slider-track__tick--first":ae.value===L.value,"v-slider-track__tick--last":ae.value===D.value}],style:{[Ee]:He}},[(ae.label||n["tick-label"])&&H("div",{class:"v-slider-track__tick-label"},[((Oe=n["tick-label"])==null?void 0:Oe.call(n,{tick:ae,index:ve}))??ae.label])])}):[]);return Bt(()=>H("div",{class:["v-slider-track",B.value,e.class],style:[{"--v-slider-track-size":dn(w.value),"--v-slider-tick-size":dn(p.value),direction:S.value?void 0:a.value},e.style]},[H("div",{class:["v-slider-track__background",k.value,{"v-slider-track__background--opacity":!!i.value||!x.value}],style:{...K.value,...V.value}},null),H("div",{class:["v-slider-track__fill",z.value],style:{...U.value,...M.value}},null),f.value&&H("div",{class:["v-slider-track__ticks",{"v-slider-track__ticks--always-show":f.value==="always"}]},[le.value])])),{}}}),Bne=ht({...iE(),...tz(),...ff(),modelValue:{type:[Number,String],default:0}},"VSlider"),lC=Mt()({name:"VSlider",props:Bne(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,start:e=>!0,end:e=>!0},setup(e,t){let{slots:n,emit:r}=t;const i=Xt(),{rtlClasses:a}=Za(),l=nz(e),o=nr(e,"modelValue",void 0,Y=>l.roundValue(Y??l.min.value)),{min:f,max:p,mousePressed:y,roundValue:x,onSliderMousedown:w,onSliderTouchstart:S,trackContainerRef:L,position:D,hasLabels:B,readonly:z}=rz({props:e,steps:l,onSliderStart:()=>{r("start",o.value)},onSliderEnd:Y=>{let{value:K}=Y;const X=x(K);o.value=X,r("end",X)},onSliderMove:Y=>{let{value:K}=Y;return o.value=x(K)},getActiveThumb:()=>{var Y;return(Y=i.value)==null?void 0:Y.$el}}),{isFocused:M,focus:k,blur:V}=Td(e),q=fe(()=>D(o.value));return Bt(()=>{const[Y,K]=ns.filterProps(e),X=!!(e.label||n.label||n.prepend);return H(ns,tn({class:["v-slider",{"v-slider--has-labels":!!n["tick-label"]||B.value,"v-slider--focused":M.value,"v-slider--pressed":y.value,"v-slider--disabled":e.disabled},a.value,e.class],style:e.style},Y,{focused:M.value}),{...n,prepend:X?U=>{var le,ue;return H(Dn,null,[((le=n.label)==null?void 0:le.call(n,U))??(e.label?H($y,{id:U.id.value,class:"v-slider__label",text:e.label},null):void 0),(ue=n.prepend)==null?void 0:ue.call(n,U)])}:void 0,default:U=>{let{id:le,messagesId:ue}=U;return H("div",{class:"v-slider__container",onMousedown:z.value?void 0:w,onTouchstartPassive:z.value?void 0:S},[H("input",{id:le.value,name:e.name||le.value,disabled:!!e.disabled,readonly:!!e.readonly,tabindex:"-1",value:o.value},null),H(iz,{ref:L,start:0,stop:q.value},{"tick-label":n["tick-label"]}),H(sC,{ref:i,"aria-describedby":ue.value,focused:M.value,min:f.value,max:p.value,modelValue:o.value,"onUpdate:modelValue":ae=>o.value=ae,position:q.value,elevation:e.elevation,onFocus:k,onBlur:V},{"thumb-label":n["thumb-label"]})])}})}),{}}}),zne=ht({color:{type:Object},disabled:Boolean,hideAlpha:Boolean,...ln()},"VColorPickerPreview"),Une=Lu({name:"VColorPickerPreview",props:zne(),emits:{"update:color":e=>!0},setup(e,t){let{emit:n}=t;return Bt(()=>{var r,i;return H("div",{class:["v-color-picker-preview",{"v-color-picker-preview--hide-alpha":e.hideAlpha},e.class],style:e.style},[H("div",{class:"v-color-picker-preview__dot"},[H("div",{style:{background:IF(e.color??K_)}},null)]),H("div",{class:"v-color-picker-preview__sliders"},[H(lC,{class:"v-color-picker-preview__track v-color-picker-preview__hue",modelValue:(r=e.color)==null?void 0:r.h,"onUpdate:modelValue":a=>n("update:color",{...e.color??K_,h:a}),step:0,min:0,max:360,disabled:e.disabled,thumbSize:14,trackSize:8,trackFillColor:"white",hideDetails:!0},null),!e.hideAlpha&&H(lC,{class:"v-color-picker-preview__track v-color-picker-preview__alpha",modelValue:((i=e.color)==null?void 0:i.a)??1,"onUpdate:modelValue":a=>n("update:color",{...e.color??K_,a}),step:1/256,min:0,max:1,disabled:e.disabled,thumbSize:14,trackSize:8,trackFillColor:"white",hideDetails:!0},null)])])}),{}}});const Vne=Object.freeze({base:"#f44336",lighten5:"#ffebee",lighten4:"#ffcdd2",lighten3:"#ef9a9a",lighten2:"#e57373",lighten1:"#ef5350",darken1:"#e53935",darken2:"#d32f2f",darken3:"#c62828",darken4:"#b71c1c",accent1:"#ff8a80",accent2:"#ff5252",accent3:"#ff1744",accent4:"#d50000"}),Gne=Object.freeze({base:"#e91e63",lighten5:"#fce4ec",lighten4:"#f8bbd0",lighten3:"#f48fb1",lighten2:"#f06292",lighten1:"#ec407a",darken1:"#d81b60",darken2:"#c2185b",darken3:"#ad1457",darken4:"#880e4f",accent1:"#ff80ab",accent2:"#ff4081",accent3:"#f50057",accent4:"#c51162"}),$ne=Object.freeze({base:"#9c27b0",lighten5:"#f3e5f5",lighten4:"#e1bee7",lighten3:"#ce93d8",lighten2:"#ba68c8",lighten1:"#ab47bc",darken1:"#8e24aa",darken2:"#7b1fa2",darken3:"#6a1b9a",darken4:"#4a148c",accent1:"#ea80fc",accent2:"#e040fb",accent3:"#d500f9",accent4:"#aa00ff"}),jne=Object.freeze({base:"#673ab7",lighten5:"#ede7f6",lighten4:"#d1c4e9",lighten3:"#b39ddb",lighten2:"#9575cd",lighten1:"#7e57c2",darken1:"#5e35b1",darken2:"#512da8",darken3:"#4527a0",darken4:"#311b92",accent1:"#b388ff",accent2:"#7c4dff",accent3:"#651fff",accent4:"#6200ea"}),qne=Object.freeze({base:"#3f51b5",lighten5:"#e8eaf6",lighten4:"#c5cae9",lighten3:"#9fa8da",lighten2:"#7986cb",lighten1:"#5c6bc0",darken1:"#3949ab",darken2:"#303f9f",darken3:"#283593",darken4:"#1a237e",accent1:"#8c9eff",accent2:"#536dfe",accent3:"#3d5afe",accent4:"#304ffe"}),Zne=Object.freeze({base:"#2196f3",lighten5:"#e3f2fd",lighten4:"#bbdefb",lighten3:"#90caf9",lighten2:"#64b5f6",lighten1:"#42a5f5",darken1:"#1e88e5",darken2:"#1976d2",darken3:"#1565c0",darken4:"#0d47a1",accent1:"#82b1ff",accent2:"#448aff",accent3:"#2979ff",accent4:"#2962ff"}),Xne=Object.freeze({base:"#03a9f4",lighten5:"#e1f5fe",lighten4:"#b3e5fc",lighten3:"#81d4fa",lighten2:"#4fc3f7",lighten1:"#29b6f6",darken1:"#039be5",darken2:"#0288d1",darken3:"#0277bd",darken4:"#01579b",accent1:"#80d8ff",accent2:"#40c4ff",accent3:"#00b0ff",accent4:"#0091ea"}),Wne=Object.freeze({base:"#00bcd4",lighten5:"#e0f7fa",lighten4:"#b2ebf2",lighten3:"#80deea",lighten2:"#4dd0e1",lighten1:"#26c6da",darken1:"#00acc1",darken2:"#0097a7",darken3:"#00838f",darken4:"#006064",accent1:"#84ffff",accent2:"#18ffff",accent3:"#00e5ff",accent4:"#00b8d4"}),Hne=Object.freeze({base:"#009688",lighten5:"#e0f2f1",lighten4:"#b2dfdb",lighten3:"#80cbc4",lighten2:"#4db6ac",lighten1:"#26a69a",darken1:"#00897b",darken2:"#00796b",darken3:"#00695c",darken4:"#004d40",accent1:"#a7ffeb",accent2:"#64ffda",accent3:"#1de9b6",accent4:"#00bfa5"}),Yne=Object.freeze({base:"#4caf50",lighten5:"#e8f5e9",lighten4:"#c8e6c9",lighten3:"#a5d6a7",lighten2:"#81c784",lighten1:"#66bb6a",darken1:"#43a047",darken2:"#388e3c",darken3:"#2e7d32",darken4:"#1b5e20",accent1:"#b9f6ca",accent2:"#69f0ae",accent3:"#00e676",accent4:"#00c853"}),Kne=Object.freeze({base:"#8bc34a",lighten5:"#f1f8e9",lighten4:"#dcedc8",lighten3:"#c5e1a5",lighten2:"#aed581",lighten1:"#9ccc65",darken1:"#7cb342",darken2:"#689f38",darken3:"#558b2f",darken4:"#33691e",accent1:"#ccff90",accent2:"#b2ff59",accent3:"#76ff03",accent4:"#64dd17"}),Jne=Object.freeze({base:"#cddc39",lighten5:"#f9fbe7",lighten4:"#f0f4c3",lighten3:"#e6ee9c",lighten2:"#dce775",lighten1:"#d4e157",darken1:"#c0ca33",darken2:"#afb42b",darken3:"#9e9d24",darken4:"#827717",accent1:"#f4ff81",accent2:"#eeff41",accent3:"#c6ff00",accent4:"#aeea00"}),Qne=Object.freeze({base:"#ffeb3b",lighten5:"#fffde7",lighten4:"#fff9c4",lighten3:"#fff59d",lighten2:"#fff176",lighten1:"#ffee58",darken1:"#fdd835",darken2:"#fbc02d",darken3:"#f9a825",darken4:"#f57f17",accent1:"#ffff8d",accent2:"#ffff00",accent3:"#ffea00",accent4:"#ffd600"}),ere=Object.freeze({base:"#ffc107",lighten5:"#fff8e1",lighten4:"#ffecb3",lighten3:"#ffe082",lighten2:"#ffd54f",lighten1:"#ffca28",darken1:"#ffb300",darken2:"#ffa000",darken3:"#ff8f00",darken4:"#ff6f00",accent1:"#ffe57f",accent2:"#ffd740",accent3:"#ffc400",accent4:"#ffab00"}),tre=Object.freeze({base:"#ff9800",lighten5:"#fff3e0",lighten4:"#ffe0b2",lighten3:"#ffcc80",lighten2:"#ffb74d",lighten1:"#ffa726",darken1:"#fb8c00",darken2:"#f57c00",darken3:"#ef6c00",darken4:"#e65100",accent1:"#ffd180",accent2:"#ffab40",accent3:"#ff9100",accent4:"#ff6d00"}),nre=Object.freeze({base:"#ff5722",lighten5:"#fbe9e7",lighten4:"#ffccbc",lighten3:"#ffab91",lighten2:"#ff8a65",lighten1:"#ff7043",darken1:"#f4511e",darken2:"#e64a19",darken3:"#d84315",darken4:"#bf360c",accent1:"#ff9e80",accent2:"#ff6e40",accent3:"#ff3d00",accent4:"#dd2c00"}),rre=Object.freeze({base:"#795548",lighten5:"#efebe9",lighten4:"#d7ccc8",lighten3:"#bcaaa4",lighten2:"#a1887f",lighten1:"#8d6e63",darken1:"#6d4c41",darken2:"#5d4037",darken3:"#4e342e",darken4:"#3e2723"}),ire=Object.freeze({base:"#607d8b",lighten5:"#eceff1",lighten4:"#cfd8dc",lighten3:"#b0bec5",lighten2:"#90a4ae",lighten1:"#78909c",darken1:"#546e7a",darken2:"#455a64",darken3:"#37474f",darken4:"#263238"}),ore=Object.freeze({base:"#9e9e9e",lighten5:"#fafafa",lighten4:"#f5f5f5",lighten3:"#eeeeee",lighten2:"#e0e0e0",lighten1:"#bdbdbd",darken1:"#757575",darken2:"#616161",darken3:"#424242",darken4:"#212121"}),are=Object.freeze({black:"#000000",white:"#ffffff",transparent:"#ffffff00"}),sre=Object.freeze({red:Vne,pink:Gne,purple:$ne,deepPurple:jne,indigo:qne,blue:Zne,lightBlue:Xne,cyan:Wne,teal:Hne,green:Yne,lightGreen:Kne,lime:Jne,yellow:Qne,amber:ere,orange:tre,deepOrange:nre,brown:rre,blueGrey:ire,grey:ore,shades:are}),lre=ht({swatches:{type:Array,default:()=>ure(sre)},disabled:Boolean,color:Object,maxHeight:[Number,String],...ln()},"VColorPickerSwatches");function ure(e){return Object.keys(e).map(t=>{const n=e[t];return n.base?[n.base,n.darken4,n.darken3,n.darken2,n.darken1,n.lighten1,n.lighten2,n.lighten3,n.lighten4,n.lighten5]:[n.black,n.white,n.transparent]})}const cre=Lu({name:"VColorPickerSwatches",props:lre(),emits:{"update:color":e=>!0},setup(e,t){let{emit:n}=t;return Bt(()=>H("div",{class:["v-color-picker-swatches",e.class],style:[{maxHeight:dn(e.maxHeight)},e.style]},[H("div",null,[e.swatches.map(r=>H("div",{class:"v-color-picker-swatches__swatch"},[r.map(i=>{const a=cu(i),l=Kw(a),o=TF(a);return H("div",{class:"v-color-picker-swatches__color",onClick:()=>l&&n("update:color",l)},[H("div",{style:{background:o}},[e.color&&Ry(e.color,l)?H(zi,{size:"x-small",icon:"$success",color:jJ(i,"#FFFFFF")>2?"white":"black"},null):void 0])])})]))])])),{}}});const oz=ht({color:String,...Vl(),...ln(),...Du(),...Sa(),...wd(),...Vy(),...lo(),...or(),...ii()},"VSheet"),uC=Mt()({name:"VSheet",props:oz(),setup(e,t){let{slots:n}=t;const{themeClasses:r}=Ii(e),{backgroundColorClasses:i,backgroundColorStyles:a}=zo(kt(e,"color")),{borderClasses:l}=ku(e),{dimensionStyles:o}=Ru(e),{elevationClasses:f}=rs(e),{locationStyles:p}=Ed(e),{positionClasses:y}=Gy(e),{roundedClasses:x}=ko(e);return Bt(()=>H(e.tag,{class:["v-sheet",r.value,i.value,l.value,f.value,y.value,x.value,e.class],style:[a.value,o.value,p.value,e.style]},n)),{}}}),hre=ht({canvasHeight:{type:[String,Number],default:150},disabled:Boolean,dotSize:{type:[Number,String],default:10},hideCanvas:Boolean,hideSliders:Boolean,hideInputs:Boolean,mode:{type:String,default:"rgba",validator:e=>Object.keys(Rp).includes(e)},modes:{type:Array,default:()=>Object.keys(Rp),validator:e=>Array.isArray(e)&&e.every(t=>Object.keys(Rp).includes(t))},showSwatches:Boolean,swatches:Array,swatchesMaxHeight:{type:[Number,String],default:150},modelValue:{type:[Object,String]},...Mu(oz({width:300}),["height","location","minHeight","maxHeight","minWidth","maxWidth"])},"VColorPicker"),fre=Lu({name:"VColorPicker",props:hre(),emits:{"update:modelValue":e=>!0,"update:mode":e=>!0},setup(e){const t=nr(e,"mode"),n=Xt(null),r=nr(e,"modelValue",void 0,l=>{if(l==null||l==="")return null;let o;try{o=Kw(cu(l))}catch{return null}return n.value&&(o={...o,h:n.value.h},n.value=null),o},l=>l?Pne(l,e.modelValue):null),{rtlClasses:i}=Za(),a=l=>{r.value=l,n.value=l};return bs(()=>{e.modes.includes(t.value)||(t.value=e.modes[0])}),fa({VSlider:{color:void 0,trackColor:void 0,trackFillColor:void 0}}),Bt(()=>{const[l]=uC.filterProps(e);return H(uC,tn({rounded:e.rounded,elevation:e.elevation,theme:e.theme,class:["v-color-picker",i.value,e.class],style:[{"--v-color-picker-color-hsv":IF({...r.value??K_,a:1})},e.style]},l,{maxWidth:e.width}),{default:()=>[!e.hideCanvas&&H(Ine,{key:"canvas",color:r.value,"onUpdate:color":a,disabled:e.disabled,dotSize:e.dotSize,width:e.width,height:e.canvasHeight},null),(!e.hideSliders||!e.hideInputs)&&H("div",{key:"controls",class:"v-color-picker__controls"},[!e.hideSliders&&H(Une,{key:"preview",color:r.value,"onUpdate:color":a,hideAlpha:!t.value.endsWith("a"),disabled:e.disabled},null),!e.hideInputs&&H(Rne,{key:"edit",modes:e.modes,mode:t.value,"onUpdate:mode":o=>t.value=o,color:r.value,"onUpdate:color":a,disabled:e.disabled},null)]),e.showSwatches&&H(cre,{key:"swatches",color:r.value,"onUpdate:color":a,maxHeight:e.swatchesMaxHeight,swatches:e.swatches,disabled:e.disabled},null)]})}),{}}});function dre(e,t,n){if(t==null)return e;if(Array.isArray(t))throw new Error("Multiple matches is not implemented");return typeof t=="number"&&~t?H(Dn,null,[H("span",{class:"v-combobox__unmask"},[e.substr(0,t)]),H("span",{class:"v-combobox__mask"},[e.substr(t,n)]),H("span",{class:"v-combobox__unmask"},[e.substr(t+n)])]):e}const pre=ht({autoSelectFirst:{type:[Boolean,String]},delimiters:Array,...zB({filterKeys:["title"]}),...NP({hideNoData:!0,returnObject:!0}),...Mu(hE({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...cf({transition:!1})},"VCombobox"),gre=Mt()({name:"VCombobox",props:pre(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,t){var Vt;let{emit:n,slots:r}=t;const{t:i}=Ou(),a=Xt(),l=on(!1),o=on(!0),f=on(!1),p=Xt(),y=Xt(),x=nr(e,"menu"),w=fe({get:()=>x.value,set:dt=>{var Jt;x.value&&!dt&&((Jt=p.value)!=null&&Jt.openChildren)||(x.value=dt)}}),S=on(-1);let L=!1;const D=fe(()=>{var dt;return(dt=a.value)==null?void 0:dt.color}),B=fe(()=>w.value?e.closeText:e.openText),{items:z,transformIn:M,transformOut:k}=OP(e),{textColorClasses:V,textColorStyles:q}=xs(D),Y=nr(e,"modelValue",[],dt=>M(Pl(dt)),dt=>{const Jt=k(dt);return e.multiple?Jt:Jt[0]??null}),K=oE(),X=on(e.multiple?"":((Vt=Y.value[0])==null?void 0:Vt.title)??""),U=fe({get:()=>X.value,set:dt=>{var Jt;if(X.value=dt,e.multiple||(Y.value=[Pp(e,dt)]),dt&&e.multiple&&((Jt=e.delimiters)!=null&&Jt.length)){const Ut=dt.split(new RegExp(`(?:${e.delimiters.join("|")})+`));Ut.length>1&&(Ut.forEach(we=>{we=we.trim(),we&&Nt(Pp(e,we))}),X.value="")}dt||(S.value=-1),o.value=!dt}});cn(X,dt=>{L?qi(()=>L=!1):l.value&&!w.value&&(w.value=!0),n("update:search",dt)}),cn(Y,dt=>{var Jt;e.multiple||(X.value=((Jt=dt[0])==null?void 0:Jt.title)??"")});const{filteredItems:le,getMatches:ue}=UB(e,z,()=>o.value?"":U.value),ae=fe(()=>e.hideSelected?le.value.filter(dt=>!Y.value.some(Jt=>Jt.value===dt.value)):le.value),ve=fe(()=>Y.value.map(dt=>dt.value)),Ee=fe(()=>{var Jt;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&U.value===((Jt=ae.value[0])==null?void 0:Jt.title))&&ae.value.length>0&&!o.value&&!f.value}),He=fe(()=>e.hideNoData&&!z.value.length||e.readonly||(K==null?void 0:K.isReadonly.value)),Oe=Xt(),{onListScroll:Ve,onListKeydown:Pe}=kP(Oe,a);function Ke(dt){L=!0,e.openOnClear&&(w.value=!0)}function Be(){He.value||(w.value=!0)}function Ue(dt){He.value||(l.value&&(dt.preventDefault(),dt.stopPropagation()),w.value=!w.value)}function lt(dt){var we;if(e.readonly||K!=null&&K.isReadonly.value)return;const Jt=a.value.selectionStart,Ut=Y.value.length;if((S.value>-1||["Enter","ArrowDown","ArrowUp"].includes(dt.key))&&dt.preventDefault(),["Enter","ArrowDown"].includes(dt.key)&&(w.value=!0),["Escape"].includes(dt.key)&&(w.value=!1),["Enter","Escape","Tab"].includes(dt.key)&&(Ee.value&&["Enter","Tab"].includes(dt.key)&&Nt(le.value[0]),o.value=!0),dt.key==="ArrowDown"&&Ee.value&&((we=Oe.value)==null||we.focus("next")),!!e.multiple){if(["Backspace","Delete"].includes(dt.key)){if(S.value<0){dt.key==="Backspace"&&!U.value&&(S.value=Ut-1);return}const Ce=S.value,je=Y.value[S.value];je&&Nt(je),S.value=Ce>=Ut-1?Ut-2:Ce}if(dt.key==="ArrowLeft"){if(S.value<0&&Jt>0)return;const Ce=S.value>-1?S.value-1:Ut-1;Y.value[Ce]?S.value=Ce:(S.value=-1,a.value.setSelectionRange(U.value.length,U.value.length))}if(dt.key==="ArrowRight"){if(S.value<0)return;const Ce=S.value+1;Y.value[Ce]?S.value=Ce:(S.value=-1,a.value.setSelectionRange(0,0))}dt.key==="Enter"&&U.value&&(Nt(Pp(e,U.value)),U.value="")}}function xt(){var dt;l.value&&(o.value=!0,(dt=a.value)==null||dt.focus())}function Nt(dt){if(e.multiple){const Jt=Y.value.findIndex(Ut=>e.valueComparator(Ut.value,dt.value));if(Jt===-1)Y.value=[...Y.value,dt];else{const Ut=[...Y.value];Ut.splice(Jt,1),Y.value=Ut}U.value=""}else Y.value=[dt],X.value=dt.title,qi(()=>{w.value=!1,o.value=!0})}function Wt(dt){l.value=!0,setTimeout(()=>{f.value=!0})}function Je(dt){f.value=!1}function Kt(dt){(dt==null||dt===""&&!e.multiple)&&(Y.value=[])}return cn(le,dt=>{!dt.length&&e.hideNoData&&(w.value=!1)}),cn(l,(dt,Jt)=>{dt||dt===Jt||(S.value=-1,w.value=!1,Ee.value&&!f.value&&!Y.value.some(Ut=>{let{value:we}=Ut;return we===ae.value[0].value})?Nt(ae.value[0]):e.multiple&&U.value&&(Y.value=[...Y.value,Pp(e,U.value)],U.value=""))}),cn(w,()=>{if(!e.hideSelected&&w.value&&Y.value.length){const dt=ae.value.findIndex(Jt=>Y.value.some(Ut=>e.valueComparator(Ut.value,Jt.value)));Yi&&window.requestAnimationFrame(()=>{var Jt;dt>=0&&((Jt=y.value)==null||Jt.scrollToIndex(dt))})}}),Bt(()=>{const dt=!!(e.chips||r.chip),Jt=!!(!e.hideNoData||ae.value.length||r["prepend-item"]||r["append-item"]||r["no-data"]),Ut=Y.value.length>0,[we]=og.filterProps(e);return H(og,tn({ref:a},we,{modelValue:U.value,"onUpdate:modelValue":[Ce=>U.value=Ce,Kt],focused:l.value,"onUpdate:focused":Ce=>l.value=Ce,validationValue:Y.externalValue,dirty:Ut,class:["v-combobox",{"v-combobox--active-menu":w.value,"v-combobox--chips":!!e.chips,"v-combobox--selection-slot":!!r.selection,"v-combobox--selecting-index":S.value>-1,[`v-combobox--${e.multiple?"multiple":"single"}`]:!0},e.class],style:e.style,readonly:e.readonly,placeholder:Ut?void 0:e.placeholder,"onClick:clear":Ke,"onMousedown:control":Be,onKeydown:lt}),{...r,default:()=>H(Dn,null,[H(lE,tn({ref:p,modelValue:w.value,"onUpdate:modelValue":Ce=>w.value=Ce,activator:"parent",contentClass:"v-combobox__content",disabled:He.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:xt},e.menuProps),{default:()=>[Jt&&H(aE,{ref:Oe,selected:ve.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:Ce=>Ce.preventDefault(),onKeydown:Pe,onFocusin:Wt,onFocusout:Je,onScrollPassive:Ve,tabindex:"-1",color:e.itemColor??e.color},{default:()=>{var Ce,je,nt;return[(Ce=r["prepend-item"])==null?void 0:Ce.call(r),!ae.value.length&&!e.hideNoData&&(((je=r["no-data"])==null?void 0:je.call(r))??H(tf,{title:i(e.noDataText)},null)),H(fE,{ref:y,renderless:!0,items:ae.value},{default:st=>{var Tt;let{item:vt,index:Dt,itemRef:Ct}=st;const Gt=tn(vt.props,{ref:Ct,key:Dt,active:Ee.value&&Dt===0?!0:void 0,onClick:()=>Nt(vt)});return((Tt=r.item)==null?void 0:Tt.call(r,{item:vt,index:Dt,props:Gt}))??H(tf,Gt,{prepend:fn=>{let{isSelected:un}=fn;return H(Dn,null,[e.multiple&&!e.hideSelected?H(wy,{key:vt.value,modelValue:un,ripple:!1,tabindex:"-1"},null):void 0,vt.props.prependIcon&&H(zi,{icon:vt.props.prependIcon},null)])},title:()=>{var fn,un;return o.value?vt.title:dre(vt.title,(fn=ue(vt))==null?void 0:fn.title,((un=U.value)==null?void 0:un.length)??0)}})}}),(nt=r["append-item"])==null?void 0:nt.call(r)]}})]}),Y.value.map((Ce,je)=>{var vt;function nt(Dt){Dt.stopPropagation(),Dt.preventDefault(),Nt(Ce)}const st={"onClick:close":nt,onMousedown(Dt){Dt.preventDefault(),Dt.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return H("div",{key:Ce.value,class:["v-combobox__selection",je===S.value&&["v-combobox__selection--selected",V.value]],style:je===S.value?q.value:{}},[dt?r.chip?H(Mi,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:Ce.title}}},{default:()=>{var Dt;return[(Dt=r.chip)==null?void 0:Dt.call(r,{item:Ce,index:je,props:st})]}}):H(s1,tn({key:"chip",closable:e.closableChips,size:"small",text:Ce.title},st),null):((vt=r.selection)==null?void 0:vt.call(r,{item:Ce,index:je}))??H("span",{class:"v-combobox__selection-text"},[Ce.title,e.multiple&&je<Y.value.length-1&&H("span",{class:"v-combobox__selection-comma"},[au(",")])])])})]),"append-inner":function(){var st;for(var Ce=arguments.length,je=new Array(Ce),nt=0;nt<Ce;nt++)je[nt]=arguments[nt];return H(Dn,null,[(st=r["append-inner"])==null?void 0:st.call(r,...je),(!e.hideNoData||e.items.length)&&e.menuIcon?H(zi,{class:"v-combobox__menu-icon",icon:e.menuIcon,onMousedown:Ue,onClick:_F,"aria-label":i(B.value),title:i(B.value)},null):void 0])}})}),Ic({isFocused:l,isPristine:o,menu:w,search:U,selectionIndex:S,filteredItems:le,select:Nt},a)}});const mre=ht({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...l1({origin:"center center",scrollStrategy:"block",transition:{component:eE},zIndex:2400})},"VDialog"),yre=Mt()({name:"VDialog",props:mre(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const r=nr(e,"modelValue"),{scopeId:i}=jy(),a=Xt();function l(f){var x,w;const p=f.relatedTarget,y=f.target;if(p!==y&&((x=a.value)!=null&&x.contentEl)&&((w=a.value)!=null&&w.globalTop)&&![document,a.value.contentEl].includes(y)&&!a.value.contentEl.contains(y)){const S=O0(a.value.contentEl);if(!S.length)return;const L=S[0],D=S[S.length-1];p===L?D.focus():L.focus()}}Yi&&cn(()=>r.value&&e.retainFocus,f=>{f?document.addEventListener("focusin",l):document.removeEventListener("focusin",l)},{immediate:!0}),cn(r,async f=>{var p,y;await qi(),f?(p=a.value.contentEl)==null||p.focus({preventScroll:!0}):(y=a.value.activatorEl)==null||y.focus({preventScroll:!0})});const o=fe(()=>tn({"aria-haspopup":"dialog","aria-expanded":String(r.value)},e.activatorProps));return Bt(()=>{const[f]=nf.filterProps(e);return H(nf,tn({ref:a,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable},e.class],style:e.style},f,{modelValue:r.value,"onUpdate:modelValue":p=>r.value=p,"aria-modal":"true",activatorProps:o.value,role:"dialog"},i),{activator:n.activator,default:function(){for(var p=arguments.length,y=new Array(p),x=0;x<p;x++)y[x]=arguments[x];return H(Mi,{root:"VDialog"},{default:()=>{var w;return[(w=n.default)==null?void 0:w.call(n,...y)]}})}})}),Ic({},a)}});const B0=Symbol.for("vuetify:v-expansion-panel"),vre=["default","accordion","inset","popout"],_re=ht({color:String,variant:{type:String,default:"default",validator:e=>vre.includes(e)},readonly:Boolean,...ln(),...Fy(),...or(),...ii()},"VExpansionPanels"),xre=Mt()({name:"VExpansionPanels",props:_re(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;yg(e,B0);const{themeClasses:r}=Ii(e),i=fe(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return fa({VExpansionPanel:{color:kt(e,"color")},VExpansionPanelTitle:{readonly:kt(e,"readonly")}}),Bt(()=>H(e.tag,{class:["v-expansion-panels",r.value,i.value,e.class],style:e.style},n)),{}}}),bre=ht({...ln(),...sE()},"VExpansionPanelText"),az=Mt()({name:"VExpansionPanelText",props:bre(),setup(e,t){let{slots:n}=t;const r=Pi(B0);if(!r)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:i,onAfterLeave:a}=DP(e,r.isSelected);return Bt(()=>H(tE,{onAfterLeave:a},{default:()=>{var l;return[go(H("div",{class:["v-expansion-panel-text",e.class],style:e.style},[n.default&&i.value&&H("div",{class:"v-expansion-panel-text__wrapper"},[(l=n.default)==null?void 0:l.call(n)])]),[[Ec,r.isSelected.value]])]}})),{}}}),sz=ht({color:String,expandIcon:{type:Jn,default:"$expand"},collapseIcon:{type:Jn,default:"$collapse"},hideActions:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...ln()},"VExpansionPanelTitle"),lz=Mt()({name:"VExpansionPanelTitle",directives:{Ripple:Sd},props:sz(),setup(e,t){let{slots:n}=t;const r=Pi(B0);if(!r)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:i,backgroundColorStyles:a}=zo(e,"color"),l=fe(()=>({collapseIcon:e.collapseIcon,disabled:r.disabled.value,expanded:r.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly}));return Bt(()=>{var o;return go(H("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":r.isSelected.value},i.value,e.class],style:[a.value,e.style],type:"button",tabindex:r.disabled.value?-1:void 0,disabled:r.disabled.value,"aria-expanded":r.isSelected.value,onClick:e.readonly?void 0:r.toggle},[H("span",{class:"v-expansion-panel-title__overlay"},null),(o=n.default)==null?void 0:o.call(n,l.value),!e.hideActions&&H("span",{class:"v-expansion-panel-title__icon"},[n.actions?n.actions(l.value):H(zi,{icon:r.isSelected.value?e.collapseIcon:e.expandIcon},null)])]),[[Fl("ripple"),e.ripple]])}),{}}}),wre=ht({title:String,text:String,bgColor:String,...ln(),...Sa(),...By(),...sE(),...lo(),...or(),...sz()},"VExpansionPanel"),Ere=Mt()({name:"VExpansionPanel",props:wre(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:n}=t;const r=zy(e,B0),{backgroundColorClasses:i,backgroundColorStyles:a}=zo(e,"bgColor"),{elevationClasses:l}=rs(e),{roundedClasses:o}=ko(e),f=fe(()=>(r==null?void 0:r.disabled.value)||e.disabled),p=fe(()=>r.group.items.value.reduce((w,S,L)=>(r.group.selected.value.includes(S.id)&&w.push(L),w),[])),y=fe(()=>{const w=r.group.items.value.findIndex(S=>S.id===r.id);return!r.isSelected.value&&p.value.some(S=>S-w===1)}),x=fe(()=>{const w=r.group.items.value.findIndex(S=>S.id===r.id);return!r.isSelected.value&&p.value.some(S=>S-w===-1)});return da(B0,r),fa({VExpansionPanelText:{eager:kt(e,"eager")}}),Bt(()=>{const w=!!(n.text||e.text),S=!!(n.title||e.title);return H(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":r.isSelected.value,"v-expansion-panel--before-active":y.value,"v-expansion-panel--after-active":x.value,"v-expansion-panel--disabled":f.value},o.value,i.value,e.class],style:[a.value,e.style]},{default:()=>{var L;return[H("div",{class:["v-expansion-panel__shadow",...l.value]},null),S&&H(lz,{key:"title",collapseIcon:e.collapseIcon,color:e.color,expandIcon:e.expandIcon,hideActions:e.hideActions,ripple:e.ripple},{default:()=>[n.title?n.title():e.title]}),w&&H(az,{key:"text"},{default:()=>[n.text?n.text():e.text]}),(L=n.default)==null?void 0:L.call(n)]}})}),{}}});const Sre=ht({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,showSize:{type:[Boolean,Number],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(e)},...ff({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:e=>Pl(e).every(t=>t!=null&&typeof t=="object")},...cE({clearable:!0})},"VFileInput"),Tre=Mt()({name:"VFileInput",inheritAttrs:!1,props:Sre(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{attrs:n,emit:r,slots:i}=t;const{t:a}=Ou(),l=nr(e,"modelValue"),{isFocused:o,focus:f,blur:p}=Td(e),y=fe(()=>typeof e.showSize!="boolean"?e.showSize:void 0),x=fe(()=>(l.value??[]).reduce((U,le)=>{let{size:ue=0}=le;return U+ue},0)),w=fe(()=>P3(x.value,y.value)),S=fe(()=>(l.value??[]).map(U=>{const{name:le="",size:ue=0}=U;return e.showSize?`${le} (${P3(ue,y.value)})`:le})),L=fe(()=>{var le;const U=((le=l.value)==null?void 0:le.length)??0;return e.showSize?a(e.counterSizeString,U,w.value):a(e.counterString,U)}),D=Xt(),B=Xt(),z=Xt(),M=fe(()=>o.value||e.active),k=fe(()=>["plain","underlined"].includes(e.variant));function V(){var U;z.value!==document.activeElement&&((U=z.value)==null||U.focus()),o.value||f()}function q(U){K(U)}function Y(U){r("mousedown:control",U)}function K(U){var le;(le=z.value)==null||le.click(),r("click:control",U)}function X(U){U.stopPropagation(),V(),qi(()=>{l.value=[],uP(e["onClick:clear"],U)})}return cn(l,U=>{(!Array.isArray(U)||!U.length)&&z.value&&(z.value.value="")}),Bt(()=>{const U=!!(i.counter||e.counter),le=!!(U||i.details),[ue,ae]=fg(n),[{modelValue:ve,...Ee}]=ns.filterProps(e),[He]=RP(e);return H(ns,tn({ref:D,modelValue:l.value,"onUpdate:modelValue":Oe=>l.value=Oe,class:["v-file-input",{"v-text-field--plain-underlined":k.value},e.class],style:e.style,"onClick:prepend":q},ue,Ee,{centerAffix:!k.value,focused:o.value}),{...i,default:Oe=>{let{id:Ve,isDisabled:Pe,isDirty:Ke,isReadonly:Be,isValid:Ue}=Oe;return H(u1,tn({ref:B,"prepend-icon":e.prependIcon,onMousedown:Y,onClick:K,"onClick:clear":X,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},He,{id:Ve.value,active:M.value||Ke.value,dirty:Ke.value,disabled:Pe.value,focused:o.value,error:Ue.value===!1}),{...i,default:lt=>{var Wt;let{props:{class:xt,...Nt}}=lt;return H(Dn,null,[H("input",tn({ref:z,type:"file",readonly:Be.value,disabled:Pe.value,multiple:e.multiple,name:e.name,onClick:Je=>{Je.stopPropagation(),Be.value&&Je.preventDefault(),V()},onChange:Je=>{if(!Je.target)return;const Kt=Je.target;l.value=[...Kt.files??[]]},onFocus:V,onBlur:p},Nt,ae),null),H("div",{class:xt},[!!((Wt=l.value)!=null&&Wt.length)&&(i.selection?i.selection({fileNames:S.value,totalBytes:x.value,totalBytesReadable:w.value}):e.chips?S.value.map(Je=>H(s1,{key:Je,size:"small",color:e.color},{default:()=>[Je]})):S.value.join(", "))])])}})},details:le?Oe=>{var Ve,Pe;return H(Dn,null,[(Ve=i.details)==null?void 0:Ve.call(i,Oe),U&&H(Dn,null,[H("span",null,null),H(uE,{active:!!((Pe=l.value)!=null&&Pe.length),value:L.value},i.counter)])])}:void 0})}),Ic({},D,B,z)}});const Ire=ht({app:Boolean,color:String,height:{type:[Number,String],default:"auto"},...Vl(),...ln(),...Sa(),...ky(),...lo(),...or({tag:"footer"}),...ii()},"VFooter"),Cre=Mt()({name:"VFooter",props:Ire(),setup(e,t){let{slots:n}=t;const{themeClasses:r}=Ii(e),{backgroundColorClasses:i,backgroundColorStyles:a}=zo(kt(e,"color")),{borderClasses:l}=ku(e),{elevationClasses:o}=rs(e),{roundedClasses:f}=ko(e),p=on(32),{resizeRef:y}=lh(S=>{S.length&&(p.value=S[0].target.clientHeight)}),x=fe(()=>e.height==="auto"?p.value:parseInt(e.height,10)),{layoutItemStyles:w}=Ny({id:e.name,order:fe(()=>parseInt(e.order,10)),position:fe(()=>"bottom"),layoutSize:x,elementSize:fe(()=>e.height==="auto"?void 0:x.value),active:fe(()=>e.app),absolute:kt(e,"absolute")});return Bt(()=>H(e.tag,{ref:y,class:["v-footer",r.value,i.value,l.value,o.value,f.value,e.class],style:[a.value,e.app?w.value:{height:dn(e.height)},e.style]},n)),{}}}),Pre=ht({...ln(),...zee()},"VForm"),Are=Mt()({name:"VForm",props:Pre(),emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,t){let{slots:n,emit:r}=t;const i=Uee(e),a=Xt();function l(f){f.preventDefault(),i.reset()}function o(f){const p=f,y=i.validate();p.then=y.then.bind(y),p.catch=y.catch.bind(y),p.finally=y.finally.bind(y),r("submit",p),p.defaultPrevented||y.then(x=>{var S;let{valid:w}=x;w&&((S=a.value)==null||S.submit())}),p.preventDefault()}return Bt(()=>{var f;return H("form",{ref:a,class:["v-form",e.class],style:e.style,novalidate:!0,onReset:l,onSubmit:o},[(f=n.default)==null?void 0:f.call(n,i)])}),Ic(i,a)}});const Mre=ht({fluid:{type:Boolean,default:!1},...ln(),...or()},"VContainer"),Lre=Mt()({name:"VContainer",props:Mre(),setup(e,t){let{slots:n}=t;const{rtlClasses:r}=Za();return Bt(()=>H(e.tag,{class:["v-container",{"v-container--fluid":e.fluid},r.value,e.class],style:e.style},n)),{}}}),uz=(()=>Jw.reduce((e,t)=>(e[t]={type:[Boolean,String,Number],default:!1},e),{}))(),cz=(()=>Jw.reduce((e,t)=>{const n="offset"+rf(t);return e[n]={type:[String,Number],default:null},e},{}))(),hz=(()=>Jw.reduce((e,t)=>{const n="order"+rf(t);return e[n]={type:[String,Number],default:null},e},{}))(),dR={col:Object.keys(uz),offset:Object.keys(cz),order:Object.keys(hz)};function Ore(e,t,n){let r=e;if(!(n==null||n===!1)){if(t){const i=t.replace(e,"");r+=`-${i}`}return e==="col"&&(r="v-"+r),e==="col"&&(n===""||n===!0)||(r+=`-${n}`),r.toLowerCase()}}const Dre=["auto","start","end","center","baseline","stretch"],Rre=ht({cols:{type:[Boolean,String,Number],default:!1},...uz,offset:{type:[String,Number],default:null},...cz,order:{type:[String,Number],default:null},...hz,alignSelf:{type:String,default:null,validator:e=>Dre.includes(e)},...ln(),...or()},"VCol"),kre=Mt()({name:"VCol",props:Rre(),setup(e,t){let{slots:n}=t;const r=fe(()=>{const i=[];let a;for(a in dR)dR[a].forEach(o=>{const f=e[o],p=Ore(a,o,f);p&&i.push(p)});const l=i.some(o=>o.startsWith("v-col-"));return i.push({"v-col":!l||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),i});return()=>{var i;return vd(e.tag,{class:[r.value,e.class],style:e.style},(i=n.default)==null?void 0:i.call(n))}}}),zP=["start","end","center"],fz=["space-between","space-around","space-evenly"];function UP(e,t){return Jw.reduce((n,r)=>{const i=e+rf(r);return n[i]=t(),n},{})}const Nre=[...zP,"baseline","stretch"],dz=e=>Nre.includes(e),pz=UP("align",()=>({type:String,default:null,validator:dz})),Fre=[...zP,...fz],gz=e=>Fre.includes(e),mz=UP("justify",()=>({type:String,default:null,validator:gz})),Bre=[...zP,...fz,"stretch"],yz=e=>Bre.includes(e),vz=UP("alignContent",()=>({type:String,default:null,validator:yz})),pR={align:Object.keys(pz),justify:Object.keys(mz),alignContent:Object.keys(vz)},zre={align:"align",justify:"justify",alignContent:"align-content"};function Ure(e,t,n){let r=zre[e];if(n!=null){if(t){const i=t.replace(e,"");r+=`-${i}`}return r+=`-${n}`,r.toLowerCase()}}const Vre=ht({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:dz},...pz,justify:{type:String,default:null,validator:gz},...mz,alignContent:{type:String,default:null,validator:yz},...vz,...ln(),...or()},"VRow"),Gre=Mt()({name:"VRow",props:Vre(),setup(e,t){let{slots:n}=t;const r=fe(()=>{const i=[];let a;for(a in pR)pR[a].forEach(l=>{const o=e[l],f=Ure(a,l,o);f&&i.push(f)});return i.push({"v-row--no-gutters":e.noGutters,"v-row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),i});return()=>{var i;return vd(e.tag,{class:["v-row",r.value,e.class],style:e.style},(i=n.default)==null?void 0:i.call(n))}}}),$re=Tc("v-spacer","div","VSpacer"),jre=ht({disabled:Boolean,modelValue:{type:Boolean,default:void 0},...DB()},"VHover"),qre=Mt()({name:"VHover",props:jre(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const r=nr(e,"modelValue"),{runOpenDelay:i,runCloseDelay:a}=RB(e,l=>!e.disabled&&(r.value=l));return()=>{var l;return(l=n.default)==null?void 0:l.call(n,{isHovering:r.value,props:{onMouseenter:i,onMouseleave:a}})}}});const _z=Symbol.for("vuetify:v-item-group"),Zre=ht({...ln(),...Fy({selectedClass:"v-item--selected"}),...or(),...ii()},"VItemGroup"),Xre=Mt()({name:"VItemGroup",props:Zre(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{themeClasses:r}=Ii(e),{isSelected:i,select:a,next:l,prev:o,selected:f}=yg(e,_z);return()=>H(e.tag,{class:["v-item-group",r.value,e.class],style:e.style},{default:()=>{var p;return[(p=n.default)==null?void 0:p.call(n,{isSelected:i,select:a,next:l,prev:o,selected:f.value})]}})}}),Wre=Mt()({name:"VItem",props:By(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:n}=t;const{isSelected:r,select:i,toggle:a,selectedClass:l,value:o,disabled:f}=zy(e,_z);return()=>{var p;return(p=n.default)==null?void 0:p.call(n,{isSelected:r.value,selectedClass:l.value,select:i,toggle:a,value:o.value,disabled:f.value})}}});const Hre=Tc("v-kbd");const Yre=ht({...ln(),...UF()},"VLayout"),Kre=Mt()({name:"VLayout",props:Yre(),setup(e,t){let{slots:n}=t;const{layoutClasses:r,layoutStyles:i,getLayoutItem:a,items:l,layoutRef:o}=VF(e);return Bt(()=>{var f;return H("div",{ref:o,class:[r.value,e.class],style:[i.value,e.style]},[(f=n.default)==null?void 0:f.call(n)])}),{getLayoutItem:a,items:l}}});const Jre=ht({position:{type:String,required:!0},size:{type:[Number,String],default:300},modelValue:Boolean,...ln(),...ky()},"VLayoutItem"),Qre=Mt()({name:"VLayoutItem",props:Jre(),setup(e,t){let{slots:n}=t;const{layoutItemStyles:r}=Ny({id:e.name,order:fe(()=>parseInt(e.order,10)),position:kt(e,"position"),elementSize:kt(e,"size"),layoutSize:kt(e,"size"),active:kt(e,"modelValue"),absolute:kt(e,"absolute")});return()=>{var i;return H("div",{class:["v-layout-item",e.class],style:[r.value,e.style]},[(i=n.default)==null?void 0:i.call(n)])}}}),eie=ht({modelValue:Boolean,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},...ln(),...Du(),...or(),...cf({transition:"fade-transition"})},"VLazy"),tie=Mt()({name:"VLazy",directives:{intersect:i1},props:eie(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{dimensionStyles:r}=Ru(e),i=nr(e,"modelValue");function a(l){i.value||(i.value=l)}return Bt(()=>go(H(e.tag,{class:["v-lazy",e.class],style:[r.value,e.style]},{default:()=>[i.value&&H(uc,{transition:e.transition,appear:!0},{default:()=>{var l;return[(l=n.default)==null?void 0:l.call(n)]}})]}),[[Fl("intersect"),{handler:a,options:e.options},null]])),{}}});const nie=ht({locale:String,fallbackLocale:String,messages:Object,rtl:{type:Boolean,default:void 0},...ln()},"VLocaleProvider"),rie=Mt()({name:"VLocaleProvider",props:nie(),setup(e,t){let{slots:n}=t;const{rtlClasses:r}=fQ(e);return Bt(()=>{var i;return H("div",{class:["v-locale-provider",r.value,e.class],style:e.style},[(i=n.default)==null?void 0:i.call(n)])}),{}}});const iie=ht({scrollable:Boolean,...ln(),...or({tag:"main"})},"VMain"),oie=Mt()({name:"VMain",props:iie(),setup(e,t){let{slots:n}=t;const{mainStyles:r}=UQ(),{ssrBootStyles:i}=pg();return Bt(()=>H(e.tag,{class:["v-main",{"v-main--scrollable":e.scrollable},e.class],style:[r.value,i.value,e.style]},{default:()=>{var a,l;return[e.scrollable?H("div",{class:"v-main__scroller"},[(a=n.default)==null?void 0:a.call(n)]):(l=n.default)==null?void 0:l.call(n)]}})),{}}});function aie(e){let{rootEl:t,isSticky:n,layoutItemStyles:r}=e;const i=on(!1),a=on(0),l=fe(()=>{const p=typeof i.value=="boolean"?"top":i.value;return[n.value?{top:"auto",bottom:"auto",height:void 0}:void 0,i.value?{[p]:dn(a.value)}:{top:r.value.top}]});bs(()=>{cn(n,p=>{p?window.addEventListener("scroll",f,{passive:!0}):window.removeEventListener("scroll",f)},{immediate:!0})}),Us(()=>{window.removeEventListener("scroll",f)});let o=0;function f(){const p=o>window.scrollY?"up":"down",y=t.value.getBoundingClientRect(),x=parseFloat(r.value.top??0),w=window.scrollY-Math.max(0,a.value-x),S=y.height+Math.max(a.value,x)-window.scrollY-window.innerHeight,L=parseFloat(getComputedStyle(t.value).getPropertyValue("--v-body-scroll-y"))||0;y.height<window.innerHeight-x?(i.value="top",a.value=x):p==="up"&&i.value==="bottom"||p==="down"&&i.value==="top"?(a.value=window.scrollY+y.top-L,i.value=!0):p==="down"&&S<=0?(a.value=0,i.value="bottom"):p==="up"&&w<=0&&(L?i.value!=="top"&&(a.value=-w+L+x,i.value="top"):(a.value=y.top+w,i.value="top")),o=window.scrollY}return{isStuck:i,stickyStyles:l}}const sie=100,lie=20;function gR(e){const t=1.41421356237;return(e<0?-1:1)*Math.sqrt(Math.abs(e))*t}function mR(e){if(e.length<2)return 0;if(e.length===2)return e[1].t===e[0].t?0:(e[1].d-e[0].d)/(e[1].t-e[0].t);let t=0;for(let n=e.length-1;n>0;n--){if(e[n].t===e[n-1].t)continue;const r=gR(t),i=(e[n].d-e[n-1].d)/(e[n].t-e[n-1].t);t+=(i-r)*Math.abs(i),n===e.length-1&&(t*=.5)}return gR(t)*1e3}function uie(){const e={};function t(i){Array.from(i.changedTouches).forEach(a=>{(e[a.identifier]??(e[a.identifier]=new xJ(lie))).push([i.timeStamp,a])})}function n(i){Array.from(i.changedTouches).forEach(a=>{delete e[a.identifier]})}function r(i){var p;const a=(p=e[i])==null?void 0:p.values().reverse();if(!a)throw new Error(`No samples for touch id ${i}`);const l=a[0],o=[],f=[];for(const y of a){if(l[0]-y[0]>sie)break;o.push({t:y[0],d:y[1].clientX}),f.push({t:y[0],d:y[1].clientY})}return{x:mR(o),y:mR(f),get direction(){const{x:y,y:x}=this,[w,S]=[Math.abs(y),Math.abs(x)];return w>S&&y>=0?"right":w>S&&y<=0?"left":S>w&&x>=0?"down":S>w&&x<=0?"up":cie()}}}return{addMovement:t,endTouch:n,getVelocity:r}}function cie(){throw new Error}function hie(e){let{isActive:t,isTemporary:n,width:r,touchless:i,position:a}=e;bs(()=>{window.addEventListener("touchstart",z,{passive:!0}),window.addEventListener("touchmove",M,{passive:!1}),window.addEventListener("touchend",k,{passive:!0})}),Us(()=>{window.removeEventListener("touchstart",z),window.removeEventListener("touchmove",M),window.removeEventListener("touchend",k)});const l=fe(()=>["left","right"].includes(a.value)),{addMovement:o,endTouch:f,getVelocity:p}=uie();let y=!1;const x=on(!1),w=on(0),S=on(0);let L;function D(q,Y){return(a.value==="left"?q:a.value==="right"?document.documentElement.clientWidth-q:a.value==="top"?q:a.value==="bottom"?document.documentElement.clientHeight-q:Tm())-(Y?r.value:0)}function B(q){let Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const K=a.value==="left"?(q-S.value)/r.value:a.value==="right"?(document.documentElement.clientWidth-q-S.value)/r.value:a.value==="top"?(q-S.value)/r.value:a.value==="bottom"?(document.documentElement.clientHeight-q-S.value)/r.value:Tm();return Y?Math.max(0,Math.min(1,K)):K}function z(q){if(i.value)return;const Y=q.changedTouches[0].clientX,K=q.changedTouches[0].clientY,X=25,U=a.value==="left"?Y<X:a.value==="right"?Y>document.documentElement.clientWidth-X:a.value==="top"?K<X:a.value==="bottom"?K>document.documentElement.clientHeight-X:Tm(),le=t.value&&(a.value==="left"?Y<r.value:a.value==="right"?Y>document.documentElement.clientWidth-r.value:a.value==="top"?K<r.value:a.value==="bottom"?K>document.documentElement.clientHeight-r.value:Tm());(U||le||t.value&&n.value)&&(y=!0,L=[Y,K],S.value=D(l.value?Y:K,t.value),w.value=B(l.value?Y:K),f(q),o(q))}function M(q){const Y=q.changedTouches[0].clientX,K=q.changedTouches[0].clientY;if(y){if(!q.cancelable){y=!1;return}const U=Math.abs(Y-L[0]),le=Math.abs(K-L[1]);(l.value?U>le&&U>3:le>U&&le>3)?(x.value=!0,y=!1):(l.value?le:U)>3&&(y=!1)}if(!x.value)return;q.preventDefault(),o(q);const X=B(l.value?Y:K,!1);w.value=Math.max(0,Math.min(1,X)),X>1?S.value=D(l.value?Y:K,!0):X<0&&(S.value=D(l.value?Y:K,!1))}function k(q){if(y=!1,!x.value)return;o(q),x.value=!1;const Y=p(q.changedTouches[0].identifier),K=Math.abs(Y.x),X=Math.abs(Y.y);(l.value?K>X&&K>400:X>K&&X>3)?t.value=Y.direction===({left:"right",right:"left",top:"down",bottom:"up"}[a.value]||Tm()):t.value=w.value>.5}const V=fe(()=>x.value?{transform:a.value==="left"?`translateX(calc(-100% + ${w.value*r.value}px))`:a.value==="right"?`translateX(calc(100% - ${w.value*r.value}px))`:a.value==="top"?`translateY(calc(-100% + ${w.value*r.value}px))`:a.value==="bottom"?`translateY(calc(100% - ${w.value*r.value}px))`:Tm(),transition:"none"}:void 0);return{isDragging:x,dragProgress:w,dragStyles:V}}function Tm(){throw new Error}const fie=["start","end","left","right","top","bottom"],die=ht({color:String,disableResizeWatcher:Boolean,disableRouteWatcher:Boolean,expandOnHover:Boolean,floating:Boolean,modelValue:{type:Boolean,default:null},permanent:Boolean,rail:{type:Boolean,default:null},railWidth:{type:[Number,String],default:56},scrim:{type:[Boolean,String],default:!0},image:String,temporary:Boolean,touchless:Boolean,width:{type:[Number,String],default:256},location:{type:String,default:"start",validator:e=>fie.includes(e)},sticky:Boolean,...Vl(),...ln(),...Sa(),...ky(),...lo(),...or({tag:"nav"}),...ii()},"VNavigationDrawer"),pie=Mt()({name:"VNavigationDrawer",props:die(),emits:{"update:modelValue":e=>!0,"update:rail":e=>!0},setup(e,t){let{attrs:n,emit:r,slots:i}=t;const{isRtl:a}=Za(),{themeClasses:l}=Ii(e),{borderClasses:o}=ku(e),{backgroundColorClasses:f,backgroundColorStyles:p}=zo(kt(e,"color")),{elevationClasses:y}=rs(e),{mobile:x}=dg(),{roundedClasses:w}=ko(e),S=JF(),L=nr(e,"modelValue",null,Ke=>!!Ke),{ssrBootStyles:D}=pg(),{scopeId:B}=jy(),z=Xt(),M=on(!1),k=fe(()=>e.rail&&e.expandOnHover&&M.value?Number(e.width):Number(e.rail?e.railWidth:e.width)),V=fe(()=>BI(e.location,a.value)),q=fe(()=>!e.permanent&&(x.value||e.temporary)),Y=fe(()=>e.sticky&&!q.value&&V.value!=="bottom");e.expandOnHover&&e.rail!=null&&cn(M,Ke=>r("update:rail",!Ke)),e.disableResizeWatcher||cn(q,Ke=>!e.permanent&&qi(()=>L.value=!Ke)),!e.disableRouteWatcher&&S&&cn(S.currentRoute,()=>q.value&&(L.value=!1)),cn(()=>e.permanent,Ke=>{Ke&&(L.value=!0)}),gw(()=>{e.modelValue!=null||q.value||(L.value=e.permanent||!x.value)});const{isDragging:K,dragProgress:X,dragStyles:U}=hie({isActive:L,isTemporary:q,width:k,touchless:kt(e,"touchless"),position:V}),le=fe(()=>{const Ke=q.value?0:e.rail&&e.expandOnHover?Number(e.railWidth):k.value;return K.value?Ke*X.value:Ke}),{layoutItemStyles:ue,layoutItemScrimStyles:ae}=Ny({id:e.name,order:fe(()=>parseInt(e.order,10)),position:V,layoutSize:le,elementSize:k,active:fe(()=>L.value||K.value),disableTransitions:fe(()=>K.value),absolute:fe(()=>e.absolute||Y.value&&typeof ve.value!="string")}),{isStuck:ve,stickyStyles:Ee}=aie({rootEl:z,isSticky:Y,layoutItemStyles:ue}),He=zo(fe(()=>typeof e.scrim=="string"?e.scrim:null)),Oe=fe(()=>({...K.value?{opacity:X.value*.2,transition:"none"}:void 0,...ae.value}));fa({VList:{bgColor:"transparent"}});function Ve(){M.value=!0}function Pe(){M.value=!1}return Bt(()=>{const Ke=i.image||e.image;return H(Dn,null,[H(e.tag,tn({ref:z,onMouseenter:Ve,onMouseleave:Pe,class:["v-navigation-drawer",`v-navigation-drawer--${V.value}`,{"v-navigation-drawer--expand-on-hover":e.expandOnHover,"v-navigation-drawer--floating":e.floating,"v-navigation-drawer--is-hovering":M.value,"v-navigation-drawer--rail":e.rail,"v-navigation-drawer--temporary":q.value,"v-navigation-drawer--active":L.value,"v-navigation-drawer--sticky":Y.value},l.value,f.value,o.value,y.value,w.value,e.class],style:[p.value,ue.value,U.value,D.value,Ee.value,e.style]},B,n),{default:()=>{var Be,Ue,lt,xt;return[Ke&&H("div",{key:"image",class:"v-navigation-drawer__img"},[i.image?(Be=i.image)==null?void 0:Be.call(i,{image:e.image}):H("img",{src:e.image,alt:""},null)]),i.prepend&&H("div",{class:"v-navigation-drawer__prepend"},[(Ue=i.prepend)==null?void 0:Ue.call(i)]),H("div",{class:"v-navigation-drawer__content"},[(lt=i.default)==null?void 0:lt.call(i)]),i.append&&H("div",{class:"v-navigation-drawer__append"},[(xt=i.append)==null?void 0:xt.call(i)])]}}),H(Qc,{name:"fade-transition"},{default:()=>[q.value&&(K.value||L.value)&&!!e.scrim&&H("div",tn({class:["v-navigation-drawer__scrim",He.backgroundColorClasses.value],style:[Oe.value,He.backgroundColorStyles.value],onClick:()=>L.value=!1},B),null)]})])}),{isStuck:ve}}}),gie=Lu({name:"VNoSsr",setup(e,t){let{slots:n}=t;const r=kB();return()=>{var i;return r.value&&((i=n.default)==null?void 0:i.call(n))}}});function mie(){const e=Xt([]);rk(()=>e.value=[]);function t(n,r){e.value[r]=n}return{refs:e,updateRef:t}}const yie=ht({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:Jn,default:"$first"},prevIcon:{type:Jn,default:"$prev"},nextIcon:{type:Jn,default:"$next"},lastIcon:{type:Jn,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...Vl(),...ln(),...Ta(),...Sa(),...lo(),...hf(),...or({tag:"nav"}),...ii(),...Nu({variant:"text"})},"VPagination"),vie=Mt()({name:"VPagination",props:yie(),emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,t){let{slots:n,emit:r}=t;const i=nr(e,"modelValue"),{t:a,n:l}=Ou(),{isRtl:o}=Za(),{themeClasses:f}=Ii(e),{width:p}=dg(),y=on(-1);fa(void 0,{scoped:!0});const{resizeRef:x}=lh(X=>{if(!X.length)return;const{target:U,contentRect:le}=X[0],ue=U.querySelector(".v-pagination__list > *");if(!ue)return;const ae=le.width,ve=ue.offsetWidth+parseFloat(getComputedStyle(ue).marginRight)*2;y.value=D(ae,ve)}),w=fe(()=>parseInt(e.length,10)),S=fe(()=>parseInt(e.start,10)),L=fe(()=>e.totalVisible?parseInt(e.totalVisible,10):y.value>=0?y.value:D(p.value,58));function D(X,U){const le=e.showFirstLastPage?5:3;return Math.max(0,Math.floor(+((X-U*le)/U).toFixed(2)))}const B=fe(()=>{if(w.value<=0||isNaN(w.value)||w.value>Number.MAX_SAFE_INTEGER)return[];if(L.value<=1)return[i.value];if(w.value<=L.value)return Fh(w.value,S.value);const X=L.value%2===0,U=X?L.value/2:Math.floor(L.value/2),le=X?U:U+1,ue=w.value-U;if(le-i.value>=0)return[...Fh(Math.max(1,L.value-1),S.value),e.ellipsis,w.value];if(i.value-ue>=(X?1:0)){const ae=L.value-1,ve=w.value-ae+S.value;return[S.value,e.ellipsis,...Fh(ae,ve)]}else{const ae=Math.max(1,L.value-3),ve=ae===1?i.value:i.value-Math.ceil(ae/2)+S.value;return[S.value,e.ellipsis,...Fh(ae,ve),e.ellipsis,w.value]}});function z(X,U,le){X.preventDefault(),i.value=U,le&&r(le,U)}const{refs:M,updateRef:k}=mie();fa({VPaginationBtn:{color:kt(e,"color"),border:kt(e,"border"),density:kt(e,"density"),size:kt(e,"size"),variant:kt(e,"variant"),rounded:kt(e,"rounded"),elevation:kt(e,"elevation")}});const V=fe(()=>B.value.map((X,U)=>{const le=ue=>k(ue,U);if(typeof X=="string")return{isActive:!1,key:`ellipsis-${U}`,page:X,props:{ref:le,ellipsis:!0,icon:!0,disabled:!0}};{const ue=X===i.value;return{isActive:ue,key:X,page:l(X),props:{ref:le,ellipsis:!1,icon:!0,disabled:!!e.disabled||+e.length<2,color:ue?e.activeColor:e.color,ariaCurrent:ue,ariaLabel:a(ue?e.currentPageAriaLabel:e.pageAriaLabel,X),onClick:ae=>z(ae,X)}}}})),q=fe(()=>{const X=!!e.disabled||i.value<=S.value,U=!!e.disabled||i.value>=S.value+w.value-1;return{first:e.showFirstLastPage?{icon:o.value?e.lastIcon:e.firstIcon,onClick:le=>z(le,S.value,"first"),disabled:X,ariaLabel:a(e.firstAriaLabel),ariaDisabled:X}:void 0,prev:{icon:o.value?e.nextIcon:e.prevIcon,onClick:le=>z(le,i.value-1,"prev"),disabled:X,ariaLabel:a(e.previousAriaLabel),ariaDisabled:X},next:{icon:o.value?e.prevIcon:e.nextIcon,onClick:le=>z(le,i.value+1,"next"),disabled:U,ariaLabel:a(e.nextAriaLabel),ariaDisabled:U},last:e.showFirstLastPage?{icon:o.value?e.firstIcon:e.lastIcon,onClick:le=>z(le,S.value+w.value-1,"last"),disabled:U,ariaLabel:a(e.lastAriaLabel),ariaDisabled:U}:void 0}});function Y(){var U;const X=i.value-S.value;(U=M.value[X])==null||U.$el.focus()}function K(X){X.key===NI.left&&!e.disabled&&i.value>+e.start?(i.value=i.value-1,qi(Y)):X.key===NI.right&&!e.disabled&&i.value<S.value+w.value-1&&(i.value=i.value+1,qi(Y))}return Bt(()=>H(e.tag,{ref:x,class:["v-pagination",f.value,e.class],style:e.style,role:"navigation","aria-label":a(e.ariaLabel),onKeydown:K,"data-test":"v-pagination-root"},{default:()=>[H("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&H("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[n.first?n.first(q.value.first):H(Ls,tn({_as:"VPaginationBtn"},q.value.first),null)]),H("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[n.prev?n.prev(q.value.prev):H(Ls,tn({_as:"VPaginationBtn"},q.value.prev),null)]),V.value.map((X,U)=>H("li",{key:X.key,class:["v-pagination__item",{"v-pagination__item--is-active":X.isActive}],"data-test":"v-pagination-item"},[n.item?n.item(X):H(Ls,tn({_as:"VPaginationBtn"},X.props),{default:()=>[X.page]})])),H("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[n.next?n.next(q.value.next):H(Ls,tn({_as:"VPaginationBtn"},q.value.next),null)]),e.showFirstLastPage&&H("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[n.last?n.last(q.value.last):H(Ls,tn({_as:"VPaginationBtn"},q.value.last),null)])])]})),{}}});function _ie(e){return Math.floor(Math.abs(e))*Math.sign(e)}const xie=ht({scale:{type:[Number,String],default:.5},...ln()},"VParallax"),bie=Mt()({name:"VParallax",props:xie(),setup(e,t){let{slots:n}=t;const{intersectionRef:r,isIntersecting:i}=SP(),{resizeRef:a,contentRect:l}=lh(),{height:o}=dg(),f=Xt();Nl(()=>{var S;r.value=a.value=(S=f.value)==null?void 0:S.$el});let p;cn(i,S=>{S?(p=dP(r.value),p=p===document.scrollingElement?document:p,p.addEventListener("scroll",w,{passive:!0}),w()):p.removeEventListener("scroll",w)}),Us(()=>{p==null||p.removeEventListener("scroll",w)}),cn(o,w),cn(()=>{var S;return(S=l.value)==null?void 0:S.height},w);const y=fe(()=>1-ps(+e.scale));let x=-1;function w(){i.value&&(cancelAnimationFrame(x),x=requestAnimationFrame(()=>{var q;const S=((q=f.value)==null?void 0:q.$el).querySelector(".v-img__img");if(!S)return;const L=p instanceof Document?document.documentElement.clientHeight:p.clientHeight,D=p instanceof Document?window.scrollY:p.scrollTop,B=r.value.getBoundingClientRect().top+D,z=l.value.height,M=B+(z-L)/2,k=_ie((D-M)*y.value),V=Math.max(1,(y.value*(L-z)+z)/z);S.style.setProperty("transform",`translateY(${k}px) scale(${V})`)}))}return Bt(()=>H(rg,{class:["v-parallax",{"v-parallax--active":i.value},e.class],style:e.style,ref:f,cover:!0,onLoadstart:w,onLoad:w},n)),{}}}),wie=ht({...rE({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),Eie=Mt()({name:"VRadio",props:wie(),setup(e,t){let{slots:n}=t;return Bt(()=>H(ig,tn(e,{class:["v-radio",e.class],style:e.style,type:"radio"}),n)),{}}});const Sie=ht({height:{type:[Number,String],default:"auto"},...ff(),...Mu(MP(),["multiple"]),trueIcon:{type:Jn,default:"$radioOn"},falseIcon:{type:Jn,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),Tie=Mt()({name:"VRadioGroup",inheritAttrs:!1,props:Sie(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:n,slots:r}=t;const i=ws(),a=fe(()=>e.id||`radio-group-${i}`),l=nr(e,"modelValue");return Bt(()=>{const[o,f]=fg(n),[p,y]=ns.filterProps(e),[x,w]=ig.filterProps(e),S=r.label?r.label({label:e.label,props:{for:a.value}}):e.label;return H(ns,tn({class:["v-radio-group",e.class],style:e.style},o,p,{modelValue:l.value,"onUpdate:modelValue":L=>l.value=L,id:a.value}),{...r,default:L=>{let{id:D,messagesId:B,isDisabled:z,isReadonly:M}=L;return H(Dn,null,[S&&H($y,{id:D.value},{default:()=>[S]}),H(uB,tn(x,{id:D.value,"aria-describedby":B.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:z.value,readonly:M.value,"aria-labelledby":S?D.value:void 0,multiple:!1},f,{modelValue:l.value,"onUpdate:modelValue":k=>l.value=k}),r)])}})}),{}}}),Iie=ht({...iE(),...ff(),...tz(),strict:Boolean,modelValue:{type:Array,default:()=>[0,0]}},"VRangeSlider"),Cie=Mt()({name:"VRangeSlider",props:Iie(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,end:e=>!0,start:e=>!0},setup(e,t){let{slots:n,emit:r}=t;const i=Xt(),a=Xt(),l=Xt(),{rtlClasses:o}=Za();function f(U){if(!i.value||!a.value)return;const le=aC(U,i.value.$el,e.direction),ue=aC(U,a.value.$el,e.direction),ae=Math.abs(le),ve=Math.abs(ue);return ae<ve||ae===ve&&le<0?i.value.$el:a.value.$el}const p=nz(e),y=nr(e,"modelValue",void 0,U=>U!=null&&U.length?U.map(le=>p.roundValue(le)):[0,0]),{activeThumbRef:x,hasLabels:w,max:S,min:L,mousePressed:D,onSliderMousedown:B,onSliderTouchstart:z,position:M,trackContainerRef:k}=rz({props:e,steps:p,onSliderStart:()=>{r("start",y.value)},onSliderEnd:U=>{var ae;let{value:le}=U;const ue=x.value===((ae=i.value)==null?void 0:ae.$el)?[le,y.value[1]]:[y.value[0],le];!e.strict&&ue[0]<ue[1]&&(y.value=ue),r("end",y.value)},onSliderMove:U=>{var ve,Ee,He,Oe;let{value:le}=U;const[ue,ae]=y.value;!e.strict&&ue===ae&&ue!==L.value&&(x.value=le>ue?(ve=a.value)==null?void 0:ve.$el:(Ee=i.value)==null?void 0:Ee.$el,(He=x.value)==null||He.focus()),x.value===((Oe=i.value)==null?void 0:Oe.$el)?y.value=[Math.min(le,ae),ae]:y.value=[ue,Math.max(ue,le)]},getActiveThumb:f}),{isFocused:V,focus:q,blur:Y}=Td(e),K=fe(()=>M(y.value[0])),X=fe(()=>M(y.value[1]));return Bt(()=>{const[U,le]=ns.filterProps(e),ue=!!(e.label||n.label||n.prepend);return H(ns,tn({class:["v-slider","v-range-slider",{"v-slider--has-labels":!!n["tick-label"]||w.value,"v-slider--focused":V.value,"v-slider--pressed":D.value,"v-slider--disabled":e.disabled},o.value,e.class],style:e.style,ref:l},U,{focused:V.value}),{...n,prepend:ue?ae=>{var ve,Ee;return H(Dn,null,[((ve=n.label)==null?void 0:ve.call(n,ae))??(e.label?H($y,{class:"v-slider__label",text:e.label},null):void 0),(Ee=n.prepend)==null?void 0:Ee.call(n,ae)])}:void 0,default:ae=>{var He,Oe;let{id:ve,messagesId:Ee}=ae;return H("div",{class:"v-slider__container",onMousedown:B,onTouchstartPassive:z},[H("input",{id:`${ve.value}_start`,name:e.name||ve.value,disabled:!!e.disabled,readonly:!!e.readonly,tabindex:"-1",value:y.value[0]},null),H("input",{id:`${ve.value}_stop`,name:e.name||ve.value,disabled:!!e.disabled,readonly:!!e.readonly,tabindex:"-1",value:y.value[1]},null),H(iz,{ref:k,start:K.value,stop:X.value},{"tick-label":n["tick-label"]}),H(sC,{ref:i,"aria-describedby":Ee.value,focused:V&&x.value===((He=i.value)==null?void 0:He.$el),modelValue:y.value[0],"onUpdate:modelValue":Ve=>y.value=[Ve,y.value[1]],onFocus:Ve=>{var Pe,Ke,Be,Ue;q(),x.value=(Pe=i.value)==null?void 0:Pe.$el,y.value[0]===y.value[1]&&y.value[1]===L.value&&Ve.relatedTarget!==((Ke=a.value)==null?void 0:Ke.$el)&&((Be=i.value)==null||Be.$el.blur(),(Ue=a.value)==null||Ue.$el.focus())},onBlur:()=>{Y(),x.value=void 0},min:L.value,max:y.value[1],position:K.value},{"thumb-label":n["thumb-label"]}),H(sC,{ref:a,"aria-describedby":Ee.value,focused:V&&x.value===((Oe=a.value)==null?void 0:Oe.$el),modelValue:y.value[1],"onUpdate:modelValue":Ve=>y.value=[y.value[0],Ve],onFocus:Ve=>{var Pe,Ke,Be,Ue;q(),x.value=(Pe=a.value)==null?void 0:Pe.$el,y.value[0]===y.value[1]&&y.value[0]===S.value&&Ve.relatedTarget!==((Ke=i.value)==null?void 0:Ke.$el)&&((Be=a.value)==null||Be.$el.blur(),(Ue=i.value)==null||Ue.$el.focus())},onBlur:()=>{Y(),x.value=void 0},min:y.value[0],max:S.value,position:X.value},{"thumb-label":n["thumb-label"]})])}})}),{}}});const Pie=ht({name:String,itemAriaLabel:{type:String,default:"$vuetify.rating.ariaLabel.item"},activeColor:String,color:String,clearable:Boolean,disabled:Boolean,emptyIcon:{type:Jn,default:"$ratingEmpty"},fullIcon:{type:Jn,default:"$ratingFull"},halfIncrements:Boolean,hover:Boolean,length:{type:[Number,String],default:5},readonly:Boolean,modelValue:{type:[Number,String],default:0},itemLabels:Array,itemLabelPosition:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},ripple:Boolean,...ln(),...Ta(),...hf(),...or(),...ii()},"VRating"),Aie=Mt()({name:"VRating",props:Pie(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{t:r}=Ou(),{themeClasses:i}=Ii(e),a=nr(e,"modelValue"),l=fe(()=>ps(parseFloat(a.value),0,+e.length)),o=fe(()=>Fh(Number(e.length),1)),f=fe(()=>o.value.flatMap(D=>e.halfIncrements?[D-.5,D]:[D])),p=on(-1),y=fe(()=>f.value.map(D=>{const B=e.hover&&p.value>-1,z=l.value>=D,M=p.value>=D,V=(B?M:z)?e.fullIcon:e.emptyIcon,q=e.activeColor??e.color,Y=z||M?q:e.color;return{isFilled:z,isHovered:M,icon:V,color:Y}})),x=fe(()=>[0,...f.value].map(D=>{function B(){p.value=D}function z(){p.value=-1}function M(){e.disabled||e.readonly||(a.value=l.value===D&&e.clearable?0:D)}return{onMouseenter:e.hover?B:void 0,onMouseleave:e.hover?z:void 0,onClick:M}})),w=fe(()=>e.name??`v-rating-${ws()}`);function S(D){var X,U;let{value:B,index:z,showStar:M=!0}=D;const{onMouseenter:k,onMouseleave:V,onClick:q}=x.value[z+1],Y=`${w.value}-${String(B).replace(".","-")}`,K={color:(X=y.value[z])==null?void 0:X.color,density:e.density,disabled:e.disabled,icon:(U=y.value[z])==null?void 0:U.icon,ripple:e.ripple,size:e.size,variant:"plain"};return H(Dn,null,[H("label",{for:Y,class:{"v-rating__item--half":e.halfIncrements&&B%1>0,"v-rating__item--full":e.halfIncrements&&B%1===0},onMouseenter:k,onMouseleave:V,onClick:q},[H("span",{class:"v-rating__hidden"},[r(e.itemAriaLabel,B,e.length)]),M?n.item?n.item({...y.value[z],props:K,value:B,index:z,rating:l.value}):H(Ls,tn({"aria-label":r(e.itemAriaLabel,B,e.length)},K),null):void 0]),H("input",{class:"v-rating__hidden",name:w.value,id:Y,type:"radio",value:B,checked:l.value===B,tabindex:-1,readonly:e.readonly,disabled:e.disabled},null)])}function L(D){return n["item-label"]?n["item-label"](D):D.label?H("span",null,[D.label]):H("span",null,[au("")])}return Bt(()=>{var B;const D=!!((B=e.itemLabels)!=null&&B.length)||n["item-label"];return H(e.tag,{class:["v-rating",{"v-rating--hover":e.hover,"v-rating--readonly":e.readonly},i.value,e.class],style:e.style},{default:()=>[H(S,{value:0,index:-1,showStar:!1},null),o.value.map((z,M)=>{var k,V;return H("div",{class:"v-rating__wrapper"},[D&&e.itemLabelPosition==="top"?L({value:z,index:M,label:(k=e.itemLabels)==null?void 0:k[M]}):void 0,H("div",{class:"v-rating__item"},[e.halfIncrements?H(Dn,null,[H(S,{value:z-.5,index:M*2},null),H(S,{value:z,index:M*2+1},null)]):H(S,{value:z,index:M},null)]),D&&e.itemLabelPosition==="bottom"?L({value:z,index:M,label:(V=e.itemLabels)==null?void 0:V[M]}):void 0])})]})}),{}}});function yR(e){const n=Math.abs(e);return Math.sign(e)*(n/((1/.501-2)*(1-n)+1))}function vR(e){let{selectedElement:t,containerSize:n,contentSize:r,isRtl:i,currentScrollOffset:a,isHorizontal:l}=e;const o=l?t.clientWidth:t.clientHeight,f=l?t.offsetLeft:t.offsetTop,p=i&&l?r-f-o:f,y=n+a,x=o+p,w=o*.4;return p<=a?a=Math.max(p-w,0):y<=x&&(a=Math.min(a-(y-x-w),r-n)),a}function Mie(e){let{selectedElement:t,containerSize:n,contentSize:r,isRtl:i,isHorizontal:a}=e;const l=a?t.clientWidth:t.clientHeight,o=a?t.offsetLeft:t.offsetTop,f=i&&a?r-o-l/2-n/2:o+l/2-n/2;return Math.min(r-n,Math.max(0,f))}const xz=Symbol.for("vuetify:v-slide-group"),bz=ht({centerActive:Boolean,direction:{type:String,default:"horizontal"},symbol:{type:null,default:xz},nextIcon:{type:Jn,default:"$next"},prevIcon:{type:Jn,default:"$prev"},showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["always","desktop","mobile"].includes(e)},...ln(),...or(),...Fy({selectedClass:"v-slide-group-item--active"})},"VSlideGroup"),cC=Mt()({name:"VSlideGroup",props:bz(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{isRtl:r}=Za(),{mobile:i}=dg(),a=yg(e,e.symbol),l=on(!1),o=on(0),f=on(0),p=on(0),y=fe(()=>e.direction==="horizontal"),{resizeRef:x,contentRect:w}=lh(),{resizeRef:S,contentRect:L}=lh(),D=fe(()=>a.selected.value.length?a.items.value.findIndex(Be=>Be.id===a.selected.value[0]):-1),B=fe(()=>a.selected.value.length?a.items.value.findIndex(Be=>Be.id===a.selected.value[a.selected.value.length-1]):-1);if(Yi){let Be=-1;cn(()=>[a.selected.value,w.value,L.value,y.value],()=>{cancelAnimationFrame(Be),Be=requestAnimationFrame(()=>{if(w.value&&L.value){const Ue=y.value?"width":"height";f.value=w.value[Ue],p.value=L.value[Ue],l.value=f.value+1<p.value}if(D.value>=0&&S.value){const Ue=S.value.children[B.value];D.value===0||!l.value?o.value=0:e.centerActive?o.value=Mie({selectedElement:Ue,containerSize:f.value,contentSize:p.value,isRtl:r.value,isHorizontal:y.value}):l.value&&(o.value=vR({selectedElement:Ue,containerSize:f.value,contentSize:p.value,isRtl:r.value,currentScrollOffset:o.value,isHorizontal:y.value}))}})})}const z=on(!1);let M=0,k=0;function V(Be){const Ue=y.value?"clientX":"clientY";k=(r.value&&y.value?-1:1)*o.value,M=Be.touches[0][Ue],z.value=!0}function q(Be){if(!l.value)return;const Ue=y.value?"clientX":"clientY",lt=r.value&&y.value?-1:1;o.value=lt*(k+M-Be.touches[0][Ue])}function Y(Be){const Ue=p.value-f.value;o.value<0||!l.value?o.value=0:o.value>=Ue&&(o.value=Ue),z.value=!1}function K(){x.value&&(x.value[y.value?"scrollLeft":"scrollTop"]=0)}const X=on(!1);function U(Be){if(X.value=!0,!(!l.value||!S.value)){for(const Ue of Be.composedPath())for(const lt of S.value.children)if(lt===Ue){o.value=vR({selectedElement:lt,containerSize:f.value,contentSize:p.value,isRtl:r.value,currentScrollOffset:o.value,isHorizontal:y.value});return}}}function le(Be){X.value=!1}function ue(Be){var Ue;!X.value&&!(Be.relatedTarget&&((Ue=S.value)!=null&&Ue.contains(Be.relatedTarget)))&&ve()}function ae(Be){S.value&&(y.value?Be.key==="ArrowRight"?ve(r.value?"prev":"next"):Be.key==="ArrowLeft"&&ve(r.value?"next":"prev"):Be.key==="ArrowDown"?ve("next"):Be.key==="ArrowUp"&&ve("prev"),Be.key==="Home"?ve("first"):Be.key==="End"&&ve("last"))}function ve(Be){var Ue,lt,xt,Nt,Wt;if(S.value)if(!Be)(Ue=O0(S.value)[0])==null||Ue.focus();else if(Be==="next"){const Je=(lt=S.value.querySelector(":focus"))==null?void 0:lt.nextElementSibling;Je?Je.focus():ve("first")}else if(Be==="prev"){const Je=(xt=S.value.querySelector(":focus"))==null?void 0:xt.previousElementSibling;Je?Je.focus():ve("last")}else Be==="first"?(Nt=S.value.firstElementChild)==null||Nt.focus():Be==="last"&&((Wt=S.value.lastElementChild)==null||Wt.focus())}function Ee(Be){const Ue=o.value+(Be==="prev"?-1:1)*f.value;o.value=ps(Ue,0,p.value-f.value)}const He=fe(()=>{let Be=o.value>p.value-f.value?-(p.value-f.value)+yR(p.value-f.value-o.value):-o.value;o.value<=0&&(Be=yR(-o.value));const Ue=r.value&&y.value?-1:1;return{transform:`translate${y.value?"X":"Y"}(${Ue*Be}px)`,transition:z.value?"none":"",willChange:z.value?"transform":""}}),Oe=fe(()=>({next:a.next,prev:a.prev,select:a.select,isSelected:a.isSelected})),Ve=fe(()=>{switch(e.showArrows){case"always":return!0;case"desktop":return!i.value;case!0:return l.value||Math.abs(o.value)>0;case"mobile":return i.value||l.value||Math.abs(o.value)>0;default:return!i.value&&(l.value||Math.abs(o.value)>0)}}),Pe=fe(()=>Math.abs(o.value)>0),Ke=fe(()=>p.value>Math.abs(o.value)+f.value);return Bt(()=>H(e.tag,{class:["v-slide-group",{"v-slide-group--vertical":!y.value,"v-slide-group--has-affixes":Ve.value,"v-slide-group--is-overflowing":l.value},e.class],style:e.style,tabindex:X.value||a.selected.value.length?-1:0,onFocus:ue},{default:()=>{var Be,Ue,lt;return[Ve.value&&H("div",{key:"prev",class:["v-slide-group__prev",{"v-slide-group__prev--disabled":!Pe.value}],onClick:()=>Ee("prev")},[((Be=n.prev)==null?void 0:Be.call(n,Oe.value))??H(qI,null,{default:()=>[H(zi,{icon:r.value?e.nextIcon:e.prevIcon},null)]})]),H("div",{key:"container",ref:x,class:"v-slide-group__container",onScroll:K},[H("div",{ref:S,class:"v-slide-group__content",style:He.value,onTouchstartPassive:V,onTouchmovePassive:q,onTouchendPassive:Y,onFocusin:U,onFocusout:le,onKeydown:ae},[(Ue=n.default)==null?void 0:Ue.call(n,Oe.value)])]),Ve.value&&H("div",{key:"next",class:["v-slide-group__next",{"v-slide-group__next--disabled":!Ke.value}],onClick:()=>Ee("next")},[((lt=n.next)==null?void 0:lt.call(n,Oe.value))??H(qI,null,{default:()=>[H(zi,{icon:r.value?e.prevIcon:e.nextIcon},null)]})])]}})),{selected:a.selected,scrollTo:Ee,scrollOffset:o,focus:ve}}}),Lie=Mt()({name:"VSlideGroupItem",props:By(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:n}=t;const r=zy(e,xz);return()=>{var i;return(i=n.default)==null?void 0:i.call(n,{isSelected:r.isSelected.value,select:r.select,toggle:r.toggle,selectedClass:r.selectedClass.value})}}});const Oie=ht({multiLine:Boolean,timeout:{type:[Number,String],default:5e3},vertical:Boolean,...wd({location:"bottom"}),...Vy(),...lo(),...Nu(),...ii(),...Mu(l1({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),Die=Mt()({name:"VSnackbar",props:Oie(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const r=nr(e,"modelValue"),{locationStyles:i}=Ed(e),{positionClasses:a}=Gy(e),{scopeId:l}=jy(),{themeClasses:o}=Ii(e),{colorClasses:f,colorStyles:p,variantClasses:y}=mg(e),{roundedClasses:x}=ko(e),w=Xt();cn(r,L),cn(()=>e.timeout,L),bs(()=>{r.value&&L()});let S=-1;function L(){window.clearTimeout(S);const B=Number(e.timeout);!r.value||B===-1||(S=window.setTimeout(()=>{r.value=!1},B))}function D(){window.clearTimeout(S)}return Bt(()=>{const[B]=nf.filterProps(e);return H(nf,tn({ref:w,class:["v-snackbar",{"v-snackbar--active":r.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--vertical":e.vertical},a.value,e.class],style:e.style},B,{modelValue:r.value,"onUpdate:modelValue":z=>r.value=z,contentProps:tn({class:["v-snackbar__wrapper",o.value,f.value,x.value,y.value],style:[i.value,p.value],onPointerenter:D,onPointerleave:L},B.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0},l),{default:()=>[gg(!1,"v-snackbar"),n.default&&H("div",{class:"v-snackbar__content",role:"status","aria-live":"polite"},[n.default()]),n.actions&&H(Mi,{defaults:{VBtn:{variant:"text",ripple:!1}}},{default:()=>[H("div",{class:"v-snackbar__actions"},[n.actions()])]})],activator:n.activator})}),Ic({},w)}});const Rie=ht({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...ff(),...rE()},"VSwitch"),kie=Mt()({name:"VSwitch",inheritAttrs:!1,props:Rie(),emits:{"update:focused":e=>!0,"update:modelValue":()=>!0,"update:indeterminate":e=>!0},setup(e,t){let{attrs:n,slots:r}=t;const i=nr(e,"indeterminate"),a=nr(e,"modelValue"),{loaderClasses:l}=nE(e),{isFocused:o,focus:f,blur:p}=Td(e),y=Xt(),x=fe(()=>typeof e.loading=="string"&&e.loading!==""?e.loading:e.color),w=ws(),S=fe(()=>e.id||`switch-${w}`);function L(){i.value&&(i.value=!1)}function D(B){var z,M;B.stopPropagation(),B.preventDefault(),(M=(z=y.value)==null?void 0:z.input)==null||M.click()}return Bt(()=>{const[B,z]=fg(n),[M,k]=ns.filterProps(e),[V,q]=ig.filterProps(e);return H(ns,tn({class:["v-switch",{"v-switch--inset":e.inset},{"v-switch--indeterminate":i.value},l.value,e.class],style:e.style},B,M,{id:S.value,focused:o.value}),{...r,default:Y=>{let{id:K,messagesId:X,isDisabled:U,isReadonly:le,isValid:ue}=Y;return H(ig,tn({ref:y},V,{modelValue:a.value,"onUpdate:modelValue":[ae=>a.value=ae,L],id:K.value,"aria-describedby":X.value,type:"checkbox","aria-checked":i.value?"mixed":void 0,disabled:U.value,readonly:le.value,onFocus:f,onBlur:p},z),{...r,default:ae=>{let{backgroundColorClasses:ve,backgroundColorStyles:Ee}=ae;return H("div",{class:["v-switch__track",...ve.value],style:Ee.value,onClick:D},null)},input:ae=>{let{inputNode:ve,icon:Ee,backgroundColorClasses:He,backgroundColorStyles:Oe}=ae;return H(Dn,null,[ve,H("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":Ee||e.loading},e.inset?void 0:He.value],style:e.inset?void 0:Oe.value},[H(_P,null,{default:()=>[e.loading?H(PP,{name:"v-switch",active:!0,color:ue.value===!1?void 0:x.value},{default:Ve=>r.loader?r.loader(Ve):H(TP,{active:Ve.isActive,color:Ve.color,indeterminate:!0,size:"16",width:"2"},null)}):Ee&&H(zi,{key:Ee,icon:Ee,size:"x-small"},null)]})])])}})}})}),{}}});const Nie=ht({color:String,height:[Number,String],window:Boolean,...ln(),...Sa(),...ky(),...lo(),...or(),...ii()},"VSystemBar"),Fie=Mt()({name:"VSystemBar",props:Nie(),setup(e,t){let{slots:n}=t;const{themeClasses:r}=Ii(e),{backgroundColorClasses:i,backgroundColorStyles:a}=zo(kt(e,"color")),{elevationClasses:l}=rs(e),{roundedClasses:o}=ko(e),{ssrBootStyles:f}=pg(),p=fe(()=>e.height??(e.window?32:24)),{layoutItemStyles:y}=Ny({id:e.name,order:fe(()=>parseInt(e.order,10)),position:on("top"),layoutSize:p,elementSize:p,active:fe(()=>!0),absolute:kt(e,"absolute")});return Bt(()=>H(e.tag,{class:["v-system-bar",{"v-system-bar--window":e.window},r.value,i.value,l.value,o.value,e.class],style:[a.value,y.value,f.value,e.style]},n)),{}}});const wz=Symbol.for("vuetify:v-tabs"),Bie=ht({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Mu(AP({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),Ez=Mt()({name:"VTab",props:Bie(),setup(e,t){let{slots:n,attrs:r}=t;const{textColorClasses:i,textColorStyles:a}=xs(e,"sliderColor"),l=fe(()=>e.direction==="horizontal"),o=on(!1),f=Xt(),p=Xt();function y(x){var S,L;let{value:w}=x;if(o.value=w,w){const D=(L=(S=f.value)==null?void 0:S.$el.parentElement)==null?void 0:L.querySelector(".v-tab--selected .v-tab__slider"),B=p.value;if(!D||!B)return;const z=getComputedStyle(D).color,M=D.getBoundingClientRect(),k=B.getBoundingClientRect(),V=l.value?"x":"y",q=l.value?"X":"Y",Y=l.value?"right":"bottom",K=l.value?"width":"height",X=M[V],U=k[V],le=X>U?M[Y]-k[Y]:M[V]-k[V],ue=Math.sign(le)>0?l.value?"right":"bottom":Math.sign(le)<0?l.value?"left":"top":"center",ve=(Math.abs(le)+(Math.sign(le)<0?M[K]:k[K]))/Math.max(M[K],k[K])||0,Ee=M[K]/k[K]||0,He=1.5;Cp(B,{backgroundColor:[z,"currentcolor"],transform:[`translate${q}(${le}px) scale${q}(${Ee})`,`translate${q}(${le/He}px) scale${q}(${(ve-1)/He+1})`,"none"],transformOrigin:Array(3).fill(ue)},{duration:225,easing:D0})}}return Bt(()=>{const[x]=Ls.filterProps(e);return H(Ls,tn({symbol:wz,ref:f,class:["v-tab",e.class],style:e.style,tabindex:o.value?0:-1,role:"tab","aria-selected":String(o.value),active:!1},x,r,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":y}),{default:()=>{var w;return[((w=n.default)==null?void 0:w.call(n))??e.text,!e.hideSlider&&H("div",{ref:p,class:["v-tab__slider",i.value],style:a.value},null)]}})}),{}}});function zie(e){return e?e.map(t=>Jb(t)?t:{text:t,value:t}):[]}const Uie=ht({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...bz({mandatory:"force"}),...Ta(),...or()},"VTabs"),Vie=Mt()({name:"VTabs",props:Uie(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const r=nr(e,"modelValue"),i=fe(()=>zie(e.items)),{densityClasses:a}=Es(e),{backgroundColorClasses:l,backgroundColorStyles:o}=zo(kt(e,"bgColor"));return fa({VTab:{color:kt(e,"color"),direction:kt(e,"direction"),stacked:kt(e,"stacked"),fixed:kt(e,"fixedTabs"),sliderColor:kt(e,"sliderColor"),hideSlider:kt(e,"hideSlider")}}),Bt(()=>{const[f]=cC.filterProps(e);return H(cC,tn(f,{modelValue:r.value,"onUpdate:modelValue":p=>r.value=p,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},a.value,l.value,e.class],style:[{"--v-tabs-height":dn(e.height)},o.value,e.style],role:"tablist",symbol:wz}),{default:()=>[n.default?n.default():i.value.map(p=>H(Ez,tn(p,{key:p.text}),null))]})}),{}}});const Gie=ht({fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...ln(),...Ta(),...or(),...ii()},"VTable"),$ie=Mt()({name:"VTable",props:Gie(),setup(e,t){let{slots:n}=t;const{themeClasses:r}=Ii(e),{densityClasses:i}=Es(e);return Bt(()=>H(e.tag,{class:["v-table",{"v-table--fixed-height":!!e.height,"v-table--fixed-header":e.fixedHeader,"v-table--fixed-footer":e.fixedFooter,"v-table--has-top":!!n.top,"v-table--has-bottom":!!n.bottom,"v-table--hover":e.hover},r.value,i.value,e.class],style:e.style},{default:()=>{var a,l,o;return[(a=n.top)==null?void 0:a.call(n),n.default?H("div",{class:"v-table__wrapper",style:{height:dn(e.height)}},[H("table",null,[n.default()])]):(l=n.wrapper)==null?void 0:l.call(n),(o=n.bottom)==null?void 0:o.call(n)]}})),{}}});const jie=ht({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...ff(),...cE()},"VTextarea"),qie=Mt()({name:"VTextarea",directives:{Intersect:i1},inheritAttrs:!1,props:jie(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{attrs:n,emit:r,slots:i}=t;const a=nr(e,"modelValue"),{isFocused:l,focus:o,blur:f}=Td(e),p=fe(()=>typeof e.counterValue=="function"?e.counterValue(a.value):(a.value||"").toString().length),y=fe(()=>{if(n.maxlength)return n.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function x(ue,ae){var ve,Ee;!e.autofocus||!ue||(Ee=(ve=ae[0].target)==null?void 0:ve.focus)==null||Ee.call(ve)}const w=Xt(),S=Xt(),L=on(""),D=Xt(),B=fe(()=>e.persistentPlaceholder||l.value||e.active);function z(){var ue;D.value!==document.activeElement&&((ue=D.value)==null||ue.focus()),l.value||o()}function M(ue){z(),r("click:control",ue)}function k(ue){r("mousedown:control",ue)}function V(ue){ue.stopPropagation(),z(),qi(()=>{a.value="",uP(e["onClick:clear"],ue)})}function q(ue){var ve;const ae=ue.target;if(a.value=ae.value,(ve=e.modelModifiers)!=null&&ve.trim){const Ee=[ae.selectionStart,ae.selectionEnd];qi(()=>{ae.selectionStart=Ee[0],ae.selectionEnd=Ee[1]})}}const Y=Xt(),K=Xt(+e.rows),X=fe(()=>["plain","underlined"].includes(e.variant));Nl(()=>{e.autoGrow||(K.value=+e.rows)});function U(){e.autoGrow&&qi(()=>{if(!Y.value||!S.value)return;const ue=getComputedStyle(Y.value),ae=getComputedStyle(S.value.$el),ve=parseFloat(ue.getPropertyValue("--v-field-padding-top"))+parseFloat(ue.getPropertyValue("--v-input-padding-top"))+parseFloat(ue.getPropertyValue("--v-field-padding-bottom")),Ee=Y.value.scrollHeight,He=parseFloat(ue.lineHeight),Oe=Math.max(parseFloat(e.rows)*He+ve,parseFloat(ae.getPropertyValue("--v-input-control-height"))),Ve=parseFloat(e.maxRows)*He+ve||1/0,Pe=ps(Ee??0,Oe,Ve);K.value=Math.floor((Pe-ve)/He),L.value=dn(Pe)})}bs(U),cn(a,U),cn(()=>e.rows,U),cn(()=>e.maxRows,U),cn(()=>e.density,U);let le;return cn(Y,ue=>{ue?(le=new ResizeObserver(U),le.observe(Y.value)):le==null||le.disconnect()}),Us(()=>{le==null||le.disconnect()}),Bt(()=>{const ue=!!(i.counter||e.counter||e.counterValue),ae=!!(ue||i.details),[ve,Ee]=fg(n),[{modelValue:He,...Oe}]=ns.filterProps(e),[Ve]=RP(e);return H(ns,tn({ref:w,modelValue:a.value,"onUpdate:modelValue":Pe=>a.value=Pe,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-text-field--plain-underlined":X.value},e.class],style:e.style},ve,Oe,{centerAffix:K.value===1&&!X.value,focused:l.value}),{...i,default:Pe=>{let{isDisabled:Ke,isDirty:Be,isReadonly:Ue,isValid:lt}=Pe;return H(u1,tn({ref:S,style:{"--v-textarea-control-height":L.value},onClick:M,onMousedown:k,"onClick:clear":V,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},Ve,{active:B.value||Be.value,centerAffix:K.value===1&&!X.value,dirty:Be.value||e.dirty,disabled:Ke.value,focused:l.value,error:lt.value===!1}),{...i,default:xt=>{let{props:{class:Nt,...Wt}}=xt;return H(Dn,null,[e.prefix&&H("span",{class:"v-text-field__prefix"},[e.prefix]),go(H("textarea",tn({ref:D,class:Nt,value:a.value,onInput:q,autofocus:e.autofocus,readonly:Ue.value,disabled:Ke.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:z,onBlur:f},Wt,Ee),null),[[Fl("intersect"),{handler:x},null,{once:!0}]]),e.autoGrow&&go(H("textarea",{class:[Nt,"v-textarea__sizer"],id:`${Wt.id}-sizer`,"onUpdate:modelValue":Je=>a.value=Je,ref:Y,readonly:!0,"aria-hidden":"true"},null),[[IV,a.value]]),e.suffix&&H("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:ae?Pe=>{var Ke;return H(Dn,null,[(Ke=i.details)==null?void 0:Ke.call(i,Pe),ue&&H(Dn,null,[H("span",null,null),H(uE,{active:e.persistentCounter||l.value,value:p.value,max:y.value},i.counter)])])}:void 0})}),Ic({},w,S,D)}});const Zie=ht({withBackground:Boolean,...ln(),...ii(),...or()},"VThemeProvider"),Xie=Mt()({name:"VThemeProvider",props:Zie(),setup(e,t){let{slots:n}=t;const{themeClasses:r}=Ii(e);return()=>{var i;return e.withBackground?H(e.tag,{class:["v-theme-provider",r.value,e.class],style:e.style},{default:()=>{var a;return[(a=n.default)==null?void 0:a.call(n)]}}):(i=n.default)==null?void 0:i.call(n)}}});const Wie=ht({align:{type:String,default:"center",validator:e=>["center","start"].includes(e)},direction:{type:String,default:"vertical",validator:e=>["vertical","horizontal"].includes(e)},justify:{type:String,default:"auto",validator:e=>["auto","center"].includes(e)},side:{type:String,validator:e=>e==null||["start","end"].includes(e)},lineInset:{type:[String,Number],default:0},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:e=>["start","end","both"].includes(e)},...ln(),...Ta(),...or(),...ii()},"VTimeline"),Hie=Mt()({name:"VTimeline",props:Wie(),setup(e,t){let{slots:n}=t;const{themeClasses:r}=Ii(e),{densityClasses:i}=Es(e),{rtlClasses:a}=Za();fa({VTimelineDivider:{lineColor:kt(e,"lineColor")},VTimelineItem:{density:kt(e,"density"),lineInset:kt(e,"lineInset")}});const l=fe(()=>{const f=e.side?e.side:e.density!=="default"?"end":null;return f&&`v-timeline--side-${f}`}),o=fe(()=>{const f=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(e.truncateLine){case"both":return f;case"start":return f[0];case"end":return f[1];default:return null}});return Bt(()=>H(e.tag,{class:["v-timeline",`v-timeline--${e.direction}`,`v-timeline--align-${e.align}`,`v-timeline--justify-${e.justify}`,o.value,{"v-timeline--inset-line":!!e.lineInset},r.value,i.value,l.value,a.value,e.class],style:[{"--v-timeline-line-thickness":dn(e.lineThickness)},e.style]},n)),{}}}),Yie=ht({dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:Jn,iconColor:String,lineColor:String,...ln(),...lo(),...hf(),...Sa()},"VTimelineDivider"),Kie=Mt()({name:"VTimelineDivider",props:Yie(),setup(e,t){let{slots:n}=t;const{sizeClasses:r,sizeStyles:i}=Uy(e,"v-timeline-divider__dot"),{backgroundColorStyles:a,backgroundColorClasses:l}=zo(kt(e,"dotColor")),{roundedClasses:o}=ko(e,"v-timeline-divider__dot"),{elevationClasses:f}=rs(e),{backgroundColorClasses:p,backgroundColorStyles:y}=zo(kt(e,"lineColor"));return Bt(()=>H("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":e.fillDot},e.class],style:e.style},[H("div",{class:["v-timeline-divider__before",p.value],style:y.value},null),!e.hideDot&&H("div",{key:"dot",class:["v-timeline-divider__dot",f.value,o.value,r.value],style:i.value},[H("div",{class:["v-timeline-divider__inner-dot",l.value,o.value],style:a.value},[n.default?H(Mi,{key:"icon-defaults",disabled:!e.icon,defaults:{VIcon:{color:e.iconColor,icon:e.icon,size:e.size}}},n.default):H(zi,{key:"icon",color:e.iconColor,icon:e.icon,size:e.size},null)])]),H("div",{class:["v-timeline-divider__after",p.value],style:y.value},null)])),{}}}),Jie=ht({density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:Jn,iconColor:String,lineInset:[Number,String],...ln(),...Du(),...Sa(),...lo(),...hf(),...or()},"VTimelineItem"),Qie=Mt()({name:"VTimelineItem",props:Jie(),setup(e,t){let{slots:n}=t;const{dimensionStyles:r}=Ru(e),i=on(0),a=Xt();return cn(a,l=>{var o;l&&(i.value=((o=l.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:o.getBoundingClientRect().width)??0)},{flush:"post"}),Bt(()=>{var l,o;return H("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":e.fillDot},e.class],style:[{"--v-timeline-dot-size":dn(i.value),"--v-timeline-line-inset":e.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${dn(e.lineInset)})`:dn(0)},e.style]},[H("div",{class:"v-timeline-item__body",style:r.value},[(l=n.default)==null?void 0:l.call(n)]),H(Kie,{ref:a,hideDot:e.hideDot,icon:e.icon,iconColor:e.iconColor,size:e.size,elevation:e.elevation,dotColor:e.dotColor,fillDot:e.fillDot,rounded:e.rounded},{default:n.icon}),e.density!=="compact"&&H("div",{class:"v-timeline-item__opposite"},[!e.hideOpposite&&((o=n.opposite)==null?void 0:o.call(n))])])}),{}}}),eoe=ht({...ln(),...Nu({variant:"text"})},"VToolbarItems"),toe=Mt()({name:"VToolbarItems",props:eoe(),setup(e,t){let{slots:n}=t;return fa({VBtn:{color:kt(e,"color"),height:"inherit",variant:kt(e,"variant")}}),Bt(()=>{var r;return H("div",{class:["v-toolbar-items",e.class],style:e.style},[(r=n.default)==null?void 0:r.call(n)])}),{}}});const noe=ht({id:String,text:String,...Mu(l1({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),roe=Mt()({name:"VTooltip",props:noe(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const r=nr(e,"modelValue"),{scopeId:i}=jy(),a=ws(),l=fe(()=>e.id||`v-tooltip-${a}`),o=Xt(),f=fe(()=>e.location.split(" ").length>1?e.location:e.location+" center"),p=fe(()=>e.origin==="auto"||e.origin==="overlap"||e.origin.split(" ").length>1||e.location.split(" ").length>1?e.origin:e.origin+" center"),y=fe(()=>e.transition?e.transition:r.value?"scale-transition":"fade-transition"),x=fe(()=>tn({"aria-describedby":l.value},e.activatorProps));return Bt(()=>{const[w]=nf.filterProps(e);return H(nf,tn({ref:o,class:["v-tooltip",e.class],style:e.style,id:l.value},w,{modelValue:r.value,"onUpdate:modelValue":S=>r.value=S,transition:y.value,absolute:!0,location:f.value,origin:p.value,persistent:!0,role:"tooltip",activatorProps:x.value,_disableGlobalStack:!0},i),{activator:n.activator,default:function(){var B;for(var S=arguments.length,L=new Array(S),D=0;D<S;D++)L[D]=arguments[D];return((B=n.default)==null?void 0:B.call(n,...L))??e.text}})}),Ic({},o)}}),ioe=Mt()({name:"VValidation",props:pB(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const r=gB(e,"validation");return()=>{var i;return(i=n.default)==null?void 0:i.call(n,r)}}}),ooe=Object.freeze(Object.defineProperty({__proto__:null,VAlert:Ree,VAlertTitle:sB,VApp:jQ,VAppBar:cee,VAppBarNavIcon:Mee,VAppBarTitle:Lee,VAutocomplete:Jte,VAvatar:yd,VBadge:ene,VBanner:rne,VBannerActions:VB,VBannerText:GB,VBottomNavigation:one,VBreadcrumbs:une,VBreadcrumbsDivider:$B,VBreadcrumbsItem:jB,VBtn:Ls,VBtnGroup:WI,VBtnToggle:mee,VCard:fne,VCardActions:qB,VCardItem:WB,VCardSubtitle:ZB,VCardText:HB,VCardTitle:XB,VCarousel:bne,VCarouselItem:Ene,VCheckbox:Gee,VCheckboxBtn:wy,VChip:s1,VChipGroup:qee,VClassIcon:yP,VCode:Sne,VCol:kre,VColorPicker:fre,VCombobox:gre,VComponentIcon:GI,VContainer:Lre,VCounter:uE,VDefaultsProvider:Mi,VDialog:yre,VDialogBottomTransition:WQ,VDialogTopTransition:HQ,VDialogTransition:eE,VDivider:IB,VExpandTransition:tE,VExpandXTransition:bP,VExpansionPanel:Ere,VExpansionPanelText:az,VExpansionPanelTitle:lz,VExpansionPanels:xre,VFabTransition:XQ,VFadeTransition:qI,VField:u1,VFieldLabel:j_,VFileInput:Tre,VFooter:Cre,VForm:Are,VHover:qre,VIcon:zi,VImg:rg,VInput:ns,VItem:Wre,VItemGroup:Xre,VKbd:Hre,VLabel:$y,VLayout:Kre,VLayoutItem:Qre,VLazy:tie,VLigatureIcon:rQ,VList:aE,VListGroup:JI,VListImg:hte,VListItem:tf,VListItemAction:dte,VListItemMedia:gte,VListItemSubtitle:EB,VListItemTitle:SB,VListSubheader:TB,VLocaleProvider:rie,VMain:oie,VMenu:lE,VMessages:fB,VNavigationDrawer:pie,VNoSsr:gie,VOverlay:nf,VPagination:vie,VParallax:bie,VProgressCircular:TP,VProgressLinear:IP,VRadio:Eie,VRadioGroup:Tie,VRangeSlider:Cie,VRating:Aie,VResponsive:ZI,VRow:Gre,VScaleTransition:_P,VScrollXReverseTransition:KQ,VScrollXTransition:YQ,VScrollYReverseTransition:QQ,VScrollYTransition:JQ,VSelect:Xte,VSelectionControl:ig,VSelectionControlGroup:uB,VSheet:uC,VSlideGroup:cC,VSlideGroupItem:Lie,VSlideXReverseTransition:tee,VSlideXTransition:eee,VSlideYReverseTransition:nee,VSlideYTransition:xP,VSlider:lC,VSnackbar:Die,VSpacer:$re,VSvgIcon:mP,VSwitch:kie,VSystemBar:Fie,VTab:Ez,VTable:$ie,VTabs:Vie,VTextField:og,VTextarea:qie,VThemeProvider:Xie,VTimeline:Hie,VTimelineItem:Qie,VToolbar:XI,VToolbarItems:toe,VToolbarTitle:vP,VTooltip:roe,VValidation:ioe,VVirtualScroll:fE,VWindow:nC,VWindowItem:rC},Symbol.toStringTag,{value:"Module"}));function aoe(e,t){const n=t.modifiers||{},r=t.value,{once:i,immediate:a,...l}=n,o=!Object.keys(l).length,{handler:f,options:p}=typeof r=="object"?r:{handler:r,options:{attributes:(l==null?void 0:l.attr)??o,characterData:(l==null?void 0:l.char)??o,childList:(l==null?void 0:l.child)??o,subtree:(l==null?void 0:l.sub)??o}},y=new MutationObserver(function(){let x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],w=arguments.length>1?arguments[1]:void 0;f==null||f(x,w),i&&Sz(e,t)});a&&(f==null||f([],y)),e._mutate=Object(e._mutate),e._mutate[t.instance.$.uid]={observer:y},y.observe(e,p)}function Sz(e,t){var n;(n=e._mutate)!=null&&n[t.instance.$.uid]&&(e._mutate[t.instance.$.uid].observer.disconnect(),delete e._mutate[t.instance.$.uid])}const soe={mounted:aoe,unmounted:Sz};function loe(e,t){var i,a;const n=t.value,r={passive:!((i=t.modifiers)!=null&&i.active)};window.addEventListener("resize",n,r),e._onResize=Object(e._onResize),e._onResize[t.instance.$.uid]={handler:n,options:r},(a=t.modifiers)!=null&&a.quiet||n()}function uoe(e,t){var i;if(!((i=e._onResize)!=null&&i[t.instance.$.uid]))return;const{handler:n,options:r}=e._onResize[t.instance.$.uid];window.removeEventListener("resize",n,r),delete e._onResize[t.instance.$.uid]}const coe={mounted:loe,unmounted:uoe};function Tz(e,t){const{self:n=!1}=t.modifiers??{},r=t.value,i=typeof r=="object"&&r.options||{passive:!0},a=typeof r=="function"||"handleEvent"in r?r:r.handler,l=n?e:t.arg?document.querySelector(t.arg):window;l&&(l.addEventListener("scroll",a,i),e._onScroll=Object(e._onScroll),e._onScroll[t.instance.$.uid]={handler:a,options:i,target:n?void 0:l})}function Iz(e,t){var a;if(!((a=e._onScroll)!=null&&a[t.instance.$.uid]))return;const{handler:n,options:r,target:i=e}=e._onScroll[t.instance.$.uid];i.removeEventListener("scroll",n,r),delete e._onScroll[t.instance.$.uid]}function hoe(e,t){t.value!==t.oldValue&&(Iz(e,t),Tz(e,t))}const foe={mounted:Tz,unmounted:Iz,updated:hoe},doe=Object.freeze(Object.defineProperty({__proto__:null,ClickOutside:BB,Intersect:i1,Mutate:soe,Resize:coe,Ripple:Sd,Scroll:foe,Touch:FP},Symbol.toStringTag,{value:"Module"})),poe=GF({components:ooe,directives:doe});RV(fJ).use(poe).mount("#app");
